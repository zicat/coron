"SELECT SUM(""自定义 SQL 查询"".""host_4k"") AS ""TEMP(Calculation_3519281700079370244)(1075454865)(0)"",
  SUM(""自定义 SQL 查询"".""audience_sd"") AS ""TEMP(Calculation_3519281700079370244)(1133678835)(0)"",
  SUM(""自定义 SQL 查询"".""host_1080p"") AS ""TEMP(Calculation_3519281700079370244)(1312501967)(0)"",
  SUM(""自定义 SQL 查询"".""host_hd"") AS ""TEMP(Calculation_3519281700079370244)(276907208)(0)"",
  SUM(""自定义 SQL 查询"".""video"") AS ""TEMP(Calculation_3519281700079370244)(2929708110)(0)"",
  SUM(""自定义 SQL 查询"".""audience_hd"") AS ""TEMP(Calculation_3519281700079370244)(2930728935)(0)"",
  SUM(""自定义 SQL 查询"".""audience_hdp"") AS ""TEMP(Calculation_3519281700079370244)(3010533957)(0)"",
  SUM(""自定义 SQL 查询"".""host_hdp"") AS ""TEMP(Calculation_3519281700079370244)(30306054)(0)"",
  SUM(""自定义 SQL 查询"".""host_audio"") AS ""TEMP(Calculation_3519281700079370244)(3087054365)(0)"",
  SUM(""自定义 SQL 查询"".""audio"") AS ""TEMP(Calculation_3519281700079370244)(3299350010)(0)"",
  SUM(""自定义 SQL 查询"".""audience_1080p"") AS ""TEMP(Calculation_3519281700079370244)(3628946582)(0)"",
  SUM(""自定义 SQL 查询"".""totalUsage"") AS ""TEMP(Calculation_3519281700079370244)(3847882359)(0)"",
  SUM(""自定义 SQL 查询"".""audience_audio"") AS ""TEMP(Calculation_3519281700079370244)(4109514392)(0)"",
  SUM(""自定义 SQL 查询"".""host_2k"") AS ""TEMP(Calculation_3519281700079370244)(586790827)(0)"",
  SUM(""自定义 SQL 查询"".""host_sd"") AS ""TEMP(Calculation_3519281700079370244)(709512178)(0)"",
  SUM(""自定义 SQL 查询"".""audience_4k"") AS ""TEMP(Calculation_3519281700079370244)(764410224)(0)"",
  SUM(""自定义 SQL 查询"".""audience_2k"") AS ""TEMP(Calculation_3519281700079370244)(943764407)(0)"",
  ""自定义 SQL 查询"".""level1"" AS ""level1"",
  SUM(""自定义 SQL 查询"".""totalUsage"") AS ""sum_totalUsage_ok"",
  DATE_ADD('SECOND', 0, date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d')) AS ""tdy_date_ok""
FROM (SELECT date,
        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,
      start_date AS start_date_7,
      end_date AS end_date,
      tag,
      area AS Scope,
      dim,
        CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,
      level2,
      level3,
      level4,
      product_level1 AS product_line,
      product_level2,
      product_level3,
      product_level4,
      vid_internal_industry_en AS cid_industry,
      vid_use_case_en AS vid_use_case_cn,
      vid_sector_en,
      ver_type,
      ver,
      os,
      domain,
      country,
      region,
      dim_grouping_name,
        CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,
      total AS totalUsage,
      audio,
      video,
      host_audio,
      audience_audio,
      host_sd,
      host_hd,
      host_hdp,
      host_1080p,
      host_2k,
      host_4k,
      audience_sd,
      audience_hd,
      audience_hdp,
      audience_1080p,
      audience_2k,
      audience_4k,
      audience_audio_low_latency,
      audience_sd_low_latency,
      audience_hd_low_latency,
      audience_hdp_low_latency,
      audience_1080p_low_latency,
      audience_2k_low_latency,
      audience_4k_low_latency,
      audience_audio_ultra_low_latency,
      audience_sd_ultra_low_latency,
      audience_hd_ultra_low_latency,
      audience_hdp_ultra_low_latency,
      audience_1080p_ultra_low_latency,
      audience_2k_ultra_low_latency,
      audience_4k_ultra_low_latency,
      total_last1 AS audio_video_last,
      audio_last1 AS audio_last,
      video_last1 AS video_last,
      video_sd_last1 AS video_sd_last,
      video_hd_last1 AS video_hd_last,
      video_hdp_last1 AS video_hdp_last,
      host_sd_last1 AS host_video_sd_last,
      audience_sd_last1 AS audience_video_sd_last,
      host_hd_last1 AS host_video_hd_last,
      audience_hd_last1 AS audience_video_hd_last,
      host_hdp_last1 AS host_video_hdp_last,
      audience_hdp_last1 AS audience_video_hdp_last,
      host_audio_last1 AS host_audio_last,
      audience_audio_last1 AS audience_audio_last,
      host_video_last1 AS host_video_last,
      audience_video_last1 AS audience_video_last,
      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,
      audience_video_low_latency_last1 AS audience_video_low_latency_last,
      audience_total_low_latency_last1 AS audience_total_low_latency_last,
      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,
      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,
      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,
      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,
      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,
      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,
      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,
      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,
      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,
      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,
      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,
      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,
      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,
      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,
      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,
      audience_2k_last1 AS audience_2k_last,
      audience_4k_last1 AS audience_4k_last,
      audience_1080p_last1 AS audience_1080p_last,
      host_1080p_last1 AS host_1080p_last,
      host_2k_last1 AS host_2k_last,
      host_4k_last1 AS host_4k_last,
      total_last7,
      audio_last7,
      video_last7,
      video_sd_last7,
      video_hd_last7,
      video_hdp_last7,
      host_sd_last7,
      audience_sd_last7,
      host_hd_last7,
      audience_hd_last7,
      host_hdp_last7,
      audience_hdp_last7,
      host_audio_last7,
      audience_audio_last7,
      host_video_last7,
      audience_video_last7,
      audience_audio_low_latency_last7,
      audience_video_low_latency_last7,
      audience_total_low_latency_last7,
      audience_sd_low_latency_last7,
      audience_hd_low_latency_last7,
      audience_hdp_low_latency_last7,
      audience_1080p_low_latency_last7,
      audience_2k_low_latency_last7,
      audience_4k_low_latency_last7,
      audience_audio_ultra_low_latency_last7,
      audience_video_ultra_low_latency_last7,
      audience_total_ultra_low_latency_last7,
      audience_sd_ultra_low_latency_last7,
      audience_hd_ultra_low_latency_last7,
      audience_hdp_ultra_low_latency_last7,
      audience_1080p_ultra_low_latency_last7,
      audience_2k_ultra_low_latency_last7,
      audience_4k_ultra_low_latency_last7,
      audience_2k_last7,
      audience_4k_last7,
      audience_1080p_last7,
      host_1080p_last7,
      host_2k_last7,
      host_4k_last7
    FROM levels_usage_dod_di_1
    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-06') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-04') AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS ""自定义 SQL 查询""
  CROSS JOIN (SELECT MAX(date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d')) AS ""__measure__0""
    FROM (SELECT date,
            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,
          start_date AS start_date_7,
          end_date AS end_date,
          tag,
          area AS Scope,
          dim,
            CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,
          level2,
          level3,
          level4,
          product_level1 AS product_line,
          product_level2,
          product_level3,
          product_level4,
          vid_internal_industry_en AS cid_industry,
          vid_use_case_en AS vid_use_case_cn,
          vid_sector_en,
          ver_type,
          ver,
          os,
          domain,
          country,
          region,
          dim_grouping_name,
            CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,
          total AS totalUsage,
          audio,
          video,
          host_audio,
          audience_audio,
          host_sd,
          host_hd,
          host_hdp,
          host_1080p,
          host_2k,
          host_4k,
          audience_sd,
          audience_hd,
          audience_hdp,
          audience_1080p,
          audience_2k,
          audience_4k,
          audience_audio_low_latency,
          audience_sd_low_latency,
          audience_hd_low_latency,
          audience_hdp_low_latency,
          audience_1080p_low_latency,
          audience_2k_low_latency,
          audience_4k_low_latency,
          audience_audio_ultra_low_latency,
          audience_sd_ultra_low_latency,
          audience_hd_ultra_low_latency,
          audience_hdp_ultra_low_latency,
          audience_1080p_ultra_low_latency,
          audience_2k_ultra_low_latency,
          audience_4k_ultra_low_latency,
          total_last1 AS audio_video_last,
          audio_last1 AS audio_last,
          video_last1 AS video_last,
          video_sd_last1 AS video_sd_last,
          video_hd_last1 AS video_hd_last,
          video_hdp_last1 AS video_hdp_last,
          host_sd_last1 AS host_video_sd_last,
          audience_sd_last1 AS audience_video_sd_last,
          host_hd_last1 AS host_video_hd_last,
          audience_hd_last1 AS audience_video_hd_last,
          host_hdp_last1 AS host_video_hdp_last,
          audience_hdp_last1 AS audience_video_hdp_last,
          host_audio_last1 AS host_audio_last,
          audience_audio_last1 AS audience_audio_last,
          host_video_last1 AS host_video_last,
          audience_video_last1 AS audience_video_last,
          audience_audio_low_latency_last1 AS audience_audio_low_latency_last,
          audience_video_low_latency_last1 AS audience_video_low_latency_last,
          audience_total_low_latency_last1 AS audience_total_low_latency_last,
          audience_sd_low_latency_last1 AS audience_sd_low_latency_last,
          audience_hd_low_latency_last1 AS audience_hd_low_latency_last,
          audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,
          audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,
          audience_2k_low_latency_last1 AS audience_2k_low_latency_last,
          audience_4k_low_latency_last1 AS audience_4k_low_latency_last,
          audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,
          audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,
          audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,
          audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,
          audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,
          audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,
          audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,
          audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,
          audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,
          audience_2k_last1 AS audience_2k_last,
          audience_4k_last1 AS audience_4k_last,
          audience_1080p_last1 AS audience_1080p_last,
          host_1080p_last1 AS host_1080p_last,
          host_2k_last1 AS host_2k_last,
          host_4k_last1 AS host_4k_last,
          total_last7,
          audio_last7,
          video_last7,
          video_sd_last7,
          video_hd_last7,
          video_hdp_last7,
          host_sd_last7,
          audience_sd_last7,
          host_hd_last7,
          audience_hd_last7,
          host_hdp_last7,
          audience_hdp_last7,
          host_audio_last7,
          audience_audio_last7,
          host_video_last7,
          audience_video_last7,
          audience_audio_low_latency_last7,
          audience_video_low_latency_last7,
          audience_total_low_latency_last7,
          audience_sd_low_latency_last7,
          audience_hd_low_latency_last7,
          audience_hdp_low_latency_last7,
          audience_1080p_low_latency_last7,
          audience_2k_low_latency_last7,
          audience_4k_low_latency_last7,
          audience_audio_ultra_low_latency_last7,
          audience_video_ultra_low_latency_last7,
          audience_total_ultra_low_latency_last7,
          audience_sd_ultra_low_latency_last7,
          audience_hd_ultra_low_latency_last7,
          audience_hdp_ultra_low_latency_last7,
          audience_1080p_ultra_low_latency_last7,
          audience_2k_ultra_low_latency_last7,
          audience_4k_ultra_low_latency_last7,
          audience_2k_last7,
          audience_4k_last7,
          audience_1080p_last7,
          host_1080p_last7,
          host_2k_last7,
          host_4k_last7
        FROM levels_usage_dod_di_1
        WHERE CAST(tag AS VARCHAR) = 'Industry' AND date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-06') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-04') AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS ""自定义 SQL 查询""
    HAVING COUNT(1) > 0) AS ""t0""
WHERE ""自定义 SQL 查询"".""dim"" = 1 AND ""自定义 SQL 查询"".""rank_level1"" = 6 AND date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d') = ""t0"".""__measure__0""
GROUP BY 18,
  20"
"SELECT ""自定义 SQL 查询"".""product_level2"" AS ""product_level2"",
  SUM(""自定义 SQL 查询"".""total"") AS ""sum_total_ok""
FROM (SELECT date,
      SUBSTR(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) AS date_range_1,
      SUBSTR(CAST(end_date AS VARCHAR), 1, 10) AS date_range_2,
      stat_period,
        CASE WHEN CAST(stat_period AS VARCHAR) = 'day' THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,
      area,
      vid,
      project,
      company_id AS cid,
      company_name AS company,
      customer_level AS level,
      vid_internal_industry_en AS industry,
      vid_use_case_cn,
      csdc_owner,
      os,
      ver,
      ver_type,
      product_level1,
      product_level2,
      product_level3,
      total,
      audio,
      video,
      video_sd,
      video_hd,
      video_hdp,
        host_audio + host_video AS host,
      host_audio,
      host_video,
      host_sd,
      host_hd,
      host_hdp,
        audience_audio + audience_video AS audience,
        audience_audio_low_latency + audience_video_low_latency AS audience_low_latency,
      audience_audio,
      audience_audio_low_latency,
      audience_video,
      audience_video_low_latency,
      audience_sd,
      audience_sd_low_latency,
      audience_hd,
      audience_hd_low_latency,
      audience_hdp,
      audience_hdp_low_latency,
      total_last1,
      audio_last1,
      video_last1,
      video_sd_last1,
      video_hd_last1,
      video_hdp_last1,
        host_audio_last1 + host_video_last1 AS host_last1,
      host_audio_last1,
      host_video_last1,
        audience_audio_last1 + audience_video_last1 AS audience_last1,
        audience_audio_low_latency_last1 + audience_video_low_latency_last1 AS audience_low_latency_last1,
      audience_audio_last1,
      audience_audio_low_latency_last1,
      audience_video_last1,
      audience_video_low_latency_last1,
      total_last7,
      audio_last7,
      video_last7,
      video_sd_last7,
      video_hd_last7,
      video_hdp_last7,
        host_audio_last7 + host_video_last7 AS host_last7,
      host_audio_last7,
      host_video_last7,
        audience_audio_last7 + audience_video_last7 AS audience_last7,
        audience_audio_low_latency_last7 + audience_video_low_latency_last7 AS audience_low_latency_last7,
      audience_audio_last7,
      audience_audio_low_latency_last7,
      audience_video_last7,
      audience_video_low_latency_last7
    FROM report_datahub.vendor_vid_usage_di_1
    WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-06') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-06') AND CAST(vid AS VARCHAR) = CAST(428342 AS VARCHAR) AND dim = 1) AS ""自定义 SQL 查询""
GROUP BY 1"
"SELECT SUM(""自定义 SQL 查询"".""host_4k"") AS ""TEMP(Calculation_3519281700341563406)(1075454865)(0)"",
  SUM(""自定义 SQL 查询"".""audience_audio_last7"") AS ""TEMP(Calculation_3519281700341563406)(1077563395)(0)"",
  SUM(""自定义 SQL 查询"".""audience_sd"") AS ""TEMP(Calculation_3519281700341563406)(1133678835)(0)"",
  SUM(""自定义 SQL 查询"".""host_1080p"") AS ""TEMP(Calculation_3519281700341563406)(1312501967)(0)"",
  SUM(""自定义 SQL 查询"".""audience_sd_last7"") AS ""TEMP(Calculation_3519281700341563406)(1456465729)(0)"",
  SUM(""自定义 SQL 查询"".""host_hd_last7"") AS ""TEMP(Calculation_3519281700341563406)(1635749653)(0)"",
  SUM(""自定义 SQL 查询"".""audience_hd_last7"") AS ""TEMP(Calculation_3519281700341563406)(1747046964)(0)"",
  SUM(""自定义 SQL 查询"".""audience_2k_last7"") AS ""TEMP(Calculation_3519281700341563406)(1747524570)(0)"",
  SUM(""自定义 SQL 查询"".""host_hdp_last7"") AS ""TEMP(Calculation_3519281700341563406)(2044136109)(0)"",
  SUM(""自定义 SQL 查询"".""host_audio_last7"") AS ""TEMP(Calculation_3519281700341563406)(2464388580)(0)"",
  SUM(""自定义 SQL 查询"".""audio_last7"") AS ""TEMP(Calculation_3519281700341563406)(2589233512)(0)"",
  SUM(""自定义 SQL 查询"".""host_hd"") AS ""TEMP(Calculation_3519281700341563406)(276907208)(0)"",
  SUM(""自定义 SQL 查询"".""host_2k_last7"") AS ""TEMP(Calculation_3519281700341563406)(280796653)(0)"",
  SUM(""自定义 SQL 查询"".""video"") AS ""TEMP(Calculation_3519281700341563406)(2929708110)(0)"",
  SUM(""自定义 SQL 查询"".""audience_hd"") AS ""TEMP(Calculation_3519281700341563406)(2930728935)(0)"",
  SUM(""自定义 SQL 查询"".""audience_hdp"") AS ""TEMP(Calculation_3519281700341563406)(3010533957)(0)"",
  SUM(""自定义 SQL 查询"".""host_hdp"") AS ""TEMP(Calculation_3519281700341563406)(30306054)(0)"",
  SUM(""自定义 SQL 查询"".""host_audio"") AS ""TEMP(Calculation_3519281700341563406)(3087054365)(0)"",
  SUM(""自定义 SQL 查询"".""host_4k_last7"") AS ""TEMP(Calculation_3519281700341563406)(3127348545)(0)"",
  SUM(""自定义 SQL 查询"".""audio"") AS ""TEMP(Calculation_3519281700341563406)(3299350010)(0)"",
  SUM(""自定义 SQL 查询"".""total_last7"") AS ""TEMP(Calculation_3519281700341563406)(346677966)(0)"",
  SUM(""自定义 SQL 查询"".""audience_4k_last7"") AS ""TEMP(Calculation_3519281700341563406)(3543669678)(0)"",
  SUM(""自定义 SQL 查询"".""host_1080p_last7"") AS ""TEMP(Calculation_3519281700341563406)(3624983014)(0)"",
  SUM(""自定义 SQL 查询"".""audience_1080p"") AS ""TEMP(Calculation_3519281700341563406)(3628946582)(0)"",
  SUM(""自定义 SQL 查询"".""totalUsage"") AS ""TEMP(Calculation_3519281700341563406)(3847882359)(0)"",
  SUM(""自定义 SQL 查询"".""host_sd_last7"") AS ""TEMP(Calculation_3519281700341563406)(3905372418)(0)"",
  SUM(""自定义 SQL 查询"".""video_last7"") AS ""TEMP(Calculation_3519281700341563406)(4107040267)(0)"",
  SUM(""自定义 SQL 查询"".""audience_audio"") AS ""TEMP(Calculation_3519281700341563406)(4109514392)(0)"",
  SUM(""自定义 SQL 查询"".""host_2k"") AS ""TEMP(Calculation_3519281700341563406)(586790827)(0)"",
  SUM(""自定义 SQL 查询"".""audience_1080p_last7"") AS ""TEMP(Calculation_3519281700341563406)(632977665)(0)"",
  SUM(""自定义 SQL 查询"".""host_sd"") AS ""TEMP(Calculation_3519281700341563406)(709512178)(0)"",
  SUM(""自定义 SQL 查询"".""audience_hdp_last7"") AS ""TEMP(Calculation_3519281700341563406)(750340200)(0)"",
  SUM(""自定义 SQL 查询"".""audience_4k"") AS ""TEMP(Calculation_3519281700341563406)(764410224)(0)"",
  SUM(""自定义 SQL 查询"".""audience_2k"") AS ""TEMP(Calculation_3519281700341563406)(943764407)(0)"",
  ""自定义 SQL 查询"".""level1"" AS ""level1"",
  SUM(""自定义 SQL 查询"".""audio_video_last"") AS ""sum_audio_video_last_ok""
FROM (SELECT date,
        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,
      start_date AS start_date_7,
      end_date AS end_date,
      tag,
      area AS Scope,
      dim,
        CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,
      level2,
      level3,
      level4,
      product_level1 AS product_line,
      product_level2,
      product_level3,
      product_level4,
      vid_internal_industry_en AS cid_industry,
      vid_use_case_en AS vid_use_case_cn,
      vid_sector_en,
      ver_type,
      ver,
      os,
      domain,
      country,
      region,
      dim_grouping_name,
        CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,
      total AS totalUsage,
      audio,
      video,
      host_audio,
      audience_audio,
      host_sd,
      host_hd,
      host_hdp,
      host_1080p,
      host_2k,
      host_4k,
      audience_sd,
      audience_hd,
      audience_hdp,
      audience_1080p,
      audience_2k,
      audience_4k,
      audience_audio_low_latency,
      audience_sd_low_latency,
      audience_hd_low_latency,
      audience_hdp_low_latency,
      audience_1080p_low_latency,
      audience_2k_low_latency,
      audience_4k_low_latency,
      audience_audio_ultra_low_latency,
      audience_sd_ultra_low_latency,
      audience_hd_ultra_low_latency,
      audience_hdp_ultra_low_latency,
      audience_1080p_ultra_low_latency,
      audience_2k_ultra_low_latency,
      audience_4k_ultra_low_latency,
      total_last1 AS audio_video_last,
      audio_last1 AS audio_last,
      video_last1 AS video_last,
      video_sd_last1 AS video_sd_last,
      video_hd_last1 AS video_hd_last,
      video_hdp_last1 AS video_hdp_last,
      host_sd_last1 AS host_video_sd_last,
      audience_sd_last1 AS audience_video_sd_last,
      host_hd_last1 AS host_video_hd_last,
      audience_hd_last1 AS audience_video_hd_last,
      host_hdp_last1 AS host_video_hdp_last,
      audience_hdp_last1 AS audience_video_hdp_last,
      host_audio_last1 AS host_audio_last,
      audience_audio_last1 AS audience_audio_last,
      host_video_last1 AS host_video_last,
      audience_video_last1 AS audience_video_last,
      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,
      audience_video_low_latency_last1 AS audience_video_low_latency_last,
      audience_total_low_latency_last1 AS audience_total_low_latency_last,
      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,
      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,
      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,
      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,
      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,
      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,
      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,
      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,
      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,
      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,
      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,
      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,
      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,
      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,
      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,
      audience_2k_last1 AS audience_2k_last,
      audience_4k_last1 AS audience_4k_last,
      audience_1080p_last1 AS audience_1080p_last,
      host_1080p_last1 AS host_1080p_last,
      host_2k_last1 AS host_2k_last,
      host_4k_last1 AS host_4k_last,
      total_last7,
      audio_last7,
      video_last7,
      video_sd_last7,
      video_hd_last7,
      video_hdp_last7,
      host_sd_last7,
      audience_sd_last7,
      host_hd_last7,
      audience_hd_last7,
      host_hdp_last7,
      audience_hdp_last7,
      host_audio_last7,
      audience_audio_last7,
      host_video_last7,
      audience_video_last7,
      audience_audio_low_latency_last7,
      audience_video_low_latency_last7,
      audience_total_low_latency_last7,
      audience_sd_low_latency_last7,
      audience_hd_low_latency_last7,
      audience_hdp_low_latency_last7,
      audience_1080p_low_latency_last7,
      audience_2k_low_latency_last7,
      audience_4k_low_latency_last7,
      audience_audio_ultra_low_latency_last7,
      audience_video_ultra_low_latency_last7,
      audience_total_ultra_low_latency_last7,
      audience_sd_ultra_low_latency_last7,
      audience_hd_ultra_low_latency_last7,
      audience_hdp_ultra_low_latency_last7,
      audience_1080p_ultra_low_latency_last7,
      audience_2k_ultra_low_latency_last7,
      audience_4k_ultra_low_latency_last7,
      audience_2k_last7,
      audience_4k_last7,
      audience_1080p_last7,
      host_1080p_last7,
      host_2k_last7,
      host_4k_last7
    FROM levels_usage_dod_di_1
    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-06') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-04') AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS ""自定义 SQL 查询""
  CROSS JOIN (SELECT MAX(date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d')) AS ""__measure__0""
    FROM (SELECT date,
            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,
          start_date AS start_date_7,
          end_date AS end_date,
          tag,
          area AS Scope,
          dim,
            CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,
          level2,
          level3,
          level4,
          product_level1 AS product_line,
          product_level2,
          product_level3,
          product_level4,
          vid_internal_industry_en AS cid_industry,
          vid_use_case_en AS vid_use_case_cn,
          vid_sector_en,
          ver_type,
          ver,
          os,
          domain,
          country,
          region,
          dim_grouping_name,
            CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,
          total AS totalUsage,
          audio,
          video,
          host_audio,
          audience_audio,
          host_sd,
          host_hd,
          host_hdp,
          host_1080p,
          host_2k,
          host_4k,
          audience_sd,
          audience_hd,
          audience_hdp,
          audience_1080p,
          audience_2k,
          audience_4k,
          audience_audio_low_latency,
          audience_sd_low_latency,
          audience_hd_low_latency,
          audience_hdp_low_latency,
          audience_1080p_low_latency,
          audience_2k_low_latency,
          audience_4k_low_latency,
          audience_audio_ultra_low_latency,
          audience_sd_ultra_low_latency,
          audience_hd_ultra_low_latency,
          audience_hdp_ultra_low_latency,
          audience_1080p_ultra_low_latency,
          audience_2k_ultra_low_latency,
          audience_4k_ultra_low_latency,
          total_last1 AS audio_video_last,
          audio_last1 AS audio_last,
          video_last1 AS video_last,
          video_sd_last1 AS video_sd_last,
          video_hd_last1 AS video_hd_last,
          video_hdp_last1 AS video_hdp_last,
          host_sd_last1 AS host_video_sd_last,
          audience_sd_last1 AS audience_video_sd_last,
          host_hd_last1 AS host_video_hd_last,
          audience_hd_last1 AS audience_video_hd_last,
          host_hdp_last1 AS host_video_hdp_last,
          audience_hdp_last1 AS audience_video_hdp_last,
          host_audio_last1 AS host_audio_last,
          audience_audio_last1 AS audience_audio_last,
          host_video_last1 AS host_video_last,
          audience_video_last1 AS audience_video_last,
          audience_audio_low_latency_last1 AS audience_audio_low_latency_last,
          audience_video_low_latency_last1 AS audience_video_low_latency_last,
          audience_total_low_latency_last1 AS audience_total_low_latency_last,
          audience_sd_low_latency_last1 AS audience_sd_low_latency_last,
          audience_hd_low_latency_last1 AS audience_hd_low_latency_last,
          audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,
          audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,
          audience_2k_low_latency_last1 AS audience_2k_low_latency_last,
          audience_4k_low_latency_last1 AS audience_4k_low_latency_last,
          audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,
          audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,
          audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,
          audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,
          audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,
          audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,
          audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,
          audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,
          audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,
          audience_2k_last1 AS audience_2k_last,
          audience_4k_last1 AS audience_4k_last,
          audience_1080p_last1 AS audience_1080p_last,
          host_1080p_last1 AS host_1080p_last,
          host_2k_last1 AS host_2k_last,
          host_4k_last1 AS host_4k_last,
          total_last7,
          audio_last7,
          video_last7,
          video_sd_last7,
          video_hd_last7,
          video_hdp_last7,
          host_sd_last7,
          audience_sd_last7,
          host_hd_last7,
          audience_hd_last7,
          host_hdp_last7,
          audience_hdp_last7,
          host_audio_last7,
          audience_audio_last7,
          host_video_last7,
          audience_video_last7,
          audience_audio_low_latency_last7,
          audience_video_low_latency_last7,
          audience_total_low_latency_last7,
          audience_sd_low_latency_last7,
          audience_hd_low_latency_last7,
          audience_hdp_low_latency_last7,
          audience_1080p_low_latency_last7,
          audience_2k_low_latency_last7,
          audience_4k_low_latency_last7,
          audience_audio_ultra_low_latency_last7,
          audience_video_ultra_low_latency_last7,
          audience_total_ultra_low_latency_last7,
          audience_sd_ultra_low_latency_last7,
          audience_hd_ultra_low_latency_last7,
          audience_hdp_ultra_low_latency_last7,
          audience_1080p_ultra_low_latency_last7,
          audience_2k_ultra_low_latency_last7,
          audience_4k_ultra_low_latency_last7,
          audience_2k_last7,
          audience_4k_last7,
          audience_1080p_last7,
          host_1080p_last7,
          host_2k_last7,
          host_4k_last7
        FROM levels_usage_dod_di_1
        WHERE CAST(tag AS VARCHAR) = 'Industry' AND date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-06') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-04') AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS ""自定义 SQL 查询""
    HAVING COUNT(1) > 0) AS ""t0""
WHERE ""自定义 SQL 查询"".""dim"" = 1 AND ""自定义 SQL 查询"".""rank_level1"" = 1 AND date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d') = ""t0"".""__measure__0""
GROUP BY 35"
"SELECT SUM(""自定义 SQL 查询"".""s2l_25ms_delay_sec"") AS ""TEMP(Calculation_1430244791154503680)(2227145667)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_total_delay_sec"") AS ""TEMP(Calculation_1430244791154503680)(2460078802)(0)"",
  SUM(""自定义 SQL 查询"".""5s_succ_join_ap_cnt"") AS ""TEMP(Calculation_1430244791247978510)(1716451703)(0)"",
  SUM(""自定义 SQL 查询"".""total_join_ap_cnt"") AS ""TEMP(Calculation_1430244791247978510)(2681092799)(0)"",
  SUM(""自定义 SQL 查询"".""video_totaltime_200"") AS ""TEMP(Calculation_2810035073237950465)(2104207895)(0)"",
  SUM(""自定义 SQL 查询"".""video_freeze_time_200"") AS ""TEMP(Calculation_2810035073237950465)(530162565)(0)"",
  SUM(""自定义 SQL 查询"".""totalJoin"") AS ""TEMP(Calculation_374009936508170240)(2073556184)(0)"",
  SUM(""自定义 SQL 查询"".""totalJoinSuccess"") AS ""TEMP(Calculation_374009936508170240)(2807417001)(0)"",
  SUM(""自定义 SQL 查询"".""threeSecJoinSuccess"") AS ""TEMP(Calculation_374009936508321793)(3693645608)(0)"",
  SUM(""自定义 SQL 查询"".""fiveSecJoinSuccess"") AS ""TEMP(Calculation_374009936508416002)(383616769)(0)"",
  SUM(""自定义 SQL 查询"".""video_totaltime"") AS ""TEMP(Calculation_374009936515215363)(2797449586)(0)"",
  SUM(""自定义 SQL 查询"".""video_freeze_time"") AS ""TEMP(Calculation_374009936515215363)(2940759860)(0)"",
  SUM(""自定义 SQL 查询"".""audio_totaltime"") AS ""TEMP(Calculation_374009936517861380)(1652566750)(0)"",
  SUM(""自定义 SQL 查询"".""audio_freeze_time"") AS ""TEMP(Calculation_374009936517861380)(2919389392)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_lost_Leq5"") AS ""TEMP(Calculation_374009936519704581)(1936123547)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_lost_all"") AS ""TEMP(Calculation_374009936519704581)(749826584)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_75ms_delay_sec"") AS ""TEMP(Calculation_6542393318886285312)(2003933318)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_lost_Leq5"") AS ""TEMP(Calculation_7034341207026868236)(2745840127)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_lost_all"") AS ""TEMP(Calculation_7034341207026868236)(734589263)(0)"",
  SUM(""自定义 SQL 查询"".""crash_cnt"") AS ""TEMP(Calculation_7034341207372070925)(2360900687)(0)"",
  SUM(""自定义 SQL 查询"".""service_cnt"") AS ""TEMP(Calculation_7034341207372070925)(4291252132)(0)"",
  DATE_ADD('SECOND', 0, date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d')) AS ""tdy_date_ok""
FROM (SELECT date,
        CASE WHEN CAST(stat_period AS VARCHAR) = 'day' THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(substr(CAST(start_date AS VARCHAR), 1, 10) AS VARCHAR), '~', CAST(substr(CAST(end_date AS VARCHAR), 1, 10) AS VARCHAR)) END AS period,
      start_date,
      end_date,
      stat_period,
      tag,
      dim,
      level1,
      level2,
      level3,
      level4,
      '' AS pd,
      os,
      ver,
      ver_type,
      '' AS product_line,
      '' AS product_type,
      domain,
      country,
      region,
      net,
      vid,
      project,
      company_id,
      company_name,
      rowsnum,
      lastusage,
      thisusage,
      fiveSecJoinSuccess,
      totalJoin,
      cnt_sid,
      video_freeze_time,
      video_totaltime,
      audio_freeze_time,
      audio_totaltime,
      s2l_total_delay_sec,
      s2l_25ms_delay_sec,
      s2l_75ms_delay_sec,
      p2s_lost_Leq5,
      p2s_lost_all,
      crash_cnt,
      service_cnt,
      ""1s_succ_join_ap_cnt"",
      ""5s_succ_join_ap_cnt"",
      total_join_ap_cnt,
      totalJoinSuccess,
      threeSecJoinSuccess,
      video_freeze_time_200,
      video_totaltime_200,
      video_freeze_time_500,
      video_totaltime_500,
      ""3s_succ_join_session_cnt_last1"",
      ""5s_succ_join_session_cnt_last1"",
      succ_join_session_cnt_last1,
      total_join_session_cnt_last1,
      total_session_cnt_last1,
      ""1s_succ_join_ap_cnt_last1"",
      ""5s_succ_join_ap_cnt_last1"",
      total_join_ap_cnt_last1,
      ""3s_succ_join_session_cnt_last7"",
      ""5s_succ_join_session_cnt_last7"",
      succ_join_session_cnt_last7,
      total_join_session_cnt_last7,
      total_session_cnt_last7,
      ""1s_succ_join_ap_cnt_last7"",
      ""5s_succ_join_ap_cnt_last7"",
      total_join_ap_cnt_last7,
      video_freeze_time_last1,
      video_totaltime_last1,
      video_freeze_time_500_last1,
      video_totaltime_500_last1,
      video_freeze_time_200_last1,
      video_totaltime_200_last1,
      video_freeze_time_last7,
      video_totaltime_last7,
      video_freeze_time_500_last7,
      video_totaltime_500_last7,
      video_freeze_time_200_last7,
      video_totaltime_200_last7,
      audio_freeze_time_last1,
      audio_totaltime_last1,
      audio_freeze_time_last7,
      audio_totaltime_last7,
      s2l_total_delay_sec_last1,
      s2l_25ms_delay_sec_last1,
      s2l_75ms_delay_sec_last1,
      s2l_total_delay_sec_last7,
      s2l_25ms_delay_sec_last7,
      s2l_75ms_delay_sec_last7,
      p2s_lost_Leq5_last1,
      p2s_lost_all_last1,
      p2s_lost_Leq5_last7,
      p2s_lost_all_last7,
      crash_cnt_last1,
      service_cnt_last1,
      crash_cnt_last7,
      service_cnt_last7,
      product_level1,
      product_level2,
      product_level3,
      product_level4,
      s2l_lost_Leq5,
      s2l_lost_all,
      s2l_lost_Leq5_last1,
      s2l_lost_all_last1,
      s2l_lost_Leq5_last7,
      s2l_lost_all_last7
    FROM report_datahub.pub_levels_quality_di_1
    WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-21') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-11-21')) AS ""自定义 SQL 查询""
WHERE CASE WHEN CAST(""自定义 SQL 查询"".""tag"" AS VARCHAR) = 'Industry' AND CAST(""自定义 SQL 查询"".""product_level1"" AS VARCHAR) = 'RTC' AND CAST(""自定义 SQL 查询"".""dim"" AS VARCHAR) = 'osver' THEN 0 WHEN CAST(""自定义 SQL 查询"".""tag"" AS VARCHAR) = 'VerType' AND CAST(""自定义 SQL 查询"".""product_level1"" AS VARCHAR) = 'RTC' AND CAST(""自定义 SQL 查询"".""dim"" AS VARCHAR) = 'osver' THEN 0 WHEN CAST(""自定义 SQL 查询"".""tag"" AS VARCHAR) = 'Product' AND CAST(""自定义 SQL 查询"".""product_level1"" AS VARCHAR) = 'RTC' AND CAST(""自定义 SQL 查询"".""dim"" AS VARCHAR) = 'osver' THEN 1 ELSE 0 END
GROUP BY 22"
"SELECT ""自定义 SQL 查询"".""idc"" AS ""idc""
FROM (SELECT date AS ""date"",
      src_domain AS ""srcDomain"",
      src_region AS ""srcRegion"",
      dest_idc AS ""idc"",
      delay_25 AS ""p2s_Delay25"",
      delay_50 AS ""p2s_Delay50"",
      delay_75 AS ""p2s_Delay75"",
      delay_100 AS ""p2s_Delay100"",
      delay_125 AS ""p2s_Delay125"",
      delay_150 AS ""p2s_Delay150"",
      delay_total,
      lost_ratio_5 AS ""p2s_lostRatio"",
      lostratio_total AS ""p2s_total"",
      jitter95_50 AS ""p2s_jitter95_50"",
      jitter95_100 AS ""p2s_jitter95_100"",
      jitter95_200 AS ""p2s_jitter95_200"",
      jitter95_300 AS ""p2s_jitter95_300"",
      jitter95_total,
      product_line,
      product_type
    FROM media.p2s_cover_mainland_ip
    WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-25') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-01')) AS ""自定义 SQL 查询""
GROUP BY 1
LIMIT 256"
"SELECT SUM(""自定义 SQL 查询"".""s2l_25ms_delay_sec"") AS ""TEMP(Calculation_1430244791154503680)(2227145667)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_total_delay_sec"") AS ""TEMP(Calculation_1430244791154503680)(2460078802)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_total_delay_sec_last1"") AS ""TEMP(Calculation_1430244791161831425)(1533897333)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_25ms_delay_sec_last1"") AS ""TEMP(Calculation_1430244791161831425)(3105382701)(0)"",
  SUM(""自定义 SQL 查询"".""5s_succ_join_ap_cnt"") AS ""TEMP(Calculation_1430244791247978510)(1716451703)(0)"",
  SUM(""自定义 SQL 查询"".""total_join_ap_cnt"") AS ""TEMP(Calculation_1430244791247978510)(2681092799)(0)"",
  SUM(""自定义 SQL 查询"".""5s_succ_join_ap_cnt_last1"") AS ""TEMP(Calculation_1430244791248527375)(865560869)(0)"",
  SUM(""自定义 SQL 查询"".""total_join_ap_cnt_last1"") AS ""TEMP(Calculation_1430244791248527375)(97423155)(0)"",
  SUM(""自定义 SQL 查询"".""video_freeze_time_500"") AS ""TEMP(Calculation_2810035073237774336)(389023081)(0)"",
  SUM(""自定义 SQL 查询"".""video_totaltime_500"") AS ""TEMP(Calculation_2810035073237774336)(458654145)(0)"",
  SUM(""自定义 SQL 查询"".""video_totaltime_200"") AS ""TEMP(Calculation_2810035073237950465)(2104207895)(0)"",
  SUM(""自定义 SQL 查询"".""video_freeze_time_200"") AS ""TEMP(Calculation_2810035073237950465)(530162565)(0)"",
  SUM(""自定义 SQL 查询"".""video_totaltime_200_last1"") AS ""TEMP(Calculation_2810035073238130690)(1909093697)(0)"",
  SUM(""自定义 SQL 查询"".""video_freeze_time_200_last1"") AS ""TEMP(Calculation_2810035073238130690)(356123728)(0)"",
  SUM(""自定义 SQL 查询"".""video_freeze_time_200_last7"") AS ""TEMP(Calculation_2810035073238458371)(1003246719)(0)"",
  SUM(""自定义 SQL 查询"".""video_totaltime_200_last7"") AS ""TEMP(Calculation_2810035073238458371)(3922744675)(0)"",
  SUM(""自定义 SQL 查询"".""video_totaltime_500_last1"") AS ""TEMP(Calculation_2810035073238695940)(3425883446)(0)"",
  SUM(""自定义 SQL 查询"".""video_freeze_time_500_last1"") AS ""TEMP(Calculation_2810035073238695940)(3450234468)(0)"",
  SUM(""自定义 SQL 查询"".""video_freeze_time_500_last7"") AS ""TEMP(Calculation_2810035073239027717)(1458194667)(0)"",
  SUM(""自定义 SQL 查询"".""video_totaltime_500_last7"") AS ""TEMP(Calculation_2810035073239027717)(2161412938)(0)"",
  SUM(""自定义 SQL 查询"".""totalJoin"") AS ""TEMP(Calculation_374009936508170240)(2073556184)(0)"",
  SUM(""自定义 SQL 查询"".""totalJoinSuccess"") AS ""TEMP(Calculation_374009936508170240)(2807417001)(0)"",
  SUM(""自定义 SQL 查询"".""threeSecJoinSuccess"") AS ""TEMP(Calculation_374009936508321793)(3693645608)(0)"",
  SUM(""自定义 SQL 查询"".""fiveSecJoinSuccess"") AS ""TEMP(Calculation_374009936508416002)(383616769)(0)"",
  SUM(""自定义 SQL 查询"".""video_totaltime"") AS ""TEMP(Calculation_374009936515215363)(2797449586)(0)"",
  SUM(""自定义 SQL 查询"".""video_freeze_time"") AS ""TEMP(Calculation_374009936515215363)(2940759860)(0)"",
  SUM(""自定义 SQL 查询"".""audio_totaltime"") AS ""TEMP(Calculation_374009936517861380)(1652566750)(0)"",
  SUM(""自定义 SQL 查询"".""audio_freeze_time"") AS ""TEMP(Calculation_374009936517861380)(2919389392)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_lost_Leq5"") AS ""TEMP(Calculation_374009936519704581)(1936123547)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_lost_all"") AS ""TEMP(Calculation_374009936519704581)(749826584)(0)"",
  SUM(""自定义 SQL 查询"".""total_join_session_cnt_last1"") AS ""TEMP(Calculation_374009936523853831)(2708102775)(0)"",
  SUM(""自定义 SQL 查询"".""succ_join_session_cnt_last1"") AS ""TEMP(Calculation_374009936523853831)(929207889)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_75ms_delay_sec"") AS ""TEMP(Calculation_6542393318886285312)(2003933318)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_total_delay_sec_last1"") AS ""TEMP(Calculation_6542393318886735875)(3088956105)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_75ms_delay_sec_last1"") AS ""TEMP(Calculation_6542393318886735875)(602483182)(0)"",
  SUM(""自定义 SQL 查询"".""3s_succ_join_session_cnt_last1"") AS ""TEMP(Calculation_7034341207020355584)(2445597373)(0)"",
  SUM(""自定义 SQL 查询"".""5s_succ_join_session_cnt_last1"") AS ""TEMP(Calculation_7034341207023706114)(2534022291)(0)"",
  SUM(""自定义 SQL 查询"".""video_totaltime_last1"") AS ""TEMP(Calculation_7034341207025315846)(1221500367)(0)"",
  SUM(""自定义 SQL 查询"".""video_freeze_time_last1"") AS ""TEMP(Calculation_7034341207025315846)(3506758486)(0)"",
  SUM(""自定义 SQL 查询"".""audio_totaltime_last1"") AS ""TEMP(Calculation_7034341207025774600)(803828507)(0)"",
  SUM(""自定义 SQL 查询"".""audio_freeze_time_last1"") AS ""TEMP(Calculation_7034341207025774600)(877259553)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_lost_Leq5"") AS ""TEMP(Calculation_7034341207026102282)(2745840127)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_lost_all_last1"") AS ""TEMP(Calculation_7034341207026102282)(3348338895)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_lost_Leq5_last1"") AS ""TEMP(Calculation_7034341207026102282)(700826822)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_lost_all"") AS ""TEMP(Calculation_7034341207026102282)(734589263)(0)"",
  SUM(""自定义 SQL 查询"".""crash_cnt"") AS ""TEMP(Calculation_7034341207372070925)(2360900687)(0)"",
  SUM(""自定义 SQL 查询"".""service_cnt"") AS ""TEMP(Calculation_7034341207372070925)(4291252132)(0)"",
  SUM(""自定义 SQL 查询"".""service_cnt_last1"") AS ""TEMP(Calculation_7034341207372197902)(2436060403)(0)"",
  SUM(""自定义 SQL 查询"".""crash_cnt_last1"") AS ""TEMP(Calculation_7034341207372197902)(651130603)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_lost_all_last1"") AS ""TEMP(Calculation_75998310509129730)(1975694301)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_lost_Leq5_last1"") AS ""TEMP(Calculation_75998310509129730)(1982054307)(0)""
FROM (SELECT date,
        CASE WHEN CAST(stat_period AS VARCHAR) = 'day' THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(substr(CAST(start_date AS VARCHAR), 1, 10) AS VARCHAR), '~', CAST(substr(CAST(end_date AS VARCHAR), 1, 10) AS VARCHAR)) END AS period,
      start_date,
      end_date,
      stat_period,
      tag,
      dim,
      level1,
      level2,
      level3,
      level4,
      '' AS pd,
      os,
      ver,
      ver_type,
      '' AS product_line,
      '' AS product_type,
      domain,
      country,
      region,
      net,
      vid,
      project,
      company_id,
      company_name,
      rowsnum,
      lastusage,
      thisusage,
      fiveSecJoinSuccess,
      totalJoin,
      cnt_sid,
      video_freeze_time,
      video_totaltime,
      audio_freeze_time,
      audio_totaltime,
      s2l_total_delay_sec,
      s2l_25ms_delay_sec,
      s2l_75ms_delay_sec,
      p2s_lost_Leq5,
      p2s_lost_all,
      crash_cnt,
      service_cnt,
      ""1s_succ_join_ap_cnt"",
      ""5s_succ_join_ap_cnt"",
      total_join_ap_cnt,
      totalJoinSuccess,
      threeSecJoinSuccess,
      video_freeze_time_200,
      video_totaltime_200,
      video_freeze_time_500,
      video_totaltime_500,
      ""3s_succ_join_session_cnt_last1"",
      ""5s_succ_join_session_cnt_last1"",
      succ_join_session_cnt_last1,
      total_join_session_cnt_last1,
      total_session_cnt_last1,
      ""1s_succ_join_ap_cnt_last1"",
      ""5s_succ_join_ap_cnt_last1"",
      total_join_ap_cnt_last1,
      ""3s_succ_join_session_cnt_last7"",
      ""5s_succ_join_session_cnt_last7"",
      succ_join_session_cnt_last7,
      total_join_session_cnt_last7,
      total_session_cnt_last7,
      ""1s_succ_join_ap_cnt_last7"",
      ""5s_succ_join_ap_cnt_last7"",
      total_join_ap_cnt_last7,
      video_freeze_time_last1,
      video_totaltime_last1,
      video_freeze_time_500_last1,
      video_totaltime_500_last1,
      video_freeze_time_200_last1,
      video_totaltime_200_last1,
      video_freeze_time_last7,
      video_totaltime_last7,
      video_freeze_time_500_last7,
      video_totaltime_500_last7,
      video_freeze_time_200_last7,
      video_totaltime_200_last7,
      audio_freeze_time_last1,
      audio_totaltime_last1,
      audio_freeze_time_last7,
      audio_totaltime_last7,
      s2l_total_delay_sec_last1,
      s2l_25ms_delay_sec_last1,
      s2l_75ms_delay_sec_last1,
      s2l_total_delay_sec_last7,
      s2l_25ms_delay_sec_last7,
      s2l_75ms_delay_sec_last7,
      p2s_lost_Leq5_last1,
      p2s_lost_all_last1,
      p2s_lost_Leq5_last7,
      p2s_lost_all_last7,
      crash_cnt_last1,
      service_cnt_last1,
      crash_cnt_last7,
      service_cnt_last7,
      product_level1,
      product_level2,
      product_level3,
      product_level4,
      s2l_lost_Leq5,
      s2l_lost_all,
      s2l_lost_Leq5_last1,
      s2l_lost_all_last1,
      s2l_lost_Leq5_last7,
      s2l_lost_all_last7
    FROM report_datahub.pub_levels_quality_di_1
    WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-21') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-05')) AS ""自定义 SQL 查询""
  CROSS JOIN (SELECT MAX(date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d')) AS ""__measure__0""
    FROM (SELECT date,
            CASE WHEN CAST(stat_period AS VARCHAR) = 'day' THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(substr(CAST(start_date AS VARCHAR), 1, 10) AS VARCHAR), '~', CAST(substr(CAST(end_date AS VARCHAR), 1, 10) AS VARCHAR)) END AS period,
          start_date,
          end_date,
          stat_period,
          tag,
          dim,
          level1,
          level2,
          level3,
          level4,
          '' AS pd,
          os,
          ver,
          ver_type,
          '' AS product_line,
          '' AS product_type,
          domain,
          country,
          region,
          net,
          vid,
          project,
          company_id,
          company_name,
          rowsnum,
          lastusage,
          thisusage,
          fiveSecJoinSuccess,
          totalJoin,
          cnt_sid,
          video_freeze_time,
          video_totaltime,
          audio_freeze_time,
          audio_totaltime,
          s2l_total_delay_sec,
          s2l_25ms_delay_sec,
          s2l_75ms_delay_sec,
          p2s_lost_Leq5,
          p2s_lost_all,
          crash_cnt,
          service_cnt,
          ""1s_succ_join_ap_cnt"",
          ""5s_succ_join_ap_cnt"",
          total_join_ap_cnt,
          totalJoinSuccess,
          threeSecJoinSuccess,
          video_freeze_time_200,
          video_totaltime_200,
          video_freeze_time_500,
          video_totaltime_500,
          ""3s_succ_join_session_cnt_last1"",
          ""5s_succ_join_session_cnt_last1"",
          succ_join_session_cnt_last1,
          total_join_session_cnt_last1,
          total_session_cnt_last1,
          ""1s_succ_join_ap_cnt_last1"",
          ""5s_succ_join_ap_cnt_last1"",
          total_join_ap_cnt_last1,
          ""3s_succ_join_session_cnt_last7"",
          ""5s_succ_join_session_cnt_last7"",
          succ_join_session_cnt_last7,
          total_join_session_cnt_last7,
          total_session_cnt_last7,
          ""1s_succ_join_ap_cnt_last7"",
          ""5s_succ_join_ap_cnt_last7"",
          total_join_ap_cnt_last7,
          video_freeze_time_last1,
          video_totaltime_last1,
          video_freeze_time_500_last1,
          video_totaltime_500_last1,
          video_freeze_time_200_last1,
          video_totaltime_200_last1,
          video_freeze_time_last7,
          video_totaltime_last7,
          video_freeze_time_500_last7,
          video_totaltime_500_last7,
          video_freeze_time_200_last7,
          video_totaltime_200_last7,
          audio_freeze_time_last1,
          audio_totaltime_last1,
          audio_freeze_time_last7,
          audio_totaltime_last7,
          s2l_total_delay_sec_last1,
          s2l_25ms_delay_sec_last1,
          s2l_75ms_delay_sec_last1,
          s2l_total_delay_sec_last7,
          s2l_25ms_delay_sec_last7,
          s2l_75ms_delay_sec_last7,
          p2s_lost_Leq5_last1,
          p2s_lost_all_last1,
          p2s_lost_Leq5_last7,
          p2s_lost_all_last7,
          crash_cnt_last1,
          service_cnt_last1,
          crash_cnt_last7,
          service_cnt_last7,
          product_level1,
          product_level2,
          product_level3,
          product_level4,
          s2l_lost_Leq5,
          s2l_lost_all,
          s2l_lost_Leq5_last1,
          s2l_lost_all_last1,
          s2l_lost_Leq5_last7,
          s2l_lost_all_last7
        FROM report_datahub.pub_levels_quality_di_1
        WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-21') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-05')) AS ""自定义 SQL 查询""
    HAVING COUNT(1) > 0) AS ""t0""
WHERE CASE WHEN CAST(""自定义 SQL 查询"".""tag"" AS VARCHAR) = 'Industry' AND CAST(""自定义 SQL 查询"".""product_level1"" AS VARCHAR) = 'RTC' AND CAST(""自定义 SQL 查询"".""dim"" AS VARCHAR) = 'osver' THEN 0 WHEN CAST(""自定义 SQL 查询"".""tag"" AS VARCHAR) = 'VerType' AND CAST(""自定义 SQL 查询"".""product_level1"" AS VARCHAR) = 'RTC' AND CAST(""自定义 SQL 查询"".""dim"" AS VARCHAR) = 'osver' THEN 0 WHEN CAST(""自定义 SQL 查询"".""tag"" AS VARCHAR) = 'Product' AND CAST(""自定义 SQL 查询"".""product_level1"" AS VARCHAR) = 'RTC' AND CAST(""自定义 SQL 查询"".""dim"" AS VARCHAR) = 'osver' THEN 1 ELSE 0 END AND DATE_ADD('SECOND', 0, date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d')) = DATE_ADD('SECOND', 0, ""t0"".""__measure__0"")
HAVING COUNT(1) > 0"
"SELECT ""自定义 SQL 查询"".""product_level1"" AS ""product_level1""
FROM (SELECT date,
      SUBSTR(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) AS date_range_1,
      SUBSTR(CAST(end_date AS VARCHAR), 1, 10) AS date_range_2,
      stat_period,
        CASE WHEN CAST(stat_period AS VARCHAR) = 'day' THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,
      area,
      vid,
      project,
      company_id AS cid,
      company_name AS company,
      customer_level AS level,
      vid_internal_industry_en AS industry,
      vid_use_case_cn,
      csdc_owner,
      os,
      ver,
      ver_type,
      product_level1,
      product_level2,
      product_level3,
      total,
      audio,
      video,
      video_sd,
      video_hd,
      video_hdp,
        host_audio + host_video AS host,
      host_audio,
      host_video,
      host_sd,
      host_hd,
      host_hdp,
        audience_audio + audience_video AS audience,
        audience_audio_low_latency + audience_video_low_latency AS audience_low_latency,
      audience_audio,
      audience_audio_low_latency,
      audience_video,
      audience_video_low_latency,
      audience_sd,
      audience_sd_low_latency,
      audience_hd,
      audience_hd_low_latency,
      audience_hdp,
      audience_hdp_low_latency,
      total_last1,
      audio_last1,
      video_last1,
      video_sd_last1,
      video_hd_last1,
      video_hdp_last1,
        host_audio_last1 + host_video_last1 AS host_last1,
      host_audio_last1,
      host_video_last1,
        audience_audio_last1 + audience_video_last1 AS audience_last1,
        audience_audio_low_latency_last1 + audience_video_low_latency_last1 AS audience_low_latency_last1,
      audience_audio_last1,
      audience_audio_low_latency_last1,
      audience_video_last1,
      audience_video_low_latency_last1,
      total_last7,
      audio_last7,
      video_last7,
      video_sd_last7,
      video_hd_last7,
      video_hdp_last7,
        host_audio_last7 + host_video_last7 AS host_last7,
      host_audio_last7,
      host_video_last7,
        audience_audio_last7 + audience_video_last7 AS audience_last7,
        audience_audio_low_latency_last7 + audience_video_low_latency_last7 AS audience_low_latency_last7,
      audience_audio_last7,
      audience_audio_low_latency_last7,
      audience_video_last7,
      audience_video_low_latency_last7
    FROM report_datahub.vendor_vid_usage_di_1
    WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-06') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-06') AND CAST(vid AS VARCHAR) = CAST(311291 AS VARCHAR) AND dim = 1) AS ""自定义 SQL 查询""
GROUP BY 1
ORDER BY ""product_level1"""
"SELECT ""自定义 SQL 查询"".""level2"" AS ""level2""
FROM (SELECT date,
        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,
      start_date AS start_date_7,
      end_date AS end_date,
      tag,
      area AS Scope,
      dim,
        CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,
      level2,
      level3,
      level4,
      product_level1 AS product_line,
      product_level2,
      product_level3,
      product_level4,
      vid_internal_industry_en AS cid_industry,
      vid_use_case_en AS vid_use_case_cn,
      vid_sector_en,
      ver_type,
      ver,
      os,
      domain,
      country,
      region,
      dim_grouping_name,
        CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,
      total AS totalUsage,
      audio,
      video,
      host_audio,
      audience_audio,
      host_sd,
      host_hd,
      host_hdp,
      host_1080p,
      host_2k,
      host_4k,
      audience_sd,
      audience_hd,
      audience_hdp,
      audience_1080p,
      audience_2k,
      audience_4k,
      audience_audio_low_latency,
      audience_sd_low_latency,
      audience_hd_low_latency,
      audience_hdp_low_latency,
      audience_1080p_low_latency,
      audience_2k_low_latency,
      audience_4k_low_latency,
      audience_audio_ultra_low_latency,
      audience_sd_ultra_low_latency,
      audience_hd_ultra_low_latency,
      audience_hdp_ultra_low_latency,
      audience_1080p_ultra_low_latency,
      audience_2k_ultra_low_latency,
      audience_4k_ultra_low_latency,
      total_last1 AS audio_video_last,
      audio_last1 AS audio_last,
      video_last1 AS video_last,
      video_sd_last1 AS video_sd_last,
      video_hd_last1 AS video_hd_last,
      video_hdp_last1 AS video_hdp_last,
      host_sd_last1 AS host_video_sd_last,
      audience_sd_last1 AS audience_video_sd_last,
      host_hd_last1 AS host_video_hd_last,
      audience_hd_last1 AS audience_video_hd_last,
      host_hdp_last1 AS host_video_hdp_last,
      audience_hdp_last1 AS audience_video_hdp_last,
      host_audio_last1 AS host_audio_last,
      audience_audio_last1 AS audience_audio_last,
      host_video_last1 AS host_video_last,
      audience_video_last1 AS audience_video_last,
      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,
      audience_video_low_latency_last1 AS audience_video_low_latency_last,
      audience_total_low_latency_last1 AS audience_total_low_latency_last,
      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,
      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,
      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,
      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,
      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,
      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,
      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,
      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,
      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,
      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,
      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,
      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,
      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,
      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,
      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,
      audience_2k_last1 AS audience_2k_last,
      audience_4k_last1 AS audience_4k_last,
      audience_1080p_last1 AS audience_1080p_last,
      host_1080p_last1 AS host_1080p_last,
      host_2k_last1 AS host_2k_last,
      host_4k_last1 AS host_4k_last,
      total_last7,
      audio_last7,
      video_last7,
      video_sd_last7,
      video_hd_last7,
      video_hdp_last7,
      host_sd_last7,
      audience_sd_last7,
      host_hd_last7,
      audience_hd_last7,
      host_hdp_last7,
      audience_hdp_last7,
      host_audio_last7,
      audience_audio_last7,
      host_video_last7,
      audience_video_last7,
      audience_audio_low_latency_last7,
      audience_video_low_latency_last7,
      audience_total_low_latency_last7,
      audience_sd_low_latency_last7,
      audience_hd_low_latency_last7,
      audience_hdp_low_latency_last7,
      audience_1080p_low_latency_last7,
      audience_2k_low_latency_last7,
      audience_4k_low_latency_last7,
      audience_audio_ultra_low_latency_last7,
      audience_video_ultra_low_latency_last7,
      audience_total_ultra_low_latency_last7,
      audience_sd_ultra_low_latency_last7,
      audience_hd_ultra_low_latency_last7,
      audience_hdp_ultra_low_latency_last7,
      audience_1080p_ultra_low_latency_last7,
      audience_2k_ultra_low_latency_last7,
      audience_4k_ultra_low_latency_last7,
      audience_2k_last7,
      audience_4k_last7,
      audience_1080p_last7,
      host_1080p_last7,
      host_2k_last7,
      host_4k_last7
    FROM levels_usage_dod_di_1
    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-06') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-04') AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS ""自定义 SQL 查询""
GROUP BY 1
ORDER BY ""level2"""
"SELECT '跳转：音频可用性' AS ""Calculation_5876704998653468673""
FROM (SELECT date,
        CASE WHEN CAST(stat_period AS VARCHAR) = 'day' THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(substr(CAST(start_date AS VARCHAR), 1, 10) AS VARCHAR), '~', CAST(substr(CAST(end_date AS VARCHAR), 1, 10) AS VARCHAR)) END AS period,
      start_date,
      end_date,
      stat_period,
      tag,
      dim,
      level1,
      level2,
      level3,
      level4,
      '' AS pd,
      os,
      ver,
      ver_type,
      '' AS product_line,
      '' AS product_type,
      domain,
      country,
      region,
      net,
      vid,
      project,
      company_id,
      company_name,
      rowsnum,
      lastusage,
      thisusage,
      fiveSecJoinSuccess,
      totalJoin,
      cnt_sid,
      video_freeze_time,
      video_totaltime,
      audio_freeze_time,
      audio_totaltime,
      s2l_total_delay_sec,
      s2l_25ms_delay_sec,
      s2l_75ms_delay_sec,
      p2s_lost_Leq5,
      p2s_lost_all,
      crash_cnt,
      service_cnt,
      ""1s_succ_join_ap_cnt"",
      ""5s_succ_join_ap_cnt"",
      total_join_ap_cnt,
      totalJoinSuccess,
      threeSecJoinSuccess,
      video_freeze_time_200,
      video_totaltime_200,
      video_freeze_time_500,
      video_totaltime_500,
      ""3s_succ_join_session_cnt_last1"",
      ""5s_succ_join_session_cnt_last1"",
      succ_join_session_cnt_last1,
      total_join_session_cnt_last1,
      total_session_cnt_last1,
      ""1s_succ_join_ap_cnt_last1"",
      ""5s_succ_join_ap_cnt_last1"",
      total_join_ap_cnt_last1,
      ""3s_succ_join_session_cnt_last7"",
      ""5s_succ_join_session_cnt_last7"",
      succ_join_session_cnt_last7,
      total_join_session_cnt_last7,
      total_session_cnt_last7,
      ""1s_succ_join_ap_cnt_last7"",
      ""5s_succ_join_ap_cnt_last7"",
      total_join_ap_cnt_last7,
      video_freeze_time_last1,
      video_totaltime_last1,
      video_freeze_time_500_last1,
      video_totaltime_500_last1,
      video_freeze_time_200_last1,
      video_totaltime_200_last1,
      video_freeze_time_last7,
      video_totaltime_last7,
      video_freeze_time_500_last7,
      video_totaltime_500_last7,
      video_freeze_time_200_last7,
      video_totaltime_200_last7,
      audio_freeze_time_last1,
      audio_totaltime_last1,
      audio_freeze_time_last7,
      audio_totaltime_last7,
      s2l_total_delay_sec_last1,
      s2l_25ms_delay_sec_last1,
      s2l_75ms_delay_sec_last1,
      s2l_total_delay_sec_last7,
      s2l_25ms_delay_sec_last7,
      s2l_75ms_delay_sec_last7,
      p2s_lost_Leq5_last1,
      p2s_lost_all_last1,
      p2s_lost_Leq5_last7,
      p2s_lost_all_last7,
      crash_cnt_last1,
      service_cnt_last1,
      crash_cnt_last7,
      service_cnt_last7,
      product_level1,
      product_level2,
      product_level3,
      product_level4,
      s2l_lost_Leq5,
      s2l_lost_all,
      s2l_lost_Leq5_last1,
      s2l_lost_all_last1,
      s2l_lost_Leq5_last7,
      s2l_lost_all_last7
    FROM report_datahub.pub_levels_quality_di_1
    WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-21') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-05')) AS ""自定义 SQL 查询""
HAVING COUNT(1) > 0"
"SELECT ""自定义 SQL 查询"".""idc"" AS ""idc""
FROM (SELECT date AS ""date"",
      src_domain AS ""srcDomain"",
      src_country AS ""srcCountry"",
      dest_idc AS ""idc"",
      delay_25 AS ""p2s_Delay25"",
      delay_50 AS ""p2s_Delay50"",
      delay_75 AS ""p2s_Delay75"",
      delay_100 AS ""p2s_Delay100"",
      delay_125 AS ""p2s_Delay125"",
      delay_150 AS ""p2s_Delay150"",
      delay_total,
      lost_ratio_5 AS ""p2s_lostRatio"",
      lostratio_total AS ""p2s_total"",
      jitter95_50 AS ""p2s_jitter95_50"",
      jitter95_100 AS ""p2s_jitter95_100"",
      jitter95_200 AS ""p2s_jitter95_200"",
      jitter95_300 AS ""p2s_jitter95_300"",
      jitter95_total,
      product_line,
      product_type
    FROM media.p2s_cover_oversea_idc
    WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-25') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-01')) AS ""自定义 SQL 查询""
WHERE CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'aofei-frankfurt1g' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'zhuzhou1g-ctel'
GROUP BY 1"
"SELECT SUM(""自定义 SQL 查询"".""p2s_Delay25"" * ""自定义 SQL 查询"".""delay_total"") AS ""TEMP(Calculation_1122874106500857864)(1563607262)(0)"",
  SUM(""自定义 SQL 查询"".""delay_total"") AS ""TEMP(Calculation_1122874106500857864)(363980608)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_Delay50"" * ""自定义 SQL 查询"".""delay_total"") AS ""TEMP(Calculation_1122874106501021705)(1551638771)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_Delay75"" * ""自定义 SQL 查询"".""delay_total"") AS ""TEMP(Calculation_1122874106501136394)(2562427304)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_lostRatio"" * ""自定义 SQL 查询"".""p2s_total"") AS ""TEMP(Calculation_1122874106501275659)(1741181994)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_total"") AS ""TEMP(Calculation_1122874106501275659)(2624355999)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_Delay100"" * ""自定义 SQL 查询"".""delay_total"") AS ""TEMP(Calculation_4208191644268068870)(4273621395)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_Delay125"" * ""自定义 SQL 查询"".""delay_total"") AS ""TEMP(Calculation_4208191644269584391)(3242688810)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_Delay150"" * ""自定义 SQL 查询"".""delay_total"") AS ""TEMP(Calculation_4208191644269871112)(1276673441)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_jitter95_50"" * ""自定义 SQL 查询"".""jitter95_total"") AS ""TEMP(Calculation_4208191644275204106)(1652714847)(0)"",
  SUM(""自定义 SQL 查询"".""jitter95_total"") AS ""TEMP(Calculation_4208191644275204106)(633698484)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_jitter95_100"" * ""自定义 SQL 查询"".""jitter95_total"") AS ""TEMP(Calculation_4208191644276129803)(3609783325)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_jitter95_200"" * ""自定义 SQL 查询"".""jitter95_total"") AS ""TEMP(Calculation_4208191644276916236)(206867949)(0)"",
  ""自定义 SQL 查询"".""idc"" AS ""idc"",
  ""自定义 SQL 查询"".""srcCountry"" AS ""srcCountry"",
  ""自定义 SQL 查询"".""srcDomain"" AS ""srcDomain"",
  SUM(""自定义 SQL 查询"".""p2s_total"") AS ""sum_p2s_total_ok""
FROM (SELECT date AS ""date"",
      src_domain AS ""srcDomain"",
      src_country AS ""srcCountry"",
      dest_idc AS ""idc"",
      delay_25 AS ""p2s_Delay25"",
      delay_50 AS ""p2s_Delay50"",
      delay_75 AS ""p2s_Delay75"",
      delay_100 AS ""p2s_Delay100"",
      delay_125 AS ""p2s_Delay125"",
      delay_150 AS ""p2s_Delay150"",
      delay_total,
      lost_ratio_5 AS ""p2s_lostRatio"",
      lostratio_total AS ""p2s_total"",
      jitter95_50 AS ""p2s_jitter95_50"",
      jitter95_100 AS ""p2s_jitter95_100"",
      jitter95_200 AS ""p2s_jitter95_200"",
      jitter95_300 AS ""p2s_jitter95_300"",
      jitter95_total,
      product_line,
      product_type
    FROM media.p2s_cover_oversea_idc
    WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-25') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-01')) AS ""自定义 SQL 查询""
WHERE CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'aofei-frankfurt1g' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'zhuzhou1g-ctel' AND ""自定义 SQL 查询"".""srcCountry"" NOT IN ('Falkland Islands', 'British Indian Ocean Territory', 'Montserrat', 'North Korea', 'Tuvalu', 'Niue')
GROUP BY 14,
  15,
  16
HAVING CAST(CASE WHEN SUM(""自定义 SQL 查询"".""p2s_total"") >= 0 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100 THEN '0-100' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 1000 THEN '100-1000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 1000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 10000 THEN '1000-10000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 10000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100000 THEN '10000-100000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100000 THEN '100000以上' ELSE 'other' END AS VARCHAR) = '100-1000' OR CAST(CASE WHEN SUM(""自定义 SQL 查询"".""p2s_total"") >= 0 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100 THEN '0-100' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 1000 THEN '100-1000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 1000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 10000 THEN '1000-10000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 10000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100000 THEN '10000-100000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100000 THEN '100000以上' ELSE 'other' END AS VARCHAR) = '1000-10000' OR CAST(CASE WHEN SUM(""自定义 SQL 查询"".""p2s_total"") >= 0 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100 THEN '0-100' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 1000 THEN '100-1000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 1000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 10000 THEN '1000-10000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 10000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100000 THEN '10000-100000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100000 THEN '100000以上' ELSE 'other' END AS VARCHAR) = '10000-100000' OR CAST(CASE WHEN SUM(""自定义 SQL 查询"".""p2s_total"") >= 0 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100 THEN '0-100' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 1000 THEN '100-1000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 1000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 10000 THEN '1000-10000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 10000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100000 THEN '10000-100000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100000 THEN '100000以上' ELSE 'other' END AS VARCHAR) = '100000以上'"
"SELECT ""自定义 SQL 查询"".""srcRegion"" AS ""srcRegion""
FROM (SELECT date AS ""date"",
      src_domain AS ""srcDomain"",
      src_region AS ""srcRegion"",
      dest_idc AS ""idc"",
      src_isp,
      dest_ip,
      delay_25 AS ""p2s_Delay25"",
      delay_50 AS ""p2s_Delay50"",
      delay_75 AS ""p2s_Delay75"",
      delay_100 AS ""p2s_Delay100"",
      delay_125 AS ""p2s_Delay125"",
      delay_150 AS ""p2s_Delay150"",
      delay_total,
      lost_ratio_5 AS ""p2s_lostRatio"",
      lostratio_total AS ""p2s_total"",
      jitter95_50 AS ""p2s_jitter95_50"",
      jitter95_100 AS ""p2s_jitter95_100"",
      jitter95_200 AS ""p2s_jitter95_200"",
      jitter95_300 AS ""p2s_jitter95_300"",
      jitter95_total,
      product_line,
      product_type
    FROM media.p2s_cover_mainland_ip
    WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-25') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-01')) AS ""自定义 SQL 查询""
GROUP BY 1
ORDER BY ""srcRegion"""
"SELECT SUM(""自定义 SQL 查询"".""s2l_25ms_delay_sec"") AS ""TEMP(Calculation_1430244791154503680)(2227145667)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_total_delay_sec"") AS ""TEMP(Calculation_1430244791154503680)(2460078802)(0)"",
  SUM(""自定义 SQL 查询"".""5s_succ_join_ap_cnt"") AS ""TEMP(Calculation_1430244791247978510)(1716451703)(0)"",
  SUM(""自定义 SQL 查询"".""total_join_ap_cnt"") AS ""TEMP(Calculation_1430244791247978510)(2681092799)(0)"",
  SUM(""自定义 SQL 查询"".""video_freeze_time_500"") AS ""TEMP(Calculation_2810035073237774336)(389023081)(0)"",
  SUM(""自定义 SQL 查询"".""video_totaltime_500"") AS ""TEMP(Calculation_2810035073237774336)(458654145)(0)"",
  SUM(""自定义 SQL 查询"".""video_totaltime_200"") AS ""TEMP(Calculation_2810035073237950465)(2104207895)(0)"",
  SUM(""自定义 SQL 查询"".""video_freeze_time_200"") AS ""TEMP(Calculation_2810035073237950465)(530162565)(0)"",
  SUM(""自定义 SQL 查询"".""totalJoin"") AS ""TEMP(Calculation_374009936508170240)(2073556184)(0)"",
  SUM(""自定义 SQL 查询"".""totalJoinSuccess"") AS ""TEMP(Calculation_374009936508170240)(2807417001)(0)"",
  SUM(""自定义 SQL 查询"".""threeSecJoinSuccess"") AS ""TEMP(Calculation_374009936508321793)(3693645608)(0)"",
  SUM(""自定义 SQL 查询"".""fiveSecJoinSuccess"") AS ""TEMP(Calculation_374009936508416002)(383616769)(0)"",
  SUM(""自定义 SQL 查询"".""video_totaltime"") AS ""TEMP(Calculation_374009936515215363)(2797449586)(0)"",
  SUM(""自定义 SQL 查询"".""video_freeze_time"") AS ""TEMP(Calculation_374009936515215363)(2940759860)(0)"",
  SUM(""自定义 SQL 查询"".""audio_totaltime"") AS ""TEMP(Calculation_374009936517861380)(1652566750)(0)"",
  SUM(""自定义 SQL 查询"".""audio_freeze_time"") AS ""TEMP(Calculation_374009936517861380)(2919389392)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_lost_Leq5"") AS ""TEMP(Calculation_374009936519704581)(1936123547)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_lost_all"") AS ""TEMP(Calculation_374009936519704581)(749826584)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_75ms_delay_sec"") AS ""TEMP(Calculation_6542393318886285312)(2003933318)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_lost_Leq5"") AS ""TEMP(Calculation_7034341207026868236)(2745840127)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_lost_all"") AS ""TEMP(Calculation_7034341207026868236)(734589263)(0)"",
  SUM(""自定义 SQL 查询"".""crash_cnt"") AS ""TEMP(Calculation_7034341207372070925)(2360900687)(0)"",
  SUM(""自定义 SQL 查询"".""service_cnt"") AS ""TEMP(Calculation_7034341207372070925)(4291252132)(0)"",
  SUM(""自定义 SQL 查询"".""thisusage"") AS ""TEMP(TC_)(949910004)(0)"",
  ""自定义 SQL 查询"".""company_id"" AS ""company_id"",
  ""自定义 SQL 查询"".""company_name"" AS ""company_name"",
  ""自定义 SQL 查询"".""project"" AS ""project"",
  SUM(""自定义 SQL 查询"".""cnt_sid"") AS ""sum_cnt_sid_ok"",
  SUM(""自定义 SQL 查询"".""thisusage"") AS ""sum_thisusage_ok"",
  MAX(""自定义 SQL 查询"".""period"") AS ""usr_Calculation_6733444459377328128_nk"",
  ""自定义 SQL 查询"".""vid"" AS ""vid""
FROM (SELECT date,
        CASE WHEN CAST(stat_period AS VARCHAR) = 'day' THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(substr(CAST(start_date AS VARCHAR), 1, 10) AS VARCHAR), '~', CAST(substr(CAST(end_date AS VARCHAR), 1, 10) AS VARCHAR)) END AS period,
      start_date,
      end_date,
      stat_period,
      tag,
      dim,
      level1,
      level2,
      level3,
      level4,
      '' AS pd,
      os,
      ver,
      ver_type,
      '' AS product_line,
      '' AS product_type,
      domain,
      country,
      region,
      net,
      vid,
      project,
      company_id,
      company_name,
      rowsnum,
      lastusage,
      thisusage,
      fiveSecJoinSuccess,
      totalJoin,
      cnt_sid,
      video_freeze_time,
      video_totaltime,
      audio_freeze_time,
      audio_totaltime,
      s2l_total_delay_sec,
      s2l_25ms_delay_sec,
      s2l_75ms_delay_sec,
      p2s_lost_Leq5,
      p2s_lost_all,
      crash_cnt,
      service_cnt,
      ""1s_succ_join_ap_cnt"",
      ""5s_succ_join_ap_cnt"",
      total_join_ap_cnt,
      totalJoinSuccess,
      threeSecJoinSuccess,
      video_freeze_time_200,
      video_totaltime_200,
      video_freeze_time_500,
      video_totaltime_500,
      ""3s_succ_join_session_cnt_last1"",
      ""5s_succ_join_session_cnt_last1"",
      succ_join_session_cnt_last1,
      total_join_session_cnt_last1,
      total_session_cnt_last1,
      ""1s_succ_join_ap_cnt_last1"",
      ""5s_succ_join_ap_cnt_last1"",
      total_join_ap_cnt_last1,
      ""3s_succ_join_session_cnt_last7"",
      ""5s_succ_join_session_cnt_last7"",
      succ_join_session_cnt_last7,
      total_join_session_cnt_last7,
      total_session_cnt_last7,
      ""1s_succ_join_ap_cnt_last7"",
      ""5s_succ_join_ap_cnt_last7"",
      total_join_ap_cnt_last7,
      video_freeze_time_last1,
      video_totaltime_last1,
      video_freeze_time_500_last1,
      video_totaltime_500_last1,
      video_freeze_time_200_last1,
      video_totaltime_200_last1,
      video_freeze_time_last7,
      video_totaltime_last7,
      video_freeze_time_500_last7,
      video_totaltime_500_last7,
      video_freeze_time_200_last7,
      video_totaltime_200_last7,
      audio_freeze_time_last1,
      audio_totaltime_last1,
      audio_freeze_time_last7,
      audio_totaltime_last7,
      s2l_total_delay_sec_last1,
      s2l_25ms_delay_sec_last1,
      s2l_75ms_delay_sec_last1,
      s2l_total_delay_sec_last7,
      s2l_25ms_delay_sec_last7,
      s2l_75ms_delay_sec_last7,
      p2s_lost_Leq5_last1,
      p2s_lost_all_last1,
      p2s_lost_Leq5_last7,
      p2s_lost_all_last7,
      crash_cnt_last1,
      service_cnt_last1,
      crash_cnt_last7,
      service_cnt_last7,
      product_level1,
      product_level2,
      product_level3,
      product_level4,
      s2l_lost_Leq5,
      s2l_lost_all,
      s2l_lost_Leq5_last1,
      s2l_lost_all_last1,
      s2l_lost_Leq5_last7,
      s2l_lost_all_last7
    FROM report_datahub.pub_levels_quality_di_1
    WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-21') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-05')) AS ""自定义 SQL 查询""
  CROSS JOIN (SELECT MAX(date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d')) AS ""__measure__0""
    FROM (SELECT date,
            CASE WHEN CAST(stat_period AS VARCHAR) = 'day' THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(substr(CAST(start_date AS VARCHAR), 1, 10) AS VARCHAR), '~', CAST(substr(CAST(end_date AS VARCHAR), 1, 10) AS VARCHAR)) END AS period,
          start_date,
          end_date,
          stat_period,
          tag,
          dim,
          level1,
          level2,
          level3,
          level4,
          '' AS pd,
          os,
          ver,
          ver_type,
          '' AS product_line,
          '' AS product_type,
          domain,
          country,
          region,
          net,
          vid,
          project,
          company_id,
          company_name,
          rowsnum,
          lastusage,
          thisusage,
          fiveSecJoinSuccess,
          totalJoin,
          cnt_sid,
          video_freeze_time,
          video_totaltime,
          audio_freeze_time,
          audio_totaltime,
          s2l_total_delay_sec,
          s2l_25ms_delay_sec,
          s2l_75ms_delay_sec,
          p2s_lost_Leq5,
          p2s_lost_all,
          crash_cnt,
          service_cnt,
          ""1s_succ_join_ap_cnt"",
          ""5s_succ_join_ap_cnt"",
          total_join_ap_cnt,
          totalJoinSuccess,
          threeSecJoinSuccess,
          video_freeze_time_200,
          video_totaltime_200,
          video_freeze_time_500,
          video_totaltime_500,
          ""3s_succ_join_session_cnt_last1"",
          ""5s_succ_join_session_cnt_last1"",
          succ_join_session_cnt_last1,
          total_join_session_cnt_last1,
          total_session_cnt_last1,
          ""1s_succ_join_ap_cnt_last1"",
          ""5s_succ_join_ap_cnt_last1"",
          total_join_ap_cnt_last1,
          ""3s_succ_join_session_cnt_last7"",
          ""5s_succ_join_session_cnt_last7"",
          succ_join_session_cnt_last7,
          total_join_session_cnt_last7,
          total_session_cnt_last7,
          ""1s_succ_join_ap_cnt_last7"",
          ""5s_succ_join_ap_cnt_last7"",
          total_join_ap_cnt_last7,
          video_freeze_time_last1,
          video_totaltime_last1,
          video_freeze_time_500_last1,
          video_totaltime_500_last1,
          video_freeze_time_200_last1,
          video_totaltime_200_last1,
          video_freeze_time_last7,
          video_totaltime_last7,
          video_freeze_time_500_last7,
          video_totaltime_500_last7,
          video_freeze_time_200_last7,
          video_totaltime_200_last7,
          audio_freeze_time_last1,
          audio_totaltime_last1,
          audio_freeze_time_last7,
          audio_totaltime_last7,
          s2l_total_delay_sec_last1,
          s2l_25ms_delay_sec_last1,
          s2l_75ms_delay_sec_last1,
          s2l_total_delay_sec_last7,
          s2l_25ms_delay_sec_last7,
          s2l_75ms_delay_sec_last7,
          p2s_lost_Leq5_last1,
          p2s_lost_all_last1,
          p2s_lost_Leq5_last7,
          p2s_lost_all_last7,
          crash_cnt_last1,
          service_cnt_last1,
          crash_cnt_last7,
          service_cnt_last7,
          product_level1,
          product_level2,
          product_level3,
          product_level4,
          s2l_lost_Leq5,
          s2l_lost_all,
          s2l_lost_Leq5_last1,
          s2l_lost_all_last1,
          s2l_lost_Leq5_last7,
          s2l_lost_all_last7
        FROM report_datahub.pub_levels_quality_di_1
        WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-21') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-05')) AS ""自定义 SQL 查询""
    HAVING COUNT(1) > 0) AS ""t0""
WHERE NOT ( (  ""自定义 SQL 查询"".""vid""  ) is null) AND CAST(""自定义 SQL 查询"".""dim"" AS VARCHAR) = '103' AND CAST(""自定义 SQL 查询"".""level1"" AS VARCHAR) = 'RTC' AND CAST(""自定义 SQL 查询"".""level2"" AS VARCHAR) = 'ALL' AND CAST(""自定义 SQL 查询"".""level3"" AS VARCHAR) = 'ALL' AND CAST(""自定义 SQL 查询"".""tag"" AS VARCHAR) = 'Product' AND DATE_ADD('SECOND', 0, date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d')) = DATE_ADD('SECOND', 0, ""t0"".""__measure__0"")
GROUP BY 25,
  26,
  27,
  31"
"SELECT ""t0"".""idc"" AS ""idc""
FROM (SELECT ""自定义 SQL 查询"".""idc"" AS ""idc""
    FROM (SELECT date AS ""date"",
          src_domain AS ""srcDomain"",
          src_country AS ""srcCountry"",
          dest_idc AS ""idc"",
          delay_25 AS ""p2s_Delay25"",
          delay_50 AS ""p2s_Delay50"",
          delay_75 AS ""p2s_Delay75"",
          delay_100 AS ""p2s_Delay100"",
          delay_125 AS ""p2s_Delay125"",
          delay_150 AS ""p2s_Delay150"",
          delay_total,
          lost_ratio_5 AS ""p2s_lostRatio"",
          lostratio_total AS ""p2s_total"",
          jitter95_50 AS ""p2s_jitter95_50"",
          jitter95_100 AS ""p2s_jitter95_100"",
          jitter95_200 AS ""p2s_jitter95_200"",
          jitter95_300 AS ""p2s_jitter95_300"",
          jitter95_total,
          product_line,
          product_type
        FROM media.p2s_cover_oversea_idc
        WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-25') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-01')) AS ""自定义 SQL 查询""
    WHERE CAST(""自定义 SQL 查询"".""srcCountry"" AS VARCHAR) = 'India' AND ""自定义 SQL 查询"".""srcCountry"" NOT IN ('Falkland Islands', 'British Indian Ocean Territory', 'Montserrat', 'North Korea', 'Tuvalu', 'Niue')
    GROUP BY 1,
      ""自定义 SQL 查询"".""srcCountry"",
      ""自定义 SQL 查询"".""srcDomain""
    HAVING CAST(CASE WHEN SUM(""自定义 SQL 查询"".""p2s_total"") >= 0 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100 THEN '0-100' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 1000 THEN '100-1000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 1000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 10000 THEN '1000-10000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 10000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100000 THEN '10000-100000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100000 THEN '100000以上' ELSE 'other' END AS VARCHAR) = '100-1000' OR CAST(CASE WHEN SUM(""自定义 SQL 查询"".""p2s_total"") >= 0 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100 THEN '0-100' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 1000 THEN '100-1000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 1000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 10000 THEN '1000-10000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 10000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100000 THEN '10000-100000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100000 THEN '100000以上' ELSE 'other' END AS VARCHAR) = '1000-10000' OR CAST(CASE WHEN SUM(""自定义 SQL 查询"".""p2s_total"") >= 0 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100 THEN '0-100' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 1000 THEN '100-1000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 1000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 10000 THEN '1000-10000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 10000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100000 THEN '10000-100000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100000 THEN '100000以上' ELSE 'other' END AS VARCHAR) = '10000-100000' OR CAST(CASE WHEN SUM(""自定义 SQL 查询"".""p2s_total"") >= 0 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100 THEN '0-100' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 1000 THEN '100-1000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 1000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 10000 THEN '1000-10000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 10000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100000 THEN '10000-100000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100000 THEN '100000以上' ELSE 'other' END AS VARCHAR) = '100000以上') AS ""t0""
GROUP BY 1"
"SELECT '跳转：音频可用性' AS ""Calculation_5876704998653468673""
FROM (SELECT t1.date,
        CASE WHEN CAST(stat_period AS VARCHAR) = 'day' THEN substr(CAST(date_parse(cast( t1.date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(substr(CAST(start_date AS VARCHAR), 1, 10) AS VARCHAR), '~', CAST(substr(CAST(end_date AS VARCHAR), 1, 10) AS VARCHAR)) END AS period,
      start_date,
      end_date,
      stat_period,
      tag,
      t1.dim,
      level1,
      level2,
      level3,
      level4,
      os,
      ver,
      ver_type,
      domain,
      country,
      region,
      net,
      vid,
      project,
      company_id,
      company_name,
      rowsnum,
      lastusage,
      thisusage,
      fiveSecJoinSuccess,
      totalJoin,
      cnt_sid,
      video_freeze_time,
      video_totaltime,
      audio_freeze_time,
      audio_totaltime,
      s2l_total_delay_sec,
      s2l_25ms_delay_sec,
      s2l_75ms_delay_sec,
      p2s_lost_Leq5,
      p2s_lost_all,
      crash_cnt,
      service_cnt,
      ""1s_succ_join_ap_cnt"",
      ""5s_succ_join_ap_cnt"",
      total_join_ap_cnt,
      totalJoinSuccess,
      threeSecJoinSuccess,
      video_freeze_time_200,
      video_totaltime_200,
      video_freeze_time_500,
      video_totaltime_500,
      ""3s_succ_join_session_cnt_last1"",
      ""5s_succ_join_session_cnt_last1"",
      succ_join_session_cnt_last1,
      total_join_session_cnt_last1,
      total_session_cnt_last1,
      ""1s_succ_join_ap_cnt_last1"",
      ""5s_succ_join_ap_cnt_last1"",
      total_join_ap_cnt_last1,
      ""3s_succ_join_session_cnt_last7"",
      ""5s_succ_join_session_cnt_last7"",
      succ_join_session_cnt_last7,
      total_join_session_cnt_last7,
      total_session_cnt_last7,
      ""1s_succ_join_ap_cnt_last7"",
      ""5s_succ_join_ap_cnt_last7"",
      total_join_ap_cnt_last7,
      video_freeze_time_last1,
      video_totaltime_last1,
      video_freeze_time_500_last1,
      video_totaltime_500_last1,
      video_freeze_time_200_last1,
      video_totaltime_200_last1,
      video_freeze_time_last7,
      video_totaltime_last7,
      video_freeze_time_500_last7,
      video_totaltime_500_last7,
      video_freeze_time_200_last7,
      video_totaltime_200_last7,
      audio_freeze_time_last1,
      audio_totaltime_last1,
      audio_freeze_time_last7,
      audio_totaltime_last7,
      s2l_total_delay_sec_last1,
      s2l_25ms_delay_sec_last1,
      s2l_75ms_delay_sec_last1,
      s2l_total_delay_sec_last7,
      s2l_25ms_delay_sec_last7,
      s2l_75ms_delay_sec_last7,
      p2s_lost_Leq5_last1,
      p2s_lost_all_last1,
      p2s_lost_Leq5_last7,
      p2s_lost_all_last7,
      crash_cnt_last1,
      service_cnt_last1,
      crash_cnt_last7,
      service_cnt_last7,
      product_level1,
      product_level2,
      product_level3,
      product_level4,
      s2l_lost_Leq5,
      s2l_lost_all,
      s2l_lost_Leq5_last1,
      s2l_lost_all_last1,
      s2l_lost_Leq5_last7,
      s2l_lost_all_last7,
      fiveSecJoinSuccess_total,
      totalJoin_total,
      cnt_sid_total,
      video_freeze_time_total,
      video_totaltime_total,
      audio_freeze_time_total,
      audio_totaltime_total,
      s2l_total_delay_sec_total,
      s2l_25ms_delay_sec_total,
      s2l_75ms_delay_sec_total,
      p2s_lost_Leq5_total,
      p2s_lost_all_total,
      crash_cnt_total,
      service_cnt_total,
      ""1s_succ_join_ap_cnt_total"",
      ""5s_succ_join_ap_cnt_total"",
      total_join_ap_cnt_total,
      totalJoinSuccess_total,
      threeSecJoinSuccess_total,
      video_freeze_time_200_total,
      video_totaltime_200_total,
      video_freeze_time_500_total,
      video_totaltime_500_total,
      ""3s_succ_join_session_cnt_last1_total"",
      ""5s_succ_join_session_cnt_last1_total"",
      succ_join_session_cnt_last1_total,
      total_join_session_cnt_last1_total,
      total_session_cnt_last1_total,
      ""1s_succ_join_ap_cnt_last1_total"",
      ""5s_succ_join_ap_cnt_last1_total"",
      total_join_ap_cnt_last1_total,
      ""3s_succ_join_session_cnt_last7_total"",
      ""5s_succ_join_session_cnt_last7_total"",
      succ_join_session_cnt_last7_total,
      total_join_session_cnt_last7_total,
      total_session_cnt_last7_total,
      ""1s_succ_join_ap_cnt_last7_total"",
      ""5s_succ_join_ap_cnt_last7_total"",
      total_join_ap_cnt_last7_total,
      video_freeze_time_last1_total,
      video_totaltime_last1_total,
      video_freeze_time_500_last1_total,
      video_totaltime_500_last1_total,
      video_freeze_time_200_last1_total,
      video_totaltime_200_last1_total,
      video_freeze_time_last7_total,
      video_totaltime_last7_total,
      video_freeze_time_500_last7_total,
      video_totaltime_500_last7_total,
      video_freeze_time_200_last7_total,
      video_totaltime_200_last7_total,
      audio_freeze_time_last1_total,
      audio_totaltime_last1_total,
      audio_freeze_time_last7_total,
      audio_totaltime_last7_total,
      s2l_total_delay_sec_last1_total,
      s2l_25ms_delay_sec_last1_total,
      s2l_75ms_delay_sec_last1_total,
      s2l_total_delay_sec_last7_total,
      s2l_25ms_delay_sec_last7_total,
      s2l_75ms_delay_sec_last7_total,
      p2s_lost_Leq5_last1_total,
      p2s_lost_all_last1_total,
      p2s_lost_Leq5_last7_total,
      p2s_lost_all_last7_total,
      crash_cnt_last1_total,
      service_cnt_last1_total,
      crash_cnt_last7_total,
      service_cnt_last7_total,
      s2l_lost_Leq5_total,
      s2l_lost_all_total,
      s2l_lost_Leq5_last1_total,
      s2l_lost_all_last1_total,
      s2l_lost_Leq5_last7_total,
      s2l_lost_all_last7_total
    FROM report_datahub.pub_levels_quality_di_1 AS t1
      LEFT JOIN (SELECT date,
          dim,
          SUM(fiveSecJoinSuccess) AS fiveSecJoinSuccess_total,
          SUM(totalJoin) AS totalJoin_total,
          SUM(cnt_sid) AS cnt_sid_total,
          SUM(video_freeze_time) AS video_freeze_time_total,
          SUM(video_totaltime) AS video_totaltime_total,
          SUM(audio_freeze_time) AS audio_freeze_time_total,
          SUM(audio_totaltime) AS audio_totaltime_total,
          SUM(s2l_total_delay_sec) AS s2l_total_delay_sec_total,
          SUM(s2l_25ms_delay_sec) AS s2l_25ms_delay_sec_total,
          SUM(s2l_75ms_delay_sec) AS s2l_75ms_delay_sec_total,
          SUM(p2s_lost_Leq5) AS p2s_lost_Leq5_total,
          SUM(p2s_lost_all) AS p2s_lost_all_total,
          SUM(crash_cnt) AS crash_cnt_total,
          SUM(service_cnt) AS service_cnt_total,
          SUM(""1s_succ_join_ap_cnt"") AS ""1s_succ_join_ap_cnt_total"",
          SUM(""5s_succ_join_ap_cnt"") AS ""5s_succ_join_ap_cnt_total"",
          SUM(total_join_ap_cnt) AS total_join_ap_cnt_total,
          SUM(totalJoinSuccess) AS totalJoinSuccess_total,
          SUM(threeSecJoinSuccess) AS threeSecJoinSuccess_total,
          SUM(video_freeze_time_200) AS video_freeze_time_200_total,
          SUM(video_totaltime_200) AS video_totaltime_200_total,
          SUM(video_freeze_time_500) AS video_freeze_time_500_total,
          SUM(video_totaltime_500) AS video_totaltime_500_total,
          SUM(""3s_succ_join_session_cnt_last1"") AS ""3s_succ_join_session_cnt_last1_total"",
          SUM(""5s_succ_join_session_cnt_last1"") AS ""5s_succ_join_session_cnt_last1_total"",
          SUM(succ_join_session_cnt_last1) AS succ_join_session_cnt_last1_total,
          SUM(total_join_session_cnt_last1) AS total_join_session_cnt_last1_total,
          SUM(total_session_cnt_last1) AS total_session_cnt_last1_total,
          SUM(""1s_succ_join_ap_cnt_last1"") AS ""1s_succ_join_ap_cnt_last1_total"",
          SUM(""5s_succ_join_ap_cnt_last1"") AS ""5s_succ_join_ap_cnt_last1_total"",
          SUM(total_join_ap_cnt_last1) AS total_join_ap_cnt_last1_total,
          SUM(""3s_succ_join_session_cnt_last7"") AS ""3s_succ_join_session_cnt_last7_total"",
          SUM(""5s_succ_join_session_cnt_last7"") AS ""5s_succ_join_session_cnt_last7_total"",
          SUM(succ_join_session_cnt_last7) AS succ_join_session_cnt_last7_total,
          SUM(total_join_session_cnt_last7) AS total_join_session_cnt_last7_total,
          SUM(total_session_cnt_last7) AS total_session_cnt_last7_total,
          SUM(""1s_succ_join_ap_cnt_last7"") AS ""1s_succ_join_ap_cnt_last7_total"",
          SUM(""5s_succ_join_ap_cnt_last7"") AS ""5s_succ_join_ap_cnt_last7_total"",
          SUM(total_join_ap_cnt_last7) AS total_join_ap_cnt_last7_total,
          SUM(video_freeze_time_last1) AS video_freeze_time_last1_total,
          SUM(video_totaltime_last1) AS video_totaltime_last1_total,
          SUM(video_freeze_time_500_last1) AS video_freeze_time_500_last1_total,
          SUM(video_totaltime_500_last1) AS video_totaltime_500_last1_total,
          SUM(video_freeze_time_200_last1) AS video_freeze_time_200_last1_total,
          SUM(video_totaltime_200_last1) AS video_totaltime_200_last1_total,
          SUM(video_freeze_time_last7) AS video_freeze_time_last7_total,
          SUM(video_totaltime_last7) AS video_totaltime_last7_total,
          SUM(video_freeze_time_500_last7) AS video_freeze_time_500_last7_total,
          SUM(video_totaltime_500_last7) AS video_totaltime_500_last7_total,
          SUM(video_freeze_time_200_last7) AS video_freeze_time_200_last7_total,
          SUM(video_totaltime_200_last7) AS video_totaltime_200_last7_total,
          SUM(audio_freeze_time_last1) AS audio_freeze_time_last1_total,
          SUM(audio_totaltime_last1) AS audio_totaltime_last1_total,
          SUM(audio_freeze_time_last7) AS audio_freeze_time_last7_total,
          SUM(audio_totaltime_last7) AS audio_totaltime_last7_total,
          SUM(s2l_total_delay_sec_last1) AS s2l_total_delay_sec_last1_total,
          SUM(s2l_25ms_delay_sec_last1) AS s2l_25ms_delay_sec_last1_total,
          SUM(s2l_75ms_delay_sec_last1) AS s2l_75ms_delay_sec_last1_total,
          SUM(s2l_total_delay_sec_last7) AS s2l_total_delay_sec_last7_total,
          SUM(s2l_25ms_delay_sec_last7) AS s2l_25ms_delay_sec_last7_total,
          SUM(s2l_75ms_delay_sec_last7) AS s2l_75ms_delay_sec_last7_total,
          SUM(p2s_lost_Leq5_last1) AS p2s_lost_Leq5_last1_total,
          SUM(p2s_lost_all_last1) AS p2s_lost_all_last1_total,
          SUM(p2s_lost_Leq5_last7) AS p2s_lost_Leq5_last7_total,
          SUM(p2s_lost_all_last7) AS p2s_lost_all_last7_total,
          SUM(crash_cnt_last1) AS crash_cnt_last1_total,
          SUM(service_cnt_last1) AS service_cnt_last1_total,
          SUM(crash_cnt_last7) AS crash_cnt_last7_total,
          SUM(service_cnt_last7) AS service_cnt_last7_total,
          SUM(s2l_lost_Leq5) AS s2l_lost_Leq5_total,
          SUM(s2l_lost_all) AS s2l_lost_all_total,
          SUM(s2l_lost_Leq5_last1) AS s2l_lost_Leq5_last1_total,
          SUM(s2l_lost_all_last1) AS s2l_lost_all_last1_total,
          SUM(s2l_lost_Leq5_last7) AS s2l_lost_Leq5_last7_total,
          SUM(s2l_lost_all_last7) AS s2l_lost_all_last7_total
        FROM report_datahub.pub_levels_quality_di_1
        WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-21') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-05') AND CAST(tag AS VARCHAR) = 'Product'
        GROUP BY date,
          dim) AS t2 ON t1.date = t2.date AND t1.dim = t2.dim
    WHERE date_parse(cast( t1.date as VARCHAR), '%Y%m%d') >= DATE('2021-11-21') AND date_parse(cast( t1.date as VARCHAR), '%Y%m%d') <= DATE('2021-12-05') AND CAST(tag AS VARCHAR) = 'Product') AS ""自定义 SQL 查询""
WHERE CASE WHEN CAST(""自定义 SQL 查询"".""tag"" AS VARCHAR) = 'Industry' AND CAST(""自定义 SQL 查询"".""product_level1"" AS VARCHAR) = 'RTC' AND CAST(""自定义 SQL 查询"".""dim"" AS VARCHAR) = 'osver' THEN 0 WHEN CAST(""自定义 SQL 查询"".""tag"" AS VARCHAR) = 'VerType' AND CAST(""自定义 SQL 查询"".""product_level1"" AS VARCHAR) = 'RTC' AND CAST(""自定义 SQL 查询"".""dim"" AS VARCHAR) = 'osver' THEN 0 WHEN CAST(""自定义 SQL 查询"".""tag"" AS VARCHAR) = 'Product' AND CAST(""自定义 SQL 查询"".""dim"" AS VARCHAR) = 'osver' AND CAST(""自定义 SQL 查询"".""product_level1"" AS VARCHAR) = 'RTC' THEN 1 ELSE 0 END
HAVING COUNT(1) > 0"
"SELECT SUM(""自定义 SQL 查询"".""host_4k_last"") AS ""TEMP(Calculation_3519281700083154949)(101123376)(0)"",
  SUM(""自定义 SQL 查询"".""host_4k"") AS ""TEMP(Calculation_3519281700083154949)(1075454865)(0)"",
  SUM(""自定义 SQL 查询"".""audience_sd"") AS ""TEMP(Calculation_3519281700083154949)(1133678835)(0)"",
  SUM(""自定义 SQL 查询"".""audience_video_hdp_last"") AS ""TEMP(Calculation_3519281700083154949)(1200517625)(0)"",
  SUM(""自定义 SQL 查询"".""host_1080p"") AS ""TEMP(Calculation_3519281700083154949)(1312501967)(0)"",
  SUM(""自定义 SQL 查询"".""audience_1080p_last"") AS ""TEMP(Calculation_3519281700083154949)(1314346200)(0)"",
  SUM(""自定义 SQL 查询"".""audience_video_hd_last"") AS ""TEMP(Calculation_3519281700083154949)(146570423)(0)"",
  SUM(""自定义 SQL 查询"".""audience_2k_last"") AS ""TEMP(Calculation_3519281700083154949)(1717771635)(0)"",
  SUM(""自定义 SQL 查询"".""audience_audio_last"") AS ""TEMP(Calculation_3519281700083154949)(2313111073)(0)"",
  SUM(""自定义 SQL 查询"".""host_video_hdp_last"") AS ""TEMP(Calculation_3519281700083154949)(258310559)(0)"",
  SUM(""自定义 SQL 查询"".""host_hd"") AS ""TEMP(Calculation_3519281700083154949)(276907208)(0)"",
  SUM(""自定义 SQL 查询"".""audio_video_last"") AS ""TEMP(Calculation_3519281700083154949)(2820618408)(0)"",
  SUM(""自定义 SQL 查询"".""video"") AS ""TEMP(Calculation_3519281700083154949)(2929708110)(0)"",
  SUM(""自定义 SQL 查询"".""audience_hd"") AS ""TEMP(Calculation_3519281700083154949)(2930728935)(0)"",
  SUM(""自定义 SQL 查询"".""audience_hdp"") AS ""TEMP(Calculation_3519281700083154949)(3010533957)(0)"",
  SUM(""自定义 SQL 查询"".""host_hdp"") AS ""TEMP(Calculation_3519281700083154949)(30306054)(0)"",
  SUM(""自定义 SQL 查询"".""host_audio"") AS ""TEMP(Calculation_3519281700083154949)(3087054365)(0)"",
  SUM(""自定义 SQL 查询"".""audience_4k_last"") AS ""TEMP(Calculation_3519281700083154949)(3121859593)(0)"",
  SUM(""自定义 SQL 查询"".""host_1080p_last"") AS ""TEMP(Calculation_3519281700083154949)(3222422303)(0)"",
  SUM(""自定义 SQL 查询"".""host_audio_last"") AS ""TEMP(Calculation_3519281700083154949)(3227677803)(0)"",
  SUM(""自定义 SQL 查询"".""audio"") AS ""TEMP(Calculation_3519281700083154949)(3299350010)(0)"",
  SUM(""自定义 SQL 查询"".""audience_1080p"") AS ""TEMP(Calculation_3519281700083154949)(3628946582)(0)"",
  SUM(""自定义 SQL 查询"".""totalUsage"") AS ""TEMP(Calculation_3519281700083154949)(3847882359)(0)"",
  SUM(""自定义 SQL 查询"".""video_last"") AS ""TEMP(Calculation_3519281700083154949)(3934387163)(0)"",
  SUM(""自定义 SQL 查询"".""host_2k_last"") AS ""TEMP(Calculation_3519281700083154949)(4055292783)(0)"",
  SUM(""自定义 SQL 查询"".""audio_last"") AS ""TEMP(Calculation_3519281700083154949)(4091190060)(0)"",
  SUM(""自定义 SQL 查询"".""audience_audio"") AS ""TEMP(Calculation_3519281700083154949)(4109514392)(0)"",
  SUM(""自定义 SQL 查询"".""host_video_hd_last"") AS ""TEMP(Calculation_3519281700083154949)(4170367250)(0)"",
  SUM(""自定义 SQL 查询"".""host_video_sd_last"") AS ""TEMP(Calculation_3519281700083154949)(4190307025)(0)"",
  SUM(""自定义 SQL 查询"".""host_2k"") AS ""TEMP(Calculation_3519281700083154949)(586790827)(0)"",
  SUM(""自定义 SQL 查询"".""host_sd"") AS ""TEMP(Calculation_3519281700083154949)(709512178)(0)"",
  SUM(""自定义 SQL 查询"".""audience_4k"") AS ""TEMP(Calculation_3519281700083154949)(764410224)(0)"",
  SUM(""自定义 SQL 查询"".""audience_video_sd_last"") AS ""TEMP(Calculation_3519281700083154949)(933007102)(0)"",
  SUM(""自定义 SQL 查询"".""audience_2k"") AS ""TEMP(Calculation_3519281700083154949)(943764407)(0)"",
  AVG(""自定义 SQL 查询"".""totalUsage"") AS ""avg_totalUsage_ok"",
  ""自定义 SQL 查询"".""level1"" AS ""level1"",
  SUM(""自定义 SQL 查询"".""totalUsage"") AS ""sum_totalUsage_ok""
FROM (SELECT date,
        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,
      start_date AS start_date_7,
      end_date AS end_date,
      tag,
      area AS Scope,
      dim,
        CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,
      level2,
      level3,
      level4,
      product_level1 AS product_line,
      product_level2,
      product_level3,
      product_level4,
      vid_internal_industry_en AS cid_industry,
      vid_use_case_en AS vid_use_case_cn,
      vid_sector_en,
      ver_type,
      ver,
      os,
      domain,
      country,
      region,
      dim_grouping_name,
        CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,
      total AS totalUsage,
      audio,
      video,
      host_audio,
      audience_audio,
      host_sd,
      host_hd,
      host_hdp,
      host_1080p,
      host_2k,
      host_4k,
      audience_sd,
      audience_hd,
      audience_hdp,
      audience_1080p,
      audience_2k,
      audience_4k,
      audience_audio_low_latency,
      audience_sd_low_latency,
      audience_hd_low_latency,
      audience_hdp_low_latency,
      audience_1080p_low_latency,
      audience_2k_low_latency,
      audience_4k_low_latency,
      audience_audio_ultra_low_latency,
      audience_sd_ultra_low_latency,
      audience_hd_ultra_low_latency,
      audience_hdp_ultra_low_latency,
      audience_1080p_ultra_low_latency,
      audience_2k_ultra_low_latency,
      audience_4k_ultra_low_latency,
      total_last1 AS audio_video_last,
      audio_last1 AS audio_last,
      video_last1 AS video_last,
      video_sd_last1 AS video_sd_last,
      video_hd_last1 AS video_hd_last,
      video_hdp_last1 AS video_hdp_last,
      host_sd_last1 AS host_video_sd_last,
      audience_sd_last1 AS audience_video_sd_last,
      host_hd_last1 AS host_video_hd_last,
      audience_hd_last1 AS audience_video_hd_last,
      host_hdp_last1 AS host_video_hdp_last,
      audience_hdp_last1 AS audience_video_hdp_last,
      host_audio_last1 AS host_audio_last,
      audience_audio_last1 AS audience_audio_last,
      host_video_last1 AS host_video_last,
      audience_video_last1 AS audience_video_last,
      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,
      audience_video_low_latency_last1 AS audience_video_low_latency_last,
      audience_total_low_latency_last1 AS audience_total_low_latency_last,
      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,
      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,
      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,
      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,
      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,
      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,
      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,
      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,
      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,
      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,
      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,
      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,
      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,
      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,
      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,
      audience_2k_last1 AS audience_2k_last,
      audience_4k_last1 AS audience_4k_last,
      audience_1080p_last1 AS audience_1080p_last,
      host_1080p_last1 AS host_1080p_last,
      host_2k_last1 AS host_2k_last,
      host_4k_last1 AS host_4k_last,
      total_last7,
      audio_last7,
      video_last7,
      video_sd_last7,
      video_hd_last7,
      video_hdp_last7,
      host_sd_last7,
      audience_sd_last7,
      host_hd_last7,
      audience_hd_last7,
      host_hdp_last7,
      audience_hdp_last7,
      host_audio_last7,
      audience_audio_last7,
      host_video_last7,
      audience_video_last7,
      audience_audio_low_latency_last7,
      audience_video_low_latency_last7,
      audience_total_low_latency_last7,
      audience_sd_low_latency_last7,
      audience_hd_low_latency_last7,
      audience_hdp_low_latency_last7,
      audience_1080p_low_latency_last7,
      audience_2k_low_latency_last7,
      audience_4k_low_latency_last7,
      audience_audio_ultra_low_latency_last7,
      audience_video_ultra_low_latency_last7,
      audience_total_ultra_low_latency_last7,
      audience_sd_ultra_low_latency_last7,
      audience_hd_ultra_low_latency_last7,
      audience_hdp_ultra_low_latency_last7,
      audience_1080p_ultra_low_latency_last7,
      audience_2k_ultra_low_latency_last7,
      audience_4k_ultra_low_latency_last7,
      audience_2k_last7,
      audience_4k_last7,
      audience_1080p_last7,
      host_1080p_last7,
      host_2k_last7,
      host_4k_last7
    FROM levels_usage_dod_di_1
    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-06') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-04') AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS ""自定义 SQL 查询""
  CROSS JOIN (SELECT MAX(date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d')) AS ""__measure__0""
    FROM (SELECT date,
            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,
          start_date AS start_date_7,
          end_date AS end_date,
          tag,
          area AS Scope,
          dim,
            CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,
          level2,
          level3,
          level4,
          product_level1 AS product_line,
          product_level2,
          product_level3,
          product_level4,
          vid_internal_industry_en AS cid_industry,
          vid_use_case_en AS vid_use_case_cn,
          vid_sector_en,
          ver_type,
          ver,
          os,
          domain,
          country,
          region,
          dim_grouping_name,
            CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,
          total AS totalUsage,
          audio,
          video,
          host_audio,
          audience_audio,
          host_sd,
          host_hd,
          host_hdp,
          host_1080p,
          host_2k,
          host_4k,
          audience_sd,
          audience_hd,
          audience_hdp,
          audience_1080p,
          audience_2k,
          audience_4k,
          audience_audio_low_latency,
          audience_sd_low_latency,
          audience_hd_low_latency,
          audience_hdp_low_latency,
          audience_1080p_low_latency,
          audience_2k_low_latency,
          audience_4k_low_latency,
          audience_audio_ultra_low_latency,
          audience_sd_ultra_low_latency,
          audience_hd_ultra_low_latency,
          audience_hdp_ultra_low_latency,
          audience_1080p_ultra_low_latency,
          audience_2k_ultra_low_latency,
          audience_4k_ultra_low_latency,
          total_last1 AS audio_video_last,
          audio_last1 AS audio_last,
          video_last1 AS video_last,
          video_sd_last1 AS video_sd_last,
          video_hd_last1 AS video_hd_last,
          video_hdp_last1 AS video_hdp_last,
          host_sd_last1 AS host_video_sd_last,
          audience_sd_last1 AS audience_video_sd_last,
          host_hd_last1 AS host_video_hd_last,
          audience_hd_last1 AS audience_video_hd_last,
          host_hdp_last1 AS host_video_hdp_last,
          audience_hdp_last1 AS audience_video_hdp_last,
          host_audio_last1 AS host_audio_last,
          audience_audio_last1 AS audience_audio_last,
          host_video_last1 AS host_video_last,
          audience_video_last1 AS audience_video_last,
          audience_audio_low_latency_last1 AS audience_audio_low_latency_last,
          audience_video_low_latency_last1 AS audience_video_low_latency_last,
          audience_total_low_latency_last1 AS audience_total_low_latency_last,
          audience_sd_low_latency_last1 AS audience_sd_low_latency_last,
          audience_hd_low_latency_last1 AS audience_hd_low_latency_last,
          audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,
          audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,
          audience_2k_low_latency_last1 AS audience_2k_low_latency_last,
          audience_4k_low_latency_last1 AS audience_4k_low_latency_last,
          audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,
          audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,
          audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,
          audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,
          audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,
          audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,
          audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,
          audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,
          audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,
          audience_2k_last1 AS audience_2k_last,
          audience_4k_last1 AS audience_4k_last,
          audience_1080p_last1 AS audience_1080p_last,
          host_1080p_last1 AS host_1080p_last,
          host_2k_last1 AS host_2k_last,
          host_4k_last1 AS host_4k_last,
          total_last7,
          audio_last7,
          video_last7,
          video_sd_last7,
          video_hd_last7,
          video_hdp_last7,
          host_sd_last7,
          audience_sd_last7,
          host_hd_last7,
          audience_hd_last7,
          host_hdp_last7,
          audience_hdp_last7,
          host_audio_last7,
          audience_audio_last7,
          host_video_last7,
          audience_video_last7,
          audience_audio_low_latency_last7,
          audience_video_low_latency_last7,
          audience_total_low_latency_last7,
          audience_sd_low_latency_last7,
          audience_hd_low_latency_last7,
          audience_hdp_low_latency_last7,
          audience_1080p_low_latency_last7,
          audience_2k_low_latency_last7,
          audience_4k_low_latency_last7,
          audience_audio_ultra_low_latency_last7,
          audience_video_ultra_low_latency_last7,
          audience_total_ultra_low_latency_last7,
          audience_sd_ultra_low_latency_last7,
          audience_hd_ultra_low_latency_last7,
          audience_hdp_ultra_low_latency_last7,
          audience_1080p_ultra_low_latency_last7,
          audience_2k_ultra_low_latency_last7,
          audience_4k_ultra_low_latency_last7,
          audience_2k_last7,
          audience_4k_last7,
          audience_1080p_last7,
          host_1080p_last7,
          host_2k_last7,
          host_4k_last7
        FROM levels_usage_dod_di_1
        WHERE CAST(tag AS VARCHAR) = 'Industry' AND date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-06') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-04') AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS ""自定义 SQL 查询""
    HAVING COUNT(1) > 0) AS ""t0""
WHERE ""自定义 SQL 查询"".""dim"" = 1 AND ""自定义 SQL 查询"".""rank_level1"" = 8 AND date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d') = ""t0"".""__measure__0""
GROUP BY 36"
"SELECT SUM(""自定义 SQL 查询"".""audience_low_latency_last1"") AS ""TEMP(Calculation_230316907702542336)(2007846651)(0)"",
  SUM(""自定义 SQL 查询"".""audience_low_latency"") AS ""TEMP(Calculation_230316907702542336)(2627877912)(0)"",
  SUM(""自定义 SQL 查询"".""total"") AS ""TEMP(Calculation_5203557528859017219)(2253843611)(0)"",
  SUM(""自定义 SQL 查询"".""total_last1"") AS ""TEMP(Calculation_5203557528859017219)(3076278274)(0)"",
  SUM(""自定义 SQL 查询"".""audio_last1"") AS ""TEMP(Calculation_5203557528863870981)(2207581090)(0)"",
  SUM(""自定义 SQL 查询"".""audio"") AS ""TEMP(Calculation_5203557528863870981)(4234702922)(0)"",
  SUM(""自定义 SQL 查询"".""video_last1"") AS ""TEMP(Calculation_5203557528864096263)(1192334319)(0)"",
  SUM(""自定义 SQL 查询"".""video"") AS ""TEMP(Calculation_5203557528864096263)(3647352276)(0)"",
  SUM(""自定义 SQL 查询"".""audience"") AS ""TEMP(Calculation_534802460955746306)(1306364424)(0)"",
  SUM(""自定义 SQL 查询"".""audience_last1"") AS ""TEMP(Calculation_534802460955746306)(2505681848)(0)"",
  SUM(""自定义 SQL 查询"".""audience_audio"") AS ""TEMP(Calculation_534802460956037124)(1868547182)(0)"",
  SUM(""自定义 SQL 查询"".""audience_audio_last1"") AS ""TEMP(Calculation_534802460956037124)(2218970377)(0)"",
  SUM(""自定义 SQL 查询"".""audience_video_last1"") AS ""TEMP(Calculation_534802460956319750)(188915252)(0)"",
  SUM(""自定义 SQL 查询"".""audience_video"") AS ""TEMP(Calculation_534802460956319750)(2182583436)(0)"",
  SUM(""自定义 SQL 查询"".""video_sd"") AS ""TEMP(Calculation_6762858532789223429)(2567841492)(0)"",
  SUM(""自定义 SQL 查询"".""video_hd"") AS ""TEMP(Calculation_6762858532789321734)(3091062117)(0)"",
  SUM(""自定义 SQL 查询"".""video_hdp"") AS ""TEMP(Calculation_6762858532789395463)(207731858)(0)"",
  MAX(""自定义 SQL 查询"".""stat_date"") AS ""TEMP(attr_stat_date_nk)(2102638629)(0)"",
  MIN(""自定义 SQL 查询"".""stat_date"") AS ""TEMP(attr_stat_date_nk)(2790680713)(0)"",
  SUM(""自定义 SQL 查询"".""host_audio_last1"") AS ""TEMP(audience_audio_last1_rate (复制)_534802460956618761)(24"",
  SUM(""自定义 SQL 查询"".""host_audio"") AS ""TEMP(audience_audio_last1_rate (复制)_534802460956618761)(36"",
  SUM(""自定义 SQL 查询"".""host_last1"") AS ""TEMP(audience_last1_rate (复制)_534802460956647435)(15035501"",
  SUM(""自定义 SQL 查询"".""host"") AS ""TEMP(audience_last1_rate (复制)_534802460956647435)(24867219"",
  SUM(""自定义 SQL 查询"".""audience_video_low_latency_last1"") AS ""TEMP(audience_low_latency_last1_rate (复制)_2303169077218304"",
  SUM(""自定义 SQL 查询"".""audience_video_low_latency"") AS ""TEMP(audience_low_latency_last1_rate (复制)_2303169077218301"",
  SUM(""自定义 SQL 查询"".""host_video"") AS ""TEMP(audience_video_last1_rate (复制)_534802460956696589)(26"",
  SUM(""自定义 SQL 查询"".""host_video_last1"") AS ""TEMP(audience_video_last1_rate (复制)_534802460956696589)(42"",
  SUM(""自定义 SQL 查询"".""audience_audio_low_latency"") AS ""sum_audience_audio_low_latency_ok"",
  SUM(""自定义 SQL 查询"".""audience_audio_low_latency_last1"") AS ""sum_audience_audio_low_latency_last1_ok"",
  SUM(""自定义 SQL 查询"".""audience_hd"") AS ""sum_audience_hd_ok"",
  SUM(""自定义 SQL 查询"".""audience_hd_low_latency"") AS ""sum_audience_hd_low_latency_ok"",
  SUM(""自定义 SQL 查询"".""audience_hdp"") AS ""sum_audience_hdp_ok"",
  SUM(""自定义 SQL 查询"".""audience_hdp_low_latency"") AS ""sum_audience_hdp_low_latency_ok"",
  SUM(""自定义 SQL 查询"".""audience_sd"") AS ""sum_audience_sd_ok"",
  SUM(""自定义 SQL 查询"".""audience_sd_low_latency"") AS ""sum_audience_sd_low_latency_ok"",
  SUM(""自定义 SQL 查询"".""audience_video_low_latency"") AS ""sum_audience_video_low_latency_ok"",
  SUM(""自定义 SQL 查询"".""host_hd"") AS ""sum_host_hd_ok"",
  SUM(""自定义 SQL 查询"".""host_hdp"") AS ""sum_host_hdp_ok"",
  SUM(""自定义 SQL 查询"".""host_sd"") AS ""sum_host_sd_ok"",
  DATE_ADD('SECOND', 0, date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d')) AS ""tdy_date_ok""
FROM (SELECT date,
      SUBSTR(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) AS date_range_1,
      SUBSTR(CAST(end_date AS VARCHAR), 1, 10) AS date_range_2,
      stat_period,
        CASE WHEN CAST(stat_period AS VARCHAR) = 'day' THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,
      area,
      vid,
      project,
      company_id AS cid,
      company_name AS company,
      customer_level AS level,
      vid_internal_industry_en AS industry,
      vid_use_case_cn,
      csdc_owner,
      os,
      ver,
      ver_type,
      product_level1,
      product_level2,
      product_level3,
      total,
      audio,
      video,
      video_sd,
      video_hd,
      video_hdp,
        host_audio + host_video AS host,
      host_audio,
      host_video,
      host_sd,
      host_hd,
      host_hdp,
        audience_audio + audience_video AS audience,
        audience_audio_low_latency + audience_video_low_latency AS audience_low_latency,
      audience_audio,
      audience_audio_low_latency,
      audience_video,
      audience_video_low_latency,
      audience_sd,
      audience_sd_low_latency,
      audience_hd,
      audience_hd_low_latency,
      audience_hdp,
      audience_hdp_low_latency,
      total_last1,
      audio_last1,
      video_last1,
      video_sd_last1,
      video_hd_last1,
      video_hdp_last1,
        host_audio_last1 + host_video_last1 AS host_last1,
      host_audio_last1,
      host_video_last1,
        audience_audio_last1 + audience_video_last1 AS audience_last1,
        audience_audio_low_latency_last1 + audience_video_low_latency_last1 AS audience_low_latency_last1,
      audience_audio_last1,
      audience_audio_low_latency_last1,
      audience_video_last1,
      audience_video_low_latency_last1,
      total_last7,
      audio_last7,
      video_last7,
      video_sd_last7,
      video_hd_last7,
      video_hdp_last7,
        host_audio_last7 + host_video_last7 AS host_last7,
      host_audio_last7,
      host_video_last7,
        audience_audio_last7 + audience_video_last7 AS audience_last7,
        audience_audio_low_latency_last7 + audience_video_low_latency_last7 AS audience_low_latency_last7,
      audience_audio_last7,
      audience_audio_low_latency_last7,
      audience_video_last7,
      audience_video_low_latency_last7
    FROM report_datahub.vendor_vid_usage_di_1
    WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-06') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-06') AND CAST(vid AS VARCHAR) = CAST(428342 AS VARCHAR) AND dim = 1) AS ""自定义 SQL 查询""
GROUP BY 40"
"SELECT ""t0"".""__measure__0"" AS ""Calculation_207447066293481472"",
  MAX(""自定义 SQL 查询"".""stat_date"") AS ""TEMP(attr_stat_date_nk)(2102638629)(0)"",
  MIN(""自定义 SQL 查询"".""stat_date"") AS ""TEMP(attr_stat_date_nk)(2790680713)(0)"",
  ""自定义 SQL 查询"".""area"" AS ""area"",
  ""自定义 SQL 查询"".""cid"" AS ""cid"",
  ""自定义 SQL 查询"".""company"" AS ""company"",
  ""自定义 SQL 查询"".""csdc_owner"" AS ""csdc_owner"",
  ""自定义 SQL 查询"".""industry"" AS ""industry"",
  ""自定义 SQL 查询"".""level"" AS ""level"",
  ""自定义 SQL 查询"".""project"" AS ""project"",
  SUM(""自定义 SQL 查询"".""total"") AS ""sum_total_ok"",
  ""自定义 SQL 查询"".""vid"" AS ""vid""
FROM (SELECT date,
      SUBSTR(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) AS date_range_1,
      SUBSTR(CAST(end_date AS VARCHAR), 1, 10) AS date_range_2,
      stat_period,
        CASE WHEN CAST(stat_period AS VARCHAR) = 'day' THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,
      area,
      vid,
      project,
      company_id AS cid,
      company_name AS company,
      customer_level AS level,
      vid_internal_industry_en AS industry,
      vid_use_case_cn,
      csdc_owner,
      os,
      ver,
      ver_type,
      product_level1,
      product_level2,
      product_level3,
      total,
      audio,
      video,
      video_sd,
      video_hd,
      video_hdp,
        host_audio + host_video AS host,
      host_audio,
      host_video,
      host_sd,
      host_hd,
      host_hdp,
        audience_audio + audience_video AS audience,
        audience_audio_low_latency + audience_video_low_latency AS audience_low_latency,
      audience_audio,
      audience_audio_low_latency,
      audience_video,
      audience_video_low_latency,
      audience_sd,
      audience_sd_low_latency,
      audience_hd,
      audience_hd_low_latency,
      audience_hdp,
      audience_hdp_low_latency,
      total_last1,
      audio_last1,
      video_last1,
      video_sd_last1,
      video_hd_last1,
      video_hdp_last1,
        host_audio_last1 + host_video_last1 AS host_last1,
      host_audio_last1,
      host_video_last1,
        audience_audio_last1 + audience_video_last1 AS audience_last1,
        audience_audio_low_latency_last1 + audience_video_low_latency_last1 AS audience_low_latency_last1,
      audience_audio_last1,
      audience_audio_low_latency_last1,
      audience_video_last1,
      audience_video_low_latency_last1,
      total_last7,
      audio_last7,
      video_last7,
      video_sd_last7,
      video_hd_last7,
      video_hdp_last7,
        host_audio_last7 + host_video_last7 AS host_last7,
      host_audio_last7,
      host_video_last7,
        audience_audio_last7 + audience_video_last7 AS audience_last7,
        audience_audio_low_latency_last7 + audience_video_low_latency_last7 AS audience_low_latency_last7,
      audience_audio_last7,
      audience_audio_low_latency_last7,
      audience_video_last7,
      audience_video_low_latency_last7
    FROM report_datahub.vendor_vid_usage_di_1
    WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-06') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-06') AND CAST(vid AS VARCHAR) = CAST(311291 AS VARCHAR) AND dim = 1) AS ""自定义 SQL 查询""
  CROSS JOIN (SELECT MAX(""自定义 SQL 查询"".""vid_use_case_cn"") AS ""__measure__0""
    FROM (SELECT date,
          SUBSTR(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) AS date_range_1,
          SUBSTR(CAST(end_date AS VARCHAR), 1, 10) AS date_range_2,
          stat_period,
            CASE WHEN CAST(stat_period AS VARCHAR) = 'day' THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,
          area,
          vid,
          project,
          company_id AS cid,
          company_name AS company,
          customer_level AS level,
          vid_internal_industry_en AS industry,
          vid_use_case_cn,
          csdc_owner,
          os,
          ver,
          ver_type,
          product_level1,
          product_level2,
          product_level3,
          total,
          audio,
          video,
          video_sd,
          video_hd,
          video_hdp,
            host_audio + host_video AS host,
          host_audio,
          host_video,
          host_sd,
          host_hd,
          host_hdp,
            audience_audio + audience_video AS audience,
            audience_audio_low_latency + audience_video_low_latency AS audience_low_latency,
          audience_audio,
          audience_audio_low_latency,
          audience_video,
          audience_video_low_latency,
          audience_sd,
          audience_sd_low_latency,
          audience_hd,
          audience_hd_low_latency,
          audience_hdp,
          audience_hdp_low_latency,
          total_last1,
          audio_last1,
          video_last1,
          video_sd_last1,
          video_hd_last1,
          video_hdp_last1,
            host_audio_last1 + host_video_last1 AS host_last1,
          host_audio_last1,
          host_video_last1,
            audience_audio_last1 + audience_video_last1 AS audience_last1,
            audience_audio_low_latency_last1 + audience_video_low_latency_last1 AS audience_low_latency_last1,
          audience_audio_last1,
          audience_audio_low_latency_last1,
          audience_video_last1,
          audience_video_low_latency_last1,
          total_last7,
          audio_last7,
          video_last7,
          video_sd_last7,
          video_hd_last7,
          video_hdp_last7,
            host_audio_last7 + host_video_last7 AS host_last7,
          host_audio_last7,
          host_video_last7,
            audience_audio_last7 + audience_video_last7 AS audience_last7,
            audience_audio_low_latency_last7 + audience_video_low_latency_last7 AS audience_low_latency_last7,
          audience_audio_last7,
          audience_audio_low_latency_last7,
          audience_video_last7,
          audience_video_low_latency_last7
        FROM report_datahub.vendor_vid_usage_di_1
        WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-06') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-06') AND CAST(vid AS VARCHAR) = CAST(311291 AS VARCHAR) AND dim = 1) AS ""自定义 SQL 查询""
    HAVING COUNT(1) > 0) AS ""t0""
GROUP BY 1,
  4,
  5,
  6,
  7,
  8,
  9,
  10,
  12"
"SELECT ""自定义 SQL 查询"".""product_type"" AS ""product_type""
FROM (SELECT date AS ""date"",
      src_domain AS ""srcDomain"",
      src_country AS ""srcCountry"",
      dest_idc AS ""idc"",
      speaker_ip_isp AS ""srcisp"",
      speaker_vos_ip,
      delay_25 AS ""p2s_Delay25"",
      delay_50 AS ""p2s_Delay50"",
      delay_75 AS ""p2s_Delay75"",
      delay_100 AS ""p2s_Delay100"",
      delay_125 AS ""p2s_Delay125"",
      delay_150 AS ""p2s_Delay150"",
      delay_total,
      lost_ratio_5 AS ""p2s_lostRatio"",
      lostratio_total AS ""p2s_total"",
      jitter95_50 AS ""p2s_jitter95_50"",
      jitter95_100 AS ""p2s_jitter95_100"",
      jitter95_200 AS ""p2s_jitter95_200"",
      jitter95_300 AS ""p2s_jitter95_300"",
      jitter95_total,
      product_line,
      product_type
    FROM media.p2s_cover_oversea_ip
    WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-25') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-01')) AS ""自定义 SQL 查询""
GROUP BY 1
ORDER BY ""product_type"""
"SELECT SUM(""自定义 SQL 查询"".""host_4k"") AS ""TEMP(Calculation_3519281700079370244)(1075454865)(0)"",
  SUM(""自定义 SQL 查询"".""audience_sd"") AS ""TEMP(Calculation_3519281700079370244)(1133678835)(0)"",
  SUM(""自定义 SQL 查询"".""host_1080p"") AS ""TEMP(Calculation_3519281700079370244)(1312501967)(0)"",
  SUM(""自定义 SQL 查询"".""host_hd"") AS ""TEMP(Calculation_3519281700079370244)(276907208)(0)"",
  SUM(""自定义 SQL 查询"".""video"") AS ""TEMP(Calculation_3519281700079370244)(2929708110)(0)"",
  SUM(""自定义 SQL 查询"".""audience_hd"") AS ""TEMP(Calculation_3519281700079370244)(2930728935)(0)"",
  SUM(""自定义 SQL 查询"".""audience_hdp"") AS ""TEMP(Calculation_3519281700079370244)(3010533957)(0)"",
  SUM(""自定义 SQL 查询"".""host_hdp"") AS ""TEMP(Calculation_3519281700079370244)(30306054)(0)"",
  SUM(""自定义 SQL 查询"".""host_audio"") AS ""TEMP(Calculation_3519281700079370244)(3087054365)(0)"",
  SUM(""自定义 SQL 查询"".""audio"") AS ""TEMP(Calculation_3519281700079370244)(3299350010)(0)"",
  SUM(""自定义 SQL 查询"".""audience_1080p"") AS ""TEMP(Calculation_3519281700079370244)(3628946582)(0)"",
  SUM(""自定义 SQL 查询"".""totalUsage"") AS ""TEMP(Calculation_3519281700079370244)(3847882359)(0)"",
  SUM(""自定义 SQL 查询"".""audience_audio"") AS ""TEMP(Calculation_3519281700079370244)(4109514392)(0)"",
  SUM(""自定义 SQL 查询"".""host_2k"") AS ""TEMP(Calculation_3519281700079370244)(586790827)(0)"",
  SUM(""自定义 SQL 查询"".""host_sd"") AS ""TEMP(Calculation_3519281700079370244)(709512178)(0)"",
  SUM(""自定义 SQL 查询"".""audience_4k"") AS ""TEMP(Calculation_3519281700079370244)(764410224)(0)"",
  SUM(""自定义 SQL 查询"".""audience_2k"") AS ""TEMP(Calculation_3519281700079370244)(943764407)(0)"",
  SUM(""自定义 SQL 查询"".""host_4k_last"") AS ""TEMP(Calculation_3519281700083154949)(101123376)(0)"",
  SUM(""自定义 SQL 查询"".""audience_video_hdp_last"") AS ""TEMP(Calculation_3519281700083154949)(1200517625)(0)"",
  SUM(""自定义 SQL 查询"".""audience_1080p_last"") AS ""TEMP(Calculation_3519281700083154949)(1314346200)(0)"",
  SUM(""自定义 SQL 查询"".""audience_video_hd_last"") AS ""TEMP(Calculation_3519281700083154949)(146570423)(0)"",
  SUM(""自定义 SQL 查询"".""audience_2k_last"") AS ""TEMP(Calculation_3519281700083154949)(1717771635)(0)"",
  SUM(""自定义 SQL 查询"".""audience_audio_last"") AS ""TEMP(Calculation_3519281700083154949)(2313111073)(0)"",
  SUM(""自定义 SQL 查询"".""host_video_hdp_last"") AS ""TEMP(Calculation_3519281700083154949)(258310559)(0)"",
  SUM(""自定义 SQL 查询"".""audio_video_last"") AS ""TEMP(Calculation_3519281700083154949)(2820618408)(0)"",
  SUM(""自定义 SQL 查询"".""audience_4k_last"") AS ""TEMP(Calculation_3519281700083154949)(3121859593)(0)"",
  SUM(""自定义 SQL 查询"".""host_1080p_last"") AS ""TEMP(Calculation_3519281700083154949)(3222422303)(0)"",
  SUM(""自定义 SQL 查询"".""host_audio_last"") AS ""TEMP(Calculation_3519281700083154949)(3227677803)(0)"",
  SUM(""自定义 SQL 查询"".""video_last"") AS ""TEMP(Calculation_3519281700083154949)(3934387163)(0)"",
  SUM(""自定义 SQL 查询"".""host_2k_last"") AS ""TEMP(Calculation_3519281700083154949)(4055292783)(0)"",
  SUM(""自定义 SQL 查询"".""audio_last"") AS ""TEMP(Calculation_3519281700083154949)(4091190060)(0)"",
  SUM(""自定义 SQL 查询"".""host_video_hd_last"") AS ""TEMP(Calculation_3519281700083154949)(4170367250)(0)"",
  SUM(""自定义 SQL 查询"".""host_video_sd_last"") AS ""TEMP(Calculation_3519281700083154949)(4190307025)(0)"",
  SUM(""自定义 SQL 查询"".""audience_video_sd_last"") AS ""TEMP(Calculation_3519281700083154949)(933007102)(0)"",
  MAX(""自定义 SQL 查询"".""stat_date"") AS ""TEMP(attr_stat_date_nk)(2102638629)(0)"",
  MIN(""自定义 SQL 查询"".""stat_date"") AS ""TEMP(attr_stat_date_nk)(2790680713)(0)"",
  ""自定义 SQL 查询"".""level1"" AS ""level1"",
  SUM(""自定义 SQL 查询"".""totalUsage"") AS ""sum_totalUsage_ok"",
  DATE_ADD('SECOND', 0, date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d')) AS ""tdy_date_ok""
FROM (SELECT date,
        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,
      start_date AS start_date_7,
      end_date AS end_date,
      tag,
      area AS Scope,
      dim,
        CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,
      level2,
      level3,
      level4,
      product_level1 AS product_line,
      product_level2,
      product_level3,
      product_level4,
      vid_internal_industry_en AS cid_industry,
      vid_use_case_en AS vid_use_case_cn,
      vid_sector_en,
      ver_type,
      ver,
      os,
      domain,
      country,
      region,
      dim_grouping_name,
        CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,
      total AS totalUsage,
      audio,
      video,
      host_audio,
      audience_audio,
      host_sd,
      host_hd,
      host_hdp,
      host_1080p,
      host_2k,
      host_4k,
      audience_sd,
      audience_hd,
      audience_hdp,
      audience_1080p,
      audience_2k,
      audience_4k,
      audience_audio_low_latency,
      audience_sd_low_latency,
      audience_hd_low_latency,
      audience_hdp_low_latency,
      audience_1080p_low_latency,
      audience_2k_low_latency,
      audience_4k_low_latency,
      audience_audio_ultra_low_latency,
      audience_sd_ultra_low_latency,
      audience_hd_ultra_low_latency,
      audience_hdp_ultra_low_latency,
      audience_1080p_ultra_low_latency,
      audience_2k_ultra_low_latency,
      audience_4k_ultra_low_latency,
      total_last1 AS audio_video_last,
      audio_last1 AS audio_last,
      video_last1 AS video_last,
      video_sd_last1 AS video_sd_last,
      video_hd_last1 AS video_hd_last,
      video_hdp_last1 AS video_hdp_last,
      host_sd_last1 AS host_video_sd_last,
      audience_sd_last1 AS audience_video_sd_last,
      host_hd_last1 AS host_video_hd_last,
      audience_hd_last1 AS audience_video_hd_last,
      host_hdp_last1 AS host_video_hdp_last,
      audience_hdp_last1 AS audience_video_hdp_last,
      host_audio_last1 AS host_audio_last,
      audience_audio_last1 AS audience_audio_last,
      host_video_last1 AS host_video_last,
      audience_video_last1 AS audience_video_last,
      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,
      audience_video_low_latency_last1 AS audience_video_low_latency_last,
      audience_total_low_latency_last1 AS audience_total_low_latency_last,
      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,
      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,
      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,
      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,
      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,
      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,
      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,
      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,
      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,
      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,
      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,
      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,
      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,
      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,
      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,
      audience_2k_last1 AS audience_2k_last,
      audience_4k_last1 AS audience_4k_last,
      audience_1080p_last1 AS audience_1080p_last,
      host_1080p_last1 AS host_1080p_last,
      host_2k_last1 AS host_2k_last,
      host_4k_last1 AS host_4k_last,
      total_last7,
      audio_last7,
      video_last7,
      video_sd_last7,
      video_hd_last7,
      video_hdp_last7,
      host_sd_last7,
      audience_sd_last7,
      host_hd_last7,
      audience_hd_last7,
      host_hdp_last7,
      audience_hdp_last7,
      host_audio_last7,
      audience_audio_last7,
      host_video_last7,
      audience_video_last7,
      audience_audio_low_latency_last7,
      audience_video_low_latency_last7,
      audience_total_low_latency_last7,
      audience_sd_low_latency_last7,
      audience_hd_low_latency_last7,
      audience_hdp_low_latency_last7,
      audience_1080p_low_latency_last7,
      audience_2k_low_latency_last7,
      audience_4k_low_latency_last7,
      audience_audio_ultra_low_latency_last7,
      audience_video_ultra_low_latency_last7,
      audience_total_ultra_low_latency_last7,
      audience_sd_ultra_low_latency_last7,
      audience_hd_ultra_low_latency_last7,
      audience_hdp_ultra_low_latency_last7,
      audience_1080p_ultra_low_latency_last7,
      audience_2k_ultra_low_latency_last7,
      audience_4k_ultra_low_latency_last7,
      audience_2k_last7,
      audience_4k_last7,
      audience_1080p_last7,
      host_1080p_last7,
      host_2k_last7,
      host_4k_last7
    FROM levels_usage_dod_di_1
    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-06') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-04') AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS ""自定义 SQL 查询""
WHERE ""自定义 SQL 查询"".""dim"" = 1 AND ""自定义 SQL 查询"".""rank_level1"" = 6
GROUP BY 37,
  39"
"SELECT SUM(""自定义 SQL 查询"".""s2l_25ms_delay_sec"") AS ""TEMP(Calculation_1430244791154503680)(2227145667)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_total_delay_sec"") AS ""TEMP(Calculation_1430244791154503680)(2460078802)(0)"",
  SUM(""自定义 SQL 查询"".""5s_succ_join_ap_cnt"") AS ""TEMP(Calculation_1430244791247978510)(1716451703)(0)"",
  SUM(""自定义 SQL 查询"".""total_join_ap_cnt"") AS ""TEMP(Calculation_1430244791247978510)(2681092799)(0)"",
  SUM(""自定义 SQL 查询"".""video_totaltime_200"") AS ""TEMP(Calculation_3430124447289356289)(2104207895)(0)"",
  SUM(""自定义 SQL 查询"".""video_freeze_time_200"") AS ""TEMP(Calculation_3430124447289356289)(530162565)(0)"",
  SUM(""自定义 SQL 查询"".""video_freeze_time_500"") AS ""TEMP(Calculation_3430124447289524226)(389023081)(0)"",
  SUM(""自定义 SQL 查询"".""video_totaltime_500"") AS ""TEMP(Calculation_3430124447289524226)(458654145)(0)"",
  SUM(""自定义 SQL 查询"".""totalJoin"") AS ""TEMP(Calculation_374009936508170240)(2073556184)(0)"",
  SUM(""自定义 SQL 查询"".""totalJoinSuccess"") AS ""TEMP(Calculation_374009936508170240)(2807417001)(0)"",
  SUM(""自定义 SQL 查询"".""threeSecJoinSuccess"") AS ""TEMP(Calculation_374009936508321793)(3693645608)(0)"",
  SUM(""自定义 SQL 查询"".""fiveSecJoinSuccess"") AS ""TEMP(Calculation_374009936508416002)(383616769)(0)"",
  SUM(""自定义 SQL 查询"".""video_totaltime"") AS ""TEMP(Calculation_374009936515215363)(2797449586)(0)"",
  SUM(""自定义 SQL 查询"".""video_freeze_time"") AS ""TEMP(Calculation_374009936515215363)(2940759860)(0)"",
  SUM(""自定义 SQL 查询"".""audio_freeze_time_200"") AS ""TEMP(Calculation_374009936517861380)(1946708283)(0)"",
  SUM(""自定义 SQL 查询"".""audio_totaltime_200"") AS ""TEMP(Calculation_374009936517861380)(784477006)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_lost_Leq5"") AS ""TEMP(Calculation_374009936519704581)(1936123547)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_lost_all"") AS ""TEMP(Calculation_374009936519704581)(749826584)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_75ms_delay_sec"") AS ""TEMP(Calculation_6542393318886285312)(2003933318)(0)"",
  SUM(""自定义 SQL 查询"".""crash_cnt"") AS ""TEMP(Calculation_7034341207372070925)(2360900687)(0)"",
  SUM(""自定义 SQL 查询"".""service_cnt"") AS ""TEMP(Calculation_7034341207372070925)(4291252132)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_lost_Leq5"") AS ""TEMP(Calculation_939915332871118850)(2745840127)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_lost_all"") AS ""TEMP(Calculation_939915332871118850)(734589263)(0)"",
  DATE_ADD('SECOND', 0, date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d')) AS ""tdy_date_ok""
FROM (SELECT ts.*,
      fiveSecJoinSuccess_total,
      threeSecJoinSuccess_total,
      totalJoinSuccess_total,
      totalJoin_total,
      cnt_sid_total,
      ""1s_succ_join_ap_cnt_total"",
      ""5s_succ_join_ap_cnt_total"",
      total_join_ap_cnt_total,
      audio_freeze_time_200_total,
      audio_totaltime_200_total,
      video_freeze_time_total,
      video_totaltime_total,
      p2s_lost_Leq5_total,
      p2s_lost_all_total,
      s2l_25ms_delay_sec_total,
      s2l_75ms_delay_sec_total,
      s2l_total_delay_sec_total,
      crash_cnt_total,
      service_cnt_total,
      ""5s_succ_join_session_cnt_last1_total"",
      ""3s_succ_join_session_cnt_last1_total"",
      succ_join_session_cnt_last1_total,
      total_join_session_cnt_last1_total,
      total_session_cnt_last1_total,
      ""1s_succ_join_ap_cnt_last1_total"",
      ""5s_succ_join_ap_cnt_last1_total"",
      total_join_ap_cnt_last1_total,
      video_freeze_time_last1_total,
      video_totaltime_last1_total,
      p2s_lost_Leq5_last1_total,
      p2s_lost_all_last1_total,
      s2l_25ms_delay_sec_last1_total,
      s2l_75ms_delay_sec_last1_total,
      s2l_total_delay_sec_last1_total,
      crash_cnt_last1_total,
      service_cnt_last1_total,
      audio_freeze_time_200_last1_total,
      audio_totaltime_200_last1_total,
      ""5s_succ_join_session_cnt_last7_total"",
      ""3s_succ_join_session_cnt_last7_total"",
      succ_join_session_cnt_last7_total,
      total_join_session_cnt_last7_total,
      total_session_cnt_last7_total,
      ""7s_succ_join_ap_cnt_last7_total"",
      ""5s_succ_join_ap_cnt_last7_total"",
      total_join_ap_cnt_last7_total,
      video_freeze_time_last7_total,
      video_totaltime_last7_total,
      p2s_lost_Leq5_last7_total,
      p2s_lost_all_last7_total,
      s2l_25ms_delay_sec_last7_total,
      s2l_75ms_delay_sec_last7_total,
      s2l_total_delay_sec_last7_total,
      crash_cnt_last7_total,
      service_cnt_last7_total,
      audio_freeze_time_200_last7_total,
      audio_totaltime_200_last7_total,
      video_freeze_time_500_total,
      video_totaltime_500_total,
      video_freeze_time_200_total,
      video_totaltime_200_total,
      video_freeze_time_500_last1_total,
      video_totaltime_500_last1_total,
      video_freeze_time_200_last1_total,
      video_totaltime_200_last1_total,
      video_freeze_time_500_last7_total,
      video_totaltime_500_last7_total,
      video_freeze_time_200_last7_total,
      video_totaltime_200_last7_total,
      s2l_lost_Leq5_total,
      s2l_lost_all_total,
      s2l_lost_Leq5_last1_total,
      s2l_lost_all_last1_total,
      s2l_lost_Leq5_last7_total,
      s2l_lost_all_last7_total
    FROM (SELECT vid,
          project,
          company_id,
          area,
          company_name,
          industry_name,
          date,
            CASE WHEN CAST(stat_period AS VARCHAR) = 'day' THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(substr(CAST(start_date AS VARCHAR), 1, 10) AS VARCHAR), '~', CAST(substr(CAST(end_date AS VARCHAR), 1, 10) AS VARCHAR)) END AS period,
          net,
          os,
          ver,
          'osver' AS dim,
          product_level_1,
          product_level_2,
          ver_type,
          SUM(fiveSecJoinSuccess) AS fiveSecJoinSuccess,
          SUM(threeSecJoinSuccess) AS threeSecJoinSuccess,
          SUM(totalJoinSuccess) AS totalJoinSuccess,
          SUM(totalJoin) AS totalJoin,
          SUM(cnt_sid) AS cnt_sid,
          SUM(""1s_succ_join_ap_cnt"") AS ""1s_succ_join_ap_cnt"",
          SUM(""5s_succ_join_ap_cnt"") AS ""5s_succ_join_ap_cnt"",
          SUM(total_join_ap_cnt) AS total_join_ap_cnt,
          SUM(audio_freeze_time_200) AS audio_freeze_time_200,
          SUM(audio_totaltime_200) AS audio_totaltime_200,
          SUM(video_freeze_time) AS video_freeze_time,
          SUM(video_totaltime) AS video_totaltime,
          SUM(p2s_lost_Leq5) AS p2s_lost_Leq5,
          SUM(p2s_lost_all) AS p2s_lost_all,
          SUM(s2l_25ms_delay_sec) AS s2l_25ms_delay_sec,
          SUM(s2l_75ms_delay_sec) AS s2l_75ms_delay_sec,
          SUM(s2l_total_delay_sec) AS s2l_total_delay_sec,
          SUM(crash_cnt) AS crash_cnt,
          SUM(service_cnt) AS service_cnt,
          SUM(""5s_succ_join_session_cnt_last1"") AS ""5s_succ_join_session_cnt_last1"",
          SUM(""3s_succ_join_session_cnt_last1"") AS ""3s_succ_join_session_cnt_last1"",
          SUM(succ_join_session_cnt_last1) AS succ_join_session_cnt_last1,
          SUM(total_join_session_cnt_last1) AS total_join_session_cnt_last1,
          SUM(total_session_cnt_last1) AS total_session_cnt_last1,
          SUM(""1s_succ_join_ap_cnt_last1"") AS ""1s_succ_join_ap_cnt_last1"",
          SUM(""5s_succ_join_ap_cnt_last1"") AS ""5s_succ_join_ap_cnt_last1"",
          SUM(total_join_ap_cnt_last1) AS total_join_ap_cnt_last1,
          SUM(video_freeze_time_last1) AS video_freeze_time_last1,
          SUM(video_totaltime_last1) AS video_totaltime_last1,
          SUM(p2s_lost_Leq5_last1) AS p2s_lost_Leq5_last1,
          SUM(p2s_lost_all_last1) AS p2s_lost_all_last1,
          SUM(s2l_25ms_delay_sec_last1) AS s2l_25ms_delay_sec_last1,
          SUM(s2l_75ms_delay_sec_last1) AS s2l_75ms_delay_sec_last1,
          SUM(s2l_total_delay_sec_last1) AS s2l_total_delay_sec_last1,
          SUM(crash_cnt_last1) AS crash_cnt_last1,
          SUM(service_cnt_last1) AS service_cnt_last1,
          SUM(audio_freeze_time_200_last1) AS audio_freeze_time_200_last1,
          SUM(audio_totaltime_200_last1) AS audio_totaltime_200_last1,
          SUM(""5s_succ_join_session_cnt_last7"") AS ""5s_succ_join_session_cnt_last7"",
          SUM(""3s_succ_join_session_cnt_last7"") AS ""3s_succ_join_session_cnt_last7"",
          SUM(succ_join_session_cnt_last7) AS succ_join_session_cnt_last7,
          SUM(total_join_session_cnt_last7) AS total_join_session_cnt_last7,
          SUM(total_session_cnt_last7) AS total_session_cnt_last7,
          SUM(""1s_succ_join_ap_cnt_last7"") AS ""7s_succ_join_ap_cnt_last7"",
          SUM(""5s_succ_join_ap_cnt_last7"") AS ""5s_succ_join_ap_cnt_last7"",
          SUM(total_join_ap_cnt_last7) AS total_join_ap_cnt_last7,
          SUM(video_freeze_time_last7) AS video_freeze_time_last7,
          SUM(video_totaltime_last7) AS video_totaltime_last7,
          SUM(p2s_lost_Leq5_last7) AS p2s_lost_Leq5_last7,
          SUM(p2s_lost_all_last7) AS p2s_lost_all_last7,
          SUM(s2l_25ms_delay_sec_last7) AS s2l_25ms_delay_sec_last7,
          SUM(s2l_75ms_delay_sec_last7) AS s2l_75ms_delay_sec_last7,
          SUM(s2l_total_delay_sec_last7) AS s2l_total_delay_sec_last7,
          SUM(crash_cnt_last7) AS crash_cnt_last7,
          SUM(service_cnt_last7) AS service_cnt_last7,
          SUM(audio_freeze_time_200_last7) AS audio_freeze_time_200_last7,
          SUM(audio_totaltime_200_last7) AS audio_totaltime_200_last7,
          SUM(video_freeze_time_500) AS video_freeze_time_500,
          SUM(video_totaltime_500) AS video_totaltime_500,
          SUM(video_freeze_time_200) AS video_freeze_time_200,
          SUM(video_totaltime_200) AS video_totaltime_200,
          SUM(video_freeze_time_500_last1) AS video_freeze_time_500_last1,
          SUM(video_totaltime_500_last1) AS video_totaltime_500_last1,
          SUM(video_freeze_time_200_last1) AS video_freeze_time_200_last1,
          SUM(video_totaltime_200_last1) AS video_totaltime_200_last1,
          SUM(video_freeze_time_500_last7) AS video_freeze_time_500_last7,
          SUM(video_totaltime_500_last7) AS video_totaltime_500_last7,
          SUM(video_freeze_time_200_last7) AS video_freeze_time_200_last7,
          SUM(video_totaltime_200_last7) AS video_totaltime_200_last7,
          SUM(s2l_lost_Leq5) AS s2l_lost_Leq5,
          SUM(s2l_lost_all) AS s2l_lost_all,
          SUM(s2l_lost_Leq5_last1) AS s2l_lost_Leq5_last1,
          SUM(s2l_lost_all_last1) AS s2l_lost_all_last1,
          SUM(s2l_lost_Leq5_last7) AS s2l_lost_Leq5_last7,
          SUM(s2l_lost_all_last7) AS s2l_lost_all_last7
        FROM report_datahub.vid_osver_net_cp_domain_quality_di_1
        WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-21') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-11-21') AND CAST(vid AS VARCHAR) = CAST(281104 AS VARCHAR) AND CAST(product_level_2 AS VARCHAR) = 'Native'
        GROUP BY vid,
          project,
          company_id,
          area,
          company_name,
          industry_name,
          date,
          net,
          os,
          ver,
          product_level_1,
          product_level_2,
          ver_type,
            CASE WHEN CAST(stat_period AS VARCHAR) = 'day' THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(substr(CAST(start_date AS VARCHAR), 1, 10) AS VARCHAR), '~', CAST(substr(CAST(end_date AS VARCHAR), 1, 10) AS VARCHAR)) END) AS ts
      LEFT JOIN (SELECT vid,
          date,
          SUM(fiveSecJoinSuccess) AS fiveSecJoinSuccess_total,
          SUM(threeSecJoinSuccess) AS threeSecJoinSuccess_total,
          SUM(totalJoinSuccess) AS totalJoinSuccess_total,
          SUM(totalJoin) AS totalJoin_total,
          SUM(cnt_sid) AS cnt_sid_total,
          SUM(""1s_succ_join_ap_cnt"") AS ""1s_succ_join_ap_cnt_total"",
          SUM(""5s_succ_join_ap_cnt"") AS ""5s_succ_join_ap_cnt_total"",
          SUM(total_join_ap_cnt) AS total_join_ap_cnt_total,
          SUM(audio_freeze_time_200) AS audio_freeze_time_200_total,
          SUM(audio_totaltime_200) AS audio_totaltime_200_total,
          SUM(video_freeze_time) AS video_freeze_time_total,
          SUM(video_totaltime) AS video_totaltime_total,
          SUM(p2s_lost_Leq5) AS p2s_lost_Leq5_total,
          SUM(p2s_lost_all) AS p2s_lost_all_total,
          SUM(s2l_25ms_delay_sec) AS s2l_25ms_delay_sec_total,
          SUM(s2l_75ms_delay_sec) AS s2l_75ms_delay_sec_total,
          SUM(s2l_total_delay_sec) AS s2l_total_delay_sec_total,
          SUM(crash_cnt) AS crash_cnt_total,
          SUM(service_cnt) AS service_cnt_total,
          SUM(""5s_succ_join_session_cnt_last1"") AS ""5s_succ_join_session_cnt_last1_total"",
          SUM(""3s_succ_join_session_cnt_last1"") AS ""3s_succ_join_session_cnt_last1_total"",
          SUM(succ_join_session_cnt_last1) AS succ_join_session_cnt_last1_total,
          SUM(total_join_session_cnt_last1) AS total_join_session_cnt_last1_total,
          SUM(total_session_cnt_last1) AS total_session_cnt_last1_total,
          SUM(""1s_succ_join_ap_cnt_last1"") AS ""1s_succ_join_ap_cnt_last1_total"",
          SUM(""5s_succ_join_ap_cnt_last1"") AS ""5s_succ_join_ap_cnt_last1_total"",
          SUM(total_join_ap_cnt_last1) AS total_join_ap_cnt_last1_total,
          SUM(video_freeze_time_last1) AS video_freeze_time_last1_total,
          SUM(video_totaltime_last1) AS video_totaltime_last1_total,
          SUM(p2s_lost_Leq5_last1) AS p2s_lost_Leq5_last1_total,
          SUM(p2s_lost_all_last1) AS p2s_lost_all_last1_total,
          SUM(s2l_25ms_delay_sec_last1) AS s2l_25ms_delay_sec_last1_total,
          SUM(s2l_75ms_delay_sec_last1) AS s2l_75ms_delay_sec_last1_total,
          SUM(s2l_total_delay_sec_last1) AS s2l_total_delay_sec_last1_total,
          SUM(crash_cnt_last1) AS crash_cnt_last1_total,
          SUM(service_cnt_last1) AS service_cnt_last1_total,
          SUM(audio_freeze_time_200_last1) AS audio_freeze_time_200_last1_total,
          SUM(audio_totaltime_200_last1) AS audio_totaltime_200_last1_total,
          SUM(""5s_succ_join_session_cnt_last7"") AS ""5s_succ_join_session_cnt_last7_total"",
          SUM(""3s_succ_join_session_cnt_last7"") AS ""3s_succ_join_session_cnt_last7_total"",
          SUM(succ_join_session_cnt_last7) AS succ_join_session_cnt_last7_total,
          SUM(total_join_session_cnt_last7) AS total_join_session_cnt_last7_total,
          SUM(total_session_cnt_last7) AS total_session_cnt_last7_total,
          SUM(""1s_succ_join_ap_cnt_last7"") AS ""7s_succ_join_ap_cnt_last7_total"",
          SUM(""5s_succ_join_ap_cnt_last7"") AS ""5s_succ_join_ap_cnt_last7_total"",
          SUM(total_join_ap_cnt_last7) AS total_join_ap_cnt_last7_total,
          SUM(video_freeze_time_last7) AS video_freeze_time_last7_total,
          SUM(video_totaltime_last7) AS video_totaltime_last7_total,
          SUM(p2s_lost_Leq5_last7) AS p2s_lost_Leq5_last7_total,
          SUM(p2s_lost_all_last7) AS p2s_lost_all_last7_total,
          SUM(s2l_25ms_delay_sec_last7) AS s2l_25ms_delay_sec_last7_total,
          SUM(s2l_75ms_delay_sec_last7) AS s2l_75ms_delay_sec_last7_total,
          SUM(s2l_total_delay_sec_last7) AS s2l_total_delay_sec_last7_total,
          SUM(crash_cnt_last7) AS crash_cnt_last7_total,
          SUM(service_cnt_last7) AS service_cnt_last7_total,
          SUM(audio_freeze_time_200_last7) AS audio_freeze_time_200_last7_total,
          SUM(audio_totaltime_200_last7) AS audio_totaltime_200_last7_total,
          SUM(video_freeze_time_500) AS video_freeze_time_500_total,
          SUM(video_totaltime_500) AS video_totaltime_500_total,
          SUM(video_freeze_time_200) AS video_freeze_time_200_total,
          SUM(video_totaltime_200) AS video_totaltime_200_total,
          SUM(video_freeze_time_500_last1) AS video_freeze_time_500_last1_total,
          SUM(video_totaltime_500_last1) AS video_totaltime_500_last1_total,
          SUM(video_freeze_time_200_last1) AS video_freeze_time_200_last1_total,
          SUM(video_totaltime_200_last1) AS video_totaltime_200_last1_total,
          SUM(video_freeze_time_500_last7) AS video_freeze_time_500_last7_total,
          SUM(video_totaltime_500_last7) AS video_totaltime_500_last7_total,
          SUM(video_freeze_time_200_last7) AS video_freeze_time_200_last7_total,
          SUM(video_totaltime_200_last7) AS video_totaltime_200_last7_total,
          SUM(s2l_lost_Leq5) AS s2l_lost_Leq5_total,
          SUM(s2l_lost_all) AS s2l_lost_all_total,
          SUM(s2l_lost_Leq5_last1) AS s2l_lost_Leq5_last1_total,
          SUM(s2l_lost_all_last1) AS s2l_lost_all_last1_total,
          SUM(s2l_lost_Leq5_last7) AS s2l_lost_Leq5_last7_total,
          SUM(s2l_lost_all_last7) AS s2l_lost_all_last7_total
        FROM report_datahub.vid_osver_net_cp_domain_quality_di_1
        WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-21') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-11-21') AND CAST(vid AS VARCHAR) = CAST(281104 AS VARCHAR) AND CAST(product_level_2 AS VARCHAR) = 'Native'
        GROUP BY vid,
          date) AS tt ON CAST(ts.vid AS VARCHAR) = CAST(tt.vid AS VARCHAR) AND ts.date = tt.date) AS ""自定义 SQL 查询""
WHERE CAST(""自定义 SQL 查询"".""dim"" AS VARCHAR) = 'osver'
GROUP BY 24"
"SELECT SUM(""自定义 SQL 查询"".""host_4k"") AS ""TEMP(Calculation_3519281700079370244)(1075454865)(0)"",
  SUM(""自定义 SQL 查询"".""audience_sd"") AS ""TEMP(Calculation_3519281700079370244)(1133678835)(0)"",
  SUM(""自定义 SQL 查询"".""host_1080p"") AS ""TEMP(Calculation_3519281700079370244)(1312501967)(0)"",
  SUM(""自定义 SQL 查询"".""host_hd"") AS ""TEMP(Calculation_3519281700079370244)(276907208)(0)"",
  SUM(""自定义 SQL 查询"".""video"") AS ""TEMP(Calculation_3519281700079370244)(2929708110)(0)"",
  SUM(""自定义 SQL 查询"".""audience_hd"") AS ""TEMP(Calculation_3519281700079370244)(2930728935)(0)"",
  SUM(""自定义 SQL 查询"".""audience_hdp"") AS ""TEMP(Calculation_3519281700079370244)(3010533957)(0)"",
  SUM(""自定义 SQL 查询"".""host_hdp"") AS ""TEMP(Calculation_3519281700079370244)(30306054)(0)"",
  SUM(""自定义 SQL 查询"".""host_audio"") AS ""TEMP(Calculation_3519281700079370244)(3087054365)(0)"",
  SUM(""自定义 SQL 查询"".""audio"") AS ""TEMP(Calculation_3519281700079370244)(3299350010)(0)"",
  SUM(""自定义 SQL 查询"".""audience_1080p"") AS ""TEMP(Calculation_3519281700079370244)(3628946582)(0)"",
  SUM(""自定义 SQL 查询"".""totalUsage"") AS ""TEMP(Calculation_3519281700079370244)(3847882359)(0)"",
  SUM(""自定义 SQL 查询"".""audience_audio"") AS ""TEMP(Calculation_3519281700079370244)(4109514392)(0)"",
  SUM(""自定义 SQL 查询"".""host_2k"") AS ""TEMP(Calculation_3519281700079370244)(586790827)(0)"",
  SUM(""自定义 SQL 查询"".""host_sd"") AS ""TEMP(Calculation_3519281700079370244)(709512178)(0)"",
  SUM(""自定义 SQL 查询"".""audience_4k"") AS ""TEMP(Calculation_3519281700079370244)(764410224)(0)"",
  SUM(""自定义 SQL 查询"".""audience_2k"") AS ""TEMP(Calculation_3519281700079370244)(943764407)(0)"",
  ""自定义 SQL 查询"".""level1"" AS ""level1"",
  SUM(""自定义 SQL 查询"".""totalUsage"") AS ""sum_totalUsage_ok"",
  DATE_ADD('SECOND', 0, date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d')) AS ""tdy_date_ok""
FROM (SELECT date,
        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,
      start_date AS start_date_7,
      end_date AS end_date,
      tag,
      area AS Scope,
      dim,
        CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,
      level2,
      level3,
      level4,
      product_level1 AS product_line,
      product_level2,
      product_level3,
      product_level4,
      vid_internal_industry_en AS cid_industry,
      vid_use_case_en AS vid_use_case_cn,
      vid_sector_en,
      ver_type,
      ver,
      os,
      domain,
      country,
      region,
      dim_grouping_name,
        CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,
      total AS totalUsage,
      audio,
      video,
      host_audio,
      audience_audio,
      host_sd,
      host_hd,
      host_hdp,
      host_1080p,
      host_2k,
      host_4k,
      audience_sd,
      audience_hd,
      audience_hdp,
      audience_1080p,
      audience_2k,
      audience_4k,
      audience_audio_low_latency,
      audience_sd_low_latency,
      audience_hd_low_latency,
      audience_hdp_low_latency,
      audience_1080p_low_latency,
      audience_2k_low_latency,
      audience_4k_low_latency,
      audience_audio_ultra_low_latency,
      audience_sd_ultra_low_latency,
      audience_hd_ultra_low_latency,
      audience_hdp_ultra_low_latency,
      audience_1080p_ultra_low_latency,
      audience_2k_ultra_low_latency,
      audience_4k_ultra_low_latency,
      total_last1 AS audio_video_last,
      audio_last1 AS audio_last,
      video_last1 AS video_last,
      video_sd_last1 AS video_sd_last,
      video_hd_last1 AS video_hd_last,
      video_hdp_last1 AS video_hdp_last,
      host_sd_last1 AS host_video_sd_last,
      audience_sd_last1 AS audience_video_sd_last,
      host_hd_last1 AS host_video_hd_last,
      audience_hd_last1 AS audience_video_hd_last,
      host_hdp_last1 AS host_video_hdp_last,
      audience_hdp_last1 AS audience_video_hdp_last,
      host_audio_last1 AS host_audio_last,
      audience_audio_last1 AS audience_audio_last,
      host_video_last1 AS host_video_last,
      audience_video_last1 AS audience_video_last,
      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,
      audience_video_low_latency_last1 AS audience_video_low_latency_last,
      audience_total_low_latency_last1 AS audience_total_low_latency_last,
      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,
      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,
      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,
      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,
      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,
      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,
      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,
      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,
      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,
      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,
      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,
      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,
      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,
      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,
      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,
      audience_2k_last1 AS audience_2k_last,
      audience_4k_last1 AS audience_4k_last,
      audience_1080p_last1 AS audience_1080p_last,
      host_1080p_last1 AS host_1080p_last,
      host_2k_last1 AS host_2k_last,
      host_4k_last1 AS host_4k_last,
      total_last7,
      audio_last7,
      video_last7,
      video_sd_last7,
      video_hd_last7,
      video_hdp_last7,
      host_sd_last7,
      audience_sd_last7,
      host_hd_last7,
      audience_hd_last7,
      host_hdp_last7,
      audience_hdp_last7,
      host_audio_last7,
      audience_audio_last7,
      host_video_last7,
      audience_video_last7,
      audience_audio_low_latency_last7,
      audience_video_low_latency_last7,
      audience_total_low_latency_last7,
      audience_sd_low_latency_last7,
      audience_hd_low_latency_last7,
      audience_hdp_low_latency_last7,
      audience_1080p_low_latency_last7,
      audience_2k_low_latency_last7,
      audience_4k_low_latency_last7,
      audience_audio_ultra_low_latency_last7,
      audience_video_ultra_low_latency_last7,
      audience_total_ultra_low_latency_last7,
      audience_sd_ultra_low_latency_last7,
      audience_hd_ultra_low_latency_last7,
      audience_hdp_ultra_low_latency_last7,
      audience_1080p_ultra_low_latency_last7,
      audience_2k_ultra_low_latency_last7,
      audience_4k_ultra_low_latency_last7,
      audience_2k_last7,
      audience_4k_last7,
      audience_1080p_last7,
      host_1080p_last7,
      host_2k_last7,
      host_4k_last7
    FROM levels_usage_dod_di_1
    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-06') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-04') AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS ""自定义 SQL 查询""
  CROSS JOIN (SELECT MAX(date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d')) AS ""__measure__0""
    FROM (SELECT date,
            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,
          start_date AS start_date_7,
          end_date AS end_date,
          tag,
          area AS Scope,
          dim,
            CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,
          level2,
          level3,
          level4,
          product_level1 AS product_line,
          product_level2,
          product_level3,
          product_level4,
          vid_internal_industry_en AS cid_industry,
          vid_use_case_en AS vid_use_case_cn,
          vid_sector_en,
          ver_type,
          ver,
          os,
          domain,
          country,
          region,
          dim_grouping_name,
            CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,
          total AS totalUsage,
          audio,
          video,
          host_audio,
          audience_audio,
          host_sd,
          host_hd,
          host_hdp,
          host_1080p,
          host_2k,
          host_4k,
          audience_sd,
          audience_hd,
          audience_hdp,
          audience_1080p,
          audience_2k,
          audience_4k,
          audience_audio_low_latency,
          audience_sd_low_latency,
          audience_hd_low_latency,
          audience_hdp_low_latency,
          audience_1080p_low_latency,
          audience_2k_low_latency,
          audience_4k_low_latency,
          audience_audio_ultra_low_latency,
          audience_sd_ultra_low_latency,
          audience_hd_ultra_low_latency,
          audience_hdp_ultra_low_latency,
          audience_1080p_ultra_low_latency,
          audience_2k_ultra_low_latency,
          audience_4k_ultra_low_latency,
          total_last1 AS audio_video_last,
          audio_last1 AS audio_last,
          video_last1 AS video_last,
          video_sd_last1 AS video_sd_last,
          video_hd_last1 AS video_hd_last,
          video_hdp_last1 AS video_hdp_last,
          host_sd_last1 AS host_video_sd_last,
          audience_sd_last1 AS audience_video_sd_last,
          host_hd_last1 AS host_video_hd_last,
          audience_hd_last1 AS audience_video_hd_last,
          host_hdp_last1 AS host_video_hdp_last,
          audience_hdp_last1 AS audience_video_hdp_last,
          host_audio_last1 AS host_audio_last,
          audience_audio_last1 AS audience_audio_last,
          host_video_last1 AS host_video_last,
          audience_video_last1 AS audience_video_last,
          audience_audio_low_latency_last1 AS audience_audio_low_latency_last,
          audience_video_low_latency_last1 AS audience_video_low_latency_last,
          audience_total_low_latency_last1 AS audience_total_low_latency_last,
          audience_sd_low_latency_last1 AS audience_sd_low_latency_last,
          audience_hd_low_latency_last1 AS audience_hd_low_latency_last,
          audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,
          audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,
          audience_2k_low_latency_last1 AS audience_2k_low_latency_last,
          audience_4k_low_latency_last1 AS audience_4k_low_latency_last,
          audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,
          audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,
          audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,
          audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,
          audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,
          audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,
          audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,
          audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,
          audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,
          audience_2k_last1 AS audience_2k_last,
          audience_4k_last1 AS audience_4k_last,
          audience_1080p_last1 AS audience_1080p_last,
          host_1080p_last1 AS host_1080p_last,
          host_2k_last1 AS host_2k_last,
          host_4k_last1 AS host_4k_last,
          total_last7,
          audio_last7,
          video_last7,
          video_sd_last7,
          video_hd_last7,
          video_hdp_last7,
          host_sd_last7,
          audience_sd_last7,
          host_hd_last7,
          audience_hd_last7,
          host_hdp_last7,
          audience_hdp_last7,
          host_audio_last7,
          audience_audio_last7,
          host_video_last7,
          audience_video_last7,
          audience_audio_low_latency_last7,
          audience_video_low_latency_last7,
          audience_total_low_latency_last7,
          audience_sd_low_latency_last7,
          audience_hd_low_latency_last7,
          audience_hdp_low_latency_last7,
          audience_1080p_low_latency_last7,
          audience_2k_low_latency_last7,
          audience_4k_low_latency_last7,
          audience_audio_ultra_low_latency_last7,
          audience_video_ultra_low_latency_last7,
          audience_total_ultra_low_latency_last7,
          audience_sd_ultra_low_latency_last7,
          audience_hd_ultra_low_latency_last7,
          audience_hdp_ultra_low_latency_last7,
          audience_1080p_ultra_low_latency_last7,
          audience_2k_ultra_low_latency_last7,
          audience_4k_ultra_low_latency_last7,
          audience_2k_last7,
          audience_4k_last7,
          audience_1080p_last7,
          host_1080p_last7,
          host_2k_last7,
          host_4k_last7
        FROM levels_usage_dod_di_1
        WHERE CAST(tag AS VARCHAR) = 'Industry' AND date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-06') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-04') AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS ""自定义 SQL 查询""
    HAVING COUNT(1) > 0) AS ""t0""
WHERE ""自定义 SQL 查询"".""dim"" = 1 AND ""自定义 SQL 查询"".""rank_level1"" = 5 AND date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d') = ""t0"".""__measure__0""
GROUP BY 18,
  20"
"SELECT ""自定义 SQL 查询"".""dest_ip"" AS ""dest_ip"",
  ""自定义 SQL 查询"".""idc"" AS ""idc"",
  ""自定义 SQL 查询"".""srcRegion"" AS ""srcRegion"",
  ""自定义 SQL 查询"".""src_isp"" AS ""src_isp"",
    CASE WHEN SUM(""自定义 SQL 查询"".""p2s_total"") >= 0 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100 THEN '0-100' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 1000 THEN '100-1000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 1000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 10000 THEN '1000-10000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 10000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100000 THEN '10000-100000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100000 THEN '100000以上' ELSE 'other' END AS ""usr_Calculation_5363224211558019075_nk""
FROM (SELECT date AS ""date"",
      src_domain AS ""srcDomain"",
      src_region AS ""srcRegion"",
      dest_idc AS ""idc"",
      src_isp,
      dest_ip,
      delay_25 AS ""p2s_Delay25"",
      delay_50 AS ""p2s_Delay50"",
      delay_75 AS ""p2s_Delay75"",
      delay_100 AS ""p2s_Delay100"",
      delay_125 AS ""p2s_Delay125"",
      delay_150 AS ""p2s_Delay150"",
      delay_total,
      lost_ratio_5 AS ""p2s_lostRatio"",
      lostratio_total AS ""p2s_total"",
      jitter95_50 AS ""p2s_jitter95_50"",
      jitter95_100 AS ""p2s_jitter95_100"",
      jitter95_200 AS ""p2s_jitter95_200"",
      jitter95_300 AS ""p2s_jitter95_300"",
      jitter95_total,
      product_line,
      product_type
    FROM media.p2s_cover_mainland_ip
    WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-25') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-01')) AS ""自定义 SQL 查询""
GROUP BY 1,
  2,
  3,
  4"
"SELECT SUM(""自定义 SQL 查询"".""p2s_Delay25"" * ""自定义 SQL 查询"".""delay_total"") AS ""TEMP(Calculation_6634083767547871232)(1563607262)(0)"",
  SUM(""自定义 SQL 查询"".""delay_total"") AS ""TEMP(Calculation_6634083767547871232)(363980608)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_Delay50"" * ""自定义 SQL 查询"".""delay_total"") AS ""TEMP(Calculation_6634083767548375041)(1551638771)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_Delay75"" * ""自定义 SQL 查询"".""delay_total"") AS ""TEMP(Calculation_6634083767548604418)(2562427304)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_lostRatio"" * ""自定义 SQL 查询"".""p2s_total"") AS ""TEMP(Calculation_6634083767550464005)(1741181994)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_total"") AS ""TEMP(Calculation_6634083767550464005)(2624355999)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_jitter95_50"" * ""自定义 SQL 查询"".""jitter95_total"") AS ""TEMP(Calculation_6634083767551082502)(1652714847)(0)"",
  SUM(""自定义 SQL 查询"".""jitter95_total"") AS ""TEMP(Calculation_6634083767551082502)(633698484)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_jitter95_100"" * ""自定义 SQL 查询"".""jitter95_total"") AS ""TEMP(Calculation_6634083767551520776)(3609783325)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_jitter95_200"" * ""自定义 SQL 查询"".""jitter95_total"") AS ""TEMP(Calculation_6634083767551815690)(206867949)(0)"",
  ""自定义 SQL 查询"".""srcDomain"" AS ""srcDomain"",
  DATE_ADD('SECOND', 0, date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d')) AS ""tdy_date_ok""
FROM (SELECT date,
      src_domain AS ""srcDomain"",
      delay_25 AS ""p2s_Delay25"",
      delay_50 AS ""p2s_Delay50"",
      delay_75 AS ""p2s_Delay75"",
      delay_100 AS ""p2s_Delay100"",
      delay_125 AS ""p2s_Delay125"",
      delay_150 AS ""p2s_Delay150"",
      delay_total,
      lost_ratio_5 AS ""p2s_lostRatio"",
      lostratio_total AS ""p2s_total"",
      jitter95_50 AS ""p2s_jitter95_50"",
      jitter95_100 AS ""p2s_jitter95_100"",
      jitter95_200 AS ""p2s_jitter95_200"",
      jitter95_300 AS ""p2s_jitter95_300"",
      jitter95_total,
      product_line,
      product_type
    FROM media.p2s_cover_domain
    WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-25') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-01')) AS ""自定义 SQL 查询""
GROUP BY 11,
  12"
"SELECT SUM(""自定义 SQL 查询"".""delay75"") AS ""TEMP(Calculation_3094043381461454849)(2419700853)(0)"",
  SUM(""自定义 SQL 查询"".""delay_total"") AS ""TEMP(Calculation_3094043381461454849)(363980608)(0)"",
  SUM(""自定义 SQL 查询"".""lost_ratio_5"") AS ""TEMP(Calculation_3094043381461549058)(1479243093)(0)"",
  SUM(""自定义 SQL 查询"".""lost_total"") AS ""TEMP(Calculation_3094043381461549058)(154362899)(0)"",
  ""自定义 SQL 查询"".""country"" AS ""country"",
  DATE_ADD('SECOND', 0, date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d')) AS ""tdy_date_ok""
FROM (SELECT *
    FROM media.sdrtn_okr_notvpn
    WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-16') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-11-29')) AS ""自定义 SQL 查询""
GROUP BY 5,
  6
HAVING CASE WHEN SUM(""自定义 SQL 查询"".""delay25"") / SUM(""自定义 SQL 查询"".""delay_total"") >= 0.5 AND SUM(""自定义 SQL 查询"".""delay75"") / SUM(""自定义 SQL 查询"".""delay_total"") >= 0.90000000000000002 AND SUM(""自定义 SQL 查询"".""lost_ratio_5"") / SUM(""自定义 SQL 查询"".""lost_total"") >= 0.96499999999999997 THEN 0 ELSE 1 END"
"SELECT ""自定义 SQL 查询"".""product_level2"" AS ""product_level2"",
  SUM(""自定义 SQL 查询"".""total"") AS ""sum_total_ok""
FROM (SELECT date,
      SUBSTR(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) AS date_range_1,
      SUBSTR(CAST(end_date AS VARCHAR), 1, 10) AS date_range_2,
      stat_period,
        CASE WHEN CAST(stat_period AS VARCHAR) = 'day' THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,
      area,
      vid,
      project,
      company_id AS cid,
      company_name AS company,
      customer_level AS level,
      vid_internal_industry_en AS industry,
      vid_use_case_cn,
      csdc_owner,
      os,
      ver,
      ver_type,
      product_level1,
      product_level2,
      product_level3,
      total,
      audio,
      video,
      video_sd,
      video_hd,
      video_hdp,
        host_audio + host_video AS host,
      host_audio,
      host_video,
      host_sd,
      host_hd,
      host_hdp,
        audience_audio + audience_video AS audience,
        audience_audio_low_latency + audience_video_low_latency AS audience_low_latency,
      audience_audio,
      audience_audio_low_latency,
      audience_video,
      audience_video_low_latency,
      audience_sd,
      audience_sd_low_latency,
      audience_hd,
      audience_hd_low_latency,
      audience_hdp,
      audience_hdp_low_latency,
      total_last1,
      audio_last1,
      video_last1,
      video_sd_last1,
      video_hd_last1,
      video_hdp_last1,
        host_audio_last1 + host_video_last1 AS host_last1,
      host_audio_last1,
      host_video_last1,
        audience_audio_last1 + audience_video_last1 AS audience_last1,
        audience_audio_low_latency_last1 + audience_video_low_latency_last1 AS audience_low_latency_last1,
      audience_audio_last1,
      audience_audio_low_latency_last1,
      audience_video_last1,
      audience_video_low_latency_last1,
      total_last7,
      audio_last7,
      video_last7,
      video_sd_last7,
      video_hd_last7,
      video_hdp_last7,
        host_audio_last7 + host_video_last7 AS host_last7,
      host_audio_last7,
      host_video_last7,
        audience_audio_last7 + audience_video_last7 AS audience_last7,
        audience_audio_low_latency_last7 + audience_video_low_latency_last7 AS audience_low_latency_last7,
      audience_audio_last7,
      audience_audio_low_latency_last7,
      audience_video_last7,
      audience_video_low_latency_last7
    FROM report_datahub.vendor_vid_usage_di_1
    WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-06') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-06') AND CAST(vid AS VARCHAR) = CAST(311291 AS VARCHAR) AND dim = 1) AS ""自定义 SQL 查询""
GROUP BY 1"
"SELECT ""自定义 SQL 查询"".""idc"" AS ""idc""
FROM (SELECT date AS ""date"",
      src_domain AS ""srcDomain"",
      src_region AS ""srcRegion"",
      dest_idc AS ""idc"",
      delay_25 AS ""p2s_Delay25"",
      delay_50 AS ""p2s_Delay50"",
      delay_75 AS ""p2s_Delay75"",
      delay_100 AS ""p2s_Delay100"",
      delay_125 AS ""p2s_Delay125"",
      delay_150 AS ""p2s_Delay150"",
      delay_total,
      lost_ratio_5 AS ""p2s_lostRatio"",
      lostratio_total AS ""p2s_total"",
      jitter95_50 AS ""p2s_jitter95_50"",
      jitter95_100 AS ""p2s_jitter95_100"",
      jitter95_200 AS ""p2s_jitter95_200"",
      jitter95_300 AS ""p2s_jitter95_300"",
      jitter95_total,
      product_line,
      product_type
    FROM media.p2s_cover_mainland_ip
    WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-25') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-01')) AS ""自定义 SQL 查询""
WHERE ""自定义 SQL 查询"".""idc"" IN ('aofei-frankfurt1g', 'aofei-hk1ga', 'aofei-japan', 'aofei-singapore1ga', 'aofei-tokyo9', 'changchun1g-cucc', 'changsha-cucc', 'changsha9-ctel', 'eq-newyork10', 'eq-newyork9', 'evc-chicago1g', 'evc-frankfurt1ga', 'evc-frankfurt9', 'evc-japan9a', 'evc-seattle1g', 'evc-singapore1ga', 'evc-singapore1gb', 'fuzhou1g-cmcc', 'guangzhou-cmcc', 'guangzhou0t-drpeng', 'guangzhou1g-cmcc', 'guangzhou6js-bgp', 'guangzhou99-cmcc', 'hangzhou6al-bgp', 'hangzhou9-ctel', 'hangzhou9b-cmcc', 'hefei9-cmcc', 'huainan1g-cmcc', 'huhehaote1g-ctel', 'huzhou9-ctel', 'huzhou9-cucc', 'jinan1g-3line', 'jinan1g-cucc', 'jinan6bdbm-cucc', 'jinan9-cmcc', 'jiujiang9-ctel', 'langfang6uc-cucc', 'nanchang1g-cmcc', 'neijiang1g-ctel', 'ningbo1g-3line', 'qingdao1g-ctel', 'qinhuangdao1g-cucc', 'shanghai6js-bgp', 'shantou1g-ctel', 'shenyang1g-cmcc', 'shenyang9a-cucc', 'suzhou1g-cmcc', 'suzhou6bdbm-ctel', 'taiyuan6bd-ctel', 'taiyuan6bdbm-ctel', 'taiyuan9-cucc', 'tangshan9-cucc', 'tangshan99-cucc', 'tianjin1ga-ctel', 'tianjin3g-3line', 'wujiang-ctel', 'wuxi3c-bgp', 'xiamen6bd-ctel', 'xiamen6bdbm-ctel', 'xinxiang1g-cucc', 'yancheng1g-ctel', 'yantai1g-cucc', 'yiyang1g-cucc', 'yueyang6bd-ctel', 'yueyang6bdbm-ctel', 'zaozhuang9b-cucc', 'zen-amsterdam9b', 'zen-bangalore1ga', 'zen-bangkok', 'zen-chennai1ga', 'zen-dallas1g', 'zen-frankfurt1g', 'zen-frankfurt1gb', 'zen-hk9b', 'zen-losangeles9', 'zen-losangeles9a', 'zen-melbourne9a', 'zen-miami1g', 'zen-moscow2', 'zen-saopaulo2', 'zen-singapore1ga', 'zen-singapore1gb', 'zen-singapore3a', 'zen-washington1ga') OR ( (  ""自定义 SQL 查询"".""idc""  ) is null) OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'baoji1g-ctel' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'beijing-bgp' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'beijing6-bgp' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'beijing8-bgp' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'changsha1g-3line' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'changsha1g-cucc' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'changzhou9a-drpeng' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'chengdu6al-bgp' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'chongqing1g-3line' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'chongqing1ga-ctel' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'dalian1g-cmcc' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'eq-losangeles9' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'foshan1g-ctel' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'foshan9-ctel' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'guizhou1g-ctel' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'hangzhou3g-3line' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'lishui1g-ctel' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'luoyang1g-ctel' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'nanchang6bd-ctel' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'nanchang6uc-ctel' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'qinhuangdao9-cucc' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'retn-amsterdam0t' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'shenzhen9-drpeng' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'singtel-singapore0t' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'taizhou1g-3line' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'taizhou9-cucc' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'tianjin1g-cmcc' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'tianjin1g-cucc' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'tianjin9-ctel' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'tianjin9d-cucc' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'wenzhou1g-cmcc' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'wenzhou9-cmcc' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'xian1g-cmcc' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'xiangyang1g-cmcc' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'xixian9-ctel' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'xuzhou9b-ctel' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'yancheng9-cmcc' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'yancheng9b-ctel' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'yangzhou1g-cmcc' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'yangzhou6uc-3line' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'zen-amsterdam1' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'zen-amsterdam3' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'zen-frankfurt9a' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'zen-hk1gb' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'zen-japan' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'zen-japan9' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'zen-london1ga' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'zen-london3' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'zen-london9a' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'zen-losangeles3' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'zen-mumbai1ga' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'zen-mumbai9' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'zen-singapore9b' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'zen-tokyo1g' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'zhangjiakou1gb-cmcc' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'zhengzhou6bd-cucc' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'zhenjiang1g-3line' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'zhuzhou1g-ctel'
GROUP BY 1
ORDER BY ""idc"""
"SELECT ""自定义 SQL 查询"".""level3"" AS ""level3""
FROM (SELECT date,
        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,
      start_date AS start_date_7,
      end_date AS end_date,
      tag,
      area AS Scope,
      dim,
        CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,
      level2,
      level3,
      level4,
      product_level1 AS product_line,
      product_level2,
      product_level3,
      product_level4,
      vid_internal_industry_en AS cid_industry,
      vid_use_case_en AS vid_use_case_cn,
      vid_sector_en,
      ver_type,
      ver,
      os,
      domain,
      country,
      region,
      dim_grouping_name,
        CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,
      total AS totalUsage,
      audio,
      video,
      host_audio,
      audience_audio,
      host_sd,
      host_hd,
      host_hdp,
      host_1080p,
      host_2k,
      host_4k,
      audience_sd,
      audience_hd,
      audience_hdp,
      audience_1080p,
      audience_2k,
      audience_4k,
      audience_audio_low_latency,
      audience_sd_low_latency,
      audience_hd_low_latency,
      audience_hdp_low_latency,
      audience_1080p_low_latency,
      audience_2k_low_latency,
      audience_4k_low_latency,
      audience_audio_ultra_low_latency,
      audience_sd_ultra_low_latency,
      audience_hd_ultra_low_latency,
      audience_hdp_ultra_low_latency,
      audience_1080p_ultra_low_latency,
      audience_2k_ultra_low_latency,
      audience_4k_ultra_low_latency,
      total_last1 AS audio_video_last,
      audio_last1 AS audio_last,
      video_last1 AS video_last,
      video_sd_last1 AS video_sd_last,
      video_hd_last1 AS video_hd_last,
      video_hdp_last1 AS video_hdp_last,
      host_sd_last1 AS host_video_sd_last,
      audience_sd_last1 AS audience_video_sd_last,
      host_hd_last1 AS host_video_hd_last,
      audience_hd_last1 AS audience_video_hd_last,
      host_hdp_last1 AS host_video_hdp_last,
      audience_hdp_last1 AS audience_video_hdp_last,
      host_audio_last1 AS host_audio_last,
      audience_audio_last1 AS audience_audio_last,
      host_video_last1 AS host_video_last,
      audience_video_last1 AS audience_video_last,
      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,
      audience_video_low_latency_last1 AS audience_video_low_latency_last,
      audience_total_low_latency_last1 AS audience_total_low_latency_last,
      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,
      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,
      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,
      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,
      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,
      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,
      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,
      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,
      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,
      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,
      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,
      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,
      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,
      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,
      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,
      audience_2k_last1 AS audience_2k_last,
      audience_4k_last1 AS audience_4k_last,
      audience_1080p_last1 AS audience_1080p_last,
      host_1080p_last1 AS host_1080p_last,
      host_2k_last1 AS host_2k_last,
      host_4k_last1 AS host_4k_last,
      total_last7,
      audio_last7,
      video_last7,
      video_sd_last7,
      video_hd_last7,
      video_hdp_last7,
      host_sd_last7,
      audience_sd_last7,
      host_hd_last7,
      audience_hd_last7,
      host_hdp_last7,
      audience_hdp_last7,
      host_audio_last7,
      audience_audio_last7,
      host_video_last7,
      audience_video_last7,
      audience_audio_low_latency_last7,
      audience_video_low_latency_last7,
      audience_total_low_latency_last7,
      audience_sd_low_latency_last7,
      audience_hd_low_latency_last7,
      audience_hdp_low_latency_last7,
      audience_1080p_low_latency_last7,
      audience_2k_low_latency_last7,
      audience_4k_low_latency_last7,
      audience_audio_ultra_low_latency_last7,
      audience_video_ultra_low_latency_last7,
      audience_total_ultra_low_latency_last7,
      audience_sd_ultra_low_latency_last7,
      audience_hd_ultra_low_latency_last7,
      audience_hdp_ultra_low_latency_last7,
      audience_1080p_ultra_low_latency_last7,
      audience_2k_ultra_low_latency_last7,
      audience_4k_ultra_low_latency_last7,
      audience_2k_last7,
      audience_4k_last7,
      audience_1080p_last7,
      host_1080p_last7,
      host_2k_last7,
      host_4k_last7
    FROM levels_usage_dod_di_1
    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-06') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-04') AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS ""自定义 SQL 查询""
GROUP BY 1
ORDER BY ""level3"""
"SELECT SUM(""自定义 SQL 查询"".""p2s_Delay25"" * ""自定义 SQL 查询"".""delay_total"") AS ""TEMP(Calculation_1231523447811919872)(1563607262)(0)"",
  SUM(""自定义 SQL 查询"".""delay_total"") AS ""TEMP(Calculation_1231523447811919872)(363980608)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_Delay50"" * ""自定义 SQL 查询"".""delay_total"") AS ""TEMP(Calculation_1231523447812059137)(1551638771)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_Delay75"" * ""自定义 SQL 查询"".""delay_total"") AS ""TEMP(Calculation_1231523447812194306)(2562427304)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_lostRatio"" * ""自定义 SQL 查询"".""p2s_total"") AS ""TEMP(Calculation_1231523447812321283)(1741181994)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_total"") AS ""TEMP(Calculation_1231523447812321283)(2624355999)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_Delay125"" * ""自定义 SQL 查询"".""delay_total"") AS ""TEMP(Calculation_4208191644284768271)(3242688810)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_Delay150"" * ""自定义 SQL 查询"".""delay_total"") AS ""TEMP(Calculation_4208191644285206544)(1276673441)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_jitter95_50"" * ""自定义 SQL 查询"".""jitter95_total"") AS ""TEMP(Calculation_4208191644285542417)(1652714847)(0)"",
  SUM(""自定义 SQL 查询"".""jitter95_total"") AS ""TEMP(Calculation_4208191644285542417)(633698484)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_jitter95_100"" * ""自定义 SQL 查询"".""jitter95_total"") AS ""TEMP(Calculation_4208191644285714450)(3609783325)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_jitter95_200"" * ""自定义 SQL 查询"".""jitter95_total"") AS ""TEMP(Calculation_4208191644285919251)(206867949)(0)"",
  ""自定义 SQL 查询"".""idc"" AS ""idc"",
  ""自定义 SQL 查询"".""srcCountry"" AS ""srcCountry"",
  ""自定义 SQL 查询"".""srcDomain"" AS ""srcDomain"",
  ""自定义 SQL 查询"".""srcisp"" AS ""srcisp"",
  SUM(""自定义 SQL 查询"".""p2s_total"") AS ""sum_p2s_total_ok""
FROM (SELECT date AS ""date"",
      src_domain AS ""srcDomain"",
      src_country AS ""srcCountry"",
      dest_idc AS ""idc"",
      speaker_ip_isp AS ""srcisp"",
      speaker_vos_ip,
      delay_25 AS ""p2s_Delay25"",
      delay_50 AS ""p2s_Delay50"",
      delay_75 AS ""p2s_Delay75"",
      delay_100 AS ""p2s_Delay100"",
      delay_125 AS ""p2s_Delay125"",
      delay_150 AS ""p2s_Delay150"",
      delay_total,
      lost_ratio_5 AS ""p2s_lostRatio"",
      lostratio_total AS ""p2s_total"",
      jitter95_50 AS ""p2s_jitter95_50"",
      jitter95_100 AS ""p2s_jitter95_100"",
      jitter95_200 AS ""p2s_jitter95_200"",
      jitter95_300 AS ""p2s_jitter95_300"",
      jitter95_total,
      product_line,
      product_type
    FROM media.p2s_cover_oversea_ip
    WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-25') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-01')) AS ""自定义 SQL 查询""
WHERE ""自定义 SQL 查询"".""srcisp"" IN ('1telecom.com.br', '21.com.pk', '3s.com.tn', '4inet.com.br', '73s.com.br', 'a1.by', 'a1.si', 'a3.se', 'aan-ict.com', 'aapt.com.au', 'abcom.al', 'absolutnet.com.br', 'accesshaiti.com', 'acelerate.com', 'acertelecom.com.br', 'acesso10.net.br', 'acessotelecomunicacoes.com.br', 'actcorp.in', 'afghan-wireless.com', 'afghantelecom.af', 'africell.ug', 'afriqnetworks.co.ke', 'agatangelo.com.br', 'agni.com', 'aguasdelcolorado-lp.com.ar', 'airmax.com.pk', 'airnet.net.br', 'airtel.cd', 'airtel.cg', 'airtel.co.rw', 'airtel.co.tz', 'airtel.co.ug', 'airtel.co.zm', 'airtel.com', 'airtel.mg', 'airtel.mw', 'airtel.ne', 'airtel.td', 'ais.co.th', 'aknet.kg', 'albtelecom.al', 'alfa.com.lb', 'alfanet.az', 'alfanet.tv', 'algartelecom.com.br', 'algerietelecom.dz', 'ALIYUN', 'aljeel.ly', 'allconecta.com.br', 'allo.my', 'almadarisp.com', 'aloo.com.br', 'alriyada-net.net', 'alsardfiber.com', 'altanettelecom.com.br', 'altice.com.do', 'amatelecom.com.br', 'amazon.com', 'americanet.com.br', 'americatel.com.pe', 'amorimtelecom.com.br', 'amplia.co.tt', 'amturbonet.com.br', 'anditel.com.co', 'angolacables.co.ao', 'ans.af', 'antel.com.uy', 'aoun-networks.com', 'apsfl.in', 'aptg.com.tw', 'aranetinfo.com.br', 'ariasat.af', 'ariastelecom.com.br', 'ario.net', 'arn.dz', 'arsat.com.ar', 'artnet.pl', 'asiabtelecom.com', 'asiacell.com', 'asianvision.com.ph', 'ask4.com', 'asnet.com.br', 'asolucaoinfo.com.br', 'aster.com.do', 'ativanetwork.com.br', 'att.com', 'avantel.co', 'avianet.com.br', 'awasr.com', 'aya.sy', 'azercell.com', 'azeronline.com', 'azeurotel.com', 'azqtel.com', 'azstarnet.az', 'aztecacomunicaciones.com', 'aztelekom.az', 'babilon-t.tj', 'baehost.com', 'baghdad-link.com', 'bakcell.com', 'baktelecom.az', 'baktun.com.gt', 'batelco.com', 'bayan.com.ph', 'beeline.am', 'beeline.kg', 'beeline.kz', 'beeline.ru', 'beeline.tj', 'beeline.uz', 'belizetelemedia.net', 'beltelecom.by', 'beskidmedia.pl', 'bezeqint.net', 'bhtelecom.ba', 'bitakat.sy', 'bitcom.psi.br', 'bitel.com.pe', 'blinkload.cloud', 'blue.net.gt', 'bmjnet.com.br', 'bnet.ps', 'bouyguestelecom.fr', 'brasilinfo.net.br', 'brasilnetcp.net.br', 'brasnetinformatica.com.br', 'brcentral.com.br', 'bredband2.com', 'brisanet.com.br', 'brsite.com.br', 'brxtelecom.com.br', 'bsnl.co.in', 'bt.bt', 'bt.com', 'btc.bw', 'btcbahamas.com', 'buana.net', 'buechele-networks.de', 'bvitourism.com', 'bwtelecom.com', 'cabangu.com.br', 'cablebahamas.com', 'cablecolor.hn', 'cabledelancer.com', 'cabledelnorte.com', 'cablelink.com.ph', 'cablemar.net', 'cablemax.com.do', 'cablenet.com.cy', 'cableonda.com', 'cableondaoriental.com', 'cabletica.com', 'cablevision.com.ar', 'canal-plus.com', 'canar.sd', 'cantv.com.ve', 'caribcable.com', 'caribserve.net', 'caxiasontelecom.com.br', 'cdn77.com', 'cdns.net', 'cednet.com.br', 'celcom.com.my', 'cell-net.net', 'cellc.co.za', 'cellcom.co.il', 'centraltv.bz', 'centurylink.com', 'ceranetworks.com', 'ceretechs.com', 'charter.com', 'ChinaMobile', 'ChinaTelecom', 'ChinaUnicom', 'chinguitel.mr', 'chltech.net', 'choopa.com', 'cht.com.tw', 'citicableworld.com', 'claro.com.ar', 'claro.com.br', 'claro.com.co', 'claro.com.do', 'claro.com.ec', 'claro.com.gt', 'claro.com.hn', 'claro.com.ni', 'claro.com.pa', 'claro.com.pe', 'claro.com.sv', 'claro.cr', 'clarochile.cl', 'claropr.com', 'clearpath.net.ph', 'clig.com.br', 'clnetworks-sa.com', 'cloudflare.com', 'cloudinnovation.org', 'clouvider.co.uk', 'clubnet.co.mz', 'cmet.net', 'cnet.af', 'cnt.gob.ec', 'cogentco.com', 'colombiamastv.co', 'colombiatel.co', 'colsecor.com.ar', 'comcast.com', 'comhem.se', 'comnt.com.br', 'comteco.com.bo', 'conectaminas.com.br', 'conectbm.com.br', 'conectcor.com.br', 'conective.sv', 'conexaotelecom.net.br', 'connect.az', 'connect.net.pk', 'connecti.net.br', 'connectinternet.com.br', 'conquesttelecom.com.br', 'convergeict.com', 'convergenze.it', 'coolnet.ps', 'coopetel.org', 'cooptortu.com.ar', 'copaco.com.py', 'copeltelecom.com', 'cosmote.gr', 'costadosol.tv.br', 'cotas.com', 'cotecal.com.ar', 'cotel.bo', 'cprm.net', 'csuc.cat', 'cte.net.br', 'cwc.com', 'cwnetworks.com', 'cwpanama.com', 'cyber.net.pk', 'cyberia.net.lb', 'cyberwave.com.ar', 'dascacable.com', 'datanet.iq', 'dauphintelecom.com', 'davitel.com.ar', 'dcc.ps', 'dctv.com.ph', 'delta-telecom.net', 'delta-x.ua', 'desktop.com.br', 'destinycable.com.ph', 'dflash.com.br', 'dialnet.net', 'dialog.lk', 'digi.com.my', 'digicelgroup.com', 'digimobil.es', 'digital-vm.com', 'digitalocean.com', 'digitel.com.ve', 'digitel.ph', 'dimensiondata.com', 'directv.com.ar', 'directvla.com.co', 'discoverflow.co', 'dishtele.com', 'djiboutitelecom.dj', 'dna.fi', 'docomopacific.com', 'domru.ru', 'DRPENG', 'dtac.co.th', 'du.ae', 'dumaimandirinet.id', 'e-lcom.sy', 'eaglenet.net.lb', 'earthlink.iq', 'eastlink.ca', 'ecom.net.do', 'edatel.com.co', 'ee.co.uk', 'elcat.kg', 'elisa.ee', 'elsuhdnet.com', 'embratel.com.br', 'emcali.net.co', 'emtel.net.co', 'engeplus.com.br', 'enlacevision.com', 'enredhn.com', 'entel.bo', 'entel.cl', 'entel.pe', 'enteriw.com.br', 'ert.com.co', 'estnoc.ee', 'estrelatel.com', 'etapa.net.ec', 'etb.com', 'etecsa.cu', 'ethiotelecom.et', 'ethtelecom.com.br', 'etisalat.ae', 'etisalat.af', 'etisalat.eg', 'etllao.com', 'evo.uz', 'exitovision.com', 'expand.tv.br', 'express.com.ar', 'faciliti.com.br', 'falco-networks.com', 'farahnet.net.lb', 'fariya.com', 'farsroute.af', 'fastiraq.com', 'fastnetisp.com', 'fastprovedor.net.br', 'fdnet.com.br', 'fetnet.net', 'fiber-sat.net', 'fiberathome.my', 'fiberbandalarga.com.br', 'fibercom.com.pk', 'fibergrid.net', 'fiberlink.net.pk', 'fibernet.uz', 'fibertelecom-isp.com.br', 'fiberwaves.com', 'fiberway.com.ar', 'fiberx.net', 'fibra1.com.br', 'fibralink.com.br', 'fibranet.ec', 'filprod-dgte.ph', 'fittelecom.com.br', 'flashfibra.net.br', 'flink.uz', 'flx.com.pe', 'flybyte.com.br', 'foaaa.com', 'forthnet.gr', 'fourtelecom.com', 'free.fr', 'freenet-group.de', 'fsmtc.fm', 'ft.fo', 'fusion.ps', 'g8.net.br', 'gals.uz', 'gcore.lu', 'gd.tt', 'gegatelecom.net', 'gemzo.ps', 'genettelecom.net.br', 'gerrys.net', 'gigaline.com.br', 'gigalink.com.br', 'giganor.com', 'gigared.com.ar', 'gironetfibra.com.br', 'glink.net.br', 'glnet.com.br', 'global-layer.com', 'globe.com.ph', 'globenet.net', 'gloworld.com', 'glpnet.com.br', 'gmo.jp', 'go.com.mt', 'godnet.com.br', 'golddata.net', 'google.com', 'goonet.com.br', 'gorannet.net', 'gptc.ly', 'grajaunet.com.br', 'grameenphone.com', 'gramnet.com.br', 'groupnet-iq.com', 'gruponewlife.com.br', 'grupotvcable.com', 'gtd.cl', 'gthost.com', 'gtt.co.gy', 'gtt.net', 'guestchoicerd.com', 'hadara.ps', 'halasat.net', 'hayat-isp.net', 'hbinfo.com.br', 'heficed.com', 'hetzner.com', 'highspeed.com.tr', 'hilink.com.br', 'holistica.com.br', 'homenet.cl', 'homenet.sumy.ua', 'hondutel.hn', 'hopnet.com.br', 'hormuud.com', 'hosteam.pl', 'hosteurope.de', 'hostroyale.com', 'hotnet.net.il', 'hrins.net', 'hughes.com', 'hughes.com.br', 'hvtv.co', 'hypernet.sy', 'i-tower.net', 'iam.ma', 'ibaaco.net', 'ibitelecom.com.br', 'ibiunet.com.br', 'ibw.com.ni', 'ice.no', 'iclik.co', 'ideay.com', 'idm.net.lb', 'ifxnetworks.com', 'ifxnw.com.ve', 'iij.ad.jp', 'iinet.net.au', 'impactnet.com.br', 'indosatooredoo.com', 'inea.pl', 'inet.sy', 'inethn.com', 'inetminas.com.br', 'infinity.iq', 'infologti.com.br', 'infonet.ee', 'infornet.in', 'instatelecom.com', 'intelsat.com', 'inter.com.ve', 'interbourg.com.ar', 'interconnects.us', 'interlink.com.ar', 'internexa.com', 'internexsolutions.com', 'internext.cz', 'intesanet.net', 'inwi.ma', 'io-global.com', 'iomart.com', 'iontel.ly', 'ip.ro', 'iparatodos.com.ar', 'ipc.ph', 'ipcore.com.my', 'iplan.com.ar', 'iptp.net', 'iqnet.com', 'iranettelecom.com.br', 'is.com.gh', 'istanbuldc.com', 'istv.uz', 'it7.net', 'ite.net', 'itelkom.co', 'itldc.com', 'itsbrasil.net', 'iveloz.net.br', 'ivitelecom.com.br', 'jdimax.com', 'jetnet.ps', 'jhcs.com', 'jio.com', 'jotazo.com.br', 'jpproviders.com.br', 'jrconect.com', 'jt.iq', 'jtglobal.com', 'juquianet.net.br', 'k2telecom.com.br', 'kabayancablegroup.com', 'kalibocable.net', 'kamatera.com', 'kaopuyun.com', 'karibcable.com', 'katv1.com', 'knet-telecom.com', 'korektel.com', 'kt.kg', 'kyivstar.ua', 'lagoon.nc', 'laotel.com', 'lazertelecom.com', 'leadertelecom.ru', 'leaseweb.com', 'level3.com', 'libyana.ly', 'ligue.net', 'link.net.pk', 'linkem.com', 'linode.com', 'linxbr.com.br', 'liquidtelecom.com', 'liquidtelecom.net', 'litc.ly', 'litoraltibau.com.br', 'lizcat.com', 'logic.ky', 'logicweb.com', 'logix.com', 'loina.wf', 'lonsdalenet.co.uk', 'lpinternet.com.br', 'lpnet.com.br', 'ltt.ly', 'lunasat.com', 'm247.com', 'mada.ps', 'maisinternet.net.br', 'maisprovedor.com.br', 'maksnet.net', 'marandu.com.ar', 'masaratcom.com', 'masternet.net.br', 'matelecon.com.br', 'matosnet.com.br', 'matrixisp.com', 'mavnet.com.br', 'maxcomm.com.br', 'maxis.com.my', 'mayatama.net', 'mbgtecnologias.com.br', 'mc.inf.br', 'mc.net.co', 'mediaserv.com', 'megacable.com.ar', 'megacable.com.mx', 'megacom.kg', 'megafon.ru', 'megafon.tj', 'megaline.kg', 'megalinkcorp.com.br', 'meganetsalto.com.br', 'megared.com.gt', 'melita.com', 'metronethn.com', 'metrotel.com.ar', 'metrotel.com.co', 'mhnet.com.br', 'microsoft.com', 'microtell.com.br', 'mimonet.com.br', 'minasnet.net', 'mksnet.com.br', 'mnets.net', 'mobi.net.lb', 'mobile.free.fr', 'mobilinkgsm.com', 'mobily.com.sa', 'mobitel.lk', 'mobtelecom.com.br', 'mountainview.com.ph', 'movistar.com.pa', 'mrynet.com.br', 'mtilabs.com', 'mtn.ci', 'mtn.co.rw', 'mtn.co.ug', 'mtn.com.af', 'mtn.com.gh', 'mtn.com.sy', 'mtn.sd', 'mtncongo.net', 'mtnirancell.ir', 'mtnonline.com', 'mts.rs', 'mts.ru', 'mts.ua', 'multicablehonduras.com', 'multiplaytelecom.com.br', 'mundopacifico.cl', 'musurit.com', 'myrepublic.net', 'mysky.com.ph', 'nar.az', 'natcom.com.ht', 'nawand.net', 'nayatel.com', 'neda.af', 'nedetel.net', 'neotel.co.za', 'net.sy', 'net11.com.br', 'netbarretos.com.br', 'netcartelecom.com.br', 'netco.uz', 'netcomplusve.com', 'netfibra.com', 'netfibratelecomunicacoes.com.br', 'netforcetelecom.com.br', 'netglobal.it', 'netia.pl', 'netiontelecom.com.br', 'netiq.sk', 'netlife.ec', 'netlinetelecom.com.br', 'netprolb.com', 'netsaojose.com.br', 'netseg.net.br', 'netserv.com.br', 'netstream.ps', 'netuno.net', 'neunet.com.ar', 'newcloudnetworks.com', 'newertech.com.br', 'newnet.psi.br', 'newroztelecom.com', 'newstarmax.ps', 'nextel.com.br', 'nextnetwork.com.br', 'nexttel.cm', 'nile-online.com', 'nipcable.com.br', 'niponet.com.br', 'niqturbo.com.br', 'nmultifibra.com.br', 'nortech.com.ar', 'northtelecom.af', 'nortis.ma', 'nos.pt', 'nova.is', 'novafibratelecom.com.br', 'novanetwork.com.br', 'ntcnet.com.br', 'nterconexionhn.com', 'nurtelecom.kg', 'oeste-rede.com.br', 'oesteline.com.br', 'oi.com.br', 'olafibra.com.br', 'omantel.om', 'omni.net.br', 'omniya.sy', 'omnya.co', 'onatel.bf', 'onemax.com', 'online.net', 'online.net.br', 'onnethn.com', 'oops.tv.br', 'ooredoo.com.mm', 'ooredoo.om', 'ooredoo.qa', 'ooredoo.tn', 'opstelecom.com.br', 'opt.nc', 'optus.com.au', 'oracle.com', 'orange-bissau.com', 'orange.bf', 'orange.cd', 'orange.ci', 'orange.com', 'orange.eg', 'orange.jo', 'orange.ma', 'orange.mg', 'orange.ne', 'orange.pl', 'orange.ps', 'orange.sk', 'orange.tn', 'orangemali.com', 'orbitcable.com.do', 'orbitelecom.com.br', 'oriontelekom.rs', 'outremer-telecom.fr', 'ovh.com', 'paikltd.com', 'palautelecoms.com', 'paltel.ps', 'palwifi.net', 'pandanetwork.com.br', 'pccw.com', 'personal.com.py', 'petaexpress.com', 'petrynet.com.br', 'pinspb.ru', 'pirmamgroup.com', 'planetcabletv.com', 'platinum.uz', 'play.pl', 'pldt.com', 'plus.pl', 'plusnetfoz.com', 'pnccpalau.com', 'pointtelecom.com.br', 'post.lu', 'powerline.com.br', 'powernetsolutions.com.br', 'pratatelecom.com.br', 'predialnet.com.br', 'primatecmt.com.br', 'privatelayer.com', 'privax.com', 'prodatanet.com.ph', 'prokk.net', 'provale.com.br', 'provedorsuperconnect.com.br', 'provedoruniversal.com.br', 'providersnet.com.br', 'psn.co.id', 'psychz.net', 'ptcl.com.pk', 'puntonet.ec', 'qitelecom.net.br', 'qnax.com.br', 'qubee.com.pk', 'quick.com.br', 'quickline.ch', 'radiolan.sk', 'ragtek.com.br', 'rahanet.af', 'ramnet.com.br', 'rapidatelecom.com.br', 'razaoinfo.com.br', 'rdconlinebd.net', 'redecom.net.br', 'redenilf.com.br', 'redetelecom.com.br', 'redfoxtelecom.com.br', 'redintercable.com.ar', 'researchsrl.com.ar', 'rightel.ir', 'riotel.com.ar', 'rmsconnect.net.br', 'rnova.com.br', 'rnp.br', 'robi.com.bd', 'rogers.com', 'roshan.af', 'royalcable.com.ph', 'rsonet.com.ar', 'rt.ru', 'runnet.sy', 'rvrnetworks.com', 'sadattelecom.af', 'safaricom.co.ke', 'salartel.com', 'salestelecom.net.br', 'samanet.sy', 'sanluisctv.com.ar', 'sattrakt.com', 'sawaisp.sy', 'sbb.rs', 'sco.gov.pk', 'sconfibras.com.br', 'scopesky.com', 'scrio.com.br', 'scs-net.org', 'seacom.mu', 'sebratel.com.br', 'sepcom.com.co', 'sercomtel.com.br', 'ses.com', 'seven-sky.net', 'sfox.com.br', 'sfr.com', 'sfr.re', 'sglinknet.com.br', 'shams-tele.com', 'sharktech.net', 'sigmanet.com.br', 'simbanet.net', 'simbatv.co.ug', 'sinusnet.pl', 'sion.com', 'sitel.com.br', 'sjnettelecom.com.br', 'sky.com', 'sky.com.br', 'sky.net.co', 'skylogic.it', 'skylonhost.com', 'skyonline.net.ar', 'slt.lk', 'smart-bz.com', 'smart.com.ph', 'smartlink-isp.com', 'smartwavesnetwork.com', 'sobralnet.com.br', 'socitel.com.br', 'sodobrasil.net.br', 'softether.jp', 'softlinknet.com', 'sol.az', 'solucaonetwork.com', 'solunet.com.ar', 'somtelnetwork.net', 'sonatel.sn', 'speedclick.ps', 'speedjettelecom.com.br', 'speednetcomunicacoes.com.br', 'speedrs.com.br', 'spinservers.com', 'splink.net.br', 'sprint.com', 'st.uz', 'stantelecom.net', 'star1.com.br', 'starcommunicationbd.com', 'starktel.com', 'starman.com.br', 'starnet.cz', 'starnettelecom.com.br', 'stationnet.com.br', 'stc.com.sa', 'stem.co.za', 'strongvpn.com', 'stv.ee', 'suanet.net.br', 'suatelecom.com.br', 'sudatel.sd', 'sudatel.sn', 'sudoestetelecom.com.br', 'sumicity.net.br', 'supercable.com.ve', 'supercabotv.com.br', 'supercanal-arlink.com.ar', 'supercellnetwork.com', 'superlink.ps', 'superonline.net', 'supranet.com.br', 'sure.com', 'surfshark.com', 'swan.sk', 'swisscom.ch', 'sygo.com.br', 'synapsecom.gr', 'syriatel.sy', 't-mobile.com', 't-mobile.cz', 't-mobile.pl', 't1chihuahua.com', 'tajnet.tj', 'takamol.sy', 'talia.net', 'talktalkgroup.com', 'tangerine.co.ug', 'tarinnet.info', 'tascom.com.br', 'tashicell.com', 'tbtelecom.net.br', 'tca.com.br', 'tcell.tj', 'tchenet.net', 'tcheturbo.com.br', 'tci.ir', 'tct.ir', 'tcvnet.com.br', 'tdc.dk', 'tdkom.com.br', 'techcomprovedor.com.br', 'tecnologiasvirtuales.com', 'tedata.net', 'teko.com.ni', 'telbru.com.bn', 'telconet.ec', 'telcorp.com.ve', 'tele2.com', 'tele2.kz', 'tele2.ru', 'telebras.com.br', 'telebucaramanga.com.co', 'telecablecentral.com', 'telecablecr.com', 'telecablelaunion.com', 'telecel-rca.com', 'telecelfaso.bf', 'telecentro.com.ar', 'telecom.com.ar', 'telecom.kz', 'telecom.pt', 'telecom.tm', 'telecomdados.com.br', 'telecomitalia.it', 'telecomitalia.sm', 'telecomprovider.com.br', 'telefonica.co', 'telefonica.com', 'telefonica.com.pe', 'telefonica.es', 'telefonicachile.cl', 'teleguam.net', 'teleimagensatelital.com', 'telekom.de', 'telekom.hu', 'telekom.mk', 'telekom.sk', 'telemach.si', 'telemgroup.sx', 'telemontv.com', 'telenet.be', 'telenor.com', 'telenor.com.pk', 'telenor.rs', 'telenord.com', 'telepost.gl', 'telered.com.ar', 'telesis.hn', 'telesur.sr', 'televiaducto.com.do', 'teleyemen.com.ye', 'telia.com', 'telia.ee', 'telium.com.br', 'telkom.co.id', 'telkomsel.com', 'tellcorpce.com.br', 'telmex.com', 'telmexchile.cl', 'telnets.com.br', 'telpin.com.ar', 'telstra.com', 'telsur.cl', 'telvgg.coop', 'tely.com.br', 'tencent.com', 'tepenet.com.tr', 'terra.net.lb', 'terratransit.de', 'tfl.com.fj', 'thecable.net', 'thegeniusisp.com', 'thglobalvision.net', 'thinkhuge.net', 'thsprovider.com.br', 'thundertecnologia.com.br', 'tigo.co.rw', 'tigo.com.bo', 'tigo.com.co', 'tigo.com.gt', 'tigo.com.hn', 'tigo.com.py', 'tigo.com.sv', 'tigo.cr', 'tigo.sn', 'tigrisnet.net', 'tim.com.br', 'time.com.my', 'timortelecom.tl', 'tiqanyatalshabaka.com', 'titania.com.br', 'tixtelecom.com.br', 'tm.com.my', 'togotelecom.tg', 'toledonet.com.br', 'tolrs.com.br', 'topcomunications.com', 'topnet.tn', 'tot.co.th', 'totalplay.com.mx', 'toya.net.pl', 'tpg.com.au', 'tpp.com.ar', 'tps.uz', 'transdatelecom.com', 'transeurocom.az', 'transnexa.com', 'tre.se', 'tremnet.com.br', 'tri.co.id', 'trixnet.com.br', 'truecorp.co.th', 'tstt.co.tt', 'tsukaeru.net', 'ttcl.co.tz', 'tunisietelecom.tn', 'turbonetwifi.com.br', 'turk.net', 'turkcell.com.tr', 'turktelekom.com.tr', 'turontelecom.uz', 'tvc.tv.br', 'tvkhajnowka.pl', 'tvn.tv.br', 'tvsom.com.br', 'tw1.com', 'twmbroadband.com', 'u.com.my', 'uatelecom.af', 'ucell.uz', 'ufinet.com', 'ufone.com', 'ukrtelecom.ua', 'ultranetpb.com.br', 'umniah.com', 'unartel.cz', 'une.com.co', 'unifi.com.my', 'unifique.com.br', 'unitel.com.la', 'uniteltmais.cv', 'unonet.com.br', 'unusinc.com', 'uolsinectis.com.ar', 'upc.at', 'upc.cz', 'upcspl.in', 'upfournet.com.br', 'upnettelecom.net.br', 'usatv.port48.com', 'uts.cw', 'uztelecom.uz', 'vcnetwork.com.br', 'verizon.com', 'vextelecom.com.br', 'vh.net', 'vi.choice-wireless.com', 'viaband.net.br', 'vianet.com.br', 'vianovatelecom.com.br', 'viaradiodourados.com.br', 'viareal.com.br', 'viettel.com.vn', 'view.sy', 'vilanovanet.com', 'vini.pf', 'vip.mk', 'vipbrtelecom.com.br', 'vipnettelecom.com.br', 'virginmedia.com', 'virginmedia.ie', 'virtex.com.br', 'visp.net.lb', 'vitaltelecom.net', 'viva.com.bh', 'viva.com.do', 'viyavi.com', 'vmnettelecom.com.br', 'vnpt.vn', 'vocetelecom.vc', 'vocus.co.nz', 'vodacom.cd', 'vodacom.co.ls', 'vodafone.com', 'vodafone.com.au', 'vodafone.com.eg', 'vodafone.com.fj', 'vodafone.com.gh', 'vodafone.de', 'vodafone.gr', 'vodafone.ie', 'vodafone.in', 'vodafone.is', 'vodafone.it', 'vodafone.qa', 'vogeltelecom.com', 'vtr.com', 'w2i.net.br', 'wananchi.com', 'wateen.com', 'wavenet-lb.net', 'webbytelecom.com.br', 'websurfer.com.np', 'wildpark.net', 'wind.com.do', 'wind.gr', 'windtelecom.com.br', 'windtre.it', 'winetbrasil.com.br', 'winfnet.com.br', 'wiretelecom.com.br', 'wise.net.lb', 'wmservice.com.do', 'worldstream.nl', 'wsinternet.com.br', 'wsnetfibra.com.br', 'wznet.com.br', 'xl.co.id', 'xolbroadband.com', 'yellownet.com.br', 'yemen.net.ye', 'yeptv.com.br', 'yes.my', 'yota.com.ni', 'zain.com', 'zamtel.zm', 'zap.cvmultimedia.cv', 'zaytona.ps', 'zenlayer.com', 'zetro.com.ar', 'ziggo.nl', 'zong.com.pk')
GROUP BY 13,
  14,
  15,
  16
HAVING CAST(CASE WHEN SUM(""自定义 SQL 查询"".""p2s_total"") >= 0 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100 THEN '0-100' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 1000 THEN '100-1000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 1000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 10000 THEN '1000-10000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 10000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100000 THEN '10000-100000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100000 THEN '100000以上' ELSE 'other' END AS VARCHAR) = '100-1000' OR CAST(CASE WHEN SUM(""自定义 SQL 查询"".""p2s_total"") >= 0 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100 THEN '0-100' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 1000 THEN '100-1000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 1000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 10000 THEN '1000-10000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 10000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100000 THEN '10000-100000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100000 THEN '100000以上' ELSE 'other' END AS VARCHAR) = '1000-10000' OR CAST(CASE WHEN SUM(""自定义 SQL 查询"".""p2s_total"") >= 0 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100 THEN '0-100' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 1000 THEN '100-1000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 1000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 10000 THEN '1000-10000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 10000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100000 THEN '10000-100000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100000 THEN '100000以上' ELSE 'other' END AS VARCHAR) = '10000-100000' OR CAST(CASE WHEN SUM(""自定义 SQL 查询"".""p2s_total"") >= 0 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100 THEN '0-100' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 1000 THEN '100-1000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 1000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 10000 THEN '1000-10000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 10000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100000 THEN '10000-100000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100000 THEN '100000以上' ELSE 'other' END AS VARCHAR) = '100000以上'"
"select * from queries limit 10"
"SELECT ""t0"".""__measure__0"" AS ""Calculation_207447066293481472"",
  MAX(""自定义 SQL 查询"".""stat_date"") AS ""TEMP(attr_stat_date_nk)(2102638629)(0)"",
  MIN(""自定义 SQL 查询"".""stat_date"") AS ""TEMP(attr_stat_date_nk)(2790680713)(0)"",
  ""自定义 SQL 查询"".""area"" AS ""area"",
  ""自定义 SQL 查询"".""cid"" AS ""cid"",
  ""自定义 SQL 查询"".""company"" AS ""company"",
  ""自定义 SQL 查询"".""csdc_owner"" AS ""csdc_owner"",
  ""自定义 SQL 查询"".""industry"" AS ""industry"",
  ""自定义 SQL 查询"".""level"" AS ""level"",
  ""自定义 SQL 查询"".""project"" AS ""project"",
  SUM(""自定义 SQL 查询"".""total"") AS ""sum_total_ok"",
  ""自定义 SQL 查询"".""vid"" AS ""vid""
FROM (SELECT date,
      SUBSTR(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) AS date_range_1,
      SUBSTR(CAST(end_date AS VARCHAR), 1, 10) AS date_range_2,
      stat_period,
        CASE WHEN CAST(stat_period AS VARCHAR) = 'day' THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,
      area,
      vid,
      project,
      company_id AS cid,
      company_name AS company,
      customer_level AS level,
      vid_internal_industry_en AS industry,
      vid_use_case_cn,
      csdc_owner,
      os,
      ver,
      ver_type,
      product_level1,
      product_level2,
      product_level3,
      total,
      audio,
      video,
      video_sd,
      video_hd,
      video_hdp,
        host_audio + host_video AS host,
      host_audio,
      host_video,
      host_sd,
      host_hd,
      host_hdp,
        audience_audio + audience_video AS audience,
        audience_audio_low_latency + audience_video_low_latency AS audience_low_latency,
      audience_audio,
      audience_audio_low_latency,
      audience_video,
      audience_video_low_latency,
      audience_sd,
      audience_sd_low_latency,
      audience_hd,
      audience_hd_low_latency,
      audience_hdp,
      audience_hdp_low_latency,
      total_last1,
      audio_last1,
      video_last1,
      video_sd_last1,
      video_hd_last1,
      video_hdp_last1,
        host_audio_last1 + host_video_last1 AS host_last1,
      host_audio_last1,
      host_video_last1,
        audience_audio_last1 + audience_video_last1 AS audience_last1,
        audience_audio_low_latency_last1 + audience_video_low_latency_last1 AS audience_low_latency_last1,
      audience_audio_last1,
      audience_audio_low_latency_last1,
      audience_video_last1,
      audience_video_low_latency_last1,
      total_last7,
      audio_last7,
      video_last7,
      video_sd_last7,
      video_hd_last7,
      video_hdp_last7,
        host_audio_last7 + host_video_last7 AS host_last7,
      host_audio_last7,
      host_video_last7,
        audience_audio_last7 + audience_video_last7 AS audience_last7,
        audience_audio_low_latency_last7 + audience_video_low_latency_last7 AS audience_low_latency_last7,
      audience_audio_last7,
      audience_audio_low_latency_last7,
      audience_video_last7,
      audience_video_low_latency_last7
    FROM report_datahub.vendor_vid_usage_di_1
    WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-06') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-06') AND CAST(vid AS VARCHAR) = CAST(428342 AS VARCHAR) AND dim = 1) AS ""自定义 SQL 查询""
  CROSS JOIN (SELECT MAX(""自定义 SQL 查询"".""vid_use_case_cn"") AS ""__measure__0""
    FROM (SELECT date,
          SUBSTR(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) AS date_range_1,
          SUBSTR(CAST(end_date AS VARCHAR), 1, 10) AS date_range_2,
          stat_period,
            CASE WHEN CAST(stat_period AS VARCHAR) = 'day' THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,
          area,
          vid,
          project,
          company_id AS cid,
          company_name AS company,
          customer_level AS level,
          vid_internal_industry_en AS industry,
          vid_use_case_cn,
          csdc_owner,
          os,
          ver,
          ver_type,
          product_level1,
          product_level2,
          product_level3,
          total,
          audio,
          video,
          video_sd,
          video_hd,
          video_hdp,
            host_audio + host_video AS host,
          host_audio,
          host_video,
          host_sd,
          host_hd,
          host_hdp,
            audience_audio + audience_video AS audience,
            audience_audio_low_latency + audience_video_low_latency AS audience_low_latency,
          audience_audio,
          audience_audio_low_latency,
          audience_video,
          audience_video_low_latency,
          audience_sd,
          audience_sd_low_latency,
          audience_hd,
          audience_hd_low_latency,
          audience_hdp,
          audience_hdp_low_latency,
          total_last1,
          audio_last1,
          video_last1,
          video_sd_last1,
          video_hd_last1,
          video_hdp_last1,
            host_audio_last1 + host_video_last1 AS host_last1,
          host_audio_last1,
          host_video_last1,
            audience_audio_last1 + audience_video_last1 AS audience_last1,
            audience_audio_low_latency_last1 + audience_video_low_latency_last1 AS audience_low_latency_last1,
          audience_audio_last1,
          audience_audio_low_latency_last1,
          audience_video_last1,
          audience_video_low_latency_last1,
          total_last7,
          audio_last7,
          video_last7,
          video_sd_last7,
          video_hd_last7,
          video_hdp_last7,
            host_audio_last7 + host_video_last7 AS host_last7,
          host_audio_last7,
          host_video_last7,
            audience_audio_last7 + audience_video_last7 AS audience_last7,
            audience_audio_low_latency_last7 + audience_video_low_latency_last7 AS audience_low_latency_last7,
          audience_audio_last7,
          audience_audio_low_latency_last7,
          audience_video_last7,
          audience_video_low_latency_last7
        FROM report_datahub.vendor_vid_usage_di_1
        WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-06') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-06') AND CAST(vid AS VARCHAR) = CAST(428342 AS VARCHAR) AND dim = 1) AS ""自定义 SQL 查询""
    HAVING COUNT(1) > 0) AS ""t0""
GROUP BY 1,
  4,
  5,
  6,
  7,
  8,
  9,
  10,
  12"
"select query from system.runtime.queries where created >= TIMESTAMP '2021-12-05 16:00:00.000 UTC'"
"SELECT SUM(""自定义 SQL 查询"".""host_4k"") AS ""TEMP(Calculation_3519281700341563406)(1075454865)(0)"",
  SUM(""自定义 SQL 查询"".""audience_audio_last7"") AS ""TEMP(Calculation_3519281700341563406)(1077563395)(0)"",
  SUM(""自定义 SQL 查询"".""audience_sd"") AS ""TEMP(Calculation_3519281700341563406)(1133678835)(0)"",
  SUM(""自定义 SQL 查询"".""host_1080p"") AS ""TEMP(Calculation_3519281700341563406)(1312501967)(0)"",
  SUM(""自定义 SQL 查询"".""audience_sd_last7"") AS ""TEMP(Calculation_3519281700341563406)(1456465729)(0)"",
  SUM(""自定义 SQL 查询"".""host_hd_last7"") AS ""TEMP(Calculation_3519281700341563406)(1635749653)(0)"",
  SUM(""自定义 SQL 查询"".""audience_hd_last7"") AS ""TEMP(Calculation_3519281700341563406)(1747046964)(0)"",
  SUM(""自定义 SQL 查询"".""audience_2k_last7"") AS ""TEMP(Calculation_3519281700341563406)(1747524570)(0)"",
  SUM(""自定义 SQL 查询"".""host_hdp_last7"") AS ""TEMP(Calculation_3519281700341563406)(2044136109)(0)"",
  SUM(""自定义 SQL 查询"".""host_audio_last7"") AS ""TEMP(Calculation_3519281700341563406)(2464388580)(0)"",
  SUM(""自定义 SQL 查询"".""audio_last7"") AS ""TEMP(Calculation_3519281700341563406)(2589233512)(0)"",
  SUM(""自定义 SQL 查询"".""host_hd"") AS ""TEMP(Calculation_3519281700341563406)(276907208)(0)"",
  SUM(""自定义 SQL 查询"".""host_2k_last7"") AS ""TEMP(Calculation_3519281700341563406)(280796653)(0)"",
  SUM(""自定义 SQL 查询"".""video"") AS ""TEMP(Calculation_3519281700341563406)(2929708110)(0)"",
  SUM(""自定义 SQL 查询"".""audience_hd"") AS ""TEMP(Calculation_3519281700341563406)(2930728935)(0)"",
  SUM(""自定义 SQL 查询"".""audience_hdp"") AS ""TEMP(Calculation_3519281700341563406)(3010533957)(0)"",
  SUM(""自定义 SQL 查询"".""host_hdp"") AS ""TEMP(Calculation_3519281700341563406)(30306054)(0)"",
  SUM(""自定义 SQL 查询"".""host_audio"") AS ""TEMP(Calculation_3519281700341563406)(3087054365)(0)"",
  SUM(""自定义 SQL 查询"".""host_4k_last7"") AS ""TEMP(Calculation_3519281700341563406)(3127348545)(0)"",
  SUM(""自定义 SQL 查询"".""audio"") AS ""TEMP(Calculation_3519281700341563406)(3299350010)(0)"",
  SUM(""自定义 SQL 查询"".""total_last7"") AS ""TEMP(Calculation_3519281700341563406)(346677966)(0)"",
  SUM(""自定义 SQL 查询"".""audience_4k_last7"") AS ""TEMP(Calculation_3519281700341563406)(3543669678)(0)"",
  SUM(""自定义 SQL 查询"".""host_1080p_last7"") AS ""TEMP(Calculation_3519281700341563406)(3624983014)(0)"",
  SUM(""自定义 SQL 查询"".""audience_1080p"") AS ""TEMP(Calculation_3519281700341563406)(3628946582)(0)"",
  SUM(""自定义 SQL 查询"".""totalUsage"") AS ""TEMP(Calculation_3519281700341563406)(3847882359)(0)"",
  SUM(""自定义 SQL 查询"".""host_sd_last7"") AS ""TEMP(Calculation_3519281700341563406)(3905372418)(0)"",
  SUM(""自定义 SQL 查询"".""video_last7"") AS ""TEMP(Calculation_3519281700341563406)(4107040267)(0)"",
  SUM(""自定义 SQL 查询"".""audience_audio"") AS ""TEMP(Calculation_3519281700341563406)(4109514392)(0)"",
  SUM(""自定义 SQL 查询"".""host_2k"") AS ""TEMP(Calculation_3519281700341563406)(586790827)(0)"",
  SUM(""自定义 SQL 查询"".""audience_1080p_last7"") AS ""TEMP(Calculation_3519281700341563406)(632977665)(0)"",
  SUM(""自定义 SQL 查询"".""host_sd"") AS ""TEMP(Calculation_3519281700341563406)(709512178)(0)"",
  SUM(""自定义 SQL 查询"".""audience_hdp_last7"") AS ""TEMP(Calculation_3519281700341563406)(750340200)(0)"",
  SUM(""自定义 SQL 查询"".""audience_4k"") AS ""TEMP(Calculation_3519281700341563406)(764410224)(0)"",
  SUM(""自定义 SQL 查询"".""audience_2k"") AS ""TEMP(Calculation_3519281700341563406)(943764407)(0)"",
  ""自定义 SQL 查询"".""level1"" AS ""level1"",
  SUM(""自定义 SQL 查询"".""audio_video_last"") AS ""sum_audio_video_last_ok""
FROM (SELECT date,
        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,
      start_date AS start_date_7,
      end_date AS end_date,
      tag,
      area AS Scope,
      dim,
        CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,
      level2,
      level3,
      level4,
      product_level1 AS product_line,
      product_level2,
      product_level3,
      product_level4,
      vid_internal_industry_en AS cid_industry,
      vid_use_case_en AS vid_use_case_cn,
      vid_sector_en,
      ver_type,
      ver,
      os,
      domain,
      country,
      region,
      dim_grouping_name,
        CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,
      total AS totalUsage,
      audio,
      video,
      host_audio,
      audience_audio,
      host_sd,
      host_hd,
      host_hdp,
      host_1080p,
      host_2k,
      host_4k,
      audience_sd,
      audience_hd,
      audience_hdp,
      audience_1080p,
      audience_2k,
      audience_4k,
      audience_audio_low_latency,
      audience_sd_low_latency,
      audience_hd_low_latency,
      audience_hdp_low_latency,
      audience_1080p_low_latency,
      audience_2k_low_latency,
      audience_4k_low_latency,
      audience_audio_ultra_low_latency,
      audience_sd_ultra_low_latency,
      audience_hd_ultra_low_latency,
      audience_hdp_ultra_low_latency,
      audience_1080p_ultra_low_latency,
      audience_2k_ultra_low_latency,
      audience_4k_ultra_low_latency,
      total_last1 AS audio_video_last,
      audio_last1 AS audio_last,
      video_last1 AS video_last,
      video_sd_last1 AS video_sd_last,
      video_hd_last1 AS video_hd_last,
      video_hdp_last1 AS video_hdp_last,
      host_sd_last1 AS host_video_sd_last,
      audience_sd_last1 AS audience_video_sd_last,
      host_hd_last1 AS host_video_hd_last,
      audience_hd_last1 AS audience_video_hd_last,
      host_hdp_last1 AS host_video_hdp_last,
      audience_hdp_last1 AS audience_video_hdp_last,
      host_audio_last1 AS host_audio_last,
      audience_audio_last1 AS audience_audio_last,
      host_video_last1 AS host_video_last,
      audience_video_last1 AS audience_video_last,
      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,
      audience_video_low_latency_last1 AS audience_video_low_latency_last,
      audience_total_low_latency_last1 AS audience_total_low_latency_last,
      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,
      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,
      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,
      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,
      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,
      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,
      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,
      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,
      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,
      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,
      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,
      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,
      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,
      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,
      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,
      audience_2k_last1 AS audience_2k_last,
      audience_4k_last1 AS audience_4k_last,
      audience_1080p_last1 AS audience_1080p_last,
      host_1080p_last1 AS host_1080p_last,
      host_2k_last1 AS host_2k_last,
      host_4k_last1 AS host_4k_last,
      total_last7,
      audio_last7,
      video_last7,
      video_sd_last7,
      video_hd_last7,
      video_hdp_last7,
      host_sd_last7,
      audience_sd_last7,
      host_hd_last7,
      audience_hd_last7,
      host_hdp_last7,
      audience_hdp_last7,
      host_audio_last7,
      audience_audio_last7,
      host_video_last7,
      audience_video_last7,
      audience_audio_low_latency_last7,
      audience_video_low_latency_last7,
      audience_total_low_latency_last7,
      audience_sd_low_latency_last7,
      audience_hd_low_latency_last7,
      audience_hdp_low_latency_last7,
      audience_1080p_low_latency_last7,
      audience_2k_low_latency_last7,
      audience_4k_low_latency_last7,
      audience_audio_ultra_low_latency_last7,
      audience_video_ultra_low_latency_last7,
      audience_total_ultra_low_latency_last7,
      audience_sd_ultra_low_latency_last7,
      audience_hd_ultra_low_latency_last7,
      audience_hdp_ultra_low_latency_last7,
      audience_1080p_ultra_low_latency_last7,
      audience_2k_ultra_low_latency_last7,
      audience_4k_ultra_low_latency_last7,
      audience_2k_last7,
      audience_4k_last7,
      audience_1080p_last7,
      host_1080p_last7,
      host_2k_last7,
      host_4k_last7
    FROM levels_usage_dod_di_1
    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-06') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-04') AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS ""自定义 SQL 查询""
  CROSS JOIN (SELECT MAX(date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d')) AS ""__measure__0""
    FROM (SELECT date,
            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,
          start_date AS start_date_7,
          end_date AS end_date,
          tag,
          area AS Scope,
          dim,
            CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,
          level2,
          level3,
          level4,
          product_level1 AS product_line,
          product_level2,
          product_level3,
          product_level4,
          vid_internal_industry_en AS cid_industry,
          vid_use_case_en AS vid_use_case_cn,
          vid_sector_en,
          ver_type,
          ver,
          os,
          domain,
          country,
          region,
          dim_grouping_name,
            CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,
          total AS totalUsage,
          audio,
          video,
          host_audio,
          audience_audio,
          host_sd,
          host_hd,
          host_hdp,
          host_1080p,
          host_2k,
          host_4k,
          audience_sd,
          audience_hd,
          audience_hdp,
          audience_1080p,
          audience_2k,
          audience_4k,
          audience_audio_low_latency,
          audience_sd_low_latency,
          audience_hd_low_latency,
          audience_hdp_low_latency,
          audience_1080p_low_latency,
          audience_2k_low_latency,
          audience_4k_low_latency,
          audience_audio_ultra_low_latency,
          audience_sd_ultra_low_latency,
          audience_hd_ultra_low_latency,
          audience_hdp_ultra_low_latency,
          audience_1080p_ultra_low_latency,
          audience_2k_ultra_low_latency,
          audience_4k_ultra_low_latency,
          total_last1 AS audio_video_last,
          audio_last1 AS audio_last,
          video_last1 AS video_last,
          video_sd_last1 AS video_sd_last,
          video_hd_last1 AS video_hd_last,
          video_hdp_last1 AS video_hdp_last,
          host_sd_last1 AS host_video_sd_last,
          audience_sd_last1 AS audience_video_sd_last,
          host_hd_last1 AS host_video_hd_last,
          audience_hd_last1 AS audience_video_hd_last,
          host_hdp_last1 AS host_video_hdp_last,
          audience_hdp_last1 AS audience_video_hdp_last,
          host_audio_last1 AS host_audio_last,
          audience_audio_last1 AS audience_audio_last,
          host_video_last1 AS host_video_last,
          audience_video_last1 AS audience_video_last,
          audience_audio_low_latency_last1 AS audience_audio_low_latency_last,
          audience_video_low_latency_last1 AS audience_video_low_latency_last,
          audience_total_low_latency_last1 AS audience_total_low_latency_last,
          audience_sd_low_latency_last1 AS audience_sd_low_latency_last,
          audience_hd_low_latency_last1 AS audience_hd_low_latency_last,
          audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,
          audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,
          audience_2k_low_latency_last1 AS audience_2k_low_latency_last,
          audience_4k_low_latency_last1 AS audience_4k_low_latency_last,
          audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,
          audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,
          audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,
          audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,
          audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,
          audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,
          audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,
          audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,
          audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,
          audience_2k_last1 AS audience_2k_last,
          audience_4k_last1 AS audience_4k_last,
          audience_1080p_last1 AS audience_1080p_last,
          host_1080p_last1 AS host_1080p_last,
          host_2k_last1 AS host_2k_last,
          host_4k_last1 AS host_4k_last,
          total_last7,
          audio_last7,
          video_last7,
          video_sd_last7,
          video_hd_last7,
          video_hdp_last7,
          host_sd_last7,
          audience_sd_last7,
          host_hd_last7,
          audience_hd_last7,
          host_hdp_last7,
          audience_hdp_last7,
          host_audio_last7,
          audience_audio_last7,
          host_video_last7,
          audience_video_last7,
          audience_audio_low_latency_last7,
          audience_video_low_latency_last7,
          audience_total_low_latency_last7,
          audience_sd_low_latency_last7,
          audience_hd_low_latency_last7,
          audience_hdp_low_latency_last7,
          audience_1080p_low_latency_last7,
          audience_2k_low_latency_last7,
          audience_4k_low_latency_last7,
          audience_audio_ultra_low_latency_last7,
          audience_video_ultra_low_latency_last7,
          audience_total_ultra_low_latency_last7,
          audience_sd_ultra_low_latency_last7,
          audience_hd_ultra_low_latency_last7,
          audience_hdp_ultra_low_latency_last7,
          audience_1080p_ultra_low_latency_last7,
          audience_2k_ultra_low_latency_last7,
          audience_4k_ultra_low_latency_last7,
          audience_2k_last7,
          audience_4k_last7,
          audience_1080p_last7,
          host_1080p_last7,
          host_2k_last7,
          host_4k_last7
        FROM levels_usage_dod_di_1
        WHERE CAST(tag AS VARCHAR) = 'Industry' AND date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-06') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-04') AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS ""自定义 SQL 查询""
    HAVING COUNT(1) > 0) AS ""t0""
WHERE ""自定义 SQL 查询"".""dim"" = 1 AND ""自定义 SQL 查询"".""rank_level1"" = 8 AND date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d') = ""t0"".""__measure__0""
GROUP BY 35"
"SELECT ""自定义 SQL 查询"".""idc"" AS ""idc"",
  ""自定义 SQL 查询"".""srcRegion"" AS ""srcRegion"",
    CASE WHEN SUM(""自定义 SQL 查询"".""p2s_total"") >= 0 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100 THEN '0-100' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 1000 THEN '100-1000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 1000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 10000 THEN '1000-10000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 10000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100000 THEN '10000-100000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100000 THEN '100000以上' ELSE 'other' END AS ""usr_Calculation_4757419695720181760_nk""
FROM (SELECT date AS ""date"",
      src_domain AS ""srcDomain"",
      src_region AS ""srcRegion"",
      dest_idc AS ""idc"",
      delay_25 AS ""p2s_Delay25"",
      delay_50 AS ""p2s_Delay50"",
      delay_75 AS ""p2s_Delay75"",
      delay_100 AS ""p2s_Delay100"",
      delay_125 AS ""p2s_Delay125"",
      delay_150 AS ""p2s_Delay150"",
      delay_total,
      lost_ratio_5 AS ""p2s_lostRatio"",
      lostratio_total AS ""p2s_total"",
      jitter95_50 AS ""p2s_jitter95_50"",
      jitter95_100 AS ""p2s_jitter95_100"",
      jitter95_200 AS ""p2s_jitter95_200"",
      jitter95_300 AS ""p2s_jitter95_300"",
      jitter95_total,
      product_line,
      product_type
    FROM media.p2s_cover_mainland_ip
    WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-25') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-01')) AS ""自定义 SQL 查询""
GROUP BY 1,
  2"
"SELECT SUM(""自定义 SQL 查询"".""delay25"") AS ""TEMP(Calculation_3094043381461364736)(3362377732)(0)"",
  SUM(""自定义 SQL 查询"".""delay_total"") AS ""TEMP(Calculation_3094043381461364736)(363980608)(0)"",
  ""自定义 SQL 查询"".""country"" AS ""country"",
  DATE_ADD('SECOND', 0, date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d')) AS ""tdy_date_ok""
FROM (SELECT *
    FROM media.sdrtn_okr_notvpn
    WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-16') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-11-29')) AS ""自定义 SQL 查询""
GROUP BY 3,
  4
HAVING CASE WHEN SUM(""自定义 SQL 查询"".""delay25"") / SUM(""自定义 SQL 查询"".""delay_total"") >= 0.5 AND SUM(""自定义 SQL 查询"".""delay75"") / SUM(""自定义 SQL 查询"".""delay_total"") >= 0.90000000000000002 AND SUM(""自定义 SQL 查询"".""lost_ratio_5"") / SUM(""自定义 SQL 查询"".""lost_total"") >= 0.96499999999999997 THEN 0 ELSE 1 END"
"SELECT '跳转：音频可用性' AS ""Calculation_5876704998653468673""
FROM (SELECT t1.date,
        CASE WHEN CAST(stat_period AS VARCHAR) = 'day' THEN substr(CAST(date_parse(cast( t1.date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(substr(CAST(start_date AS VARCHAR), 1, 10) AS VARCHAR), '~', CAST(substr(CAST(end_date AS VARCHAR), 1, 10) AS VARCHAR)) END AS period,
      start_date,
      end_date,
      stat_period,
      tag,
      t1.dim,
      level1,
      level2,
      level3,
      level4,
      os,
      ver,
      ver_type,
      domain,
      country,
      region,
      net,
      vid,
      project,
      company_id,
      company_name,
      rowsnum,
      lastusage,
      thisusage,
      fiveSecJoinSuccess,
      totalJoin,
      cnt_sid,
      video_freeze_time,
      video_totaltime,
      audio_freeze_time,
      audio_totaltime,
      s2l_total_delay_sec,
      s2l_25ms_delay_sec,
      s2l_75ms_delay_sec,
      p2s_lost_Leq5,
      p2s_lost_all,
      crash_cnt,
      service_cnt,
      ""1s_succ_join_ap_cnt"",
      ""5s_succ_join_ap_cnt"",
      total_join_ap_cnt,
      totalJoinSuccess,
      threeSecJoinSuccess,
      video_freeze_time_200,
      video_totaltime_200,
      video_freeze_time_500,
      video_totaltime_500,
      ""3s_succ_join_session_cnt_last1"",
      ""5s_succ_join_session_cnt_last1"",
      succ_join_session_cnt_last1,
      total_join_session_cnt_last1,
      total_session_cnt_last1,
      ""1s_succ_join_ap_cnt_last1"",
      ""5s_succ_join_ap_cnt_last1"",
      total_join_ap_cnt_last1,
      ""3s_succ_join_session_cnt_last7"",
      ""5s_succ_join_session_cnt_last7"",
      succ_join_session_cnt_last7,
      total_join_session_cnt_last7,
      total_session_cnt_last7,
      ""1s_succ_join_ap_cnt_last7"",
      ""5s_succ_join_ap_cnt_last7"",
      total_join_ap_cnt_last7,
      video_freeze_time_last1,
      video_totaltime_last1,
      video_freeze_time_500_last1,
      video_totaltime_500_last1,
      video_freeze_time_200_last1,
      video_totaltime_200_last1,
      video_freeze_time_last7,
      video_totaltime_last7,
      video_freeze_time_500_last7,
      video_totaltime_500_last7,
      video_freeze_time_200_last7,
      video_totaltime_200_last7,
      audio_freeze_time_last1,
      audio_totaltime_last1,
      audio_freeze_time_last7,
      audio_totaltime_last7,
      s2l_total_delay_sec_last1,
      s2l_25ms_delay_sec_last1,
      s2l_75ms_delay_sec_last1,
      s2l_total_delay_sec_last7,
      s2l_25ms_delay_sec_last7,
      s2l_75ms_delay_sec_last7,
      p2s_lost_Leq5_last1,
      p2s_lost_all_last1,
      p2s_lost_Leq5_last7,
      p2s_lost_all_last7,
      crash_cnt_last1,
      service_cnt_last1,
      crash_cnt_last7,
      service_cnt_last7,
      product_level1,
      product_level2,
      product_level3,
      product_level4,
      s2l_lost_Leq5,
      s2l_lost_all,
      s2l_lost_Leq5_last1,
      s2l_lost_all_last1,
      s2l_lost_Leq5_last7,
      s2l_lost_all_last7,
      fiveSecJoinSuccess_total,
      totalJoin_total,
      cnt_sid_total,
      video_freeze_time_total,
      video_totaltime_total,
      audio_freeze_time_total,
      audio_totaltime_total,
      s2l_total_delay_sec_total,
      s2l_25ms_delay_sec_total,
      s2l_75ms_delay_sec_total,
      p2s_lost_Leq5_total,
      p2s_lost_all_total,
      crash_cnt_total,
      service_cnt_total,
      ""1s_succ_join_ap_cnt_total"",
      ""5s_succ_join_ap_cnt_total"",
      total_join_ap_cnt_total,
      totalJoinSuccess_total,
      threeSecJoinSuccess_total,
      video_freeze_time_200_total,
      video_totaltime_200_total,
      video_freeze_time_500_total,
      video_totaltime_500_total,
      ""3s_succ_join_session_cnt_last1_total"",
      ""5s_succ_join_session_cnt_last1_total"",
      succ_join_session_cnt_last1_total,
      total_join_session_cnt_last1_total,
      total_session_cnt_last1_total,
      ""1s_succ_join_ap_cnt_last1_total"",
      ""5s_succ_join_ap_cnt_last1_total"",
      total_join_ap_cnt_last1_total,
      ""3s_succ_join_session_cnt_last7_total"",
      ""5s_succ_join_session_cnt_last7_total"",
      succ_join_session_cnt_last7_total,
      total_join_session_cnt_last7_total,
      total_session_cnt_last7_total,
      ""1s_succ_join_ap_cnt_last7_total"",
      ""5s_succ_join_ap_cnt_last7_total"",
      total_join_ap_cnt_last7_total,
      video_freeze_time_last1_total,
      video_totaltime_last1_total,
      video_freeze_time_500_last1_total,
      video_totaltime_500_last1_total,
      video_freeze_time_200_last1_total,
      video_totaltime_200_last1_total,
      video_freeze_time_last7_total,
      video_totaltime_last7_total,
      video_freeze_time_500_last7_total,
      video_totaltime_500_last7_total,
      video_freeze_time_200_last7_total,
      video_totaltime_200_last7_total,
      audio_freeze_time_last1_total,
      audio_totaltime_last1_total,
      audio_freeze_time_last7_total,
      audio_totaltime_last7_total,
      s2l_total_delay_sec_last1_total,
      s2l_25ms_delay_sec_last1_total,
      s2l_75ms_delay_sec_last1_total,
      s2l_total_delay_sec_last7_total,
      s2l_25ms_delay_sec_last7_total,
      s2l_75ms_delay_sec_last7_total,
      p2s_lost_Leq5_last1_total,
      p2s_lost_all_last1_total,
      p2s_lost_Leq5_last7_total,
      p2s_lost_all_last7_total,
      crash_cnt_last1_total,
      service_cnt_last1_total,
      crash_cnt_last7_total,
      service_cnt_last7_total,
      s2l_lost_Leq5_total,
      s2l_lost_all_total,
      s2l_lost_Leq5_last1_total,
      s2l_lost_all_last1_total,
      s2l_lost_Leq5_last7_total,
      s2l_lost_all_last7_total
    FROM report_datahub.pub_levels_quality_di_1 AS t1
      LEFT JOIN (SELECT date,
          dim,
          SUM(fiveSecJoinSuccess) AS fiveSecJoinSuccess_total,
          SUM(totalJoin) AS totalJoin_total,
          SUM(cnt_sid) AS cnt_sid_total,
          SUM(video_freeze_time) AS video_freeze_time_total,
          SUM(video_totaltime) AS video_totaltime_total,
          SUM(audio_freeze_time) AS audio_freeze_time_total,
          SUM(audio_totaltime) AS audio_totaltime_total,
          SUM(s2l_total_delay_sec) AS s2l_total_delay_sec_total,
          SUM(s2l_25ms_delay_sec) AS s2l_25ms_delay_sec_total,
          SUM(s2l_75ms_delay_sec) AS s2l_75ms_delay_sec_total,
          SUM(p2s_lost_Leq5) AS p2s_lost_Leq5_total,
          SUM(p2s_lost_all) AS p2s_lost_all_total,
          SUM(crash_cnt) AS crash_cnt_total,
          SUM(service_cnt) AS service_cnt_total,
          SUM(""1s_succ_join_ap_cnt"") AS ""1s_succ_join_ap_cnt_total"",
          SUM(""5s_succ_join_ap_cnt"") AS ""5s_succ_join_ap_cnt_total"",
          SUM(total_join_ap_cnt) AS total_join_ap_cnt_total,
          SUM(totalJoinSuccess) AS totalJoinSuccess_total,
          SUM(threeSecJoinSuccess) AS threeSecJoinSuccess_total,
          SUM(video_freeze_time_200) AS video_freeze_time_200_total,
          SUM(video_totaltime_200) AS video_totaltime_200_total,
          SUM(video_freeze_time_500) AS video_freeze_time_500_total,
          SUM(video_totaltime_500) AS video_totaltime_500_total,
          SUM(""3s_succ_join_session_cnt_last1"") AS ""3s_succ_join_session_cnt_last1_total"",
          SUM(""5s_succ_join_session_cnt_last1"") AS ""5s_succ_join_session_cnt_last1_total"",
          SUM(succ_join_session_cnt_last1) AS succ_join_session_cnt_last1_total,
          SUM(total_join_session_cnt_last1) AS total_join_session_cnt_last1_total,
          SUM(total_session_cnt_last1) AS total_session_cnt_last1_total,
          SUM(""1s_succ_join_ap_cnt_last1"") AS ""1s_succ_join_ap_cnt_last1_total"",
          SUM(""5s_succ_join_ap_cnt_last1"") AS ""5s_succ_join_ap_cnt_last1_total"",
          SUM(total_join_ap_cnt_last1) AS total_join_ap_cnt_last1_total,
          SUM(""3s_succ_join_session_cnt_last7"") AS ""3s_succ_join_session_cnt_last7_total"",
          SUM(""5s_succ_join_session_cnt_last7"") AS ""5s_succ_join_session_cnt_last7_total"",
          SUM(succ_join_session_cnt_last7) AS succ_join_session_cnt_last7_total,
          SUM(total_join_session_cnt_last7) AS total_join_session_cnt_last7_total,
          SUM(total_session_cnt_last7) AS total_session_cnt_last7_total,
          SUM(""1s_succ_join_ap_cnt_last7"") AS ""1s_succ_join_ap_cnt_last7_total"",
          SUM(""5s_succ_join_ap_cnt_last7"") AS ""5s_succ_join_ap_cnt_last7_total"",
          SUM(total_join_ap_cnt_last7) AS total_join_ap_cnt_last7_total,
          SUM(video_freeze_time_last1) AS video_freeze_time_last1_total,
          SUM(video_totaltime_last1) AS video_totaltime_last1_total,
          SUM(video_freeze_time_500_last1) AS video_freeze_time_500_last1_total,
          SUM(video_totaltime_500_last1) AS video_totaltime_500_last1_total,
          SUM(video_freeze_time_200_last1) AS video_freeze_time_200_last1_total,
          SUM(video_totaltime_200_last1) AS video_totaltime_200_last1_total,
          SUM(video_freeze_time_last7) AS video_freeze_time_last7_total,
          SUM(video_totaltime_last7) AS video_totaltime_last7_total,
          SUM(video_freeze_time_500_last7) AS video_freeze_time_500_last7_total,
          SUM(video_totaltime_500_last7) AS video_totaltime_500_last7_total,
          SUM(video_freeze_time_200_last7) AS video_freeze_time_200_last7_total,
          SUM(video_totaltime_200_last7) AS video_totaltime_200_last7_total,
          SUM(audio_freeze_time_last1) AS audio_freeze_time_last1_total,
          SUM(audio_totaltime_last1) AS audio_totaltime_last1_total,
          SUM(audio_freeze_time_last7) AS audio_freeze_time_last7_total,
          SUM(audio_totaltime_last7) AS audio_totaltime_last7_total,
          SUM(s2l_total_delay_sec_last1) AS s2l_total_delay_sec_last1_total,
          SUM(s2l_25ms_delay_sec_last1) AS s2l_25ms_delay_sec_last1_total,
          SUM(s2l_75ms_delay_sec_last1) AS s2l_75ms_delay_sec_last1_total,
          SUM(s2l_total_delay_sec_last7) AS s2l_total_delay_sec_last7_total,
          SUM(s2l_25ms_delay_sec_last7) AS s2l_25ms_delay_sec_last7_total,
          SUM(s2l_75ms_delay_sec_last7) AS s2l_75ms_delay_sec_last7_total,
          SUM(p2s_lost_Leq5_last1) AS p2s_lost_Leq5_last1_total,
          SUM(p2s_lost_all_last1) AS p2s_lost_all_last1_total,
          SUM(p2s_lost_Leq5_last7) AS p2s_lost_Leq5_last7_total,
          SUM(p2s_lost_all_last7) AS p2s_lost_all_last7_total,
          SUM(crash_cnt_last1) AS crash_cnt_last1_total,
          SUM(service_cnt_last1) AS service_cnt_last1_total,
          SUM(crash_cnt_last7) AS crash_cnt_last7_total,
          SUM(service_cnt_last7) AS service_cnt_last7_total,
          SUM(s2l_lost_Leq5) AS s2l_lost_Leq5_total,
          SUM(s2l_lost_all) AS s2l_lost_all_total,
          SUM(s2l_lost_Leq5_last1) AS s2l_lost_Leq5_last1_total,
          SUM(s2l_lost_all_last1) AS s2l_lost_all_last1_total,
          SUM(s2l_lost_Leq5_last7) AS s2l_lost_Leq5_last7_total,
          SUM(s2l_lost_all_last7) AS s2l_lost_all_last7_total
        FROM report_datahub.pub_levels_quality_di_1
        WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-21') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-11-21') AND CAST(tag AS VARCHAR) = 'Product'
        GROUP BY date,
          dim) AS t2 ON t1.date = t2.date AND t1.dim = t2.dim
    WHERE date_parse(cast( t1.date as VARCHAR), '%Y%m%d') >= DATE('2021-11-21') AND date_parse(cast( t1.date as VARCHAR), '%Y%m%d') <= DATE('2021-11-21') AND CAST(tag AS VARCHAR) = 'Product') AS ""自定义 SQL 查询""
WHERE CASE WHEN CAST(""自定义 SQL 查询"".""tag"" AS VARCHAR) = 'Industry' AND CAST(""自定义 SQL 查询"".""product_level1"" AS VARCHAR) = 'RTC' AND CAST(""自定义 SQL 查询"".""dim"" AS VARCHAR) = 'osver' THEN 0 WHEN CAST(""自定义 SQL 查询"".""tag"" AS VARCHAR) = 'VerType' AND CAST(""自定义 SQL 查询"".""product_level1"" AS VARCHAR) = 'RTC' AND CAST(""自定义 SQL 查询"".""dim"" AS VARCHAR) = 'osver' THEN 0 WHEN CAST(""自定义 SQL 查询"".""tag"" AS VARCHAR) = 'Product' AND CAST(""自定义 SQL 查询"".""dim"" AS VARCHAR) = 'osver' AND CAST(""自定义 SQL 查询"".""product_level1"" AS VARCHAR) = 'RTC' THEN 1 ELSE 0 END
HAVING COUNT(1) > 0"
"SELECT SUM(""自定义 SQL 查询"".""host_4k"") AS ""TEMP(Calculation_3519281700079370244)(1075454865)(0)"",
  SUM(""自定义 SQL 查询"".""audience_sd"") AS ""TEMP(Calculation_3519281700079370244)(1133678835)(0)"",
  SUM(""自定义 SQL 查询"".""host_1080p"") AS ""TEMP(Calculation_3519281700079370244)(1312501967)(0)"",
  SUM(""自定义 SQL 查询"".""host_hd"") AS ""TEMP(Calculation_3519281700079370244)(276907208)(0)"",
  SUM(""自定义 SQL 查询"".""video"") AS ""TEMP(Calculation_3519281700079370244)(2929708110)(0)"",
  SUM(""自定义 SQL 查询"".""audience_hd"") AS ""TEMP(Calculation_3519281700079370244)(2930728935)(0)"",
  SUM(""自定义 SQL 查询"".""audience_hdp"") AS ""TEMP(Calculation_3519281700079370244)(3010533957)(0)"",
  SUM(""自定义 SQL 查询"".""host_hdp"") AS ""TEMP(Calculation_3519281700079370244)(30306054)(0)"",
  SUM(""自定义 SQL 查询"".""host_audio"") AS ""TEMP(Calculation_3519281700079370244)(3087054365)(0)"",
  SUM(""自定义 SQL 查询"".""audio"") AS ""TEMP(Calculation_3519281700079370244)(3299350010)(0)"",
  SUM(""自定义 SQL 查询"".""audience_1080p"") AS ""TEMP(Calculation_3519281700079370244)(3628946582)(0)"",
  SUM(""自定义 SQL 查询"".""totalUsage"") AS ""TEMP(Calculation_3519281700079370244)(3847882359)(0)"",
  SUM(""自定义 SQL 查询"".""audience_audio"") AS ""TEMP(Calculation_3519281700079370244)(4109514392)(0)"",
  SUM(""自定义 SQL 查询"".""host_2k"") AS ""TEMP(Calculation_3519281700079370244)(586790827)(0)"",
  SUM(""自定义 SQL 查询"".""host_sd"") AS ""TEMP(Calculation_3519281700079370244)(709512178)(0)"",
  SUM(""自定义 SQL 查询"".""audience_4k"") AS ""TEMP(Calculation_3519281700079370244)(764410224)(0)"",
  SUM(""自定义 SQL 查询"".""audience_2k"") AS ""TEMP(Calculation_3519281700079370244)(943764407)(0)"",
  ""自定义 SQL 查询"".""level1"" AS ""level1"",
  SUM(""自定义 SQL 查询"".""totalUsage"") AS ""sum_totalUsage_ok"",
  DATE_ADD('SECOND', 0, date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d')) AS ""tdy_date_ok""
FROM (SELECT date,
        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,
      start_date AS start_date_7,
      end_date AS end_date,
      tag,
      area AS Scope,
      dim,
        CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,
      level2,
      level3,
      level4,
      product_level1 AS product_line,
      product_level2,
      product_level3,
      product_level4,
      vid_internal_industry_en AS cid_industry,
      vid_use_case_en AS vid_use_case_cn,
      vid_sector_en,
      ver_type,
      ver,
      os,
      domain,
      country,
      region,
      dim_grouping_name,
        CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,
      total AS totalUsage,
      audio,
      video,
      host_audio,
      audience_audio,
      host_sd,
      host_hd,
      host_hdp,
      host_1080p,
      host_2k,
      host_4k,
      audience_sd,
      audience_hd,
      audience_hdp,
      audience_1080p,
      audience_2k,
      audience_4k,
      audience_audio_low_latency,
      audience_sd_low_latency,
      audience_hd_low_latency,
      audience_hdp_low_latency,
      audience_1080p_low_latency,
      audience_2k_low_latency,
      audience_4k_low_latency,
      audience_audio_ultra_low_latency,
      audience_sd_ultra_low_latency,
      audience_hd_ultra_low_latency,
      audience_hdp_ultra_low_latency,
      audience_1080p_ultra_low_latency,
      audience_2k_ultra_low_latency,
      audience_4k_ultra_low_latency,
      total_last1 AS audio_video_last,
      audio_last1 AS audio_last,
      video_last1 AS video_last,
      video_sd_last1 AS video_sd_last,
      video_hd_last1 AS video_hd_last,
      video_hdp_last1 AS video_hdp_last,
      host_sd_last1 AS host_video_sd_last,
      audience_sd_last1 AS audience_video_sd_last,
      host_hd_last1 AS host_video_hd_last,
      audience_hd_last1 AS audience_video_hd_last,
      host_hdp_last1 AS host_video_hdp_last,
      audience_hdp_last1 AS audience_video_hdp_last,
      host_audio_last1 AS host_audio_last,
      audience_audio_last1 AS audience_audio_last,
      host_video_last1 AS host_video_last,
      audience_video_last1 AS audience_video_last,
      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,
      audience_video_low_latency_last1 AS audience_video_low_latency_last,
      audience_total_low_latency_last1 AS audience_total_low_latency_last,
      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,
      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,
      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,
      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,
      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,
      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,
      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,
      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,
      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,
      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,
      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,
      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,
      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,
      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,
      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,
      audience_2k_last1 AS audience_2k_last,
      audience_4k_last1 AS audience_4k_last,
      audience_1080p_last1 AS audience_1080p_last,
      host_1080p_last1 AS host_1080p_last,
      host_2k_last1 AS host_2k_last,
      host_4k_last1 AS host_4k_last,
      total_last7,
      audio_last7,
      video_last7,
      video_sd_last7,
      video_hd_last7,
      video_hdp_last7,
      host_sd_last7,
      audience_sd_last7,
      host_hd_last7,
      audience_hd_last7,
      host_hdp_last7,
      audience_hdp_last7,
      host_audio_last7,
      audience_audio_last7,
      host_video_last7,
      audience_video_last7,
      audience_audio_low_latency_last7,
      audience_video_low_latency_last7,
      audience_total_low_latency_last7,
      audience_sd_low_latency_last7,
      audience_hd_low_latency_last7,
      audience_hdp_low_latency_last7,
      audience_1080p_low_latency_last7,
      audience_2k_low_latency_last7,
      audience_4k_low_latency_last7,
      audience_audio_ultra_low_latency_last7,
      audience_video_ultra_low_latency_last7,
      audience_total_ultra_low_latency_last7,
      audience_sd_ultra_low_latency_last7,
      audience_hd_ultra_low_latency_last7,
      audience_hdp_ultra_low_latency_last7,
      audience_1080p_ultra_low_latency_last7,
      audience_2k_ultra_low_latency_last7,
      audience_4k_ultra_low_latency_last7,
      audience_2k_last7,
      audience_4k_last7,
      audience_1080p_last7,
      host_1080p_last7,
      host_2k_last7,
      host_4k_last7
    FROM levels_usage_dod_di_1
    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-06') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-04') AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS ""自定义 SQL 查询""
  CROSS JOIN (SELECT MAX(date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d')) AS ""__measure__0""
    FROM (SELECT date,
            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,
          start_date AS start_date_7,
          end_date AS end_date,
          tag,
          area AS Scope,
          dim,
            CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,
          level2,
          level3,
          level4,
          product_level1 AS product_line,
          product_level2,
          product_level3,
          product_level4,
          vid_internal_industry_en AS cid_industry,
          vid_use_case_en AS vid_use_case_cn,
          vid_sector_en,
          ver_type,
          ver,
          os,
          domain,
          country,
          region,
          dim_grouping_name,
            CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,
          total AS totalUsage,
          audio,
          video,
          host_audio,
          audience_audio,
          host_sd,
          host_hd,
          host_hdp,
          host_1080p,
          host_2k,
          host_4k,
          audience_sd,
          audience_hd,
          audience_hdp,
          audience_1080p,
          audience_2k,
          audience_4k,
          audience_audio_low_latency,
          audience_sd_low_latency,
          audience_hd_low_latency,
          audience_hdp_low_latency,
          audience_1080p_low_latency,
          audience_2k_low_latency,
          audience_4k_low_latency,
          audience_audio_ultra_low_latency,
          audience_sd_ultra_low_latency,
          audience_hd_ultra_low_latency,
          audience_hdp_ultra_low_latency,
          audience_1080p_ultra_low_latency,
          audience_2k_ultra_low_latency,
          audience_4k_ultra_low_latency,
          total_last1 AS audio_video_last,
          audio_last1 AS audio_last,
          video_last1 AS video_last,
          video_sd_last1 AS video_sd_last,
          video_hd_last1 AS video_hd_last,
          video_hdp_last1 AS video_hdp_last,
          host_sd_last1 AS host_video_sd_last,
          audience_sd_last1 AS audience_video_sd_last,
          host_hd_last1 AS host_video_hd_last,
          audience_hd_last1 AS audience_video_hd_last,
          host_hdp_last1 AS host_video_hdp_last,
          audience_hdp_last1 AS audience_video_hdp_last,
          host_audio_last1 AS host_audio_last,
          audience_audio_last1 AS audience_audio_last,
          host_video_last1 AS host_video_last,
          audience_video_last1 AS audience_video_last,
          audience_audio_low_latency_last1 AS audience_audio_low_latency_last,
          audience_video_low_latency_last1 AS audience_video_low_latency_last,
          audience_total_low_latency_last1 AS audience_total_low_latency_last,
          audience_sd_low_latency_last1 AS audience_sd_low_latency_last,
          audience_hd_low_latency_last1 AS audience_hd_low_latency_last,
          audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,
          audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,
          audience_2k_low_latency_last1 AS audience_2k_low_latency_last,
          audience_4k_low_latency_last1 AS audience_4k_low_latency_last,
          audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,
          audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,
          audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,
          audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,
          audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,
          audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,
          audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,
          audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,
          audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,
          audience_2k_last1 AS audience_2k_last,
          audience_4k_last1 AS audience_4k_last,
          audience_1080p_last1 AS audience_1080p_last,
          host_1080p_last1 AS host_1080p_last,
          host_2k_last1 AS host_2k_last,
          host_4k_last1 AS host_4k_last,
          total_last7,
          audio_last7,
          video_last7,
          video_sd_last7,
          video_hd_last7,
          video_hdp_last7,
          host_sd_last7,
          audience_sd_last7,
          host_hd_last7,
          audience_hd_last7,
          host_hdp_last7,
          audience_hdp_last7,
          host_audio_last7,
          audience_audio_last7,
          host_video_last7,
          audience_video_last7,
          audience_audio_low_latency_last7,
          audience_video_low_latency_last7,
          audience_total_low_latency_last7,
          audience_sd_low_latency_last7,
          audience_hd_low_latency_last7,
          audience_hdp_low_latency_last7,
          audience_1080p_low_latency_last7,
          audience_2k_low_latency_last7,
          audience_4k_low_latency_last7,
          audience_audio_ultra_low_latency_last7,
          audience_video_ultra_low_latency_last7,
          audience_total_ultra_low_latency_last7,
          audience_sd_ultra_low_latency_last7,
          audience_hd_ultra_low_latency_last7,
          audience_hdp_ultra_low_latency_last7,
          audience_1080p_ultra_low_latency_last7,
          audience_2k_ultra_low_latency_last7,
          audience_4k_ultra_low_latency_last7,
          audience_2k_last7,
          audience_4k_last7,
          audience_1080p_last7,
          host_1080p_last7,
          host_2k_last7,
          host_4k_last7
        FROM levels_usage_dod_di_1
        WHERE CAST(tag AS VARCHAR) = 'Industry' AND date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-06') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-04') AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS ""自定义 SQL 查询""
    HAVING COUNT(1) > 0) AS ""t0""
WHERE ""自定义 SQL 查询"".""dim"" = 1 AND ""自定义 SQL 查询"".""rank_level1"" = 3 AND date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d') = ""t0"".""__measure__0""
GROUP BY 18,
  20"
"SELECT SUM(""自定义 SQL 查询"".""host_4k"") AS ""TEMP(Calculation_3519281700079370244)(1075454865)(0)"",
  SUM(""自定义 SQL 查询"".""audience_sd"") AS ""TEMP(Calculation_3519281700079370244)(1133678835)(0)"",
  SUM(""自定义 SQL 查询"".""host_1080p"") AS ""TEMP(Calculation_3519281700079370244)(1312501967)(0)"",
  SUM(""自定义 SQL 查询"".""host_hd"") AS ""TEMP(Calculation_3519281700079370244)(276907208)(0)"",
  SUM(""自定义 SQL 查询"".""video"") AS ""TEMP(Calculation_3519281700079370244)(2929708110)(0)"",
  SUM(""自定义 SQL 查询"".""audience_hd"") AS ""TEMP(Calculation_3519281700079370244)(2930728935)(0)"",
  SUM(""自定义 SQL 查询"".""audience_hdp"") AS ""TEMP(Calculation_3519281700079370244)(3010533957)(0)"",
  SUM(""自定义 SQL 查询"".""host_hdp"") AS ""TEMP(Calculation_3519281700079370244)(30306054)(0)"",
  SUM(""自定义 SQL 查询"".""host_audio"") AS ""TEMP(Calculation_3519281700079370244)(3087054365)(0)"",
  SUM(""自定义 SQL 查询"".""audio"") AS ""TEMP(Calculation_3519281700079370244)(3299350010)(0)"",
  SUM(""自定义 SQL 查询"".""audience_1080p"") AS ""TEMP(Calculation_3519281700079370244)(3628946582)(0)"",
  SUM(""自定义 SQL 查询"".""totalUsage"") AS ""TEMP(Calculation_3519281700079370244)(3847882359)(0)"",
  SUM(""自定义 SQL 查询"".""audience_audio"") AS ""TEMP(Calculation_3519281700079370244)(4109514392)(0)"",
  SUM(""自定义 SQL 查询"".""host_2k"") AS ""TEMP(Calculation_3519281700079370244)(586790827)(0)"",
  SUM(""自定义 SQL 查询"".""host_sd"") AS ""TEMP(Calculation_3519281700079370244)(709512178)(0)"",
  SUM(""自定义 SQL 查询"".""audience_4k"") AS ""TEMP(Calculation_3519281700079370244)(764410224)(0)"",
  SUM(""自定义 SQL 查询"".""audience_2k"") AS ""TEMP(Calculation_3519281700079370244)(943764407)(0)"",
  MIN(""自定义 SQL 查询"".""level1"") AS ""TEMP(attr_level1_nk)(1482809429)(0)"",
  MAX(""自定义 SQL 查询"".""level1"") AS ""TEMP(attr_level1_nk)(3765460736)(0)"",
  ""自定义 SQL 查询"".""level3"" AS ""level3"",
  ""自定义 SQL 查询"".""stat_date"" AS ""stat_date""
FROM (SELECT date,
        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,
      start_date AS start_date_7,
      end_date AS end_date,
      tag,
      area AS Scope,
      dim,
        CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,
      level2,
      level3,
      level4,
      product_level1 AS product_line,
      product_level2,
      product_level3,
      product_level4,
      vid_internal_industry_en AS cid_industry,
      vid_use_case_en AS vid_use_case_cn,
      vid_sector_en,
      ver_type,
      ver,
      os,
      domain,
      country,
      region,
      dim_grouping_name,
        CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,
      total AS totalUsage,
      audio,
      video,
      host_audio,
      audience_audio,
      host_sd,
      host_hd,
      host_hdp,
      host_1080p,
      host_2k,
      host_4k,
      audience_sd,
      audience_hd,
      audience_hdp,
      audience_1080p,
      audience_2k,
      audience_4k,
      audience_audio_low_latency,
      audience_sd_low_latency,
      audience_hd_low_latency,
      audience_hdp_low_latency,
      audience_1080p_low_latency,
      audience_2k_low_latency,
      audience_4k_low_latency,
      audience_audio_ultra_low_latency,
      audience_sd_ultra_low_latency,
      audience_hd_ultra_low_latency,
      audience_hdp_ultra_low_latency,
      audience_1080p_ultra_low_latency,
      audience_2k_ultra_low_latency,
      audience_4k_ultra_low_latency,
      total_last1 AS audio_video_last,
      audio_last1 AS audio_last,
      video_last1 AS video_last,
      video_sd_last1 AS video_sd_last,
      video_hd_last1 AS video_hd_last,
      video_hdp_last1 AS video_hdp_last,
      host_sd_last1 AS host_video_sd_last,
      audience_sd_last1 AS audience_video_sd_last,
      host_hd_last1 AS host_video_hd_last,
      audience_hd_last1 AS audience_video_hd_last,
      host_hdp_last1 AS host_video_hdp_last,
      audience_hdp_last1 AS audience_video_hdp_last,
      host_audio_last1 AS host_audio_last,
      audience_audio_last1 AS audience_audio_last,
      host_video_last1 AS host_video_last,
      audience_video_last1 AS audience_video_last,
      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,
      audience_video_low_latency_last1 AS audience_video_low_latency_last,
      audience_total_low_latency_last1 AS audience_total_low_latency_last,
      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,
      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,
      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,
      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,
      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,
      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,
      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,
      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,
      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,
      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,
      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,
      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,
      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,
      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,
      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,
      audience_2k_last1 AS audience_2k_last,
      audience_4k_last1 AS audience_4k_last,
      audience_1080p_last1 AS audience_1080p_last,
      host_1080p_last1 AS host_1080p_last,
      host_2k_last1 AS host_2k_last,
      host_4k_last1 AS host_4k_last,
      total_last7,
      audio_last7,
      video_last7,
      video_sd_last7,
      video_hd_last7,
      video_hdp_last7,
      host_sd_last7,
      audience_sd_last7,
      host_hd_last7,
      audience_hd_last7,
      host_hdp_last7,
      audience_hdp_last7,
      host_audio_last7,
      audience_audio_last7,
      host_video_last7,
      audience_video_last7,
      audience_audio_low_latency_last7,
      audience_video_low_latency_last7,
      audience_total_low_latency_last7,
      audience_sd_low_latency_last7,
      audience_hd_low_latency_last7,
      audience_hdp_low_latency_last7,
      audience_1080p_low_latency_last7,
      audience_2k_low_latency_last7,
      audience_4k_low_latency_last7,
      audience_audio_ultra_low_latency_last7,
      audience_video_ultra_low_latency_last7,
      audience_total_ultra_low_latency_last7,
      audience_sd_ultra_low_latency_last7,
      audience_hd_ultra_low_latency_last7,
      audience_hdp_ultra_low_latency_last7,
      audience_1080p_ultra_low_latency_last7,
      audience_2k_ultra_low_latency_last7,
      audience_4k_ultra_low_latency_last7,
      audience_2k_last7,
      audience_4k_last7,
      audience_1080p_last7,
      host_1080p_last7,
      host_2k_last7,
      host_4k_last7
    FROM levels_usage_dod_di_1
    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-06') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-04') AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS ""自定义 SQL 查询""
  CROSS JOIN (SELECT MAX(date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d')) AS ""__measure__0""
    FROM (SELECT date,
            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,
          start_date AS start_date_7,
          end_date AS end_date,
          tag,
          area AS Scope,
          dim,
            CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,
          level2,
          level3,
          level4,
          product_level1 AS product_line,
          product_level2,
          product_level3,
          product_level4,
          vid_internal_industry_en AS cid_industry,
          vid_use_case_en AS vid_use_case_cn,
          vid_sector_en,
          ver_type,
          ver,
          os,
          domain,
          country,
          region,
          dim_grouping_name,
            CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,
          total AS totalUsage,
          audio,
          video,
          host_audio,
          audience_audio,
          host_sd,
          host_hd,
          host_hdp,
          host_1080p,
          host_2k,
          host_4k,
          audience_sd,
          audience_hd,
          audience_hdp,
          audience_1080p,
          audience_2k,
          audience_4k,
          audience_audio_low_latency,
          audience_sd_low_latency,
          audience_hd_low_latency,
          audience_hdp_low_latency,
          audience_1080p_low_latency,
          audience_2k_low_latency,
          audience_4k_low_latency,
          audience_audio_ultra_low_latency,
          audience_sd_ultra_low_latency,
          audience_hd_ultra_low_latency,
          audience_hdp_ultra_low_latency,
          audience_1080p_ultra_low_latency,
          audience_2k_ultra_low_latency,
          audience_4k_ultra_low_latency,
          total_last1 AS audio_video_last,
          audio_last1 AS audio_last,
          video_last1 AS video_last,
          video_sd_last1 AS video_sd_last,
          video_hd_last1 AS video_hd_last,
          video_hdp_last1 AS video_hdp_last,
          host_sd_last1 AS host_video_sd_last,
          audience_sd_last1 AS audience_video_sd_last,
          host_hd_last1 AS host_video_hd_last,
          audience_hd_last1 AS audience_video_hd_last,
          host_hdp_last1 AS host_video_hdp_last,
          audience_hdp_last1 AS audience_video_hdp_last,
          host_audio_last1 AS host_audio_last,
          audience_audio_last1 AS audience_audio_last,
          host_video_last1 AS host_video_last,
          audience_video_last1 AS audience_video_last,
          audience_audio_low_latency_last1 AS audience_audio_low_latency_last,
          audience_video_low_latency_last1 AS audience_video_low_latency_last,
          audience_total_low_latency_last1 AS audience_total_low_latency_last,
          audience_sd_low_latency_last1 AS audience_sd_low_latency_last,
          audience_hd_low_latency_last1 AS audience_hd_low_latency_last,
          audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,
          audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,
          audience_2k_low_latency_last1 AS audience_2k_low_latency_last,
          audience_4k_low_latency_last1 AS audience_4k_low_latency_last,
          audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,
          audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,
          audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,
          audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,
          audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,
          audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,
          audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,
          audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,
          audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,
          audience_2k_last1 AS audience_2k_last,
          audience_4k_last1 AS audience_4k_last,
          audience_1080p_last1 AS audience_1080p_last,
          host_1080p_last1 AS host_1080p_last,
          host_2k_last1 AS host_2k_last,
          host_4k_last1 AS host_4k_last,
          total_last7,
          audio_last7,
          video_last7,
          video_sd_last7,
          video_hd_last7,
          video_hdp_last7,
          host_sd_last7,
          audience_sd_last7,
          host_hd_last7,
          audience_hd_last7,
          host_hdp_last7,
          audience_hdp_last7,
          host_audio_last7,
          audience_audio_last7,
          host_video_last7,
          audience_video_last7,
          audience_audio_low_latency_last7,
          audience_video_low_latency_last7,
          audience_total_low_latency_last7,
          audience_sd_low_latency_last7,
          audience_hd_low_latency_last7,
          audience_hdp_low_latency_last7,
          audience_1080p_low_latency_last7,
          audience_2k_low_latency_last7,
          audience_4k_low_latency_last7,
          audience_audio_ultra_low_latency_last7,
          audience_video_ultra_low_latency_last7,
          audience_total_ultra_low_latency_last7,
          audience_sd_ultra_low_latency_last7,
          audience_hd_ultra_low_latency_last7,
          audience_hdp_ultra_low_latency_last7,
          audience_1080p_ultra_low_latency_last7,
          audience_2k_ultra_low_latency_last7,
          audience_4k_ultra_low_latency_last7,
          audience_2k_last7,
          audience_4k_last7,
          audience_1080p_last7,
          host_1080p_last7,
          host_2k_last7,
          host_4k_last7
        FROM levels_usage_dod_di_1
        WHERE CAST(tag AS VARCHAR) = 'Industry' AND date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-06') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-04') AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS ""自定义 SQL 查询""
    HAVING COUNT(1) > 0) AS ""t0""
WHERE ""自定义 SQL 查询"".""dim"" = 1 AND date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d') = ""t0"".""__measure__0""
GROUP BY 20,
  21"
"SELECT table_name FROM information_schema.tables WHERE table_schema = 'runtime'"
"SELECT ""自定义 SQL 查询"".""idc"" AS ""idc""
FROM (SELECT date AS ""date"",
      src_domain AS ""srcDomain"",
      src_region AS ""srcRegion"",
      dest_idc AS ""idc"",
      src_isp,
      dest_ip,
      delay_25 AS ""p2s_Delay25"",
      delay_50 AS ""p2s_Delay50"",
      delay_75 AS ""p2s_Delay75"",
      delay_100 AS ""p2s_Delay100"",
      delay_125 AS ""p2s_Delay125"",
      delay_150 AS ""p2s_Delay150"",
      delay_total,
      lost_ratio_5 AS ""p2s_lostRatio"",
      lostratio_total AS ""p2s_total"",
      jitter95_50 AS ""p2s_jitter95_50"",
      jitter95_100 AS ""p2s_jitter95_100"",
      jitter95_200 AS ""p2s_jitter95_200"",
      jitter95_300 AS ""p2s_jitter95_300"",
      jitter95_total,
      product_line,
      product_type
    FROM media.p2s_cover_mainland_ip
    WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-25') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-01')) AS ""自定义 SQL 查询""
GROUP BY 1
ORDER BY ""idc"""
"SELECT ""自定义 SQL 查询"".""product_level1"" AS ""product_level1"",
  SUM(""自定义 SQL 查询"".""total"") AS ""sum_total_ok""
FROM (SELECT date,
      SUBSTR(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) AS date_range_1,
      SUBSTR(CAST(end_date AS VARCHAR), 1, 10) AS date_range_2,
      stat_period,
        CASE WHEN CAST(stat_period AS VARCHAR) = 'day' THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,
      area,
      vid,
      project,
      company_id AS cid,
      company_name AS company,
      customer_level AS level,
      vid_internal_industry_en AS industry,
      vid_use_case_cn,
      csdc_owner,
      os,
      ver,
      ver_type,
      product_level1,
      product_level2,
      product_level3,
      total,
      audio,
      video,
      video_sd,
      video_hd,
      video_hdp,
        host_audio + host_video AS host,
      host_audio,
      host_video,
      host_sd,
      host_hd,
      host_hdp,
        audience_audio + audience_video AS audience,
        audience_audio_low_latency + audience_video_low_latency AS audience_low_latency,
      audience_audio,
      audience_audio_low_latency,
      audience_video,
      audience_video_low_latency,
      audience_sd,
      audience_sd_low_latency,
      audience_hd,
      audience_hd_low_latency,
      audience_hdp,
      audience_hdp_low_latency,
      total_last1,
      audio_last1,
      video_last1,
      video_sd_last1,
      video_hd_last1,
      video_hdp_last1,
        host_audio_last1 + host_video_last1 AS host_last1,
      host_audio_last1,
      host_video_last1,
        audience_audio_last1 + audience_video_last1 AS audience_last1,
        audience_audio_low_latency_last1 + audience_video_low_latency_last1 AS audience_low_latency_last1,
      audience_audio_last1,
      audience_audio_low_latency_last1,
      audience_video_last1,
      audience_video_low_latency_last1,
      total_last7,
      audio_last7,
      video_last7,
      video_sd_last7,
      video_hd_last7,
      video_hdp_last7,
        host_audio_last7 + host_video_last7 AS host_last7,
      host_audio_last7,
      host_video_last7,
        audience_audio_last7 + audience_video_last7 AS audience_last7,
        audience_audio_low_latency_last7 + audience_video_low_latency_last7 AS audience_low_latency_last7,
      audience_audio_last7,
      audience_audio_low_latency_last7,
      audience_video_last7,
      audience_video_low_latency_last7
    FROM report_datahub.vendor_vid_usage_di_1
    WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-06') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-06') AND CAST(vid AS VARCHAR) = CAST(311291 AS VARCHAR) AND dim = 1) AS ""自定义 SQL 查询""
GROUP BY 1"
"SELECT '跳转：视频可用性' AS ""Calculation_5876704998657425411""
FROM (SELECT date,
        CASE WHEN CAST(stat_period AS VARCHAR) = 'day' THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(substr(CAST(start_date AS VARCHAR), 1, 10) AS VARCHAR), '~', CAST(substr(CAST(end_date AS VARCHAR), 1, 10) AS VARCHAR)) END AS period,
      start_date,
      end_date,
      stat_period,
      tag,
      dim,
      level1,
      level2,
      level3,
      level4,
      '' AS pd,
      os,
      ver,
      ver_type,
      '' AS product_line,
      '' AS product_type,
      domain,
      country,
      region,
      net,
      vid,
      project,
      company_id,
      company_name,
      rowsnum,
      lastusage,
      thisusage,
      fiveSecJoinSuccess,
      totalJoin,
      cnt_sid,
      video_freeze_time,
      video_totaltime,
      audio_freeze_time,
      audio_totaltime,
      s2l_total_delay_sec,
      s2l_25ms_delay_sec,
      s2l_75ms_delay_sec,
      p2s_lost_Leq5,
      p2s_lost_all,
      crash_cnt,
      service_cnt,
      ""1s_succ_join_ap_cnt"",
      ""5s_succ_join_ap_cnt"",
      total_join_ap_cnt,
      totalJoinSuccess,
      threeSecJoinSuccess,
      video_freeze_time_200,
      video_totaltime_200,
      video_freeze_time_500,
      video_totaltime_500,
      ""3s_succ_join_session_cnt_last1"",
      ""5s_succ_join_session_cnt_last1"",
      succ_join_session_cnt_last1,
      total_join_session_cnt_last1,
      total_session_cnt_last1,
      ""1s_succ_join_ap_cnt_last1"",
      ""5s_succ_join_ap_cnt_last1"",
      total_join_ap_cnt_last1,
      ""3s_succ_join_session_cnt_last7"",
      ""5s_succ_join_session_cnt_last7"",
      succ_join_session_cnt_last7,
      total_join_session_cnt_last7,
      total_session_cnt_last7,
      ""1s_succ_join_ap_cnt_last7"",
      ""5s_succ_join_ap_cnt_last7"",
      total_join_ap_cnt_last7,
      video_freeze_time_last1,
      video_totaltime_last1,
      video_freeze_time_500_last1,
      video_totaltime_500_last1,
      video_freeze_time_200_last1,
      video_totaltime_200_last1,
      video_freeze_time_last7,
      video_totaltime_last7,
      video_freeze_time_500_last7,
      video_totaltime_500_last7,
      video_freeze_time_200_last7,
      video_totaltime_200_last7,
      audio_freeze_time_last1,
      audio_totaltime_last1,
      audio_freeze_time_last7,
      audio_totaltime_last7,
      s2l_total_delay_sec_last1,
      s2l_25ms_delay_sec_last1,
      s2l_75ms_delay_sec_last1,
      s2l_total_delay_sec_last7,
      s2l_25ms_delay_sec_last7,
      s2l_75ms_delay_sec_last7,
      p2s_lost_Leq5_last1,
      p2s_lost_all_last1,
      p2s_lost_Leq5_last7,
      p2s_lost_all_last7,
      crash_cnt_last1,
      service_cnt_last1,
      crash_cnt_last7,
      service_cnt_last7,
      product_level1,
      product_level2,
      product_level3,
      product_level4,
      s2l_lost_Leq5,
      s2l_lost_all,
      s2l_lost_Leq5_last1,
      s2l_lost_all_last1,
      s2l_lost_Leq5_last7,
      s2l_lost_all_last7
    FROM report_datahub.pub_levels_quality_di_1
    WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-21') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-11-21')) AS ""自定义 SQL 查询""
HAVING COUNT(1) > 0"
"SELECT ""自定义 SQL 查询"".""product_level3"" AS ""product_level3""
FROM (SELECT date,
      SUBSTR(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) AS date_range_1,
      SUBSTR(CAST(end_date AS VARCHAR), 1, 10) AS date_range_2,
      stat_period,
        CASE WHEN CAST(stat_period AS VARCHAR) = 'day' THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,
      area,
      vid,
      project,
      company_id AS cid,
      company_name AS company,
      customer_level AS level,
      vid_internal_industry_en AS industry,
      vid_use_case_cn,
      csdc_owner,
      os,
      ver,
      ver_type,
      product_level1,
      product_level2,
      product_level3,
      total,
      audio,
      video,
      video_sd,
      video_hd,
      video_hdp,
        host_audio + host_video AS host,
      host_audio,
      host_video,
      host_sd,
      host_hd,
      host_hdp,
        audience_audio + audience_video AS audience,
        audience_audio_low_latency + audience_video_low_latency AS audience_low_latency,
      audience_audio,
      audience_audio_low_latency,
      audience_video,
      audience_video_low_latency,
      audience_sd,
      audience_sd_low_latency,
      audience_hd,
      audience_hd_low_latency,
      audience_hdp,
      audience_hdp_low_latency,
      total_last1,
      audio_last1,
      video_last1,
      video_sd_last1,
      video_hd_last1,
      video_hdp_last1,
        host_audio_last1 + host_video_last1 AS host_last1,
      host_audio_last1,
      host_video_last1,
        audience_audio_last1 + audience_video_last1 AS audience_last1,
        audience_audio_low_latency_last1 + audience_video_low_latency_last1 AS audience_low_latency_last1,
      audience_audio_last1,
      audience_audio_low_latency_last1,
      audience_video_last1,
      audience_video_low_latency_last1,
      total_last7,
      audio_last7,
      video_last7,
      video_sd_last7,
      video_hd_last7,
      video_hdp_last7,
        host_audio_last7 + host_video_last7 AS host_last7,
      host_audio_last7,
      host_video_last7,
        audience_audio_last7 + audience_video_last7 AS audience_last7,
        audience_audio_low_latency_last7 + audience_video_low_latency_last7 AS audience_low_latency_last7,
      audience_audio_last7,
      audience_audio_low_latency_last7,
      audience_video_last7,
      audience_video_low_latency_last7
    FROM report_datahub.vendor_vid_usage_di_1
    WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-06') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-06') AND CAST(vid AS VARCHAR) = CAST(311291 AS VARCHAR) AND dim = 1) AS ""自定义 SQL 查询""
GROUP BY 1
ORDER BY ""product_level3"""
"SELECT SUM(""自定义 SQL 查询"".""s2l_25ms_delay_sec"") AS ""TEMP(Calculation_1430244791154503680)(2227145667)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_total_delay_sec"") AS ""TEMP(Calculation_1430244791154503680)(2460078802)(0)"",
  SUM(""自定义 SQL 查询"".""5s_succ_join_ap_cnt"") AS ""TEMP(Calculation_1430244791247978510)(1716451703)(0)"",
  SUM(""自定义 SQL 查询"".""total_join_ap_cnt"") AS ""TEMP(Calculation_1430244791247978510)(2681092799)(0)"",
  SUM(""自定义 SQL 查询"".""video_freeze_time_500"") AS ""TEMP(Calculation_1857594119395086336)(389023081)(0)"",
  SUM(""自定义 SQL 查询"".""video_totaltime_500"") AS ""TEMP(Calculation_1857594119395086336)(458654145)(0)"",
  SUM(""自定义 SQL 查询"".""video_totaltime_200"") AS ""TEMP(Calculation_2033093767653158912)(2104207895)(0)"",
  SUM(""自定义 SQL 查询"".""video_freeze_time_200"") AS ""TEMP(Calculation_2033093767653158912)(530162565)(0)"",
  SUM(""自定义 SQL 查询"".""totalJoin"") AS ""TEMP(Calculation_374009936508170240)(2073556184)(0)"",
  SUM(""自定义 SQL 查询"".""totalJoinSuccess"") AS ""TEMP(Calculation_374009936508170240)(2807417001)(0)"",
  SUM(""自定义 SQL 查询"".""threeSecJoinSuccess"") AS ""TEMP(Calculation_374009936508321793)(3693645608)(0)"",
  SUM(""自定义 SQL 查询"".""fiveSecJoinSuccess"") AS ""TEMP(Calculation_374009936508416002)(383616769)(0)"",
  SUM(""自定义 SQL 查询"".""video_totaltime"") AS ""TEMP(Calculation_374009936515215363)(2797449586)(0)"",
  SUM(""自定义 SQL 查询"".""video_freeze_time"") AS ""TEMP(Calculation_374009936515215363)(2940759860)(0)"",
  SUM(""自定义 SQL 查询"".""audio_totaltime"") AS ""TEMP(Calculation_374009936517861380)(1652566750)(0)"",
  SUM(""自定义 SQL 查询"".""audio_freeze_time"") AS ""TEMP(Calculation_374009936517861380)(2919389392)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_lost_Leq5"") AS ""TEMP(Calculation_374009936519704581)(1936123547)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_lost_all"") AS ""TEMP(Calculation_374009936519704581)(749826584)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_75ms_delay_sec"") AS ""TEMP(Calculation_6542393318886285312)(2003933318)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_lost_Leq5"") AS ""TEMP(Calculation_7012034266496475136)(2745840127)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_lost_all"") AS ""TEMP(Calculation_7012034266496475136)(734589263)(0)"",
  SUM(""自定义 SQL 查询"".""crash_cnt"") AS ""TEMP(Calculation_7034341207372070925)(2360900687)(0)"",
  SUM(""自定义 SQL 查询"".""service_cnt"") AS ""TEMP(Calculation_7034341207372070925)(4291252132)(0)"",
  DATE_ADD('SECOND', 0, date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d')) AS ""tdy_date_ok""
FROM (SELECT t1.date,
        CASE WHEN CAST(stat_period AS VARCHAR) = 'day' THEN substr(CAST(date_parse(cast( t1.date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(substr(CAST(start_date AS VARCHAR), 1, 10) AS VARCHAR), '~', CAST(substr(CAST(end_date AS VARCHAR), 1, 10) AS VARCHAR)) END AS period,
      start_date,
      end_date,
      stat_period,
      tag,
      t1.dim,
      level1,
      level2,
      level3,
      level4,
      os,
      ver,
      ver_type,
      domain,
      country,
      region,
      net,
      vid,
      project,
      company_id,
      company_name,
      rowsnum,
      lastusage,
      thisusage,
      fiveSecJoinSuccess,
      totalJoin,
      cnt_sid,
      video_freeze_time,
      video_totaltime,
      audio_freeze_time,
      audio_totaltime,
      s2l_total_delay_sec,
      s2l_25ms_delay_sec,
      s2l_75ms_delay_sec,
      p2s_lost_Leq5,
      p2s_lost_all,
      crash_cnt,
      service_cnt,
      ""1s_succ_join_ap_cnt"",
      ""5s_succ_join_ap_cnt"",
      total_join_ap_cnt,
      totalJoinSuccess,
      threeSecJoinSuccess,
      video_freeze_time_200,
      video_totaltime_200,
      video_freeze_time_500,
      video_totaltime_500,
      ""3s_succ_join_session_cnt_last1"",
      ""5s_succ_join_session_cnt_last1"",
      succ_join_session_cnt_last1,
      total_join_session_cnt_last1,
      total_session_cnt_last1,
      ""1s_succ_join_ap_cnt_last1"",
      ""5s_succ_join_ap_cnt_last1"",
      total_join_ap_cnt_last1,
      ""3s_succ_join_session_cnt_last7"",
      ""5s_succ_join_session_cnt_last7"",
      succ_join_session_cnt_last7,
      total_join_session_cnt_last7,
      total_session_cnt_last7,
      ""1s_succ_join_ap_cnt_last7"",
      ""5s_succ_join_ap_cnt_last7"",
      total_join_ap_cnt_last7,
      video_freeze_time_last1,
      video_totaltime_last1,
      video_freeze_time_500_last1,
      video_totaltime_500_last1,
      video_freeze_time_200_last1,
      video_totaltime_200_last1,
      video_freeze_time_last7,
      video_totaltime_last7,
      video_freeze_time_500_last7,
      video_totaltime_500_last7,
      video_freeze_time_200_last7,
      video_totaltime_200_last7,
      audio_freeze_time_last1,
      audio_totaltime_last1,
      audio_freeze_time_last7,
      audio_totaltime_last7,
      s2l_total_delay_sec_last1,
      s2l_25ms_delay_sec_last1,
      s2l_75ms_delay_sec_last1,
      s2l_total_delay_sec_last7,
      s2l_25ms_delay_sec_last7,
      s2l_75ms_delay_sec_last7,
      p2s_lost_Leq5_last1,
      p2s_lost_all_last1,
      p2s_lost_Leq5_last7,
      p2s_lost_all_last7,
      crash_cnt_last1,
      service_cnt_last1,
      crash_cnt_last7,
      service_cnt_last7,
      product_level1,
      product_level2,
      product_level3,
      product_level4,
      s2l_lost_Leq5,
      s2l_lost_all,
      s2l_lost_Leq5_last1,
      s2l_lost_all_last1,
      s2l_lost_Leq5_last7,
      s2l_lost_all_last7,
      fiveSecJoinSuccess_total,
      totalJoin_total,
      cnt_sid_total,
      video_freeze_time_total,
      video_totaltime_total,
      audio_freeze_time_total,
      audio_totaltime_total,
      s2l_total_delay_sec_total,
      s2l_25ms_delay_sec_total,
      s2l_75ms_delay_sec_total,
      p2s_lost_Leq5_total,
      p2s_lost_all_total,
      crash_cnt_total,
      service_cnt_total,
      ""1s_succ_join_ap_cnt_total"",
      ""5s_succ_join_ap_cnt_total"",
      total_join_ap_cnt_total,
      totalJoinSuccess_total,
      threeSecJoinSuccess_total,
      video_freeze_time_200_total,
      video_totaltime_200_total,
      video_freeze_time_500_total,
      video_totaltime_500_total,
      ""3s_succ_join_session_cnt_last1_total"",
      ""5s_succ_join_session_cnt_last1_total"",
      succ_join_session_cnt_last1_total,
      total_join_session_cnt_last1_total,
      total_session_cnt_last1_total,
      ""1s_succ_join_ap_cnt_last1_total"",
      ""5s_succ_join_ap_cnt_last1_total"",
      total_join_ap_cnt_last1_total,
      ""3s_succ_join_session_cnt_last7_total"",
      ""5s_succ_join_session_cnt_last7_total"",
      succ_join_session_cnt_last7_total,
      total_join_session_cnt_last7_total,
      total_session_cnt_last7_total,
      ""1s_succ_join_ap_cnt_last7_total"",
      ""5s_succ_join_ap_cnt_last7_total"",
      total_join_ap_cnt_last7_total,
      video_freeze_time_last1_total,
      video_totaltime_last1_total,
      video_freeze_time_500_last1_total,
      video_totaltime_500_last1_total,
      video_freeze_time_200_last1_total,
      video_totaltime_200_last1_total,
      video_freeze_time_last7_total,
      video_totaltime_last7_total,
      video_freeze_time_500_last7_total,
      video_totaltime_500_last7_total,
      video_freeze_time_200_last7_total,
      video_totaltime_200_last7_total,
      audio_freeze_time_last1_total,
      audio_totaltime_last1_total,
      audio_freeze_time_last7_total,
      audio_totaltime_last7_total,
      s2l_total_delay_sec_last1_total,
      s2l_25ms_delay_sec_last1_total,
      s2l_75ms_delay_sec_last1_total,
      s2l_total_delay_sec_last7_total,
      s2l_25ms_delay_sec_last7_total,
      s2l_75ms_delay_sec_last7_total,
      p2s_lost_Leq5_last1_total,
      p2s_lost_all_last1_total,
      p2s_lost_Leq5_last7_total,
      p2s_lost_all_last7_total,
      crash_cnt_last1_total,
      service_cnt_last1_total,
      crash_cnt_last7_total,
      service_cnt_last7_total,
      s2l_lost_Leq5_total,
      s2l_lost_all_total,
      s2l_lost_Leq5_last1_total,
      s2l_lost_all_last1_total,
      s2l_lost_Leq5_last7_total,
      s2l_lost_all_last7_total
    FROM report_datahub.pub_levels_quality_di_1 AS t1
      LEFT JOIN (SELECT date,
          dim,
          SUM(fiveSecJoinSuccess) AS fiveSecJoinSuccess_total,
          SUM(totalJoin) AS totalJoin_total,
          SUM(cnt_sid) AS cnt_sid_total,
          SUM(video_freeze_time) AS video_freeze_time_total,
          SUM(video_totaltime) AS video_totaltime_total,
          SUM(audio_freeze_time) AS audio_freeze_time_total,
          SUM(audio_totaltime) AS audio_totaltime_total,
          SUM(s2l_total_delay_sec) AS s2l_total_delay_sec_total,
          SUM(s2l_25ms_delay_sec) AS s2l_25ms_delay_sec_total,
          SUM(s2l_75ms_delay_sec) AS s2l_75ms_delay_sec_total,
          SUM(p2s_lost_Leq5) AS p2s_lost_Leq5_total,
          SUM(p2s_lost_all) AS p2s_lost_all_total,
          SUM(crash_cnt) AS crash_cnt_total,
          SUM(service_cnt) AS service_cnt_total,
          SUM(""1s_succ_join_ap_cnt"") AS ""1s_succ_join_ap_cnt_total"",
          SUM(""5s_succ_join_ap_cnt"") AS ""5s_succ_join_ap_cnt_total"",
          SUM(total_join_ap_cnt) AS total_join_ap_cnt_total,
          SUM(totalJoinSuccess) AS totalJoinSuccess_total,
          SUM(threeSecJoinSuccess) AS threeSecJoinSuccess_total,
          SUM(video_freeze_time_200) AS video_freeze_time_200_total,
          SUM(video_totaltime_200) AS video_totaltime_200_total,
          SUM(video_freeze_time_500) AS video_freeze_time_500_total,
          SUM(video_totaltime_500) AS video_totaltime_500_total,
          SUM(""3s_succ_join_session_cnt_last1"") AS ""3s_succ_join_session_cnt_last1_total"",
          SUM(""5s_succ_join_session_cnt_last1"") AS ""5s_succ_join_session_cnt_last1_total"",
          SUM(succ_join_session_cnt_last1) AS succ_join_session_cnt_last1_total,
          SUM(total_join_session_cnt_last1) AS total_join_session_cnt_last1_total,
          SUM(total_session_cnt_last1) AS total_session_cnt_last1_total,
          SUM(""1s_succ_join_ap_cnt_last1"") AS ""1s_succ_join_ap_cnt_last1_total"",
          SUM(""5s_succ_join_ap_cnt_last1"") AS ""5s_succ_join_ap_cnt_last1_total"",
          SUM(total_join_ap_cnt_last1) AS total_join_ap_cnt_last1_total,
          SUM(""3s_succ_join_session_cnt_last7"") AS ""3s_succ_join_session_cnt_last7_total"",
          SUM(""5s_succ_join_session_cnt_last7"") AS ""5s_succ_join_session_cnt_last7_total"",
          SUM(succ_join_session_cnt_last7) AS succ_join_session_cnt_last7_total,
          SUM(total_join_session_cnt_last7) AS total_join_session_cnt_last7_total,
          SUM(total_session_cnt_last7) AS total_session_cnt_last7_total,
          SUM(""1s_succ_join_ap_cnt_last7"") AS ""1s_succ_join_ap_cnt_last7_total"",
          SUM(""5s_succ_join_ap_cnt_last7"") AS ""5s_succ_join_ap_cnt_last7_total"",
          SUM(total_join_ap_cnt_last7) AS total_join_ap_cnt_last7_total,
          SUM(video_freeze_time_last1) AS video_freeze_time_last1_total,
          SUM(video_totaltime_last1) AS video_totaltime_last1_total,
          SUM(video_freeze_time_500_last1) AS video_freeze_time_500_last1_total,
          SUM(video_totaltime_500_last1) AS video_totaltime_500_last1_total,
          SUM(video_freeze_time_200_last1) AS video_freeze_time_200_last1_total,
          SUM(video_totaltime_200_last1) AS video_totaltime_200_last1_total,
          SUM(video_freeze_time_last7) AS video_freeze_time_last7_total,
          SUM(video_totaltime_last7) AS video_totaltime_last7_total,
          SUM(video_freeze_time_500_last7) AS video_freeze_time_500_last7_total,
          SUM(video_totaltime_500_last7) AS video_totaltime_500_last7_total,
          SUM(video_freeze_time_200_last7) AS video_freeze_time_200_last7_total,
          SUM(video_totaltime_200_last7) AS video_totaltime_200_last7_total,
          SUM(audio_freeze_time_last1) AS audio_freeze_time_last1_total,
          SUM(audio_totaltime_last1) AS audio_totaltime_last1_total,
          SUM(audio_freeze_time_last7) AS audio_freeze_time_last7_total,
          SUM(audio_totaltime_last7) AS audio_totaltime_last7_total,
          SUM(s2l_total_delay_sec_last1) AS s2l_total_delay_sec_last1_total,
          SUM(s2l_25ms_delay_sec_last1) AS s2l_25ms_delay_sec_last1_total,
          SUM(s2l_75ms_delay_sec_last1) AS s2l_75ms_delay_sec_last1_total,
          SUM(s2l_total_delay_sec_last7) AS s2l_total_delay_sec_last7_total,
          SUM(s2l_25ms_delay_sec_last7) AS s2l_25ms_delay_sec_last7_total,
          SUM(s2l_75ms_delay_sec_last7) AS s2l_75ms_delay_sec_last7_total,
          SUM(p2s_lost_Leq5_last1) AS p2s_lost_Leq5_last1_total,
          SUM(p2s_lost_all_last1) AS p2s_lost_all_last1_total,
          SUM(p2s_lost_Leq5_last7) AS p2s_lost_Leq5_last7_total,
          SUM(p2s_lost_all_last7) AS p2s_lost_all_last7_total,
          SUM(crash_cnt_last1) AS crash_cnt_last1_total,
          SUM(service_cnt_last1) AS service_cnt_last1_total,
          SUM(crash_cnt_last7) AS crash_cnt_last7_total,
          SUM(service_cnt_last7) AS service_cnt_last7_total,
          SUM(s2l_lost_Leq5) AS s2l_lost_Leq5_total,
          SUM(s2l_lost_all) AS s2l_lost_all_total,
          SUM(s2l_lost_Leq5_last1) AS s2l_lost_Leq5_last1_total,
          SUM(s2l_lost_all_last1) AS s2l_lost_all_last1_total,
          SUM(s2l_lost_Leq5_last7) AS s2l_lost_Leq5_last7_total,
          SUM(s2l_lost_all_last7) AS s2l_lost_all_last7_total
        FROM report_datahub.pub_levels_quality_di_1
        WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-21') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-05') AND CAST(tag AS VARCHAR) = 'Product'
        GROUP BY date,
          dim) AS t2 ON t1.date = t2.date AND t1.dim = t2.dim
    WHERE date_parse(cast( t1.date as VARCHAR), '%Y%m%d') >= DATE('2021-11-21') AND date_parse(cast( t1.date as VARCHAR), '%Y%m%d') <= DATE('2021-12-05') AND CAST(tag AS VARCHAR) = 'Product') AS ""自定义 SQL 查询""
WHERE CASE WHEN CAST(""自定义 SQL 查询"".""tag"" AS VARCHAR) = 'Industry' AND CAST(""自定义 SQL 查询"".""product_level1"" AS VARCHAR) = 'RTC' AND CAST(""自定义 SQL 查询"".""dim"" AS VARCHAR) = 'osver' THEN 0 WHEN CAST(""自定义 SQL 查询"".""tag"" AS VARCHAR) = 'VerType' AND CAST(""自定义 SQL 查询"".""product_level1"" AS VARCHAR) = 'RTC' AND CAST(""自定义 SQL 查询"".""dim"" AS VARCHAR) = 'osver' THEN 0 WHEN CAST(""自定义 SQL 查询"".""tag"" AS VARCHAR) = 'Product' AND CAST(""自定义 SQL 查询"".""dim"" AS VARCHAR) = 'osver' AND CAST(""自定义 SQL 查询"".""product_level1"" AS VARCHAR) = 'RTC' THEN 1 ELSE 0 END AND CAST(""自定义 SQL 查询"".""level2"" AS VARCHAR) = 'Native'
GROUP BY 24"
"SELECT ""t0"".""idc"" AS ""idc""
FROM (SELECT ""自定义 SQL 查询"".""idc"" AS ""idc""
    FROM (SELECT date AS ""date"",
          src_domain AS ""srcDomain"",
          src_country AS ""srcCountry"",
          dest_idc AS ""idc"",
          delay_25 AS ""p2s_Delay25"",
          delay_50 AS ""p2s_Delay50"",
          delay_75 AS ""p2s_Delay75"",
          delay_100 AS ""p2s_Delay100"",
          delay_125 AS ""p2s_Delay125"",
          delay_150 AS ""p2s_Delay150"",
          delay_total,
          lost_ratio_5 AS ""p2s_lostRatio"",
          lostratio_total AS ""p2s_total"",
          jitter95_50 AS ""p2s_jitter95_50"",
          jitter95_100 AS ""p2s_jitter95_100"",
          jitter95_200 AS ""p2s_jitter95_200"",
          jitter95_300 AS ""p2s_jitter95_300"",
          jitter95_total,
          product_line,
          product_type
        FROM media.p2s_cover_oversea_idc
        WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-25') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-01')) AS ""自定义 SQL 查询""
    WHERE ""自定义 SQL 查询"".""srcCountry"" NOT IN ('Falkland Islands', 'British Indian Ocean Territory', 'Montserrat', 'North Korea', 'Tuvalu', 'Niue')
    GROUP BY 1,
      ""自定义 SQL 查询"".""srcCountry"",
      ""自定义 SQL 查询"".""srcDomain""
    HAVING CAST(CASE WHEN SUM(""自定义 SQL 查询"".""p2s_total"") >= 0 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100 THEN '0-100' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 1000 THEN '100-1000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 1000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 10000 THEN '1000-10000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 10000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100000 THEN '10000-100000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100000 THEN '100000以上' ELSE 'other' END AS VARCHAR) = '100-1000' OR CAST(CASE WHEN SUM(""自定义 SQL 查询"".""p2s_total"") >= 0 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100 THEN '0-100' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 1000 THEN '100-1000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 1000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 10000 THEN '1000-10000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 10000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100000 THEN '10000-100000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100000 THEN '100000以上' ELSE 'other' END AS VARCHAR) = '1000-10000' OR CAST(CASE WHEN SUM(""自定义 SQL 查询"".""p2s_total"") >= 0 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100 THEN '0-100' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 1000 THEN '100-1000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 1000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 10000 THEN '1000-10000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 10000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100000 THEN '10000-100000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100000 THEN '100000以上' ELSE 'other' END AS VARCHAR) = '10000-100000' OR CAST(CASE WHEN SUM(""自定义 SQL 查询"".""p2s_total"") >= 0 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100 THEN '0-100' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 1000 THEN '100-1000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 1000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 10000 THEN '1000-10000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 10000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100000 THEN '10000-100000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100000 THEN '100000以上' ELSE 'other' END AS VARCHAR) = '100000以上') AS ""t0""
GROUP BY 1"
"SELECT DATE_ADD('SECOND', 0, date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d')) AS ""tdy_date_ok""
FROM (SELECT date,
        CASE WHEN CAST(stat_period AS VARCHAR) = 'day' THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(substr(CAST(start_date AS VARCHAR), 1, 10) AS VARCHAR), '~', CAST(substr(CAST(end_date AS VARCHAR), 1, 10) AS VARCHAR)) END AS period,
      start_date,
      end_date,
      stat_period,
      tag,
      dim,
      level1,
      level2,
      level3,
      level4,
      '' AS pd,
      os,
      ver,
      ver_type,
      '' AS product_line,
      '' AS product_type,
      domain,
      country,
      region,
      net,
      vid,
      project,
      company_id,
      company_name,
      rowsnum,
      lastusage,
      thisusage,
      fiveSecJoinSuccess,
      totalJoin,
      cnt_sid,
      video_freeze_time,
      video_totaltime,
      audio_freeze_time,
      audio_totaltime,
      s2l_total_delay_sec,
      s2l_25ms_delay_sec,
      s2l_75ms_delay_sec,
      p2s_lost_Leq5,
      p2s_lost_all,
      crash_cnt,
      service_cnt,
      ""1s_succ_join_ap_cnt"",
      ""5s_succ_join_ap_cnt"",
      total_join_ap_cnt,
      totalJoinSuccess,
      threeSecJoinSuccess,
      video_freeze_time_200,
      video_totaltime_200,
      video_freeze_time_500,
      video_totaltime_500,
      ""3s_succ_join_session_cnt_last1"",
      ""5s_succ_join_session_cnt_last1"",
      succ_join_session_cnt_last1,
      total_join_session_cnt_last1,
      total_session_cnt_last1,
      ""1s_succ_join_ap_cnt_last1"",
      ""5s_succ_join_ap_cnt_last1"",
      total_join_ap_cnt_last1,
      ""3s_succ_join_session_cnt_last7"",
      ""5s_succ_join_session_cnt_last7"",
      succ_join_session_cnt_last7,
      total_join_session_cnt_last7,
      total_session_cnt_last7,
      ""1s_succ_join_ap_cnt_last7"",
      ""5s_succ_join_ap_cnt_last7"",
      total_join_ap_cnt_last7,
      video_freeze_time_last1,
      video_totaltime_last1,
      video_freeze_time_500_last1,
      video_totaltime_500_last1,
      video_freeze_time_200_last1,
      video_totaltime_200_last1,
      video_freeze_time_last7,
      video_totaltime_last7,
      video_freeze_time_500_last7,
      video_totaltime_500_last7,
      video_freeze_time_200_last7,
      video_totaltime_200_last7,
      audio_freeze_time_last1,
      audio_totaltime_last1,
      audio_freeze_time_last7,
      audio_totaltime_last7,
      s2l_total_delay_sec_last1,
      s2l_25ms_delay_sec_last1,
      s2l_75ms_delay_sec_last1,
      s2l_total_delay_sec_last7,
      s2l_25ms_delay_sec_last7,
      s2l_75ms_delay_sec_last7,
      p2s_lost_Leq5_last1,
      p2s_lost_all_last1,
      p2s_lost_Leq5_last7,
      p2s_lost_all_last7,
      crash_cnt_last1,
      service_cnt_last1,
      crash_cnt_last7,
      service_cnt_last7,
      product_level1,
      product_level2,
      product_level3,
      product_level4,
      s2l_lost_Leq5,
      s2l_lost_all,
      s2l_lost_Leq5_last1,
      s2l_lost_all_last1,
      s2l_lost_Leq5_last7,
      s2l_lost_all_last7
    FROM report_datahub.pub_levels_quality_di_1
    WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-21') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-05')) AS ""自定义 SQL 查询""
GROUP BY 1"
"SELECT MIN(""t0"".""srcCountry"") AS ""srcCountry""
FROM (SELECT ""自定义 SQL 查询"".""srcCountry"" AS ""srcCountry""
    FROM (SELECT date AS ""date"",
          src_domain AS ""srcDomain"",
          src_country AS ""srcCountry"",
          dest_idc AS ""idc"",
          delay_25 AS ""p2s_Delay25"",
          delay_50 AS ""p2s_Delay50"",
          delay_75 AS ""p2s_Delay75"",
          delay_100 AS ""p2s_Delay100"",
          delay_125 AS ""p2s_Delay125"",
          delay_150 AS ""p2s_Delay150"",
          delay_total,
          lost_ratio_5 AS ""p2s_lostRatio"",
          lostratio_total AS ""p2s_total"",
          jitter95_50 AS ""p2s_jitter95_50"",
          jitter95_100 AS ""p2s_jitter95_100"",
          jitter95_200 AS ""p2s_jitter95_200"",
          jitter95_300 AS ""p2s_jitter95_300"",
          jitter95_total,
          product_line,
          product_type
        FROM media.p2s_cover_oversea_idc
        WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-25') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-01')) AS ""自定义 SQL 查询""
    WHERE CAST(""自定义 SQL 查询"".""srcCountry"" AS VARCHAR) = 'India' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'aofei-frankfurt1g' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'zhuzhou1g-ctel'
    GROUP BY ""自定义 SQL 查询"".""idc"",
      1,
      ""自定义 SQL 查询"".""srcDomain""
    HAVING CAST(CASE WHEN SUM(""自定义 SQL 查询"".""p2s_total"") >= 0 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100 THEN '0-100' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 1000 THEN '100-1000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 1000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 10000 THEN '1000-10000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 10000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100000 THEN '10000-100000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100000 THEN '100000以上' ELSE 'other' END AS VARCHAR) = '100-1000' OR CAST(CASE WHEN SUM(""自定义 SQL 查询"".""p2s_total"") >= 0 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100 THEN '0-100' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 1000 THEN '100-1000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 1000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 10000 THEN '1000-10000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 10000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100000 THEN '10000-100000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100000 THEN '100000以上' ELSE 'other' END AS VARCHAR) = '1000-10000' OR CAST(CASE WHEN SUM(""自定义 SQL 查询"".""p2s_total"") >= 0 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100 THEN '0-100' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 1000 THEN '100-1000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 1000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 10000 THEN '1000-10000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 10000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100000 THEN '10000-100000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100000 THEN '100000以上' ELSE 'other' END AS VARCHAR) = '10000-100000' OR CAST(CASE WHEN SUM(""自定义 SQL 查询"".""p2s_total"") >= 0 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100 THEN '0-100' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 1000 THEN '100-1000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 1000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 10000 THEN '1000-10000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 10000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100000 THEN '10000-100000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100000 THEN '100000以上' ELSE 'other' END AS VARCHAR) = '100000以上') AS ""t0""
HAVING COUNT(1) > 0"
"SELECT SUM(""自定义 SQL 查询"".""s2l_25ms_delay_sec_last7"") AS ""TEMP(Calculation_1430244791162150914)(10119751)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_25ms_delay_sec"") AS ""TEMP(Calculation_1430244791162150914)(2227145667)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_total_delay_sec"") AS ""TEMP(Calculation_1430244791162150914)(2460078802)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_total_delay_sec_last7"") AS ""TEMP(Calculation_1430244791162150914)(3558359569)(0)"",
  SUM(""自定义 SQL 查询"".""5s_succ_join_ap_cnt"") AS ""TEMP(Calculation_1430244791249522705)(1716451703)(0)"",
  SUM(""自定义 SQL 查询"".""total_join_ap_cnt_last7"") AS ""TEMP(Calculation_1430244791249522705)(2573436739)(0)"",
  SUM(""自定义 SQL 查询"".""total_join_ap_cnt"") AS ""TEMP(Calculation_1430244791249522705)(2681092799)(0)"",
  SUM(""自定义 SQL 查询"".""5s_succ_join_ap_cnt_last7"") AS ""TEMP(Calculation_1430244791249522705)(2802323494)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_75ms_delay_sec"") AS ""TEMP(Calculation_6542393318886535170)(2003933318)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_75ms_delay_sec_last7"") AS ""TEMP(Calculation_6542393318886535170)(775655446)(0)"",
  SUM(""自定义 SQL 查询"".""totalJoin"") AS ""TEMP(Calculation_7034341207023464449)(2073556184)(0)"",
  SUM(""自定义 SQL 查询"".""3s_succ_join_session_cnt_last7"") AS ""TEMP(Calculation_7034341207023464449)(2344416377)(0)"",
  SUM(""自定义 SQL 查询"".""total_join_session_cnt_last7"") AS ""TEMP(Calculation_7034341207023464449)(3093209995)(0)"",
  SUM(""自定义 SQL 查询"".""threeSecJoinSuccess"") AS ""TEMP(Calculation_7034341207023464449)(3693645608)(0)"",
  SUM(""自定义 SQL 查询"".""5s_succ_join_session_cnt_last7"") AS ""TEMP(Calculation_7034341207023988739)(1073906376)(0)"",
  SUM(""自定义 SQL 查询"".""fiveSecJoinSuccess"") AS ""TEMP(Calculation_7034341207023988739)(383616769)(0)"",
  SUM(""自定义 SQL 查询"".""succ_join_session_cnt_last7"") AS ""TEMP(Calculation_7034341207025020933)(2300438540)(0)"",
  SUM(""自定义 SQL 查询"".""totalJoinSuccess"") AS ""TEMP(Calculation_7034341207025020933)(2807417001)(0)"",
  SUM(""自定义 SQL 查询"".""video_totaltime_last7"") AS ""TEMP(Calculation_7034341207025557511)(2411308906)(0)"",
  SUM(""自定义 SQL 查询"".""video_totaltime"") AS ""TEMP(Calculation_7034341207025557511)(2797449586)(0)"",
  SUM(""自定义 SQL 查询"".""video_freeze_time"") AS ""TEMP(Calculation_7034341207025557511)(2940759860)(0)"",
  SUM(""自定义 SQL 查询"".""video_freeze_time_last7"") AS ""TEMP(Calculation_7034341207025557511)(3152166089)(0)"",
  SUM(""自定义 SQL 查询"".""audio_totaltime"") AS ""TEMP(Calculation_7034341207025938441)(1652566750)(0)"",
  SUM(""自定义 SQL 查询"".""audio_freeze_time"") AS ""TEMP(Calculation_7034341207025938441)(2919389392)(0)"",
  SUM(""自定义 SQL 查询"".""audio_freeze_time_last7"") AS ""TEMP(Calculation_7034341207025938441)(3377500597)(0)"",
  SUM(""自定义 SQL 查询"".""audio_totaltime_last7"") AS ""TEMP(Calculation_7034341207025938441)(489775499)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_lost_Leq5_last7"") AS ""TEMP(Calculation_7034341207026606091)(2526464233)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_lost_Leq5"") AS ""TEMP(Calculation_7034341207026606091)(2745840127)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_lost_all_last7"") AS ""TEMP(Calculation_7034341207026606091)(453870284)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_lost_all"") AS ""TEMP(Calculation_7034341207026606091)(734589263)(0)"",
  SUM(""自定义 SQL 查询"".""crash_cnt_last7"") AS ""TEMP(Calculation_7034341207372492815)(2315319037)(0)"",
  SUM(""自定义 SQL 查询"".""crash_cnt"") AS ""TEMP(Calculation_7034341207372492815)(2360900687)(0)"",
  SUM(""自定义 SQL 查询"".""service_cnt_last7"") AS ""TEMP(Calculation_7034341207372492815)(3843063028)(0)"",
  SUM(""自定义 SQL 查询"".""service_cnt"") AS ""TEMP(Calculation_7034341207372492815)(4291252132)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_lost_all_last7"") AS ""TEMP(Calculation_75998310508670977)(1411695322)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_lost_Leq5"") AS ""TEMP(Calculation_75998310508670977)(1936123547)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_lost_all"") AS ""TEMP(Calculation_75998310508670977)(749826584)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_lost_Leq5_last7"") AS ""TEMP(Calculation_75998310508670977)(790094525)(0)""
FROM (SELECT date,
        CASE WHEN CAST(stat_period AS VARCHAR) = 'day' THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(substr(CAST(start_date AS VARCHAR), 1, 10) AS VARCHAR), '~', CAST(substr(CAST(end_date AS VARCHAR), 1, 10) AS VARCHAR)) END AS period,
      start_date,
      end_date,
      stat_period,
      tag,
      dim,
      level1,
      level2,
      level3,
      level4,
      '' AS pd,
      os,
      ver,
      ver_type,
      '' AS product_line,
      '' AS product_type,
      domain,
      country,
      region,
      net,
      vid,
      project,
      company_id,
      company_name,
      rowsnum,
      lastusage,
      thisusage,
      fiveSecJoinSuccess,
      totalJoin,
      cnt_sid,
      video_freeze_time,
      video_totaltime,
      audio_freeze_time,
      audio_totaltime,
      s2l_total_delay_sec,
      s2l_25ms_delay_sec,
      s2l_75ms_delay_sec,
      p2s_lost_Leq5,
      p2s_lost_all,
      crash_cnt,
      service_cnt,
      ""1s_succ_join_ap_cnt"",
      ""5s_succ_join_ap_cnt"",
      total_join_ap_cnt,
      totalJoinSuccess,
      threeSecJoinSuccess,
      video_freeze_time_200,
      video_totaltime_200,
      video_freeze_time_500,
      video_totaltime_500,
      ""3s_succ_join_session_cnt_last1"",
      ""5s_succ_join_session_cnt_last1"",
      succ_join_session_cnt_last1,
      total_join_session_cnt_last1,
      total_session_cnt_last1,
      ""1s_succ_join_ap_cnt_last1"",
      ""5s_succ_join_ap_cnt_last1"",
      total_join_ap_cnt_last1,
      ""3s_succ_join_session_cnt_last7"",
      ""5s_succ_join_session_cnt_last7"",
      succ_join_session_cnt_last7,
      total_join_session_cnt_last7,
      total_session_cnt_last7,
      ""1s_succ_join_ap_cnt_last7"",
      ""5s_succ_join_ap_cnt_last7"",
      total_join_ap_cnt_last7,
      video_freeze_time_last1,
      video_totaltime_last1,
      video_freeze_time_500_last1,
      video_totaltime_500_last1,
      video_freeze_time_200_last1,
      video_totaltime_200_last1,
      video_freeze_time_last7,
      video_totaltime_last7,
      video_freeze_time_500_last7,
      video_totaltime_500_last7,
      video_freeze_time_200_last7,
      video_totaltime_200_last7,
      audio_freeze_time_last1,
      audio_totaltime_last1,
      audio_freeze_time_last7,
      audio_totaltime_last7,
      s2l_total_delay_sec_last1,
      s2l_25ms_delay_sec_last1,
      s2l_75ms_delay_sec_last1,
      s2l_total_delay_sec_last7,
      s2l_25ms_delay_sec_last7,
      s2l_75ms_delay_sec_last7,
      p2s_lost_Leq5_last1,
      p2s_lost_all_last1,
      p2s_lost_Leq5_last7,
      p2s_lost_all_last7,
      crash_cnt_last1,
      service_cnt_last1,
      crash_cnt_last7,
      service_cnt_last7,
      product_level1,
      product_level2,
      product_level3,
      product_level4,
      s2l_lost_Leq5,
      s2l_lost_all,
      s2l_lost_Leq5_last1,
      s2l_lost_all_last1,
      s2l_lost_Leq5_last7,
      s2l_lost_all_last7
    FROM report_datahub.pub_levels_quality_di_1
    WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-21') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-05')) AS ""自定义 SQL 查询""
  CROSS JOIN (SELECT MAX(date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d')) AS ""__measure__0""
    FROM (SELECT date,
            CASE WHEN CAST(stat_period AS VARCHAR) = 'day' THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(substr(CAST(start_date AS VARCHAR), 1, 10) AS VARCHAR), '~', CAST(substr(CAST(end_date AS VARCHAR), 1, 10) AS VARCHAR)) END AS period,
          start_date,
          end_date,
          stat_period,
          tag,
          dim,
          level1,
          level2,
          level3,
          level4,
          '' AS pd,
          os,
          ver,
          ver_type,
          '' AS product_line,
          '' AS product_type,
          domain,
          country,
          region,
          net,
          vid,
          project,
          company_id,
          company_name,
          rowsnum,
          lastusage,
          thisusage,
          fiveSecJoinSuccess,
          totalJoin,
          cnt_sid,
          video_freeze_time,
          video_totaltime,
          audio_freeze_time,
          audio_totaltime,
          s2l_total_delay_sec,
          s2l_25ms_delay_sec,
          s2l_75ms_delay_sec,
          p2s_lost_Leq5,
          p2s_lost_all,
          crash_cnt,
          service_cnt,
          ""1s_succ_join_ap_cnt"",
          ""5s_succ_join_ap_cnt"",
          total_join_ap_cnt,
          totalJoinSuccess,
          threeSecJoinSuccess,
          video_freeze_time_200,
          video_totaltime_200,
          video_freeze_time_500,
          video_totaltime_500,
          ""3s_succ_join_session_cnt_last1"",
          ""5s_succ_join_session_cnt_last1"",
          succ_join_session_cnt_last1,
          total_join_session_cnt_last1,
          total_session_cnt_last1,
          ""1s_succ_join_ap_cnt_last1"",
          ""5s_succ_join_ap_cnt_last1"",
          total_join_ap_cnt_last1,
          ""3s_succ_join_session_cnt_last7"",
          ""5s_succ_join_session_cnt_last7"",
          succ_join_session_cnt_last7,
          total_join_session_cnt_last7,
          total_session_cnt_last7,
          ""1s_succ_join_ap_cnt_last7"",
          ""5s_succ_join_ap_cnt_last7"",
          total_join_ap_cnt_last7,
          video_freeze_time_last1,
          video_totaltime_last1,
          video_freeze_time_500_last1,
          video_totaltime_500_last1,
          video_freeze_time_200_last1,
          video_totaltime_200_last1,
          video_freeze_time_last7,
          video_totaltime_last7,
          video_freeze_time_500_last7,
          video_totaltime_500_last7,
          video_freeze_time_200_last7,
          video_totaltime_200_last7,
          audio_freeze_time_last1,
          audio_totaltime_last1,
          audio_freeze_time_last7,
          audio_totaltime_last7,
          s2l_total_delay_sec_last1,
          s2l_25ms_delay_sec_last1,
          s2l_75ms_delay_sec_last1,
          s2l_total_delay_sec_last7,
          s2l_25ms_delay_sec_last7,
          s2l_75ms_delay_sec_last7,
          p2s_lost_Leq5_last1,
          p2s_lost_all_last1,
          p2s_lost_Leq5_last7,
          p2s_lost_all_last7,
          crash_cnt_last1,
          service_cnt_last1,
          crash_cnt_last7,
          service_cnt_last7,
          product_level1,
          product_level2,
          product_level3,
          product_level4,
          s2l_lost_Leq5,
          s2l_lost_all,
          s2l_lost_Leq5_last1,
          s2l_lost_all_last1,
          s2l_lost_Leq5_last7,
          s2l_lost_all_last7
        FROM report_datahub.pub_levels_quality_di_1
        WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-21') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-05')) AS ""自定义 SQL 查询""
    HAVING COUNT(1) > 0) AS ""t0""
WHERE CASE WHEN CAST(""自定义 SQL 查询"".""tag"" AS VARCHAR) = 'Industry' AND CAST(""自定义 SQL 查询"".""product_level1"" AS VARCHAR) = 'RTC' AND CAST(""自定义 SQL 查询"".""dim"" AS VARCHAR) = 'osver' THEN 0 WHEN CAST(""自定义 SQL 查询"".""tag"" AS VARCHAR) = 'VerType' AND CAST(""自定义 SQL 查询"".""product_level1"" AS VARCHAR) = 'RTC' AND CAST(""自定义 SQL 查询"".""dim"" AS VARCHAR) = 'osver' THEN 0 WHEN CAST(""自定义 SQL 查询"".""tag"" AS VARCHAR) = 'Product' AND CAST(""自定义 SQL 查询"".""product_level1"" AS VARCHAR) = 'RTC' AND CAST(""自定义 SQL 查询"".""dim"" AS VARCHAR) = 'osver' THEN 1 ELSE 0 END AND DATE_ADD('SECOND', 0, date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d')) = DATE_ADD('SECOND', 0, ""t0"".""__measure__0"")
HAVING COUNT(1) > 0"
"SELECT SUM(""自定义 SQL 查询"".""s2l_25ms_delay_sec"") AS ""TEMP(Calculation_1430244791154503680)(2227145667)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_total_delay_sec"") AS ""TEMP(Calculation_1430244791154503680)(2460078802)(0)"",
  SUM(""自定义 SQL 查询"".""5s_succ_join_ap_cnt"") AS ""TEMP(Calculation_1430244791247978510)(1716451703)(0)"",
  SUM(""自定义 SQL 查询"".""total_join_ap_cnt"") AS ""TEMP(Calculation_1430244791247978510)(2681092799)(0)"",
  SUM(""自定义 SQL 查询"".""video_freeze_time_500"") AS ""TEMP(Calculation_1857594119395086336)(389023081)(0)"",
  SUM(""自定义 SQL 查询"".""video_totaltime_500"") AS ""TEMP(Calculation_1857594119395086336)(458654145)(0)"",
  SUM(""自定义 SQL 查询"".""video_totaltime_200"") AS ""TEMP(Calculation_2033093767653158912)(2104207895)(0)"",
  SUM(""自定义 SQL 查询"".""video_freeze_time_200"") AS ""TEMP(Calculation_2033093767653158912)(530162565)(0)"",
  SUM(""自定义 SQL 查询"".""totalJoin"") AS ""TEMP(Calculation_374009936508170240)(2073556184)(0)"",
  SUM(""自定义 SQL 查询"".""totalJoinSuccess"") AS ""TEMP(Calculation_374009936508170240)(2807417001)(0)"",
  SUM(""自定义 SQL 查询"".""threeSecJoinSuccess"") AS ""TEMP(Calculation_374009936508321793)(3693645608)(0)"",
  SUM(""自定义 SQL 查询"".""fiveSecJoinSuccess"") AS ""TEMP(Calculation_374009936508416002)(383616769)(0)"",
  SUM(""自定义 SQL 查询"".""video_totaltime"") AS ""TEMP(Calculation_374009936515215363)(2797449586)(0)"",
  SUM(""自定义 SQL 查询"".""video_freeze_time"") AS ""TEMP(Calculation_374009936515215363)(2940759860)(0)"",
  SUM(""自定义 SQL 查询"".""audio_totaltime"") AS ""TEMP(Calculation_374009936517861380)(1652566750)(0)"",
  SUM(""自定义 SQL 查询"".""audio_freeze_time"") AS ""TEMP(Calculation_374009936517861380)(2919389392)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_lost_Leq5"") AS ""TEMP(Calculation_374009936519704581)(1936123547)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_lost_all"") AS ""TEMP(Calculation_374009936519704581)(749826584)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_75ms_delay_sec"") AS ""TEMP(Calculation_6542393318886285312)(2003933318)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_lost_Leq5"") AS ""TEMP(Calculation_7012034266496475136)(2745840127)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_lost_all"") AS ""TEMP(Calculation_7012034266496475136)(734589263)(0)"",
  SUM(""自定义 SQL 查询"".""crash_cnt"") AS ""TEMP(Calculation_7034341207372070925)(2360900687)(0)"",
  SUM(""自定义 SQL 查询"".""service_cnt"") AS ""TEMP(Calculation_7034341207372070925)(4291252132)(0)"",
  SUM(""自定义 SQL 查询"".""thisusage"") AS ""TEMP(TC_)(949910004)(0)"",
  ""自定义 SQL 查询"".""company_id"" AS ""company_id"",
  ""自定义 SQL 查询"".""company_name"" AS ""company_name"",
  ""自定义 SQL 查询"".""project"" AS ""project"",
  SUM(""自定义 SQL 查询"".""cnt_sid"") AS ""sum_cnt_sid_ok"",
  SUM(""自定义 SQL 查询"".""thisusage"") AS ""sum_thisusage_ok"",
  MAX(""自定义 SQL 查询"".""period"") AS ""usr_Calculation_6733444459377328128_nk"",
  ""自定义 SQL 查询"".""vid"" AS ""vid""
FROM (SELECT t1.date,
        CASE WHEN CAST(stat_period AS VARCHAR) = 'day' THEN substr(CAST(date_parse(cast( t1.date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(substr(CAST(start_date AS VARCHAR), 1, 10) AS VARCHAR), '~', CAST(substr(CAST(end_date AS VARCHAR), 1, 10) AS VARCHAR)) END AS period,
      start_date,
      end_date,
      stat_period,
      tag,
      t1.dim,
      level1,
      level2,
      level3,
      level4,
      os,
      ver,
      ver_type,
      domain,
      country,
      region,
      net,
      vid,
      project,
      company_id,
      company_name,
      rowsnum,
      lastusage,
      thisusage,
      fiveSecJoinSuccess,
      totalJoin,
      cnt_sid,
      video_freeze_time,
      video_totaltime,
      audio_freeze_time,
      audio_totaltime,
      s2l_total_delay_sec,
      s2l_25ms_delay_sec,
      s2l_75ms_delay_sec,
      p2s_lost_Leq5,
      p2s_lost_all,
      crash_cnt,
      service_cnt,
      ""1s_succ_join_ap_cnt"",
      ""5s_succ_join_ap_cnt"",
      total_join_ap_cnt,
      totalJoinSuccess,
      threeSecJoinSuccess,
      video_freeze_time_200,
      video_totaltime_200,
      video_freeze_time_500,
      video_totaltime_500,
      ""3s_succ_join_session_cnt_last1"",
      ""5s_succ_join_session_cnt_last1"",
      succ_join_session_cnt_last1,
      total_join_session_cnt_last1,
      total_session_cnt_last1,
      ""1s_succ_join_ap_cnt_last1"",
      ""5s_succ_join_ap_cnt_last1"",
      total_join_ap_cnt_last1,
      ""3s_succ_join_session_cnt_last7"",
      ""5s_succ_join_session_cnt_last7"",
      succ_join_session_cnt_last7,
      total_join_session_cnt_last7,
      total_session_cnt_last7,
      ""1s_succ_join_ap_cnt_last7"",
      ""5s_succ_join_ap_cnt_last7"",
      total_join_ap_cnt_last7,
      video_freeze_time_last1,
      video_totaltime_last1,
      video_freeze_time_500_last1,
      video_totaltime_500_last1,
      video_freeze_time_200_last1,
      video_totaltime_200_last1,
      video_freeze_time_last7,
      video_totaltime_last7,
      video_freeze_time_500_last7,
      video_totaltime_500_last7,
      video_freeze_time_200_last7,
      video_totaltime_200_last7,
      audio_freeze_time_last1,
      audio_totaltime_last1,
      audio_freeze_time_last7,
      audio_totaltime_last7,
      s2l_total_delay_sec_last1,
      s2l_25ms_delay_sec_last1,
      s2l_75ms_delay_sec_last1,
      s2l_total_delay_sec_last7,
      s2l_25ms_delay_sec_last7,
      s2l_75ms_delay_sec_last7,
      p2s_lost_Leq5_last1,
      p2s_lost_all_last1,
      p2s_lost_Leq5_last7,
      p2s_lost_all_last7,
      crash_cnt_last1,
      service_cnt_last1,
      crash_cnt_last7,
      service_cnt_last7,
      product_level1,
      product_level2,
      product_level3,
      product_level4,
      s2l_lost_Leq5,
      s2l_lost_all,
      s2l_lost_Leq5_last1,
      s2l_lost_all_last1,
      s2l_lost_Leq5_last7,
      s2l_lost_all_last7,
      fiveSecJoinSuccess_total,
      totalJoin_total,
      cnt_sid_total,
      video_freeze_time_total,
      video_totaltime_total,
      audio_freeze_time_total,
      audio_totaltime_total,
      s2l_total_delay_sec_total,
      s2l_25ms_delay_sec_total,
      s2l_75ms_delay_sec_total,
      p2s_lost_Leq5_total,
      p2s_lost_all_total,
      crash_cnt_total,
      service_cnt_total,
      ""1s_succ_join_ap_cnt_total"",
      ""5s_succ_join_ap_cnt_total"",
      total_join_ap_cnt_total,
      totalJoinSuccess_total,
      threeSecJoinSuccess_total,
      video_freeze_time_200_total,
      video_totaltime_200_total,
      video_freeze_time_500_total,
      video_totaltime_500_total,
      ""3s_succ_join_session_cnt_last1_total"",
      ""5s_succ_join_session_cnt_last1_total"",
      succ_join_session_cnt_last1_total,
      total_join_session_cnt_last1_total,
      total_session_cnt_last1_total,
      ""1s_succ_join_ap_cnt_last1_total"",
      ""5s_succ_join_ap_cnt_last1_total"",
      total_join_ap_cnt_last1_total,
      ""3s_succ_join_session_cnt_last7_total"",
      ""5s_succ_join_session_cnt_last7_total"",
      succ_join_session_cnt_last7_total,
      total_join_session_cnt_last7_total,
      total_session_cnt_last7_total,
      ""1s_succ_join_ap_cnt_last7_total"",
      ""5s_succ_join_ap_cnt_last7_total"",
      total_join_ap_cnt_last7_total,
      video_freeze_time_last1_total,
      video_totaltime_last1_total,
      video_freeze_time_500_last1_total,
      video_totaltime_500_last1_total,
      video_freeze_time_200_last1_total,
      video_totaltime_200_last1_total,
      video_freeze_time_last7_total,
      video_totaltime_last7_total,
      video_freeze_time_500_last7_total,
      video_totaltime_500_last7_total,
      video_freeze_time_200_last7_total,
      video_totaltime_200_last7_total,
      audio_freeze_time_last1_total,
      audio_totaltime_last1_total,
      audio_freeze_time_last7_total,
      audio_totaltime_last7_total,
      s2l_total_delay_sec_last1_total,
      s2l_25ms_delay_sec_last1_total,
      s2l_75ms_delay_sec_last1_total,
      s2l_total_delay_sec_last7_total,
      s2l_25ms_delay_sec_last7_total,
      s2l_75ms_delay_sec_last7_total,
      p2s_lost_Leq5_last1_total,
      p2s_lost_all_last1_total,
      p2s_lost_Leq5_last7_total,
      p2s_lost_all_last7_total,
      crash_cnt_last1_total,
      service_cnt_last1_total,
      crash_cnt_last7_total,
      service_cnt_last7_total,
      s2l_lost_Leq5_total,
      s2l_lost_all_total,
      s2l_lost_Leq5_last1_total,
      s2l_lost_all_last1_total,
      s2l_lost_Leq5_last7_total,
      s2l_lost_all_last7_total
    FROM report_datahub.pub_levels_quality_di_1 AS t1
      LEFT JOIN (SELECT date,
          dim,
          SUM(fiveSecJoinSuccess) AS fiveSecJoinSuccess_total,
          SUM(totalJoin) AS totalJoin_total,
          SUM(cnt_sid) AS cnt_sid_total,
          SUM(video_freeze_time) AS video_freeze_time_total,
          SUM(video_totaltime) AS video_totaltime_total,
          SUM(audio_freeze_time) AS audio_freeze_time_total,
          SUM(audio_totaltime) AS audio_totaltime_total,
          SUM(s2l_total_delay_sec) AS s2l_total_delay_sec_total,
          SUM(s2l_25ms_delay_sec) AS s2l_25ms_delay_sec_total,
          SUM(s2l_75ms_delay_sec) AS s2l_75ms_delay_sec_total,
          SUM(p2s_lost_Leq5) AS p2s_lost_Leq5_total,
          SUM(p2s_lost_all) AS p2s_lost_all_total,
          SUM(crash_cnt) AS crash_cnt_total,
          SUM(service_cnt) AS service_cnt_total,
          SUM(""1s_succ_join_ap_cnt"") AS ""1s_succ_join_ap_cnt_total"",
          SUM(""5s_succ_join_ap_cnt"") AS ""5s_succ_join_ap_cnt_total"",
          SUM(total_join_ap_cnt) AS total_join_ap_cnt_total,
          SUM(totalJoinSuccess) AS totalJoinSuccess_total,
          SUM(threeSecJoinSuccess) AS threeSecJoinSuccess_total,
          SUM(video_freeze_time_200) AS video_freeze_time_200_total,
          SUM(video_totaltime_200) AS video_totaltime_200_total,
          SUM(video_freeze_time_500) AS video_freeze_time_500_total,
          SUM(video_totaltime_500) AS video_totaltime_500_total,
          SUM(""3s_succ_join_session_cnt_last1"") AS ""3s_succ_join_session_cnt_last1_total"",
          SUM(""5s_succ_join_session_cnt_last1"") AS ""5s_succ_join_session_cnt_last1_total"",
          SUM(succ_join_session_cnt_last1) AS succ_join_session_cnt_last1_total,
          SUM(total_join_session_cnt_last1) AS total_join_session_cnt_last1_total,
          SUM(total_session_cnt_last1) AS total_session_cnt_last1_total,
          SUM(""1s_succ_join_ap_cnt_last1"") AS ""1s_succ_join_ap_cnt_last1_total"",
          SUM(""5s_succ_join_ap_cnt_last1"") AS ""5s_succ_join_ap_cnt_last1_total"",
          SUM(total_join_ap_cnt_last1) AS total_join_ap_cnt_last1_total,
          SUM(""3s_succ_join_session_cnt_last7"") AS ""3s_succ_join_session_cnt_last7_total"",
          SUM(""5s_succ_join_session_cnt_last7"") AS ""5s_succ_join_session_cnt_last7_total"",
          SUM(succ_join_session_cnt_last7) AS succ_join_session_cnt_last7_total,
          SUM(total_join_session_cnt_last7) AS total_join_session_cnt_last7_total,
          SUM(total_session_cnt_last7) AS total_session_cnt_last7_total,
          SUM(""1s_succ_join_ap_cnt_last7"") AS ""1s_succ_join_ap_cnt_last7_total"",
          SUM(""5s_succ_join_ap_cnt_last7"") AS ""5s_succ_join_ap_cnt_last7_total"",
          SUM(total_join_ap_cnt_last7) AS total_join_ap_cnt_last7_total,
          SUM(video_freeze_time_last1) AS video_freeze_time_last1_total,
          SUM(video_totaltime_last1) AS video_totaltime_last1_total,
          SUM(video_freeze_time_500_last1) AS video_freeze_time_500_last1_total,
          SUM(video_totaltime_500_last1) AS video_totaltime_500_last1_total,
          SUM(video_freeze_time_200_last1) AS video_freeze_time_200_last1_total,
          SUM(video_totaltime_200_last1) AS video_totaltime_200_last1_total,
          SUM(video_freeze_time_last7) AS video_freeze_time_last7_total,
          SUM(video_totaltime_last7) AS video_totaltime_last7_total,
          SUM(video_freeze_time_500_last7) AS video_freeze_time_500_last7_total,
          SUM(video_totaltime_500_last7) AS video_totaltime_500_last7_total,
          SUM(video_freeze_time_200_last7) AS video_freeze_time_200_last7_total,
          SUM(video_totaltime_200_last7) AS video_totaltime_200_last7_total,
          SUM(audio_freeze_time_last1) AS audio_freeze_time_last1_total,
          SUM(audio_totaltime_last1) AS audio_totaltime_last1_total,
          SUM(audio_freeze_time_last7) AS audio_freeze_time_last7_total,
          SUM(audio_totaltime_last7) AS audio_totaltime_last7_total,
          SUM(s2l_total_delay_sec_last1) AS s2l_total_delay_sec_last1_total,
          SUM(s2l_25ms_delay_sec_last1) AS s2l_25ms_delay_sec_last1_total,
          SUM(s2l_75ms_delay_sec_last1) AS s2l_75ms_delay_sec_last1_total,
          SUM(s2l_total_delay_sec_last7) AS s2l_total_delay_sec_last7_total,
          SUM(s2l_25ms_delay_sec_last7) AS s2l_25ms_delay_sec_last7_total,
          SUM(s2l_75ms_delay_sec_last7) AS s2l_75ms_delay_sec_last7_total,
          SUM(p2s_lost_Leq5_last1) AS p2s_lost_Leq5_last1_total,
          SUM(p2s_lost_all_last1) AS p2s_lost_all_last1_total,
          SUM(p2s_lost_Leq5_last7) AS p2s_lost_Leq5_last7_total,
          SUM(p2s_lost_all_last7) AS p2s_lost_all_last7_total,
          SUM(crash_cnt_last1) AS crash_cnt_last1_total,
          SUM(service_cnt_last1) AS service_cnt_last1_total,
          SUM(crash_cnt_last7) AS crash_cnt_last7_total,
          SUM(service_cnt_last7) AS service_cnt_last7_total,
          SUM(s2l_lost_Leq5) AS s2l_lost_Leq5_total,
          SUM(s2l_lost_all) AS s2l_lost_all_total,
          SUM(s2l_lost_Leq5_last1) AS s2l_lost_Leq5_last1_total,
          SUM(s2l_lost_all_last1) AS s2l_lost_all_last1_total,
          SUM(s2l_lost_Leq5_last7) AS s2l_lost_Leq5_last7_total,
          SUM(s2l_lost_all_last7) AS s2l_lost_all_last7_total
        FROM report_datahub.pub_levels_quality_di_1
        WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-21') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-11-21') AND CAST(tag AS VARCHAR) = 'Product'
        GROUP BY date,
          dim) AS t2 ON t1.date = t2.date AND t1.dim = t2.dim
    WHERE date_parse(cast( t1.date as VARCHAR), '%Y%m%d') >= DATE('2021-11-21') AND date_parse(cast( t1.date as VARCHAR), '%Y%m%d') <= DATE('2021-11-21') AND CAST(tag AS VARCHAR) = 'Product') AS ""自定义 SQL 查询""
  CROSS JOIN (SELECT MAX(date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d')) AS ""__measure__0""
    FROM (SELECT t1.date,
            CASE WHEN CAST(stat_period AS VARCHAR) = 'day' THEN substr(CAST(date_parse(cast( t1.date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(substr(CAST(start_date AS VARCHAR), 1, 10) AS VARCHAR), '~', CAST(substr(CAST(end_date AS VARCHAR), 1, 10) AS VARCHAR)) END AS period,
          start_date,
          end_date,
          stat_period,
          tag,
          t1.dim,
          level1,
          level2,
          level3,
          level4,
          os,
          ver,
          ver_type,
          domain,
          country,
          region,
          net,
          vid,
          project,
          company_id,
          company_name,
          rowsnum,
          lastusage,
          thisusage,
          fiveSecJoinSuccess,
          totalJoin,
          cnt_sid,
          video_freeze_time,
          video_totaltime,
          audio_freeze_time,
          audio_totaltime,
          s2l_total_delay_sec,
          s2l_25ms_delay_sec,
          s2l_75ms_delay_sec,
          p2s_lost_Leq5,
          p2s_lost_all,
          crash_cnt,
          service_cnt,
          ""1s_succ_join_ap_cnt"",
          ""5s_succ_join_ap_cnt"",
          total_join_ap_cnt,
          totalJoinSuccess,
          threeSecJoinSuccess,
          video_freeze_time_200,
          video_totaltime_200,
          video_freeze_time_500,
          video_totaltime_500,
          ""3s_succ_join_session_cnt_last1"",
          ""5s_succ_join_session_cnt_last1"",
          succ_join_session_cnt_last1,
          total_join_session_cnt_last1,
          total_session_cnt_last1,
          ""1s_succ_join_ap_cnt_last1"",
          ""5s_succ_join_ap_cnt_last1"",
          total_join_ap_cnt_last1,
          ""3s_succ_join_session_cnt_last7"",
          ""5s_succ_join_session_cnt_last7"",
          succ_join_session_cnt_last7,
          total_join_session_cnt_last7,
          total_session_cnt_last7,
          ""1s_succ_join_ap_cnt_last7"",
          ""5s_succ_join_ap_cnt_last7"",
          total_join_ap_cnt_last7,
          video_freeze_time_last1,
          video_totaltime_last1,
          video_freeze_time_500_last1,
          video_totaltime_500_last1,
          video_freeze_time_200_last1,
          video_totaltime_200_last1,
          video_freeze_time_last7,
          video_totaltime_last7,
          video_freeze_time_500_last7,
          video_totaltime_500_last7,
          video_freeze_time_200_last7,
          video_totaltime_200_last7,
          audio_freeze_time_last1,
          audio_totaltime_last1,
          audio_freeze_time_last7,
          audio_totaltime_last7,
          s2l_total_delay_sec_last1,
          s2l_25ms_delay_sec_last1,
          s2l_75ms_delay_sec_last1,
          s2l_total_delay_sec_last7,
          s2l_25ms_delay_sec_last7,
          s2l_75ms_delay_sec_last7,
          p2s_lost_Leq5_last1,
          p2s_lost_all_last1,
          p2s_lost_Leq5_last7,
          p2s_lost_all_last7,
          crash_cnt_last1,
          service_cnt_last1,
          crash_cnt_last7,
          service_cnt_last7,
          product_level1,
          product_level2,
          product_level3,
          product_level4,
          s2l_lost_Leq5,
          s2l_lost_all,
          s2l_lost_Leq5_last1,
          s2l_lost_all_last1,
          s2l_lost_Leq5_last7,
          s2l_lost_all_last7,
          fiveSecJoinSuccess_total,
          totalJoin_total,
          cnt_sid_total,
          video_freeze_time_total,
          video_totaltime_total,
          audio_freeze_time_total,
          audio_totaltime_total,
          s2l_total_delay_sec_total,
          s2l_25ms_delay_sec_total,
          s2l_75ms_delay_sec_total,
          p2s_lost_Leq5_total,
          p2s_lost_all_total,
          crash_cnt_total,
          service_cnt_total,
          ""1s_succ_join_ap_cnt_total"",
          ""5s_succ_join_ap_cnt_total"",
          total_join_ap_cnt_total,
          totalJoinSuccess_total,
          threeSecJoinSuccess_total,
          video_freeze_time_200_total,
          video_totaltime_200_total,
          video_freeze_time_500_total,
          video_totaltime_500_total,
          ""3s_succ_join_session_cnt_last1_total"",
          ""5s_succ_join_session_cnt_last1_total"",
          succ_join_session_cnt_last1_total,
          total_join_session_cnt_last1_total,
          total_session_cnt_last1_total,
          ""1s_succ_join_ap_cnt_last1_total"",
          ""5s_succ_join_ap_cnt_last1_total"",
          total_join_ap_cnt_last1_total,
          ""3s_succ_join_session_cnt_last7_total"",
          ""5s_succ_join_session_cnt_last7_total"",
          succ_join_session_cnt_last7_total,
          total_join_session_cnt_last7_total,
          total_session_cnt_last7_total,
          ""1s_succ_join_ap_cnt_last7_total"",
          ""5s_succ_join_ap_cnt_last7_total"",
          total_join_ap_cnt_last7_total,
          video_freeze_time_last1_total,
          video_totaltime_last1_total,
          video_freeze_time_500_last1_total,
          video_totaltime_500_last1_total,
          video_freeze_time_200_last1_total,
          video_totaltime_200_last1_total,
          video_freeze_time_last7_total,
          video_totaltime_last7_total,
          video_freeze_time_500_last7_total,
          video_totaltime_500_last7_total,
          video_freeze_time_200_last7_total,
          video_totaltime_200_last7_total,
          audio_freeze_time_last1_total,
          audio_totaltime_last1_total,
          audio_freeze_time_last7_total,
          audio_totaltime_last7_total,
          s2l_total_delay_sec_last1_total,
          s2l_25ms_delay_sec_last1_total,
          s2l_75ms_delay_sec_last1_total,
          s2l_total_delay_sec_last7_total,
          s2l_25ms_delay_sec_last7_total,
          s2l_75ms_delay_sec_last7_total,
          p2s_lost_Leq5_last1_total,
          p2s_lost_all_last1_total,
          p2s_lost_Leq5_last7_total,
          p2s_lost_all_last7_total,
          crash_cnt_last1_total,
          service_cnt_last1_total,
          crash_cnt_last7_total,
          service_cnt_last7_total,
          s2l_lost_Leq5_total,
          s2l_lost_all_total,
          s2l_lost_Leq5_last1_total,
          s2l_lost_all_last1_total,
          s2l_lost_Leq5_last7_total,
          s2l_lost_all_last7_total
        FROM report_datahub.pub_levels_quality_di_1 AS t1
          LEFT JOIN (SELECT date,
              dim,
              SUM(fiveSecJoinSuccess) AS fiveSecJoinSuccess_total,
              SUM(totalJoin) AS totalJoin_total,
              SUM(cnt_sid) AS cnt_sid_total,
              SUM(video_freeze_time) AS video_freeze_time_total,
              SUM(video_totaltime) AS video_totaltime_total,
              SUM(audio_freeze_time) AS audio_freeze_time_total,
              SUM(audio_totaltime) AS audio_totaltime_total,
              SUM(s2l_total_delay_sec) AS s2l_total_delay_sec_total,
              SUM(s2l_25ms_delay_sec) AS s2l_25ms_delay_sec_total,
              SUM(s2l_75ms_delay_sec) AS s2l_75ms_delay_sec_total,
              SUM(p2s_lost_Leq5) AS p2s_lost_Leq5_total,
              SUM(p2s_lost_all) AS p2s_lost_all_total,
              SUM(crash_cnt) AS crash_cnt_total,
              SUM(service_cnt) AS service_cnt_total,
              SUM(""1s_succ_join_ap_cnt"") AS ""1s_succ_join_ap_cnt_total"",
              SUM(""5s_succ_join_ap_cnt"") AS ""5s_succ_join_ap_cnt_total"",
              SUM(total_join_ap_cnt) AS total_join_ap_cnt_total,
              SUM(totalJoinSuccess) AS totalJoinSuccess_total,
              SUM(threeSecJoinSuccess) AS threeSecJoinSuccess_total,
              SUM(video_freeze_time_200) AS video_freeze_time_200_total,
              SUM(video_totaltime_200) AS video_totaltime_200_total,
              SUM(video_freeze_time_500) AS video_freeze_time_500_total,
              SUM(video_totaltime_500) AS video_totaltime_500_total,
              SUM(""3s_succ_join_session_cnt_last1"") AS ""3s_succ_join_session_cnt_last1_total"",
              SUM(""5s_succ_join_session_cnt_last1"") AS ""5s_succ_join_session_cnt_last1_total"",
              SUM(succ_join_session_cnt_last1) AS succ_join_session_cnt_last1_total,
              SUM(total_join_session_cnt_last1) AS total_join_session_cnt_last1_total,
              SUM(total_session_cnt_last1) AS total_session_cnt_last1_total,
              SUM(""1s_succ_join_ap_cnt_last1"") AS ""1s_succ_join_ap_cnt_last1_total"",
              SUM(""5s_succ_join_ap_cnt_last1"") AS ""5s_succ_join_ap_cnt_last1_total"",
              SUM(total_join_ap_cnt_last1) AS total_join_ap_cnt_last1_total,
              SUM(""3s_succ_join_session_cnt_last7"") AS ""3s_succ_join_session_cnt_last7_total"",
              SUM(""5s_succ_join_session_cnt_last7"") AS ""5s_succ_join_session_cnt_last7_total"",
              SUM(succ_join_session_cnt_last7) AS succ_join_session_cnt_last7_total,
              SUM(total_join_session_cnt_last7) AS total_join_session_cnt_last7_total,
              SUM(total_session_cnt_last7) AS total_session_cnt_last7_total,
              SUM(""1s_succ_join_ap_cnt_last7"") AS ""1s_succ_join_ap_cnt_last7_total"",
              SUM(""5s_succ_join_ap_cnt_last7"") AS ""5s_succ_join_ap_cnt_last7_total"",
              SUM(total_join_ap_cnt_last7) AS total_join_ap_cnt_last7_total,
              SUM(video_freeze_time_last1) AS video_freeze_time_last1_total,
              SUM(video_totaltime_last1) AS video_totaltime_last1_total,
              SUM(video_freeze_time_500_last1) AS video_freeze_time_500_last1_total,
              SUM(video_totaltime_500_last1) AS video_totaltime_500_last1_total,
              SUM(video_freeze_time_200_last1) AS video_freeze_time_200_last1_total,
              SUM(video_totaltime_200_last1) AS video_totaltime_200_last1_total,
              SUM(video_freeze_time_last7) AS video_freeze_time_last7_total,
              SUM(video_totaltime_last7) AS video_totaltime_last7_total,
              SUM(video_freeze_time_500_last7) AS video_freeze_time_500_last7_total,
              SUM(video_totaltime_500_last7) AS video_totaltime_500_last7_total,
              SUM(video_freeze_time_200_last7) AS video_freeze_time_200_last7_total,
              SUM(video_totaltime_200_last7) AS video_totaltime_200_last7_total,
              SUM(audio_freeze_time_last1) AS audio_freeze_time_last1_total,
              SUM(audio_totaltime_last1) AS audio_totaltime_last1_total,
              SUM(audio_freeze_time_last7) AS audio_freeze_time_last7_total,
              SUM(audio_totaltime_last7) AS audio_totaltime_last7_total,
              SUM(s2l_total_delay_sec_last1) AS s2l_total_delay_sec_last1_total,
              SUM(s2l_25ms_delay_sec_last1) AS s2l_25ms_delay_sec_last1_total,
              SUM(s2l_75ms_delay_sec_last1) AS s2l_75ms_delay_sec_last1_total,
              SUM(s2l_total_delay_sec_last7) AS s2l_total_delay_sec_last7_total,
              SUM(s2l_25ms_delay_sec_last7) AS s2l_25ms_delay_sec_last7_total,
              SUM(s2l_75ms_delay_sec_last7) AS s2l_75ms_delay_sec_last7_total,
              SUM(p2s_lost_Leq5_last1) AS p2s_lost_Leq5_last1_total,
              SUM(p2s_lost_all_last1) AS p2s_lost_all_last1_total,
              SUM(p2s_lost_Leq5_last7) AS p2s_lost_Leq5_last7_total,
              SUM(p2s_lost_all_last7) AS p2s_lost_all_last7_total,
              SUM(crash_cnt_last1) AS crash_cnt_last1_total,
              SUM(service_cnt_last1) AS service_cnt_last1_total,
              SUM(crash_cnt_last7) AS crash_cnt_last7_total,
              SUM(service_cnt_last7) AS service_cnt_last7_total,
              SUM(s2l_lost_Leq5) AS s2l_lost_Leq5_total,
              SUM(s2l_lost_all) AS s2l_lost_all_total,
              SUM(s2l_lost_Leq5_last1) AS s2l_lost_Leq5_last1_total,
              SUM(s2l_lost_all_last1) AS s2l_lost_all_last1_total,
              SUM(s2l_lost_Leq5_last7) AS s2l_lost_Leq5_last7_total,
              SUM(s2l_lost_all_last7) AS s2l_lost_all_last7_total
            FROM report_datahub.pub_levels_quality_di_1
            WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-21') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-11-21') AND CAST(tag AS VARCHAR) = 'Product'
            GROUP BY date,
              dim) AS t2 ON t1.date = t2.date AND t1.dim = t2.dim
        WHERE date_parse(cast( t1.date as VARCHAR), '%Y%m%d') >= DATE('2021-11-21') AND date_parse(cast( t1.date as VARCHAR), '%Y%m%d') <= DATE('2021-11-21') AND CAST(tag AS VARCHAR) = 'Product') AS ""自定义 SQL 查询""
    HAVING COUNT(1) > 0) AS ""t0""
WHERE NOT ( (  ""自定义 SQL 查询"".""vid""  ) is null) AND CAST(""自定义 SQL 查询"".""dim"" AS VARCHAR) = '103' AND CAST(""自定义 SQL 查询"".""level1"" AS VARCHAR) = 'RTC' AND CAST(""自定义 SQL 查询"".""level2"" AS VARCHAR) = 'Native' AND CAST(""自定义 SQL 查询"".""level3"" AS VARCHAR) = 'ALL' AND CAST(""自定义 SQL 查询"".""tag"" AS VARCHAR) = 'Product' AND DATE_ADD('SECOND', 0, date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d')) = DATE_ADD('SECOND', 0, ""t0"".""__measure__0"")
GROUP BY 25,
  26,
  27,
  31"
"SELECT SUM(""自定义 SQL 查询"".""host_4k"") AS ""TEMP(Calculation_3519281700079370244)(1075454865)(0)"",
  SUM(""自定义 SQL 查询"".""audience_sd"") AS ""TEMP(Calculation_3519281700079370244)(1133678835)(0)"",
  SUM(""自定义 SQL 查询"".""host_1080p"") AS ""TEMP(Calculation_3519281700079370244)(1312501967)(0)"",
  SUM(""自定义 SQL 查询"".""host_hd"") AS ""TEMP(Calculation_3519281700079370244)(276907208)(0)"",
  SUM(""自定义 SQL 查询"".""video"") AS ""TEMP(Calculation_3519281700079370244)(2929708110)(0)"",
  SUM(""自定义 SQL 查询"".""audience_hd"") AS ""TEMP(Calculation_3519281700079370244)(2930728935)(0)"",
  SUM(""自定义 SQL 查询"".""audience_hdp"") AS ""TEMP(Calculation_3519281700079370244)(3010533957)(0)"",
  SUM(""自定义 SQL 查询"".""host_hdp"") AS ""TEMP(Calculation_3519281700079370244)(30306054)(0)"",
  SUM(""自定义 SQL 查询"".""host_audio"") AS ""TEMP(Calculation_3519281700079370244)(3087054365)(0)"",
  SUM(""自定义 SQL 查询"".""audio"") AS ""TEMP(Calculation_3519281700079370244)(3299350010)(0)"",
  SUM(""自定义 SQL 查询"".""audience_1080p"") AS ""TEMP(Calculation_3519281700079370244)(3628946582)(0)"",
  SUM(""自定义 SQL 查询"".""totalUsage"") AS ""TEMP(Calculation_3519281700079370244)(3847882359)(0)"",
  SUM(""自定义 SQL 查询"".""audience_audio"") AS ""TEMP(Calculation_3519281700079370244)(4109514392)(0)"",
  SUM(""自定义 SQL 查询"".""host_2k"") AS ""TEMP(Calculation_3519281700079370244)(586790827)(0)"",
  SUM(""自定义 SQL 查询"".""host_sd"") AS ""TEMP(Calculation_3519281700079370244)(709512178)(0)"",
  SUM(""自定义 SQL 查询"".""audience_4k"") AS ""TEMP(Calculation_3519281700079370244)(764410224)(0)"",
  SUM(""自定义 SQL 查询"".""audience_2k"") AS ""TEMP(Calculation_3519281700079370244)(943764407)(0)"",
  SUM(""自定义 SQL 查询"".""host_4k_last"") AS ""TEMP(Calculation_3519281700083154949)(101123376)(0)"",
  SUM(""自定义 SQL 查询"".""audience_video_hdp_last"") AS ""TEMP(Calculation_3519281700083154949)(1200517625)(0)"",
  SUM(""自定义 SQL 查询"".""audience_1080p_last"") AS ""TEMP(Calculation_3519281700083154949)(1314346200)(0)"",
  SUM(""自定义 SQL 查询"".""audience_video_hd_last"") AS ""TEMP(Calculation_3519281700083154949)(146570423)(0)"",
  SUM(""自定义 SQL 查询"".""audience_2k_last"") AS ""TEMP(Calculation_3519281700083154949)(1717771635)(0)"",
  SUM(""自定义 SQL 查询"".""audience_audio_last"") AS ""TEMP(Calculation_3519281700083154949)(2313111073)(0)"",
  SUM(""自定义 SQL 查询"".""host_video_hdp_last"") AS ""TEMP(Calculation_3519281700083154949)(258310559)(0)"",
  SUM(""自定义 SQL 查询"".""audio_video_last"") AS ""TEMP(Calculation_3519281700083154949)(2820618408)(0)"",
  SUM(""自定义 SQL 查询"".""audience_4k_last"") AS ""TEMP(Calculation_3519281700083154949)(3121859593)(0)"",
  SUM(""自定义 SQL 查询"".""host_1080p_last"") AS ""TEMP(Calculation_3519281700083154949)(3222422303)(0)"",
  SUM(""自定义 SQL 查询"".""host_audio_last"") AS ""TEMP(Calculation_3519281700083154949)(3227677803)(0)"",
  SUM(""自定义 SQL 查询"".""video_last"") AS ""TEMP(Calculation_3519281700083154949)(3934387163)(0)"",
  SUM(""自定义 SQL 查询"".""host_2k_last"") AS ""TEMP(Calculation_3519281700083154949)(4055292783)(0)"",
  SUM(""自定义 SQL 查询"".""audio_last"") AS ""TEMP(Calculation_3519281700083154949)(4091190060)(0)"",
  SUM(""自定义 SQL 查询"".""host_video_hd_last"") AS ""TEMP(Calculation_3519281700083154949)(4170367250)(0)"",
  SUM(""自定义 SQL 查询"".""host_video_sd_last"") AS ""TEMP(Calculation_3519281700083154949)(4190307025)(0)"",
  SUM(""自定义 SQL 查询"".""audience_video_sd_last"") AS ""TEMP(Calculation_3519281700083154949)(933007102)(0)"",
  MAX(""自定义 SQL 查询"".""stat_date"") AS ""TEMP(attr_stat_date_nk)(2102638629)(0)"",
  MIN(""自定义 SQL 查询"".""stat_date"") AS ""TEMP(attr_stat_date_nk)(2790680713)(0)"",
  ""自定义 SQL 查询"".""level1"" AS ""level1"",
  SUM(""自定义 SQL 查询"".""totalUsage"") AS ""sum_totalUsage_ok"",
  DATE_ADD('SECOND', 0, date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d')) AS ""tdy_date_ok""
FROM (SELECT date,
        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,
      start_date AS start_date_7,
      end_date AS end_date,
      tag,
      area AS Scope,
      dim,
        CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,
      level2,
      level3,
      level4,
      product_level1 AS product_line,
      product_level2,
      product_level3,
      product_level4,
      vid_internal_industry_en AS cid_industry,
      vid_use_case_en AS vid_use_case_cn,
      vid_sector_en,
      ver_type,
      ver,
      os,
      domain,
      country,
      region,
      dim_grouping_name,
        CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,
      total AS totalUsage,
      audio,
      video,
      host_audio,
      audience_audio,
      host_sd,
      host_hd,
      host_hdp,
      host_1080p,
      host_2k,
      host_4k,
      audience_sd,
      audience_hd,
      audience_hdp,
      audience_1080p,
      audience_2k,
      audience_4k,
      audience_audio_low_latency,
      audience_sd_low_latency,
      audience_hd_low_latency,
      audience_hdp_low_latency,
      audience_1080p_low_latency,
      audience_2k_low_latency,
      audience_4k_low_latency,
      audience_audio_ultra_low_latency,
      audience_sd_ultra_low_latency,
      audience_hd_ultra_low_latency,
      audience_hdp_ultra_low_latency,
      audience_1080p_ultra_low_latency,
      audience_2k_ultra_low_latency,
      audience_4k_ultra_low_latency,
      total_last1 AS audio_video_last,
      audio_last1 AS audio_last,
      video_last1 AS video_last,
      video_sd_last1 AS video_sd_last,
      video_hd_last1 AS video_hd_last,
      video_hdp_last1 AS video_hdp_last,
      host_sd_last1 AS host_video_sd_last,
      audience_sd_last1 AS audience_video_sd_last,
      host_hd_last1 AS host_video_hd_last,
      audience_hd_last1 AS audience_video_hd_last,
      host_hdp_last1 AS host_video_hdp_last,
      audience_hdp_last1 AS audience_video_hdp_last,
      host_audio_last1 AS host_audio_last,
      audience_audio_last1 AS audience_audio_last,
      host_video_last1 AS host_video_last,
      audience_video_last1 AS audience_video_last,
      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,
      audience_video_low_latency_last1 AS audience_video_low_latency_last,
      audience_total_low_latency_last1 AS audience_total_low_latency_last,
      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,
      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,
      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,
      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,
      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,
      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,
      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,
      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,
      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,
      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,
      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,
      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,
      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,
      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,
      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,
      audience_2k_last1 AS audience_2k_last,
      audience_4k_last1 AS audience_4k_last,
      audience_1080p_last1 AS audience_1080p_last,
      host_1080p_last1 AS host_1080p_last,
      host_2k_last1 AS host_2k_last,
      host_4k_last1 AS host_4k_last,
      total_last7,
      audio_last7,
      video_last7,
      video_sd_last7,
      video_hd_last7,
      video_hdp_last7,
      host_sd_last7,
      audience_sd_last7,
      host_hd_last7,
      audience_hd_last7,
      host_hdp_last7,
      audience_hdp_last7,
      host_audio_last7,
      audience_audio_last7,
      host_video_last7,
      audience_video_last7,
      audience_audio_low_latency_last7,
      audience_video_low_latency_last7,
      audience_total_low_latency_last7,
      audience_sd_low_latency_last7,
      audience_hd_low_latency_last7,
      audience_hdp_low_latency_last7,
      audience_1080p_low_latency_last7,
      audience_2k_low_latency_last7,
      audience_4k_low_latency_last7,
      audience_audio_ultra_low_latency_last7,
      audience_video_ultra_low_latency_last7,
      audience_total_ultra_low_latency_last7,
      audience_sd_ultra_low_latency_last7,
      audience_hd_ultra_low_latency_last7,
      audience_hdp_ultra_low_latency_last7,
      audience_1080p_ultra_low_latency_last7,
      audience_2k_ultra_low_latency_last7,
      audience_4k_ultra_low_latency_last7,
      audience_2k_last7,
      audience_4k_last7,
      audience_1080p_last7,
      host_1080p_last7,
      host_2k_last7,
      host_4k_last7
    FROM levels_usage_dod_di_1
    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-06') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-04') AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS ""自定义 SQL 查询""
WHERE ""自定义 SQL 查询"".""dim"" = 1 AND ""自定义 SQL 查询"".""rank_level1"" = 1
GROUP BY 37,
  39"
"SELECT '跳转：视频可用性' AS ""Calculation_5876704998657425411""
FROM (SELECT t1.date,
        CASE WHEN CAST(stat_period AS VARCHAR) = 'day' THEN substr(CAST(date_parse(cast( t1.date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(substr(CAST(start_date AS VARCHAR), 1, 10) AS VARCHAR), '~', CAST(substr(CAST(end_date AS VARCHAR), 1, 10) AS VARCHAR)) END AS period,
      start_date,
      end_date,
      stat_period,
      tag,
      t1.dim,
      level1,
      level2,
      level3,
      level4,
      os,
      ver,
      ver_type,
      domain,
      country,
      region,
      net,
      vid,
      project,
      company_id,
      company_name,
      rowsnum,
      lastusage,
      thisusage,
      fiveSecJoinSuccess,
      totalJoin,
      cnt_sid,
      video_freeze_time,
      video_totaltime,
      audio_freeze_time,
      audio_totaltime,
      s2l_total_delay_sec,
      s2l_25ms_delay_sec,
      s2l_75ms_delay_sec,
      p2s_lost_Leq5,
      p2s_lost_all,
      crash_cnt,
      service_cnt,
      ""1s_succ_join_ap_cnt"",
      ""5s_succ_join_ap_cnt"",
      total_join_ap_cnt,
      totalJoinSuccess,
      threeSecJoinSuccess,
      video_freeze_time_200,
      video_totaltime_200,
      video_freeze_time_500,
      video_totaltime_500,
      ""3s_succ_join_session_cnt_last1"",
      ""5s_succ_join_session_cnt_last1"",
      succ_join_session_cnt_last1,
      total_join_session_cnt_last1,
      total_session_cnt_last1,
      ""1s_succ_join_ap_cnt_last1"",
      ""5s_succ_join_ap_cnt_last1"",
      total_join_ap_cnt_last1,
      ""3s_succ_join_session_cnt_last7"",
      ""5s_succ_join_session_cnt_last7"",
      succ_join_session_cnt_last7,
      total_join_session_cnt_last7,
      total_session_cnt_last7,
      ""1s_succ_join_ap_cnt_last7"",
      ""5s_succ_join_ap_cnt_last7"",
      total_join_ap_cnt_last7,
      video_freeze_time_last1,
      video_totaltime_last1,
      video_freeze_time_500_last1,
      video_totaltime_500_last1,
      video_freeze_time_200_last1,
      video_totaltime_200_last1,
      video_freeze_time_last7,
      video_totaltime_last7,
      video_freeze_time_500_last7,
      video_totaltime_500_last7,
      video_freeze_time_200_last7,
      video_totaltime_200_last7,
      audio_freeze_time_last1,
      audio_totaltime_last1,
      audio_freeze_time_last7,
      audio_totaltime_last7,
      s2l_total_delay_sec_last1,
      s2l_25ms_delay_sec_last1,
      s2l_75ms_delay_sec_last1,
      s2l_total_delay_sec_last7,
      s2l_25ms_delay_sec_last7,
      s2l_75ms_delay_sec_last7,
      p2s_lost_Leq5_last1,
      p2s_lost_all_last1,
      p2s_lost_Leq5_last7,
      p2s_lost_all_last7,
      crash_cnt_last1,
      service_cnt_last1,
      crash_cnt_last7,
      service_cnt_last7,
      product_level1,
      product_level2,
      product_level3,
      product_level4,
      s2l_lost_Leq5,
      s2l_lost_all,
      s2l_lost_Leq5_last1,
      s2l_lost_all_last1,
      s2l_lost_Leq5_last7,
      s2l_lost_all_last7,
      fiveSecJoinSuccess_total,
      totalJoin_total,
      cnt_sid_total,
      video_freeze_time_total,
      video_totaltime_total,
      audio_freeze_time_total,
      audio_totaltime_total,
      s2l_total_delay_sec_total,
      s2l_25ms_delay_sec_total,
      s2l_75ms_delay_sec_total,
      p2s_lost_Leq5_total,
      p2s_lost_all_total,
      crash_cnt_total,
      service_cnt_total,
      ""1s_succ_join_ap_cnt_total"",
      ""5s_succ_join_ap_cnt_total"",
      total_join_ap_cnt_total,
      totalJoinSuccess_total,
      threeSecJoinSuccess_total,
      video_freeze_time_200_total,
      video_totaltime_200_total,
      video_freeze_time_500_total,
      video_totaltime_500_total,
      ""3s_succ_join_session_cnt_last1_total"",
      ""5s_succ_join_session_cnt_last1_total"",
      succ_join_session_cnt_last1_total,
      total_join_session_cnt_last1_total,
      total_session_cnt_last1_total,
      ""1s_succ_join_ap_cnt_last1_total"",
      ""5s_succ_join_ap_cnt_last1_total"",
      total_join_ap_cnt_last1_total,
      ""3s_succ_join_session_cnt_last7_total"",
      ""5s_succ_join_session_cnt_last7_total"",
      succ_join_session_cnt_last7_total,
      total_join_session_cnt_last7_total,
      total_session_cnt_last7_total,
      ""1s_succ_join_ap_cnt_last7_total"",
      ""5s_succ_join_ap_cnt_last7_total"",
      total_join_ap_cnt_last7_total,
      video_freeze_time_last1_total,
      video_totaltime_last1_total,
      video_freeze_time_500_last1_total,
      video_totaltime_500_last1_total,
      video_freeze_time_200_last1_total,
      video_totaltime_200_last1_total,
      video_freeze_time_last7_total,
      video_totaltime_last7_total,
      video_freeze_time_500_last7_total,
      video_totaltime_500_last7_total,
      video_freeze_time_200_last7_total,
      video_totaltime_200_last7_total,
      audio_freeze_time_last1_total,
      audio_totaltime_last1_total,
      audio_freeze_time_last7_total,
      audio_totaltime_last7_total,
      s2l_total_delay_sec_last1_total,
      s2l_25ms_delay_sec_last1_total,
      s2l_75ms_delay_sec_last1_total,
      s2l_total_delay_sec_last7_total,
      s2l_25ms_delay_sec_last7_total,
      s2l_75ms_delay_sec_last7_total,
      p2s_lost_Leq5_last1_total,
      p2s_lost_all_last1_total,
      p2s_lost_Leq5_last7_total,
      p2s_lost_all_last7_total,
      crash_cnt_last1_total,
      service_cnt_last1_total,
      crash_cnt_last7_total,
      service_cnt_last7_total,
      s2l_lost_Leq5_total,
      s2l_lost_all_total,
      s2l_lost_Leq5_last1_total,
      s2l_lost_all_last1_total,
      s2l_lost_Leq5_last7_total,
      s2l_lost_all_last7_total
    FROM report_datahub.pub_levels_quality_di_1 AS t1
      LEFT JOIN (SELECT date,
          dim,
          SUM(fiveSecJoinSuccess) AS fiveSecJoinSuccess_total,
          SUM(totalJoin) AS totalJoin_total,
          SUM(cnt_sid) AS cnt_sid_total,
          SUM(video_freeze_time) AS video_freeze_time_total,
          SUM(video_totaltime) AS video_totaltime_total,
          SUM(audio_freeze_time) AS audio_freeze_time_total,
          SUM(audio_totaltime) AS audio_totaltime_total,
          SUM(s2l_total_delay_sec) AS s2l_total_delay_sec_total,
          SUM(s2l_25ms_delay_sec) AS s2l_25ms_delay_sec_total,
          SUM(s2l_75ms_delay_sec) AS s2l_75ms_delay_sec_total,
          SUM(p2s_lost_Leq5) AS p2s_lost_Leq5_total,
          SUM(p2s_lost_all) AS p2s_lost_all_total,
          SUM(crash_cnt) AS crash_cnt_total,
          SUM(service_cnt) AS service_cnt_total,
          SUM(""1s_succ_join_ap_cnt"") AS ""1s_succ_join_ap_cnt_total"",
          SUM(""5s_succ_join_ap_cnt"") AS ""5s_succ_join_ap_cnt_total"",
          SUM(total_join_ap_cnt) AS total_join_ap_cnt_total,
          SUM(totalJoinSuccess) AS totalJoinSuccess_total,
          SUM(threeSecJoinSuccess) AS threeSecJoinSuccess_total,
          SUM(video_freeze_time_200) AS video_freeze_time_200_total,
          SUM(video_totaltime_200) AS video_totaltime_200_total,
          SUM(video_freeze_time_500) AS video_freeze_time_500_total,
          SUM(video_totaltime_500) AS video_totaltime_500_total,
          SUM(""3s_succ_join_session_cnt_last1"") AS ""3s_succ_join_session_cnt_last1_total"",
          SUM(""5s_succ_join_session_cnt_last1"") AS ""5s_succ_join_session_cnt_last1_total"",
          SUM(succ_join_session_cnt_last1) AS succ_join_session_cnt_last1_total,
          SUM(total_join_session_cnt_last1) AS total_join_session_cnt_last1_total,
          SUM(total_session_cnt_last1) AS total_session_cnt_last1_total,
          SUM(""1s_succ_join_ap_cnt_last1"") AS ""1s_succ_join_ap_cnt_last1_total"",
          SUM(""5s_succ_join_ap_cnt_last1"") AS ""5s_succ_join_ap_cnt_last1_total"",
          SUM(total_join_ap_cnt_last1) AS total_join_ap_cnt_last1_total,
          SUM(""3s_succ_join_session_cnt_last7"") AS ""3s_succ_join_session_cnt_last7_total"",
          SUM(""5s_succ_join_session_cnt_last7"") AS ""5s_succ_join_session_cnt_last7_total"",
          SUM(succ_join_session_cnt_last7) AS succ_join_session_cnt_last7_total,
          SUM(total_join_session_cnt_last7) AS total_join_session_cnt_last7_total,
          SUM(total_session_cnt_last7) AS total_session_cnt_last7_total,
          SUM(""1s_succ_join_ap_cnt_last7"") AS ""1s_succ_join_ap_cnt_last7_total"",
          SUM(""5s_succ_join_ap_cnt_last7"") AS ""5s_succ_join_ap_cnt_last7_total"",
          SUM(total_join_ap_cnt_last7) AS total_join_ap_cnt_last7_total,
          SUM(video_freeze_time_last1) AS video_freeze_time_last1_total,
          SUM(video_totaltime_last1) AS video_totaltime_last1_total,
          SUM(video_freeze_time_500_last1) AS video_freeze_time_500_last1_total,
          SUM(video_totaltime_500_last1) AS video_totaltime_500_last1_total,
          SUM(video_freeze_time_200_last1) AS video_freeze_time_200_last1_total,
          SUM(video_totaltime_200_last1) AS video_totaltime_200_last1_total,
          SUM(video_freeze_time_last7) AS video_freeze_time_last7_total,
          SUM(video_totaltime_last7) AS video_totaltime_last7_total,
          SUM(video_freeze_time_500_last7) AS video_freeze_time_500_last7_total,
          SUM(video_totaltime_500_last7) AS video_totaltime_500_last7_total,
          SUM(video_freeze_time_200_last7) AS video_freeze_time_200_last7_total,
          SUM(video_totaltime_200_last7) AS video_totaltime_200_last7_total,
          SUM(audio_freeze_time_last1) AS audio_freeze_time_last1_total,
          SUM(audio_totaltime_last1) AS audio_totaltime_last1_total,
          SUM(audio_freeze_time_last7) AS audio_freeze_time_last7_total,
          SUM(audio_totaltime_last7) AS audio_totaltime_last7_total,
          SUM(s2l_total_delay_sec_last1) AS s2l_total_delay_sec_last1_total,
          SUM(s2l_25ms_delay_sec_last1) AS s2l_25ms_delay_sec_last1_total,
          SUM(s2l_75ms_delay_sec_last1) AS s2l_75ms_delay_sec_last1_total,
          SUM(s2l_total_delay_sec_last7) AS s2l_total_delay_sec_last7_total,
          SUM(s2l_25ms_delay_sec_last7) AS s2l_25ms_delay_sec_last7_total,
          SUM(s2l_75ms_delay_sec_last7) AS s2l_75ms_delay_sec_last7_total,
          SUM(p2s_lost_Leq5_last1) AS p2s_lost_Leq5_last1_total,
          SUM(p2s_lost_all_last1) AS p2s_lost_all_last1_total,
          SUM(p2s_lost_Leq5_last7) AS p2s_lost_Leq5_last7_total,
          SUM(p2s_lost_all_last7) AS p2s_lost_all_last7_total,
          SUM(crash_cnt_last1) AS crash_cnt_last1_total,
          SUM(service_cnt_last1) AS service_cnt_last1_total,
          SUM(crash_cnt_last7) AS crash_cnt_last7_total,
          SUM(service_cnt_last7) AS service_cnt_last7_total,
          SUM(s2l_lost_Leq5) AS s2l_lost_Leq5_total,
          SUM(s2l_lost_all) AS s2l_lost_all_total,
          SUM(s2l_lost_Leq5_last1) AS s2l_lost_Leq5_last1_total,
          SUM(s2l_lost_all_last1) AS s2l_lost_all_last1_total,
          SUM(s2l_lost_Leq5_last7) AS s2l_lost_Leq5_last7_total,
          SUM(s2l_lost_all_last7) AS s2l_lost_all_last7_total
        FROM report_datahub.pub_levels_quality_di_1
        WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-21') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-11-21') AND CAST(tag AS VARCHAR) = 'Product'
        GROUP BY date,
          dim) AS t2 ON t1.date = t2.date AND t1.dim = t2.dim
    WHERE date_parse(cast( t1.date as VARCHAR), '%Y%m%d') >= DATE('2021-11-21') AND date_parse(cast( t1.date as VARCHAR), '%Y%m%d') <= DATE('2021-11-21') AND CAST(tag AS VARCHAR) = 'Product') AS ""自定义 SQL 查询""
WHERE CASE WHEN CAST(""自定义 SQL 查询"".""tag"" AS VARCHAR) = 'Industry' AND CAST(""自定义 SQL 查询"".""product_level1"" AS VARCHAR) = 'RTC' AND CAST(""自定义 SQL 查询"".""dim"" AS VARCHAR) = 'osver' THEN 0 WHEN CAST(""自定义 SQL 查询"".""tag"" AS VARCHAR) = 'VerType' AND CAST(""自定义 SQL 查询"".""product_level1"" AS VARCHAR) = 'RTC' AND CAST(""自定义 SQL 查询"".""dim"" AS VARCHAR) = 'osver' THEN 0 WHEN CAST(""自定义 SQL 查询"".""tag"" AS VARCHAR) = 'Product' AND CAST(""自定义 SQL 查询"".""dim"" AS VARCHAR) = 'osver' AND CAST(""自定义 SQL 查询"".""product_level1"" AS VARCHAR) = 'RTC' THEN 1 ELSE 0 END
HAVING COUNT(1) > 0"
"SELECT SUM(""自定义 SQL 查询"".""host_4k"") AS ""TEMP(Calculation_3519281700079370244)(1075454865)(0)"",
  SUM(""自定义 SQL 查询"".""audience_sd"") AS ""TEMP(Calculation_3519281700079370244)(1133678835)(0)"",
  SUM(""自定义 SQL 查询"".""host_1080p"") AS ""TEMP(Calculation_3519281700079370244)(1312501967)(0)"",
  SUM(""自定义 SQL 查询"".""host_hd"") AS ""TEMP(Calculation_3519281700079370244)(276907208)(0)"",
  SUM(""自定义 SQL 查询"".""video"") AS ""TEMP(Calculation_3519281700079370244)(2929708110)(0)"",
  SUM(""自定义 SQL 查询"".""audience_hd"") AS ""TEMP(Calculation_3519281700079370244)(2930728935)(0)"",
  SUM(""自定义 SQL 查询"".""audience_hdp"") AS ""TEMP(Calculation_3519281700079370244)(3010533957)(0)"",
  SUM(""自定义 SQL 查询"".""host_hdp"") AS ""TEMP(Calculation_3519281700079370244)(30306054)(0)"",
  SUM(""自定义 SQL 查询"".""host_audio"") AS ""TEMP(Calculation_3519281700079370244)(3087054365)(0)"",
  SUM(""自定义 SQL 查询"".""audio"") AS ""TEMP(Calculation_3519281700079370244)(3299350010)(0)"",
  SUM(""自定义 SQL 查询"".""audience_1080p"") AS ""TEMP(Calculation_3519281700079370244)(3628946582)(0)"",
  SUM(""自定义 SQL 查询"".""totalUsage"") AS ""TEMP(Calculation_3519281700079370244)(3847882359)(0)"",
  SUM(""自定义 SQL 查询"".""audience_audio"") AS ""TEMP(Calculation_3519281700079370244)(4109514392)(0)"",
  SUM(""自定义 SQL 查询"".""host_2k"") AS ""TEMP(Calculation_3519281700079370244)(586790827)(0)"",
  SUM(""自定义 SQL 查询"".""host_sd"") AS ""TEMP(Calculation_3519281700079370244)(709512178)(0)"",
  SUM(""自定义 SQL 查询"".""audience_4k"") AS ""TEMP(Calculation_3519281700079370244)(764410224)(0)"",
  SUM(""自定义 SQL 查询"".""audience_2k"") AS ""TEMP(Calculation_3519281700079370244)(943764407)(0)"",
  SUM(""自定义 SQL 查询"".""host_4k_last"") AS ""TEMP(Calculation_3519281700083154949)(101123376)(0)"",
  SUM(""自定义 SQL 查询"".""audience_video_hdp_last"") AS ""TEMP(Calculation_3519281700083154949)(1200517625)(0)"",
  SUM(""自定义 SQL 查询"".""audience_1080p_last"") AS ""TEMP(Calculation_3519281700083154949)(1314346200)(0)"",
  SUM(""自定义 SQL 查询"".""audience_video_hd_last"") AS ""TEMP(Calculation_3519281700083154949)(146570423)(0)"",
  SUM(""自定义 SQL 查询"".""audience_2k_last"") AS ""TEMP(Calculation_3519281700083154949)(1717771635)(0)"",
  SUM(""自定义 SQL 查询"".""audience_audio_last"") AS ""TEMP(Calculation_3519281700083154949)(2313111073)(0)"",
  SUM(""自定义 SQL 查询"".""host_video_hdp_last"") AS ""TEMP(Calculation_3519281700083154949)(258310559)(0)"",
  SUM(""自定义 SQL 查询"".""audio_video_last"") AS ""TEMP(Calculation_3519281700083154949)(2820618408)(0)"",
  SUM(""自定义 SQL 查询"".""audience_4k_last"") AS ""TEMP(Calculation_3519281700083154949)(3121859593)(0)"",
  SUM(""自定义 SQL 查询"".""host_1080p_last"") AS ""TEMP(Calculation_3519281700083154949)(3222422303)(0)"",
  SUM(""自定义 SQL 查询"".""host_audio_last"") AS ""TEMP(Calculation_3519281700083154949)(3227677803)(0)"",
  SUM(""自定义 SQL 查询"".""video_last"") AS ""TEMP(Calculation_3519281700083154949)(3934387163)(0)"",
  SUM(""自定义 SQL 查询"".""host_2k_last"") AS ""TEMP(Calculation_3519281700083154949)(4055292783)(0)"",
  SUM(""自定义 SQL 查询"".""audio_last"") AS ""TEMP(Calculation_3519281700083154949)(4091190060)(0)"",
  SUM(""自定义 SQL 查询"".""host_video_hd_last"") AS ""TEMP(Calculation_3519281700083154949)(4170367250)(0)"",
  SUM(""自定义 SQL 查询"".""host_video_sd_last"") AS ""TEMP(Calculation_3519281700083154949)(4190307025)(0)"",
  SUM(""自定义 SQL 查询"".""audience_video_sd_last"") AS ""TEMP(Calculation_3519281700083154949)(933007102)(0)"",
  AVG(""自定义 SQL 查询"".""totalUsage"") AS ""avg_totalUsage_ok"",
  ""自定义 SQL 查询"".""level1"" AS ""level1"",
  SUM(""自定义 SQL 查询"".""totalUsage"") AS ""sum_totalUsage_ok""
FROM (SELECT date,
        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,
      start_date AS start_date_7,
      end_date AS end_date,
      tag,
      area AS Scope,
      dim,
        CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,
      level2,
      level3,
      level4,
      product_level1 AS product_line,
      product_level2,
      product_level3,
      product_level4,
      vid_internal_industry_en AS cid_industry,
      vid_use_case_en AS vid_use_case_cn,
      vid_sector_en,
      ver_type,
      ver,
      os,
      domain,
      country,
      region,
      dim_grouping_name,
        CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,
      total AS totalUsage,
      audio,
      video,
      host_audio,
      audience_audio,
      host_sd,
      host_hd,
      host_hdp,
      host_1080p,
      host_2k,
      host_4k,
      audience_sd,
      audience_hd,
      audience_hdp,
      audience_1080p,
      audience_2k,
      audience_4k,
      audience_audio_low_latency,
      audience_sd_low_latency,
      audience_hd_low_latency,
      audience_hdp_low_latency,
      audience_1080p_low_latency,
      audience_2k_low_latency,
      audience_4k_low_latency,
      audience_audio_ultra_low_latency,
      audience_sd_ultra_low_latency,
      audience_hd_ultra_low_latency,
      audience_hdp_ultra_low_latency,
      audience_1080p_ultra_low_latency,
      audience_2k_ultra_low_latency,
      audience_4k_ultra_low_latency,
      total_last1 AS audio_video_last,
      audio_last1 AS audio_last,
      video_last1 AS video_last,
      video_sd_last1 AS video_sd_last,
      video_hd_last1 AS video_hd_last,
      video_hdp_last1 AS video_hdp_last,
      host_sd_last1 AS host_video_sd_last,
      audience_sd_last1 AS audience_video_sd_last,
      host_hd_last1 AS host_video_hd_last,
      audience_hd_last1 AS audience_video_hd_last,
      host_hdp_last1 AS host_video_hdp_last,
      audience_hdp_last1 AS audience_video_hdp_last,
      host_audio_last1 AS host_audio_last,
      audience_audio_last1 AS audience_audio_last,
      host_video_last1 AS host_video_last,
      audience_video_last1 AS audience_video_last,
      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,
      audience_video_low_latency_last1 AS audience_video_low_latency_last,
      audience_total_low_latency_last1 AS audience_total_low_latency_last,
      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,
      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,
      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,
      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,
      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,
      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,
      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,
      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,
      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,
      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,
      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,
      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,
      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,
      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,
      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,
      audience_2k_last1 AS audience_2k_last,
      audience_4k_last1 AS audience_4k_last,
      audience_1080p_last1 AS audience_1080p_last,
      host_1080p_last1 AS host_1080p_last,
      host_2k_last1 AS host_2k_last,
      host_4k_last1 AS host_4k_last,
      total_last7,
      audio_last7,
      video_last7,
      video_sd_last7,
      video_hd_last7,
      video_hdp_last7,
      host_sd_last7,
      audience_sd_last7,
      host_hd_last7,
      audience_hd_last7,
      host_hdp_last7,
      audience_hdp_last7,
      host_audio_last7,
      audience_audio_last7,
      host_video_last7,
      audience_video_last7,
      audience_audio_low_latency_last7,
      audience_video_low_latency_last7,
      audience_total_low_latency_last7,
      audience_sd_low_latency_last7,
      audience_hd_low_latency_last7,
      audience_hdp_low_latency_last7,
      audience_1080p_low_latency_last7,
      audience_2k_low_latency_last7,
      audience_4k_low_latency_last7,
      audience_audio_ultra_low_latency_last7,
      audience_video_ultra_low_latency_last7,
      audience_total_ultra_low_latency_last7,
      audience_sd_ultra_low_latency_last7,
      audience_hd_ultra_low_latency_last7,
      audience_hdp_ultra_low_latency_last7,
      audience_1080p_ultra_low_latency_last7,
      audience_2k_ultra_low_latency_last7,
      audience_4k_ultra_low_latency_last7,
      audience_2k_last7,
      audience_4k_last7,
      audience_1080p_last7,
      host_1080p_last7,
      host_2k_last7,
      host_4k_last7
    FROM levels_usage_dod_di_1
    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-06') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-04') AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS ""自定义 SQL 查询""
  CROSS JOIN (SELECT MAX(date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d')) AS ""__measure__0""
    FROM (SELECT date,
            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,
          start_date AS start_date_7,
          end_date AS end_date,
          tag,
          area AS Scope,
          dim,
            CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,
          level2,
          level3,
          level4,
          product_level1 AS product_line,
          product_level2,
          product_level3,
          product_level4,
          vid_internal_industry_en AS cid_industry,
          vid_use_case_en AS vid_use_case_cn,
          vid_sector_en,
          ver_type,
          ver,
          os,
          domain,
          country,
          region,
          dim_grouping_name,
            CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,
          total AS totalUsage,
          audio,
          video,
          host_audio,
          audience_audio,
          host_sd,
          host_hd,
          host_hdp,
          host_1080p,
          host_2k,
          host_4k,
          audience_sd,
          audience_hd,
          audience_hdp,
          audience_1080p,
          audience_2k,
          audience_4k,
          audience_audio_low_latency,
          audience_sd_low_latency,
          audience_hd_low_latency,
          audience_hdp_low_latency,
          audience_1080p_low_latency,
          audience_2k_low_latency,
          audience_4k_low_latency,
          audience_audio_ultra_low_latency,
          audience_sd_ultra_low_latency,
          audience_hd_ultra_low_latency,
          audience_hdp_ultra_low_latency,
          audience_1080p_ultra_low_latency,
          audience_2k_ultra_low_latency,
          audience_4k_ultra_low_latency,
          total_last1 AS audio_video_last,
          audio_last1 AS audio_last,
          video_last1 AS video_last,
          video_sd_last1 AS video_sd_last,
          video_hd_last1 AS video_hd_last,
          video_hdp_last1 AS video_hdp_last,
          host_sd_last1 AS host_video_sd_last,
          audience_sd_last1 AS audience_video_sd_last,
          host_hd_last1 AS host_video_hd_last,
          audience_hd_last1 AS audience_video_hd_last,
          host_hdp_last1 AS host_video_hdp_last,
          audience_hdp_last1 AS audience_video_hdp_last,
          host_audio_last1 AS host_audio_last,
          audience_audio_last1 AS audience_audio_last,
          host_video_last1 AS host_video_last,
          audience_video_last1 AS audience_video_last,
          audience_audio_low_latency_last1 AS audience_audio_low_latency_last,
          audience_video_low_latency_last1 AS audience_video_low_latency_last,
          audience_total_low_latency_last1 AS audience_total_low_latency_last,
          audience_sd_low_latency_last1 AS audience_sd_low_latency_last,
          audience_hd_low_latency_last1 AS audience_hd_low_latency_last,
          audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,
          audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,
          audience_2k_low_latency_last1 AS audience_2k_low_latency_last,
          audience_4k_low_latency_last1 AS audience_4k_low_latency_last,
          audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,
          audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,
          audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,
          audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,
          audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,
          audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,
          audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,
          audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,
          audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,
          audience_2k_last1 AS audience_2k_last,
          audience_4k_last1 AS audience_4k_last,
          audience_1080p_last1 AS audience_1080p_last,
          host_1080p_last1 AS host_1080p_last,
          host_2k_last1 AS host_2k_last,
          host_4k_last1 AS host_4k_last,
          total_last7,
          audio_last7,
          video_last7,
          video_sd_last7,
          video_hd_last7,
          video_hdp_last7,
          host_sd_last7,
          audience_sd_last7,
          host_hd_last7,
          audience_hd_last7,
          host_hdp_last7,
          audience_hdp_last7,
          host_audio_last7,
          audience_audio_last7,
          host_video_last7,
          audience_video_last7,
          audience_audio_low_latency_last7,
          audience_video_low_latency_last7,
          audience_total_low_latency_last7,
          audience_sd_low_latency_last7,
          audience_hd_low_latency_last7,
          audience_hdp_low_latency_last7,
          audience_1080p_low_latency_last7,
          audience_2k_low_latency_last7,
          audience_4k_low_latency_last7,
          audience_audio_ultra_low_latency_last7,
          audience_video_ultra_low_latency_last7,
          audience_total_ultra_low_latency_last7,
          audience_sd_ultra_low_latency_last7,
          audience_hd_ultra_low_latency_last7,
          audience_hdp_ultra_low_latency_last7,
          audience_1080p_ultra_low_latency_last7,
          audience_2k_ultra_low_latency_last7,
          audience_4k_ultra_low_latency_last7,
          audience_2k_last7,
          audience_4k_last7,
          audience_1080p_last7,
          host_1080p_last7,
          host_2k_last7,
          host_4k_last7
        FROM levels_usage_dod_di_1
        WHERE CAST(tag AS VARCHAR) = 'Industry' AND date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-06') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-04') AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS ""自定义 SQL 查询""
    HAVING COUNT(1) > 0) AS ""t0""
WHERE ""自定义 SQL 查询"".""dim"" = 1 AND ""自定义 SQL 查询"".""rank_level1"" = 2 AND date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d') = ""t0"".""__measure__0""
GROUP BY 36"
"SELECT SUM(""自定义 SQL 查询"".""host_4k"") AS ""TEMP(Calculation_3519281700079370244)(1075454865)(0)"",
  SUM(""自定义 SQL 查询"".""audience_sd"") AS ""TEMP(Calculation_3519281700079370244)(1133678835)(0)"",
  SUM(""自定义 SQL 查询"".""host_1080p"") AS ""TEMP(Calculation_3519281700079370244)(1312501967)(0)"",
  SUM(""自定义 SQL 查询"".""host_hd"") AS ""TEMP(Calculation_3519281700079370244)(276907208)(0)"",
  SUM(""自定义 SQL 查询"".""video"") AS ""TEMP(Calculation_3519281700079370244)(2929708110)(0)"",
  SUM(""自定义 SQL 查询"".""audience_hd"") AS ""TEMP(Calculation_3519281700079370244)(2930728935)(0)"",
  SUM(""自定义 SQL 查询"".""audience_hdp"") AS ""TEMP(Calculation_3519281700079370244)(3010533957)(0)"",
  SUM(""自定义 SQL 查询"".""host_hdp"") AS ""TEMP(Calculation_3519281700079370244)(30306054)(0)"",
  SUM(""自定义 SQL 查询"".""host_audio"") AS ""TEMP(Calculation_3519281700079370244)(3087054365)(0)"",
  SUM(""自定义 SQL 查询"".""audio"") AS ""TEMP(Calculation_3519281700079370244)(3299350010)(0)"",
  SUM(""自定义 SQL 查询"".""audience_1080p"") AS ""TEMP(Calculation_3519281700079370244)(3628946582)(0)"",
  SUM(""自定义 SQL 查询"".""totalUsage"") AS ""TEMP(Calculation_3519281700079370244)(3847882359)(0)"",
  SUM(""自定义 SQL 查询"".""audience_audio"") AS ""TEMP(Calculation_3519281700079370244)(4109514392)(0)"",
  SUM(""自定义 SQL 查询"".""host_2k"") AS ""TEMP(Calculation_3519281700079370244)(586790827)(0)"",
  SUM(""自定义 SQL 查询"".""host_sd"") AS ""TEMP(Calculation_3519281700079370244)(709512178)(0)"",
  SUM(""自定义 SQL 查询"".""audience_4k"") AS ""TEMP(Calculation_3519281700079370244)(764410224)(0)"",
  SUM(""自定义 SQL 查询"".""audience_2k"") AS ""TEMP(Calculation_3519281700079370244)(943764407)(0)"",
  ""自定义 SQL 查询"".""level1"" AS ""level1"",
  SUM(""自定义 SQL 查询"".""totalUsage"") AS ""sum_totalUsage_ok"",
  DATE_ADD('SECOND', 0, date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d')) AS ""tdy_date_ok""
FROM (SELECT date,
        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,
      start_date AS start_date_7,
      end_date AS end_date,
      tag,
      area AS Scope,
      dim,
        CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,
      level2,
      level3,
      level4,
      product_level1 AS product_line,
      product_level2,
      product_level3,
      product_level4,
      vid_internal_industry_en AS cid_industry,
      vid_use_case_en AS vid_use_case_cn,
      vid_sector_en,
      ver_type,
      ver,
      os,
      domain,
      country,
      region,
      dim_grouping_name,
        CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,
      total AS totalUsage,
      audio,
      video,
      host_audio,
      audience_audio,
      host_sd,
      host_hd,
      host_hdp,
      host_1080p,
      host_2k,
      host_4k,
      audience_sd,
      audience_hd,
      audience_hdp,
      audience_1080p,
      audience_2k,
      audience_4k,
      audience_audio_low_latency,
      audience_sd_low_latency,
      audience_hd_low_latency,
      audience_hdp_low_latency,
      audience_1080p_low_latency,
      audience_2k_low_latency,
      audience_4k_low_latency,
      audience_audio_ultra_low_latency,
      audience_sd_ultra_low_latency,
      audience_hd_ultra_low_latency,
      audience_hdp_ultra_low_latency,
      audience_1080p_ultra_low_latency,
      audience_2k_ultra_low_latency,
      audience_4k_ultra_low_latency,
      total_last1 AS audio_video_last,
      audio_last1 AS audio_last,
      video_last1 AS video_last,
      video_sd_last1 AS video_sd_last,
      video_hd_last1 AS video_hd_last,
      video_hdp_last1 AS video_hdp_last,
      host_sd_last1 AS host_video_sd_last,
      audience_sd_last1 AS audience_video_sd_last,
      host_hd_last1 AS host_video_hd_last,
      audience_hd_last1 AS audience_video_hd_last,
      host_hdp_last1 AS host_video_hdp_last,
      audience_hdp_last1 AS audience_video_hdp_last,
      host_audio_last1 AS host_audio_last,
      audience_audio_last1 AS audience_audio_last,
      host_video_last1 AS host_video_last,
      audience_video_last1 AS audience_video_last,
      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,
      audience_video_low_latency_last1 AS audience_video_low_latency_last,
      audience_total_low_latency_last1 AS audience_total_low_latency_last,
      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,
      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,
      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,
      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,
      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,
      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,
      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,
      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,
      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,
      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,
      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,
      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,
      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,
      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,
      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,
      audience_2k_last1 AS audience_2k_last,
      audience_4k_last1 AS audience_4k_last,
      audience_1080p_last1 AS audience_1080p_last,
      host_1080p_last1 AS host_1080p_last,
      host_2k_last1 AS host_2k_last,
      host_4k_last1 AS host_4k_last,
      total_last7,
      audio_last7,
      video_last7,
      video_sd_last7,
      video_hd_last7,
      video_hdp_last7,
      host_sd_last7,
      audience_sd_last7,
      host_hd_last7,
      audience_hd_last7,
      host_hdp_last7,
      audience_hdp_last7,
      host_audio_last7,
      audience_audio_last7,
      host_video_last7,
      audience_video_last7,
      audience_audio_low_latency_last7,
      audience_video_low_latency_last7,
      audience_total_low_latency_last7,
      audience_sd_low_latency_last7,
      audience_hd_low_latency_last7,
      audience_hdp_low_latency_last7,
      audience_1080p_low_latency_last7,
      audience_2k_low_latency_last7,
      audience_4k_low_latency_last7,
      audience_audio_ultra_low_latency_last7,
      audience_video_ultra_low_latency_last7,
      audience_total_ultra_low_latency_last7,
      audience_sd_ultra_low_latency_last7,
      audience_hd_ultra_low_latency_last7,
      audience_hdp_ultra_low_latency_last7,
      audience_1080p_ultra_low_latency_last7,
      audience_2k_ultra_low_latency_last7,
      audience_4k_ultra_low_latency_last7,
      audience_2k_last7,
      audience_4k_last7,
      audience_1080p_last7,
      host_1080p_last7,
      host_2k_last7,
      host_4k_last7
    FROM levels_usage_dod_di_1
    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-06') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-04') AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS ""自定义 SQL 查询""
  CROSS JOIN (SELECT MAX(date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d')) AS ""__measure__0""
    FROM (SELECT date,
            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,
          start_date AS start_date_7,
          end_date AS end_date,
          tag,
          area AS Scope,
          dim,
            CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,
          level2,
          level3,
          level4,
          product_level1 AS product_line,
          product_level2,
          product_level3,
          product_level4,
          vid_internal_industry_en AS cid_industry,
          vid_use_case_en AS vid_use_case_cn,
          vid_sector_en,
          ver_type,
          ver,
          os,
          domain,
          country,
          region,
          dim_grouping_name,
            CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,
          total AS totalUsage,
          audio,
          video,
          host_audio,
          audience_audio,
          host_sd,
          host_hd,
          host_hdp,
          host_1080p,
          host_2k,
          host_4k,
          audience_sd,
          audience_hd,
          audience_hdp,
          audience_1080p,
          audience_2k,
          audience_4k,
          audience_audio_low_latency,
          audience_sd_low_latency,
          audience_hd_low_latency,
          audience_hdp_low_latency,
          audience_1080p_low_latency,
          audience_2k_low_latency,
          audience_4k_low_latency,
          audience_audio_ultra_low_latency,
          audience_sd_ultra_low_latency,
          audience_hd_ultra_low_latency,
          audience_hdp_ultra_low_latency,
          audience_1080p_ultra_low_latency,
          audience_2k_ultra_low_latency,
          audience_4k_ultra_low_latency,
          total_last1 AS audio_video_last,
          audio_last1 AS audio_last,
          video_last1 AS video_last,
          video_sd_last1 AS video_sd_last,
          video_hd_last1 AS video_hd_last,
          video_hdp_last1 AS video_hdp_last,
          host_sd_last1 AS host_video_sd_last,
          audience_sd_last1 AS audience_video_sd_last,
          host_hd_last1 AS host_video_hd_last,
          audience_hd_last1 AS audience_video_hd_last,
          host_hdp_last1 AS host_video_hdp_last,
          audience_hdp_last1 AS audience_video_hdp_last,
          host_audio_last1 AS host_audio_last,
          audience_audio_last1 AS audience_audio_last,
          host_video_last1 AS host_video_last,
          audience_video_last1 AS audience_video_last,
          audience_audio_low_latency_last1 AS audience_audio_low_latency_last,
          audience_video_low_latency_last1 AS audience_video_low_latency_last,
          audience_total_low_latency_last1 AS audience_total_low_latency_last,
          audience_sd_low_latency_last1 AS audience_sd_low_latency_last,
          audience_hd_low_latency_last1 AS audience_hd_low_latency_last,
          audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,
          audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,
          audience_2k_low_latency_last1 AS audience_2k_low_latency_last,
          audience_4k_low_latency_last1 AS audience_4k_low_latency_last,
          audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,
          audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,
          audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,
          audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,
          audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,
          audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,
          audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,
          audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,
          audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,
          audience_2k_last1 AS audience_2k_last,
          audience_4k_last1 AS audience_4k_last,
          audience_1080p_last1 AS audience_1080p_last,
          host_1080p_last1 AS host_1080p_last,
          host_2k_last1 AS host_2k_last,
          host_4k_last1 AS host_4k_last,
          total_last7,
          audio_last7,
          video_last7,
          video_sd_last7,
          video_hd_last7,
          video_hdp_last7,
          host_sd_last7,
          audience_sd_last7,
          host_hd_last7,
          audience_hd_last7,
          host_hdp_last7,
          audience_hdp_last7,
          host_audio_last7,
          audience_audio_last7,
          host_video_last7,
          audience_video_last7,
          audience_audio_low_latency_last7,
          audience_video_low_latency_last7,
          audience_total_low_latency_last7,
          audience_sd_low_latency_last7,
          audience_hd_low_latency_last7,
          audience_hdp_low_latency_last7,
          audience_1080p_low_latency_last7,
          audience_2k_low_latency_last7,
          audience_4k_low_latency_last7,
          audience_audio_ultra_low_latency_last7,
          audience_video_ultra_low_latency_last7,
          audience_total_ultra_low_latency_last7,
          audience_sd_ultra_low_latency_last7,
          audience_hd_ultra_low_latency_last7,
          audience_hdp_ultra_low_latency_last7,
          audience_1080p_ultra_low_latency_last7,
          audience_2k_ultra_low_latency_last7,
          audience_4k_ultra_low_latency_last7,
          audience_2k_last7,
          audience_4k_last7,
          audience_1080p_last7,
          host_1080p_last7,
          host_2k_last7,
          host_4k_last7
        FROM levels_usage_dod_di_1
        WHERE CAST(tag AS VARCHAR) = 'Industry' AND date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-06') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-04') AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS ""自定义 SQL 查询""
    HAVING COUNT(1) > 0) AS ""t0""
WHERE ""自定义 SQL 查询"".""dim"" = 1 AND ""自定义 SQL 查询"".""rank_level1"" = 8 AND date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d') = ""t0"".""__measure__0""
GROUP BY 18,
  20"
"SELECT SUM(""自定义 SQL 查询"".""host_4k"") AS ""TEMP(Calculation_3519281700341563406)(1075454865)(0)"",
  SUM(""自定义 SQL 查询"".""audience_audio_last7"") AS ""TEMP(Calculation_3519281700341563406)(1077563395)(0)"",
  SUM(""自定义 SQL 查询"".""audience_sd"") AS ""TEMP(Calculation_3519281700341563406)(1133678835)(0)"",
  SUM(""自定义 SQL 查询"".""host_1080p"") AS ""TEMP(Calculation_3519281700341563406)(1312501967)(0)"",
  SUM(""自定义 SQL 查询"".""audience_sd_last7"") AS ""TEMP(Calculation_3519281700341563406)(1456465729)(0)"",
  SUM(""自定义 SQL 查询"".""host_hd_last7"") AS ""TEMP(Calculation_3519281700341563406)(1635749653)(0)"",
  SUM(""自定义 SQL 查询"".""audience_hd_last7"") AS ""TEMP(Calculation_3519281700341563406)(1747046964)(0)"",
  SUM(""自定义 SQL 查询"".""audience_2k_last7"") AS ""TEMP(Calculation_3519281700341563406)(1747524570)(0)"",
  SUM(""自定义 SQL 查询"".""host_hdp_last7"") AS ""TEMP(Calculation_3519281700341563406)(2044136109)(0)"",
  SUM(""自定义 SQL 查询"".""host_audio_last7"") AS ""TEMP(Calculation_3519281700341563406)(2464388580)(0)"",
  SUM(""自定义 SQL 查询"".""audio_last7"") AS ""TEMP(Calculation_3519281700341563406)(2589233512)(0)"",
  SUM(""自定义 SQL 查询"".""host_hd"") AS ""TEMP(Calculation_3519281700341563406)(276907208)(0)"",
  SUM(""自定义 SQL 查询"".""host_2k_last7"") AS ""TEMP(Calculation_3519281700341563406)(280796653)(0)"",
  SUM(""自定义 SQL 查询"".""video"") AS ""TEMP(Calculation_3519281700341563406)(2929708110)(0)"",
  SUM(""自定义 SQL 查询"".""audience_hd"") AS ""TEMP(Calculation_3519281700341563406)(2930728935)(0)"",
  SUM(""自定义 SQL 查询"".""audience_hdp"") AS ""TEMP(Calculation_3519281700341563406)(3010533957)(0)"",
  SUM(""自定义 SQL 查询"".""host_hdp"") AS ""TEMP(Calculation_3519281700341563406)(30306054)(0)"",
  SUM(""自定义 SQL 查询"".""host_audio"") AS ""TEMP(Calculation_3519281700341563406)(3087054365)(0)"",
  SUM(""自定义 SQL 查询"".""host_4k_last7"") AS ""TEMP(Calculation_3519281700341563406)(3127348545)(0)"",
  SUM(""自定义 SQL 查询"".""audio"") AS ""TEMP(Calculation_3519281700341563406)(3299350010)(0)"",
  SUM(""自定义 SQL 查询"".""total_last7"") AS ""TEMP(Calculation_3519281700341563406)(346677966)(0)"",
  SUM(""自定义 SQL 查询"".""audience_4k_last7"") AS ""TEMP(Calculation_3519281700341563406)(3543669678)(0)"",
  SUM(""自定义 SQL 查询"".""host_1080p_last7"") AS ""TEMP(Calculation_3519281700341563406)(3624983014)(0)"",
  SUM(""自定义 SQL 查询"".""audience_1080p"") AS ""TEMP(Calculation_3519281700341563406)(3628946582)(0)"",
  SUM(""自定义 SQL 查询"".""totalUsage"") AS ""TEMP(Calculation_3519281700341563406)(3847882359)(0)"",
  SUM(""自定义 SQL 查询"".""host_sd_last7"") AS ""TEMP(Calculation_3519281700341563406)(3905372418)(0)"",
  SUM(""自定义 SQL 查询"".""video_last7"") AS ""TEMP(Calculation_3519281700341563406)(4107040267)(0)"",
  SUM(""自定义 SQL 查询"".""audience_audio"") AS ""TEMP(Calculation_3519281700341563406)(4109514392)(0)"",
  SUM(""自定义 SQL 查询"".""host_2k"") AS ""TEMP(Calculation_3519281700341563406)(586790827)(0)"",
  SUM(""自定义 SQL 查询"".""audience_1080p_last7"") AS ""TEMP(Calculation_3519281700341563406)(632977665)(0)"",
  SUM(""自定义 SQL 查询"".""host_sd"") AS ""TEMP(Calculation_3519281700341563406)(709512178)(0)"",
  SUM(""自定义 SQL 查询"".""audience_hdp_last7"") AS ""TEMP(Calculation_3519281700341563406)(750340200)(0)"",
  SUM(""自定义 SQL 查询"".""audience_4k"") AS ""TEMP(Calculation_3519281700341563406)(764410224)(0)"",
  SUM(""自定义 SQL 查询"".""audience_2k"") AS ""TEMP(Calculation_3519281700341563406)(943764407)(0)"",
  ""自定义 SQL 查询"".""level1"" AS ""level1"",
  SUM(""自定义 SQL 查询"".""audio_video_last"") AS ""sum_audio_video_last_ok""
FROM (SELECT date,
        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,
      start_date AS start_date_7,
      end_date AS end_date,
      tag,
      area AS Scope,
      dim,
        CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,
      level2,
      level3,
      level4,
      product_level1 AS product_line,
      product_level2,
      product_level3,
      product_level4,
      vid_internal_industry_en AS cid_industry,
      vid_use_case_en AS vid_use_case_cn,
      vid_sector_en,
      ver_type,
      ver,
      os,
      domain,
      country,
      region,
      dim_grouping_name,
        CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,
      total AS totalUsage,
      audio,
      video,
      host_audio,
      audience_audio,
      host_sd,
      host_hd,
      host_hdp,
      host_1080p,
      host_2k,
      host_4k,
      audience_sd,
      audience_hd,
      audience_hdp,
      audience_1080p,
      audience_2k,
      audience_4k,
      audience_audio_low_latency,
      audience_sd_low_latency,
      audience_hd_low_latency,
      audience_hdp_low_latency,
      audience_1080p_low_latency,
      audience_2k_low_latency,
      audience_4k_low_latency,
      audience_audio_ultra_low_latency,
      audience_sd_ultra_low_latency,
      audience_hd_ultra_low_latency,
      audience_hdp_ultra_low_latency,
      audience_1080p_ultra_low_latency,
      audience_2k_ultra_low_latency,
      audience_4k_ultra_low_latency,
      total_last1 AS audio_video_last,
      audio_last1 AS audio_last,
      video_last1 AS video_last,
      video_sd_last1 AS video_sd_last,
      video_hd_last1 AS video_hd_last,
      video_hdp_last1 AS video_hdp_last,
      host_sd_last1 AS host_video_sd_last,
      audience_sd_last1 AS audience_video_sd_last,
      host_hd_last1 AS host_video_hd_last,
      audience_hd_last1 AS audience_video_hd_last,
      host_hdp_last1 AS host_video_hdp_last,
      audience_hdp_last1 AS audience_video_hdp_last,
      host_audio_last1 AS host_audio_last,
      audience_audio_last1 AS audience_audio_last,
      host_video_last1 AS host_video_last,
      audience_video_last1 AS audience_video_last,
      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,
      audience_video_low_latency_last1 AS audience_video_low_latency_last,
      audience_total_low_latency_last1 AS audience_total_low_latency_last,
      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,
      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,
      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,
      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,
      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,
      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,
      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,
      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,
      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,
      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,
      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,
      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,
      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,
      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,
      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,
      audience_2k_last1 AS audience_2k_last,
      audience_4k_last1 AS audience_4k_last,
      audience_1080p_last1 AS audience_1080p_last,
      host_1080p_last1 AS host_1080p_last,
      host_2k_last1 AS host_2k_last,
      host_4k_last1 AS host_4k_last,
      total_last7,
      audio_last7,
      video_last7,
      video_sd_last7,
      video_hd_last7,
      video_hdp_last7,
      host_sd_last7,
      audience_sd_last7,
      host_hd_last7,
      audience_hd_last7,
      host_hdp_last7,
      audience_hdp_last7,
      host_audio_last7,
      audience_audio_last7,
      host_video_last7,
      audience_video_last7,
      audience_audio_low_latency_last7,
      audience_video_low_latency_last7,
      audience_total_low_latency_last7,
      audience_sd_low_latency_last7,
      audience_hd_low_latency_last7,
      audience_hdp_low_latency_last7,
      audience_1080p_low_latency_last7,
      audience_2k_low_latency_last7,
      audience_4k_low_latency_last7,
      audience_audio_ultra_low_latency_last7,
      audience_video_ultra_low_latency_last7,
      audience_total_ultra_low_latency_last7,
      audience_sd_ultra_low_latency_last7,
      audience_hd_ultra_low_latency_last7,
      audience_hdp_ultra_low_latency_last7,
      audience_1080p_ultra_low_latency_last7,
      audience_2k_ultra_low_latency_last7,
      audience_4k_ultra_low_latency_last7,
      audience_2k_last7,
      audience_4k_last7,
      audience_1080p_last7,
      host_1080p_last7,
      host_2k_last7,
      host_4k_last7
    FROM levels_usage_dod_di_1
    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-06') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-04') AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS ""自定义 SQL 查询""
  CROSS JOIN (SELECT MAX(date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d')) AS ""__measure__0""
    FROM (SELECT date,
            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,
          start_date AS start_date_7,
          end_date AS end_date,
          tag,
          area AS Scope,
          dim,
            CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,
          level2,
          level3,
          level4,
          product_level1 AS product_line,
          product_level2,
          product_level3,
          product_level4,
          vid_internal_industry_en AS cid_industry,
          vid_use_case_en AS vid_use_case_cn,
          vid_sector_en,
          ver_type,
          ver,
          os,
          domain,
          country,
          region,
          dim_grouping_name,
            CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,
          total AS totalUsage,
          audio,
          video,
          host_audio,
          audience_audio,
          host_sd,
          host_hd,
          host_hdp,
          host_1080p,
          host_2k,
          host_4k,
          audience_sd,
          audience_hd,
          audience_hdp,
          audience_1080p,
          audience_2k,
          audience_4k,
          audience_audio_low_latency,
          audience_sd_low_latency,
          audience_hd_low_latency,
          audience_hdp_low_latency,
          audience_1080p_low_latency,
          audience_2k_low_latency,
          audience_4k_low_latency,
          audience_audio_ultra_low_latency,
          audience_sd_ultra_low_latency,
          audience_hd_ultra_low_latency,
          audience_hdp_ultra_low_latency,
          audience_1080p_ultra_low_latency,
          audience_2k_ultra_low_latency,
          audience_4k_ultra_low_latency,
          total_last1 AS audio_video_last,
          audio_last1 AS audio_last,
          video_last1 AS video_last,
          video_sd_last1 AS video_sd_last,
          video_hd_last1 AS video_hd_last,
          video_hdp_last1 AS video_hdp_last,
          host_sd_last1 AS host_video_sd_last,
          audience_sd_last1 AS audience_video_sd_last,
          host_hd_last1 AS host_video_hd_last,
          audience_hd_last1 AS audience_video_hd_last,
          host_hdp_last1 AS host_video_hdp_last,
          audience_hdp_last1 AS audience_video_hdp_last,
          host_audio_last1 AS host_audio_last,
          audience_audio_last1 AS audience_audio_last,
          host_video_last1 AS host_video_last,
          audience_video_last1 AS audience_video_last,
          audience_audio_low_latency_last1 AS audience_audio_low_latency_last,
          audience_video_low_latency_last1 AS audience_video_low_latency_last,
          audience_total_low_latency_last1 AS audience_total_low_latency_last,
          audience_sd_low_latency_last1 AS audience_sd_low_latency_last,
          audience_hd_low_latency_last1 AS audience_hd_low_latency_last,
          audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,
          audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,
          audience_2k_low_latency_last1 AS audience_2k_low_latency_last,
          audience_4k_low_latency_last1 AS audience_4k_low_latency_last,
          audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,
          audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,
          audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,
          audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,
          audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,
          audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,
          audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,
          audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,
          audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,
          audience_2k_last1 AS audience_2k_last,
          audience_4k_last1 AS audience_4k_last,
          audience_1080p_last1 AS audience_1080p_last,
          host_1080p_last1 AS host_1080p_last,
          host_2k_last1 AS host_2k_last,
          host_4k_last1 AS host_4k_last,
          total_last7,
          audio_last7,
          video_last7,
          video_sd_last7,
          video_hd_last7,
          video_hdp_last7,
          host_sd_last7,
          audience_sd_last7,
          host_hd_last7,
          audience_hd_last7,
          host_hdp_last7,
          audience_hdp_last7,
          host_audio_last7,
          audience_audio_last7,
          host_video_last7,
          audience_video_last7,
          audience_audio_low_latency_last7,
          audience_video_low_latency_last7,
          audience_total_low_latency_last7,
          audience_sd_low_latency_last7,
          audience_hd_low_latency_last7,
          audience_hdp_low_latency_last7,
          audience_1080p_low_latency_last7,
          audience_2k_low_latency_last7,
          audience_4k_low_latency_last7,
          audience_audio_ultra_low_latency_last7,
          audience_video_ultra_low_latency_last7,
          audience_total_ultra_low_latency_last7,
          audience_sd_ultra_low_latency_last7,
          audience_hd_ultra_low_latency_last7,
          audience_hdp_ultra_low_latency_last7,
          audience_1080p_ultra_low_latency_last7,
          audience_2k_ultra_low_latency_last7,
          audience_4k_ultra_low_latency_last7,
          audience_2k_last7,
          audience_4k_last7,
          audience_1080p_last7,
          host_1080p_last7,
          host_2k_last7,
          host_4k_last7
        FROM levels_usage_dod_di_1
        WHERE CAST(tag AS VARCHAR) = 'Industry' AND date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-06') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-04') AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS ""自定义 SQL 查询""
    HAVING COUNT(1) > 0) AS ""t0""
WHERE ""自定义 SQL 查询"".""dim"" = 1 AND ""自定义 SQL 查询"".""rank_level1"" = 7 AND date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d') = ""t0"".""__measure__0""
GROUP BY 35"
"SELECT ""t0"".""srcisp"" AS ""srcisp""
FROM (SELECT ""自定义 SQL 查询"".""srcisp"" AS ""srcisp""
    FROM (SELECT date AS ""date"",
          src_domain AS ""srcDomain"",
          src_country AS ""srcCountry"",
          dest_idc AS ""idc"",
          speaker_ip_isp AS ""srcisp"",
          speaker_vos_ip,
          delay_25 AS ""p2s_Delay25"",
          delay_50 AS ""p2s_Delay50"",
          delay_75 AS ""p2s_Delay75"",
          delay_100 AS ""p2s_Delay100"",
          delay_125 AS ""p2s_Delay125"",
          delay_150 AS ""p2s_Delay150"",
          delay_total,
          lost_ratio_5 AS ""p2s_lostRatio"",
          lostratio_total AS ""p2s_total"",
          jitter95_50 AS ""p2s_jitter95_50"",
          jitter95_100 AS ""p2s_jitter95_100"",
          jitter95_200 AS ""p2s_jitter95_200"",
          jitter95_300 AS ""p2s_jitter95_300"",
          jitter95_total,
          product_line,
          product_type
        FROM media.p2s_cover_oversea_ip
        WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-25') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-01')) AS ""自定义 SQL 查询""
    WHERE CAST(""自定义 SQL 查询"".""srcCountry"" AS VARCHAR) = 'India'
    GROUP BY ""自定义 SQL 查询"".""idc"",
      ""自定义 SQL 查询"".""srcCountry"",
      ""自定义 SQL 查询"".""srcDomain"",
      1
    HAVING CAST(CASE WHEN SUM(""自定义 SQL 查询"".""p2s_total"") >= 0 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100 THEN '0-100' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 1000 THEN '100-1000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 1000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 10000 THEN '1000-10000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 10000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100000 THEN '10000-100000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100000 THEN '100000以上' ELSE 'other' END AS VARCHAR) = '100-1000' OR CAST(CASE WHEN SUM(""自定义 SQL 查询"".""p2s_total"") >= 0 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100 THEN '0-100' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 1000 THEN '100-1000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 1000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 10000 THEN '1000-10000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 10000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100000 THEN '10000-100000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100000 THEN '100000以上' ELSE 'other' END AS VARCHAR) = '1000-10000' OR CAST(CASE WHEN SUM(""自定义 SQL 查询"".""p2s_total"") >= 0 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100 THEN '0-100' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 1000 THEN '100-1000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 1000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 10000 THEN '1000-10000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 10000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100000 THEN '10000-100000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100000 THEN '100000以上' ELSE 'other' END AS VARCHAR) = '10000-100000' OR CAST(CASE WHEN SUM(""自定义 SQL 查询"".""p2s_total"") >= 0 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100 THEN '0-100' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 1000 THEN '100-1000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 1000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 10000 THEN '1000-10000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 10000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100000 THEN '10000-100000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100000 THEN '100000以上' ELSE 'other' END AS VARCHAR) = '100000以上') AS ""t0""
GROUP BY 1"
"SELECT SUM(""自定义 SQL 查询"".""host_4k"") AS ""TEMP(Calculation_3519281700079370244)(1075454865)(0)"",
  SUM(""自定义 SQL 查询"".""audience_sd"") AS ""TEMP(Calculation_3519281700079370244)(1133678835)(0)"",
  SUM(""自定义 SQL 查询"".""host_1080p"") AS ""TEMP(Calculation_3519281700079370244)(1312501967)(0)"",
  SUM(""自定义 SQL 查询"".""host_hd"") AS ""TEMP(Calculation_3519281700079370244)(276907208)(0)"",
  SUM(""自定义 SQL 查询"".""video"") AS ""TEMP(Calculation_3519281700079370244)(2929708110)(0)"",
  SUM(""自定义 SQL 查询"".""audience_hd"") AS ""TEMP(Calculation_3519281700079370244)(2930728935)(0)"",
  SUM(""自定义 SQL 查询"".""audience_hdp"") AS ""TEMP(Calculation_3519281700079370244)(3010533957)(0)"",
  SUM(""自定义 SQL 查询"".""host_hdp"") AS ""TEMP(Calculation_3519281700079370244)(30306054)(0)"",
  SUM(""自定义 SQL 查询"".""host_audio"") AS ""TEMP(Calculation_3519281700079370244)(3087054365)(0)"",
  SUM(""自定义 SQL 查询"".""audio"") AS ""TEMP(Calculation_3519281700079370244)(3299350010)(0)"",
  SUM(""自定义 SQL 查询"".""audience_1080p"") AS ""TEMP(Calculation_3519281700079370244)(3628946582)(0)"",
  SUM(""自定义 SQL 查询"".""totalUsage"") AS ""TEMP(Calculation_3519281700079370244)(3847882359)(0)"",
  SUM(""自定义 SQL 查询"".""audience_audio"") AS ""TEMP(Calculation_3519281700079370244)(4109514392)(0)"",
  SUM(""自定义 SQL 查询"".""host_2k"") AS ""TEMP(Calculation_3519281700079370244)(586790827)(0)"",
  SUM(""自定义 SQL 查询"".""host_sd"") AS ""TEMP(Calculation_3519281700079370244)(709512178)(0)"",
  SUM(""自定义 SQL 查询"".""audience_4k"") AS ""TEMP(Calculation_3519281700079370244)(764410224)(0)"",
  SUM(""自定义 SQL 查询"".""audience_2k"") AS ""TEMP(Calculation_3519281700079370244)(943764407)(0)"",
  MIN(""自定义 SQL 查询"".""level1"") AS ""TEMP(attr_level1_nk)(1482809429)(0)"",
  MAX(""自定义 SQL 查询"".""level1"") AS ""TEMP(attr_level1_nk)(3765460736)(0)"",
  MAX(""自定义 SQL 查询"".""stat_date"") AS ""TEMP(attr_stat_date_nk)(2102638629)(0)"",
  MIN(""自定义 SQL 查询"".""stat_date"") AS ""TEMP(attr_stat_date_nk)(2790680713)(0)"",
  ""自定义 SQL 查询"".""level2"" AS ""level2"",
  DATE_ADD('SECOND', 0, date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d')) AS ""tdy_date_ok""
FROM (SELECT date,
        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,
      start_date AS start_date_7,
      end_date AS end_date,
      tag,
      area AS Scope,
      dim,
        CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,
      level2,
      level3,
      level4,
      product_level1 AS product_line,
      product_level2,
      product_level3,
      product_level4,
      vid_internal_industry_en AS cid_industry,
      vid_use_case_en AS vid_use_case_cn,
      vid_sector_en,
      ver_type,
      ver,
      os,
      domain,
      country,
      region,
      dim_grouping_name,
        CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,
      total AS totalUsage,
      audio,
      video,
      host_audio,
      audience_audio,
      host_sd,
      host_hd,
      host_hdp,
      host_1080p,
      host_2k,
      host_4k,
      audience_sd,
      audience_hd,
      audience_hdp,
      audience_1080p,
      audience_2k,
      audience_4k,
      audience_audio_low_latency,
      audience_sd_low_latency,
      audience_hd_low_latency,
      audience_hdp_low_latency,
      audience_1080p_low_latency,
      audience_2k_low_latency,
      audience_4k_low_latency,
      audience_audio_ultra_low_latency,
      audience_sd_ultra_low_latency,
      audience_hd_ultra_low_latency,
      audience_hdp_ultra_low_latency,
      audience_1080p_ultra_low_latency,
      audience_2k_ultra_low_latency,
      audience_4k_ultra_low_latency,
      total_last1 AS audio_video_last,
      audio_last1 AS audio_last,
      video_last1 AS video_last,
      video_sd_last1 AS video_sd_last,
      video_hd_last1 AS video_hd_last,
      video_hdp_last1 AS video_hdp_last,
      host_sd_last1 AS host_video_sd_last,
      audience_sd_last1 AS audience_video_sd_last,
      host_hd_last1 AS host_video_hd_last,
      audience_hd_last1 AS audience_video_hd_last,
      host_hdp_last1 AS host_video_hdp_last,
      audience_hdp_last1 AS audience_video_hdp_last,
      host_audio_last1 AS host_audio_last,
      audience_audio_last1 AS audience_audio_last,
      host_video_last1 AS host_video_last,
      audience_video_last1 AS audience_video_last,
      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,
      audience_video_low_latency_last1 AS audience_video_low_latency_last,
      audience_total_low_latency_last1 AS audience_total_low_latency_last,
      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,
      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,
      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,
      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,
      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,
      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,
      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,
      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,
      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,
      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,
      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,
      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,
      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,
      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,
      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,
      audience_2k_last1 AS audience_2k_last,
      audience_4k_last1 AS audience_4k_last,
      audience_1080p_last1 AS audience_1080p_last,
      host_1080p_last1 AS host_1080p_last,
      host_2k_last1 AS host_2k_last,
      host_4k_last1 AS host_4k_last,
      total_last7,
      audio_last7,
      video_last7,
      video_sd_last7,
      video_hd_last7,
      video_hdp_last7,
      host_sd_last7,
      audience_sd_last7,
      host_hd_last7,
      audience_hd_last7,
      host_hdp_last7,
      audience_hdp_last7,
      host_audio_last7,
      audience_audio_last7,
      host_video_last7,
      audience_video_last7,
      audience_audio_low_latency_last7,
      audience_video_low_latency_last7,
      audience_total_low_latency_last7,
      audience_sd_low_latency_last7,
      audience_hd_low_latency_last7,
      audience_hdp_low_latency_last7,
      audience_1080p_low_latency_last7,
      audience_2k_low_latency_last7,
      audience_4k_low_latency_last7,
      audience_audio_ultra_low_latency_last7,
      audience_video_ultra_low_latency_last7,
      audience_total_ultra_low_latency_last7,
      audience_sd_ultra_low_latency_last7,
      audience_hd_ultra_low_latency_last7,
      audience_hdp_ultra_low_latency_last7,
      audience_1080p_ultra_low_latency_last7,
      audience_2k_ultra_low_latency_last7,
      audience_4k_ultra_low_latency_last7,
      audience_2k_last7,
      audience_4k_last7,
      audience_1080p_last7,
      host_1080p_last7,
      host_2k_last7,
      host_4k_last7
    FROM levels_usage_dod_di_1
    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-06') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-04') AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS ""自定义 SQL 查询""
WHERE ""自定义 SQL 查询"".""dim"" = 1
GROUP BY 22,
  23"
"SELECT SUM(""自定义 SQL 查询"".""total"") AS ""TEMP(Calculation_5203557528862519300)(2253843611)(0)"",
  SUM(""自定义 SQL 查询"".""total_last7"") AS ""TEMP(Calculation_5203557528862519300)(431428601)(0)"",
  SUM(""自定义 SQL 查询"".""audio_last7"") AS ""TEMP(Calculation_5203557528863973382)(1745737303)(0)"",
  SUM(""自定义 SQL 查询"".""audio"") AS ""TEMP(Calculation_5203557528863973382)(4234702922)(0)"",
  SUM(""自定义 SQL 查询"".""video_last7"") AS ""TEMP(Calculation_5203557528864174088)(3553322618)(0)"",
  SUM(""自定义 SQL 查询"".""video"") AS ""TEMP(Calculation_5203557528864174088)(3647352276)(0)"",
  SUM(""自定义 SQL 查询"".""audience"") AS ""TEMP(Calculation_534802460955955203)(1306364424)(0)"",
  SUM(""自定义 SQL 查询"".""audience_last7"") AS ""TEMP(Calculation_534802460955955203)(2563414513)(0)"",
  SUM(""自定义 SQL 查询"".""audience_audio_last7"") AS ""TEMP(Calculation_534802460956184581)(1783975840)(0)"",
  SUM(""自定义 SQL 查询"".""audience_audio"") AS ""TEMP(Calculation_534802460956184581)(1868547182)(0)"",
  SUM(""自定义 SQL 查询"".""audience_video_last7"") AS ""TEMP(Calculation_534802460956430343)(1897793420)(0)"",
  SUM(""自定义 SQL 查询"".""audience_video"") AS ""TEMP(Calculation_534802460956430343)(2182583436)(0)"",
  SUM(""自定义 SQL 查询"".""audience_audio_low_latency_last7"") AS ""TEMP(audience_audio_last7_rate (复制)_230316907704053763)(29"",
  SUM(""自定义 SQL 查询"".""audience_audio_low_latency"") AS ""TEMP(audience_audio_last7_rate (复制)_230316907704053763)(83"",
  SUM(""自定义 SQL 查询"".""host_audio_last7"") AS ""TEMP(audience_audio_last7_rate (复制)_534802460956631050)(15"",
  SUM(""自定义 SQL 查询"".""host_audio"") AS ""TEMP(audience_audio_last7_rate (复制)_534802460956631050)(36"",
  SUM(""自定义 SQL 查询"".""host_last7"") AS ""TEMP(audience_last7_date (复制)_534802460957310992)(24217528"",
  SUM(""自定义 SQL 查询"".""host"") AS ""TEMP(audience_last7_date (复制)_534802460957310992)(24867219"",
  SUM(""自定义 SQL 查询"".""audience_low_latency"") AS ""TEMP(audience_low_latency_last1_rate (复制)_2303169077032468"",
  SUM(""自定义 SQL 查询"".""audience_low_latency_last7"") AS ""TEMP(audience_low_latency_last1_rate (复制)_2303169077032461"",
  SUM(""自定义 SQL 查询"".""audience_video_low_latency"") AS ""TEMP(audience_low_latency_last7_rate (复制)_2303169077218181"",
  SUM(""自定义 SQL 查询"".""audience_video_low_latency_last7"") AS ""TEMP(audience_low_latency_last7_rate (复制)_2303169077218182"",
  SUM(""自定义 SQL 查询"".""host_video_last7"") AS ""TEMP(audience_video_last7_rate (复制)_534802460956704782)(21"",
  SUM(""自定义 SQL 查询"".""host_video"") AS ""TEMP(audience_video_last7_rate (复制)_534802460956704782)(26""
FROM (SELECT date,
      SUBSTR(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) AS date_range_1,
      SUBSTR(CAST(end_date AS VARCHAR), 1, 10) AS date_range_2,
      stat_period,
        CASE WHEN CAST(stat_period AS VARCHAR) = 'day' THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,
      area,
      vid,
      project,
      company_id AS cid,
      company_name AS company,
      customer_level AS level,
      vid_internal_industry_en AS industry,
      vid_use_case_cn,
      csdc_owner,
      os,
      ver,
      ver_type,
      product_level1,
      product_level2,
      product_level3,
      total,
      audio,
      video,
      video_sd,
      video_hd,
      video_hdp,
        host_audio + host_video AS host,
      host_audio,
      host_video,
      host_sd,
      host_hd,
      host_hdp,
        audience_audio + audience_video AS audience,
        audience_audio_low_latency + audience_video_low_latency AS audience_low_latency,
      audience_audio,
      audience_audio_low_latency,
      audience_video,
      audience_video_low_latency,
      audience_sd,
      audience_sd_low_latency,
      audience_hd,
      audience_hd_low_latency,
      audience_hdp,
      audience_hdp_low_latency,
      total_last1,
      audio_last1,
      video_last1,
      video_sd_last1,
      video_hd_last1,
      video_hdp_last1,
        host_audio_last1 + host_video_last1 AS host_last1,
      host_audio_last1,
      host_video_last1,
        audience_audio_last1 + audience_video_last1 AS audience_last1,
        audience_audio_low_latency_last1 + audience_video_low_latency_last1 AS audience_low_latency_last1,
      audience_audio_last1,
      audience_audio_low_latency_last1,
      audience_video_last1,
      audience_video_low_latency_last1,
      total_last7,
      audio_last7,
      video_last7,
      video_sd_last7,
      video_hd_last7,
      video_hdp_last7,
        host_audio_last7 + host_video_last7 AS host_last7,
      host_audio_last7,
      host_video_last7,
        audience_audio_last7 + audience_video_last7 AS audience_last7,
        audience_audio_low_latency_last7 + audience_video_low_latency_last7 AS audience_low_latency_last7,
      audience_audio_last7,
      audience_audio_low_latency_last7,
      audience_video_last7,
      audience_video_low_latency_last7
    FROM report_datahub.vendor_vid_usage_di_1
    WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-06') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-06') AND CAST(vid AS VARCHAR) = CAST(428342 AS VARCHAR) AND dim = 1) AS ""自定义 SQL 查询""
  CROSS JOIN (SELECT MAX(date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d')) AS ""__measure__0""
    FROM (SELECT date,
          SUBSTR(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) AS date_range_1,
          SUBSTR(CAST(end_date AS VARCHAR), 1, 10) AS date_range_2,
          stat_period,
            CASE WHEN CAST(stat_period AS VARCHAR) = 'day' THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,
          area,
          vid,
          project,
          company_id AS cid,
          company_name AS company,
          customer_level AS level,
          vid_internal_industry_en AS industry,
          vid_use_case_cn,
          csdc_owner,
          os,
          ver,
          ver_type,
          product_level1,
          product_level2,
          product_level3,
          total,
          audio,
          video,
          video_sd,
          video_hd,
          video_hdp,
            host_audio + host_video AS host,
          host_audio,
          host_video,
          host_sd,
          host_hd,
          host_hdp,
            audience_audio + audience_video AS audience,
            audience_audio_low_latency + audience_video_low_latency AS audience_low_latency,
          audience_audio,
          audience_audio_low_latency,
          audience_video,
          audience_video_low_latency,
          audience_sd,
          audience_sd_low_latency,
          audience_hd,
          audience_hd_low_latency,
          audience_hdp,
          audience_hdp_low_latency,
          total_last1,
          audio_last1,
          video_last1,
          video_sd_last1,
          video_hd_last1,
          video_hdp_last1,
            host_audio_last1 + host_video_last1 AS host_last1,
          host_audio_last1,
          host_video_last1,
            audience_audio_last1 + audience_video_last1 AS audience_last1,
            audience_audio_low_latency_last1 + audience_video_low_latency_last1 AS audience_low_latency_last1,
          audience_audio_last1,
          audience_audio_low_latency_last1,
          audience_video_last1,
          audience_video_low_latency_last1,
          total_last7,
          audio_last7,
          video_last7,
          video_sd_last7,
          video_hd_last7,
          video_hdp_last7,
            host_audio_last7 + host_video_last7 AS host_last7,
          host_audio_last7,
          host_video_last7,
            audience_audio_last7 + audience_video_last7 AS audience_last7,
            audience_audio_low_latency_last7 + audience_video_low_latency_last7 AS audience_low_latency_last7,
          audience_audio_last7,
          audience_audio_low_latency_last7,
          audience_video_last7,
          audience_video_low_latency_last7
        FROM report_datahub.vendor_vid_usage_di_1
        WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-06') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-06') AND CAST(vid AS VARCHAR) = CAST(428342 AS VARCHAR) AND dim = 1) AS ""自定义 SQL 查询""
    HAVING COUNT(1) > 0) AS ""t0""
WHERE date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d') = ""t0"".""__measure__0""
HAVING COUNT(1) > 0"
"select created from system.runtime.queries order by created desc limit 10"
"SELECT SUM(""自定义 SQL 查询"".""s2l_25ms_delay_sec"") AS ""TEMP(Calculation_1430244791154503680)(2227145667)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_total_delay_sec"") AS ""TEMP(Calculation_1430244791154503680)(2460078802)(0)"",
  SUM(""自定义 SQL 查询"".""5s_succ_join_ap_cnt"") AS ""TEMP(Calculation_1430244791247978510)(1716451703)(0)"",
  SUM(""自定义 SQL 查询"".""total_join_ap_cnt"") AS ""TEMP(Calculation_1430244791247978510)(2681092799)(0)"",
  SUM(""自定义 SQL 查询"".""video_totaltime_200"") AS ""TEMP(Calculation_3430124447289356289)(2104207895)(0)"",
  SUM(""自定义 SQL 查询"".""video_freeze_time_200"") AS ""TEMP(Calculation_3430124447289356289)(530162565)(0)"",
  SUM(""自定义 SQL 查询"".""video_freeze_time_500"") AS ""TEMP(Calculation_3430124447289524226)(389023081)(0)"",
  SUM(""自定义 SQL 查询"".""video_totaltime_500"") AS ""TEMP(Calculation_3430124447289524226)(458654145)(0)"",
  SUM(""自定义 SQL 查询"".""totalJoin"") AS ""TEMP(Calculation_374009936508170240)(2073556184)(0)"",
  SUM(""自定义 SQL 查询"".""totalJoinSuccess"") AS ""TEMP(Calculation_374009936508170240)(2807417001)(0)"",
  SUM(""自定义 SQL 查询"".""threeSecJoinSuccess"") AS ""TEMP(Calculation_374009936508321793)(3693645608)(0)"",
  SUM(""自定义 SQL 查询"".""fiveSecJoinSuccess"") AS ""TEMP(Calculation_374009936508416002)(383616769)(0)"",
  SUM(""自定义 SQL 查询"".""video_totaltime"") AS ""TEMP(Calculation_374009936515215363)(2797449586)(0)"",
  SUM(""自定义 SQL 查询"".""video_freeze_time"") AS ""TEMP(Calculation_374009936515215363)(2940759860)(0)"",
  SUM(""自定义 SQL 查询"".""audio_freeze_time_200"") AS ""TEMP(Calculation_374009936517861380)(1946708283)(0)"",
  SUM(""自定义 SQL 查询"".""audio_totaltime_200"") AS ""TEMP(Calculation_374009936517861380)(784477006)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_lost_Leq5"") AS ""TEMP(Calculation_374009936519704581)(1936123547)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_lost_all"") AS ""TEMP(Calculation_374009936519704581)(749826584)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_75ms_delay_sec"") AS ""TEMP(Calculation_6542393318886285312)(2003933318)(0)"",
  SUM(""自定义 SQL 查询"".""crash_cnt"") AS ""TEMP(Calculation_7034341207372070925)(2360900687)(0)"",
  SUM(""自定义 SQL 查询"".""service_cnt"") AS ""TEMP(Calculation_7034341207372070925)(4291252132)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_lost_Leq5"") AS ""TEMP(Calculation_939915332871118850)(2745840127)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_lost_all"") AS ""TEMP(Calculation_939915332871118850)(734589263)(0)"",
  SUM(""自定义 SQL 查询"".""cnt_sid"") AS ""sum_cnt_sid_ok"",
  MAX(""自定义 SQL 查询"".""period"") AS ""usr_Calculation_6733444459377328128_nk"",
  ""自定义 SQL 查询"".""ver_type"" AS ""ver_type""
FROM (SELECT ts.*,
      fiveSecJoinSuccess_total,
      threeSecJoinSuccess_total,
      totalJoinSuccess_total,
      totalJoin_total,
      cnt_sid_total,
      ""1s_succ_join_ap_cnt_total"",
      ""5s_succ_join_ap_cnt_total"",
      total_join_ap_cnt_total,
      audio_freeze_time_200_total,
      audio_totaltime_200_total,
      video_freeze_time_total,
      video_totaltime_total,
      p2s_lost_Leq5_total,
      p2s_lost_all_total,
      s2l_25ms_delay_sec_total,
      s2l_75ms_delay_sec_total,
      s2l_total_delay_sec_total,
      crash_cnt_total,
      service_cnt_total,
      ""5s_succ_join_session_cnt_last1_total"",
      ""3s_succ_join_session_cnt_last1_total"",
      succ_join_session_cnt_last1_total,
      total_join_session_cnt_last1_total,
      total_session_cnt_last1_total,
      ""1s_succ_join_ap_cnt_last1_total"",
      ""5s_succ_join_ap_cnt_last1_total"",
      total_join_ap_cnt_last1_total,
      video_freeze_time_last1_total,
      video_totaltime_last1_total,
      p2s_lost_Leq5_last1_total,
      p2s_lost_all_last1_total,
      s2l_25ms_delay_sec_last1_total,
      s2l_75ms_delay_sec_last1_total,
      s2l_total_delay_sec_last1_total,
      crash_cnt_last1_total,
      service_cnt_last1_total,
      audio_freeze_time_200_last1_total,
      audio_totaltime_200_last1_total,
      ""5s_succ_join_session_cnt_last7_total"",
      ""3s_succ_join_session_cnt_last7_total"",
      succ_join_session_cnt_last7_total,
      total_join_session_cnt_last7_total,
      total_session_cnt_last7_total,
      ""7s_succ_join_ap_cnt_last7_total"",
      ""5s_succ_join_ap_cnt_last7_total"",
      total_join_ap_cnt_last7_total,
      video_freeze_time_last7_total,
      video_totaltime_last7_total,
      p2s_lost_Leq5_last7_total,
      p2s_lost_all_last7_total,
      s2l_25ms_delay_sec_last7_total,
      s2l_75ms_delay_sec_last7_total,
      s2l_total_delay_sec_last7_total,
      crash_cnt_last7_total,
      service_cnt_last7_total,
      audio_freeze_time_200_last7_total,
      audio_totaltime_200_last7_total,
      video_freeze_time_500_total,
      video_totaltime_500_total,
      video_freeze_time_200_total,
      video_totaltime_200_total,
      video_freeze_time_500_last1_total,
      video_totaltime_500_last1_total,
      video_freeze_time_200_last1_total,
      video_totaltime_200_last1_total,
      video_freeze_time_500_last7_total,
      video_totaltime_500_last7_total,
      video_freeze_time_200_last7_total,
      video_totaltime_200_last7_total,
      s2l_lost_Leq5_total,
      s2l_lost_all_total,
      s2l_lost_Leq5_last1_total,
      s2l_lost_all_last1_total,
      s2l_lost_Leq5_last7_total,
      s2l_lost_all_last7_total
    FROM (SELECT vid,
          project,
          company_id,
          area,
          company_name,
          industry_name,
          date,
            CASE WHEN CAST(stat_period AS VARCHAR) = 'day' THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(substr(CAST(start_date AS VARCHAR), 1, 10) AS VARCHAR), '~', CAST(substr(CAST(end_date AS VARCHAR), 1, 10) AS VARCHAR)) END AS period,
          net,
          os,
          ver,
          'osver' AS dim,
          product_level_1,
          product_level_2,
          ver_type,
          SUM(fiveSecJoinSuccess) AS fiveSecJoinSuccess,
          SUM(threeSecJoinSuccess) AS threeSecJoinSuccess,
          SUM(totalJoinSuccess) AS totalJoinSuccess,
          SUM(totalJoin) AS totalJoin,
          SUM(cnt_sid) AS cnt_sid,
          SUM(""1s_succ_join_ap_cnt"") AS ""1s_succ_join_ap_cnt"",
          SUM(""5s_succ_join_ap_cnt"") AS ""5s_succ_join_ap_cnt"",
          SUM(total_join_ap_cnt) AS total_join_ap_cnt,
          SUM(audio_freeze_time_200) AS audio_freeze_time_200,
          SUM(audio_totaltime_200) AS audio_totaltime_200,
          SUM(video_freeze_time) AS video_freeze_time,
          SUM(video_totaltime) AS video_totaltime,
          SUM(p2s_lost_Leq5) AS p2s_lost_Leq5,
          SUM(p2s_lost_all) AS p2s_lost_all,
          SUM(s2l_25ms_delay_sec) AS s2l_25ms_delay_sec,
          SUM(s2l_75ms_delay_sec) AS s2l_75ms_delay_sec,
          SUM(s2l_total_delay_sec) AS s2l_total_delay_sec,
          SUM(crash_cnt) AS crash_cnt,
          SUM(service_cnt) AS service_cnt,
          SUM(""5s_succ_join_session_cnt_last1"") AS ""5s_succ_join_session_cnt_last1"",
          SUM(""3s_succ_join_session_cnt_last1"") AS ""3s_succ_join_session_cnt_last1"",
          SUM(succ_join_session_cnt_last1) AS succ_join_session_cnt_last1,
          SUM(total_join_session_cnt_last1) AS total_join_session_cnt_last1,
          SUM(total_session_cnt_last1) AS total_session_cnt_last1,
          SUM(""1s_succ_join_ap_cnt_last1"") AS ""1s_succ_join_ap_cnt_last1"",
          SUM(""5s_succ_join_ap_cnt_last1"") AS ""5s_succ_join_ap_cnt_last1"",
          SUM(total_join_ap_cnt_last1) AS total_join_ap_cnt_last1,
          SUM(video_freeze_time_last1) AS video_freeze_time_last1,
          SUM(video_totaltime_last1) AS video_totaltime_last1,
          SUM(p2s_lost_Leq5_last1) AS p2s_lost_Leq5_last1,
          SUM(p2s_lost_all_last1) AS p2s_lost_all_last1,
          SUM(s2l_25ms_delay_sec_last1) AS s2l_25ms_delay_sec_last1,
          SUM(s2l_75ms_delay_sec_last1) AS s2l_75ms_delay_sec_last1,
          SUM(s2l_total_delay_sec_last1) AS s2l_total_delay_sec_last1,
          SUM(crash_cnt_last1) AS crash_cnt_last1,
          SUM(service_cnt_last1) AS service_cnt_last1,
          SUM(audio_freeze_time_200_last1) AS audio_freeze_time_200_last1,
          SUM(audio_totaltime_200_last1) AS audio_totaltime_200_last1,
          SUM(""5s_succ_join_session_cnt_last7"") AS ""5s_succ_join_session_cnt_last7"",
          SUM(""3s_succ_join_session_cnt_last7"") AS ""3s_succ_join_session_cnt_last7"",
          SUM(succ_join_session_cnt_last7) AS succ_join_session_cnt_last7,
          SUM(total_join_session_cnt_last7) AS total_join_session_cnt_last7,
          SUM(total_session_cnt_last7) AS total_session_cnt_last7,
          SUM(""1s_succ_join_ap_cnt_last7"") AS ""7s_succ_join_ap_cnt_last7"",
          SUM(""5s_succ_join_ap_cnt_last7"") AS ""5s_succ_join_ap_cnt_last7"",
          SUM(total_join_ap_cnt_last7) AS total_join_ap_cnt_last7,
          SUM(video_freeze_time_last7) AS video_freeze_time_last7,
          SUM(video_totaltime_last7) AS video_totaltime_last7,
          SUM(p2s_lost_Leq5_last7) AS p2s_lost_Leq5_last7,
          SUM(p2s_lost_all_last7) AS p2s_lost_all_last7,
          SUM(s2l_25ms_delay_sec_last7) AS s2l_25ms_delay_sec_last7,
          SUM(s2l_75ms_delay_sec_last7) AS s2l_75ms_delay_sec_last7,
          SUM(s2l_total_delay_sec_last7) AS s2l_total_delay_sec_last7,
          SUM(crash_cnt_last7) AS crash_cnt_last7,
          SUM(service_cnt_last7) AS service_cnt_last7,
          SUM(audio_freeze_time_200_last7) AS audio_freeze_time_200_last7,
          SUM(audio_totaltime_200_last7) AS audio_totaltime_200_last7,
          SUM(video_freeze_time_500) AS video_freeze_time_500,
          SUM(video_totaltime_500) AS video_totaltime_500,
          SUM(video_freeze_time_200) AS video_freeze_time_200,
          SUM(video_totaltime_200) AS video_totaltime_200,
          SUM(video_freeze_time_500_last1) AS video_freeze_time_500_last1,
          SUM(video_totaltime_500_last1) AS video_totaltime_500_last1,
          SUM(video_freeze_time_200_last1) AS video_freeze_time_200_last1,
          SUM(video_totaltime_200_last1) AS video_totaltime_200_last1,
          SUM(video_freeze_time_500_last7) AS video_freeze_time_500_last7,
          SUM(video_totaltime_500_last7) AS video_totaltime_500_last7,
          SUM(video_freeze_time_200_last7) AS video_freeze_time_200_last7,
          SUM(video_totaltime_200_last7) AS video_totaltime_200_last7,
          SUM(s2l_lost_Leq5) AS s2l_lost_Leq5,
          SUM(s2l_lost_all) AS s2l_lost_all,
          SUM(s2l_lost_Leq5_last1) AS s2l_lost_Leq5_last1,
          SUM(s2l_lost_all_last1) AS s2l_lost_all_last1,
          SUM(s2l_lost_Leq5_last7) AS s2l_lost_Leq5_last7,
          SUM(s2l_lost_all_last7) AS s2l_lost_all_last7
        FROM report_datahub.vid_osver_net_cp_domain_quality_di_1
        WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-21') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-11-21') AND CAST(vid AS VARCHAR) = CAST(281104 AS VARCHAR) AND CAST(product_level_2 AS VARCHAR) = 'Native'
        GROUP BY vid,
          project,
          company_id,
          area,
          company_name,
          industry_name,
          date,
          net,
          os,
          ver,
          product_level_1,
          product_level_2,
          ver_type,
            CASE WHEN CAST(stat_period AS VARCHAR) = 'day' THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(substr(CAST(start_date AS VARCHAR), 1, 10) AS VARCHAR), '~', CAST(substr(CAST(end_date AS VARCHAR), 1, 10) AS VARCHAR)) END) AS ts
      LEFT JOIN (SELECT vid,
          date,
          SUM(fiveSecJoinSuccess) AS fiveSecJoinSuccess_total,
          SUM(threeSecJoinSuccess) AS threeSecJoinSuccess_total,
          SUM(totalJoinSuccess) AS totalJoinSuccess_total,
          SUM(totalJoin) AS totalJoin_total,
          SUM(cnt_sid) AS cnt_sid_total,
          SUM(""1s_succ_join_ap_cnt"") AS ""1s_succ_join_ap_cnt_total"",
          SUM(""5s_succ_join_ap_cnt"") AS ""5s_succ_join_ap_cnt_total"",
          SUM(total_join_ap_cnt) AS total_join_ap_cnt_total,
          SUM(audio_freeze_time_200) AS audio_freeze_time_200_total,
          SUM(audio_totaltime_200) AS audio_totaltime_200_total,
          SUM(video_freeze_time) AS video_freeze_time_total,
          SUM(video_totaltime) AS video_totaltime_total,
          SUM(p2s_lost_Leq5) AS p2s_lost_Leq5_total,
          SUM(p2s_lost_all) AS p2s_lost_all_total,
          SUM(s2l_25ms_delay_sec) AS s2l_25ms_delay_sec_total,
          SUM(s2l_75ms_delay_sec) AS s2l_75ms_delay_sec_total,
          SUM(s2l_total_delay_sec) AS s2l_total_delay_sec_total,
          SUM(crash_cnt) AS crash_cnt_total,
          SUM(service_cnt) AS service_cnt_total,
          SUM(""5s_succ_join_session_cnt_last1"") AS ""5s_succ_join_session_cnt_last1_total"",
          SUM(""3s_succ_join_session_cnt_last1"") AS ""3s_succ_join_session_cnt_last1_total"",
          SUM(succ_join_session_cnt_last1) AS succ_join_session_cnt_last1_total,
          SUM(total_join_session_cnt_last1) AS total_join_session_cnt_last1_total,
          SUM(total_session_cnt_last1) AS total_session_cnt_last1_total,
          SUM(""1s_succ_join_ap_cnt_last1"") AS ""1s_succ_join_ap_cnt_last1_total"",
          SUM(""5s_succ_join_ap_cnt_last1"") AS ""5s_succ_join_ap_cnt_last1_total"",
          SUM(total_join_ap_cnt_last1) AS total_join_ap_cnt_last1_total,
          SUM(video_freeze_time_last1) AS video_freeze_time_last1_total,
          SUM(video_totaltime_last1) AS video_totaltime_last1_total,
          SUM(p2s_lost_Leq5_last1) AS p2s_lost_Leq5_last1_total,
          SUM(p2s_lost_all_last1) AS p2s_lost_all_last1_total,
          SUM(s2l_25ms_delay_sec_last1) AS s2l_25ms_delay_sec_last1_total,
          SUM(s2l_75ms_delay_sec_last1) AS s2l_75ms_delay_sec_last1_total,
          SUM(s2l_total_delay_sec_last1) AS s2l_total_delay_sec_last1_total,
          SUM(crash_cnt_last1) AS crash_cnt_last1_total,
          SUM(service_cnt_last1) AS service_cnt_last1_total,
          SUM(audio_freeze_time_200_last1) AS audio_freeze_time_200_last1_total,
          SUM(audio_totaltime_200_last1) AS audio_totaltime_200_last1_total,
          SUM(""5s_succ_join_session_cnt_last7"") AS ""5s_succ_join_session_cnt_last7_total"",
          SUM(""3s_succ_join_session_cnt_last7"") AS ""3s_succ_join_session_cnt_last7_total"",
          SUM(succ_join_session_cnt_last7) AS succ_join_session_cnt_last7_total,
          SUM(total_join_session_cnt_last7) AS total_join_session_cnt_last7_total,
          SUM(total_session_cnt_last7) AS total_session_cnt_last7_total,
          SUM(""1s_succ_join_ap_cnt_last7"") AS ""7s_succ_join_ap_cnt_last7_total"",
          SUM(""5s_succ_join_ap_cnt_last7"") AS ""5s_succ_join_ap_cnt_last7_total"",
          SUM(total_join_ap_cnt_last7) AS total_join_ap_cnt_last7_total,
          SUM(video_freeze_time_last7) AS video_freeze_time_last7_total,
          SUM(video_totaltime_last7) AS video_totaltime_last7_total,
          SUM(p2s_lost_Leq5_last7) AS p2s_lost_Leq5_last7_total,
          SUM(p2s_lost_all_last7) AS p2s_lost_all_last7_total,
          SUM(s2l_25ms_delay_sec_last7) AS s2l_25ms_delay_sec_last7_total,
          SUM(s2l_75ms_delay_sec_last7) AS s2l_75ms_delay_sec_last7_total,
          SUM(s2l_total_delay_sec_last7) AS s2l_total_delay_sec_last7_total,
          SUM(crash_cnt_last7) AS crash_cnt_last7_total,
          SUM(service_cnt_last7) AS service_cnt_last7_total,
          SUM(audio_freeze_time_200_last7) AS audio_freeze_time_200_last7_total,
          SUM(audio_totaltime_200_last7) AS audio_totaltime_200_last7_total,
          SUM(video_freeze_time_500) AS video_freeze_time_500_total,
          SUM(video_totaltime_500) AS video_totaltime_500_total,
          SUM(video_freeze_time_200) AS video_freeze_time_200_total,
          SUM(video_totaltime_200) AS video_totaltime_200_total,
          SUM(video_freeze_time_500_last1) AS video_freeze_time_500_last1_total,
          SUM(video_totaltime_500_last1) AS video_totaltime_500_last1_total,
          SUM(video_freeze_time_200_last1) AS video_freeze_time_200_last1_total,
          SUM(video_totaltime_200_last1) AS video_totaltime_200_last1_total,
          SUM(video_freeze_time_500_last7) AS video_freeze_time_500_last7_total,
          SUM(video_totaltime_500_last7) AS video_totaltime_500_last7_total,
          SUM(video_freeze_time_200_last7) AS video_freeze_time_200_last7_total,
          SUM(video_totaltime_200_last7) AS video_totaltime_200_last7_total,
          SUM(s2l_lost_Leq5) AS s2l_lost_Leq5_total,
          SUM(s2l_lost_all) AS s2l_lost_all_total,
          SUM(s2l_lost_Leq5_last1) AS s2l_lost_Leq5_last1_total,
          SUM(s2l_lost_all_last1) AS s2l_lost_all_last1_total,
          SUM(s2l_lost_Leq5_last7) AS s2l_lost_Leq5_last7_total,
          SUM(s2l_lost_all_last7) AS s2l_lost_all_last7_total
        FROM report_datahub.vid_osver_net_cp_domain_quality_di_1
        WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-21') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-11-21') AND CAST(vid AS VARCHAR) = CAST(281104 AS VARCHAR) AND CAST(product_level_2 AS VARCHAR) = 'Native'
        GROUP BY vid,
          date) AS tt ON CAST(ts.vid AS VARCHAR) = CAST(tt.vid AS VARCHAR) AND ts.date = tt.date) AS ""自定义 SQL 查询""
  CROSS JOIN (SELECT MAX(date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d')) AS ""__measure__0""
    FROM (SELECT ts.*,
          fiveSecJoinSuccess_total,
          threeSecJoinSuccess_total,
          totalJoinSuccess_total,
          totalJoin_total,
          cnt_sid_total,
          ""1s_succ_join_ap_cnt_total"",
          ""5s_succ_join_ap_cnt_total"",
          total_join_ap_cnt_total,
          audio_freeze_time_200_total,
          audio_totaltime_200_total,
          video_freeze_time_total,
          video_totaltime_total,
          p2s_lost_Leq5_total,
          p2s_lost_all_total,
          s2l_25ms_delay_sec_total,
          s2l_75ms_delay_sec_total,
          s2l_total_delay_sec_total,
          crash_cnt_total,
          service_cnt_total,
          ""5s_succ_join_session_cnt_last1_total"",
          ""3s_succ_join_session_cnt_last1_total"",
          succ_join_session_cnt_last1_total,
          total_join_session_cnt_last1_total,
          total_session_cnt_last1_total,
          ""1s_succ_join_ap_cnt_last1_total"",
          ""5s_succ_join_ap_cnt_last1_total"",
          total_join_ap_cnt_last1_total,
          video_freeze_time_last1_total,
          video_totaltime_last1_total,
          p2s_lost_Leq5_last1_total,
          p2s_lost_all_last1_total,
          s2l_25ms_delay_sec_last1_total,
          s2l_75ms_delay_sec_last1_total,
          s2l_total_delay_sec_last1_total,
          crash_cnt_last1_total,
          service_cnt_last1_total,
          audio_freeze_time_200_last1_total,
          audio_totaltime_200_last1_total,
          ""5s_succ_join_session_cnt_last7_total"",
          ""3s_succ_join_session_cnt_last7_total"",
          succ_join_session_cnt_last7_total,
          total_join_session_cnt_last7_total,
          total_session_cnt_last7_total,
          ""7s_succ_join_ap_cnt_last7_total"",
          ""5s_succ_join_ap_cnt_last7_total"",
          total_join_ap_cnt_last7_total,
          video_freeze_time_last7_total,
          video_totaltime_last7_total,
          p2s_lost_Leq5_last7_total,
          p2s_lost_all_last7_total,
          s2l_25ms_delay_sec_last7_total,
          s2l_75ms_delay_sec_last7_total,
          s2l_total_delay_sec_last7_total,
          crash_cnt_last7_total,
          service_cnt_last7_total,
          audio_freeze_time_200_last7_total,
          audio_totaltime_200_last7_total,
          video_freeze_time_500_total,
          video_totaltime_500_total,
          video_freeze_time_200_total,
          video_totaltime_200_total,
          video_freeze_time_500_last1_total,
          video_totaltime_500_last1_total,
          video_freeze_time_200_last1_total,
          video_totaltime_200_last1_total,
          video_freeze_time_500_last7_total,
          video_totaltime_500_last7_total,
          video_freeze_time_200_last7_total,
          video_totaltime_200_last7_total,
          s2l_lost_Leq5_total,
          s2l_lost_all_total,
          s2l_lost_Leq5_last1_total,
          s2l_lost_all_last1_total,
          s2l_lost_Leq5_last7_total,
          s2l_lost_all_last7_total
        FROM (SELECT vid,
              project,
              company_id,
              area,
              company_name,
              industry_name,
              date,
                CASE WHEN CAST(stat_period AS VARCHAR) = 'day' THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(substr(CAST(start_date AS VARCHAR), 1, 10) AS VARCHAR), '~', CAST(substr(CAST(end_date AS VARCHAR), 1, 10) AS VARCHAR)) END AS period,
              net,
              os,
              ver,
              'osver' AS dim,
              product_level_1,
              product_level_2,
              ver_type,
              SUM(fiveSecJoinSuccess) AS fiveSecJoinSuccess,
              SUM(threeSecJoinSuccess) AS threeSecJoinSuccess,
              SUM(totalJoinSuccess) AS totalJoinSuccess,
              SUM(totalJoin) AS totalJoin,
              SUM(cnt_sid) AS cnt_sid,
              SUM(""1s_succ_join_ap_cnt"") AS ""1s_succ_join_ap_cnt"",
              SUM(""5s_succ_join_ap_cnt"") AS ""5s_succ_join_ap_cnt"",
              SUM(total_join_ap_cnt) AS total_join_ap_cnt,
              SUM(audio_freeze_time_200) AS audio_freeze_time_200,
              SUM(audio_totaltime_200) AS audio_totaltime_200,
              SUM(video_freeze_time) AS video_freeze_time,
              SUM(video_totaltime) AS video_totaltime,
              SUM(p2s_lost_Leq5) AS p2s_lost_Leq5,
              SUM(p2s_lost_all) AS p2s_lost_all,
              SUM(s2l_25ms_delay_sec) AS s2l_25ms_delay_sec,
              SUM(s2l_75ms_delay_sec) AS s2l_75ms_delay_sec,
              SUM(s2l_total_delay_sec) AS s2l_total_delay_sec,
              SUM(crash_cnt) AS crash_cnt,
              SUM(service_cnt) AS service_cnt,
              SUM(""5s_succ_join_session_cnt_last1"") AS ""5s_succ_join_session_cnt_last1"",
              SUM(""3s_succ_join_session_cnt_last1"") AS ""3s_succ_join_session_cnt_last1"",
              SUM(succ_join_session_cnt_last1) AS succ_join_session_cnt_last1,
              SUM(total_join_session_cnt_last1) AS total_join_session_cnt_last1,
              SUM(total_session_cnt_last1) AS total_session_cnt_last1,
              SUM(""1s_succ_join_ap_cnt_last1"") AS ""1s_succ_join_ap_cnt_last1"",
              SUM(""5s_succ_join_ap_cnt_last1"") AS ""5s_succ_join_ap_cnt_last1"",
              SUM(total_join_ap_cnt_last1) AS total_join_ap_cnt_last1,
              SUM(video_freeze_time_last1) AS video_freeze_time_last1,
              SUM(video_totaltime_last1) AS video_totaltime_last1,
              SUM(p2s_lost_Leq5_last1) AS p2s_lost_Leq5_last1,
              SUM(p2s_lost_all_last1) AS p2s_lost_all_last1,
              SUM(s2l_25ms_delay_sec_last1) AS s2l_25ms_delay_sec_last1,
              SUM(s2l_75ms_delay_sec_last1) AS s2l_75ms_delay_sec_last1,
              SUM(s2l_total_delay_sec_last1) AS s2l_total_delay_sec_last1,
              SUM(crash_cnt_last1) AS crash_cnt_last1,
              SUM(service_cnt_last1) AS service_cnt_last1,
              SUM(audio_freeze_time_200_last1) AS audio_freeze_time_200_last1,
              SUM(audio_totaltime_200_last1) AS audio_totaltime_200_last1,
              SUM(""5s_succ_join_session_cnt_last7"") AS ""5s_succ_join_session_cnt_last7"",
              SUM(""3s_succ_join_session_cnt_last7"") AS ""3s_succ_join_session_cnt_last7"",
              SUM(succ_join_session_cnt_last7) AS succ_join_session_cnt_last7,
              SUM(total_join_session_cnt_last7) AS total_join_session_cnt_last7,
              SUM(total_session_cnt_last7) AS total_session_cnt_last7,
              SUM(""1s_succ_join_ap_cnt_last7"") AS ""7s_succ_join_ap_cnt_last7"",
              SUM(""5s_succ_join_ap_cnt_last7"") AS ""5s_succ_join_ap_cnt_last7"",
              SUM(total_join_ap_cnt_last7) AS total_join_ap_cnt_last7,
              SUM(video_freeze_time_last7) AS video_freeze_time_last7,
              SUM(video_totaltime_last7) AS video_totaltime_last7,
              SUM(p2s_lost_Leq5_last7) AS p2s_lost_Leq5_last7,
              SUM(p2s_lost_all_last7) AS p2s_lost_all_last7,
              SUM(s2l_25ms_delay_sec_last7) AS s2l_25ms_delay_sec_last7,
              SUM(s2l_75ms_delay_sec_last7) AS s2l_75ms_delay_sec_last7,
              SUM(s2l_total_delay_sec_last7) AS s2l_total_delay_sec_last7,
              SUM(crash_cnt_last7) AS crash_cnt_last7,
              SUM(service_cnt_last7) AS service_cnt_last7,
              SUM(audio_freeze_time_200_last7) AS audio_freeze_time_200_last7,
              SUM(audio_totaltime_200_last7) AS audio_totaltime_200_last7,
              SUM(video_freeze_time_500) AS video_freeze_time_500,
              SUM(video_totaltime_500) AS video_totaltime_500,
              SUM(video_freeze_time_200) AS video_freeze_time_200,
              SUM(video_totaltime_200) AS video_totaltime_200,
              SUM(video_freeze_time_500_last1) AS video_freeze_time_500_last1,
              SUM(video_totaltime_500_last1) AS video_totaltime_500_last1,
              SUM(video_freeze_time_200_last1) AS video_freeze_time_200_last1,
              SUM(video_totaltime_200_last1) AS video_totaltime_200_last1,
              SUM(video_freeze_time_500_last7) AS video_freeze_time_500_last7,
              SUM(video_totaltime_500_last7) AS video_totaltime_500_last7,
              SUM(video_freeze_time_200_last7) AS video_freeze_time_200_last7,
              SUM(video_totaltime_200_last7) AS video_totaltime_200_last7,
              SUM(s2l_lost_Leq5) AS s2l_lost_Leq5,
              SUM(s2l_lost_all) AS s2l_lost_all,
              SUM(s2l_lost_Leq5_last1) AS s2l_lost_Leq5_last1,
              SUM(s2l_lost_all_last1) AS s2l_lost_all_last1,
              SUM(s2l_lost_Leq5_last7) AS s2l_lost_Leq5_last7,
              SUM(s2l_lost_all_last7) AS s2l_lost_all_last7
            FROM report_datahub.vid_osver_net_cp_domain_quality_di_1
            WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-21') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-11-21') AND CAST(vid AS VARCHAR) = CAST(281104 AS VARCHAR) AND CAST(product_level_2 AS VARCHAR) = 'Native'
            GROUP BY vid,
              project,
              company_id,
              area,
              company_name,
              industry_name,
              date,
              net,
              os,
              ver,
              product_level_1,
              product_level_2,
              ver_type,
                CASE WHEN CAST(stat_period AS VARCHAR) = 'day' THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(substr(CAST(start_date AS VARCHAR), 1, 10) AS VARCHAR), '~', CAST(substr(CAST(end_date AS VARCHAR), 1, 10) AS VARCHAR)) END) AS ts
          LEFT JOIN (SELECT vid,
              date,
              SUM(fiveSecJoinSuccess) AS fiveSecJoinSuccess_total,
              SUM(threeSecJoinSuccess) AS threeSecJoinSuccess_total,
              SUM(totalJoinSuccess) AS totalJoinSuccess_total,
              SUM(totalJoin) AS totalJoin_total,
              SUM(cnt_sid) AS cnt_sid_total,
              SUM(""1s_succ_join_ap_cnt"") AS ""1s_succ_join_ap_cnt_total"",
              SUM(""5s_succ_join_ap_cnt"") AS ""5s_succ_join_ap_cnt_total"",
              SUM(total_join_ap_cnt) AS total_join_ap_cnt_total,
              SUM(audio_freeze_time_200) AS audio_freeze_time_200_total,
              SUM(audio_totaltime_200) AS audio_totaltime_200_total,
              SUM(video_freeze_time) AS video_freeze_time_total,
              SUM(video_totaltime) AS video_totaltime_total,
              SUM(p2s_lost_Leq5) AS p2s_lost_Leq5_total,
              SUM(p2s_lost_all) AS p2s_lost_all_total,
              SUM(s2l_25ms_delay_sec) AS s2l_25ms_delay_sec_total,
              SUM(s2l_75ms_delay_sec) AS s2l_75ms_delay_sec_total,
              SUM(s2l_total_delay_sec) AS s2l_total_delay_sec_total,
              SUM(crash_cnt) AS crash_cnt_total,
              SUM(service_cnt) AS service_cnt_total,
              SUM(""5s_succ_join_session_cnt_last1"") AS ""5s_succ_join_session_cnt_last1_total"",
              SUM(""3s_succ_join_session_cnt_last1"") AS ""3s_succ_join_session_cnt_last1_total"",
              SUM(succ_join_session_cnt_last1) AS succ_join_session_cnt_last1_total,
              SUM(total_join_session_cnt_last1) AS total_join_session_cnt_last1_total,
              SUM(total_session_cnt_last1) AS total_session_cnt_last1_total,
              SUM(""1s_succ_join_ap_cnt_last1"") AS ""1s_succ_join_ap_cnt_last1_total"",
              SUM(""5s_succ_join_ap_cnt_last1"") AS ""5s_succ_join_ap_cnt_last1_total"",
              SUM(total_join_ap_cnt_last1) AS total_join_ap_cnt_last1_total,
              SUM(video_freeze_time_last1) AS video_freeze_time_last1_total,
              SUM(video_totaltime_last1) AS video_totaltime_last1_total,
              SUM(p2s_lost_Leq5_last1) AS p2s_lost_Leq5_last1_total,
              SUM(p2s_lost_all_last1) AS p2s_lost_all_last1_total,
              SUM(s2l_25ms_delay_sec_last1) AS s2l_25ms_delay_sec_last1_total,
              SUM(s2l_75ms_delay_sec_last1) AS s2l_75ms_delay_sec_last1_total,
              SUM(s2l_total_delay_sec_last1) AS s2l_total_delay_sec_last1_total,
              SUM(crash_cnt_last1) AS crash_cnt_last1_total,
              SUM(service_cnt_last1) AS service_cnt_last1_total,
              SUM(audio_freeze_time_200_last1) AS audio_freeze_time_200_last1_total,
              SUM(audio_totaltime_200_last1) AS audio_totaltime_200_last1_total,
              SUM(""5s_succ_join_session_cnt_last7"") AS ""5s_succ_join_session_cnt_last7_total"",
              SUM(""3s_succ_join_session_cnt_last7"") AS ""3s_succ_join_session_cnt_last7_total"",
              SUM(succ_join_session_cnt_last7) AS succ_join_session_cnt_last7_total,
              SUM(total_join_session_cnt_last7) AS total_join_session_cnt_last7_total,
              SUM(total_session_cnt_last7) AS total_session_cnt_last7_total,
              SUM(""1s_succ_join_ap_cnt_last7"") AS ""7s_succ_join_ap_cnt_last7_total"",
              SUM(""5s_succ_join_ap_cnt_last7"") AS ""5s_succ_join_ap_cnt_last7_total"",
              SUM(total_join_ap_cnt_last7) AS total_join_ap_cnt_last7_total,
              SUM(video_freeze_time_last7) AS video_freeze_time_last7_total,
              SUM(video_totaltime_last7) AS video_totaltime_last7_total,
              SUM(p2s_lost_Leq5_last7) AS p2s_lost_Leq5_last7_total,
              SUM(p2s_lost_all_last7) AS p2s_lost_all_last7_total,
              SUM(s2l_25ms_delay_sec_last7) AS s2l_25ms_delay_sec_last7_total,
              SUM(s2l_75ms_delay_sec_last7) AS s2l_75ms_delay_sec_last7_total,
              SUM(s2l_total_delay_sec_last7) AS s2l_total_delay_sec_last7_total,
              SUM(crash_cnt_last7) AS crash_cnt_last7_total,
              SUM(service_cnt_last7) AS service_cnt_last7_total,
              SUM(audio_freeze_time_200_last7) AS audio_freeze_time_200_last7_total,
              SUM(audio_totaltime_200_last7) AS audio_totaltime_200_last7_total,
              SUM(video_freeze_time_500) AS video_freeze_time_500_total,
              SUM(video_totaltime_500) AS video_totaltime_500_total,
              SUM(video_freeze_time_200) AS video_freeze_time_200_total,
              SUM(video_totaltime_200) AS video_totaltime_200_total,
              SUM(video_freeze_time_500_last1) AS video_freeze_time_500_last1_total,
              SUM(video_totaltime_500_last1) AS video_totaltime_500_last1_total,
              SUM(video_freeze_time_200_last1) AS video_freeze_time_200_last1_total,
              SUM(video_totaltime_200_last1) AS video_totaltime_200_last1_total,
              SUM(video_freeze_time_500_last7) AS video_freeze_time_500_last7_total,
              SUM(video_totaltime_500_last7) AS video_totaltime_500_last7_total,
              SUM(video_freeze_time_200_last7) AS video_freeze_time_200_last7_total,
              SUM(video_totaltime_200_last7) AS video_totaltime_200_last7_total,
              SUM(s2l_lost_Leq5) AS s2l_lost_Leq5_total,
              SUM(s2l_lost_all) AS s2l_lost_all_total,
              SUM(s2l_lost_Leq5_last1) AS s2l_lost_Leq5_last1_total,
              SUM(s2l_lost_all_last1) AS s2l_lost_all_last1_total,
              SUM(s2l_lost_Leq5_last7) AS s2l_lost_Leq5_last7_total,
              SUM(s2l_lost_all_last7) AS s2l_lost_all_last7_total
            FROM report_datahub.vid_osver_net_cp_domain_quality_di_1
            WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-21') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-11-21') AND CAST(vid AS VARCHAR) = CAST(281104 AS VARCHAR) AND CAST(product_level_2 AS VARCHAR) = 'Native'
            GROUP BY vid,
              date) AS tt ON CAST(ts.vid AS VARCHAR) = CAST(tt.vid AS VARCHAR) AND ts.date = tt.date) AS ""自定义 SQL 查询""
    HAVING COUNT(1) > 0) AS ""t0""
WHERE (""自定义 SQL 查询"".""ver_type"" IN ('主版本', '教育特殊版', '教育稳定版', '老主版本', '老教育稳定版') OR ( (  ""自定义 SQL 查询"".""ver_type""  ) is null)) AND CAST(""自定义 SQL 查询"".""dim"" AS VARCHAR) = 'osver' AND NOT ( (  ""自定义 SQL 查询"".""vid""  ) is null) AND DATE_ADD('SECOND', 0, date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d')) = DATE_ADD('SECOND', 0, ""t0"".""__measure__0"")
GROUP BY 26"
"SELECT ""自定义 SQL 查询"".""product_type"" AS ""product_type""
FROM (SELECT date,
      src_domain AS ""srcDomain"",
      delay_25 AS ""p2s_Delay25"",
      delay_50 AS ""p2s_Delay50"",
      delay_75 AS ""p2s_Delay75"",
      delay_100 AS ""p2s_Delay100"",
      delay_125 AS ""p2s_Delay125"",
      delay_150 AS ""p2s_Delay150"",
      delay_total,
      lost_ratio_5 AS ""p2s_lostRatio"",
      lostratio_total AS ""p2s_total"",
      jitter95_50 AS ""p2s_jitter95_50"",
      jitter95_100 AS ""p2s_jitter95_100"",
      jitter95_200 AS ""p2s_jitter95_200"",
      jitter95_300 AS ""p2s_jitter95_300"",
      jitter95_total,
      product_line,
      product_type
    FROM media.p2s_cover_domain
    WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-25') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-01')) AS ""自定义 SQL 查询""
GROUP BY 1
ORDER BY ""product_type"""
"select query from system.runtime.queries where created >= TIMESTAMP '2021-12-05 16:00:00.000 UTC' and query not like 'explain%' and query not like '%system.runtime%' order by created desc limit 10"
"SELECT SUM(""自定义 SQL 查询"".""host_4k"") AS ""TEMP(Calculation_3519281700079370244)(1075454865)(0)"",
  SUM(""自定义 SQL 查询"".""audience_sd"") AS ""TEMP(Calculation_3519281700079370244)(1133678835)(0)"",
  SUM(""自定义 SQL 查询"".""host_1080p"") AS ""TEMP(Calculation_3519281700079370244)(1312501967)(0)"",
  SUM(""自定义 SQL 查询"".""host_hd"") AS ""TEMP(Calculation_3519281700079370244)(276907208)(0)"",
  SUM(""自定义 SQL 查询"".""video"") AS ""TEMP(Calculation_3519281700079370244)(2929708110)(0)"",
  SUM(""自定义 SQL 查询"".""audience_hd"") AS ""TEMP(Calculation_3519281700079370244)(2930728935)(0)"",
  SUM(""自定义 SQL 查询"".""audience_hdp"") AS ""TEMP(Calculation_3519281700079370244)(3010533957)(0)"",
  SUM(""自定义 SQL 查询"".""host_hdp"") AS ""TEMP(Calculation_3519281700079370244)(30306054)(0)"",
  SUM(""自定义 SQL 查询"".""host_audio"") AS ""TEMP(Calculation_3519281700079370244)(3087054365)(0)"",
  SUM(""自定义 SQL 查询"".""audio"") AS ""TEMP(Calculation_3519281700079370244)(3299350010)(0)"",
  SUM(""自定义 SQL 查询"".""audience_1080p"") AS ""TEMP(Calculation_3519281700079370244)(3628946582)(0)"",
  SUM(""自定义 SQL 查询"".""totalUsage"") AS ""TEMP(Calculation_3519281700079370244)(3847882359)(0)"",
  SUM(""自定义 SQL 查询"".""audience_audio"") AS ""TEMP(Calculation_3519281700079370244)(4109514392)(0)"",
  SUM(""自定义 SQL 查询"".""host_2k"") AS ""TEMP(Calculation_3519281700079370244)(586790827)(0)"",
  SUM(""自定义 SQL 查询"".""host_sd"") AS ""TEMP(Calculation_3519281700079370244)(709512178)(0)"",
  SUM(""自定义 SQL 查询"".""audience_4k"") AS ""TEMP(Calculation_3519281700079370244)(764410224)(0)"",
  SUM(""自定义 SQL 查询"".""audience_2k"") AS ""TEMP(Calculation_3519281700079370244)(943764407)(0)"",
  MAX(""自定义 SQL 查询"".""rank_level1"") AS ""TEMP(attr_rank_level1_qk)(289677037)(0)"",
  MIN(""自定义 SQL 查询"".""rank_level1"") AS ""TEMP(attr_rank_level1_qk)(992764851)(0)"",
  ""自定义 SQL 查询"".""level1"" AS ""level1"",
  ""自定义 SQL 查询"".""stat_date"" AS ""stat_date"",
  SUM(""自定义 SQL 查询"".""totalUsage"") AS ""sum_totalUsage_ok""
FROM (SELECT date,
        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,
      start_date AS start_date_7,
      end_date AS end_date,
      tag,
      area AS Scope,
      dim,
        CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,
      level2,
      level3,
      level4,
      product_level1 AS product_line,
      product_level2,
      product_level3,
      product_level4,
      vid_internal_industry_en AS cid_industry,
      vid_use_case_en AS vid_use_case_cn,
      vid_sector_en,
      ver_type,
      ver,
      os,
      domain,
      country,
      region,
      dim_grouping_name,
        CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,
      total AS totalUsage,
      audio,
      video,
      host_audio,
      audience_audio,
      host_sd,
      host_hd,
      host_hdp,
      host_1080p,
      host_2k,
      host_4k,
      audience_sd,
      audience_hd,
      audience_hdp,
      audience_1080p,
      audience_2k,
      audience_4k,
      audience_audio_low_latency,
      audience_sd_low_latency,
      audience_hd_low_latency,
      audience_hdp_low_latency,
      audience_1080p_low_latency,
      audience_2k_low_latency,
      audience_4k_low_latency,
      audience_audio_ultra_low_latency,
      audience_sd_ultra_low_latency,
      audience_hd_ultra_low_latency,
      audience_hdp_ultra_low_latency,
      audience_1080p_ultra_low_latency,
      audience_2k_ultra_low_latency,
      audience_4k_ultra_low_latency,
      total_last1 AS audio_video_last,
      audio_last1 AS audio_last,
      video_last1 AS video_last,
      video_sd_last1 AS video_sd_last,
      video_hd_last1 AS video_hd_last,
      video_hdp_last1 AS video_hdp_last,
      host_sd_last1 AS host_video_sd_last,
      audience_sd_last1 AS audience_video_sd_last,
      host_hd_last1 AS host_video_hd_last,
      audience_hd_last1 AS audience_video_hd_last,
      host_hdp_last1 AS host_video_hdp_last,
      audience_hdp_last1 AS audience_video_hdp_last,
      host_audio_last1 AS host_audio_last,
      audience_audio_last1 AS audience_audio_last,
      host_video_last1 AS host_video_last,
      audience_video_last1 AS audience_video_last,
      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,
      audience_video_low_latency_last1 AS audience_video_low_latency_last,
      audience_total_low_latency_last1 AS audience_total_low_latency_last,
      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,
      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,
      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,
      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,
      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,
      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,
      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,
      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,
      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,
      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,
      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,
      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,
      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,
      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,
      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,
      audience_2k_last1 AS audience_2k_last,
      audience_4k_last1 AS audience_4k_last,
      audience_1080p_last1 AS audience_1080p_last,
      host_1080p_last1 AS host_1080p_last,
      host_2k_last1 AS host_2k_last,
      host_4k_last1 AS host_4k_last,
      total_last7,
      audio_last7,
      video_last7,
      video_sd_last7,
      video_hd_last7,
      video_hdp_last7,
      host_sd_last7,
      audience_sd_last7,
      host_hd_last7,
      audience_hd_last7,
      host_hdp_last7,
      audience_hdp_last7,
      host_audio_last7,
      audience_audio_last7,
      host_video_last7,
      audience_video_last7,
      audience_audio_low_latency_last7,
      audience_video_low_latency_last7,
      audience_total_low_latency_last7,
      audience_sd_low_latency_last7,
      audience_hd_low_latency_last7,
      audience_hdp_low_latency_last7,
      audience_1080p_low_latency_last7,
      audience_2k_low_latency_last7,
      audience_4k_low_latency_last7,
      audience_audio_ultra_low_latency_last7,
      audience_video_ultra_low_latency_last7,
      audience_total_ultra_low_latency_last7,
      audience_sd_ultra_low_latency_last7,
      audience_hd_ultra_low_latency_last7,
      audience_hdp_ultra_low_latency_last7,
      audience_1080p_ultra_low_latency_last7,
      audience_2k_ultra_low_latency_last7,
      audience_4k_ultra_low_latency_last7,
      audience_2k_last7,
      audience_4k_last7,
      audience_1080p_last7,
      host_1080p_last7,
      host_2k_last7,
      host_4k_last7
    FROM levels_usage_dod_di_1
    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-06') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-04') AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS ""自定义 SQL 查询""
  CROSS JOIN (SELECT MAX(date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d')) AS ""__measure__0""
    FROM (SELECT date,
            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,
          start_date AS start_date_7,
          end_date AS end_date,
          tag,
          area AS Scope,
          dim,
            CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,
          level2,
          level3,
          level4,
          product_level1 AS product_line,
          product_level2,
          product_level3,
          product_level4,
          vid_internal_industry_en AS cid_industry,
          vid_use_case_en AS vid_use_case_cn,
          vid_sector_en,
          ver_type,
          ver,
          os,
          domain,
          country,
          region,
          dim_grouping_name,
            CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,
          total AS totalUsage,
          audio,
          video,
          host_audio,
          audience_audio,
          host_sd,
          host_hd,
          host_hdp,
          host_1080p,
          host_2k,
          host_4k,
          audience_sd,
          audience_hd,
          audience_hdp,
          audience_1080p,
          audience_2k,
          audience_4k,
          audience_audio_low_latency,
          audience_sd_low_latency,
          audience_hd_low_latency,
          audience_hdp_low_latency,
          audience_1080p_low_latency,
          audience_2k_low_latency,
          audience_4k_low_latency,
          audience_audio_ultra_low_latency,
          audience_sd_ultra_low_latency,
          audience_hd_ultra_low_latency,
          audience_hdp_ultra_low_latency,
          audience_1080p_ultra_low_latency,
          audience_2k_ultra_low_latency,
          audience_4k_ultra_low_latency,
          total_last1 AS audio_video_last,
          audio_last1 AS audio_last,
          video_last1 AS video_last,
          video_sd_last1 AS video_sd_last,
          video_hd_last1 AS video_hd_last,
          video_hdp_last1 AS video_hdp_last,
          host_sd_last1 AS host_video_sd_last,
          audience_sd_last1 AS audience_video_sd_last,
          host_hd_last1 AS host_video_hd_last,
          audience_hd_last1 AS audience_video_hd_last,
          host_hdp_last1 AS host_video_hdp_last,
          audience_hdp_last1 AS audience_video_hdp_last,
          host_audio_last1 AS host_audio_last,
          audience_audio_last1 AS audience_audio_last,
          host_video_last1 AS host_video_last,
          audience_video_last1 AS audience_video_last,
          audience_audio_low_latency_last1 AS audience_audio_low_latency_last,
          audience_video_low_latency_last1 AS audience_video_low_latency_last,
          audience_total_low_latency_last1 AS audience_total_low_latency_last,
          audience_sd_low_latency_last1 AS audience_sd_low_latency_last,
          audience_hd_low_latency_last1 AS audience_hd_low_latency_last,
          audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,
          audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,
          audience_2k_low_latency_last1 AS audience_2k_low_latency_last,
          audience_4k_low_latency_last1 AS audience_4k_low_latency_last,
          audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,
          audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,
          audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,
          audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,
          audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,
          audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,
          audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,
          audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,
          audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,
          audience_2k_last1 AS audience_2k_last,
          audience_4k_last1 AS audience_4k_last,
          audience_1080p_last1 AS audience_1080p_last,
          host_1080p_last1 AS host_1080p_last,
          host_2k_last1 AS host_2k_last,
          host_4k_last1 AS host_4k_last,
          total_last7,
          audio_last7,
          video_last7,
          video_sd_last7,
          video_hd_last7,
          video_hdp_last7,
          host_sd_last7,
          audience_sd_last7,
          host_hd_last7,
          audience_hd_last7,
          host_hdp_last7,
          audience_hdp_last7,
          host_audio_last7,
          audience_audio_last7,
          host_video_last7,
          audience_video_last7,
          audience_audio_low_latency_last7,
          audience_video_low_latency_last7,
          audience_total_low_latency_last7,
          audience_sd_low_latency_last7,
          audience_hd_low_latency_last7,
          audience_hdp_low_latency_last7,
          audience_1080p_low_latency_last7,
          audience_2k_low_latency_last7,
          audience_4k_low_latency_last7,
          audience_audio_ultra_low_latency_last7,
          audience_video_ultra_low_latency_last7,
          audience_total_ultra_low_latency_last7,
          audience_sd_ultra_low_latency_last7,
          audience_hd_ultra_low_latency_last7,
          audience_hdp_ultra_low_latency_last7,
          audience_1080p_ultra_low_latency_last7,
          audience_2k_ultra_low_latency_last7,
          audience_4k_ultra_low_latency_last7,
          audience_2k_last7,
          audience_4k_last7,
          audience_1080p_last7,
          host_1080p_last7,
          host_2k_last7,
          host_4k_last7
        FROM levels_usage_dod_di_1
        WHERE CAST(tag AS VARCHAR) = 'Industry' AND date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-06') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-04') AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS ""自定义 SQL 查询""
    HAVING COUNT(1) > 0) AS ""t0""
WHERE date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d') = ""t0"".""__measure__0""
GROUP BY 20,
  21"
"SELECT ""自定义 SQL 查询"".""srcRegion"" AS ""srcRegion""
FROM (SELECT date AS ""date"",
      src_domain AS ""srcDomain"",
      src_region AS ""srcRegion"",
      dest_idc AS ""idc"",
      delay_25 AS ""p2s_Delay25"",
      delay_50 AS ""p2s_Delay50"",
      delay_75 AS ""p2s_Delay75"",
      delay_100 AS ""p2s_Delay100"",
      delay_125 AS ""p2s_Delay125"",
      delay_150 AS ""p2s_Delay150"",
      delay_total,
      lost_ratio_5 AS ""p2s_lostRatio"",
      lostratio_total AS ""p2s_total"",
      jitter95_50 AS ""p2s_jitter95_50"",
      jitter95_100 AS ""p2s_jitter95_100"",
      jitter95_200 AS ""p2s_jitter95_200"",
      jitter95_300 AS ""p2s_jitter95_300"",
      jitter95_total,
      product_line,
      product_type
    FROM media.p2s_cover_mainland_ip
    WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-25') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-01')) AS ""自定义 SQL 查询""
WHERE CAST(""自定义 SQL 查询"".""srcRegion"" AS VARCHAR) >= 'Anhui' AND CAST(""自定义 SQL 查询"".""srcRegion"" AS VARCHAR) <= 'Zhejiang'
GROUP BY 1
ORDER BY ""srcRegion"""
"SELECT SUM(""自定义 SQL 查询"".""p2s_Delay25"" * ""自定义 SQL 查询"".""delay_total"") AS ""TEMP(Calculation_1122874106500857864)(1563607262)(0)"",
  SUM(""自定义 SQL 查询"".""delay_total"") AS ""TEMP(Calculation_1122874106500857864)(363980608)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_Delay50"" * ""自定义 SQL 查询"".""delay_total"") AS ""TEMP(Calculation_1122874106501021705)(1551638771)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_Delay75"" * ""自定义 SQL 查询"".""delay_total"") AS ""TEMP(Calculation_1122874106501136394)(2562427304)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_lostRatio"" * ""自定义 SQL 查询"".""p2s_total"") AS ""TEMP(Calculation_1122874106501275659)(1741181994)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_total"") AS ""TEMP(Calculation_1122874106501275659)(2624355999)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_Delay100"" * ""自定义 SQL 查询"".""delay_total"") AS ""TEMP(Calculation_4208191644268068870)(4273621395)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_Delay125"" * ""自定义 SQL 查询"".""delay_total"") AS ""TEMP(Calculation_4208191644269584391)(3242688810)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_Delay150"" * ""自定义 SQL 查询"".""delay_total"") AS ""TEMP(Calculation_4208191644269871112)(1276673441)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_jitter95_50"" * ""自定义 SQL 查询"".""jitter95_total"") AS ""TEMP(Calculation_4208191644275204106)(1652714847)(0)"",
  SUM(""自定义 SQL 查询"".""jitter95_total"") AS ""TEMP(Calculation_4208191644275204106)(633698484)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_jitter95_100"" * ""自定义 SQL 查询"".""jitter95_total"") AS ""TEMP(Calculation_4208191644276129803)(3609783325)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_jitter95_200"" * ""自定义 SQL 查询"".""jitter95_total"") AS ""TEMP(Calculation_4208191644276916236)(206867949)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_jitter95_300"" * ""自定义 SQL 查询"".""jitter95_total"") AS ""TEMP(Calculation_4208191644277432333)(401523338)(0)"",
  ""自定义 SQL 查询"".""srcCountry"" AS ""srcCountry""
FROM (SELECT date AS ""date"",
      src_domain AS ""srcDomain"",
      src_country AS ""srcCountry"",
      dest_idc AS ""idc"",
      delay_25 AS ""p2s_Delay25"",
      delay_50 AS ""p2s_Delay50"",
      delay_75 AS ""p2s_Delay75"",
      delay_100 AS ""p2s_Delay100"",
      delay_125 AS ""p2s_Delay125"",
      delay_150 AS ""p2s_Delay150"",
      delay_total,
      lost_ratio_5 AS ""p2s_lostRatio"",
      lostratio_total AS ""p2s_total"",
      jitter95_50 AS ""p2s_jitter95_50"",
      jitter95_100 AS ""p2s_jitter95_100"",
      jitter95_200 AS ""p2s_jitter95_200"",
      jitter95_300 AS ""p2s_jitter95_300"",
      jitter95_total,
      product_line,
      product_type
    FROM media.p2s_cover_oversea_idc
    WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-25') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-01')) AS ""自定义 SQL 查询""
WHERE ""自定义 SQL 查询"".""srcCountry"" NOT IN ('Falkland Islands', 'British Indian Ocean Territory', 'Montserrat', 'North Korea', 'Tuvalu', 'Niue') AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'aofei-frankfurt1g' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'zhuzhou1g-ctel'
GROUP BY 15
HAVING CAST(CASE WHEN SUM(""自定义 SQL 查询"".""p2s_total"") >= 0 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100 THEN '0-100' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 1000 THEN '100-1000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 1000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 10000 THEN '1000-10000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 10000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100000 THEN '10000-100000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100000 THEN '100000以上' ELSE 'other' END AS VARCHAR) = '100-1000' OR CAST(CASE WHEN SUM(""自定义 SQL 查询"".""p2s_total"") >= 0 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100 THEN '0-100' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 1000 THEN '100-1000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 1000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 10000 THEN '1000-10000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 10000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100000 THEN '10000-100000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100000 THEN '100000以上' ELSE 'other' END AS VARCHAR) = '1000-10000' OR CAST(CASE WHEN SUM(""自定义 SQL 查询"".""p2s_total"") >= 0 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100 THEN '0-100' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 1000 THEN '100-1000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 1000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 10000 THEN '1000-10000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 10000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100000 THEN '10000-100000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100000 THEN '100000以上' ELSE 'other' END AS VARCHAR) = '10000-100000' OR CAST(CASE WHEN SUM(""自定义 SQL 查询"".""p2s_total"") >= 0 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100 THEN '0-100' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 1000 THEN '100-1000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 1000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 10000 THEN '1000-10000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 10000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100000 THEN '10000-100000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100000 THEN '100000以上' ELSE 'other' END AS VARCHAR) = '100000以上'"
"SELECT MAX(""自定义 SQL 查询"".""period"") AS ""usr_Calculation_6733444459377328128_nk""
FROM (SELECT date,
        CASE WHEN CAST(stat_period AS VARCHAR) = 'day' THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(substr(CAST(start_date AS VARCHAR), 1, 10) AS VARCHAR), '~', CAST(substr(CAST(end_date AS VARCHAR), 1, 10) AS VARCHAR)) END AS period,
      start_date,
      end_date,
      stat_period,
      tag,
      dim,
      level1,
      level2,
      level3,
      level4,
      '' AS pd,
      os,
      ver,
      ver_type,
      '' AS product_line,
      '' AS product_type,
      domain,
      country,
      region,
      net,
      vid,
      project,
      company_id,
      company_name,
      rowsnum,
      lastusage,
      thisusage,
      fiveSecJoinSuccess,
      totalJoin,
      cnt_sid,
      video_freeze_time,
      video_totaltime,
      audio_freeze_time,
      audio_totaltime,
      s2l_total_delay_sec,
      s2l_25ms_delay_sec,
      s2l_75ms_delay_sec,
      p2s_lost_Leq5,
      p2s_lost_all,
      crash_cnt,
      service_cnt,
      ""1s_succ_join_ap_cnt"",
      ""5s_succ_join_ap_cnt"",
      total_join_ap_cnt,
      totalJoinSuccess,
      threeSecJoinSuccess,
      video_freeze_time_200,
      video_totaltime_200,
      video_freeze_time_500,
      video_totaltime_500,
      ""3s_succ_join_session_cnt_last1"",
      ""5s_succ_join_session_cnt_last1"",
      succ_join_session_cnt_last1,
      total_join_session_cnt_last1,
      total_session_cnt_last1,
      ""1s_succ_join_ap_cnt_last1"",
      ""5s_succ_join_ap_cnt_last1"",
      total_join_ap_cnt_last1,
      ""3s_succ_join_session_cnt_last7"",
      ""5s_succ_join_session_cnt_last7"",
      succ_join_session_cnt_last7,
      total_join_session_cnt_last7,
      total_session_cnt_last7,
      ""1s_succ_join_ap_cnt_last7"",
      ""5s_succ_join_ap_cnt_last7"",
      total_join_ap_cnt_last7,
      video_freeze_time_last1,
      video_totaltime_last1,
      video_freeze_time_500_last1,
      video_totaltime_500_last1,
      video_freeze_time_200_last1,
      video_totaltime_200_last1,
      video_freeze_time_last7,
      video_totaltime_last7,
      video_freeze_time_500_last7,
      video_totaltime_500_last7,
      video_freeze_time_200_last7,
      video_totaltime_200_last7,
      audio_freeze_time_last1,
      audio_totaltime_last1,
      audio_freeze_time_last7,
      audio_totaltime_last7,
      s2l_total_delay_sec_last1,
      s2l_25ms_delay_sec_last1,
      s2l_75ms_delay_sec_last1,
      s2l_total_delay_sec_last7,
      s2l_25ms_delay_sec_last7,
      s2l_75ms_delay_sec_last7,
      p2s_lost_Leq5_last1,
      p2s_lost_all_last1,
      p2s_lost_Leq5_last7,
      p2s_lost_all_last7,
      crash_cnt_last1,
      service_cnt_last1,
      crash_cnt_last7,
      service_cnt_last7,
      product_level1,
      product_level2,
      product_level3,
      product_level4,
      s2l_lost_Leq5,
      s2l_lost_all,
      s2l_lost_Leq5_last1,
      s2l_lost_all_last1,
      s2l_lost_Leq5_last7,
      s2l_lost_all_last7
    FROM report_datahub.pub_levels_quality_di_1
    WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-21') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-11-21')) AS ""自定义 SQL 查询""
  CROSS JOIN (SELECT MAX(date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d')) AS ""__measure__0""
    FROM (SELECT date,
            CASE WHEN CAST(stat_period AS VARCHAR) = 'day' THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(substr(CAST(start_date AS VARCHAR), 1, 10) AS VARCHAR), '~', CAST(substr(CAST(end_date AS VARCHAR), 1, 10) AS VARCHAR)) END AS period,
          start_date,
          end_date,
          stat_period,
          tag,
          dim,
          level1,
          level2,
          level3,
          level4,
          '' AS pd,
          os,
          ver,
          ver_type,
          '' AS product_line,
          '' AS product_type,
          domain,
          country,
          region,
          net,
          vid,
          project,
          company_id,
          company_name,
          rowsnum,
          lastusage,
          thisusage,
          fiveSecJoinSuccess,
          totalJoin,
          cnt_sid,
          video_freeze_time,
          video_totaltime,
          audio_freeze_time,
          audio_totaltime,
          s2l_total_delay_sec,
          s2l_25ms_delay_sec,
          s2l_75ms_delay_sec,
          p2s_lost_Leq5,
          p2s_lost_all,
          crash_cnt,
          service_cnt,
          ""1s_succ_join_ap_cnt"",
          ""5s_succ_join_ap_cnt"",
          total_join_ap_cnt,
          totalJoinSuccess,
          threeSecJoinSuccess,
          video_freeze_time_200,
          video_totaltime_200,
          video_freeze_time_500,
          video_totaltime_500,
          ""3s_succ_join_session_cnt_last1"",
          ""5s_succ_join_session_cnt_last1"",
          succ_join_session_cnt_last1,
          total_join_session_cnt_last1,
          total_session_cnt_last1,
          ""1s_succ_join_ap_cnt_last1"",
          ""5s_succ_join_ap_cnt_last1"",
          total_join_ap_cnt_last1,
          ""3s_succ_join_session_cnt_last7"",
          ""5s_succ_join_session_cnt_last7"",
          succ_join_session_cnt_last7,
          total_join_session_cnt_last7,
          total_session_cnt_last7,
          ""1s_succ_join_ap_cnt_last7"",
          ""5s_succ_join_ap_cnt_last7"",
          total_join_ap_cnt_last7,
          video_freeze_time_last1,
          video_totaltime_last1,
          video_freeze_time_500_last1,
          video_totaltime_500_last1,
          video_freeze_time_200_last1,
          video_totaltime_200_last1,
          video_freeze_time_last7,
          video_totaltime_last7,
          video_freeze_time_500_last7,
          video_totaltime_500_last7,
          video_freeze_time_200_last7,
          video_totaltime_200_last7,
          audio_freeze_time_last1,
          audio_totaltime_last1,
          audio_freeze_time_last7,
          audio_totaltime_last7,
          s2l_total_delay_sec_last1,
          s2l_25ms_delay_sec_last1,
          s2l_75ms_delay_sec_last1,
          s2l_total_delay_sec_last7,
          s2l_25ms_delay_sec_last7,
          s2l_75ms_delay_sec_last7,
          p2s_lost_Leq5_last1,
          p2s_lost_all_last1,
          p2s_lost_Leq5_last7,
          p2s_lost_all_last7,
          crash_cnt_last1,
          service_cnt_last1,
          crash_cnt_last7,
          service_cnt_last7,
          product_level1,
          product_level2,
          product_level3,
          product_level4,
          s2l_lost_Leq5,
          s2l_lost_all,
          s2l_lost_Leq5_last1,
          s2l_lost_all_last1,
          s2l_lost_Leq5_last7,
          s2l_lost_all_last7
        FROM report_datahub.pub_levels_quality_di_1
        WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-21') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-11-21')) AS ""自定义 SQL 查询""
    HAVING COUNT(1) > 0) AS ""t0""
WHERE DATE_ADD('SECOND', 0, date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d')) = DATE_ADD('SECOND', 0, ""t0"".""__measure__0"")
HAVING COUNT(1) > 0"
"SELECT SUM(""自定义 SQL 查询"".""delay25"") AS ""TEMP(Calculation_3094043381461364736)(3362377732)(0)"",
  SUM(""自定义 SQL 查询"".""delay_total"") AS ""TEMP(Calculation_3094043381461364736)(363980608)(0)"",
  SUM(""自定义 SQL 查询"".""delay75"") AS ""TEMP(Calculation_3094043381461454849)(2419700853)(0)"",
  SUM(""自定义 SQL 查询"".""lost_ratio_5"") AS ""TEMP(Calculation_3094043381461549058)(1479243093)(0)"",
  SUM(""自定义 SQL 查询"".""lost_total"") AS ""TEMP(Calculation_3094043381461549058)(154362899)(0)"",
  ""自定义 SQL 查询"".""country"" AS ""country"",
  ""自定义 SQL 查询"".""speaker_vos_idc"" AS ""speaker_vos_idc"",
  SUM(""自定义 SQL 查询"".""delay_total"") AS ""sum_delay_total_ok""
FROM (SELECT *
    FROM media.sdrtn_okr_notvpn
    WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-16') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-11-29')) AS ""自定义 SQL 查询""
WHERE CASE WHEN CAST(""自定义 SQL 查询"".""country"" AS VARCHAR) = 'Brazil' AND CAST(""自定义 SQL 查询"".""speaker_vos_idc"" AS VARCHAR) = 'zen-saopaulo2' OR CAST(""自定义 SQL 查询"".""country"" AS VARCHAR) = 'Philippines' AND CAST(""自定义 SQL 查询"".""speaker_vos_idc"" AS VARCHAR) = 'zen-manila9p' OR CAST(""自定义 SQL 查询"".""country"" AS VARCHAR) = 'United Arab Emirates' AND CAST(""自定义 SQL 查询"".""speaker_vos_idc"" AS VARCHAR) = 'zen-fujairah' OR CAST(""自定义 SQL 查询"".""country"" AS VARCHAR) = 'Saudi Arabia' AND CAST(""自定义 SQL 查询"".""speaker_vos_idc"" AS VARCHAR) = 'kaopuyun-saudi' OR CAST(""自定义 SQL 查询"".""country"" AS VARCHAR) = 'Turkey' AND CAST(""自定义 SQL 查询"".""speaker_vos_idc"" AS VARCHAR) = 'zen-istanbul' OR CAST(""自定义 SQL 查询"".""country"" AS VARCHAR) = 'Indonesia' AND CAST(""自定义 SQL 查询"".""speaker_vos_idc"" AS VARCHAR) = 'zen-jakarta1a' THEN 1 ELSE 0 END
GROUP BY 6,
  7"
"SELECT ""自定义 SQL 查询"".""product_level2"" AS ""product_level2""
FROM (SELECT date,
      SUBSTR(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) AS date_range_1,
      SUBSTR(CAST(end_date AS VARCHAR), 1, 10) AS date_range_2,
      stat_period,
        CASE WHEN CAST(stat_period AS VARCHAR) = 'day' THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,
      area,
      vid,
      project,
      company_id AS cid,
      company_name AS company,
      customer_level AS level,
      vid_internal_industry_en AS industry,
      vid_use_case_cn,
      csdc_owner,
      os,
      ver,
      ver_type,
      product_level1,
      product_level2,
      product_level3,
      total,
      audio,
      video,
      video_sd,
      video_hd,
      video_hdp,
        host_audio + host_video AS host,
      host_audio,
      host_video,
      host_sd,
      host_hd,
      host_hdp,
        audience_audio + audience_video AS audience,
        audience_audio_low_latency + audience_video_low_latency AS audience_low_latency,
      audience_audio,
      audience_audio_low_latency,
      audience_video,
      audience_video_low_latency,
      audience_sd,
      audience_sd_low_latency,
      audience_hd,
      audience_hd_low_latency,
      audience_hdp,
      audience_hdp_low_latency,
      total_last1,
      audio_last1,
      video_last1,
      video_sd_last1,
      video_hd_last1,
      video_hdp_last1,
        host_audio_last1 + host_video_last1 AS host_last1,
      host_audio_last1,
      host_video_last1,
        audience_audio_last1 + audience_video_last1 AS audience_last1,
        audience_audio_low_latency_last1 + audience_video_low_latency_last1 AS audience_low_latency_last1,
      audience_audio_last1,
      audience_audio_low_latency_last1,
      audience_video_last1,
      audience_video_low_latency_last1,
      total_last7,
      audio_last7,
      video_last7,
      video_sd_last7,
      video_hd_last7,
      video_hdp_last7,
        host_audio_last7 + host_video_last7 AS host_last7,
      host_audio_last7,
      host_video_last7,
        audience_audio_last7 + audience_video_last7 AS audience_last7,
        audience_audio_low_latency_last7 + audience_video_low_latency_last7 AS audience_low_latency_last7,
      audience_audio_last7,
      audience_audio_low_latency_last7,
      audience_video_last7,
      audience_video_low_latency_last7
    FROM report_datahub.vendor_vid_usage_di_1
    WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-06') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-06') AND CAST(vid AS VARCHAR) = CAST(311291 AS VARCHAR) AND dim = 1) AS ""自定义 SQL 查询""
GROUP BY 1
ORDER BY ""product_level2"""
"SELECT ""自定义 SQL 查询"".""idc"" AS ""idc"",
  ""自定义 SQL 查询"".""srcRegion"" AS ""srcRegion"",
  SUM(""自定义 SQL 查询"".""p2s_total"") AS ""sum_p2s_total_ok""
FROM (SELECT date AS ""date"",
      src_domain AS ""srcDomain"",
      src_region AS ""srcRegion"",
      dest_idc AS ""idc"",
      src_isp,
      dest_ip,
      delay_25 AS ""p2s_Delay25"",
      delay_50 AS ""p2s_Delay50"",
      delay_75 AS ""p2s_Delay75"",
      delay_100 AS ""p2s_Delay100"",
      delay_125 AS ""p2s_Delay125"",
      delay_150 AS ""p2s_Delay150"",
      delay_total,
      lost_ratio_5 AS ""p2s_lostRatio"",
      lostratio_total AS ""p2s_total"",
      jitter95_50 AS ""p2s_jitter95_50"",
      jitter95_100 AS ""p2s_jitter95_100"",
      jitter95_200 AS ""p2s_jitter95_200"",
      jitter95_300 AS ""p2s_jitter95_300"",
      jitter95_total,
      product_line,
      product_type
    FROM media.p2s_cover_mainland_ip
    WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-25') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-01')) AS ""自定义 SQL 查询""
WHERE (""自定义 SQL 查询"".""idc"" IN ('aofei-hk1ga', 'aofei-singapore1ga', 'evc-singapore1ga', 'evc-singapore1gb', 'huhehaote1g-ctel', 'yancheng1g-ctel', 'zen-saopaulo2') OR ( (  ""自定义 SQL 查询"".""idc""  ) is null) OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'baoji1g-ctel' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'beijing8-bgp' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'changchun1g-cucc' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'changsha1g-cucc' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'changzhou9a-drpeng' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'eq-frankfurt1g' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'evc-chicago1g' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'evc-japan9a' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'foshan1g-ctel' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'huainan1g-cmcc' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'jinan1g-3line' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'jinan9-cmcc' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'jiujiang9-ctel' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'luoyang1g-ctel' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'nanchang1g-cmcc' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'taiyuan6bdbm-ctel' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'taiyuan9-cucc' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'wuxi3c-bgp' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'xiamen6bd-ctel' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'xuzhou9b-ctel' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'yancheng9-cmcc' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'zen-frankfurt1gb' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'zen-frankfurt9a' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'zen-japan9' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'zen-london1ga' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'zen-losangeles9' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'zen-melbourne9a' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'zen-mumbai9' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'zen-singapore1ga' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'zen-washington1ga' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'zhangjiakou1gb-cmcc' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'zhengzhou6bd-cucc' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'zhenjiang1g-3line' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'zhuzhou1g-ctel') AND CAST(""自定义 SQL 查询"".""srcRegion"" AS VARCHAR) >= 'Anhui' AND CAST(""自定义 SQL 查询"".""srcRegion"" AS VARCHAR) <= 'Zhejiang' AND (( (  ""自定义 SQL 查询"".""product_type""  ) is null) OR CAST(""自定义 SQL 查询"".""product_type"" AS VARCHAR) >= 'CloudPlayer' AND CAST(""自定义 SQL 查询"".""product_type"" AS VARCHAR) <= 'WebRTS')
GROUP BY 1,
  2
HAVING CASE WHEN SUM(""自定义 SQL 查询"".""p2s_total"") >= 0 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100 THEN 0 WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 1000 THEN 1 WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 1000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 10000 THEN 0 WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 10000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100000 THEN 0 WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100000 THEN 0 ELSE 0 END OR CASE WHEN SUM(""自定义 SQL 查询"".""p2s_total"") >= 0 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100 THEN 0 WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 1000 THEN 0 WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 1000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 10000 THEN 1 WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 10000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100000 THEN 0 WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100000 THEN 0 ELSE 0 END OR CASE WHEN SUM(""自定义 SQL 查询"".""p2s_total"") >= 0 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100 THEN 0 WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 1000 THEN 0 WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 1000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 10000 THEN 0 WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 10000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100000 THEN 1 WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100000 THEN 0 ELSE 0 END OR CASE WHEN SUM(""自定义 SQL 查询"".""p2s_total"") >= 0 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100 THEN 0 WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 1000 THEN 0 WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 1000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 10000 THEN 0 WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 10000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100000 THEN 0 WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100000 THEN 1 ELSE 0 END"
"SELECT MAX(""自定义 SQL 查询"".""period"") AS ""usr_Calculation_6733444459377328128_nk""
FROM (SELECT t1.date,
        CASE WHEN CAST(stat_period AS VARCHAR) = 'day' THEN substr(CAST(date_parse(cast( t1.date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(substr(CAST(start_date AS VARCHAR), 1, 10) AS VARCHAR), '~', CAST(substr(CAST(end_date AS VARCHAR), 1, 10) AS VARCHAR)) END AS period,
      start_date,
      end_date,
      stat_period,
      tag,
      t1.dim,
      level1,
      level2,
      level3,
      level4,
      os,
      ver,
      ver_type,
      domain,
      country,
      region,
      net,
      vid,
      project,
      company_id,
      company_name,
      rowsnum,
      lastusage,
      thisusage,
      fiveSecJoinSuccess,
      totalJoin,
      cnt_sid,
      video_freeze_time,
      video_totaltime,
      audio_freeze_time,
      audio_totaltime,
      s2l_total_delay_sec,
      s2l_25ms_delay_sec,
      s2l_75ms_delay_sec,
      p2s_lost_Leq5,
      p2s_lost_all,
      crash_cnt,
      service_cnt,
      ""1s_succ_join_ap_cnt"",
      ""5s_succ_join_ap_cnt"",
      total_join_ap_cnt,
      totalJoinSuccess,
      threeSecJoinSuccess,
      video_freeze_time_200,
      video_totaltime_200,
      video_freeze_time_500,
      video_totaltime_500,
      ""3s_succ_join_session_cnt_last1"",
      ""5s_succ_join_session_cnt_last1"",
      succ_join_session_cnt_last1,
      total_join_session_cnt_last1,
      total_session_cnt_last1,
      ""1s_succ_join_ap_cnt_last1"",
      ""5s_succ_join_ap_cnt_last1"",
      total_join_ap_cnt_last1,
      ""3s_succ_join_session_cnt_last7"",
      ""5s_succ_join_session_cnt_last7"",
      succ_join_session_cnt_last7,
      total_join_session_cnt_last7,
      total_session_cnt_last7,
      ""1s_succ_join_ap_cnt_last7"",
      ""5s_succ_join_ap_cnt_last7"",
      total_join_ap_cnt_last7,
      video_freeze_time_last1,
      video_totaltime_last1,
      video_freeze_time_500_last1,
      video_totaltime_500_last1,
      video_freeze_time_200_last1,
      video_totaltime_200_last1,
      video_freeze_time_last7,
      video_totaltime_last7,
      video_freeze_time_500_last7,
      video_totaltime_500_last7,
      video_freeze_time_200_last7,
      video_totaltime_200_last7,
      audio_freeze_time_last1,
      audio_totaltime_last1,
      audio_freeze_time_last7,
      audio_totaltime_last7,
      s2l_total_delay_sec_last1,
      s2l_25ms_delay_sec_last1,
      s2l_75ms_delay_sec_last1,
      s2l_total_delay_sec_last7,
      s2l_25ms_delay_sec_last7,
      s2l_75ms_delay_sec_last7,
      p2s_lost_Leq5_last1,
      p2s_lost_all_last1,
      p2s_lost_Leq5_last7,
      p2s_lost_all_last7,
      crash_cnt_last1,
      service_cnt_last1,
      crash_cnt_last7,
      service_cnt_last7,
      product_level1,
      product_level2,
      product_level3,
      product_level4,
      s2l_lost_Leq5,
      s2l_lost_all,
      s2l_lost_Leq5_last1,
      s2l_lost_all_last1,
      s2l_lost_Leq5_last7,
      s2l_lost_all_last7,
      fiveSecJoinSuccess_total,
      totalJoin_total,
      cnt_sid_total,
      video_freeze_time_total,
      video_totaltime_total,
      audio_freeze_time_total,
      audio_totaltime_total,
      s2l_total_delay_sec_total,
      s2l_25ms_delay_sec_total,
      s2l_75ms_delay_sec_total,
      p2s_lost_Leq5_total,
      p2s_lost_all_total,
      crash_cnt_total,
      service_cnt_total,
      ""1s_succ_join_ap_cnt_total"",
      ""5s_succ_join_ap_cnt_total"",
      total_join_ap_cnt_total,
      totalJoinSuccess_total,
      threeSecJoinSuccess_total,
      video_freeze_time_200_total,
      video_totaltime_200_total,
      video_freeze_time_500_total,
      video_totaltime_500_total,
      ""3s_succ_join_session_cnt_last1_total"",
      ""5s_succ_join_session_cnt_last1_total"",
      succ_join_session_cnt_last1_total,
      total_join_session_cnt_last1_total,
      total_session_cnt_last1_total,
      ""1s_succ_join_ap_cnt_last1_total"",
      ""5s_succ_join_ap_cnt_last1_total"",
      total_join_ap_cnt_last1_total,
      ""3s_succ_join_session_cnt_last7_total"",
      ""5s_succ_join_session_cnt_last7_total"",
      succ_join_session_cnt_last7_total,
      total_join_session_cnt_last7_total,
      total_session_cnt_last7_total,
      ""1s_succ_join_ap_cnt_last7_total"",
      ""5s_succ_join_ap_cnt_last7_total"",
      total_join_ap_cnt_last7_total,
      video_freeze_time_last1_total,
      video_totaltime_last1_total,
      video_freeze_time_500_last1_total,
      video_totaltime_500_last1_total,
      video_freeze_time_200_last1_total,
      video_totaltime_200_last1_total,
      video_freeze_time_last7_total,
      video_totaltime_last7_total,
      video_freeze_time_500_last7_total,
      video_totaltime_500_last7_total,
      video_freeze_time_200_last7_total,
      video_totaltime_200_last7_total,
      audio_freeze_time_last1_total,
      audio_totaltime_last1_total,
      audio_freeze_time_last7_total,
      audio_totaltime_last7_total,
      s2l_total_delay_sec_last1_total,
      s2l_25ms_delay_sec_last1_total,
      s2l_75ms_delay_sec_last1_total,
      s2l_total_delay_sec_last7_total,
      s2l_25ms_delay_sec_last7_total,
      s2l_75ms_delay_sec_last7_total,
      p2s_lost_Leq5_last1_total,
      p2s_lost_all_last1_total,
      p2s_lost_Leq5_last7_total,
      p2s_lost_all_last7_total,
      crash_cnt_last1_total,
      service_cnt_last1_total,
      crash_cnt_last7_total,
      service_cnt_last7_total,
      s2l_lost_Leq5_total,
      s2l_lost_all_total,
      s2l_lost_Leq5_last1_total,
      s2l_lost_all_last1_total,
      s2l_lost_Leq5_last7_total,
      s2l_lost_all_last7_total
    FROM report_datahub.pub_levels_quality_di_1 AS t1
      LEFT JOIN (SELECT date,
          dim,
          SUM(fiveSecJoinSuccess) AS fiveSecJoinSuccess_total,
          SUM(totalJoin) AS totalJoin_total,
          SUM(cnt_sid) AS cnt_sid_total,
          SUM(video_freeze_time) AS video_freeze_time_total,
          SUM(video_totaltime) AS video_totaltime_total,
          SUM(audio_freeze_time) AS audio_freeze_time_total,
          SUM(audio_totaltime) AS audio_totaltime_total,
          SUM(s2l_total_delay_sec) AS s2l_total_delay_sec_total,
          SUM(s2l_25ms_delay_sec) AS s2l_25ms_delay_sec_total,
          SUM(s2l_75ms_delay_sec) AS s2l_75ms_delay_sec_total,
          SUM(p2s_lost_Leq5) AS p2s_lost_Leq5_total,
          SUM(p2s_lost_all) AS p2s_lost_all_total,
          SUM(crash_cnt) AS crash_cnt_total,
          SUM(service_cnt) AS service_cnt_total,
          SUM(""1s_succ_join_ap_cnt"") AS ""1s_succ_join_ap_cnt_total"",
          SUM(""5s_succ_join_ap_cnt"") AS ""5s_succ_join_ap_cnt_total"",
          SUM(total_join_ap_cnt) AS total_join_ap_cnt_total,
          SUM(totalJoinSuccess) AS totalJoinSuccess_total,
          SUM(threeSecJoinSuccess) AS threeSecJoinSuccess_total,
          SUM(video_freeze_time_200) AS video_freeze_time_200_total,
          SUM(video_totaltime_200) AS video_totaltime_200_total,
          SUM(video_freeze_time_500) AS video_freeze_time_500_total,
          SUM(video_totaltime_500) AS video_totaltime_500_total,
          SUM(""3s_succ_join_session_cnt_last1"") AS ""3s_succ_join_session_cnt_last1_total"",
          SUM(""5s_succ_join_session_cnt_last1"") AS ""5s_succ_join_session_cnt_last1_total"",
          SUM(succ_join_session_cnt_last1) AS succ_join_session_cnt_last1_total,
          SUM(total_join_session_cnt_last1) AS total_join_session_cnt_last1_total,
          SUM(total_session_cnt_last1) AS total_session_cnt_last1_total,
          SUM(""1s_succ_join_ap_cnt_last1"") AS ""1s_succ_join_ap_cnt_last1_total"",
          SUM(""5s_succ_join_ap_cnt_last1"") AS ""5s_succ_join_ap_cnt_last1_total"",
          SUM(total_join_ap_cnt_last1) AS total_join_ap_cnt_last1_total,
          SUM(""3s_succ_join_session_cnt_last7"") AS ""3s_succ_join_session_cnt_last7_total"",
          SUM(""5s_succ_join_session_cnt_last7"") AS ""5s_succ_join_session_cnt_last7_total"",
          SUM(succ_join_session_cnt_last7) AS succ_join_session_cnt_last7_total,
          SUM(total_join_session_cnt_last7) AS total_join_session_cnt_last7_total,
          SUM(total_session_cnt_last7) AS total_session_cnt_last7_total,
          SUM(""1s_succ_join_ap_cnt_last7"") AS ""1s_succ_join_ap_cnt_last7_total"",
          SUM(""5s_succ_join_ap_cnt_last7"") AS ""5s_succ_join_ap_cnt_last7_total"",
          SUM(total_join_ap_cnt_last7) AS total_join_ap_cnt_last7_total,
          SUM(video_freeze_time_last1) AS video_freeze_time_last1_total,
          SUM(video_totaltime_last1) AS video_totaltime_last1_total,
          SUM(video_freeze_time_500_last1) AS video_freeze_time_500_last1_total,
          SUM(video_totaltime_500_last1) AS video_totaltime_500_last1_total,
          SUM(video_freeze_time_200_last1) AS video_freeze_time_200_last1_total,
          SUM(video_totaltime_200_last1) AS video_totaltime_200_last1_total,
          SUM(video_freeze_time_last7) AS video_freeze_time_last7_total,
          SUM(video_totaltime_last7) AS video_totaltime_last7_total,
          SUM(video_freeze_time_500_last7) AS video_freeze_time_500_last7_total,
          SUM(video_totaltime_500_last7) AS video_totaltime_500_last7_total,
          SUM(video_freeze_time_200_last7) AS video_freeze_time_200_last7_total,
          SUM(video_totaltime_200_last7) AS video_totaltime_200_last7_total,
          SUM(audio_freeze_time_last1) AS audio_freeze_time_last1_total,
          SUM(audio_totaltime_last1) AS audio_totaltime_last1_total,
          SUM(audio_freeze_time_last7) AS audio_freeze_time_last7_total,
          SUM(audio_totaltime_last7) AS audio_totaltime_last7_total,
          SUM(s2l_total_delay_sec_last1) AS s2l_total_delay_sec_last1_total,
          SUM(s2l_25ms_delay_sec_last1) AS s2l_25ms_delay_sec_last1_total,
          SUM(s2l_75ms_delay_sec_last1) AS s2l_75ms_delay_sec_last1_total,
          SUM(s2l_total_delay_sec_last7) AS s2l_total_delay_sec_last7_total,
          SUM(s2l_25ms_delay_sec_last7) AS s2l_25ms_delay_sec_last7_total,
          SUM(s2l_75ms_delay_sec_last7) AS s2l_75ms_delay_sec_last7_total,
          SUM(p2s_lost_Leq5_last1) AS p2s_lost_Leq5_last1_total,
          SUM(p2s_lost_all_last1) AS p2s_lost_all_last1_total,
          SUM(p2s_lost_Leq5_last7) AS p2s_lost_Leq5_last7_total,
          SUM(p2s_lost_all_last7) AS p2s_lost_all_last7_total,
          SUM(crash_cnt_last1) AS crash_cnt_last1_total,
          SUM(service_cnt_last1) AS service_cnt_last1_total,
          SUM(crash_cnt_last7) AS crash_cnt_last7_total,
          SUM(service_cnt_last7) AS service_cnt_last7_total,
          SUM(s2l_lost_Leq5) AS s2l_lost_Leq5_total,
          SUM(s2l_lost_all) AS s2l_lost_all_total,
          SUM(s2l_lost_Leq5_last1) AS s2l_lost_Leq5_last1_total,
          SUM(s2l_lost_all_last1) AS s2l_lost_all_last1_total,
          SUM(s2l_lost_Leq5_last7) AS s2l_lost_Leq5_last7_total,
          SUM(s2l_lost_all_last7) AS s2l_lost_all_last7_total
        FROM report_datahub.pub_levels_quality_di_1
        WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-21') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-11-21') AND CAST(tag AS VARCHAR) = 'Product'
        GROUP BY date,
          dim) AS t2 ON t1.date = t2.date AND t1.dim = t2.dim
    WHERE date_parse(cast( t1.date as VARCHAR), '%Y%m%d') >= DATE('2021-11-21') AND date_parse(cast( t1.date as VARCHAR), '%Y%m%d') <= DATE('2021-11-21') AND CAST(tag AS VARCHAR) = 'Product') AS ""自定义 SQL 查询""
  CROSS JOIN (SELECT MAX(date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d')) AS ""__measure__0""
    FROM (SELECT t1.date,
            CASE WHEN CAST(stat_period AS VARCHAR) = 'day' THEN substr(CAST(date_parse(cast( t1.date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(substr(CAST(start_date AS VARCHAR), 1, 10) AS VARCHAR), '~', CAST(substr(CAST(end_date AS VARCHAR), 1, 10) AS VARCHAR)) END AS period,
          start_date,
          end_date,
          stat_period,
          tag,
          t1.dim,
          level1,
          level2,
          level3,
          level4,
          os,
          ver,
          ver_type,
          domain,
          country,
          region,
          net,
          vid,
          project,
          company_id,
          company_name,
          rowsnum,
          lastusage,
          thisusage,
          fiveSecJoinSuccess,
          totalJoin,
          cnt_sid,
          video_freeze_time,
          video_totaltime,
          audio_freeze_time,
          audio_totaltime,
          s2l_total_delay_sec,
          s2l_25ms_delay_sec,
          s2l_75ms_delay_sec,
          p2s_lost_Leq5,
          p2s_lost_all,
          crash_cnt,
          service_cnt,
          ""1s_succ_join_ap_cnt"",
          ""5s_succ_join_ap_cnt"",
          total_join_ap_cnt,
          totalJoinSuccess,
          threeSecJoinSuccess,
          video_freeze_time_200,
          video_totaltime_200,
          video_freeze_time_500,
          video_totaltime_500,
          ""3s_succ_join_session_cnt_last1"",
          ""5s_succ_join_session_cnt_last1"",
          succ_join_session_cnt_last1,
          total_join_session_cnt_last1,
          total_session_cnt_last1,
          ""1s_succ_join_ap_cnt_last1"",
          ""5s_succ_join_ap_cnt_last1"",
          total_join_ap_cnt_last1,
          ""3s_succ_join_session_cnt_last7"",
          ""5s_succ_join_session_cnt_last7"",
          succ_join_session_cnt_last7,
          total_join_session_cnt_last7,
          total_session_cnt_last7,
          ""1s_succ_join_ap_cnt_last7"",
          ""5s_succ_join_ap_cnt_last7"",
          total_join_ap_cnt_last7,
          video_freeze_time_last1,
          video_totaltime_last1,
          video_freeze_time_500_last1,
          video_totaltime_500_last1,
          video_freeze_time_200_last1,
          video_totaltime_200_last1,
          video_freeze_time_last7,
          video_totaltime_last7,
          video_freeze_time_500_last7,
          video_totaltime_500_last7,
          video_freeze_time_200_last7,
          video_totaltime_200_last7,
          audio_freeze_time_last1,
          audio_totaltime_last1,
          audio_freeze_time_last7,
          audio_totaltime_last7,
          s2l_total_delay_sec_last1,
          s2l_25ms_delay_sec_last1,
          s2l_75ms_delay_sec_last1,
          s2l_total_delay_sec_last7,
          s2l_25ms_delay_sec_last7,
          s2l_75ms_delay_sec_last7,
          p2s_lost_Leq5_last1,
          p2s_lost_all_last1,
          p2s_lost_Leq5_last7,
          p2s_lost_all_last7,
          crash_cnt_last1,
          service_cnt_last1,
          crash_cnt_last7,
          service_cnt_last7,
          product_level1,
          product_level2,
          product_level3,
          product_level4,
          s2l_lost_Leq5,
          s2l_lost_all,
          s2l_lost_Leq5_last1,
          s2l_lost_all_last1,
          s2l_lost_Leq5_last7,
          s2l_lost_all_last7,
          fiveSecJoinSuccess_total,
          totalJoin_total,
          cnt_sid_total,
          video_freeze_time_total,
          video_totaltime_total,
          audio_freeze_time_total,
          audio_totaltime_total,
          s2l_total_delay_sec_total,
          s2l_25ms_delay_sec_total,
          s2l_75ms_delay_sec_total,
          p2s_lost_Leq5_total,
          p2s_lost_all_total,
          crash_cnt_total,
          service_cnt_total,
          ""1s_succ_join_ap_cnt_total"",
          ""5s_succ_join_ap_cnt_total"",
          total_join_ap_cnt_total,
          totalJoinSuccess_total,
          threeSecJoinSuccess_total,
          video_freeze_time_200_total,
          video_totaltime_200_total,
          video_freeze_time_500_total,
          video_totaltime_500_total,
          ""3s_succ_join_session_cnt_last1_total"",
          ""5s_succ_join_session_cnt_last1_total"",
          succ_join_session_cnt_last1_total,
          total_join_session_cnt_last1_total,
          total_session_cnt_last1_total,
          ""1s_succ_join_ap_cnt_last1_total"",
          ""5s_succ_join_ap_cnt_last1_total"",
          total_join_ap_cnt_last1_total,
          ""3s_succ_join_session_cnt_last7_total"",
          ""5s_succ_join_session_cnt_last7_total"",
          succ_join_session_cnt_last7_total,
          total_join_session_cnt_last7_total,
          total_session_cnt_last7_total,
          ""1s_succ_join_ap_cnt_last7_total"",
          ""5s_succ_join_ap_cnt_last7_total"",
          total_join_ap_cnt_last7_total,
          video_freeze_time_last1_total,
          video_totaltime_last1_total,
          video_freeze_time_500_last1_total,
          video_totaltime_500_last1_total,
          video_freeze_time_200_last1_total,
          video_totaltime_200_last1_total,
          video_freeze_time_last7_total,
          video_totaltime_last7_total,
          video_freeze_time_500_last7_total,
          video_totaltime_500_last7_total,
          video_freeze_time_200_last7_total,
          video_totaltime_200_last7_total,
          audio_freeze_time_last1_total,
          audio_totaltime_last1_total,
          audio_freeze_time_last7_total,
          audio_totaltime_last7_total,
          s2l_total_delay_sec_last1_total,
          s2l_25ms_delay_sec_last1_total,
          s2l_75ms_delay_sec_last1_total,
          s2l_total_delay_sec_last7_total,
          s2l_25ms_delay_sec_last7_total,
          s2l_75ms_delay_sec_last7_total,
          p2s_lost_Leq5_last1_total,
          p2s_lost_all_last1_total,
          p2s_lost_Leq5_last7_total,
          p2s_lost_all_last7_total,
          crash_cnt_last1_total,
          service_cnt_last1_total,
          crash_cnt_last7_total,
          service_cnt_last7_total,
          s2l_lost_Leq5_total,
          s2l_lost_all_total,
          s2l_lost_Leq5_last1_total,
          s2l_lost_all_last1_total,
          s2l_lost_Leq5_last7_total,
          s2l_lost_all_last7_total
        FROM report_datahub.pub_levels_quality_di_1 AS t1
          LEFT JOIN (SELECT date,
              dim,
              SUM(fiveSecJoinSuccess) AS fiveSecJoinSuccess_total,
              SUM(totalJoin) AS totalJoin_total,
              SUM(cnt_sid) AS cnt_sid_total,
              SUM(video_freeze_time) AS video_freeze_time_total,
              SUM(video_totaltime) AS video_totaltime_total,
              SUM(audio_freeze_time) AS audio_freeze_time_total,
              SUM(audio_totaltime) AS audio_totaltime_total,
              SUM(s2l_total_delay_sec) AS s2l_total_delay_sec_total,
              SUM(s2l_25ms_delay_sec) AS s2l_25ms_delay_sec_total,
              SUM(s2l_75ms_delay_sec) AS s2l_75ms_delay_sec_total,
              SUM(p2s_lost_Leq5) AS p2s_lost_Leq5_total,
              SUM(p2s_lost_all) AS p2s_lost_all_total,
              SUM(crash_cnt) AS crash_cnt_total,
              SUM(service_cnt) AS service_cnt_total,
              SUM(""1s_succ_join_ap_cnt"") AS ""1s_succ_join_ap_cnt_total"",
              SUM(""5s_succ_join_ap_cnt"") AS ""5s_succ_join_ap_cnt_total"",
              SUM(total_join_ap_cnt) AS total_join_ap_cnt_total,
              SUM(totalJoinSuccess) AS totalJoinSuccess_total,
              SUM(threeSecJoinSuccess) AS threeSecJoinSuccess_total,
              SUM(video_freeze_time_200) AS video_freeze_time_200_total,
              SUM(video_totaltime_200) AS video_totaltime_200_total,
              SUM(video_freeze_time_500) AS video_freeze_time_500_total,
              SUM(video_totaltime_500) AS video_totaltime_500_total,
              SUM(""3s_succ_join_session_cnt_last1"") AS ""3s_succ_join_session_cnt_last1_total"",
              SUM(""5s_succ_join_session_cnt_last1"") AS ""5s_succ_join_session_cnt_last1_total"",
              SUM(succ_join_session_cnt_last1) AS succ_join_session_cnt_last1_total,
              SUM(total_join_session_cnt_last1) AS total_join_session_cnt_last1_total,
              SUM(total_session_cnt_last1) AS total_session_cnt_last1_total,
              SUM(""1s_succ_join_ap_cnt_last1"") AS ""1s_succ_join_ap_cnt_last1_total"",
              SUM(""5s_succ_join_ap_cnt_last1"") AS ""5s_succ_join_ap_cnt_last1_total"",
              SUM(total_join_ap_cnt_last1) AS total_join_ap_cnt_last1_total,
              SUM(""3s_succ_join_session_cnt_last7"") AS ""3s_succ_join_session_cnt_last7_total"",
              SUM(""5s_succ_join_session_cnt_last7"") AS ""5s_succ_join_session_cnt_last7_total"",
              SUM(succ_join_session_cnt_last7) AS succ_join_session_cnt_last7_total,
              SUM(total_join_session_cnt_last7) AS total_join_session_cnt_last7_total,
              SUM(total_session_cnt_last7) AS total_session_cnt_last7_total,
              SUM(""1s_succ_join_ap_cnt_last7"") AS ""1s_succ_join_ap_cnt_last7_total"",
              SUM(""5s_succ_join_ap_cnt_last7"") AS ""5s_succ_join_ap_cnt_last7_total"",
              SUM(total_join_ap_cnt_last7) AS total_join_ap_cnt_last7_total,
              SUM(video_freeze_time_last1) AS video_freeze_time_last1_total,
              SUM(video_totaltime_last1) AS video_totaltime_last1_total,
              SUM(video_freeze_time_500_last1) AS video_freeze_time_500_last1_total,
              SUM(video_totaltime_500_last1) AS video_totaltime_500_last1_total,
              SUM(video_freeze_time_200_last1) AS video_freeze_time_200_last1_total,
              SUM(video_totaltime_200_last1) AS video_totaltime_200_last1_total,
              SUM(video_freeze_time_last7) AS video_freeze_time_last7_total,
              SUM(video_totaltime_last7) AS video_totaltime_last7_total,
              SUM(video_freeze_time_500_last7) AS video_freeze_time_500_last7_total,
              SUM(video_totaltime_500_last7) AS video_totaltime_500_last7_total,
              SUM(video_freeze_time_200_last7) AS video_freeze_time_200_last7_total,
              SUM(video_totaltime_200_last7) AS video_totaltime_200_last7_total,
              SUM(audio_freeze_time_last1) AS audio_freeze_time_last1_total,
              SUM(audio_totaltime_last1) AS audio_totaltime_last1_total,
              SUM(audio_freeze_time_last7) AS audio_freeze_time_last7_total,
              SUM(audio_totaltime_last7) AS audio_totaltime_last7_total,
              SUM(s2l_total_delay_sec_last1) AS s2l_total_delay_sec_last1_total,
              SUM(s2l_25ms_delay_sec_last1) AS s2l_25ms_delay_sec_last1_total,
              SUM(s2l_75ms_delay_sec_last1) AS s2l_75ms_delay_sec_last1_total,
              SUM(s2l_total_delay_sec_last7) AS s2l_total_delay_sec_last7_total,
              SUM(s2l_25ms_delay_sec_last7) AS s2l_25ms_delay_sec_last7_total,
              SUM(s2l_75ms_delay_sec_last7) AS s2l_75ms_delay_sec_last7_total,
              SUM(p2s_lost_Leq5_last1) AS p2s_lost_Leq5_last1_total,
              SUM(p2s_lost_all_last1) AS p2s_lost_all_last1_total,
              SUM(p2s_lost_Leq5_last7) AS p2s_lost_Leq5_last7_total,
              SUM(p2s_lost_all_last7) AS p2s_lost_all_last7_total,
              SUM(crash_cnt_last1) AS crash_cnt_last1_total,
              SUM(service_cnt_last1) AS service_cnt_last1_total,
              SUM(crash_cnt_last7) AS crash_cnt_last7_total,
              SUM(service_cnt_last7) AS service_cnt_last7_total,
              SUM(s2l_lost_Leq5) AS s2l_lost_Leq5_total,
              SUM(s2l_lost_all) AS s2l_lost_all_total,
              SUM(s2l_lost_Leq5_last1) AS s2l_lost_Leq5_last1_total,
              SUM(s2l_lost_all_last1) AS s2l_lost_all_last1_total,
              SUM(s2l_lost_Leq5_last7) AS s2l_lost_Leq5_last7_total,
              SUM(s2l_lost_all_last7) AS s2l_lost_all_last7_total
            FROM report_datahub.pub_levels_quality_di_1
            WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-21') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-11-21') AND CAST(tag AS VARCHAR) = 'Product'
            GROUP BY date,
              dim) AS t2 ON t1.date = t2.date AND t1.dim = t2.dim
        WHERE date_parse(cast( t1.date as VARCHAR), '%Y%m%d') >= DATE('2021-11-21') AND date_parse(cast( t1.date as VARCHAR), '%Y%m%d') <= DATE('2021-11-21') AND CAST(tag AS VARCHAR) = 'Product') AS ""自定义 SQL 查询""
    HAVING COUNT(1) > 0) AS ""t0""
WHERE CASE WHEN CAST(""自定义 SQL 查询"".""tag"" AS VARCHAR) = 'Industry' AND CAST(""自定义 SQL 查询"".""product_level1"" AS VARCHAR) = 'RTC' AND CAST(""自定义 SQL 查询"".""dim"" AS VARCHAR) = 'osver' THEN 0 WHEN CAST(""自定义 SQL 查询"".""tag"" AS VARCHAR) = 'VerType' AND CAST(""自定义 SQL 查询"".""product_level1"" AS VARCHAR) = 'RTC' AND CAST(""自定义 SQL 查询"".""dim"" AS VARCHAR) = 'osver' THEN 0 WHEN CAST(""自定义 SQL 查询"".""tag"" AS VARCHAR) = 'Product' AND CAST(""自定义 SQL 查询"".""dim"" AS VARCHAR) = 'osver' AND CAST(""自定义 SQL 查询"".""product_level1"" AS VARCHAR) = 'RTC' THEN 1 ELSE 0 END AND DATE_ADD('SECOND', 0, date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d')) = DATE_ADD('SECOND', 0, ""t0"".""__measure__0"")
HAVING COUNT(1) > 0"
"SELECT SUM(""自定义 SQL 查询"".""s2l_25ms_delay_sec"") AS ""TEMP(Calculation_1430244791154503680)(2227145667)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_total_delay_sec"") AS ""TEMP(Calculation_1430244791154503680)(2460078802)(0)"",
  SUM(""自定义 SQL 查询"".""5s_succ_join_ap_cnt"") AS ""TEMP(Calculation_1430244791247978510)(1716451703)(0)"",
  SUM(""自定义 SQL 查询"".""total_join_ap_cnt"") AS ""TEMP(Calculation_1430244791247978510)(2681092799)(0)"",
  SUM(""自定义 SQL 查询"".""video_freeze_time_500"") AS ""TEMP(Calculation_2810035073237774336)(389023081)(0)"",
  SUM(""自定义 SQL 查询"".""video_totaltime_500"") AS ""TEMP(Calculation_2810035073237774336)(458654145)(0)"",
  SUM(""自定义 SQL 查询"".""video_totaltime_200"") AS ""TEMP(Calculation_2810035073237950465)(2104207895)(0)"",
  SUM(""自定义 SQL 查询"".""video_freeze_time_200"") AS ""TEMP(Calculation_2810035073237950465)(530162565)(0)"",
  SUM(""自定义 SQL 查询"".""totalJoin"") AS ""TEMP(Calculation_374009936508170240)(2073556184)(0)"",
  SUM(""自定义 SQL 查询"".""totalJoinSuccess"") AS ""TEMP(Calculation_374009936508170240)(2807417001)(0)"",
  SUM(""自定义 SQL 查询"".""threeSecJoinSuccess"") AS ""TEMP(Calculation_374009936508321793)(3693645608)(0)"",
  SUM(""自定义 SQL 查询"".""fiveSecJoinSuccess"") AS ""TEMP(Calculation_374009936508416002)(383616769)(0)"",
  SUM(""自定义 SQL 查询"".""video_totaltime"") AS ""TEMP(Calculation_374009936515215363)(2797449586)(0)"",
  SUM(""自定义 SQL 查询"".""video_freeze_time"") AS ""TEMP(Calculation_374009936515215363)(2940759860)(0)"",
  SUM(""自定义 SQL 查询"".""audio_totaltime"") AS ""TEMP(Calculation_374009936517861380)(1652566750)(0)"",
  SUM(""自定义 SQL 查询"".""audio_freeze_time"") AS ""TEMP(Calculation_374009936517861380)(2919389392)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_lost_Leq5"") AS ""TEMP(Calculation_374009936519704581)(1936123547)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_lost_all"") AS ""TEMP(Calculation_374009936519704581)(749826584)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_75ms_delay_sec"") AS ""TEMP(Calculation_6542393318886285312)(2003933318)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_lost_Leq5"") AS ""TEMP(Calculation_7034341207026868236)(2745840127)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_lost_all"") AS ""TEMP(Calculation_7034341207026868236)(734589263)(0)"",
  SUM(""自定义 SQL 查询"".""crash_cnt"") AS ""TEMP(Calculation_7034341207372070925)(2360900687)(0)"",
  SUM(""自定义 SQL 查询"".""service_cnt"") AS ""TEMP(Calculation_7034341207372070925)(4291252132)(0)"",
  SUM(""自定义 SQL 查询"".""thisusage"") AS ""TEMP(TC_)(949910004)(0)"",
  ""自定义 SQL 查询"".""company_id"" AS ""company_id"",
  ""自定义 SQL 查询"".""company_name"" AS ""company_name"",
  ""自定义 SQL 查询"".""project"" AS ""project"",
  SUM(""自定义 SQL 查询"".""cnt_sid"") AS ""sum_cnt_sid_ok"",
  SUM(""自定义 SQL 查询"".""thisusage"") AS ""sum_thisusage_ok"",
  MAX(""自定义 SQL 查询"".""period"") AS ""usr_Calculation_6733444459377328128_nk"",
  ""自定义 SQL 查询"".""vid"" AS ""vid""
FROM (SELECT date,
        CASE WHEN CAST(stat_period AS VARCHAR) = 'day' THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(substr(CAST(start_date AS VARCHAR), 1, 10) AS VARCHAR), '~', CAST(substr(CAST(end_date AS VARCHAR), 1, 10) AS VARCHAR)) END AS period,
      start_date,
      end_date,
      stat_period,
      tag,
      dim,
      level1,
      level2,
      level3,
      level4,
      '' AS pd,
      os,
      ver,
      ver_type,
      '' AS product_line,
      '' AS product_type,
      domain,
      country,
      region,
      net,
      vid,
      project,
      company_id,
      company_name,
      rowsnum,
      lastusage,
      thisusage,
      fiveSecJoinSuccess,
      totalJoin,
      cnt_sid,
      video_freeze_time,
      video_totaltime,
      audio_freeze_time,
      audio_totaltime,
      s2l_total_delay_sec,
      s2l_25ms_delay_sec,
      s2l_75ms_delay_sec,
      p2s_lost_Leq5,
      p2s_lost_all,
      crash_cnt,
      service_cnt,
      ""1s_succ_join_ap_cnt"",
      ""5s_succ_join_ap_cnt"",
      total_join_ap_cnt,
      totalJoinSuccess,
      threeSecJoinSuccess,
      video_freeze_time_200,
      video_totaltime_200,
      video_freeze_time_500,
      video_totaltime_500,
      ""3s_succ_join_session_cnt_last1"",
      ""5s_succ_join_session_cnt_last1"",
      succ_join_session_cnt_last1,
      total_join_session_cnt_last1,
      total_session_cnt_last1,
      ""1s_succ_join_ap_cnt_last1"",
      ""5s_succ_join_ap_cnt_last1"",
      total_join_ap_cnt_last1,
      ""3s_succ_join_session_cnt_last7"",
      ""5s_succ_join_session_cnt_last7"",
      succ_join_session_cnt_last7,
      total_join_session_cnt_last7,
      total_session_cnt_last7,
      ""1s_succ_join_ap_cnt_last7"",
      ""5s_succ_join_ap_cnt_last7"",
      total_join_ap_cnt_last7,
      video_freeze_time_last1,
      video_totaltime_last1,
      video_freeze_time_500_last1,
      video_totaltime_500_last1,
      video_freeze_time_200_last1,
      video_totaltime_200_last1,
      video_freeze_time_last7,
      video_totaltime_last7,
      video_freeze_time_500_last7,
      video_totaltime_500_last7,
      video_freeze_time_200_last7,
      video_totaltime_200_last7,
      audio_freeze_time_last1,
      audio_totaltime_last1,
      audio_freeze_time_last7,
      audio_totaltime_last7,
      s2l_total_delay_sec_last1,
      s2l_25ms_delay_sec_last1,
      s2l_75ms_delay_sec_last1,
      s2l_total_delay_sec_last7,
      s2l_25ms_delay_sec_last7,
      s2l_75ms_delay_sec_last7,
      p2s_lost_Leq5_last1,
      p2s_lost_all_last1,
      p2s_lost_Leq5_last7,
      p2s_lost_all_last7,
      crash_cnt_last1,
      service_cnt_last1,
      crash_cnt_last7,
      service_cnt_last7,
      product_level1,
      product_level2,
      product_level3,
      product_level4,
      s2l_lost_Leq5,
      s2l_lost_all,
      s2l_lost_Leq5_last1,
      s2l_lost_all_last1,
      s2l_lost_Leq5_last7,
      s2l_lost_all_last7
    FROM report_datahub.pub_levels_quality_di_1
    WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-21') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-11-21')) AS ""自定义 SQL 查询""
  CROSS JOIN (SELECT MAX(date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d')) AS ""__measure__0""
    FROM (SELECT date,
            CASE WHEN CAST(stat_period AS VARCHAR) = 'day' THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(substr(CAST(start_date AS VARCHAR), 1, 10) AS VARCHAR), '~', CAST(substr(CAST(end_date AS VARCHAR), 1, 10) AS VARCHAR)) END AS period,
          start_date,
          end_date,
          stat_period,
          tag,
          dim,
          level1,
          level2,
          level3,
          level4,
          '' AS pd,
          os,
          ver,
          ver_type,
          '' AS product_line,
          '' AS product_type,
          domain,
          country,
          region,
          net,
          vid,
          project,
          company_id,
          company_name,
          rowsnum,
          lastusage,
          thisusage,
          fiveSecJoinSuccess,
          totalJoin,
          cnt_sid,
          video_freeze_time,
          video_totaltime,
          audio_freeze_time,
          audio_totaltime,
          s2l_total_delay_sec,
          s2l_25ms_delay_sec,
          s2l_75ms_delay_sec,
          p2s_lost_Leq5,
          p2s_lost_all,
          crash_cnt,
          service_cnt,
          ""1s_succ_join_ap_cnt"",
          ""5s_succ_join_ap_cnt"",
          total_join_ap_cnt,
          totalJoinSuccess,
          threeSecJoinSuccess,
          video_freeze_time_200,
          video_totaltime_200,
          video_freeze_time_500,
          video_totaltime_500,
          ""3s_succ_join_session_cnt_last1"",
          ""5s_succ_join_session_cnt_last1"",
          succ_join_session_cnt_last1,
          total_join_session_cnt_last1,
          total_session_cnt_last1,
          ""1s_succ_join_ap_cnt_last1"",
          ""5s_succ_join_ap_cnt_last1"",
          total_join_ap_cnt_last1,
          ""3s_succ_join_session_cnt_last7"",
          ""5s_succ_join_session_cnt_last7"",
          succ_join_session_cnt_last7,
          total_join_session_cnt_last7,
          total_session_cnt_last7,
          ""1s_succ_join_ap_cnt_last7"",
          ""5s_succ_join_ap_cnt_last7"",
          total_join_ap_cnt_last7,
          video_freeze_time_last1,
          video_totaltime_last1,
          video_freeze_time_500_last1,
          video_totaltime_500_last1,
          video_freeze_time_200_last1,
          video_totaltime_200_last1,
          video_freeze_time_last7,
          video_totaltime_last7,
          video_freeze_time_500_last7,
          video_totaltime_500_last7,
          video_freeze_time_200_last7,
          video_totaltime_200_last7,
          audio_freeze_time_last1,
          audio_totaltime_last1,
          audio_freeze_time_last7,
          audio_totaltime_last7,
          s2l_total_delay_sec_last1,
          s2l_25ms_delay_sec_last1,
          s2l_75ms_delay_sec_last1,
          s2l_total_delay_sec_last7,
          s2l_25ms_delay_sec_last7,
          s2l_75ms_delay_sec_last7,
          p2s_lost_Leq5_last1,
          p2s_lost_all_last1,
          p2s_lost_Leq5_last7,
          p2s_lost_all_last7,
          crash_cnt_last1,
          service_cnt_last1,
          crash_cnt_last7,
          service_cnt_last7,
          product_level1,
          product_level2,
          product_level3,
          product_level4,
          s2l_lost_Leq5,
          s2l_lost_all,
          s2l_lost_Leq5_last1,
          s2l_lost_all_last1,
          s2l_lost_Leq5_last7,
          s2l_lost_all_last7
        FROM report_datahub.pub_levels_quality_di_1
        WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-21') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-11-21')) AS ""自定义 SQL 查询""
    HAVING COUNT(1) > 0) AS ""t0""
WHERE NOT ( (  ""自定义 SQL 查询"".""vid""  ) is null) AND CAST(""自定义 SQL 查询"".""dim"" AS VARCHAR) = '103' AND CAST(""自定义 SQL 查询"".""level1"" AS VARCHAR) = 'RTC' AND CAST(""自定义 SQL 查询"".""level2"" AS VARCHAR) = 'ALL' AND CAST(""自定义 SQL 查询"".""level3"" AS VARCHAR) = 'ALL' AND CAST(""自定义 SQL 查询"".""tag"" AS VARCHAR) = 'Product' AND DATE_ADD('SECOND', 0, date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d')) = DATE_ADD('SECOND', 0, ""t0"".""__measure__0"")
GROUP BY 25,
  26,
  27,
  31"
"SELECT ""自定义 SQL 查询"".""stat_date"" AS ""stat_date""
FROM (SELECT date,
        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,
      start_date AS start_date_7,
      end_date AS end_date,
      tag,
      area AS Scope,
      dim,
        CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,
      level2,
      level3,
      level4,
      product_level1 AS product_line,
      product_level2,
      product_level3,
      product_level4,
      vid_internal_industry_en AS cid_industry,
      vid_use_case_en AS vid_use_case_cn,
      vid_sector_en,
      ver_type,
      ver,
      os,
      domain,
      country,
      region,
      dim_grouping_name,
        CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,
      total AS totalUsage,
      audio,
      video,
      host_audio,
      audience_audio,
      host_sd,
      host_hd,
      host_hdp,
      host_1080p,
      host_2k,
      host_4k,
      audience_sd,
      audience_hd,
      audience_hdp,
      audience_1080p,
      audience_2k,
      audience_4k,
      audience_audio_low_latency,
      audience_sd_low_latency,
      audience_hd_low_latency,
      audience_hdp_low_latency,
      audience_1080p_low_latency,
      audience_2k_low_latency,
      audience_4k_low_latency,
      audience_audio_ultra_low_latency,
      audience_sd_ultra_low_latency,
      audience_hd_ultra_low_latency,
      audience_hdp_ultra_low_latency,
      audience_1080p_ultra_low_latency,
      audience_2k_ultra_low_latency,
      audience_4k_ultra_low_latency,
      total_last1 AS audio_video_last,
      audio_last1 AS audio_last,
      video_last1 AS video_last,
      video_sd_last1 AS video_sd_last,
      video_hd_last1 AS video_hd_last,
      video_hdp_last1 AS video_hdp_last,
      host_sd_last1 AS host_video_sd_last,
      audience_sd_last1 AS audience_video_sd_last,
      host_hd_last1 AS host_video_hd_last,
      audience_hd_last1 AS audience_video_hd_last,
      host_hdp_last1 AS host_video_hdp_last,
      audience_hdp_last1 AS audience_video_hdp_last,
      host_audio_last1 AS host_audio_last,
      audience_audio_last1 AS audience_audio_last,
      host_video_last1 AS host_video_last,
      audience_video_last1 AS audience_video_last,
      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,
      audience_video_low_latency_last1 AS audience_video_low_latency_last,
      audience_total_low_latency_last1 AS audience_total_low_latency_last,
      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,
      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,
      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,
      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,
      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,
      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,
      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,
      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,
      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,
      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,
      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,
      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,
      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,
      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,
      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,
      audience_2k_last1 AS audience_2k_last,
      audience_4k_last1 AS audience_4k_last,
      audience_1080p_last1 AS audience_1080p_last,
      host_1080p_last1 AS host_1080p_last,
      host_2k_last1 AS host_2k_last,
      host_4k_last1 AS host_4k_last,
      total_last7,
      audio_last7,
      video_last7,
      video_sd_last7,
      video_hd_last7,
      video_hdp_last7,
      host_sd_last7,
      audience_sd_last7,
      host_hd_last7,
      audience_hd_last7,
      host_hdp_last7,
      audience_hdp_last7,
      host_audio_last7,
      audience_audio_last7,
      host_video_last7,
      audience_video_last7,
      audience_audio_low_latency_last7,
      audience_video_low_latency_last7,
      audience_total_low_latency_last7,
      audience_sd_low_latency_last7,
      audience_hd_low_latency_last7,
      audience_hdp_low_latency_last7,
      audience_1080p_low_latency_last7,
      audience_2k_low_latency_last7,
      audience_4k_low_latency_last7,
      audience_audio_ultra_low_latency_last7,
      audience_video_ultra_low_latency_last7,
      audience_total_ultra_low_latency_last7,
      audience_sd_ultra_low_latency_last7,
      audience_hd_ultra_low_latency_last7,
      audience_hdp_ultra_low_latency_last7,
      audience_1080p_ultra_low_latency_last7,
      audience_2k_ultra_low_latency_last7,
      audience_4k_ultra_low_latency_last7,
      audience_2k_last7,
      audience_4k_last7,
      audience_1080p_last7,
      host_1080p_last7,
      host_2k_last7,
      host_4k_last7
    FROM levels_usage_dod_di_1
    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-06') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-04') AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS ""自定义 SQL 查询""
  CROSS JOIN (SELECT MAX(date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d')) AS ""__measure__0""
    FROM (SELECT date,
            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,
          start_date AS start_date_7,
          end_date AS end_date,
          tag,
          area AS Scope,
          dim,
            CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,
          level2,
          level3,
          level4,
          product_level1 AS product_line,
          product_level2,
          product_level3,
          product_level4,
          vid_internal_industry_en AS cid_industry,
          vid_use_case_en AS vid_use_case_cn,
          vid_sector_en,
          ver_type,
          ver,
          os,
          domain,
          country,
          region,
          dim_grouping_name,
            CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,
          total AS totalUsage,
          audio,
          video,
          host_audio,
          audience_audio,
          host_sd,
          host_hd,
          host_hdp,
          host_1080p,
          host_2k,
          host_4k,
          audience_sd,
          audience_hd,
          audience_hdp,
          audience_1080p,
          audience_2k,
          audience_4k,
          audience_audio_low_latency,
          audience_sd_low_latency,
          audience_hd_low_latency,
          audience_hdp_low_latency,
          audience_1080p_low_latency,
          audience_2k_low_latency,
          audience_4k_low_latency,
          audience_audio_ultra_low_latency,
          audience_sd_ultra_low_latency,
          audience_hd_ultra_low_latency,
          audience_hdp_ultra_low_latency,
          audience_1080p_ultra_low_latency,
          audience_2k_ultra_low_latency,
          audience_4k_ultra_low_latency,
          total_last1 AS audio_video_last,
          audio_last1 AS audio_last,
          video_last1 AS video_last,
          video_sd_last1 AS video_sd_last,
          video_hd_last1 AS video_hd_last,
          video_hdp_last1 AS video_hdp_last,
          host_sd_last1 AS host_video_sd_last,
          audience_sd_last1 AS audience_video_sd_last,
          host_hd_last1 AS host_video_hd_last,
          audience_hd_last1 AS audience_video_hd_last,
          host_hdp_last1 AS host_video_hdp_last,
          audience_hdp_last1 AS audience_video_hdp_last,
          host_audio_last1 AS host_audio_last,
          audience_audio_last1 AS audience_audio_last,
          host_video_last1 AS host_video_last,
          audience_video_last1 AS audience_video_last,
          audience_audio_low_latency_last1 AS audience_audio_low_latency_last,
          audience_video_low_latency_last1 AS audience_video_low_latency_last,
          audience_total_low_latency_last1 AS audience_total_low_latency_last,
          audience_sd_low_latency_last1 AS audience_sd_low_latency_last,
          audience_hd_low_latency_last1 AS audience_hd_low_latency_last,
          audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,
          audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,
          audience_2k_low_latency_last1 AS audience_2k_low_latency_last,
          audience_4k_low_latency_last1 AS audience_4k_low_latency_last,
          audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,
          audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,
          audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,
          audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,
          audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,
          audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,
          audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,
          audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,
          audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,
          audience_2k_last1 AS audience_2k_last,
          audience_4k_last1 AS audience_4k_last,
          audience_1080p_last1 AS audience_1080p_last,
          host_1080p_last1 AS host_1080p_last,
          host_2k_last1 AS host_2k_last,
          host_4k_last1 AS host_4k_last,
          total_last7,
          audio_last7,
          video_last7,
          video_sd_last7,
          video_hd_last7,
          video_hdp_last7,
          host_sd_last7,
          audience_sd_last7,
          host_hd_last7,
          audience_hd_last7,
          host_hdp_last7,
          audience_hdp_last7,
          host_audio_last7,
          audience_audio_last7,
          host_video_last7,
          audience_video_last7,
          audience_audio_low_latency_last7,
          audience_video_low_latency_last7,
          audience_total_low_latency_last7,
          audience_sd_low_latency_last7,
          audience_hd_low_latency_last7,
          audience_hdp_low_latency_last7,
          audience_1080p_low_latency_last7,
          audience_2k_low_latency_last7,
          audience_4k_low_latency_last7,
          audience_audio_ultra_low_latency_last7,
          audience_video_ultra_low_latency_last7,
          audience_total_ultra_low_latency_last7,
          audience_sd_ultra_low_latency_last7,
          audience_hd_ultra_low_latency_last7,
          audience_hdp_ultra_low_latency_last7,
          audience_1080p_ultra_low_latency_last7,
          audience_2k_ultra_low_latency_last7,
          audience_4k_ultra_low_latency_last7,
          audience_2k_last7,
          audience_4k_last7,
          audience_1080p_last7,
          host_1080p_last7,
          host_2k_last7,
          host_4k_last7
        FROM levels_usage_dod_di_1
        WHERE CAST(tag AS VARCHAR) = 'Industry' AND date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-06') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-04') AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS ""自定义 SQL 查询""
    HAVING COUNT(1) > 0) AS ""t0""
WHERE date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d') = ""t0"".""__measure__0""
GROUP BY 1"
"SELECT SUM(""自定义 SQL 查询"".""host_4k"") AS ""TEMP(Calculation_3519281700079370244)(1075454865)(0)"",
  SUM(""自定义 SQL 查询"".""audience_sd"") AS ""TEMP(Calculation_3519281700079370244)(1133678835)(0)"",
  SUM(""自定义 SQL 查询"".""host_1080p"") AS ""TEMP(Calculation_3519281700079370244)(1312501967)(0)"",
  SUM(""自定义 SQL 查询"".""host_hd"") AS ""TEMP(Calculation_3519281700079370244)(276907208)(0)"",
  SUM(""自定义 SQL 查询"".""video"") AS ""TEMP(Calculation_3519281700079370244)(2929708110)(0)"",
  SUM(""自定义 SQL 查询"".""audience_hd"") AS ""TEMP(Calculation_3519281700079370244)(2930728935)(0)"",
  SUM(""自定义 SQL 查询"".""audience_hdp"") AS ""TEMP(Calculation_3519281700079370244)(3010533957)(0)"",
  SUM(""自定义 SQL 查询"".""host_hdp"") AS ""TEMP(Calculation_3519281700079370244)(30306054)(0)"",
  SUM(""自定义 SQL 查询"".""host_audio"") AS ""TEMP(Calculation_3519281700079370244)(3087054365)(0)"",
  SUM(""自定义 SQL 查询"".""audio"") AS ""TEMP(Calculation_3519281700079370244)(3299350010)(0)"",
  SUM(""自定义 SQL 查询"".""audience_1080p"") AS ""TEMP(Calculation_3519281700079370244)(3628946582)(0)"",
  SUM(""自定义 SQL 查询"".""totalUsage"") AS ""TEMP(Calculation_3519281700079370244)(3847882359)(0)"",
  SUM(""自定义 SQL 查询"".""audience_audio"") AS ""TEMP(Calculation_3519281700079370244)(4109514392)(0)"",
  SUM(""自定义 SQL 查询"".""host_2k"") AS ""TEMP(Calculation_3519281700079370244)(586790827)(0)"",
  SUM(""自定义 SQL 查询"".""host_sd"") AS ""TEMP(Calculation_3519281700079370244)(709512178)(0)"",
  SUM(""自定义 SQL 查询"".""audience_4k"") AS ""TEMP(Calculation_3519281700079370244)(764410224)(0)"",
  SUM(""自定义 SQL 查询"".""audience_2k"") AS ""TEMP(Calculation_3519281700079370244)(943764407)(0)"",
  SUM(""自定义 SQL 查询"".""host_4k_last"") AS ""TEMP(Calculation_3519281700083154949)(101123376)(0)"",
  SUM(""自定义 SQL 查询"".""audience_video_hdp_last"") AS ""TEMP(Calculation_3519281700083154949)(1200517625)(0)"",
  SUM(""自定义 SQL 查询"".""audience_1080p_last"") AS ""TEMP(Calculation_3519281700083154949)(1314346200)(0)"",
  SUM(""自定义 SQL 查询"".""audience_video_hd_last"") AS ""TEMP(Calculation_3519281700083154949)(146570423)(0)"",
  SUM(""自定义 SQL 查询"".""audience_2k_last"") AS ""TEMP(Calculation_3519281700083154949)(1717771635)(0)"",
  SUM(""自定义 SQL 查询"".""audience_audio_last"") AS ""TEMP(Calculation_3519281700083154949)(2313111073)(0)"",
  SUM(""自定义 SQL 查询"".""host_video_hdp_last"") AS ""TEMP(Calculation_3519281700083154949)(258310559)(0)"",
  SUM(""自定义 SQL 查询"".""audio_video_last"") AS ""TEMP(Calculation_3519281700083154949)(2820618408)(0)"",
  SUM(""自定义 SQL 查询"".""audience_4k_last"") AS ""TEMP(Calculation_3519281700083154949)(3121859593)(0)"",
  SUM(""自定义 SQL 查询"".""host_1080p_last"") AS ""TEMP(Calculation_3519281700083154949)(3222422303)(0)"",
  SUM(""自定义 SQL 查询"".""host_audio_last"") AS ""TEMP(Calculation_3519281700083154949)(3227677803)(0)"",
  SUM(""自定义 SQL 查询"".""video_last"") AS ""TEMP(Calculation_3519281700083154949)(3934387163)(0)"",
  SUM(""自定义 SQL 查询"".""host_2k_last"") AS ""TEMP(Calculation_3519281700083154949)(4055292783)(0)"",
  SUM(""自定义 SQL 查询"".""audio_last"") AS ""TEMP(Calculation_3519281700083154949)(4091190060)(0)"",
  SUM(""自定义 SQL 查询"".""host_video_hd_last"") AS ""TEMP(Calculation_3519281700083154949)(4170367250)(0)"",
  SUM(""自定义 SQL 查询"".""host_video_sd_last"") AS ""TEMP(Calculation_3519281700083154949)(4190307025)(0)"",
  SUM(""自定义 SQL 查询"".""audience_video_sd_last"") AS ""TEMP(Calculation_3519281700083154949)(933007102)(0)"",
  MAX(""自定义 SQL 查询"".""stat_date"") AS ""TEMP(attr_stat_date_nk)(2102638629)(0)"",
  MIN(""自定义 SQL 查询"".""stat_date"") AS ""TEMP(attr_stat_date_nk)(2790680713)(0)"",
  ""自定义 SQL 查询"".""level1"" AS ""level1"",
  SUM(""自定义 SQL 查询"".""totalUsage"") AS ""sum_totalUsage_ok"",
  DATE_ADD('SECOND', 0, date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d')) AS ""tdy_date_ok""
FROM (SELECT date,
        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,
      start_date AS start_date_7,
      end_date AS end_date,
      tag,
      area AS Scope,
      dim,
        CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,
      level2,
      level3,
      level4,
      product_level1 AS product_line,
      product_level2,
      product_level3,
      product_level4,
      vid_internal_industry_en AS cid_industry,
      vid_use_case_en AS vid_use_case_cn,
      vid_sector_en,
      ver_type,
      ver,
      os,
      domain,
      country,
      region,
      dim_grouping_name,
        CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,
      total AS totalUsage,
      audio,
      video,
      host_audio,
      audience_audio,
      host_sd,
      host_hd,
      host_hdp,
      host_1080p,
      host_2k,
      host_4k,
      audience_sd,
      audience_hd,
      audience_hdp,
      audience_1080p,
      audience_2k,
      audience_4k,
      audience_audio_low_latency,
      audience_sd_low_latency,
      audience_hd_low_latency,
      audience_hdp_low_latency,
      audience_1080p_low_latency,
      audience_2k_low_latency,
      audience_4k_low_latency,
      audience_audio_ultra_low_latency,
      audience_sd_ultra_low_latency,
      audience_hd_ultra_low_latency,
      audience_hdp_ultra_low_latency,
      audience_1080p_ultra_low_latency,
      audience_2k_ultra_low_latency,
      audience_4k_ultra_low_latency,
      total_last1 AS audio_video_last,
      audio_last1 AS audio_last,
      video_last1 AS video_last,
      video_sd_last1 AS video_sd_last,
      video_hd_last1 AS video_hd_last,
      video_hdp_last1 AS video_hdp_last,
      host_sd_last1 AS host_video_sd_last,
      audience_sd_last1 AS audience_video_sd_last,
      host_hd_last1 AS host_video_hd_last,
      audience_hd_last1 AS audience_video_hd_last,
      host_hdp_last1 AS host_video_hdp_last,
      audience_hdp_last1 AS audience_video_hdp_last,
      host_audio_last1 AS host_audio_last,
      audience_audio_last1 AS audience_audio_last,
      host_video_last1 AS host_video_last,
      audience_video_last1 AS audience_video_last,
      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,
      audience_video_low_latency_last1 AS audience_video_low_latency_last,
      audience_total_low_latency_last1 AS audience_total_low_latency_last,
      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,
      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,
      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,
      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,
      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,
      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,
      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,
      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,
      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,
      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,
      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,
      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,
      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,
      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,
      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,
      audience_2k_last1 AS audience_2k_last,
      audience_4k_last1 AS audience_4k_last,
      audience_1080p_last1 AS audience_1080p_last,
      host_1080p_last1 AS host_1080p_last,
      host_2k_last1 AS host_2k_last,
      host_4k_last1 AS host_4k_last,
      total_last7,
      audio_last7,
      video_last7,
      video_sd_last7,
      video_hd_last7,
      video_hdp_last7,
      host_sd_last7,
      audience_sd_last7,
      host_hd_last7,
      audience_hd_last7,
      host_hdp_last7,
      audience_hdp_last7,
      host_audio_last7,
      audience_audio_last7,
      host_video_last7,
      audience_video_last7,
      audience_audio_low_latency_last7,
      audience_video_low_latency_last7,
      audience_total_low_latency_last7,
      audience_sd_low_latency_last7,
      audience_hd_low_latency_last7,
      audience_hdp_low_latency_last7,
      audience_1080p_low_latency_last7,
      audience_2k_low_latency_last7,
      audience_4k_low_latency_last7,
      audience_audio_ultra_low_latency_last7,
      audience_video_ultra_low_latency_last7,
      audience_total_ultra_low_latency_last7,
      audience_sd_ultra_low_latency_last7,
      audience_hd_ultra_low_latency_last7,
      audience_hdp_ultra_low_latency_last7,
      audience_1080p_ultra_low_latency_last7,
      audience_2k_ultra_low_latency_last7,
      audience_4k_ultra_low_latency_last7,
      audience_2k_last7,
      audience_4k_last7,
      audience_1080p_last7,
      host_1080p_last7,
      host_2k_last7,
      host_4k_last7
    FROM levels_usage_dod_di_1
    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-06') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-04') AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS ""自定义 SQL 查询""
WHERE ""自定义 SQL 查询"".""dim"" = 1 AND ""自定义 SQL 查询"".""rank_level1"" = 5
GROUP BY 37,
  39"
"SELECT SUM(""自定义 SQL 查询"".""thisusage"") AS ""TEMP(TC_)(949910004)(0)"",
  SUM(""自定义 SQL 查询"".""thisusage"") AS ""sum_thisusage_ok"",
  MAX(""自定义 SQL 查询"".""period"") AS ""usr_Calculation_6733444459377328128_nk"",
  ""自定义 SQL 查询"".""vid"" AS ""vid""
FROM (SELECT date,
        CASE WHEN CAST(stat_period AS VARCHAR) = 'day' THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(substr(CAST(start_date AS VARCHAR), 1, 10) AS VARCHAR), '~', CAST(substr(CAST(end_date AS VARCHAR), 1, 10) AS VARCHAR)) END AS period,
      start_date,
      end_date,
      stat_period,
      tag,
      dim,
      level1,
      level2,
      level3,
      level4,
      '' AS pd,
      os,
      ver,
      ver_type,
      '' AS product_line,
      '' AS product_type,
      domain,
      country,
      region,
      net,
      vid,
      project,
      company_id,
      company_name,
      rowsnum,
      lastusage,
      thisusage,
      fiveSecJoinSuccess,
      totalJoin,
      cnt_sid,
      video_freeze_time,
      video_totaltime,
      audio_freeze_time,
      audio_totaltime,
      s2l_total_delay_sec,
      s2l_25ms_delay_sec,
      s2l_75ms_delay_sec,
      p2s_lost_Leq5,
      p2s_lost_all,
      crash_cnt,
      service_cnt,
      ""1s_succ_join_ap_cnt"",
      ""5s_succ_join_ap_cnt"",
      total_join_ap_cnt,
      totalJoinSuccess,
      threeSecJoinSuccess,
      video_freeze_time_200,
      video_totaltime_200,
      video_freeze_time_500,
      video_totaltime_500,
      ""3s_succ_join_session_cnt_last1"",
      ""5s_succ_join_session_cnt_last1"",
      succ_join_session_cnt_last1,
      total_join_session_cnt_last1,
      total_session_cnt_last1,
      ""1s_succ_join_ap_cnt_last1"",
      ""5s_succ_join_ap_cnt_last1"",
      total_join_ap_cnt_last1,
      ""3s_succ_join_session_cnt_last7"",
      ""5s_succ_join_session_cnt_last7"",
      succ_join_session_cnt_last7,
      total_join_session_cnt_last7,
      total_session_cnt_last7,
      ""1s_succ_join_ap_cnt_last7"",
      ""5s_succ_join_ap_cnt_last7"",
      total_join_ap_cnt_last7,
      video_freeze_time_last1,
      video_totaltime_last1,
      video_freeze_time_500_last1,
      video_totaltime_500_last1,
      video_freeze_time_200_last1,
      video_totaltime_200_last1,
      video_freeze_time_last7,
      video_totaltime_last7,
      video_freeze_time_500_last7,
      video_totaltime_500_last7,
      video_freeze_time_200_last7,
      video_totaltime_200_last7,
      audio_freeze_time_last1,
      audio_totaltime_last1,
      audio_freeze_time_last7,
      audio_totaltime_last7,
      s2l_total_delay_sec_last1,
      s2l_25ms_delay_sec_last1,
      s2l_75ms_delay_sec_last1,
      s2l_total_delay_sec_last7,
      s2l_25ms_delay_sec_last7,
      s2l_75ms_delay_sec_last7,
      p2s_lost_Leq5_last1,
      p2s_lost_all_last1,
      p2s_lost_Leq5_last7,
      p2s_lost_all_last7,
      crash_cnt_last1,
      service_cnt_last1,
      crash_cnt_last7,
      service_cnt_last7,
      product_level1,
      product_level2,
      product_level3,
      product_level4,
      s2l_lost_Leq5,
      s2l_lost_all,
      s2l_lost_Leq5_last1,
      s2l_lost_all_last1,
      s2l_lost_Leq5_last7,
      s2l_lost_all_last7
    FROM report_datahub.pub_levels_quality_di_1
    WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-21') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-05')) AS ""自定义 SQL 查询""
  CROSS JOIN (SELECT MAX(date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d')) AS ""__measure__0""
    FROM (SELECT date,
            CASE WHEN CAST(stat_period AS VARCHAR) = 'day' THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(substr(CAST(start_date AS VARCHAR), 1, 10) AS VARCHAR), '~', CAST(substr(CAST(end_date AS VARCHAR), 1, 10) AS VARCHAR)) END AS period,
          start_date,
          end_date,
          stat_period,
          tag,
          dim,
          level1,
          level2,
          level3,
          level4,
          '' AS pd,
          os,
          ver,
          ver_type,
          '' AS product_line,
          '' AS product_type,
          domain,
          country,
          region,
          net,
          vid,
          project,
          company_id,
          company_name,
          rowsnum,
          lastusage,
          thisusage,
          fiveSecJoinSuccess,
          totalJoin,
          cnt_sid,
          video_freeze_time,
          video_totaltime,
          audio_freeze_time,
          audio_totaltime,
          s2l_total_delay_sec,
          s2l_25ms_delay_sec,
          s2l_75ms_delay_sec,
          p2s_lost_Leq5,
          p2s_lost_all,
          crash_cnt,
          service_cnt,
          ""1s_succ_join_ap_cnt"",
          ""5s_succ_join_ap_cnt"",
          total_join_ap_cnt,
          totalJoinSuccess,
          threeSecJoinSuccess,
          video_freeze_time_200,
          video_totaltime_200,
          video_freeze_time_500,
          video_totaltime_500,
          ""3s_succ_join_session_cnt_last1"",
          ""5s_succ_join_session_cnt_last1"",
          succ_join_session_cnt_last1,
          total_join_session_cnt_last1,
          total_session_cnt_last1,
          ""1s_succ_join_ap_cnt_last1"",
          ""5s_succ_join_ap_cnt_last1"",
          total_join_ap_cnt_last1,
          ""3s_succ_join_session_cnt_last7"",
          ""5s_succ_join_session_cnt_last7"",
          succ_join_session_cnt_last7,
          total_join_session_cnt_last7,
          total_session_cnt_last7,
          ""1s_succ_join_ap_cnt_last7"",
          ""5s_succ_join_ap_cnt_last7"",
          total_join_ap_cnt_last7,
          video_freeze_time_last1,
          video_totaltime_last1,
          video_freeze_time_500_last1,
          video_totaltime_500_last1,
          video_freeze_time_200_last1,
          video_totaltime_200_last1,
          video_freeze_time_last7,
          video_totaltime_last7,
          video_freeze_time_500_last7,
          video_totaltime_500_last7,
          video_freeze_time_200_last7,
          video_totaltime_200_last7,
          audio_freeze_time_last1,
          audio_totaltime_last1,
          audio_freeze_time_last7,
          audio_totaltime_last7,
          s2l_total_delay_sec_last1,
          s2l_25ms_delay_sec_last1,
          s2l_75ms_delay_sec_last1,
          s2l_total_delay_sec_last7,
          s2l_25ms_delay_sec_last7,
          s2l_75ms_delay_sec_last7,
          p2s_lost_Leq5_last1,
          p2s_lost_all_last1,
          p2s_lost_Leq5_last7,
          p2s_lost_all_last7,
          crash_cnt_last1,
          service_cnt_last1,
          crash_cnt_last7,
          service_cnt_last7,
          product_level1,
          product_level2,
          product_level3,
          product_level4,
          s2l_lost_Leq5,
          s2l_lost_all,
          s2l_lost_Leq5_last1,
          s2l_lost_all_last1,
          s2l_lost_Leq5_last7,
          s2l_lost_all_last7
        FROM report_datahub.pub_levels_quality_di_1
        WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-21') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-05')) AS ""自定义 SQL 查询""
    HAVING COUNT(1) > 0) AS ""t0""
WHERE NOT ( (  ""自定义 SQL 查询"".""vid""  ) is null) AND CAST(""自定义 SQL 查询"".""dim"" AS VARCHAR) = '103' AND CAST(""自定义 SQL 查询"".""level1"" AS VARCHAR) = 'RTC' AND CAST(""自定义 SQL 查询"".""level2"" AS VARCHAR) = 'ALL' AND CAST(""自定义 SQL 查询"".""level3"" AS VARCHAR) = 'ALL' AND CAST(""自定义 SQL 查询"".""tag"" AS VARCHAR) = 'Product' AND DATE_ADD('SECOND', 0, date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d')) = DATE_ADD('SECOND', 0, ""t0"".""__measure__0"")
GROUP BY 4"
"use system.runtime"
"SELECT SUM(""自定义 SQL 查询"".""host_4k"") AS ""TEMP(Calculation_3519281700079370244)(1075454865)(0)"",
  SUM(""自定义 SQL 查询"".""audience_sd"") AS ""TEMP(Calculation_3519281700079370244)(1133678835)(0)"",
  SUM(""自定义 SQL 查询"".""host_1080p"") AS ""TEMP(Calculation_3519281700079370244)(1312501967)(0)"",
  SUM(""自定义 SQL 查询"".""host_hd"") AS ""TEMP(Calculation_3519281700079370244)(276907208)(0)"",
  SUM(""自定义 SQL 查询"".""video"") AS ""TEMP(Calculation_3519281700079370244)(2929708110)(0)"",
  SUM(""自定义 SQL 查询"".""audience_hd"") AS ""TEMP(Calculation_3519281700079370244)(2930728935)(0)"",
  SUM(""自定义 SQL 查询"".""audience_hdp"") AS ""TEMP(Calculation_3519281700079370244)(3010533957)(0)"",
  SUM(""自定义 SQL 查询"".""host_hdp"") AS ""TEMP(Calculation_3519281700079370244)(30306054)(0)"",
  SUM(""自定义 SQL 查询"".""host_audio"") AS ""TEMP(Calculation_3519281700079370244)(3087054365)(0)"",
  SUM(""自定义 SQL 查询"".""audio"") AS ""TEMP(Calculation_3519281700079370244)(3299350010)(0)"",
  SUM(""自定义 SQL 查询"".""audience_1080p"") AS ""TEMP(Calculation_3519281700079370244)(3628946582)(0)"",
  SUM(""自定义 SQL 查询"".""totalUsage"") AS ""TEMP(Calculation_3519281700079370244)(3847882359)(0)"",
  SUM(""自定义 SQL 查询"".""audience_audio"") AS ""TEMP(Calculation_3519281700079370244)(4109514392)(0)"",
  SUM(""自定义 SQL 查询"".""host_2k"") AS ""TEMP(Calculation_3519281700079370244)(586790827)(0)"",
  SUM(""自定义 SQL 查询"".""host_sd"") AS ""TEMP(Calculation_3519281700079370244)(709512178)(0)"",
  SUM(""自定义 SQL 查询"".""audience_4k"") AS ""TEMP(Calculation_3519281700079370244)(764410224)(0)"",
  SUM(""自定义 SQL 查询"".""audience_2k"") AS ""TEMP(Calculation_3519281700079370244)(943764407)(0)"",
  ""自定义 SQL 查询"".""level1"" AS ""level1"",
  SUM(""自定义 SQL 查询"".""totalUsage"") AS ""sum_totalUsage_ok"",
  DATE_ADD('SECOND', 0, date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d')) AS ""tdy_date_ok""
FROM (SELECT date,
        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,
      start_date AS start_date_7,
      end_date AS end_date,
      tag,
      area AS Scope,
      dim,
        CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,
      level2,
      level3,
      level4,
      product_level1 AS product_line,
      product_level2,
      product_level3,
      product_level4,
      vid_internal_industry_en AS cid_industry,
      vid_use_case_en AS vid_use_case_cn,
      vid_sector_en,
      ver_type,
      ver,
      os,
      domain,
      country,
      region,
      dim_grouping_name,
        CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,
      total AS totalUsage,
      audio,
      video,
      host_audio,
      audience_audio,
      host_sd,
      host_hd,
      host_hdp,
      host_1080p,
      host_2k,
      host_4k,
      audience_sd,
      audience_hd,
      audience_hdp,
      audience_1080p,
      audience_2k,
      audience_4k,
      audience_audio_low_latency,
      audience_sd_low_latency,
      audience_hd_low_latency,
      audience_hdp_low_latency,
      audience_1080p_low_latency,
      audience_2k_low_latency,
      audience_4k_low_latency,
      audience_audio_ultra_low_latency,
      audience_sd_ultra_low_latency,
      audience_hd_ultra_low_latency,
      audience_hdp_ultra_low_latency,
      audience_1080p_ultra_low_latency,
      audience_2k_ultra_low_latency,
      audience_4k_ultra_low_latency,
      total_last1 AS audio_video_last,
      audio_last1 AS audio_last,
      video_last1 AS video_last,
      video_sd_last1 AS video_sd_last,
      video_hd_last1 AS video_hd_last,
      video_hdp_last1 AS video_hdp_last,
      host_sd_last1 AS host_video_sd_last,
      audience_sd_last1 AS audience_video_sd_last,
      host_hd_last1 AS host_video_hd_last,
      audience_hd_last1 AS audience_video_hd_last,
      host_hdp_last1 AS host_video_hdp_last,
      audience_hdp_last1 AS audience_video_hdp_last,
      host_audio_last1 AS host_audio_last,
      audience_audio_last1 AS audience_audio_last,
      host_video_last1 AS host_video_last,
      audience_video_last1 AS audience_video_last,
      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,
      audience_video_low_latency_last1 AS audience_video_low_latency_last,
      audience_total_low_latency_last1 AS audience_total_low_latency_last,
      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,
      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,
      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,
      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,
      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,
      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,
      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,
      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,
      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,
      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,
      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,
      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,
      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,
      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,
      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,
      audience_2k_last1 AS audience_2k_last,
      audience_4k_last1 AS audience_4k_last,
      audience_1080p_last1 AS audience_1080p_last,
      host_1080p_last1 AS host_1080p_last,
      host_2k_last1 AS host_2k_last,
      host_4k_last1 AS host_4k_last,
      total_last7,
      audio_last7,
      video_last7,
      video_sd_last7,
      video_hd_last7,
      video_hdp_last7,
      host_sd_last7,
      audience_sd_last7,
      host_hd_last7,
      audience_hd_last7,
      host_hdp_last7,
      audience_hdp_last7,
      host_audio_last7,
      audience_audio_last7,
      host_video_last7,
      audience_video_last7,
      audience_audio_low_latency_last7,
      audience_video_low_latency_last7,
      audience_total_low_latency_last7,
      audience_sd_low_latency_last7,
      audience_hd_low_latency_last7,
      audience_hdp_low_latency_last7,
      audience_1080p_low_latency_last7,
      audience_2k_low_latency_last7,
      audience_4k_low_latency_last7,
      audience_audio_ultra_low_latency_last7,
      audience_video_ultra_low_latency_last7,
      audience_total_ultra_low_latency_last7,
      audience_sd_ultra_low_latency_last7,
      audience_hd_ultra_low_latency_last7,
      audience_hdp_ultra_low_latency_last7,
      audience_1080p_ultra_low_latency_last7,
      audience_2k_ultra_low_latency_last7,
      audience_4k_ultra_low_latency_last7,
      audience_2k_last7,
      audience_4k_last7,
      audience_1080p_last7,
      host_1080p_last7,
      host_2k_last7,
      host_4k_last7
    FROM levels_usage_dod_di_1
    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-06') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-04') AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS ""自定义 SQL 查询""
  CROSS JOIN (SELECT MAX(date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d')) AS ""__measure__0""
    FROM (SELECT date,
            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,
          start_date AS start_date_7,
          end_date AS end_date,
          tag,
          area AS Scope,
          dim,
            CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,
          level2,
          level3,
          level4,
          product_level1 AS product_line,
          product_level2,
          product_level3,
          product_level4,
          vid_internal_industry_en AS cid_industry,
          vid_use_case_en AS vid_use_case_cn,
          vid_sector_en,
          ver_type,
          ver,
          os,
          domain,
          country,
          region,
          dim_grouping_name,
            CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,
          total AS totalUsage,
          audio,
          video,
          host_audio,
          audience_audio,
          host_sd,
          host_hd,
          host_hdp,
          host_1080p,
          host_2k,
          host_4k,
          audience_sd,
          audience_hd,
          audience_hdp,
          audience_1080p,
          audience_2k,
          audience_4k,
          audience_audio_low_latency,
          audience_sd_low_latency,
          audience_hd_low_latency,
          audience_hdp_low_latency,
          audience_1080p_low_latency,
          audience_2k_low_latency,
          audience_4k_low_latency,
          audience_audio_ultra_low_latency,
          audience_sd_ultra_low_latency,
          audience_hd_ultra_low_latency,
          audience_hdp_ultra_low_latency,
          audience_1080p_ultra_low_latency,
          audience_2k_ultra_low_latency,
          audience_4k_ultra_low_latency,
          total_last1 AS audio_video_last,
          audio_last1 AS audio_last,
          video_last1 AS video_last,
          video_sd_last1 AS video_sd_last,
          video_hd_last1 AS video_hd_last,
          video_hdp_last1 AS video_hdp_last,
          host_sd_last1 AS host_video_sd_last,
          audience_sd_last1 AS audience_video_sd_last,
          host_hd_last1 AS host_video_hd_last,
          audience_hd_last1 AS audience_video_hd_last,
          host_hdp_last1 AS host_video_hdp_last,
          audience_hdp_last1 AS audience_video_hdp_last,
          host_audio_last1 AS host_audio_last,
          audience_audio_last1 AS audience_audio_last,
          host_video_last1 AS host_video_last,
          audience_video_last1 AS audience_video_last,
          audience_audio_low_latency_last1 AS audience_audio_low_latency_last,
          audience_video_low_latency_last1 AS audience_video_low_latency_last,
          audience_total_low_latency_last1 AS audience_total_low_latency_last,
          audience_sd_low_latency_last1 AS audience_sd_low_latency_last,
          audience_hd_low_latency_last1 AS audience_hd_low_latency_last,
          audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,
          audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,
          audience_2k_low_latency_last1 AS audience_2k_low_latency_last,
          audience_4k_low_latency_last1 AS audience_4k_low_latency_last,
          audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,
          audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,
          audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,
          audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,
          audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,
          audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,
          audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,
          audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,
          audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,
          audience_2k_last1 AS audience_2k_last,
          audience_4k_last1 AS audience_4k_last,
          audience_1080p_last1 AS audience_1080p_last,
          host_1080p_last1 AS host_1080p_last,
          host_2k_last1 AS host_2k_last,
          host_4k_last1 AS host_4k_last,
          total_last7,
          audio_last7,
          video_last7,
          video_sd_last7,
          video_hd_last7,
          video_hdp_last7,
          host_sd_last7,
          audience_sd_last7,
          host_hd_last7,
          audience_hd_last7,
          host_hdp_last7,
          audience_hdp_last7,
          host_audio_last7,
          audience_audio_last7,
          host_video_last7,
          audience_video_last7,
          audience_audio_low_latency_last7,
          audience_video_low_latency_last7,
          audience_total_low_latency_last7,
          audience_sd_low_latency_last7,
          audience_hd_low_latency_last7,
          audience_hdp_low_latency_last7,
          audience_1080p_low_latency_last7,
          audience_2k_low_latency_last7,
          audience_4k_low_latency_last7,
          audience_audio_ultra_low_latency_last7,
          audience_video_ultra_low_latency_last7,
          audience_total_ultra_low_latency_last7,
          audience_sd_ultra_low_latency_last7,
          audience_hd_ultra_low_latency_last7,
          audience_hdp_ultra_low_latency_last7,
          audience_1080p_ultra_low_latency_last7,
          audience_2k_ultra_low_latency_last7,
          audience_4k_ultra_low_latency_last7,
          audience_2k_last7,
          audience_4k_last7,
          audience_1080p_last7,
          host_1080p_last7,
          host_2k_last7,
          host_4k_last7
        FROM levels_usage_dod_di_1
        WHERE CAST(tag AS VARCHAR) = 'Industry' AND date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-06') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-04') AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS ""自定义 SQL 查询""
    HAVING COUNT(1) > 0) AS ""t0""
WHERE ""自定义 SQL 查询"".""dim"" = 1 AND ""自定义 SQL 查询"".""rank_level1"" = 4 AND date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d') = ""t0"".""__measure__0""
GROUP BY 18,
  20"
"SELECT SUM(""自定义 SQL 查询"".""host_4k"") AS ""TEMP(Calculation_3519281700079370244)(1075454865)(0)"",
  SUM(""自定义 SQL 查询"".""audience_sd"") AS ""TEMP(Calculation_3519281700079370244)(1133678835)(0)"",
  SUM(""自定义 SQL 查询"".""host_1080p"") AS ""TEMP(Calculation_3519281700079370244)(1312501967)(0)"",
  SUM(""自定义 SQL 查询"".""host_hd"") AS ""TEMP(Calculation_3519281700079370244)(276907208)(0)"",
  SUM(""自定义 SQL 查询"".""video"") AS ""TEMP(Calculation_3519281700079370244)(2929708110)(0)"",
  SUM(""自定义 SQL 查询"".""audience_hd"") AS ""TEMP(Calculation_3519281700079370244)(2930728935)(0)"",
  SUM(""自定义 SQL 查询"".""audience_hdp"") AS ""TEMP(Calculation_3519281700079370244)(3010533957)(0)"",
  SUM(""自定义 SQL 查询"".""host_hdp"") AS ""TEMP(Calculation_3519281700079370244)(30306054)(0)"",
  SUM(""自定义 SQL 查询"".""host_audio"") AS ""TEMP(Calculation_3519281700079370244)(3087054365)(0)"",
  SUM(""自定义 SQL 查询"".""audio"") AS ""TEMP(Calculation_3519281700079370244)(3299350010)(0)"",
  SUM(""自定义 SQL 查询"".""audience_1080p"") AS ""TEMP(Calculation_3519281700079370244)(3628946582)(0)"",
  SUM(""自定义 SQL 查询"".""totalUsage"") AS ""TEMP(Calculation_3519281700079370244)(3847882359)(0)"",
  SUM(""自定义 SQL 查询"".""audience_audio"") AS ""TEMP(Calculation_3519281700079370244)(4109514392)(0)"",
  SUM(""自定义 SQL 查询"".""host_2k"") AS ""TEMP(Calculation_3519281700079370244)(586790827)(0)"",
  SUM(""自定义 SQL 查询"".""host_sd"") AS ""TEMP(Calculation_3519281700079370244)(709512178)(0)"",
  SUM(""自定义 SQL 查询"".""audience_4k"") AS ""TEMP(Calculation_3519281700079370244)(764410224)(0)"",
  SUM(""自定义 SQL 查询"".""audience_2k"") AS ""TEMP(Calculation_3519281700079370244)(943764407)(0)"",
  MIN(""自定义 SQL 查询"".""level1"") AS ""TEMP(attr_level1_nk)(1482809429)(0)"",
  MAX(""自定义 SQL 查询"".""level1"") AS ""TEMP(attr_level1_nk)(3765460736)(0)"",
  ""自定义 SQL 查询"".""level2"" AS ""level2"",
  ""自定义 SQL 查询"".""stat_date"" AS ""stat_date""
FROM (SELECT date,
        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,
      start_date AS start_date_7,
      end_date AS end_date,
      tag,
      area AS Scope,
      dim,
        CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,
      level2,
      level3,
      level4,
      product_level1 AS product_line,
      product_level2,
      product_level3,
      product_level4,
      vid_internal_industry_en AS cid_industry,
      vid_use_case_en AS vid_use_case_cn,
      vid_sector_en,
      ver_type,
      ver,
      os,
      domain,
      country,
      region,
      dim_grouping_name,
        CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,
      total AS totalUsage,
      audio,
      video,
      host_audio,
      audience_audio,
      host_sd,
      host_hd,
      host_hdp,
      host_1080p,
      host_2k,
      host_4k,
      audience_sd,
      audience_hd,
      audience_hdp,
      audience_1080p,
      audience_2k,
      audience_4k,
      audience_audio_low_latency,
      audience_sd_low_latency,
      audience_hd_low_latency,
      audience_hdp_low_latency,
      audience_1080p_low_latency,
      audience_2k_low_latency,
      audience_4k_low_latency,
      audience_audio_ultra_low_latency,
      audience_sd_ultra_low_latency,
      audience_hd_ultra_low_latency,
      audience_hdp_ultra_low_latency,
      audience_1080p_ultra_low_latency,
      audience_2k_ultra_low_latency,
      audience_4k_ultra_low_latency,
      total_last1 AS audio_video_last,
      audio_last1 AS audio_last,
      video_last1 AS video_last,
      video_sd_last1 AS video_sd_last,
      video_hd_last1 AS video_hd_last,
      video_hdp_last1 AS video_hdp_last,
      host_sd_last1 AS host_video_sd_last,
      audience_sd_last1 AS audience_video_sd_last,
      host_hd_last1 AS host_video_hd_last,
      audience_hd_last1 AS audience_video_hd_last,
      host_hdp_last1 AS host_video_hdp_last,
      audience_hdp_last1 AS audience_video_hdp_last,
      host_audio_last1 AS host_audio_last,
      audience_audio_last1 AS audience_audio_last,
      host_video_last1 AS host_video_last,
      audience_video_last1 AS audience_video_last,
      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,
      audience_video_low_latency_last1 AS audience_video_low_latency_last,
      audience_total_low_latency_last1 AS audience_total_low_latency_last,
      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,
      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,
      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,
      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,
      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,
      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,
      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,
      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,
      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,
      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,
      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,
      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,
      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,
      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,
      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,
      audience_2k_last1 AS audience_2k_last,
      audience_4k_last1 AS audience_4k_last,
      audience_1080p_last1 AS audience_1080p_last,
      host_1080p_last1 AS host_1080p_last,
      host_2k_last1 AS host_2k_last,
      host_4k_last1 AS host_4k_last,
      total_last7,
      audio_last7,
      video_last7,
      video_sd_last7,
      video_hd_last7,
      video_hdp_last7,
      host_sd_last7,
      audience_sd_last7,
      host_hd_last7,
      audience_hd_last7,
      host_hdp_last7,
      audience_hdp_last7,
      host_audio_last7,
      audience_audio_last7,
      host_video_last7,
      audience_video_last7,
      audience_audio_low_latency_last7,
      audience_video_low_latency_last7,
      audience_total_low_latency_last7,
      audience_sd_low_latency_last7,
      audience_hd_low_latency_last7,
      audience_hdp_low_latency_last7,
      audience_1080p_low_latency_last7,
      audience_2k_low_latency_last7,
      audience_4k_low_latency_last7,
      audience_audio_ultra_low_latency_last7,
      audience_video_ultra_low_latency_last7,
      audience_total_ultra_low_latency_last7,
      audience_sd_ultra_low_latency_last7,
      audience_hd_ultra_low_latency_last7,
      audience_hdp_ultra_low_latency_last7,
      audience_1080p_ultra_low_latency_last7,
      audience_2k_ultra_low_latency_last7,
      audience_4k_ultra_low_latency_last7,
      audience_2k_last7,
      audience_4k_last7,
      audience_1080p_last7,
      host_1080p_last7,
      host_2k_last7,
      host_4k_last7
    FROM levels_usage_dod_di_1
    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-06') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-04') AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS ""自定义 SQL 查询""
  CROSS JOIN (SELECT MAX(date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d')) AS ""__measure__0""
    FROM (SELECT date,
            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,
          start_date AS start_date_7,
          end_date AS end_date,
          tag,
          area AS Scope,
          dim,
            CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,
          level2,
          level3,
          level4,
          product_level1 AS product_line,
          product_level2,
          product_level3,
          product_level4,
          vid_internal_industry_en AS cid_industry,
          vid_use_case_en AS vid_use_case_cn,
          vid_sector_en,
          ver_type,
          ver,
          os,
          domain,
          country,
          region,
          dim_grouping_name,
            CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,
          total AS totalUsage,
          audio,
          video,
          host_audio,
          audience_audio,
          host_sd,
          host_hd,
          host_hdp,
          host_1080p,
          host_2k,
          host_4k,
          audience_sd,
          audience_hd,
          audience_hdp,
          audience_1080p,
          audience_2k,
          audience_4k,
          audience_audio_low_latency,
          audience_sd_low_latency,
          audience_hd_low_latency,
          audience_hdp_low_latency,
          audience_1080p_low_latency,
          audience_2k_low_latency,
          audience_4k_low_latency,
          audience_audio_ultra_low_latency,
          audience_sd_ultra_low_latency,
          audience_hd_ultra_low_latency,
          audience_hdp_ultra_low_latency,
          audience_1080p_ultra_low_latency,
          audience_2k_ultra_low_latency,
          audience_4k_ultra_low_latency,
          total_last1 AS audio_video_last,
          audio_last1 AS audio_last,
          video_last1 AS video_last,
          video_sd_last1 AS video_sd_last,
          video_hd_last1 AS video_hd_last,
          video_hdp_last1 AS video_hdp_last,
          host_sd_last1 AS host_video_sd_last,
          audience_sd_last1 AS audience_video_sd_last,
          host_hd_last1 AS host_video_hd_last,
          audience_hd_last1 AS audience_video_hd_last,
          host_hdp_last1 AS host_video_hdp_last,
          audience_hdp_last1 AS audience_video_hdp_last,
          host_audio_last1 AS host_audio_last,
          audience_audio_last1 AS audience_audio_last,
          host_video_last1 AS host_video_last,
          audience_video_last1 AS audience_video_last,
          audience_audio_low_latency_last1 AS audience_audio_low_latency_last,
          audience_video_low_latency_last1 AS audience_video_low_latency_last,
          audience_total_low_latency_last1 AS audience_total_low_latency_last,
          audience_sd_low_latency_last1 AS audience_sd_low_latency_last,
          audience_hd_low_latency_last1 AS audience_hd_low_latency_last,
          audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,
          audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,
          audience_2k_low_latency_last1 AS audience_2k_low_latency_last,
          audience_4k_low_latency_last1 AS audience_4k_low_latency_last,
          audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,
          audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,
          audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,
          audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,
          audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,
          audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,
          audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,
          audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,
          audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,
          audience_2k_last1 AS audience_2k_last,
          audience_4k_last1 AS audience_4k_last,
          audience_1080p_last1 AS audience_1080p_last,
          host_1080p_last1 AS host_1080p_last,
          host_2k_last1 AS host_2k_last,
          host_4k_last1 AS host_4k_last,
          total_last7,
          audio_last7,
          video_last7,
          video_sd_last7,
          video_hd_last7,
          video_hdp_last7,
          host_sd_last7,
          audience_sd_last7,
          host_hd_last7,
          audience_hd_last7,
          host_hdp_last7,
          audience_hdp_last7,
          host_audio_last7,
          audience_audio_last7,
          host_video_last7,
          audience_video_last7,
          audience_audio_low_latency_last7,
          audience_video_low_latency_last7,
          audience_total_low_latency_last7,
          audience_sd_low_latency_last7,
          audience_hd_low_latency_last7,
          audience_hdp_low_latency_last7,
          audience_1080p_low_latency_last7,
          audience_2k_low_latency_last7,
          audience_4k_low_latency_last7,
          audience_audio_ultra_low_latency_last7,
          audience_video_ultra_low_latency_last7,
          audience_total_ultra_low_latency_last7,
          audience_sd_ultra_low_latency_last7,
          audience_hd_ultra_low_latency_last7,
          audience_hdp_ultra_low_latency_last7,
          audience_1080p_ultra_low_latency_last7,
          audience_2k_ultra_low_latency_last7,
          audience_4k_ultra_low_latency_last7,
          audience_2k_last7,
          audience_4k_last7,
          audience_1080p_last7,
          host_1080p_last7,
          host_2k_last7,
          host_4k_last7
        FROM levels_usage_dod_di_1
        WHERE CAST(tag AS VARCHAR) = 'Industry' AND date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-06') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-04') AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS ""自定义 SQL 查询""
    HAVING COUNT(1) > 0) AS ""t0""
WHERE ""自定义 SQL 查询"".""dim"" = 1 AND date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d') = ""t0"".""__measure__0""
GROUP BY 20,
  21"
"SELECT SUM(""自定义 SQL 查询"".""audience_low_latency_last1"") AS ""TEMP(Calculation_230316907702542336)(2007846651)(0)"",
  SUM(""自定义 SQL 查询"".""audience_low_latency"") AS ""TEMP(Calculation_230316907702542336)(2627877912)(0)"",
  SUM(""自定义 SQL 查询"".""total"") AS ""TEMP(Calculation_5203557528859017219)(2253843611)(0)"",
  SUM(""自定义 SQL 查询"".""total_last1"") AS ""TEMP(Calculation_5203557528859017219)(3076278274)(0)"",
  SUM(""自定义 SQL 查询"".""audio_last1"") AS ""TEMP(Calculation_5203557528863870981)(2207581090)(0)"",
  SUM(""自定义 SQL 查询"".""audio"") AS ""TEMP(Calculation_5203557528863870981)(4234702922)(0)"",
  SUM(""自定义 SQL 查询"".""video_last1"") AS ""TEMP(Calculation_5203557528864096263)(1192334319)(0)"",
  SUM(""自定义 SQL 查询"".""video"") AS ""TEMP(Calculation_5203557528864096263)(3647352276)(0)"",
  SUM(""自定义 SQL 查询"".""audience"") AS ""TEMP(Calculation_534802460955746306)(1306364424)(0)"",
  SUM(""自定义 SQL 查询"".""audience_last1"") AS ""TEMP(Calculation_534802460955746306)(2505681848)(0)"",
  SUM(""自定义 SQL 查询"".""audience_audio"") AS ""TEMP(Calculation_534802460956037124)(1868547182)(0)"",
  SUM(""自定义 SQL 查询"".""audience_audio_last1"") AS ""TEMP(Calculation_534802460956037124)(2218970377)(0)"",
  SUM(""自定义 SQL 查询"".""audience_video_last1"") AS ""TEMP(Calculation_534802460956319750)(188915252)(0)"",
  SUM(""自定义 SQL 查询"".""audience_video"") AS ""TEMP(Calculation_534802460956319750)(2182583436)(0)"",
  MAX(""自定义 SQL 查询"".""stat_date"") AS ""TEMP(attr_stat_date_nk)(2102638629)(0)"",
  MIN(""自定义 SQL 查询"".""stat_date"") AS ""TEMP(attr_stat_date_nk)(2790680713)(0)"",
  SUM(""自定义 SQL 查询"".""audience_audio_low_latency_last1"") AS ""TEMP(audience_audio_last1_rate (复制)_230316907704033282)(67"",
  SUM(""自定义 SQL 查询"".""audience_audio_low_latency"") AS ""TEMP(audience_audio_last1_rate (复制)_230316907704033282)(83"",
  SUM(""自定义 SQL 查询"".""host_audio_last1"") AS ""TEMP(audience_audio_last1_rate (复制)_534802460956618761)(24"",
  SUM(""自定义 SQL 查询"".""host_audio"") AS ""TEMP(audience_audio_last1_rate (复制)_534802460956618761)(36"",
  SUM(""自定义 SQL 查询"".""host_last1"") AS ""TEMP(audience_last1_rate (复制)_534802460956647435)(15035501"",
  SUM(""自定义 SQL 查询"".""host"") AS ""TEMP(audience_last1_rate (复制)_534802460956647435)(24867219"",
  SUM(""自定义 SQL 查询"".""audience_video_low_latency_last1"") AS ""TEMP(audience_low_latency_last1_rate (复制)_2303169077218304"",
  SUM(""自定义 SQL 查询"".""audience_video_low_latency"") AS ""TEMP(audience_low_latency_last1_rate (复制)_2303169077218301"",
  SUM(""自定义 SQL 查询"".""host_video"") AS ""TEMP(audience_video_last1_rate (复制)_534802460956696589)(26"",
  SUM(""自定义 SQL 查询"".""host_video_last1"") AS ""TEMP(audience_video_last1_rate (复制)_534802460956696589)(42"",
  SUM(""自定义 SQL 查询"".""audience_video_low_latency"") AS ""sum_audience_video_low_latency_ok""
FROM (SELECT date,
      SUBSTR(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) AS date_range_1,
      SUBSTR(CAST(end_date AS VARCHAR), 1, 10) AS date_range_2,
      stat_period,
        CASE WHEN CAST(stat_period AS VARCHAR) = 'day' THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,
      area,
      vid,
      project,
      company_id AS cid,
      company_name AS company,
      customer_level AS level,
      vid_internal_industry_en AS industry,
      vid_use_case_cn,
      csdc_owner,
      os,
      ver,
      ver_type,
      product_level1,
      product_level2,
      product_level3,
      total,
      audio,
      video,
      video_sd,
      video_hd,
      video_hdp,
        host_audio + host_video AS host,
      host_audio,
      host_video,
      host_sd,
      host_hd,
      host_hdp,
        audience_audio + audience_video AS audience,
        audience_audio_low_latency + audience_video_low_latency AS audience_low_latency,
      audience_audio,
      audience_audio_low_latency,
      audience_video,
      audience_video_low_latency,
      audience_sd,
      audience_sd_low_latency,
      audience_hd,
      audience_hd_low_latency,
      audience_hdp,
      audience_hdp_low_latency,
      total_last1,
      audio_last1,
      video_last1,
      video_sd_last1,
      video_hd_last1,
      video_hdp_last1,
        host_audio_last1 + host_video_last1 AS host_last1,
      host_audio_last1,
      host_video_last1,
        audience_audio_last1 + audience_video_last1 AS audience_last1,
        audience_audio_low_latency_last1 + audience_video_low_latency_last1 AS audience_low_latency_last1,
      audience_audio_last1,
      audience_audio_low_latency_last1,
      audience_video_last1,
      audience_video_low_latency_last1,
      total_last7,
      audio_last7,
      video_last7,
      video_sd_last7,
      video_hd_last7,
      video_hdp_last7,
        host_audio_last7 + host_video_last7 AS host_last7,
      host_audio_last7,
      host_video_last7,
        audience_audio_last7 + audience_video_last7 AS audience_last7,
        audience_audio_low_latency_last7 + audience_video_low_latency_last7 AS audience_low_latency_last7,
      audience_audio_last7,
      audience_audio_low_latency_last7,
      audience_video_last7,
      audience_video_low_latency_last7
    FROM report_datahub.vendor_vid_usage_di_1
    WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-06') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-06') AND CAST(vid AS VARCHAR) = CAST(428342 AS VARCHAR) AND dim = 1) AS ""自定义 SQL 查询""
  CROSS JOIN (SELECT MAX(date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d')) AS ""__measure__0""
    FROM (SELECT date,
          SUBSTR(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) AS date_range_1,
          SUBSTR(CAST(end_date AS VARCHAR), 1, 10) AS date_range_2,
          stat_period,
            CASE WHEN CAST(stat_period AS VARCHAR) = 'day' THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,
          area,
          vid,
          project,
          company_id AS cid,
          company_name AS company,
          customer_level AS level,
          vid_internal_industry_en AS industry,
          vid_use_case_cn,
          csdc_owner,
          os,
          ver,
          ver_type,
          product_level1,
          product_level2,
          product_level3,
          total,
          audio,
          video,
          video_sd,
          video_hd,
          video_hdp,
            host_audio + host_video AS host,
          host_audio,
          host_video,
          host_sd,
          host_hd,
          host_hdp,
            audience_audio + audience_video AS audience,
            audience_audio_low_latency + audience_video_low_latency AS audience_low_latency,
          audience_audio,
          audience_audio_low_latency,
          audience_video,
          audience_video_low_latency,
          audience_sd,
          audience_sd_low_latency,
          audience_hd,
          audience_hd_low_latency,
          audience_hdp,
          audience_hdp_low_latency,
          total_last1,
          audio_last1,
          video_last1,
          video_sd_last1,
          video_hd_last1,
          video_hdp_last1,
            host_audio_last1 + host_video_last1 AS host_last1,
          host_audio_last1,
          host_video_last1,
            audience_audio_last1 + audience_video_last1 AS audience_last1,
            audience_audio_low_latency_last1 + audience_video_low_latency_last1 AS audience_low_latency_last1,
          audience_audio_last1,
          audience_audio_low_latency_last1,
          audience_video_last1,
          audience_video_low_latency_last1,
          total_last7,
          audio_last7,
          video_last7,
          video_sd_last7,
          video_hd_last7,
          video_hdp_last7,
            host_audio_last7 + host_video_last7 AS host_last7,
          host_audio_last7,
          host_video_last7,
            audience_audio_last7 + audience_video_last7 AS audience_last7,
            audience_audio_low_latency_last7 + audience_video_low_latency_last7 AS audience_low_latency_last7,
          audience_audio_last7,
          audience_audio_low_latency_last7,
          audience_video_last7,
          audience_video_low_latency_last7
        FROM report_datahub.vendor_vid_usage_di_1
        WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-06') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-06') AND CAST(vid AS VARCHAR) = CAST(428342 AS VARCHAR) AND dim = 1) AS ""自定义 SQL 查询""
    HAVING COUNT(1) > 0) AS ""t0""
WHERE date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d') = ""t0"".""__measure__0""
HAVING COUNT(1) > 0"
"SELECT ""自定义 SQL 查询"".""srcCountry"" AS ""srcCountry"",
  ""自定义 SQL 查询"".""srcDomain"" AS ""srcDomain"",
  ""自定义 SQL 查询"".""srcisp"" AS ""srcisp"",
    CASE WHEN SUM(""自定义 SQL 查询"".""p2s_total"") >= 0 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100 THEN '0-100' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 1000 THEN '100-1000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 1000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 10000 THEN '1000-10000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 10000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100000 THEN '10000-100000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100000 THEN '100000以上' ELSE 'other' END AS ""usr_Calculation_5363224211563417605_nk""
FROM (SELECT date AS ""date"",
      src_domain AS ""srcDomain"",
      src_country AS ""srcCountry"",
      dest_idc AS ""idc"",
      speaker_ip_isp AS ""srcisp"",
      speaker_vos_ip,
      delay_25 AS ""p2s_Delay25"",
      delay_50 AS ""p2s_Delay50"",
      delay_75 AS ""p2s_Delay75"",
      delay_100 AS ""p2s_Delay100"",
      delay_125 AS ""p2s_Delay125"",
      delay_150 AS ""p2s_Delay150"",
      delay_total,
      lost_ratio_5 AS ""p2s_lostRatio"",
      lostratio_total AS ""p2s_total"",
      jitter95_50 AS ""p2s_jitter95_50"",
      jitter95_100 AS ""p2s_jitter95_100"",
      jitter95_200 AS ""p2s_jitter95_200"",
      jitter95_300 AS ""p2s_jitter95_300"",
      jitter95_total,
      product_line,
      product_type
    FROM media.p2s_cover_oversea_ip
    WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-25') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-01')) AS ""自定义 SQL 查询""
WHERE ""自定义 SQL 查询"".""srcisp"" IN ('1telecom.com.br', '21.com.pk', '3s.com.tn', '4inet.com.br', '73s.com.br', 'a1.by', 'a1.si', 'a3.se', 'aan-ict.com', 'aapt.com.au', 'abcom.al', 'absolutnet.com.br', 'accesshaiti.com', 'acelerate.com', 'acertelecom.com.br', 'acesso10.net.br', 'acessotelecomunicacoes.com.br', 'actcorp.in', 'afghan-wireless.com', 'afghantelecom.af', 'africell.ug', 'afriqnetworks.co.ke', 'agatangelo.com.br', 'agni.com', 'aguasdelcolorado-lp.com.ar', 'airmax.com.pk', 'airnet.net.br', 'airtel.cd', 'airtel.cg', 'airtel.co.rw', 'airtel.co.tz', 'airtel.co.ug', 'airtel.co.zm', 'airtel.com', 'airtel.mg', 'airtel.mw', 'airtel.ne', 'airtel.td', 'ais.co.th', 'aknet.kg', 'albtelecom.al', 'alfa.com.lb', 'alfanet.az', 'alfanet.tv', 'algartelecom.com.br', 'algerietelecom.dz', 'ALIYUN', 'aljeel.ly', 'allconecta.com.br', 'allo.my', 'almadarisp.com', 'aloo.com.br', 'alriyada-net.net', 'alsardfiber.com', 'altanettelecom.com.br', 'altice.com.do', 'amatelecom.com.br', 'amazon.com', 'americanet.com.br', 'americatel.com.pe', 'amorimtelecom.com.br', 'amplia.co.tt', 'amturbonet.com.br', 'anditel.com.co', 'angolacables.co.ao', 'ans.af', 'antel.com.uy', 'aoun-networks.com', 'apsfl.in', 'aptg.com.tw', 'aranetinfo.com.br', 'ariasat.af', 'ariastelecom.com.br', 'ario.net', 'arn.dz', 'arsat.com.ar', 'artnet.pl', 'asiabtelecom.com', 'asiacell.com', 'asianvision.com.ph', 'ask4.com', 'asnet.com.br', 'asolucaoinfo.com.br', 'aster.com.do', 'ativanetwork.com.br', 'att.com', 'avantel.co', 'avianet.com.br', 'awasr.com', 'aya.sy', 'azercell.com', 'azeronline.com', 'azeurotel.com', 'azqtel.com', 'azstarnet.az', 'aztecacomunicaciones.com', 'aztelekom.az', 'babilon-t.tj', 'baehost.com', 'baghdad-link.com', 'bakcell.com', 'baktelecom.az', 'baktun.com.gt', 'batelco.com', 'bayan.com.ph', 'beeline.am', 'beeline.kg', 'beeline.kz', 'beeline.ru', 'beeline.tj', 'beeline.uz', 'belizetelemedia.net', 'beltelecom.by', 'beskidmedia.pl', 'bezeqint.net', 'bhtelecom.ba', 'bitakat.sy', 'bitcom.psi.br', 'bitel.com.pe', 'blinkload.cloud', 'blue.net.gt', 'bmjnet.com.br', 'bnet.ps', 'bouyguestelecom.fr', 'brasilinfo.net.br', 'brasilnetcp.net.br', 'brasnetinformatica.com.br', 'brcentral.com.br', 'bredband2.com', 'brisanet.com.br', 'brsite.com.br', 'brxtelecom.com.br', 'bsnl.co.in', 'bt.bt', 'bt.com', 'btc.bw', 'btcbahamas.com', 'buana.net', 'buechele-networks.de', 'bvitourism.com', 'bwtelecom.com', 'cabangu.com.br', 'cablebahamas.com', 'cablecolor.hn', 'cabledelancer.com', 'cabledelnorte.com', 'cablelink.com.ph', 'cablemar.net', 'cablemax.com.do', 'cablenet.com.cy', 'cableonda.com', 'cableondaoriental.com', 'cabletica.com', 'cablevision.com.ar', 'canal-plus.com', 'canar.sd', 'cantv.com.ve', 'caribcable.com', 'caribserve.net', 'caxiasontelecom.com.br', 'cdn77.com', 'cdns.net', 'cednet.com.br', 'celcom.com.my', 'cell-net.net', 'cellc.co.za', 'cellcom.co.il', 'centraltv.bz', 'centurylink.com', 'ceranetworks.com', 'ceretechs.com', 'charter.com', 'ChinaMobile', 'ChinaTelecom', 'ChinaUnicom', 'chinguitel.mr', 'chltech.net', 'choopa.com', 'cht.com.tw', 'citicableworld.com', 'claro.com.ar', 'claro.com.br', 'claro.com.co', 'claro.com.do', 'claro.com.ec', 'claro.com.gt', 'claro.com.hn', 'claro.com.ni', 'claro.com.pa', 'claro.com.pe', 'claro.com.sv', 'claro.cr', 'clarochile.cl', 'claropr.com', 'clearpath.net.ph', 'clig.com.br', 'clnetworks-sa.com', 'cloudflare.com', 'cloudinnovation.org', 'clouvider.co.uk', 'clubnet.co.mz', 'cmet.net', 'cnet.af', 'cnt.gob.ec', 'cogentco.com', 'colombiamastv.co', 'colombiatel.co', 'colsecor.com.ar', 'comcast.com', 'comhem.se', 'comnt.com.br', 'comteco.com.bo', 'conectaminas.com.br', 'conectbm.com.br', 'conectcor.com.br', 'conective.sv', 'conexaotelecom.net.br', 'connect.az', 'connect.net.pk', 'connecti.net.br', 'connectinternet.com.br', 'conquesttelecom.com.br', 'convergeict.com', 'convergenze.it', 'coolnet.ps', 'coopetel.org', 'cooptortu.com.ar', 'copaco.com.py', 'copeltelecom.com', 'cosmote.gr', 'costadosol.tv.br', 'cotas.com', 'cotecal.com.ar', 'cotel.bo', 'cprm.net', 'csuc.cat', 'cte.net.br', 'cwc.com', 'cwnetworks.com', 'cwpanama.com', 'cyber.net.pk', 'cyberia.net.lb', 'cyberwave.com.ar', 'dascacable.com', 'datanet.iq', 'dauphintelecom.com', 'davitel.com.ar', 'dcc.ps', 'dctv.com.ph', 'delta-telecom.net', 'delta-x.ua', 'desktop.com.br', 'destinycable.com.ph', 'dflash.com.br', 'dialnet.net', 'dialog.lk', 'digi.com.my', 'digicelgroup.com', 'digimobil.es', 'digital-vm.com', 'digitalocean.com', 'digitel.com.ve', 'digitel.ph', 'dimensiondata.com', 'directv.com.ar', 'directvla.com.co', 'discoverflow.co', 'dishtele.com', 'djiboutitelecom.dj', 'dna.fi', 'docomopacific.com', 'domru.ru', 'DRPENG', 'dtac.co.th', 'du.ae', 'dumaimandirinet.id', 'e-lcom.sy', 'eaglenet.net.lb', 'earthlink.iq', 'eastlink.ca', 'ecom.net.do', 'edatel.com.co', 'ee.co.uk', 'elcat.kg', 'elisa.ee', 'elsuhdnet.com', 'embratel.com.br', 'emcali.net.co', 'emtel.net.co', 'engeplus.com.br', 'enlacevision.com', 'enredhn.com', 'entel.bo', 'entel.cl', 'entel.pe', 'enteriw.com.br', 'ert.com.co', 'estnoc.ee', 'estrelatel.com', 'etapa.net.ec', 'etb.com', 'etecsa.cu', 'ethiotelecom.et', 'ethtelecom.com.br', 'etisalat.ae', 'etisalat.af', 'etisalat.eg', 'etllao.com', 'evo.uz', 'exitovision.com', 'expand.tv.br', 'express.com.ar', 'faciliti.com.br', 'falco-networks.com', 'farahnet.net.lb', 'fariya.com', 'farsroute.af', 'fastiraq.com', 'fastnetisp.com', 'fastprovedor.net.br', 'fdnet.com.br', 'fetnet.net', 'fiber-sat.net', 'fiberathome.my', 'fiberbandalarga.com.br', 'fibercom.com.pk', 'fibergrid.net', 'fiberlink.net.pk', 'fibernet.uz', 'fibertelecom-isp.com.br', 'fiberwaves.com', 'fiberway.com.ar', 'fiberx.net', 'fibra1.com.br', 'fibralink.com.br', 'fibranet.ec', 'filprod-dgte.ph', 'fittelecom.com.br', 'flashfibra.net.br', 'flink.uz', 'flx.com.pe', 'flybyte.com.br', 'foaaa.com', 'forthnet.gr', 'fourtelecom.com', 'free.fr', 'freenet-group.de', 'fsmtc.fm', 'ft.fo', 'fusion.ps', 'g8.net.br', 'gals.uz', 'gcore.lu', 'gd.tt', 'gegatelecom.net', 'gemzo.ps', 'genettelecom.net.br', 'gerrys.net', 'gigaline.com.br', 'gigalink.com.br', 'giganor.com', 'gigared.com.ar', 'gironetfibra.com.br', 'glink.net.br', 'glnet.com.br', 'global-layer.com', 'globe.com.ph', 'globenet.net', 'gloworld.com', 'glpnet.com.br', 'gmo.jp', 'go.com.mt', 'godnet.com.br', 'golddata.net', 'google.com', 'goonet.com.br', 'gorannet.net', 'gptc.ly', 'grajaunet.com.br', 'grameenphone.com', 'gramnet.com.br', 'groupnet-iq.com', 'gruponewlife.com.br', 'grupotvcable.com', 'gtd.cl', 'gthost.com', 'gtt.co.gy', 'gtt.net', 'guestchoicerd.com', 'hadara.ps', 'halasat.net', 'hayat-isp.net', 'hbinfo.com.br', 'heficed.com', 'hetzner.com', 'highspeed.com.tr', 'hilink.com.br', 'holistica.com.br', 'homenet.cl', 'homenet.sumy.ua', 'hondutel.hn', 'hopnet.com.br', 'hormuud.com', 'hosteam.pl', 'hosteurope.de', 'hostroyale.com', 'hotnet.net.il', 'hrins.net', 'hughes.com', 'hughes.com.br', 'hvtv.co', 'hypernet.sy', 'i-tower.net', 'iam.ma', 'ibaaco.net', 'ibitelecom.com.br', 'ibiunet.com.br', 'ibw.com.ni', 'ice.no', 'iclik.co', 'ideay.com', 'idm.net.lb', 'ifxnetworks.com', 'ifxnw.com.ve', 'iij.ad.jp', 'iinet.net.au', 'impactnet.com.br', 'indosatooredoo.com', 'inea.pl', 'inet.sy', 'inethn.com', 'inetminas.com.br', 'infinity.iq', 'infologti.com.br', 'infonet.ee', 'infornet.in', 'instatelecom.com', 'intelsat.com', 'inter.com.ve', 'interbourg.com.ar', 'interconnects.us', 'interlink.com.ar', 'internexa.com', 'internexsolutions.com', 'internext.cz', 'intesanet.net', 'inwi.ma', 'io-global.com', 'iomart.com', 'iontel.ly', 'ip.ro', 'iparatodos.com.ar', 'ipc.ph', 'ipcore.com.my', 'iplan.com.ar', 'iptp.net', 'iqnet.com', 'iranettelecom.com.br', 'is.com.gh', 'istanbuldc.com', 'istv.uz', 'it7.net', 'ite.net', 'itelkom.co', 'itldc.com', 'itsbrasil.net', 'iveloz.net.br', 'ivitelecom.com.br', 'jdimax.com', 'jetnet.ps', 'jhcs.com', 'jio.com', 'jotazo.com.br', 'jpproviders.com.br', 'jrconect.com', 'jt.iq', 'jtglobal.com', 'juquianet.net.br', 'k2telecom.com.br', 'kabayancablegroup.com', 'kalibocable.net', 'kamatera.com', 'kaopuyun.com', 'karibcable.com', 'katv1.com', 'knet-telecom.com', 'korektel.com', 'kt.kg', 'kyivstar.ua', 'lagoon.nc', 'laotel.com', 'lazertelecom.com', 'leadertelecom.ru', 'leaseweb.com', 'level3.com', 'libyana.ly', 'ligue.net', 'link.net.pk', 'linkem.com', 'linode.com', 'linxbr.com.br', 'liquidtelecom.com', 'liquidtelecom.net', 'litc.ly', 'litoraltibau.com.br', 'lizcat.com', 'logic.ky', 'logicweb.com', 'logix.com', 'loina.wf', 'lonsdalenet.co.uk', 'lpinternet.com.br', 'lpnet.com.br', 'ltt.ly', 'lunasat.com', 'm247.com', 'mada.ps', 'maisinternet.net.br', 'maisprovedor.com.br', 'maksnet.net', 'marandu.com.ar', 'masaratcom.com', 'masternet.net.br', 'matelecon.com.br', 'matosnet.com.br', 'matrixisp.com', 'mavnet.com.br', 'maxcomm.com.br', 'maxis.com.my', 'mayatama.net', 'mbgtecnologias.com.br', 'mc.inf.br', 'mc.net.co', 'mediaserv.com', 'megacable.com.ar', 'megacable.com.mx', 'megacom.kg', 'megafon.ru', 'megafon.tj', 'megaline.kg', 'megalinkcorp.com.br', 'meganetsalto.com.br', 'megared.com.gt', 'melita.com', 'metronethn.com', 'metrotel.com.ar', 'metrotel.com.co', 'mhnet.com.br', 'microsoft.com', 'microtell.com.br', 'mimonet.com.br', 'minasnet.net', 'mksnet.com.br', 'mnets.net', 'mobi.net.lb', 'mobile.free.fr', 'mobilinkgsm.com', 'mobily.com.sa', 'mobitel.lk', 'mobtelecom.com.br', 'mountainview.com.ph', 'movistar.com.pa', 'mrynet.com.br', 'mtilabs.com', 'mtn.ci', 'mtn.co.rw', 'mtn.co.ug', 'mtn.com.af', 'mtn.com.gh', 'mtn.com.sy', 'mtn.sd', 'mtncongo.net', 'mtnirancell.ir', 'mtnonline.com', 'mts.rs', 'mts.ru', 'mts.ua', 'multicablehonduras.com', 'multiplaytelecom.com.br', 'mundopacifico.cl', 'musurit.com', 'myrepublic.net', 'mysky.com.ph', 'nar.az', 'natcom.com.ht', 'nawand.net', 'nayatel.com', 'neda.af', 'nedetel.net', 'neotel.co.za', 'net.sy', 'net11.com.br', 'netbarretos.com.br', 'netcartelecom.com.br', 'netco.uz', 'netcomplusve.com', 'netfibra.com', 'netfibratelecomunicacoes.com.br', 'netforcetelecom.com.br', 'netglobal.it', 'netia.pl', 'netiontelecom.com.br', 'netiq.sk', 'netlife.ec', 'netlinetelecom.com.br', 'netprolb.com', 'netsaojose.com.br', 'netseg.net.br', 'netserv.com.br', 'netstream.ps', 'netuno.net', 'neunet.com.ar', 'newcloudnetworks.com', 'newertech.com.br', 'newnet.psi.br', 'newroztelecom.com', 'newstarmax.ps', 'nextel.com.br', 'nextnetwork.com.br', 'nexttel.cm', 'nile-online.com', 'nipcable.com.br', 'niponet.com.br', 'niqturbo.com.br', 'nmultifibra.com.br', 'nortech.com.ar', 'northtelecom.af', 'nortis.ma', 'nos.pt', 'nova.is', 'novafibratelecom.com.br', 'novanetwork.com.br', 'ntcnet.com.br', 'nterconexionhn.com', 'nurtelecom.kg', 'oeste-rede.com.br', 'oesteline.com.br', 'oi.com.br', 'olafibra.com.br', 'omantel.om', 'omni.net.br', 'omniya.sy', 'omnya.co', 'onatel.bf', 'onemax.com', 'online.net', 'online.net.br', 'onnethn.com', 'oops.tv.br', 'ooredoo.com.mm', 'ooredoo.om', 'ooredoo.qa', 'ooredoo.tn', 'opstelecom.com.br', 'opt.nc', 'optus.com.au', 'oracle.com', 'orange-bissau.com', 'orange.bf', 'orange.cd', 'orange.ci', 'orange.com', 'orange.eg', 'orange.jo', 'orange.ma', 'orange.mg', 'orange.ne', 'orange.pl', 'orange.ps', 'orange.sk', 'orange.tn', 'orangemali.com', 'orbitcable.com.do', 'orbitelecom.com.br', 'oriontelekom.rs', 'outremer-telecom.fr', 'ovh.com', 'paikltd.com', 'palautelecoms.com', 'paltel.ps', 'palwifi.net', 'pandanetwork.com.br', 'pccw.com', 'personal.com.py', 'petaexpress.com', 'petrynet.com.br', 'pinspb.ru', 'pirmamgroup.com', 'planetcabletv.com', 'platinum.uz', 'play.pl', 'pldt.com', 'plus.pl', 'plusnetfoz.com', 'pnccpalau.com', 'pointtelecom.com.br', 'post.lu', 'powerline.com.br', 'powernetsolutions.com.br', 'pratatelecom.com.br', 'predialnet.com.br', 'primatecmt.com.br', 'privatelayer.com', 'privax.com', 'prodatanet.com.ph', 'prokk.net', 'provale.com.br', 'provedorsuperconnect.com.br', 'provedoruniversal.com.br', 'providersnet.com.br', 'psn.co.id', 'psychz.net', 'ptcl.com.pk', 'puntonet.ec', 'qitelecom.net.br', 'qnax.com.br', 'qubee.com.pk', 'quick.com.br', 'quickline.ch', 'radiolan.sk', 'ragtek.com.br', 'rahanet.af', 'ramnet.com.br', 'rapidatelecom.com.br', 'razaoinfo.com.br', 'rdconlinebd.net', 'redecom.net.br', 'redenilf.com.br', 'redetelecom.com.br', 'redfoxtelecom.com.br', 'redintercable.com.ar', 'researchsrl.com.ar', 'rightel.ir', 'riotel.com.ar', 'rmsconnect.net.br', 'rnova.com.br', 'rnp.br', 'robi.com.bd', 'rogers.com', 'roshan.af', 'royalcable.com.ph', 'rsonet.com.ar', 'rt.ru', 'runnet.sy', 'rvrnetworks.com', 'sadattelecom.af', 'safaricom.co.ke', 'salartel.com', 'salestelecom.net.br', 'samanet.sy', 'sanluisctv.com.ar', 'sattrakt.com', 'sawaisp.sy', 'sbb.rs', 'sco.gov.pk', 'sconfibras.com.br', 'scopesky.com', 'scrio.com.br', 'scs-net.org', 'seacom.mu', 'sebratel.com.br', 'sepcom.com.co', 'sercomtel.com.br', 'ses.com', 'seven-sky.net', 'sfox.com.br', 'sfr.com', 'sfr.re', 'sglinknet.com.br', 'shams-tele.com', 'sharktech.net', 'sigmanet.com.br', 'simbanet.net', 'simbatv.co.ug', 'sinusnet.pl', 'sion.com', 'sitel.com.br', 'sjnettelecom.com.br', 'sky.com', 'sky.com.br', 'sky.net.co', 'skylogic.it', 'skylonhost.com', 'skyonline.net.ar', 'slt.lk', 'smart-bz.com', 'smart.com.ph', 'smartlink-isp.com', 'smartwavesnetwork.com', 'sobralnet.com.br', 'socitel.com.br', 'sodobrasil.net.br', 'softether.jp', 'softlinknet.com', 'sol.az', 'solucaonetwork.com', 'solunet.com.ar', 'somtelnetwork.net', 'sonatel.sn', 'speedclick.ps', 'speedjettelecom.com.br', 'speednetcomunicacoes.com.br', 'speedrs.com.br', 'spinservers.com', 'splink.net.br', 'sprint.com', 'st.uz', 'stantelecom.net', 'star1.com.br', 'starcommunicationbd.com', 'starktel.com', 'starman.com.br', 'starnet.cz', 'starnettelecom.com.br', 'stationnet.com.br', 'stc.com.sa', 'stem.co.za', 'strongvpn.com', 'stv.ee', 'suanet.net.br', 'suatelecom.com.br', 'sudatel.sd', 'sudatel.sn', 'sudoestetelecom.com.br', 'sumicity.net.br', 'supercable.com.ve', 'supercabotv.com.br', 'supercanal-arlink.com.ar', 'supercellnetwork.com', 'superlink.ps', 'superonline.net', 'supranet.com.br', 'sure.com', 'surfshark.com', 'swan.sk', 'swisscom.ch', 'sygo.com.br', 'synapsecom.gr', 'syriatel.sy', 't-mobile.com', 't-mobile.cz', 't-mobile.pl', 't1chihuahua.com', 'tajnet.tj', 'takamol.sy', 'talia.net', 'talktalkgroup.com', 'tangerine.co.ug', 'tarinnet.info', 'tascom.com.br', 'tashicell.com', 'tbtelecom.net.br', 'tca.com.br', 'tcell.tj', 'tchenet.net', 'tcheturbo.com.br', 'tci.ir', 'tct.ir', 'tcvnet.com.br', 'tdc.dk', 'tdkom.com.br', 'techcomprovedor.com.br', 'tecnologiasvirtuales.com', 'tedata.net', 'teko.com.ni', 'telbru.com.bn', 'telconet.ec', 'telcorp.com.ve', 'tele2.com', 'tele2.kz', 'tele2.ru', 'telebras.com.br', 'telebucaramanga.com.co', 'telecablecentral.com', 'telecablecr.com', 'telecablelaunion.com', 'telecel-rca.com', 'telecelfaso.bf', 'telecentro.com.ar', 'telecom.com.ar', 'telecom.kz', 'telecom.pt', 'telecom.tm', 'telecomdados.com.br', 'telecomitalia.it', 'telecomitalia.sm', 'telecomprovider.com.br', 'telefonica.co', 'telefonica.com', 'telefonica.com.pe', 'telefonica.es', 'telefonicachile.cl', 'teleguam.net', 'teleimagensatelital.com', 'telekom.de', 'telekom.hu', 'telekom.mk', 'telekom.sk', 'telemach.si', 'telemgroup.sx', 'telemontv.com', 'telenet.be', 'telenor.com', 'telenor.com.pk', 'telenor.rs', 'telenord.com', 'telepost.gl', 'telered.com.ar', 'telesis.hn', 'telesur.sr', 'televiaducto.com.do', 'teleyemen.com.ye', 'telia.com', 'telia.ee', 'telium.com.br', 'telkom.co.id', 'telkomsel.com', 'tellcorpce.com.br', 'telmex.com', 'telmexchile.cl', 'telnets.com.br', 'telpin.com.ar', 'telstra.com', 'telsur.cl', 'telvgg.coop', 'tely.com.br', 'tencent.com', 'tepenet.com.tr', 'terra.net.lb', 'terratransit.de', 'tfl.com.fj', 'thecable.net', 'thegeniusisp.com', 'thglobalvision.net', 'thinkhuge.net', 'thsprovider.com.br', 'thundertecnologia.com.br', 'tigo.co.rw', 'tigo.com.bo', 'tigo.com.co', 'tigo.com.gt', 'tigo.com.hn', 'tigo.com.py', 'tigo.com.sv', 'tigo.cr', 'tigo.sn', 'tigrisnet.net', 'tim.com.br', 'time.com.my', 'timortelecom.tl', 'tiqanyatalshabaka.com', 'titania.com.br', 'tixtelecom.com.br', 'tm.com.my', 'togotelecom.tg', 'toledonet.com.br', 'tolrs.com.br', 'topcomunications.com', 'topnet.tn', 'tot.co.th', 'totalplay.com.mx', 'toya.net.pl', 'tpg.com.au', 'tpp.com.ar', 'tps.uz', 'transdatelecom.com', 'transeurocom.az', 'transnexa.com', 'tre.se', 'tremnet.com.br', 'tri.co.id', 'trixnet.com.br', 'truecorp.co.th', 'tstt.co.tt', 'tsukaeru.net', 'ttcl.co.tz', 'tunisietelecom.tn', 'turbonetwifi.com.br', 'turk.net', 'turkcell.com.tr', 'turktelekom.com.tr', 'turontelecom.uz', 'tvc.tv.br', 'tvkhajnowka.pl', 'tvn.tv.br', 'tvsom.com.br', 'tw1.com', 'twmbroadband.com', 'u.com.my', 'uatelecom.af', 'ucell.uz', 'ufinet.com', 'ufone.com', 'ukrtelecom.ua', 'ultranetpb.com.br', 'umniah.com', 'unartel.cz', 'une.com.co', 'unifi.com.my', 'unifique.com.br', 'unitel.com.la', 'uniteltmais.cv', 'unonet.com.br', 'unusinc.com', 'uolsinectis.com.ar', 'upc.at', 'upc.cz', 'upcspl.in', 'upfournet.com.br', 'upnettelecom.net.br', 'usatv.port48.com', 'uts.cw', 'uztelecom.uz', 'vcnetwork.com.br', 'verizon.com', 'vextelecom.com.br', 'vh.net', 'vi.choice-wireless.com', 'viaband.net.br', 'vianet.com.br', 'vianovatelecom.com.br', 'viaradiodourados.com.br', 'viareal.com.br', 'viettel.com.vn', 'view.sy', 'vilanovanet.com', 'vini.pf', 'vip.mk', 'vipbrtelecom.com.br', 'vipnettelecom.com.br', 'virginmedia.com', 'virginmedia.ie', 'virtex.com.br', 'visp.net.lb', 'vitaltelecom.net', 'viva.com.bh', 'viva.com.do', 'viyavi.com', 'vmnettelecom.com.br', 'vnpt.vn', 'vocetelecom.vc', 'vocus.co.nz', 'vodacom.cd', 'vodacom.co.ls', 'vodafone.com', 'vodafone.com.au', 'vodafone.com.eg', 'vodafone.com.fj', 'vodafone.com.gh', 'vodafone.de', 'vodafone.gr', 'vodafone.ie', 'vodafone.in', 'vodafone.is', 'vodafone.it', 'vodafone.qa', 'vogeltelecom.com', 'vtr.com', 'w2i.net.br', 'wananchi.com', 'wateen.com', 'wavenet-lb.net', 'webbytelecom.com.br', 'websurfer.com.np', 'wildpark.net', 'wind.com.do', 'wind.gr', 'windtelecom.com.br', 'windtre.it', 'winetbrasil.com.br', 'winfnet.com.br', 'wiretelecom.com.br', 'wise.net.lb', 'wmservice.com.do', 'worldstream.nl', 'wsinternet.com.br', 'wsnetfibra.com.br', 'wznet.com.br', 'xl.co.id', 'xolbroadband.com', 'yellownet.com.br', 'yemen.net.ye', 'yeptv.com.br', 'yes.my', 'yota.com.ni', 'zain.com', 'zamtel.zm', 'zap.cvmultimedia.cv', 'zaytona.ps', 'zenlayer.com', 'zetro.com.ar', 'ziggo.nl', 'zong.com.pk')
GROUP BY 1,
  2,
  3"
"SELECT MAX(""自定义 SQL 查询"".""period"") AS ""usr_Calculation_6733444459377328128_nk""
FROM (SELECT date,
        CASE WHEN CAST(stat_period AS VARCHAR) = 'day' THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(substr(CAST(start_date AS VARCHAR), 1, 10) AS VARCHAR), '~', CAST(substr(CAST(end_date AS VARCHAR), 1, 10) AS VARCHAR)) END AS period,
      start_date,
      end_date,
      stat_period,
      tag,
      dim,
      level1,
      level2,
      level3,
      level4,
      '' AS pd,
      os,
      ver,
      ver_type,
      '' AS product_line,
      '' AS product_type,
      domain,
      country,
      region,
      net,
      vid,
      project,
      company_id,
      company_name,
      rowsnum,
      lastusage,
      thisusage,
      fiveSecJoinSuccess,
      totalJoin,
      cnt_sid,
      video_freeze_time,
      video_totaltime,
      audio_freeze_time,
      audio_totaltime,
      s2l_total_delay_sec,
      s2l_25ms_delay_sec,
      s2l_75ms_delay_sec,
      p2s_lost_Leq5,
      p2s_lost_all,
      crash_cnt,
      service_cnt,
      ""1s_succ_join_ap_cnt"",
      ""5s_succ_join_ap_cnt"",
      total_join_ap_cnt,
      totalJoinSuccess,
      threeSecJoinSuccess,
      video_freeze_time_200,
      video_totaltime_200,
      video_freeze_time_500,
      video_totaltime_500,
      ""3s_succ_join_session_cnt_last1"",
      ""5s_succ_join_session_cnt_last1"",
      succ_join_session_cnt_last1,
      total_join_session_cnt_last1,
      total_session_cnt_last1,
      ""1s_succ_join_ap_cnt_last1"",
      ""5s_succ_join_ap_cnt_last1"",
      total_join_ap_cnt_last1,
      ""3s_succ_join_session_cnt_last7"",
      ""5s_succ_join_session_cnt_last7"",
      succ_join_session_cnt_last7,
      total_join_session_cnt_last7,
      total_session_cnt_last7,
      ""1s_succ_join_ap_cnt_last7"",
      ""5s_succ_join_ap_cnt_last7"",
      total_join_ap_cnt_last7,
      video_freeze_time_last1,
      video_totaltime_last1,
      video_freeze_time_500_last1,
      video_totaltime_500_last1,
      video_freeze_time_200_last1,
      video_totaltime_200_last1,
      video_freeze_time_last7,
      video_totaltime_last7,
      video_freeze_time_500_last7,
      video_totaltime_500_last7,
      video_freeze_time_200_last7,
      video_totaltime_200_last7,
      audio_freeze_time_last1,
      audio_totaltime_last1,
      audio_freeze_time_last7,
      audio_totaltime_last7,
      s2l_total_delay_sec_last1,
      s2l_25ms_delay_sec_last1,
      s2l_75ms_delay_sec_last1,
      s2l_total_delay_sec_last7,
      s2l_25ms_delay_sec_last7,
      s2l_75ms_delay_sec_last7,
      p2s_lost_Leq5_last1,
      p2s_lost_all_last1,
      p2s_lost_Leq5_last7,
      p2s_lost_all_last7,
      crash_cnt_last1,
      service_cnt_last1,
      crash_cnt_last7,
      service_cnt_last7,
      product_level1,
      product_level2,
      product_level3,
      product_level4,
      s2l_lost_Leq5,
      s2l_lost_all,
      s2l_lost_Leq5_last1,
      s2l_lost_all_last1,
      s2l_lost_Leq5_last7,
      s2l_lost_all_last7
    FROM report_datahub.pub_levels_quality_di_1
    WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-21') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-05')) AS ""自定义 SQL 查询""
  CROSS JOIN (SELECT MAX(date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d')) AS ""__measure__0""
    FROM (SELECT date,
            CASE WHEN CAST(stat_period AS VARCHAR) = 'day' THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(substr(CAST(start_date AS VARCHAR), 1, 10) AS VARCHAR), '~', CAST(substr(CAST(end_date AS VARCHAR), 1, 10) AS VARCHAR)) END AS period,
          start_date,
          end_date,
          stat_period,
          tag,
          dim,
          level1,
          level2,
          level3,
          level4,
          '' AS pd,
          os,
          ver,
          ver_type,
          '' AS product_line,
          '' AS product_type,
          domain,
          country,
          region,
          net,
          vid,
          project,
          company_id,
          company_name,
          rowsnum,
          lastusage,
          thisusage,
          fiveSecJoinSuccess,
          totalJoin,
          cnt_sid,
          video_freeze_time,
          video_totaltime,
          audio_freeze_time,
          audio_totaltime,
          s2l_total_delay_sec,
          s2l_25ms_delay_sec,
          s2l_75ms_delay_sec,
          p2s_lost_Leq5,
          p2s_lost_all,
          crash_cnt,
          service_cnt,
          ""1s_succ_join_ap_cnt"",
          ""5s_succ_join_ap_cnt"",
          total_join_ap_cnt,
          totalJoinSuccess,
          threeSecJoinSuccess,
          video_freeze_time_200,
          video_totaltime_200,
          video_freeze_time_500,
          video_totaltime_500,
          ""3s_succ_join_session_cnt_last1"",
          ""5s_succ_join_session_cnt_last1"",
          succ_join_session_cnt_last1,
          total_join_session_cnt_last1,
          total_session_cnt_last1,
          ""1s_succ_join_ap_cnt_last1"",
          ""5s_succ_join_ap_cnt_last1"",
          total_join_ap_cnt_last1,
          ""3s_succ_join_session_cnt_last7"",
          ""5s_succ_join_session_cnt_last7"",
          succ_join_session_cnt_last7,
          total_join_session_cnt_last7,
          total_session_cnt_last7,
          ""1s_succ_join_ap_cnt_last7"",
          ""5s_succ_join_ap_cnt_last7"",
          total_join_ap_cnt_last7,
          video_freeze_time_last1,
          video_totaltime_last1,
          video_freeze_time_500_last1,
          video_totaltime_500_last1,
          video_freeze_time_200_last1,
          video_totaltime_200_last1,
          video_freeze_time_last7,
          video_totaltime_last7,
          video_freeze_time_500_last7,
          video_totaltime_500_last7,
          video_freeze_time_200_last7,
          video_totaltime_200_last7,
          audio_freeze_time_last1,
          audio_totaltime_last1,
          audio_freeze_time_last7,
          audio_totaltime_last7,
          s2l_total_delay_sec_last1,
          s2l_25ms_delay_sec_last1,
          s2l_75ms_delay_sec_last1,
          s2l_total_delay_sec_last7,
          s2l_25ms_delay_sec_last7,
          s2l_75ms_delay_sec_last7,
          p2s_lost_Leq5_last1,
          p2s_lost_all_last1,
          p2s_lost_Leq5_last7,
          p2s_lost_all_last7,
          crash_cnt_last1,
          service_cnt_last1,
          crash_cnt_last7,
          service_cnt_last7,
          product_level1,
          product_level2,
          product_level3,
          product_level4,
          s2l_lost_Leq5,
          s2l_lost_all,
          s2l_lost_Leq5_last1,
          s2l_lost_all_last1,
          s2l_lost_Leq5_last7,
          s2l_lost_all_last7
        FROM report_datahub.pub_levels_quality_di_1
        WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-21') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-05')) AS ""自定义 SQL 查询""
    HAVING COUNT(1) > 0) AS ""t0""
WHERE DATE_ADD('SECOND', 0, date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d')) = DATE_ADD('SECOND', 0, ""t0"".""__measure__0"")
HAVING COUNT(1) > 0"
"SELECT ""自定义 SQL 查询"".""product_type"" AS ""product_type""
FROM (SELECT date AS ""date"",
      src_domain AS ""srcDomain"",
      src_region AS ""srcRegion"",
      dest_idc AS ""idc"",
      delay_25 AS ""p2s_Delay25"",
      delay_50 AS ""p2s_Delay50"",
      delay_75 AS ""p2s_Delay75"",
      delay_100 AS ""p2s_Delay100"",
      delay_125 AS ""p2s_Delay125"",
      delay_150 AS ""p2s_Delay150"",
      delay_total,
      lost_ratio_5 AS ""p2s_lostRatio"",
      lostratio_total AS ""p2s_total"",
      jitter95_50 AS ""p2s_jitter95_50"",
      jitter95_100 AS ""p2s_jitter95_100"",
      jitter95_200 AS ""p2s_jitter95_200"",
      jitter95_300 AS ""p2s_jitter95_300"",
      jitter95_total,
      product_line,
      product_type
    FROM media.p2s_cover_mainland_ip
    WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-25') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-01')) AS ""自定义 SQL 查询""
GROUP BY 1
ORDER BY ""product_type"""
"SELECT SUM(""自定义 SQL 查询"".""host_4k"") AS ""TEMP(Calculation_3519281700341563406)(1075454865)(0)"",
  SUM(""自定义 SQL 查询"".""audience_audio_last7"") AS ""TEMP(Calculation_3519281700341563406)(1077563395)(0)"",
  SUM(""自定义 SQL 查询"".""audience_sd"") AS ""TEMP(Calculation_3519281700341563406)(1133678835)(0)"",
  SUM(""自定义 SQL 查询"".""host_1080p"") AS ""TEMP(Calculation_3519281700341563406)(1312501967)(0)"",
  SUM(""自定义 SQL 查询"".""audience_sd_last7"") AS ""TEMP(Calculation_3519281700341563406)(1456465729)(0)"",
  SUM(""自定义 SQL 查询"".""host_hd_last7"") AS ""TEMP(Calculation_3519281700341563406)(1635749653)(0)"",
  SUM(""自定义 SQL 查询"".""audience_hd_last7"") AS ""TEMP(Calculation_3519281700341563406)(1747046964)(0)"",
  SUM(""自定义 SQL 查询"".""audience_2k_last7"") AS ""TEMP(Calculation_3519281700341563406)(1747524570)(0)"",
  SUM(""自定义 SQL 查询"".""host_hdp_last7"") AS ""TEMP(Calculation_3519281700341563406)(2044136109)(0)"",
  SUM(""自定义 SQL 查询"".""host_audio_last7"") AS ""TEMP(Calculation_3519281700341563406)(2464388580)(0)"",
  SUM(""自定义 SQL 查询"".""audio_last7"") AS ""TEMP(Calculation_3519281700341563406)(2589233512)(0)"",
  SUM(""自定义 SQL 查询"".""host_hd"") AS ""TEMP(Calculation_3519281700341563406)(276907208)(0)"",
  SUM(""自定义 SQL 查询"".""host_2k_last7"") AS ""TEMP(Calculation_3519281700341563406)(280796653)(0)"",
  SUM(""自定义 SQL 查询"".""video"") AS ""TEMP(Calculation_3519281700341563406)(2929708110)(0)"",
  SUM(""自定义 SQL 查询"".""audience_hd"") AS ""TEMP(Calculation_3519281700341563406)(2930728935)(0)"",
  SUM(""自定义 SQL 查询"".""audience_hdp"") AS ""TEMP(Calculation_3519281700341563406)(3010533957)(0)"",
  SUM(""自定义 SQL 查询"".""host_hdp"") AS ""TEMP(Calculation_3519281700341563406)(30306054)(0)"",
  SUM(""自定义 SQL 查询"".""host_audio"") AS ""TEMP(Calculation_3519281700341563406)(3087054365)(0)"",
  SUM(""自定义 SQL 查询"".""host_4k_last7"") AS ""TEMP(Calculation_3519281700341563406)(3127348545)(0)"",
  SUM(""自定义 SQL 查询"".""audio"") AS ""TEMP(Calculation_3519281700341563406)(3299350010)(0)"",
  SUM(""自定义 SQL 查询"".""total_last7"") AS ""TEMP(Calculation_3519281700341563406)(346677966)(0)"",
  SUM(""自定义 SQL 查询"".""audience_4k_last7"") AS ""TEMP(Calculation_3519281700341563406)(3543669678)(0)"",
  SUM(""自定义 SQL 查询"".""host_1080p_last7"") AS ""TEMP(Calculation_3519281700341563406)(3624983014)(0)"",
  SUM(""自定义 SQL 查询"".""audience_1080p"") AS ""TEMP(Calculation_3519281700341563406)(3628946582)(0)"",
  SUM(""自定义 SQL 查询"".""totalUsage"") AS ""TEMP(Calculation_3519281700341563406)(3847882359)(0)"",
  SUM(""自定义 SQL 查询"".""host_sd_last7"") AS ""TEMP(Calculation_3519281700341563406)(3905372418)(0)"",
  SUM(""自定义 SQL 查询"".""video_last7"") AS ""TEMP(Calculation_3519281700341563406)(4107040267)(0)"",
  SUM(""自定义 SQL 查询"".""audience_audio"") AS ""TEMP(Calculation_3519281700341563406)(4109514392)(0)"",
  SUM(""自定义 SQL 查询"".""host_2k"") AS ""TEMP(Calculation_3519281700341563406)(586790827)(0)"",
  SUM(""自定义 SQL 查询"".""audience_1080p_last7"") AS ""TEMP(Calculation_3519281700341563406)(632977665)(0)"",
  SUM(""自定义 SQL 查询"".""host_sd"") AS ""TEMP(Calculation_3519281700341563406)(709512178)(0)"",
  SUM(""自定义 SQL 查询"".""audience_hdp_last7"") AS ""TEMP(Calculation_3519281700341563406)(750340200)(0)"",
  SUM(""自定义 SQL 查询"".""audience_4k"") AS ""TEMP(Calculation_3519281700341563406)(764410224)(0)"",
  SUM(""自定义 SQL 查询"".""audience_2k"") AS ""TEMP(Calculation_3519281700341563406)(943764407)(0)"",
  ""自定义 SQL 查询"".""level1"" AS ""level1"",
  SUM(""自定义 SQL 查询"".""audio_video_last"") AS ""sum_audio_video_last_ok""
FROM (SELECT date,
        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,
      start_date AS start_date_7,
      end_date AS end_date,
      tag,
      area AS Scope,
      dim,
        CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,
      level2,
      level3,
      level4,
      product_level1 AS product_line,
      product_level2,
      product_level3,
      product_level4,
      vid_internal_industry_en AS cid_industry,
      vid_use_case_en AS vid_use_case_cn,
      vid_sector_en,
      ver_type,
      ver,
      os,
      domain,
      country,
      region,
      dim_grouping_name,
        CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,
      total AS totalUsage,
      audio,
      video,
      host_audio,
      audience_audio,
      host_sd,
      host_hd,
      host_hdp,
      host_1080p,
      host_2k,
      host_4k,
      audience_sd,
      audience_hd,
      audience_hdp,
      audience_1080p,
      audience_2k,
      audience_4k,
      audience_audio_low_latency,
      audience_sd_low_latency,
      audience_hd_low_latency,
      audience_hdp_low_latency,
      audience_1080p_low_latency,
      audience_2k_low_latency,
      audience_4k_low_latency,
      audience_audio_ultra_low_latency,
      audience_sd_ultra_low_latency,
      audience_hd_ultra_low_latency,
      audience_hdp_ultra_low_latency,
      audience_1080p_ultra_low_latency,
      audience_2k_ultra_low_latency,
      audience_4k_ultra_low_latency,
      total_last1 AS audio_video_last,
      audio_last1 AS audio_last,
      video_last1 AS video_last,
      video_sd_last1 AS video_sd_last,
      video_hd_last1 AS video_hd_last,
      video_hdp_last1 AS video_hdp_last,
      host_sd_last1 AS host_video_sd_last,
      audience_sd_last1 AS audience_video_sd_last,
      host_hd_last1 AS host_video_hd_last,
      audience_hd_last1 AS audience_video_hd_last,
      host_hdp_last1 AS host_video_hdp_last,
      audience_hdp_last1 AS audience_video_hdp_last,
      host_audio_last1 AS host_audio_last,
      audience_audio_last1 AS audience_audio_last,
      host_video_last1 AS host_video_last,
      audience_video_last1 AS audience_video_last,
      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,
      audience_video_low_latency_last1 AS audience_video_low_latency_last,
      audience_total_low_latency_last1 AS audience_total_low_latency_last,
      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,
      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,
      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,
      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,
      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,
      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,
      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,
      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,
      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,
      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,
      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,
      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,
      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,
      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,
      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,
      audience_2k_last1 AS audience_2k_last,
      audience_4k_last1 AS audience_4k_last,
      audience_1080p_last1 AS audience_1080p_last,
      host_1080p_last1 AS host_1080p_last,
      host_2k_last1 AS host_2k_last,
      host_4k_last1 AS host_4k_last,
      total_last7,
      audio_last7,
      video_last7,
      video_sd_last7,
      video_hd_last7,
      video_hdp_last7,
      host_sd_last7,
      audience_sd_last7,
      host_hd_last7,
      audience_hd_last7,
      host_hdp_last7,
      audience_hdp_last7,
      host_audio_last7,
      audience_audio_last7,
      host_video_last7,
      audience_video_last7,
      audience_audio_low_latency_last7,
      audience_video_low_latency_last7,
      audience_total_low_latency_last7,
      audience_sd_low_latency_last7,
      audience_hd_low_latency_last7,
      audience_hdp_low_latency_last7,
      audience_1080p_low_latency_last7,
      audience_2k_low_latency_last7,
      audience_4k_low_latency_last7,
      audience_audio_ultra_low_latency_last7,
      audience_video_ultra_low_latency_last7,
      audience_total_ultra_low_latency_last7,
      audience_sd_ultra_low_latency_last7,
      audience_hd_ultra_low_latency_last7,
      audience_hdp_ultra_low_latency_last7,
      audience_1080p_ultra_low_latency_last7,
      audience_2k_ultra_low_latency_last7,
      audience_4k_ultra_low_latency_last7,
      audience_2k_last7,
      audience_4k_last7,
      audience_1080p_last7,
      host_1080p_last7,
      host_2k_last7,
      host_4k_last7
    FROM levels_usage_dod_di_1
    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-06') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-04') AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS ""自定义 SQL 查询""
  CROSS JOIN (SELECT MAX(date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d')) AS ""__measure__0""
    FROM (SELECT date,
            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,
          start_date AS start_date_7,
          end_date AS end_date,
          tag,
          area AS Scope,
          dim,
            CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,
          level2,
          level3,
          level4,
          product_level1 AS product_line,
          product_level2,
          product_level3,
          product_level4,
          vid_internal_industry_en AS cid_industry,
          vid_use_case_en AS vid_use_case_cn,
          vid_sector_en,
          ver_type,
          ver,
          os,
          domain,
          country,
          region,
          dim_grouping_name,
            CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,
          total AS totalUsage,
          audio,
          video,
          host_audio,
          audience_audio,
          host_sd,
          host_hd,
          host_hdp,
          host_1080p,
          host_2k,
          host_4k,
          audience_sd,
          audience_hd,
          audience_hdp,
          audience_1080p,
          audience_2k,
          audience_4k,
          audience_audio_low_latency,
          audience_sd_low_latency,
          audience_hd_low_latency,
          audience_hdp_low_latency,
          audience_1080p_low_latency,
          audience_2k_low_latency,
          audience_4k_low_latency,
          audience_audio_ultra_low_latency,
          audience_sd_ultra_low_latency,
          audience_hd_ultra_low_latency,
          audience_hdp_ultra_low_latency,
          audience_1080p_ultra_low_latency,
          audience_2k_ultra_low_latency,
          audience_4k_ultra_low_latency,
          total_last1 AS audio_video_last,
          audio_last1 AS audio_last,
          video_last1 AS video_last,
          video_sd_last1 AS video_sd_last,
          video_hd_last1 AS video_hd_last,
          video_hdp_last1 AS video_hdp_last,
          host_sd_last1 AS host_video_sd_last,
          audience_sd_last1 AS audience_video_sd_last,
          host_hd_last1 AS host_video_hd_last,
          audience_hd_last1 AS audience_video_hd_last,
          host_hdp_last1 AS host_video_hdp_last,
          audience_hdp_last1 AS audience_video_hdp_last,
          host_audio_last1 AS host_audio_last,
          audience_audio_last1 AS audience_audio_last,
          host_video_last1 AS host_video_last,
          audience_video_last1 AS audience_video_last,
          audience_audio_low_latency_last1 AS audience_audio_low_latency_last,
          audience_video_low_latency_last1 AS audience_video_low_latency_last,
          audience_total_low_latency_last1 AS audience_total_low_latency_last,
          audience_sd_low_latency_last1 AS audience_sd_low_latency_last,
          audience_hd_low_latency_last1 AS audience_hd_low_latency_last,
          audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,
          audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,
          audience_2k_low_latency_last1 AS audience_2k_low_latency_last,
          audience_4k_low_latency_last1 AS audience_4k_low_latency_last,
          audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,
          audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,
          audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,
          audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,
          audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,
          audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,
          audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,
          audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,
          audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,
          audience_2k_last1 AS audience_2k_last,
          audience_4k_last1 AS audience_4k_last,
          audience_1080p_last1 AS audience_1080p_last,
          host_1080p_last1 AS host_1080p_last,
          host_2k_last1 AS host_2k_last,
          host_4k_last1 AS host_4k_last,
          total_last7,
          audio_last7,
          video_last7,
          video_sd_last7,
          video_hd_last7,
          video_hdp_last7,
          host_sd_last7,
          audience_sd_last7,
          host_hd_last7,
          audience_hd_last7,
          host_hdp_last7,
          audience_hdp_last7,
          host_audio_last7,
          audience_audio_last7,
          host_video_last7,
          audience_video_last7,
          audience_audio_low_latency_last7,
          audience_video_low_latency_last7,
          audience_total_low_latency_last7,
          audience_sd_low_latency_last7,
          audience_hd_low_latency_last7,
          audience_hdp_low_latency_last7,
          audience_1080p_low_latency_last7,
          audience_2k_low_latency_last7,
          audience_4k_low_latency_last7,
          audience_audio_ultra_low_latency_last7,
          audience_video_ultra_low_latency_last7,
          audience_total_ultra_low_latency_last7,
          audience_sd_ultra_low_latency_last7,
          audience_hd_ultra_low_latency_last7,
          audience_hdp_ultra_low_latency_last7,
          audience_1080p_ultra_low_latency_last7,
          audience_2k_ultra_low_latency_last7,
          audience_4k_ultra_low_latency_last7,
          audience_2k_last7,
          audience_4k_last7,
          audience_1080p_last7,
          host_1080p_last7,
          host_2k_last7,
          host_4k_last7
        FROM levels_usage_dod_di_1
        WHERE CAST(tag AS VARCHAR) = 'Industry' AND date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-06') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-04') AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS ""自定义 SQL 查询""
    HAVING COUNT(1) > 0) AS ""t0""
WHERE ""自定义 SQL 查询"".""dim"" = 1 AND ""自定义 SQL 查询"".""rank_level1"" = 6 AND date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d') = ""t0"".""__measure__0""
GROUP BY 35"
"SELECT ""自定义 SQL 查询"".""country"" AS ""country"",
  DATE_ADD('SECOND', 0, date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d')) AS ""tdy_date_ok"",
    CASE WHEN SUM(""自定义 SQL 查询"".""delay25"") / SUM(""自定义 SQL 查询"".""delay_total"") >= 0.5 AND SUM(""自定义 SQL 查询"".""delay75"") / SUM(""自定义 SQL 查询"".""delay_total"") >= 0.90000000000000002 AND SUM(""自定义 SQL 查询"".""lost_ratio_5"") / SUM(""自定义 SQL 查询"".""lost_total"") >= 0.96499999999999997 THEN 1 ELSE 0 END AS ""usr_Calculation_3094043313033101315_ok""
FROM (SELECT *
    FROM media.sdrtn_okr_notvpn
    WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-16') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-11-29')) AS ""自定义 SQL 查询""
GROUP BY 1,
  2"
"SELECT SUM(""自定义 SQL 查询"".""s2l_25ms_delay_sec_last7"") AS ""TEMP(Calculation_1430244791162150914)(10119751)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_25ms_delay_sec"") AS ""TEMP(Calculation_1430244791162150914)(2227145667)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_total_delay_sec"") AS ""TEMP(Calculation_1430244791162150914)(2460078802)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_total_delay_sec_last7"") AS ""TEMP(Calculation_1430244791162150914)(3558359569)(0)"",
  SUM(""自定义 SQL 查询"".""5s_succ_join_ap_cnt"") AS ""TEMP(Calculation_1430244791249522705)(1716451703)(0)"",
  SUM(""自定义 SQL 查询"".""total_join_ap_cnt_last7"") AS ""TEMP(Calculation_1430244791249522705)(2573436739)(0)"",
  SUM(""自定义 SQL 查询"".""total_join_ap_cnt"") AS ""TEMP(Calculation_1430244791249522705)(2681092799)(0)"",
  SUM(""自定义 SQL 查询"".""5s_succ_join_ap_cnt_last7"") AS ""TEMP(Calculation_1430244791249522705)(2802323494)(0)"",
  SUM(""自定义 SQL 查询"".""video_freeze_time_500_last7"") AS ""TEMP(Calculation_1857594119395786754)(1458194667)(0)"",
  SUM(""自定义 SQL 查询"".""video_totaltime_500_last7"") AS ""TEMP(Calculation_1857594119395786754)(2161412938)(0)"",
  SUM(""自定义 SQL 查询"".""video_freeze_time_500"") AS ""TEMP(Calculation_1857594119395786754)(389023081)(0)"",
  SUM(""自定义 SQL 查询"".""video_totaltime_500"") AS ""TEMP(Calculation_1857594119395786754)(458654145)(0)"",
  SUM(""自定义 SQL 查询"".""video_totaltime_200"") AS ""TEMP(Calculation_2033093767653715970)(2104207895)(0)"",
  SUM(""自定义 SQL 查询"".""video_freeze_time_200_last7"") AS ""TEMP(Calculation_2033093767653715970)(3354457873)(0)"",
  SUM(""自定义 SQL 查询"".""video_totaltime_200_last7"") AS ""TEMP(Calculation_2033093767653715970)(3922744675)(0)"",
  SUM(""自定义 SQL 查询"".""video_freeze_time_200"") AS ""TEMP(Calculation_2033093767653715970)(530162565)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_75ms_delay_sec"") AS ""TEMP(Calculation_6542393318886535170)(2003933318)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_75ms_delay_sec_last7"") AS ""TEMP(Calculation_6542393318886535170)(775655446)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_lost_Leq5_last7"") AS ""TEMP(Calculation_7012034266496974850)(2526464233)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_lost_Leq5"") AS ""TEMP(Calculation_7012034266496974850)(2745840127)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_lost_all_last7"") AS ""TEMP(Calculation_7012034266496974850)(453870284)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_lost_all"") AS ""TEMP(Calculation_7012034266496974850)(734589263)(0)"",
  SUM(""自定义 SQL 查询"".""totalJoin"") AS ""TEMP(Calculation_7034341207023464449)(2073556184)(0)"",
  SUM(""自定义 SQL 查询"".""3s_succ_join_session_cnt_last7"") AS ""TEMP(Calculation_7034341207023464449)(2344416377)(0)"",
  SUM(""自定义 SQL 查询"".""total_join_session_cnt_last7"") AS ""TEMP(Calculation_7034341207023464449)(3093209995)(0)"",
  SUM(""自定义 SQL 查询"".""threeSecJoinSuccess"") AS ""TEMP(Calculation_7034341207023464449)(3693645608)(0)"",
  SUM(""自定义 SQL 查询"".""5s_succ_join_session_cnt_last7"") AS ""TEMP(Calculation_7034341207023988739)(1073906376)(0)"",
  SUM(""自定义 SQL 查询"".""fiveSecJoinSuccess"") AS ""TEMP(Calculation_7034341207023988739)(383616769)(0)"",
  SUM(""自定义 SQL 查询"".""succ_join_session_cnt_last7"") AS ""TEMP(Calculation_7034341207025020933)(2300438540)(0)"",
  SUM(""自定义 SQL 查询"".""totalJoinSuccess"") AS ""TEMP(Calculation_7034341207025020933)(2807417001)(0)"",
  SUM(""自定义 SQL 查询"".""video_totaltime_last7"") AS ""TEMP(Calculation_7034341207025557511)(2411308906)(0)"",
  SUM(""自定义 SQL 查询"".""video_totaltime"") AS ""TEMP(Calculation_7034341207025557511)(2797449586)(0)"",
  SUM(""自定义 SQL 查询"".""video_freeze_time"") AS ""TEMP(Calculation_7034341207025557511)(2940759860)(0)"",
  SUM(""自定义 SQL 查询"".""video_freeze_time_last7"") AS ""TEMP(Calculation_7034341207025557511)(3152166089)(0)"",
  SUM(""自定义 SQL 查询"".""audio_totaltime"") AS ""TEMP(Calculation_7034341207025938441)(1652566750)(0)"",
  SUM(""自定义 SQL 查询"".""audio_freeze_time"") AS ""TEMP(Calculation_7034341207025938441)(2919389392)(0)"",
  SUM(""自定义 SQL 查询"".""audio_freeze_time_last7"") AS ""TEMP(Calculation_7034341207025938441)(3377500597)(0)"",
  SUM(""自定义 SQL 查询"".""audio_totaltime_last7"") AS ""TEMP(Calculation_7034341207025938441)(489775499)(0)"",
  SUM(""自定义 SQL 查询"".""crash_cnt_last7"") AS ""TEMP(Calculation_7034341207372492815)(2315319037)(0)"",
  SUM(""自定义 SQL 查询"".""crash_cnt"") AS ""TEMP(Calculation_7034341207372492815)(2360900687)(0)"",
  SUM(""自定义 SQL 查询"".""service_cnt_last7"") AS ""TEMP(Calculation_7034341207372492815)(3843063028)(0)"",
  SUM(""自定义 SQL 查询"".""service_cnt"") AS ""TEMP(Calculation_7034341207372492815)(4291252132)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_lost_all_last7"") AS ""TEMP(Calculation_75998310508670977)(1411695322)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_lost_Leq5"") AS ""TEMP(Calculation_75998310508670977)(1936123547)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_lost_all"") AS ""TEMP(Calculation_75998310508670977)(749826584)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_lost_Leq5_last7"") AS ""TEMP(Calculation_75998310508670977)(790094525)(0)""
FROM (SELECT t1.date,
        CASE WHEN CAST(stat_period AS VARCHAR) = 'day' THEN substr(CAST(date_parse(cast( t1.date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(substr(CAST(start_date AS VARCHAR), 1, 10) AS VARCHAR), '~', CAST(substr(CAST(end_date AS VARCHAR), 1, 10) AS VARCHAR)) END AS period,
      start_date,
      end_date,
      stat_period,
      tag,
      t1.dim,
      level1,
      level2,
      level3,
      level4,
      os,
      ver,
      ver_type,
      domain,
      country,
      region,
      net,
      vid,
      project,
      company_id,
      company_name,
      rowsnum,
      lastusage,
      thisusage,
      fiveSecJoinSuccess,
      totalJoin,
      cnt_sid,
      video_freeze_time,
      video_totaltime,
      audio_freeze_time,
      audio_totaltime,
      s2l_total_delay_sec,
      s2l_25ms_delay_sec,
      s2l_75ms_delay_sec,
      p2s_lost_Leq5,
      p2s_lost_all,
      crash_cnt,
      service_cnt,
      ""1s_succ_join_ap_cnt"",
      ""5s_succ_join_ap_cnt"",
      total_join_ap_cnt,
      totalJoinSuccess,
      threeSecJoinSuccess,
      video_freeze_time_200,
      video_totaltime_200,
      video_freeze_time_500,
      video_totaltime_500,
      ""3s_succ_join_session_cnt_last1"",
      ""5s_succ_join_session_cnt_last1"",
      succ_join_session_cnt_last1,
      total_join_session_cnt_last1,
      total_session_cnt_last1,
      ""1s_succ_join_ap_cnt_last1"",
      ""5s_succ_join_ap_cnt_last1"",
      total_join_ap_cnt_last1,
      ""3s_succ_join_session_cnt_last7"",
      ""5s_succ_join_session_cnt_last7"",
      succ_join_session_cnt_last7,
      total_join_session_cnt_last7,
      total_session_cnt_last7,
      ""1s_succ_join_ap_cnt_last7"",
      ""5s_succ_join_ap_cnt_last7"",
      total_join_ap_cnt_last7,
      video_freeze_time_last1,
      video_totaltime_last1,
      video_freeze_time_500_last1,
      video_totaltime_500_last1,
      video_freeze_time_200_last1,
      video_totaltime_200_last1,
      video_freeze_time_last7,
      video_totaltime_last7,
      video_freeze_time_500_last7,
      video_totaltime_500_last7,
      video_freeze_time_200_last7,
      video_totaltime_200_last7,
      audio_freeze_time_last1,
      audio_totaltime_last1,
      audio_freeze_time_last7,
      audio_totaltime_last7,
      s2l_total_delay_sec_last1,
      s2l_25ms_delay_sec_last1,
      s2l_75ms_delay_sec_last1,
      s2l_total_delay_sec_last7,
      s2l_25ms_delay_sec_last7,
      s2l_75ms_delay_sec_last7,
      p2s_lost_Leq5_last1,
      p2s_lost_all_last1,
      p2s_lost_Leq5_last7,
      p2s_lost_all_last7,
      crash_cnt_last1,
      service_cnt_last1,
      crash_cnt_last7,
      service_cnt_last7,
      product_level1,
      product_level2,
      product_level3,
      product_level4,
      s2l_lost_Leq5,
      s2l_lost_all,
      s2l_lost_Leq5_last1,
      s2l_lost_all_last1,
      s2l_lost_Leq5_last7,
      s2l_lost_all_last7,
      fiveSecJoinSuccess_total,
      totalJoin_total,
      cnt_sid_total,
      video_freeze_time_total,
      video_totaltime_total,
      audio_freeze_time_total,
      audio_totaltime_total,
      s2l_total_delay_sec_total,
      s2l_25ms_delay_sec_total,
      s2l_75ms_delay_sec_total,
      p2s_lost_Leq5_total,
      p2s_lost_all_total,
      crash_cnt_total,
      service_cnt_total,
      ""1s_succ_join_ap_cnt_total"",
      ""5s_succ_join_ap_cnt_total"",
      total_join_ap_cnt_total,
      totalJoinSuccess_total,
      threeSecJoinSuccess_total,
      video_freeze_time_200_total,
      video_totaltime_200_total,
      video_freeze_time_500_total,
      video_totaltime_500_total,
      ""3s_succ_join_session_cnt_last1_total"",
      ""5s_succ_join_session_cnt_last1_total"",
      succ_join_session_cnt_last1_total,
      total_join_session_cnt_last1_total,
      total_session_cnt_last1_total,
      ""1s_succ_join_ap_cnt_last1_total"",
      ""5s_succ_join_ap_cnt_last1_total"",
      total_join_ap_cnt_last1_total,
      ""3s_succ_join_session_cnt_last7_total"",
      ""5s_succ_join_session_cnt_last7_total"",
      succ_join_session_cnt_last7_total,
      total_join_session_cnt_last7_total,
      total_session_cnt_last7_total,
      ""1s_succ_join_ap_cnt_last7_total"",
      ""5s_succ_join_ap_cnt_last7_total"",
      total_join_ap_cnt_last7_total,
      video_freeze_time_last1_total,
      video_totaltime_last1_total,
      video_freeze_time_500_last1_total,
      video_totaltime_500_last1_total,
      video_freeze_time_200_last1_total,
      video_totaltime_200_last1_total,
      video_freeze_time_last7_total,
      video_totaltime_last7_total,
      video_freeze_time_500_last7_total,
      video_totaltime_500_last7_total,
      video_freeze_time_200_last7_total,
      video_totaltime_200_last7_total,
      audio_freeze_time_last1_total,
      audio_totaltime_last1_total,
      audio_freeze_time_last7_total,
      audio_totaltime_last7_total,
      s2l_total_delay_sec_last1_total,
      s2l_25ms_delay_sec_last1_total,
      s2l_75ms_delay_sec_last1_total,
      s2l_total_delay_sec_last7_total,
      s2l_25ms_delay_sec_last7_total,
      s2l_75ms_delay_sec_last7_total,
      p2s_lost_Leq5_last1_total,
      p2s_lost_all_last1_total,
      p2s_lost_Leq5_last7_total,
      p2s_lost_all_last7_total,
      crash_cnt_last1_total,
      service_cnt_last1_total,
      crash_cnt_last7_total,
      service_cnt_last7_total,
      s2l_lost_Leq5_total,
      s2l_lost_all_total,
      s2l_lost_Leq5_last1_total,
      s2l_lost_all_last1_total,
      s2l_lost_Leq5_last7_total,
      s2l_lost_all_last7_total
    FROM report_datahub.pub_levels_quality_di_1 AS t1
      LEFT JOIN (SELECT date,
          dim,
          SUM(fiveSecJoinSuccess) AS fiveSecJoinSuccess_total,
          SUM(totalJoin) AS totalJoin_total,
          SUM(cnt_sid) AS cnt_sid_total,
          SUM(video_freeze_time) AS video_freeze_time_total,
          SUM(video_totaltime) AS video_totaltime_total,
          SUM(audio_freeze_time) AS audio_freeze_time_total,
          SUM(audio_totaltime) AS audio_totaltime_total,
          SUM(s2l_total_delay_sec) AS s2l_total_delay_sec_total,
          SUM(s2l_25ms_delay_sec) AS s2l_25ms_delay_sec_total,
          SUM(s2l_75ms_delay_sec) AS s2l_75ms_delay_sec_total,
          SUM(p2s_lost_Leq5) AS p2s_lost_Leq5_total,
          SUM(p2s_lost_all) AS p2s_lost_all_total,
          SUM(crash_cnt) AS crash_cnt_total,
          SUM(service_cnt) AS service_cnt_total,
          SUM(""1s_succ_join_ap_cnt"") AS ""1s_succ_join_ap_cnt_total"",
          SUM(""5s_succ_join_ap_cnt"") AS ""5s_succ_join_ap_cnt_total"",
          SUM(total_join_ap_cnt) AS total_join_ap_cnt_total,
          SUM(totalJoinSuccess) AS totalJoinSuccess_total,
          SUM(threeSecJoinSuccess) AS threeSecJoinSuccess_total,
          SUM(video_freeze_time_200) AS video_freeze_time_200_total,
          SUM(video_totaltime_200) AS video_totaltime_200_total,
          SUM(video_freeze_time_500) AS video_freeze_time_500_total,
          SUM(video_totaltime_500) AS video_totaltime_500_total,
          SUM(""3s_succ_join_session_cnt_last1"") AS ""3s_succ_join_session_cnt_last1_total"",
          SUM(""5s_succ_join_session_cnt_last1"") AS ""5s_succ_join_session_cnt_last1_total"",
          SUM(succ_join_session_cnt_last1) AS succ_join_session_cnt_last1_total,
          SUM(total_join_session_cnt_last1) AS total_join_session_cnt_last1_total,
          SUM(total_session_cnt_last1) AS total_session_cnt_last1_total,
          SUM(""1s_succ_join_ap_cnt_last1"") AS ""1s_succ_join_ap_cnt_last1_total"",
          SUM(""5s_succ_join_ap_cnt_last1"") AS ""5s_succ_join_ap_cnt_last1_total"",
          SUM(total_join_ap_cnt_last1) AS total_join_ap_cnt_last1_total,
          SUM(""3s_succ_join_session_cnt_last7"") AS ""3s_succ_join_session_cnt_last7_total"",
          SUM(""5s_succ_join_session_cnt_last7"") AS ""5s_succ_join_session_cnt_last7_total"",
          SUM(succ_join_session_cnt_last7) AS succ_join_session_cnt_last7_total,
          SUM(total_join_session_cnt_last7) AS total_join_session_cnt_last7_total,
          SUM(total_session_cnt_last7) AS total_session_cnt_last7_total,
          SUM(""1s_succ_join_ap_cnt_last7"") AS ""1s_succ_join_ap_cnt_last7_total"",
          SUM(""5s_succ_join_ap_cnt_last7"") AS ""5s_succ_join_ap_cnt_last7_total"",
          SUM(total_join_ap_cnt_last7) AS total_join_ap_cnt_last7_total,
          SUM(video_freeze_time_last1) AS video_freeze_time_last1_total,
          SUM(video_totaltime_last1) AS video_totaltime_last1_total,
          SUM(video_freeze_time_500_last1) AS video_freeze_time_500_last1_total,
          SUM(video_totaltime_500_last1) AS video_totaltime_500_last1_total,
          SUM(video_freeze_time_200_last1) AS video_freeze_time_200_last1_total,
          SUM(video_totaltime_200_last1) AS video_totaltime_200_last1_total,
          SUM(video_freeze_time_last7) AS video_freeze_time_last7_total,
          SUM(video_totaltime_last7) AS video_totaltime_last7_total,
          SUM(video_freeze_time_500_last7) AS video_freeze_time_500_last7_total,
          SUM(video_totaltime_500_last7) AS video_totaltime_500_last7_total,
          SUM(video_freeze_time_200_last7) AS video_freeze_time_200_last7_total,
          SUM(video_totaltime_200_last7) AS video_totaltime_200_last7_total,
          SUM(audio_freeze_time_last1) AS audio_freeze_time_last1_total,
          SUM(audio_totaltime_last1) AS audio_totaltime_last1_total,
          SUM(audio_freeze_time_last7) AS audio_freeze_time_last7_total,
          SUM(audio_totaltime_last7) AS audio_totaltime_last7_total,
          SUM(s2l_total_delay_sec_last1) AS s2l_total_delay_sec_last1_total,
          SUM(s2l_25ms_delay_sec_last1) AS s2l_25ms_delay_sec_last1_total,
          SUM(s2l_75ms_delay_sec_last1) AS s2l_75ms_delay_sec_last1_total,
          SUM(s2l_total_delay_sec_last7) AS s2l_total_delay_sec_last7_total,
          SUM(s2l_25ms_delay_sec_last7) AS s2l_25ms_delay_sec_last7_total,
          SUM(s2l_75ms_delay_sec_last7) AS s2l_75ms_delay_sec_last7_total,
          SUM(p2s_lost_Leq5_last1) AS p2s_lost_Leq5_last1_total,
          SUM(p2s_lost_all_last1) AS p2s_lost_all_last1_total,
          SUM(p2s_lost_Leq5_last7) AS p2s_lost_Leq5_last7_total,
          SUM(p2s_lost_all_last7) AS p2s_lost_all_last7_total,
          SUM(crash_cnt_last1) AS crash_cnt_last1_total,
          SUM(service_cnt_last1) AS service_cnt_last1_total,
          SUM(crash_cnt_last7) AS crash_cnt_last7_total,
          SUM(service_cnt_last7) AS service_cnt_last7_total,
          SUM(s2l_lost_Leq5) AS s2l_lost_Leq5_total,
          SUM(s2l_lost_all) AS s2l_lost_all_total,
          SUM(s2l_lost_Leq5_last1) AS s2l_lost_Leq5_last1_total,
          SUM(s2l_lost_all_last1) AS s2l_lost_all_last1_total,
          SUM(s2l_lost_Leq5_last7) AS s2l_lost_Leq5_last7_total,
          SUM(s2l_lost_all_last7) AS s2l_lost_all_last7_total
        FROM report_datahub.pub_levels_quality_di_1
        WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-21') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-11-21') AND CAST(tag AS VARCHAR) = 'Product'
        GROUP BY date,
          dim) AS t2 ON t1.date = t2.date AND t1.dim = t2.dim
    WHERE date_parse(cast( t1.date as VARCHAR), '%Y%m%d') >= DATE('2021-11-21') AND date_parse(cast( t1.date as VARCHAR), '%Y%m%d') <= DATE('2021-11-21') AND CAST(tag AS VARCHAR) = 'Product') AS ""自定义 SQL 查询""
  CROSS JOIN (SELECT MAX(date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d')) AS ""__measure__0""
    FROM (SELECT t1.date,
            CASE WHEN CAST(stat_period AS VARCHAR) = 'day' THEN substr(CAST(date_parse(cast( t1.date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(substr(CAST(start_date AS VARCHAR), 1, 10) AS VARCHAR), '~', CAST(substr(CAST(end_date AS VARCHAR), 1, 10) AS VARCHAR)) END AS period,
          start_date,
          end_date,
          stat_period,
          tag,
          t1.dim,
          level1,
          level2,
          level3,
          level4,
          os,
          ver,
          ver_type,
          domain,
          country,
          region,
          net,
          vid,
          project,
          company_id,
          company_name,
          rowsnum,
          lastusage,
          thisusage,
          fiveSecJoinSuccess,
          totalJoin,
          cnt_sid,
          video_freeze_time,
          video_totaltime,
          audio_freeze_time,
          audio_totaltime,
          s2l_total_delay_sec,
          s2l_25ms_delay_sec,
          s2l_75ms_delay_sec,
          p2s_lost_Leq5,
          p2s_lost_all,
          crash_cnt,
          service_cnt,
          ""1s_succ_join_ap_cnt"",
          ""5s_succ_join_ap_cnt"",
          total_join_ap_cnt,
          totalJoinSuccess,
          threeSecJoinSuccess,
          video_freeze_time_200,
          video_totaltime_200,
          video_freeze_time_500,
          video_totaltime_500,
          ""3s_succ_join_session_cnt_last1"",
          ""5s_succ_join_session_cnt_last1"",
          succ_join_session_cnt_last1,
          total_join_session_cnt_last1,
          total_session_cnt_last1,
          ""1s_succ_join_ap_cnt_last1"",
          ""5s_succ_join_ap_cnt_last1"",
          total_join_ap_cnt_last1,
          ""3s_succ_join_session_cnt_last7"",
          ""5s_succ_join_session_cnt_last7"",
          succ_join_session_cnt_last7,
          total_join_session_cnt_last7,
          total_session_cnt_last7,
          ""1s_succ_join_ap_cnt_last7"",
          ""5s_succ_join_ap_cnt_last7"",
          total_join_ap_cnt_last7,
          video_freeze_time_last1,
          video_totaltime_last1,
          video_freeze_time_500_last1,
          video_totaltime_500_last1,
          video_freeze_time_200_last1,
          video_totaltime_200_last1,
          video_freeze_time_last7,
          video_totaltime_last7,
          video_freeze_time_500_last7,
          video_totaltime_500_last7,
          video_freeze_time_200_last7,
          video_totaltime_200_last7,
          audio_freeze_time_last1,
          audio_totaltime_last1,
          audio_freeze_time_last7,
          audio_totaltime_last7,
          s2l_total_delay_sec_last1,
          s2l_25ms_delay_sec_last1,
          s2l_75ms_delay_sec_last1,
          s2l_total_delay_sec_last7,
          s2l_25ms_delay_sec_last7,
          s2l_75ms_delay_sec_last7,
          p2s_lost_Leq5_last1,
          p2s_lost_all_last1,
          p2s_lost_Leq5_last7,
          p2s_lost_all_last7,
          crash_cnt_last1,
          service_cnt_last1,
          crash_cnt_last7,
          service_cnt_last7,
          product_level1,
          product_level2,
          product_level3,
          product_level4,
          s2l_lost_Leq5,
          s2l_lost_all,
          s2l_lost_Leq5_last1,
          s2l_lost_all_last1,
          s2l_lost_Leq5_last7,
          s2l_lost_all_last7,
          fiveSecJoinSuccess_total,
          totalJoin_total,
          cnt_sid_total,
          video_freeze_time_total,
          video_totaltime_total,
          audio_freeze_time_total,
          audio_totaltime_total,
          s2l_total_delay_sec_total,
          s2l_25ms_delay_sec_total,
          s2l_75ms_delay_sec_total,
          p2s_lost_Leq5_total,
          p2s_lost_all_total,
          crash_cnt_total,
          service_cnt_total,
          ""1s_succ_join_ap_cnt_total"",
          ""5s_succ_join_ap_cnt_total"",
          total_join_ap_cnt_total,
          totalJoinSuccess_total,
          threeSecJoinSuccess_total,
          video_freeze_time_200_total,
          video_totaltime_200_total,
          video_freeze_time_500_total,
          video_totaltime_500_total,
          ""3s_succ_join_session_cnt_last1_total"",
          ""5s_succ_join_session_cnt_last1_total"",
          succ_join_session_cnt_last1_total,
          total_join_session_cnt_last1_total,
          total_session_cnt_last1_total,
          ""1s_succ_join_ap_cnt_last1_total"",
          ""5s_succ_join_ap_cnt_last1_total"",
          total_join_ap_cnt_last1_total,
          ""3s_succ_join_session_cnt_last7_total"",
          ""5s_succ_join_session_cnt_last7_total"",
          succ_join_session_cnt_last7_total,
          total_join_session_cnt_last7_total,
          total_session_cnt_last7_total,
          ""1s_succ_join_ap_cnt_last7_total"",
          ""5s_succ_join_ap_cnt_last7_total"",
          total_join_ap_cnt_last7_total,
          video_freeze_time_last1_total,
          video_totaltime_last1_total,
          video_freeze_time_500_last1_total,
          video_totaltime_500_last1_total,
          video_freeze_time_200_last1_total,
          video_totaltime_200_last1_total,
          video_freeze_time_last7_total,
          video_totaltime_last7_total,
          video_freeze_time_500_last7_total,
          video_totaltime_500_last7_total,
          video_freeze_time_200_last7_total,
          video_totaltime_200_last7_total,
          audio_freeze_time_last1_total,
          audio_totaltime_last1_total,
          audio_freeze_time_last7_total,
          audio_totaltime_last7_total,
          s2l_total_delay_sec_last1_total,
          s2l_25ms_delay_sec_last1_total,
          s2l_75ms_delay_sec_last1_total,
          s2l_total_delay_sec_last7_total,
          s2l_25ms_delay_sec_last7_total,
          s2l_75ms_delay_sec_last7_total,
          p2s_lost_Leq5_last1_total,
          p2s_lost_all_last1_total,
          p2s_lost_Leq5_last7_total,
          p2s_lost_all_last7_total,
          crash_cnt_last1_total,
          service_cnt_last1_total,
          crash_cnt_last7_total,
          service_cnt_last7_total,
          s2l_lost_Leq5_total,
          s2l_lost_all_total,
          s2l_lost_Leq5_last1_total,
          s2l_lost_all_last1_total,
          s2l_lost_Leq5_last7_total,
          s2l_lost_all_last7_total
        FROM report_datahub.pub_levels_quality_di_1 AS t1
          LEFT JOIN (SELECT date,
              dim,
              SUM(fiveSecJoinSuccess) AS fiveSecJoinSuccess_total,
              SUM(totalJoin) AS totalJoin_total,
              SUM(cnt_sid) AS cnt_sid_total,
              SUM(video_freeze_time) AS video_freeze_time_total,
              SUM(video_totaltime) AS video_totaltime_total,
              SUM(audio_freeze_time) AS audio_freeze_time_total,
              SUM(audio_totaltime) AS audio_totaltime_total,
              SUM(s2l_total_delay_sec) AS s2l_total_delay_sec_total,
              SUM(s2l_25ms_delay_sec) AS s2l_25ms_delay_sec_total,
              SUM(s2l_75ms_delay_sec) AS s2l_75ms_delay_sec_total,
              SUM(p2s_lost_Leq5) AS p2s_lost_Leq5_total,
              SUM(p2s_lost_all) AS p2s_lost_all_total,
              SUM(crash_cnt) AS crash_cnt_total,
              SUM(service_cnt) AS service_cnt_total,
              SUM(""1s_succ_join_ap_cnt"") AS ""1s_succ_join_ap_cnt_total"",
              SUM(""5s_succ_join_ap_cnt"") AS ""5s_succ_join_ap_cnt_total"",
              SUM(total_join_ap_cnt) AS total_join_ap_cnt_total,
              SUM(totalJoinSuccess) AS totalJoinSuccess_total,
              SUM(threeSecJoinSuccess) AS threeSecJoinSuccess_total,
              SUM(video_freeze_time_200) AS video_freeze_time_200_total,
              SUM(video_totaltime_200) AS video_totaltime_200_total,
              SUM(video_freeze_time_500) AS video_freeze_time_500_total,
              SUM(video_totaltime_500) AS video_totaltime_500_total,
              SUM(""3s_succ_join_session_cnt_last1"") AS ""3s_succ_join_session_cnt_last1_total"",
              SUM(""5s_succ_join_session_cnt_last1"") AS ""5s_succ_join_session_cnt_last1_total"",
              SUM(succ_join_session_cnt_last1) AS succ_join_session_cnt_last1_total,
              SUM(total_join_session_cnt_last1) AS total_join_session_cnt_last1_total,
              SUM(total_session_cnt_last1) AS total_session_cnt_last1_total,
              SUM(""1s_succ_join_ap_cnt_last1"") AS ""1s_succ_join_ap_cnt_last1_total"",
              SUM(""5s_succ_join_ap_cnt_last1"") AS ""5s_succ_join_ap_cnt_last1_total"",
              SUM(total_join_ap_cnt_last1) AS total_join_ap_cnt_last1_total,
              SUM(""3s_succ_join_session_cnt_last7"") AS ""3s_succ_join_session_cnt_last7_total"",
              SUM(""5s_succ_join_session_cnt_last7"") AS ""5s_succ_join_session_cnt_last7_total"",
              SUM(succ_join_session_cnt_last7) AS succ_join_session_cnt_last7_total,
              SUM(total_join_session_cnt_last7) AS total_join_session_cnt_last7_total,
              SUM(total_session_cnt_last7) AS total_session_cnt_last7_total,
              SUM(""1s_succ_join_ap_cnt_last7"") AS ""1s_succ_join_ap_cnt_last7_total"",
              SUM(""5s_succ_join_ap_cnt_last7"") AS ""5s_succ_join_ap_cnt_last7_total"",
              SUM(total_join_ap_cnt_last7) AS total_join_ap_cnt_last7_total,
              SUM(video_freeze_time_last1) AS video_freeze_time_last1_total,
              SUM(video_totaltime_last1) AS video_totaltime_last1_total,
              SUM(video_freeze_time_500_last1) AS video_freeze_time_500_last1_total,
              SUM(video_totaltime_500_last1) AS video_totaltime_500_last1_total,
              SUM(video_freeze_time_200_last1) AS video_freeze_time_200_last1_total,
              SUM(video_totaltime_200_last1) AS video_totaltime_200_last1_total,
              SUM(video_freeze_time_last7) AS video_freeze_time_last7_total,
              SUM(video_totaltime_last7) AS video_totaltime_last7_total,
              SUM(video_freeze_time_500_last7) AS video_freeze_time_500_last7_total,
              SUM(video_totaltime_500_last7) AS video_totaltime_500_last7_total,
              SUM(video_freeze_time_200_last7) AS video_freeze_time_200_last7_total,
              SUM(video_totaltime_200_last7) AS video_totaltime_200_last7_total,
              SUM(audio_freeze_time_last1) AS audio_freeze_time_last1_total,
              SUM(audio_totaltime_last1) AS audio_totaltime_last1_total,
              SUM(audio_freeze_time_last7) AS audio_freeze_time_last7_total,
              SUM(audio_totaltime_last7) AS audio_totaltime_last7_total,
              SUM(s2l_total_delay_sec_last1) AS s2l_total_delay_sec_last1_total,
              SUM(s2l_25ms_delay_sec_last1) AS s2l_25ms_delay_sec_last1_total,
              SUM(s2l_75ms_delay_sec_last1) AS s2l_75ms_delay_sec_last1_total,
              SUM(s2l_total_delay_sec_last7) AS s2l_total_delay_sec_last7_total,
              SUM(s2l_25ms_delay_sec_last7) AS s2l_25ms_delay_sec_last7_total,
              SUM(s2l_75ms_delay_sec_last7) AS s2l_75ms_delay_sec_last7_total,
              SUM(p2s_lost_Leq5_last1) AS p2s_lost_Leq5_last1_total,
              SUM(p2s_lost_all_last1) AS p2s_lost_all_last1_total,
              SUM(p2s_lost_Leq5_last7) AS p2s_lost_Leq5_last7_total,
              SUM(p2s_lost_all_last7) AS p2s_lost_all_last7_total,
              SUM(crash_cnt_last1) AS crash_cnt_last1_total,
              SUM(service_cnt_last1) AS service_cnt_last1_total,
              SUM(crash_cnt_last7) AS crash_cnt_last7_total,
              SUM(service_cnt_last7) AS service_cnt_last7_total,
              SUM(s2l_lost_Leq5) AS s2l_lost_Leq5_total,
              SUM(s2l_lost_all) AS s2l_lost_all_total,
              SUM(s2l_lost_Leq5_last1) AS s2l_lost_Leq5_last1_total,
              SUM(s2l_lost_all_last1) AS s2l_lost_all_last1_total,
              SUM(s2l_lost_Leq5_last7) AS s2l_lost_Leq5_last7_total,
              SUM(s2l_lost_all_last7) AS s2l_lost_all_last7_total
            FROM report_datahub.pub_levels_quality_di_1
            WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-21') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-11-21') AND CAST(tag AS VARCHAR) = 'Product'
            GROUP BY date,
              dim) AS t2 ON t1.date = t2.date AND t1.dim = t2.dim
        WHERE date_parse(cast( t1.date as VARCHAR), '%Y%m%d') >= DATE('2021-11-21') AND date_parse(cast( t1.date as VARCHAR), '%Y%m%d') <= DATE('2021-11-21') AND CAST(tag AS VARCHAR) = 'Product') AS ""自定义 SQL 查询""
    HAVING COUNT(1) > 0) AS ""t0""
WHERE CASE WHEN CAST(""自定义 SQL 查询"".""tag"" AS VARCHAR) = 'Industry' AND CAST(""自定义 SQL 查询"".""product_level1"" AS VARCHAR) = 'RTC' AND CAST(""自定义 SQL 查询"".""dim"" AS VARCHAR) = 'osver' THEN 0 WHEN CAST(""自定义 SQL 查询"".""tag"" AS VARCHAR) = 'VerType' AND CAST(""自定义 SQL 查询"".""product_level1"" AS VARCHAR) = 'RTC' AND CAST(""自定义 SQL 查询"".""dim"" AS VARCHAR) = 'osver' THEN 0 WHEN CAST(""自定义 SQL 查询"".""tag"" AS VARCHAR) = 'Product' AND CAST(""自定义 SQL 查询"".""dim"" AS VARCHAR) = 'osver' AND CAST(""自定义 SQL 查询"".""product_level1"" AS VARCHAR) = 'RTC' THEN 1 ELSE 0 END AND CAST(""自定义 SQL 查询"".""level2"" AS VARCHAR) = 'Native' AND DATE_ADD('SECOND', 0, date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d')) = DATE_ADD('SECOND', 0, ""t0"".""__measure__0"")
HAVING COUNT(1) > 0"
"SELECT ""t0"".""srcRegion"" AS ""srcRegion""
FROM (SELECT ""自定义 SQL 查询"".""srcRegion"" AS ""srcRegion""
    FROM (SELECT date AS ""date"",
          src_domain AS ""srcDomain"",
          src_region AS ""srcRegion"",
          dest_idc AS ""idc"",
          delay_25 AS ""p2s_Delay25"",
          delay_50 AS ""p2s_Delay50"",
          delay_75 AS ""p2s_Delay75"",
          delay_100 AS ""p2s_Delay100"",
          delay_125 AS ""p2s_Delay125"",
          delay_150 AS ""p2s_Delay150"",
          delay_total,
          lost_ratio_5 AS ""p2s_lostRatio"",
          lostratio_total AS ""p2s_total"",
          jitter95_50 AS ""p2s_jitter95_50"",
          jitter95_100 AS ""p2s_jitter95_100"",
          jitter95_200 AS ""p2s_jitter95_200"",
          jitter95_300 AS ""p2s_jitter95_300"",
          jitter95_total,
          product_line,
          product_type
        FROM media.p2s_cover_mainland_ip
        WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-25') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-01')) AS ""自定义 SQL 查询""
    WHERE ""自定义 SQL 查询"".""idc"" IN ('aofei-frankfurt1g', 'aofei-hk1ga', 'aofei-japan', 'aofei-singapore1ga', 'aofei-tokyo9', 'changchun1g-cucc', 'changsha-cucc', 'changsha9-ctel', 'eq-newyork10', 'eq-newyork9', 'evc-chicago1g', 'evc-frankfurt1ga', 'evc-frankfurt9', 'evc-japan9a', 'evc-seattle1g', 'evc-singapore1ga', 'evc-singapore1gb', 'fuzhou1g-cmcc', 'guangzhou-cmcc', 'guangzhou0t-drpeng', 'guangzhou1g-cmcc', 'guangzhou6js-bgp', 'guangzhou99-cmcc', 'hangzhou6al-bgp', 'hangzhou9-ctel', 'hangzhou9b-cmcc', 'hefei9-cmcc', 'huainan1g-cmcc', 'huhehaote1g-ctel', 'huzhou9-ctel', 'huzhou9-cucc', 'jinan1g-3line', 'jinan1g-cucc', 'jinan6bdbm-cucc', 'jinan9-cmcc', 'jiujiang9-ctel', 'langfang6uc-cucc', 'nanchang1g-cmcc', 'neijiang1g-ctel', 'ningbo1g-3line', 'qingdao1g-ctel', 'qinhuangdao1g-cucc', 'shanghai6js-bgp', 'shantou1g-ctel', 'shenyang1g-cmcc', 'shenyang9a-cucc', 'suzhou1g-cmcc', 'suzhou6bdbm-ctel', 'taiyuan6bd-ctel', 'taiyuan6bdbm-ctel', 'taiyuan9-cucc', 'tangshan9-cucc', 'tangshan99-cucc', 'tianjin1ga-ctel', 'tianjin3g-3line', 'wujiang-ctel', 'wuxi3c-bgp', 'xiamen6bd-ctel', 'xiamen6bdbm-ctel', 'xinxiang1g-cucc', 'yancheng1g-ctel', 'yantai1g-cucc', 'yiyang1g-cucc', 'yueyang6bd-ctel', 'yueyang6bdbm-ctel', 'zaozhuang9b-cucc', 'zen-amsterdam9b', 'zen-bangalore1ga', 'zen-bangkok', 'zen-chennai1ga', 'zen-dallas1g', 'zen-frankfurt1g', 'zen-frankfurt1gb', 'zen-hk9b', 'zen-losangeles9', 'zen-losangeles9a', 'zen-melbourne9a', 'zen-miami1g', 'zen-moscow2', 'zen-saopaulo2', 'zen-singapore1ga', 'zen-singapore1gb', 'zen-singapore3a', 'zen-washington1ga') OR ( (  ""自定义 SQL 查询"".""idc""  ) is null) OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'baoji1g-ctel' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'beijing-bgp' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'beijing6-bgp' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'beijing8-bgp' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'changsha1g-3line' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'changsha1g-cucc' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'changzhou9a-drpeng' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'chengdu6al-bgp' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'chongqing1g-3line' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'chongqing1ga-ctel' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'dalian1g-cmcc' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'eq-losangeles9' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'foshan1g-ctel' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'foshan9-ctel' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'guizhou1g-ctel' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'hangzhou3g-3line' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'lishui1g-ctel' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'luoyang1g-ctel' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'nanchang6bd-ctel' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'nanchang6uc-ctel' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'qinhuangdao9-cucc' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'retn-amsterdam0t' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'shenzhen9-drpeng' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'singtel-singapore0t' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'taizhou1g-3line' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'taizhou9-cucc' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'tianjin1g-cmcc' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'tianjin1g-cucc' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'tianjin9-ctel' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'tianjin9d-cucc' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'wenzhou1g-cmcc' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'wenzhou9-cmcc' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'xian1g-cmcc' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'xiangyang1g-cmcc' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'xixian9-ctel' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'xuzhou9b-ctel' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'yancheng9-cmcc' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'yancheng9b-ctel' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'yangzhou1g-cmcc' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'yangzhou6uc-3line' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'zen-amsterdam1' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'zen-amsterdam3' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'zen-frankfurt9a' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'zen-hk1gb' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'zen-japan' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'zen-japan9' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'zen-london1ga' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'zen-london3' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'zen-london9a' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'zen-losangeles3' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'zen-mumbai1ga' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'zen-mumbai9' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'zen-singapore9b' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'zen-tokyo1g' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'zhangjiakou1gb-cmcc' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'zhengzhou6bd-cucc' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'zhenjiang1g-3line' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'zhuzhou1g-ctel'
    GROUP BY ""自定义 SQL 查询"".""idc"",
      1
    HAVING CAST(CASE WHEN SUM(""自定义 SQL 查询"".""p2s_total"") >= 0 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100 THEN '0-100' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 1000 THEN '100-1000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 1000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 10000 THEN '1000-10000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 10000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100000 THEN '10000-100000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100000 THEN '100000以上' ELSE 'other' END AS VARCHAR) = '0-100' OR CAST(CASE WHEN SUM(""自定义 SQL 查询"".""p2s_total"") >= 0 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100 THEN '0-100' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 1000 THEN '100-1000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 1000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 10000 THEN '1000-10000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 10000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100000 THEN '10000-100000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100000 THEN '100000以上' ELSE 'other' END AS VARCHAR) = '100-1000' OR CAST(CASE WHEN SUM(""自定义 SQL 查询"".""p2s_total"") >= 0 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100 THEN '0-100' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 1000 THEN '100-1000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 1000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 10000 THEN '1000-10000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 10000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100000 THEN '10000-100000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100000 THEN '100000以上' ELSE 'other' END AS VARCHAR) = '1000-10000' OR CAST(CASE WHEN SUM(""自定义 SQL 查询"".""p2s_total"") >= 0 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100 THEN '0-100' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 1000 THEN '100-1000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 1000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 10000 THEN '1000-10000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 10000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100000 THEN '10000-100000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100000 THEN '100000以上' ELSE 'other' END AS VARCHAR) = '10000-100000' OR CAST(CASE WHEN SUM(""自定义 SQL 查询"".""p2s_total"") >= 0 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100 THEN '0-100' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 1000 THEN '100-1000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 1000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 10000 THEN '1000-10000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 10000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100000 THEN '10000-100000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100000 THEN '100000以上' ELSE 'other' END AS VARCHAR) = '100000以上') AS ""t0""
GROUP BY 1"
"SELECT ""自定义 SQL 查询"".""product_level3"" AS ""product_level3""
FROM (SELECT date,
      SUBSTR(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) AS date_range_1,
      SUBSTR(CAST(end_date AS VARCHAR), 1, 10) AS date_range_2,
      stat_period,
        CASE WHEN CAST(stat_period AS VARCHAR) = 'day' THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,
      area,
      vid,
      project,
      company_id AS cid,
      company_name AS company,
      customer_level AS level,
      vid_internal_industry_en AS industry,
      vid_use_case_cn,
      csdc_owner,
      os,
      ver,
      ver_type,
      product_level1,
      product_level2,
      product_level3,
      total,
      audio,
      video,
      video_sd,
      video_hd,
      video_hdp,
        host_audio + host_video AS host,
      host_audio,
      host_video,
      host_sd,
      host_hd,
      host_hdp,
        audience_audio + audience_video AS audience,
        audience_audio_low_latency + audience_video_low_latency AS audience_low_latency,
      audience_audio,
      audience_audio_low_latency,
      audience_video,
      audience_video_low_latency,
      audience_sd,
      audience_sd_low_latency,
      audience_hd,
      audience_hd_low_latency,
      audience_hdp,
      audience_hdp_low_latency,
      total_last1,
      audio_last1,
      video_last1,
      video_sd_last1,
      video_hd_last1,
      video_hdp_last1,
        host_audio_last1 + host_video_last1 AS host_last1,
      host_audio_last1,
      host_video_last1,
        audience_audio_last1 + audience_video_last1 AS audience_last1,
        audience_audio_low_latency_last1 + audience_video_low_latency_last1 AS audience_low_latency_last1,
      audience_audio_last1,
      audience_audio_low_latency_last1,
      audience_video_last1,
      audience_video_low_latency_last1,
      total_last7,
      audio_last7,
      video_last7,
      video_sd_last7,
      video_hd_last7,
      video_hdp_last7,
        host_audio_last7 + host_video_last7 AS host_last7,
      host_audio_last7,
      host_video_last7,
        audience_audio_last7 + audience_video_last7 AS audience_last7,
        audience_audio_low_latency_last7 + audience_video_low_latency_last7 AS audience_low_latency_last7,
      audience_audio_last7,
      audience_audio_low_latency_last7,
      audience_video_last7,
      audience_video_low_latency_last7
    FROM report_datahub.vendor_vid_usage_di_1
    WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-06') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-06') AND CAST(vid AS VARCHAR) = CAST(428342 AS VARCHAR) AND dim = 1) AS ""自定义 SQL 查询""
GROUP BY 1
ORDER BY ""product_level3"""
"SELECT SUM(""自定义 SQL 查询"".""p2s_Delay25"" * ""自定义 SQL 查询"".""delay_total"") AS ""TEMP(Calculation_1231523447811919872)(1563607262)(0)"",
  SUM(""自定义 SQL 查询"".""delay_total"") AS ""TEMP(Calculation_1231523447811919872)(363980608)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_Delay50"" * ""自定义 SQL 查询"".""delay_total"") AS ""TEMP(Calculation_1231523447812059137)(1551638771)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_Delay75"" * ""自定义 SQL 查询"".""delay_total"") AS ""TEMP(Calculation_1231523447812194306)(2562427304)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_lostRatio"" * ""自定义 SQL 查询"".""p2s_total"") AS ""TEMP(Calculation_1231523447812321283)(1741181994)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_total"") AS ""TEMP(Calculation_1231523447812321283)(2624355999)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_Delay100"" * ""自定义 SQL 查询"".""delay_total"") AS ""TEMP(Calculation_4208191644284649486)(4273621395)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_Delay125"" * ""自定义 SQL 查询"".""delay_total"") AS ""TEMP(Calculation_4208191644284768271)(3242688810)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_Delay150"" * ""自定义 SQL 查询"".""delay_total"") AS ""TEMP(Calculation_4208191644285206544)(1276673441)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_jitter95_50"" * ""自定义 SQL 查询"".""jitter95_total"") AS ""TEMP(Calculation_4208191644285542417)(1652714847)(0)"",
  SUM(""自定义 SQL 查询"".""jitter95_total"") AS ""TEMP(Calculation_4208191644285542417)(633698484)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_jitter95_100"" * ""自定义 SQL 查询"".""jitter95_total"") AS ""TEMP(Calculation_4208191644285714450)(3609783325)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_jitter95_200"" * ""自定义 SQL 查询"".""jitter95_total"") AS ""TEMP(Calculation_4208191644285919251)(206867949)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_jitter95_300"" * ""自定义 SQL 查询"".""jitter95_total"") AS ""TEMP(Calculation_4208191644286099476)(401523338)(0)"",
  ""自定义 SQL 查询"".""idc"" AS ""idc"",
  ""自定义 SQL 查询"".""speaker_vos_ip"" AS ""speaker_vos_ip"",
  ""自定义 SQL 查询"".""srcCountry"" AS ""srcCountry"",
  ""自定义 SQL 查询"".""srcDomain"" AS ""srcDomain"",
  ""自定义 SQL 查询"".""srcisp"" AS ""srcisp"",
  SUM(""自定义 SQL 查询"".""p2s_total"") AS ""sum_p2s_total_ok""
FROM (SELECT date AS ""date"",
      src_domain AS ""srcDomain"",
      src_country AS ""srcCountry"",
      dest_idc AS ""idc"",
      speaker_ip_isp AS ""srcisp"",
      speaker_vos_ip,
      delay_25 AS ""p2s_Delay25"",
      delay_50 AS ""p2s_Delay50"",
      delay_75 AS ""p2s_Delay75"",
      delay_100 AS ""p2s_Delay100"",
      delay_125 AS ""p2s_Delay125"",
      delay_150 AS ""p2s_Delay150"",
      delay_total,
      lost_ratio_5 AS ""p2s_lostRatio"",
      lostratio_total AS ""p2s_total"",
      jitter95_50 AS ""p2s_jitter95_50"",
      jitter95_100 AS ""p2s_jitter95_100"",
      jitter95_200 AS ""p2s_jitter95_200"",
      jitter95_300 AS ""p2s_jitter95_300"",
      jitter95_total,
      product_line,
      product_type
    FROM media.p2s_cover_oversea_ip
    WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-25') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-01')) AS ""自定义 SQL 查询""
WHERE CAST(""自定义 SQL 查询"".""speaker_vos_ip"" AS VARCHAR) >= '1.180.236.12' AND CAST(""自定义 SQL 查询"".""speaker_vos_ip"" AS VARCHAR) <= '76.74.150.141' AND ""自定义 SQL 查询"".""srcisp"" IN ('1telecom.com.br', '21.com.pk', '3s.com.tn', '4inet.com.br', '73s.com.br', 'a1.by', 'a1.si', 'a3.se', 'aan-ict.com', 'aapt.com.au', 'abcom.al', 'absolutnet.com.br', 'accesshaiti.com', 'acelerate.com', 'acertelecom.com.br', 'acesso10.net.br', 'acessotelecomunicacoes.com.br', 'actcorp.in', 'afghan-wireless.com', 'afghantelecom.af', 'africell.ug', 'afriqnetworks.co.ke', 'agatangelo.com.br', 'agni.com', 'aguasdelcolorado-lp.com.ar', 'airmax.com.pk', 'airnet.net.br', 'airtel.cd', 'airtel.cg', 'airtel.co.rw', 'airtel.co.tz', 'airtel.co.ug', 'airtel.co.zm', 'airtel.com', 'airtel.mg', 'airtel.mw', 'airtel.ne', 'airtel.td', 'ais.co.th', 'aknet.kg', 'albtelecom.al', 'alfa.com.lb', 'alfanet.az', 'alfanet.tv', 'algartelecom.com.br', 'algerietelecom.dz', 'ALIYUN', 'aljeel.ly', 'allconecta.com.br', 'allo.my', 'almadarisp.com', 'aloo.com.br', 'alriyada-net.net', 'alsardfiber.com', 'altanettelecom.com.br', 'altice.com.do', 'amatelecom.com.br', 'amazon.com', 'americanet.com.br', 'americatel.com.pe', 'amorimtelecom.com.br', 'amplia.co.tt', 'amturbonet.com.br', 'anditel.com.co', 'angolacables.co.ao', 'ans.af', 'antel.com.uy', 'aoun-networks.com', 'apsfl.in', 'aptg.com.tw', 'aranetinfo.com.br', 'ariasat.af', 'ariastelecom.com.br', 'ario.net', 'arn.dz', 'arsat.com.ar', 'artnet.pl', 'asiabtelecom.com', 'asiacell.com', 'asianvision.com.ph', 'ask4.com', 'asnet.com.br', 'asolucaoinfo.com.br', 'aster.com.do', 'ativanetwork.com.br', 'att.com', 'avantel.co', 'avianet.com.br', 'awasr.com', 'aya.sy', 'azercell.com', 'azeronline.com', 'azeurotel.com', 'azqtel.com', 'azstarnet.az', 'aztecacomunicaciones.com', 'aztelekom.az', 'babilon-t.tj', 'baehost.com', 'baghdad-link.com', 'bakcell.com', 'baktelecom.az', 'baktun.com.gt', 'batelco.com', 'bayan.com.ph', 'beeline.am', 'beeline.kg', 'beeline.kz', 'beeline.ru', 'beeline.tj', 'beeline.uz', 'belizetelemedia.net', 'beltelecom.by', 'beskidmedia.pl', 'bezeqint.net', 'bhtelecom.ba', 'bitakat.sy', 'bitcom.psi.br', 'bitel.com.pe', 'blinkload.cloud', 'blue.net.gt', 'bmjnet.com.br', 'bnet.ps', 'bouyguestelecom.fr', 'brasilinfo.net.br', 'brasilnetcp.net.br', 'brasnetinformatica.com.br', 'brcentral.com.br', 'bredband2.com', 'brisanet.com.br', 'brsite.com.br', 'brxtelecom.com.br', 'bsnl.co.in', 'bt.bt', 'bt.com', 'btc.bw', 'btcbahamas.com', 'buana.net', 'buechele-networks.de', 'bvitourism.com', 'bwtelecom.com', 'cabangu.com.br', 'cablebahamas.com', 'cablecolor.hn', 'cabledelancer.com', 'cabledelnorte.com', 'cablelink.com.ph', 'cablemar.net', 'cablemax.com.do', 'cablenet.com.cy', 'cableonda.com', 'cableondaoriental.com', 'cabletica.com', 'cablevision.com.ar', 'canal-plus.com', 'canar.sd', 'cantv.com.ve', 'caribcable.com', 'caribserve.net', 'caxiasontelecom.com.br', 'cdn77.com', 'cdns.net', 'cednet.com.br', 'celcom.com.my', 'cell-net.net', 'cellc.co.za', 'cellcom.co.il', 'centraltv.bz', 'centurylink.com', 'ceranetworks.com', 'ceretechs.com', 'charter.com', 'ChinaMobile', 'ChinaTelecom', 'ChinaUnicom', 'chinguitel.mr', 'chltech.net', 'choopa.com', 'cht.com.tw', 'citicableworld.com', 'claro.com.ar', 'claro.com.br', 'claro.com.co', 'claro.com.do', 'claro.com.ec', 'claro.com.gt', 'claro.com.hn', 'claro.com.ni', 'claro.com.pa', 'claro.com.pe', 'claro.com.sv', 'claro.cr', 'clarochile.cl', 'claropr.com', 'clearpath.net.ph', 'clig.com.br', 'clnetworks-sa.com', 'cloudflare.com', 'cloudinnovation.org', 'clouvider.co.uk', 'clubnet.co.mz', 'cmet.net', 'cnet.af', 'cnt.gob.ec', 'cogentco.com', 'colombiamastv.co', 'colombiatel.co', 'colsecor.com.ar', 'comcast.com', 'comhem.se', 'comnt.com.br', 'comteco.com.bo', 'conectaminas.com.br', 'conectbm.com.br', 'conectcor.com.br', 'conective.sv', 'conexaotelecom.net.br', 'connect.az', 'connect.net.pk', 'connecti.net.br', 'connectinternet.com.br', 'conquesttelecom.com.br', 'convergeict.com', 'convergenze.it', 'coolnet.ps', 'coopetel.org', 'cooptortu.com.ar', 'copaco.com.py', 'copeltelecom.com', 'cosmote.gr', 'costadosol.tv.br', 'cotas.com', 'cotecal.com.ar', 'cotel.bo', 'cprm.net', 'csuc.cat', 'cte.net.br', 'cwc.com', 'cwnetworks.com', 'cwpanama.com', 'cyber.net.pk', 'cyberia.net.lb', 'cyberwave.com.ar', 'dascacable.com', 'datanet.iq', 'dauphintelecom.com', 'davitel.com.ar', 'dcc.ps', 'dctv.com.ph', 'delta-telecom.net', 'delta-x.ua', 'desktop.com.br', 'destinycable.com.ph', 'dflash.com.br', 'dialnet.net', 'dialog.lk', 'digi.com.my', 'digicelgroup.com', 'digimobil.es', 'digital-vm.com', 'digitalocean.com', 'digitel.com.ve', 'digitel.ph', 'dimensiondata.com', 'directv.com.ar', 'directvla.com.co', 'discoverflow.co', 'dishtele.com', 'djiboutitelecom.dj', 'dna.fi', 'docomopacific.com', 'domru.ru', 'DRPENG', 'dtac.co.th', 'du.ae', 'dumaimandirinet.id', 'e-lcom.sy', 'eaglenet.net.lb', 'earthlink.iq', 'eastlink.ca', 'ecom.net.do', 'edatel.com.co', 'ee.co.uk', 'elcat.kg', 'elisa.ee', 'elsuhdnet.com', 'embratel.com.br', 'emcali.net.co', 'emtel.net.co', 'engeplus.com.br', 'enlacevision.com', 'enredhn.com', 'entel.bo', 'entel.cl', 'entel.pe', 'enteriw.com.br', 'ert.com.co', 'estnoc.ee', 'estrelatel.com', 'etapa.net.ec', 'etb.com', 'etecsa.cu', 'ethiotelecom.et', 'ethtelecom.com.br', 'etisalat.ae', 'etisalat.af', 'etisalat.eg', 'etllao.com', 'evo.uz', 'exitovision.com', 'expand.tv.br', 'express.com.ar', 'faciliti.com.br', 'falco-networks.com', 'farahnet.net.lb', 'fariya.com', 'farsroute.af', 'fastiraq.com', 'fastnetisp.com', 'fastprovedor.net.br', 'fdnet.com.br', 'fetnet.net', 'fiber-sat.net', 'fiberathome.my', 'fiberbandalarga.com.br', 'fibercom.com.pk', 'fibergrid.net', 'fiberlink.net.pk', 'fibernet.uz', 'fibertelecom-isp.com.br', 'fiberwaves.com', 'fiberway.com.ar', 'fiberx.net', 'fibra1.com.br', 'fibralink.com.br', 'fibranet.ec', 'filprod-dgte.ph', 'fittelecom.com.br', 'flashfibra.net.br', 'flink.uz', 'flx.com.pe', 'flybyte.com.br', 'foaaa.com', 'forthnet.gr', 'fourtelecom.com', 'free.fr', 'freenet-group.de', 'fsmtc.fm', 'ft.fo', 'fusion.ps', 'g8.net.br', 'gals.uz', 'gcore.lu', 'gd.tt', 'gegatelecom.net', 'gemzo.ps', 'genettelecom.net.br', 'gerrys.net', 'gigaline.com.br', 'gigalink.com.br', 'giganor.com', 'gigared.com.ar', 'gironetfibra.com.br', 'glink.net.br', 'glnet.com.br', 'global-layer.com', 'globe.com.ph', 'globenet.net', 'gloworld.com', 'glpnet.com.br', 'gmo.jp', 'go.com.mt', 'godnet.com.br', 'golddata.net', 'google.com', 'goonet.com.br', 'gorannet.net', 'gptc.ly', 'grajaunet.com.br', 'grameenphone.com', 'gramnet.com.br', 'groupnet-iq.com', 'gruponewlife.com.br', 'grupotvcable.com', 'gtd.cl', 'gthost.com', 'gtt.co.gy', 'gtt.net', 'guestchoicerd.com', 'hadara.ps', 'halasat.net', 'hayat-isp.net', 'hbinfo.com.br', 'heficed.com', 'hetzner.com', 'highspeed.com.tr', 'hilink.com.br', 'holistica.com.br', 'homenet.cl', 'homenet.sumy.ua', 'hondutel.hn', 'hopnet.com.br', 'hormuud.com', 'hosteam.pl', 'hosteurope.de', 'hostroyale.com', 'hotnet.net.il', 'hrins.net', 'hughes.com', 'hughes.com.br', 'hvtv.co', 'hypernet.sy', 'i-tower.net', 'iam.ma', 'ibaaco.net', 'ibitelecom.com.br', 'ibiunet.com.br', 'ibw.com.ni', 'ice.no', 'iclik.co', 'ideay.com', 'idm.net.lb', 'ifxnetworks.com', 'ifxnw.com.ve', 'iij.ad.jp', 'iinet.net.au', 'impactnet.com.br', 'indosatooredoo.com', 'inea.pl', 'inet.sy', 'inethn.com', 'inetminas.com.br', 'infinity.iq', 'infologti.com.br', 'infonet.ee', 'infornet.in', 'instatelecom.com', 'intelsat.com', 'inter.com.ve', 'interbourg.com.ar', 'interconnects.us', 'interlink.com.ar', 'internexa.com', 'internexsolutions.com', 'internext.cz', 'intesanet.net', 'inwi.ma', 'io-global.com', 'iomart.com', 'iontel.ly', 'ip.ro', 'iparatodos.com.ar', 'ipc.ph', 'ipcore.com.my', 'iplan.com.ar', 'iptp.net', 'iqnet.com', 'iranettelecom.com.br', 'is.com.gh', 'istanbuldc.com', 'istv.uz', 'it7.net', 'ite.net', 'itelkom.co', 'itldc.com', 'itsbrasil.net', 'iveloz.net.br', 'ivitelecom.com.br', 'jdimax.com', 'jetnet.ps', 'jhcs.com', 'jio.com', 'jotazo.com.br', 'jpproviders.com.br', 'jrconect.com', 'jt.iq', 'jtglobal.com', 'juquianet.net.br', 'k2telecom.com.br', 'kabayancablegroup.com', 'kalibocable.net', 'kamatera.com', 'kaopuyun.com', 'karibcable.com', 'katv1.com', 'knet-telecom.com', 'korektel.com', 'kt.kg', 'kyivstar.ua', 'lagoon.nc', 'laotel.com', 'lazertelecom.com', 'leadertelecom.ru', 'leaseweb.com', 'level3.com', 'libyana.ly', 'ligue.net', 'link.net.pk', 'linkem.com', 'linode.com', 'linxbr.com.br', 'liquidtelecom.com', 'liquidtelecom.net', 'litc.ly', 'litoraltibau.com.br', 'lizcat.com', 'logic.ky', 'logicweb.com', 'logix.com', 'loina.wf', 'lonsdalenet.co.uk', 'lpinternet.com.br', 'lpnet.com.br', 'ltt.ly', 'lunasat.com', 'm247.com', 'mada.ps', 'maisinternet.net.br', 'maisprovedor.com.br', 'maksnet.net', 'marandu.com.ar', 'masaratcom.com', 'masternet.net.br', 'matelecon.com.br', 'matosnet.com.br', 'matrixisp.com', 'mavnet.com.br', 'maxcomm.com.br', 'maxis.com.my', 'mayatama.net', 'mbgtecnologias.com.br', 'mc.inf.br', 'mc.net.co', 'mediaserv.com', 'megacable.com.ar', 'megacable.com.mx', 'megacom.kg', 'megafon.ru', 'megafon.tj', 'megaline.kg', 'megalinkcorp.com.br', 'meganetsalto.com.br', 'megared.com.gt', 'melita.com', 'metronethn.com', 'metrotel.com.ar', 'metrotel.com.co', 'mhnet.com.br', 'microsoft.com', 'microtell.com.br', 'mimonet.com.br', 'minasnet.net', 'mksnet.com.br', 'mnets.net', 'mobi.net.lb', 'mobile.free.fr', 'mobilinkgsm.com', 'mobily.com.sa', 'mobitel.lk', 'mobtelecom.com.br', 'mountainview.com.ph', 'movistar.com.pa', 'mrynet.com.br', 'mtilabs.com', 'mtn.ci', 'mtn.co.rw', 'mtn.co.ug', 'mtn.com.af', 'mtn.com.gh', 'mtn.com.sy', 'mtn.sd', 'mtncongo.net', 'mtnirancell.ir', 'mtnonline.com', 'mts.rs', 'mts.ru', 'mts.ua', 'multicablehonduras.com', 'multiplaytelecom.com.br', 'mundopacifico.cl', 'musurit.com', 'myrepublic.net', 'mysky.com.ph', 'nar.az', 'natcom.com.ht', 'nawand.net', 'nayatel.com', 'neda.af', 'nedetel.net', 'neotel.co.za', 'net.sy', 'net11.com.br', 'netbarretos.com.br', 'netcartelecom.com.br', 'netco.uz', 'netcomplusve.com', 'netfibra.com', 'netfibratelecomunicacoes.com.br', 'netforcetelecom.com.br', 'netglobal.it', 'netia.pl', 'netiontelecom.com.br', 'netiq.sk', 'netlife.ec', 'netlinetelecom.com.br', 'netprolb.com', 'netsaojose.com.br', 'netseg.net.br', 'netserv.com.br', 'netstream.ps', 'netuno.net', 'neunet.com.ar', 'newcloudnetworks.com', 'newertech.com.br', 'newnet.psi.br', 'newroztelecom.com', 'newstarmax.ps', 'nextel.com.br', 'nextnetwork.com.br', 'nexttel.cm', 'nile-online.com', 'nipcable.com.br', 'niponet.com.br', 'niqturbo.com.br', 'nmultifibra.com.br', 'nortech.com.ar', 'northtelecom.af', 'nortis.ma', 'nos.pt', 'nova.is', 'novafibratelecom.com.br', 'novanetwork.com.br', 'ntcnet.com.br', 'nterconexionhn.com', 'nurtelecom.kg', 'oeste-rede.com.br', 'oesteline.com.br', 'oi.com.br', 'olafibra.com.br', 'omantel.om', 'omni.net.br', 'omniya.sy', 'omnya.co', 'onatel.bf', 'onemax.com', 'online.net', 'online.net.br', 'onnethn.com', 'oops.tv.br', 'ooredoo.com.mm', 'ooredoo.om', 'ooredoo.qa', 'ooredoo.tn', 'opstelecom.com.br', 'opt.nc', 'optus.com.au', 'oracle.com', 'orange-bissau.com', 'orange.bf', 'orange.cd', 'orange.ci', 'orange.com', 'orange.eg', 'orange.jo', 'orange.ma', 'orange.mg', 'orange.ne', 'orange.pl', 'orange.ps', 'orange.sk', 'orange.tn', 'orangemali.com', 'orbitcable.com.do', 'orbitelecom.com.br', 'oriontelekom.rs', 'outremer-telecom.fr', 'ovh.com', 'paikltd.com', 'palautelecoms.com', 'paltel.ps', 'palwifi.net', 'pandanetwork.com.br', 'pccw.com', 'personal.com.py', 'petaexpress.com', 'petrynet.com.br', 'pinspb.ru', 'pirmamgroup.com', 'planetcabletv.com', 'platinum.uz', 'play.pl', 'pldt.com', 'plus.pl', 'plusnetfoz.com', 'pnccpalau.com', 'pointtelecom.com.br', 'post.lu', 'powerline.com.br', 'powernetsolutions.com.br', 'pratatelecom.com.br', 'predialnet.com.br', 'primatecmt.com.br', 'privatelayer.com', 'privax.com', 'prodatanet.com.ph', 'prokk.net', 'provale.com.br', 'provedorsuperconnect.com.br', 'provedoruniversal.com.br', 'providersnet.com.br', 'psn.co.id', 'psychz.net', 'ptcl.com.pk', 'puntonet.ec', 'qitelecom.net.br', 'qnax.com.br', 'qubee.com.pk', 'quick.com.br', 'quickline.ch', 'radiolan.sk', 'ragtek.com.br', 'rahanet.af', 'ramnet.com.br', 'rapidatelecom.com.br', 'razaoinfo.com.br', 'rdconlinebd.net', 'redecom.net.br', 'redenilf.com.br', 'redetelecom.com.br', 'redfoxtelecom.com.br', 'redintercable.com.ar', 'researchsrl.com.ar', 'rightel.ir', 'riotel.com.ar', 'rmsconnect.net.br', 'rnova.com.br', 'rnp.br', 'robi.com.bd', 'rogers.com', 'roshan.af', 'royalcable.com.ph', 'rsonet.com.ar', 'rt.ru', 'runnet.sy', 'rvrnetworks.com', 'sadattelecom.af', 'safaricom.co.ke', 'salartel.com', 'salestelecom.net.br', 'samanet.sy', 'sanluisctv.com.ar', 'sattrakt.com', 'sawaisp.sy', 'sbb.rs', 'sco.gov.pk', 'sconfibras.com.br', 'scopesky.com', 'scrio.com.br', 'scs-net.org', 'seacom.mu', 'sebratel.com.br', 'sepcom.com.co', 'sercomtel.com.br', 'ses.com', 'seven-sky.net', 'sfox.com.br', 'sfr.com', 'sfr.re', 'sglinknet.com.br', 'shams-tele.com', 'sharktech.net', 'sigmanet.com.br', 'simbanet.net', 'simbatv.co.ug', 'sinusnet.pl', 'sion.com', 'sitel.com.br', 'sjnettelecom.com.br', 'sky.com', 'sky.com.br', 'sky.net.co', 'skylogic.it', 'skylonhost.com', 'skyonline.net.ar', 'slt.lk', 'smart-bz.com', 'smart.com.ph', 'smartlink-isp.com', 'smartwavesnetwork.com', 'sobralnet.com.br', 'socitel.com.br', 'sodobrasil.net.br', 'softether.jp', 'softlinknet.com', 'sol.az', 'solucaonetwork.com', 'solunet.com.ar', 'somtelnetwork.net', 'sonatel.sn', 'speedclick.ps', 'speedjettelecom.com.br', 'speednetcomunicacoes.com.br', 'speedrs.com.br', 'spinservers.com', 'splink.net.br', 'sprint.com', 'st.uz', 'stantelecom.net', 'star1.com.br', 'starcommunicationbd.com', 'starktel.com', 'starman.com.br', 'starnet.cz', 'starnettelecom.com.br', 'stationnet.com.br', 'stc.com.sa', 'stem.co.za', 'strongvpn.com', 'stv.ee', 'suanet.net.br', 'suatelecom.com.br', 'sudatel.sd', 'sudatel.sn', 'sudoestetelecom.com.br', 'sumicity.net.br', 'supercable.com.ve', 'supercabotv.com.br', 'supercanal-arlink.com.ar', 'supercellnetwork.com', 'superlink.ps', 'superonline.net', 'supranet.com.br', 'sure.com', 'surfshark.com', 'swan.sk', 'swisscom.ch', 'sygo.com.br', 'synapsecom.gr', 'syriatel.sy', 't-mobile.com', 't-mobile.cz', 't-mobile.pl', 't1chihuahua.com', 'tajnet.tj', 'takamol.sy', 'talia.net', 'talktalkgroup.com', 'tangerine.co.ug', 'tarinnet.info', 'tascom.com.br', 'tashicell.com', 'tbtelecom.net.br', 'tca.com.br', 'tcell.tj', 'tchenet.net', 'tcheturbo.com.br', 'tci.ir', 'tct.ir', 'tcvnet.com.br', 'tdc.dk', 'tdkom.com.br', 'techcomprovedor.com.br', 'tecnologiasvirtuales.com', 'tedata.net', 'teko.com.ni', 'telbru.com.bn', 'telconet.ec', 'telcorp.com.ve', 'tele2.com', 'tele2.kz', 'tele2.ru', 'telebras.com.br', 'telebucaramanga.com.co', 'telecablecentral.com', 'telecablecr.com', 'telecablelaunion.com', 'telecel-rca.com', 'telecelfaso.bf', 'telecentro.com.ar', 'telecom.com.ar', 'telecom.kz', 'telecom.pt', 'telecom.tm', 'telecomdados.com.br', 'telecomitalia.it', 'telecomitalia.sm', 'telecomprovider.com.br', 'telefonica.co', 'telefonica.com', 'telefonica.com.pe', 'telefonica.es', 'telefonicachile.cl', 'teleguam.net', 'teleimagensatelital.com', 'telekom.de', 'telekom.hu', 'telekom.mk', 'telekom.sk', 'telemach.si', 'telemgroup.sx', 'telemontv.com', 'telenet.be', 'telenor.com', 'telenor.com.pk', 'telenor.rs', 'telenord.com', 'telepost.gl', 'telered.com.ar', 'telesis.hn', 'telesur.sr', 'televiaducto.com.do', 'teleyemen.com.ye', 'telia.com', 'telia.ee', 'telium.com.br', 'telkom.co.id', 'telkomsel.com', 'tellcorpce.com.br', 'telmex.com', 'telmexchile.cl', 'telnets.com.br', 'telpin.com.ar', 'telstra.com', 'telsur.cl', 'telvgg.coop', 'tely.com.br', 'tencent.com', 'tepenet.com.tr', 'terra.net.lb', 'terratransit.de', 'tfl.com.fj', 'thecable.net', 'thegeniusisp.com', 'thglobalvision.net', 'thinkhuge.net', 'thsprovider.com.br', 'thundertecnologia.com.br', 'tigo.co.rw', 'tigo.com.bo', 'tigo.com.co', 'tigo.com.gt', 'tigo.com.hn', 'tigo.com.py', 'tigo.com.sv', 'tigo.cr', 'tigo.sn', 'tigrisnet.net', 'tim.com.br', 'time.com.my', 'timortelecom.tl', 'tiqanyatalshabaka.com', 'titania.com.br', 'tixtelecom.com.br', 'tm.com.my', 'togotelecom.tg', 'toledonet.com.br', 'tolrs.com.br', 'topcomunications.com', 'topnet.tn', 'tot.co.th', 'totalplay.com.mx', 'toya.net.pl', 'tpg.com.au', 'tpp.com.ar', 'tps.uz', 'transdatelecom.com', 'transeurocom.az', 'transnexa.com', 'tre.se', 'tremnet.com.br', 'tri.co.id', 'trixnet.com.br', 'truecorp.co.th', 'tstt.co.tt', 'tsukaeru.net', 'ttcl.co.tz', 'tunisietelecom.tn', 'turbonetwifi.com.br', 'turk.net', 'turkcell.com.tr', 'turktelekom.com.tr', 'turontelecom.uz', 'tvc.tv.br', 'tvkhajnowka.pl', 'tvn.tv.br', 'tvsom.com.br', 'tw1.com', 'twmbroadband.com', 'u.com.my', 'uatelecom.af', 'ucell.uz', 'ufinet.com', 'ufone.com', 'ukrtelecom.ua', 'ultranetpb.com.br', 'umniah.com', 'unartel.cz', 'une.com.co', 'unifi.com.my', 'unifique.com.br', 'unitel.com.la', 'uniteltmais.cv', 'unonet.com.br', 'unusinc.com', 'uolsinectis.com.ar', 'upc.at', 'upc.cz', 'upcspl.in', 'upfournet.com.br', 'upnettelecom.net.br', 'usatv.port48.com', 'uts.cw', 'uztelecom.uz', 'vcnetwork.com.br', 'verizon.com', 'vextelecom.com.br', 'vh.net', 'vi.choice-wireless.com', 'viaband.net.br', 'vianet.com.br', 'vianovatelecom.com.br', 'viaradiodourados.com.br', 'viareal.com.br', 'viettel.com.vn', 'view.sy', 'vilanovanet.com', 'vini.pf', 'vip.mk', 'vipbrtelecom.com.br', 'vipnettelecom.com.br', 'virginmedia.com', 'virginmedia.ie', 'virtex.com.br', 'visp.net.lb', 'vitaltelecom.net', 'viva.com.bh', 'viva.com.do', 'viyavi.com', 'vmnettelecom.com.br', 'vnpt.vn', 'vocetelecom.vc', 'vocus.co.nz', 'vodacom.cd', 'vodacom.co.ls', 'vodafone.com', 'vodafone.com.au', 'vodafone.com.eg', 'vodafone.com.fj', 'vodafone.com.gh', 'vodafone.de', 'vodafone.gr', 'vodafone.ie', 'vodafone.in', 'vodafone.is', 'vodafone.it', 'vodafone.qa', 'vogeltelecom.com', 'vtr.com', 'w2i.net.br', 'wananchi.com', 'wateen.com', 'wavenet-lb.net', 'webbytelecom.com.br', 'websurfer.com.np', 'wildpark.net', 'wind.com.do', 'wind.gr', 'windtelecom.com.br', 'windtre.it', 'winetbrasil.com.br', 'winfnet.com.br', 'wiretelecom.com.br', 'wise.net.lb', 'wmservice.com.do', 'worldstream.nl', 'wsinternet.com.br', 'wsnetfibra.com.br', 'wznet.com.br', 'xl.co.id', 'xolbroadband.com', 'yellownet.com.br', 'yemen.net.ye', 'yeptv.com.br', 'yes.my', 'yota.com.ni', 'zain.com', 'zamtel.zm', 'zap.cvmultimedia.cv', 'zaytona.ps', 'zenlayer.com', 'zetro.com.ar', 'ziggo.nl', 'zong.com.pk')
GROUP BY 15,
  16,
  17,
  18,
  19
HAVING CAST(CASE WHEN SUM(""自定义 SQL 查询"".""p2s_total"") >= 0 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100 THEN '0-100' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 1000 THEN '100-1000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 1000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 10000 THEN '1000-10000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 10000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100000 THEN '10000-100000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100000 THEN '100000以上' ELSE 'other' END AS VARCHAR) = '100-1000' OR CAST(CASE WHEN SUM(""自定义 SQL 查询"".""p2s_total"") >= 0 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100 THEN '0-100' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 1000 THEN '100-1000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 1000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 10000 THEN '1000-10000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 10000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100000 THEN '10000-100000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100000 THEN '100000以上' ELSE 'other' END AS VARCHAR) = '1000-10000' OR CAST(CASE WHEN SUM(""自定义 SQL 查询"".""p2s_total"") >= 0 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100 THEN '0-100' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 1000 THEN '100-1000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 1000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 10000 THEN '1000-10000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 10000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100000 THEN '10000-100000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100000 THEN '100000以上' ELSE 'other' END AS VARCHAR) = '10000-100000' OR CAST(CASE WHEN SUM(""自定义 SQL 查询"".""p2s_total"") >= 0 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100 THEN '0-100' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 1000 THEN '100-1000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 1000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 10000 THEN '1000-10000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 10000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100000 THEN '10000-100000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100000 THEN '100000以上' ELSE 'other' END AS VARCHAR) = '100000以上'"
"SELECT ""自定义 SQL 查询"".""idc"" AS ""idc"",
  ""自定义 SQL 查询"".""srcCountry"" AS ""srcCountry"",
  ""自定义 SQL 查询"".""srcDomain"" AS ""srcDomain"",
    CASE WHEN SUM(""自定义 SQL 查询"".""p2s_total"") >= 0 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100 THEN '0-100' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 1000 THEN '100-1000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 1000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 10000 THEN '1000-10000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 10000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100000 THEN '10000-100000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100000 THEN '100000以上' ELSE 'other' END AS ""usr_Calculation_5363224211563233284_nk""
FROM (SELECT date AS ""date"",
      src_domain AS ""srcDomain"",
      src_country AS ""srcCountry"",
      dest_idc AS ""idc"",
      delay_25 AS ""p2s_Delay25"",
      delay_50 AS ""p2s_Delay50"",
      delay_75 AS ""p2s_Delay75"",
      delay_100 AS ""p2s_Delay100"",
      delay_125 AS ""p2s_Delay125"",
      delay_150 AS ""p2s_Delay150"",
      delay_total,
      lost_ratio_5 AS ""p2s_lostRatio"",
      lostratio_total AS ""p2s_total"",
      jitter95_50 AS ""p2s_jitter95_50"",
      jitter95_100 AS ""p2s_jitter95_100"",
      jitter95_200 AS ""p2s_jitter95_200"",
      jitter95_300 AS ""p2s_jitter95_300"",
      jitter95_total,
      product_line,
      product_type
    FROM media.p2s_cover_oversea_idc
    WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-25') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-01')) AS ""自定义 SQL 查询""
WHERE CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'aofei-frankfurt1g' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'zhuzhou1g-ctel' AND ""自定义 SQL 查询"".""srcCountry"" NOT IN ('Falkland Islands', 'British Indian Ocean Territory', 'Montserrat', 'North Korea', 'Tuvalu', 'Niue')
GROUP BY 1,
  2,
  3"
"SELECT DATE_ADD('SECOND', 0, date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d')) AS ""tdy_date_ok""
FROM (SELECT date,
        CASE WHEN CAST(stat_period AS VARCHAR) = 'day' THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(substr(CAST(start_date AS VARCHAR), 1, 10) AS VARCHAR), '~', CAST(substr(CAST(end_date AS VARCHAR), 1, 10) AS VARCHAR)) END AS period,
      start_date,
      end_date,
      stat_period,
      tag,
      dim,
      level1,
      level2,
      level3,
      level4,
      '' AS pd,
      os,
      ver,
      ver_type,
      '' AS product_line,
      '' AS product_type,
      domain,
      country,
      region,
      net,
      vid,
      project,
      company_id,
      company_name,
      rowsnum,
      lastusage,
      thisusage,
      fiveSecJoinSuccess,
      totalJoin,
      cnt_sid,
      video_freeze_time,
      video_totaltime,
      audio_freeze_time,
      audio_totaltime,
      s2l_total_delay_sec,
      s2l_25ms_delay_sec,
      s2l_75ms_delay_sec,
      p2s_lost_Leq5,
      p2s_lost_all,
      crash_cnt,
      service_cnt,
      ""1s_succ_join_ap_cnt"",
      ""5s_succ_join_ap_cnt"",
      total_join_ap_cnt,
      totalJoinSuccess,
      threeSecJoinSuccess,
      video_freeze_time_200,
      video_totaltime_200,
      video_freeze_time_500,
      video_totaltime_500,
      ""3s_succ_join_session_cnt_last1"",
      ""5s_succ_join_session_cnt_last1"",
      succ_join_session_cnt_last1,
      total_join_session_cnt_last1,
      total_session_cnt_last1,
      ""1s_succ_join_ap_cnt_last1"",
      ""5s_succ_join_ap_cnt_last1"",
      total_join_ap_cnt_last1,
      ""3s_succ_join_session_cnt_last7"",
      ""5s_succ_join_session_cnt_last7"",
      succ_join_session_cnt_last7,
      total_join_session_cnt_last7,
      total_session_cnt_last7,
      ""1s_succ_join_ap_cnt_last7"",
      ""5s_succ_join_ap_cnt_last7"",
      total_join_ap_cnt_last7,
      video_freeze_time_last1,
      video_totaltime_last1,
      video_freeze_time_500_last1,
      video_totaltime_500_last1,
      video_freeze_time_200_last1,
      video_totaltime_200_last1,
      video_freeze_time_last7,
      video_totaltime_last7,
      video_freeze_time_500_last7,
      video_totaltime_500_last7,
      video_freeze_time_200_last7,
      video_totaltime_200_last7,
      audio_freeze_time_last1,
      audio_totaltime_last1,
      audio_freeze_time_last7,
      audio_totaltime_last7,
      s2l_total_delay_sec_last1,
      s2l_25ms_delay_sec_last1,
      s2l_75ms_delay_sec_last1,
      s2l_total_delay_sec_last7,
      s2l_25ms_delay_sec_last7,
      s2l_75ms_delay_sec_last7,
      p2s_lost_Leq5_last1,
      p2s_lost_all_last1,
      p2s_lost_Leq5_last7,
      p2s_lost_all_last7,
      crash_cnt_last1,
      service_cnt_last1,
      crash_cnt_last7,
      service_cnt_last7,
      product_level1,
      product_level2,
      product_level3,
      product_level4,
      s2l_lost_Leq5,
      s2l_lost_all,
      s2l_lost_Leq5_last1,
      s2l_lost_all_last1,
      s2l_lost_Leq5_last7,
      s2l_lost_all_last7
    FROM report_datahub.pub_levels_quality_di_1
    WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-21') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-11-21')) AS ""自定义 SQL 查询""
GROUP BY 1"
"SELECT SUM(""自定义 SQL 查询"".""s2l_25ms_delay_sec"") AS ""TEMP(Calculation_1430244791154503680)(2227145667)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_total_delay_sec"") AS ""TEMP(Calculation_1430244791154503680)(2460078802)(0)"",
  SUM(""自定义 SQL 查询"".""5s_succ_join_ap_cnt"") AS ""TEMP(Calculation_1430244791247978510)(1716451703)(0)"",
  SUM(""自定义 SQL 查询"".""total_join_ap_cnt"") AS ""TEMP(Calculation_1430244791247978510)(2681092799)(0)"",
  SUM(""自定义 SQL 查询"".""video_freeze_time_500"") AS ""TEMP(Calculation_1857594119395086336)(389023081)(0)"",
  SUM(""自定义 SQL 查询"".""video_totaltime_500"") AS ""TEMP(Calculation_1857594119395086336)(458654145)(0)"",
  SUM(""自定义 SQL 查询"".""video_totaltime_200"") AS ""TEMP(Calculation_2033093767653158912)(2104207895)(0)"",
  SUM(""自定义 SQL 查询"".""video_freeze_time_200"") AS ""TEMP(Calculation_2033093767653158912)(530162565)(0)"",
  SUM(""自定义 SQL 查询"".""totalJoin"") AS ""TEMP(Calculation_374009936508170240)(2073556184)(0)"",
  SUM(""自定义 SQL 查询"".""totalJoinSuccess"") AS ""TEMP(Calculation_374009936508170240)(2807417001)(0)"",
  SUM(""自定义 SQL 查询"".""threeSecJoinSuccess"") AS ""TEMP(Calculation_374009936508321793)(3693645608)(0)"",
  SUM(""自定义 SQL 查询"".""fiveSecJoinSuccess"") AS ""TEMP(Calculation_374009936508416002)(383616769)(0)"",
  SUM(""自定义 SQL 查询"".""video_totaltime"") AS ""TEMP(Calculation_374009936515215363)(2797449586)(0)"",
  SUM(""自定义 SQL 查询"".""video_freeze_time"") AS ""TEMP(Calculation_374009936515215363)(2940759860)(0)"",
  SUM(""自定义 SQL 查询"".""audio_totaltime"") AS ""TEMP(Calculation_374009936517861380)(1652566750)(0)"",
  SUM(""自定义 SQL 查询"".""audio_freeze_time"") AS ""TEMP(Calculation_374009936517861380)(2919389392)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_lost_Leq5"") AS ""TEMP(Calculation_374009936519704581)(1936123547)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_lost_all"") AS ""TEMP(Calculation_374009936519704581)(749826584)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_75ms_delay_sec"") AS ""TEMP(Calculation_6542393318886285312)(2003933318)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_lost_Leq5"") AS ""TEMP(Calculation_7012034266496475136)(2745840127)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_lost_all"") AS ""TEMP(Calculation_7012034266496475136)(734589263)(0)"",
  SUM(""自定义 SQL 查询"".""crash_cnt"") AS ""TEMP(Calculation_7034341207372070925)(2360900687)(0)"",
  SUM(""自定义 SQL 查询"".""service_cnt"") AS ""TEMP(Calculation_7034341207372070925)(4291252132)(0)"",
  DATE_ADD('SECOND', 0, date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d')) AS ""tdy_date_ok""
FROM (SELECT t1.date,
        CASE WHEN CAST(stat_period AS VARCHAR) = 'day' THEN substr(CAST(date_parse(cast( t1.date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(substr(CAST(start_date AS VARCHAR), 1, 10) AS VARCHAR), '~', CAST(substr(CAST(end_date AS VARCHAR), 1, 10) AS VARCHAR)) END AS period,
      start_date,
      end_date,
      stat_period,
      tag,
      t1.dim,
      level1,
      level2,
      level3,
      level4,
      os,
      ver,
      ver_type,
      domain,
      country,
      region,
      net,
      vid,
      project,
      company_id,
      company_name,
      rowsnum,
      lastusage,
      thisusage,
      fiveSecJoinSuccess,
      totalJoin,
      cnt_sid,
      video_freeze_time,
      video_totaltime,
      audio_freeze_time,
      audio_totaltime,
      s2l_total_delay_sec,
      s2l_25ms_delay_sec,
      s2l_75ms_delay_sec,
      p2s_lost_Leq5,
      p2s_lost_all,
      crash_cnt,
      service_cnt,
      ""1s_succ_join_ap_cnt"",
      ""5s_succ_join_ap_cnt"",
      total_join_ap_cnt,
      totalJoinSuccess,
      threeSecJoinSuccess,
      video_freeze_time_200,
      video_totaltime_200,
      video_freeze_time_500,
      video_totaltime_500,
      ""3s_succ_join_session_cnt_last1"",
      ""5s_succ_join_session_cnt_last1"",
      succ_join_session_cnt_last1,
      total_join_session_cnt_last1,
      total_session_cnt_last1,
      ""1s_succ_join_ap_cnt_last1"",
      ""5s_succ_join_ap_cnt_last1"",
      total_join_ap_cnt_last1,
      ""3s_succ_join_session_cnt_last7"",
      ""5s_succ_join_session_cnt_last7"",
      succ_join_session_cnt_last7,
      total_join_session_cnt_last7,
      total_session_cnt_last7,
      ""1s_succ_join_ap_cnt_last7"",
      ""5s_succ_join_ap_cnt_last7"",
      total_join_ap_cnt_last7,
      video_freeze_time_last1,
      video_totaltime_last1,
      video_freeze_time_500_last1,
      video_totaltime_500_last1,
      video_freeze_time_200_last1,
      video_totaltime_200_last1,
      video_freeze_time_last7,
      video_totaltime_last7,
      video_freeze_time_500_last7,
      video_totaltime_500_last7,
      video_freeze_time_200_last7,
      video_totaltime_200_last7,
      audio_freeze_time_last1,
      audio_totaltime_last1,
      audio_freeze_time_last7,
      audio_totaltime_last7,
      s2l_total_delay_sec_last1,
      s2l_25ms_delay_sec_last1,
      s2l_75ms_delay_sec_last1,
      s2l_total_delay_sec_last7,
      s2l_25ms_delay_sec_last7,
      s2l_75ms_delay_sec_last7,
      p2s_lost_Leq5_last1,
      p2s_lost_all_last1,
      p2s_lost_Leq5_last7,
      p2s_lost_all_last7,
      crash_cnt_last1,
      service_cnt_last1,
      crash_cnt_last7,
      service_cnt_last7,
      product_level1,
      product_level2,
      product_level3,
      product_level4,
      s2l_lost_Leq5,
      s2l_lost_all,
      s2l_lost_Leq5_last1,
      s2l_lost_all_last1,
      s2l_lost_Leq5_last7,
      s2l_lost_all_last7,
      fiveSecJoinSuccess_total,
      totalJoin_total,
      cnt_sid_total,
      video_freeze_time_total,
      video_totaltime_total,
      audio_freeze_time_total,
      audio_totaltime_total,
      s2l_total_delay_sec_total,
      s2l_25ms_delay_sec_total,
      s2l_75ms_delay_sec_total,
      p2s_lost_Leq5_total,
      p2s_lost_all_total,
      crash_cnt_total,
      service_cnt_total,
      ""1s_succ_join_ap_cnt_total"",
      ""5s_succ_join_ap_cnt_total"",
      total_join_ap_cnt_total,
      totalJoinSuccess_total,
      threeSecJoinSuccess_total,
      video_freeze_time_200_total,
      video_totaltime_200_total,
      video_freeze_time_500_total,
      video_totaltime_500_total,
      ""3s_succ_join_session_cnt_last1_total"",
      ""5s_succ_join_session_cnt_last1_total"",
      succ_join_session_cnt_last1_total,
      total_join_session_cnt_last1_total,
      total_session_cnt_last1_total,
      ""1s_succ_join_ap_cnt_last1_total"",
      ""5s_succ_join_ap_cnt_last1_total"",
      total_join_ap_cnt_last1_total,
      ""3s_succ_join_session_cnt_last7_total"",
      ""5s_succ_join_session_cnt_last7_total"",
      succ_join_session_cnt_last7_total,
      total_join_session_cnt_last7_total,
      total_session_cnt_last7_total,
      ""1s_succ_join_ap_cnt_last7_total"",
      ""5s_succ_join_ap_cnt_last7_total"",
      total_join_ap_cnt_last7_total,
      video_freeze_time_last1_total,
      video_totaltime_last1_total,
      video_freeze_time_500_last1_total,
      video_totaltime_500_last1_total,
      video_freeze_time_200_last1_total,
      video_totaltime_200_last1_total,
      video_freeze_time_last7_total,
      video_totaltime_last7_total,
      video_freeze_time_500_last7_total,
      video_totaltime_500_last7_total,
      video_freeze_time_200_last7_total,
      video_totaltime_200_last7_total,
      audio_freeze_time_last1_total,
      audio_totaltime_last1_total,
      audio_freeze_time_last7_total,
      audio_totaltime_last7_total,
      s2l_total_delay_sec_last1_total,
      s2l_25ms_delay_sec_last1_total,
      s2l_75ms_delay_sec_last1_total,
      s2l_total_delay_sec_last7_total,
      s2l_25ms_delay_sec_last7_total,
      s2l_75ms_delay_sec_last7_total,
      p2s_lost_Leq5_last1_total,
      p2s_lost_all_last1_total,
      p2s_lost_Leq5_last7_total,
      p2s_lost_all_last7_total,
      crash_cnt_last1_total,
      service_cnt_last1_total,
      crash_cnt_last7_total,
      service_cnt_last7_total,
      s2l_lost_Leq5_total,
      s2l_lost_all_total,
      s2l_lost_Leq5_last1_total,
      s2l_lost_all_last1_total,
      s2l_lost_Leq5_last7_total,
      s2l_lost_all_last7_total
    FROM report_datahub.pub_levels_quality_di_1 AS t1
      LEFT JOIN (SELECT date,
          dim,
          SUM(fiveSecJoinSuccess) AS fiveSecJoinSuccess_total,
          SUM(totalJoin) AS totalJoin_total,
          SUM(cnt_sid) AS cnt_sid_total,
          SUM(video_freeze_time) AS video_freeze_time_total,
          SUM(video_totaltime) AS video_totaltime_total,
          SUM(audio_freeze_time) AS audio_freeze_time_total,
          SUM(audio_totaltime) AS audio_totaltime_total,
          SUM(s2l_total_delay_sec) AS s2l_total_delay_sec_total,
          SUM(s2l_25ms_delay_sec) AS s2l_25ms_delay_sec_total,
          SUM(s2l_75ms_delay_sec) AS s2l_75ms_delay_sec_total,
          SUM(p2s_lost_Leq5) AS p2s_lost_Leq5_total,
          SUM(p2s_lost_all) AS p2s_lost_all_total,
          SUM(crash_cnt) AS crash_cnt_total,
          SUM(service_cnt) AS service_cnt_total,
          SUM(""1s_succ_join_ap_cnt"") AS ""1s_succ_join_ap_cnt_total"",
          SUM(""5s_succ_join_ap_cnt"") AS ""5s_succ_join_ap_cnt_total"",
          SUM(total_join_ap_cnt) AS total_join_ap_cnt_total,
          SUM(totalJoinSuccess) AS totalJoinSuccess_total,
          SUM(threeSecJoinSuccess) AS threeSecJoinSuccess_total,
          SUM(video_freeze_time_200) AS video_freeze_time_200_total,
          SUM(video_totaltime_200) AS video_totaltime_200_total,
          SUM(video_freeze_time_500) AS video_freeze_time_500_total,
          SUM(video_totaltime_500) AS video_totaltime_500_total,
          SUM(""3s_succ_join_session_cnt_last1"") AS ""3s_succ_join_session_cnt_last1_total"",
          SUM(""5s_succ_join_session_cnt_last1"") AS ""5s_succ_join_session_cnt_last1_total"",
          SUM(succ_join_session_cnt_last1) AS succ_join_session_cnt_last1_total,
          SUM(total_join_session_cnt_last1) AS total_join_session_cnt_last1_total,
          SUM(total_session_cnt_last1) AS total_session_cnt_last1_total,
          SUM(""1s_succ_join_ap_cnt_last1"") AS ""1s_succ_join_ap_cnt_last1_total"",
          SUM(""5s_succ_join_ap_cnt_last1"") AS ""5s_succ_join_ap_cnt_last1_total"",
          SUM(total_join_ap_cnt_last1) AS total_join_ap_cnt_last1_total,
          SUM(""3s_succ_join_session_cnt_last7"") AS ""3s_succ_join_session_cnt_last7_total"",
          SUM(""5s_succ_join_session_cnt_last7"") AS ""5s_succ_join_session_cnt_last7_total"",
          SUM(succ_join_session_cnt_last7) AS succ_join_session_cnt_last7_total,
          SUM(total_join_session_cnt_last7) AS total_join_session_cnt_last7_total,
          SUM(total_session_cnt_last7) AS total_session_cnt_last7_total,
          SUM(""1s_succ_join_ap_cnt_last7"") AS ""1s_succ_join_ap_cnt_last7_total"",
          SUM(""5s_succ_join_ap_cnt_last7"") AS ""5s_succ_join_ap_cnt_last7_total"",
          SUM(total_join_ap_cnt_last7) AS total_join_ap_cnt_last7_total,
          SUM(video_freeze_time_last1) AS video_freeze_time_last1_total,
          SUM(video_totaltime_last1) AS video_totaltime_last1_total,
          SUM(video_freeze_time_500_last1) AS video_freeze_time_500_last1_total,
          SUM(video_totaltime_500_last1) AS video_totaltime_500_last1_total,
          SUM(video_freeze_time_200_last1) AS video_freeze_time_200_last1_total,
          SUM(video_totaltime_200_last1) AS video_totaltime_200_last1_total,
          SUM(video_freeze_time_last7) AS video_freeze_time_last7_total,
          SUM(video_totaltime_last7) AS video_totaltime_last7_total,
          SUM(video_freeze_time_500_last7) AS video_freeze_time_500_last7_total,
          SUM(video_totaltime_500_last7) AS video_totaltime_500_last7_total,
          SUM(video_freeze_time_200_last7) AS video_freeze_time_200_last7_total,
          SUM(video_totaltime_200_last7) AS video_totaltime_200_last7_total,
          SUM(audio_freeze_time_last1) AS audio_freeze_time_last1_total,
          SUM(audio_totaltime_last1) AS audio_totaltime_last1_total,
          SUM(audio_freeze_time_last7) AS audio_freeze_time_last7_total,
          SUM(audio_totaltime_last7) AS audio_totaltime_last7_total,
          SUM(s2l_total_delay_sec_last1) AS s2l_total_delay_sec_last1_total,
          SUM(s2l_25ms_delay_sec_last1) AS s2l_25ms_delay_sec_last1_total,
          SUM(s2l_75ms_delay_sec_last1) AS s2l_75ms_delay_sec_last1_total,
          SUM(s2l_total_delay_sec_last7) AS s2l_total_delay_sec_last7_total,
          SUM(s2l_25ms_delay_sec_last7) AS s2l_25ms_delay_sec_last7_total,
          SUM(s2l_75ms_delay_sec_last7) AS s2l_75ms_delay_sec_last7_total,
          SUM(p2s_lost_Leq5_last1) AS p2s_lost_Leq5_last1_total,
          SUM(p2s_lost_all_last1) AS p2s_lost_all_last1_total,
          SUM(p2s_lost_Leq5_last7) AS p2s_lost_Leq5_last7_total,
          SUM(p2s_lost_all_last7) AS p2s_lost_all_last7_total,
          SUM(crash_cnt_last1) AS crash_cnt_last1_total,
          SUM(service_cnt_last1) AS service_cnt_last1_total,
          SUM(crash_cnt_last7) AS crash_cnt_last7_total,
          SUM(service_cnt_last7) AS service_cnt_last7_total,
          SUM(s2l_lost_Leq5) AS s2l_lost_Leq5_total,
          SUM(s2l_lost_all) AS s2l_lost_all_total,
          SUM(s2l_lost_Leq5_last1) AS s2l_lost_Leq5_last1_total,
          SUM(s2l_lost_all_last1) AS s2l_lost_all_last1_total,
          SUM(s2l_lost_Leq5_last7) AS s2l_lost_Leq5_last7_total,
          SUM(s2l_lost_all_last7) AS s2l_lost_all_last7_total
        FROM report_datahub.pub_levels_quality_di_1
        WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-21') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-11-21') AND CAST(tag AS VARCHAR) = 'Product'
        GROUP BY date,
          dim) AS t2 ON t1.date = t2.date AND t1.dim = t2.dim
    WHERE date_parse(cast( t1.date as VARCHAR), '%Y%m%d') >= DATE('2021-11-21') AND date_parse(cast( t1.date as VARCHAR), '%Y%m%d') <= DATE('2021-11-21') AND CAST(tag AS VARCHAR) = 'Product') AS ""自定义 SQL 查询""
WHERE CASE WHEN CAST(""自定义 SQL 查询"".""tag"" AS VARCHAR) = 'Industry' AND CAST(""自定义 SQL 查询"".""product_level1"" AS VARCHAR) = 'RTC' AND CAST(""自定义 SQL 查询"".""dim"" AS VARCHAR) = 'osver' THEN 0 WHEN CAST(""自定义 SQL 查询"".""tag"" AS VARCHAR) = 'VerType' AND CAST(""自定义 SQL 查询"".""product_level1"" AS VARCHAR) = 'RTC' AND CAST(""自定义 SQL 查询"".""dim"" AS VARCHAR) = 'osver' THEN 0 WHEN CAST(""自定义 SQL 查询"".""tag"" AS VARCHAR) = 'Product' AND CAST(""自定义 SQL 查询"".""dim"" AS VARCHAR) = 'osver' AND CAST(""自定义 SQL 查询"".""product_level1"" AS VARCHAR) = 'RTC' THEN 1 ELSE 0 END AND CAST(""自定义 SQL 查询"".""level2"" AS VARCHAR) = 'Native'
GROUP BY 24"
"SELECT SUM(""自定义 SQL 查询"".""host_4k"") AS ""TEMP(Calculation_3519281700079370244)(1075454865)(0)"",
  SUM(""自定义 SQL 查询"".""audience_sd"") AS ""TEMP(Calculation_3519281700079370244)(1133678835)(0)"",
  SUM(""自定义 SQL 查询"".""host_1080p"") AS ""TEMP(Calculation_3519281700079370244)(1312501967)(0)"",
  SUM(""自定义 SQL 查询"".""host_hd"") AS ""TEMP(Calculation_3519281700079370244)(276907208)(0)"",
  SUM(""自定义 SQL 查询"".""video"") AS ""TEMP(Calculation_3519281700079370244)(2929708110)(0)"",
  SUM(""自定义 SQL 查询"".""audience_hd"") AS ""TEMP(Calculation_3519281700079370244)(2930728935)(0)"",
  SUM(""自定义 SQL 查询"".""audience_hdp"") AS ""TEMP(Calculation_3519281700079370244)(3010533957)(0)"",
  SUM(""自定义 SQL 查询"".""host_hdp"") AS ""TEMP(Calculation_3519281700079370244)(30306054)(0)"",
  SUM(""自定义 SQL 查询"".""host_audio"") AS ""TEMP(Calculation_3519281700079370244)(3087054365)(0)"",
  SUM(""自定义 SQL 查询"".""audio"") AS ""TEMP(Calculation_3519281700079370244)(3299350010)(0)"",
  SUM(""自定义 SQL 查询"".""audience_1080p"") AS ""TEMP(Calculation_3519281700079370244)(3628946582)(0)"",
  SUM(""自定义 SQL 查询"".""totalUsage"") AS ""TEMP(Calculation_3519281700079370244)(3847882359)(0)"",
  SUM(""自定义 SQL 查询"".""audience_audio"") AS ""TEMP(Calculation_3519281700079370244)(4109514392)(0)"",
  SUM(""自定义 SQL 查询"".""host_2k"") AS ""TEMP(Calculation_3519281700079370244)(586790827)(0)"",
  SUM(""自定义 SQL 查询"".""host_sd"") AS ""TEMP(Calculation_3519281700079370244)(709512178)(0)"",
  SUM(""自定义 SQL 查询"".""audience_4k"") AS ""TEMP(Calculation_3519281700079370244)(764410224)(0)"",
  SUM(""自定义 SQL 查询"".""audience_2k"") AS ""TEMP(Calculation_3519281700079370244)(943764407)(0)"",
  SUM(""自定义 SQL 查询"".""host_4k_last"") AS ""TEMP(Calculation_3519281700083154949)(101123376)(0)"",
  SUM(""自定义 SQL 查询"".""audience_video_hdp_last"") AS ""TEMP(Calculation_3519281700083154949)(1200517625)(0)"",
  SUM(""自定义 SQL 查询"".""audience_1080p_last"") AS ""TEMP(Calculation_3519281700083154949)(1314346200)(0)"",
  SUM(""自定义 SQL 查询"".""audience_video_hd_last"") AS ""TEMP(Calculation_3519281700083154949)(146570423)(0)"",
  SUM(""自定义 SQL 查询"".""audience_2k_last"") AS ""TEMP(Calculation_3519281700083154949)(1717771635)(0)"",
  SUM(""自定义 SQL 查询"".""audience_audio_last"") AS ""TEMP(Calculation_3519281700083154949)(2313111073)(0)"",
  SUM(""自定义 SQL 查询"".""host_video_hdp_last"") AS ""TEMP(Calculation_3519281700083154949)(258310559)(0)"",
  SUM(""自定义 SQL 查询"".""audio_video_last"") AS ""TEMP(Calculation_3519281700083154949)(2820618408)(0)"",
  SUM(""自定义 SQL 查询"".""audience_4k_last"") AS ""TEMP(Calculation_3519281700083154949)(3121859593)(0)"",
  SUM(""自定义 SQL 查询"".""host_1080p_last"") AS ""TEMP(Calculation_3519281700083154949)(3222422303)(0)"",
  SUM(""自定义 SQL 查询"".""host_audio_last"") AS ""TEMP(Calculation_3519281700083154949)(3227677803)(0)"",
  SUM(""自定义 SQL 查询"".""video_last"") AS ""TEMP(Calculation_3519281700083154949)(3934387163)(0)"",
  SUM(""自定义 SQL 查询"".""host_2k_last"") AS ""TEMP(Calculation_3519281700083154949)(4055292783)(0)"",
  SUM(""自定义 SQL 查询"".""audio_last"") AS ""TEMP(Calculation_3519281700083154949)(4091190060)(0)"",
  SUM(""自定义 SQL 查询"".""host_video_hd_last"") AS ""TEMP(Calculation_3519281700083154949)(4170367250)(0)"",
  SUM(""自定义 SQL 查询"".""host_video_sd_last"") AS ""TEMP(Calculation_3519281700083154949)(4190307025)(0)"",
  SUM(""自定义 SQL 查询"".""audience_video_sd_last"") AS ""TEMP(Calculation_3519281700083154949)(933007102)(0)"",
  MAX(""自定义 SQL 查询"".""stat_date"") AS ""TEMP(attr_stat_date_nk)(2102638629)(0)"",
  MIN(""自定义 SQL 查询"".""stat_date"") AS ""TEMP(attr_stat_date_nk)(2790680713)(0)"",
  ""自定义 SQL 查询"".""level1"" AS ""level1"",
  SUM(""自定义 SQL 查询"".""totalUsage"") AS ""sum_totalUsage_ok"",
  DATE_ADD('SECOND', 0, date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d')) AS ""tdy_date_ok""
FROM (SELECT date,
        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,
      start_date AS start_date_7,
      end_date AS end_date,
      tag,
      area AS Scope,
      dim,
        CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,
      level2,
      level3,
      level4,
      product_level1 AS product_line,
      product_level2,
      product_level3,
      product_level4,
      vid_internal_industry_en AS cid_industry,
      vid_use_case_en AS vid_use_case_cn,
      vid_sector_en,
      ver_type,
      ver,
      os,
      domain,
      country,
      region,
      dim_grouping_name,
        CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,
      total AS totalUsage,
      audio,
      video,
      host_audio,
      audience_audio,
      host_sd,
      host_hd,
      host_hdp,
      host_1080p,
      host_2k,
      host_4k,
      audience_sd,
      audience_hd,
      audience_hdp,
      audience_1080p,
      audience_2k,
      audience_4k,
      audience_audio_low_latency,
      audience_sd_low_latency,
      audience_hd_low_latency,
      audience_hdp_low_latency,
      audience_1080p_low_latency,
      audience_2k_low_latency,
      audience_4k_low_latency,
      audience_audio_ultra_low_latency,
      audience_sd_ultra_low_latency,
      audience_hd_ultra_low_latency,
      audience_hdp_ultra_low_latency,
      audience_1080p_ultra_low_latency,
      audience_2k_ultra_low_latency,
      audience_4k_ultra_low_latency,
      total_last1 AS audio_video_last,
      audio_last1 AS audio_last,
      video_last1 AS video_last,
      video_sd_last1 AS video_sd_last,
      video_hd_last1 AS video_hd_last,
      video_hdp_last1 AS video_hdp_last,
      host_sd_last1 AS host_video_sd_last,
      audience_sd_last1 AS audience_video_sd_last,
      host_hd_last1 AS host_video_hd_last,
      audience_hd_last1 AS audience_video_hd_last,
      host_hdp_last1 AS host_video_hdp_last,
      audience_hdp_last1 AS audience_video_hdp_last,
      host_audio_last1 AS host_audio_last,
      audience_audio_last1 AS audience_audio_last,
      host_video_last1 AS host_video_last,
      audience_video_last1 AS audience_video_last,
      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,
      audience_video_low_latency_last1 AS audience_video_low_latency_last,
      audience_total_low_latency_last1 AS audience_total_low_latency_last,
      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,
      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,
      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,
      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,
      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,
      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,
      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,
      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,
      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,
      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,
      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,
      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,
      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,
      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,
      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,
      audience_2k_last1 AS audience_2k_last,
      audience_4k_last1 AS audience_4k_last,
      audience_1080p_last1 AS audience_1080p_last,
      host_1080p_last1 AS host_1080p_last,
      host_2k_last1 AS host_2k_last,
      host_4k_last1 AS host_4k_last,
      total_last7,
      audio_last7,
      video_last7,
      video_sd_last7,
      video_hd_last7,
      video_hdp_last7,
      host_sd_last7,
      audience_sd_last7,
      host_hd_last7,
      audience_hd_last7,
      host_hdp_last7,
      audience_hdp_last7,
      host_audio_last7,
      audience_audio_last7,
      host_video_last7,
      audience_video_last7,
      audience_audio_low_latency_last7,
      audience_video_low_latency_last7,
      audience_total_low_latency_last7,
      audience_sd_low_latency_last7,
      audience_hd_low_latency_last7,
      audience_hdp_low_latency_last7,
      audience_1080p_low_latency_last7,
      audience_2k_low_latency_last7,
      audience_4k_low_latency_last7,
      audience_audio_ultra_low_latency_last7,
      audience_video_ultra_low_latency_last7,
      audience_total_ultra_low_latency_last7,
      audience_sd_ultra_low_latency_last7,
      audience_hd_ultra_low_latency_last7,
      audience_hdp_ultra_low_latency_last7,
      audience_1080p_ultra_low_latency_last7,
      audience_2k_ultra_low_latency_last7,
      audience_4k_ultra_low_latency_last7,
      audience_2k_last7,
      audience_4k_last7,
      audience_1080p_last7,
      host_1080p_last7,
      host_2k_last7,
      host_4k_last7
    FROM levels_usage_dod_di_1
    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-06') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-04') AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS ""自定义 SQL 查询""
WHERE ""自定义 SQL 查询"".""dim"" = 1 AND ""自定义 SQL 查询"".""rank_level1"" = 8
GROUP BY 37,
  39"
"SELECT ""自定义 SQL 查询"".""idc"" AS ""idc"",
  ""自定义 SQL 查询"".""srcCountry"" AS ""srcCountry"",
  ""自定义 SQL 查询"".""srcDomain"" AS ""srcDomain"",
    CASE WHEN SUM(""自定义 SQL 查询"".""p2s_total"") >= 0 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100 THEN '0-100' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 1000 THEN '100-1000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 1000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 10000 THEN '1000-10000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 10000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100000 THEN '10000-100000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100000 THEN '100000以上' ELSE 'other' END AS ""usr_Calculation_5363224211563233284_nk""
FROM (SELECT date AS ""date"",
      src_domain AS ""srcDomain"",
      src_country AS ""srcCountry"",
      dest_idc AS ""idc"",
      delay_25 AS ""p2s_Delay25"",
      delay_50 AS ""p2s_Delay50"",
      delay_75 AS ""p2s_Delay75"",
      delay_100 AS ""p2s_Delay100"",
      delay_125 AS ""p2s_Delay125"",
      delay_150 AS ""p2s_Delay150"",
      delay_total,
      lost_ratio_5 AS ""p2s_lostRatio"",
      lostratio_total AS ""p2s_total"",
      jitter95_50 AS ""p2s_jitter95_50"",
      jitter95_100 AS ""p2s_jitter95_100"",
      jitter95_200 AS ""p2s_jitter95_200"",
      jitter95_300 AS ""p2s_jitter95_300"",
      jitter95_total,
      product_line,
      product_type
    FROM media.p2s_cover_oversea_idc
    WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-25') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-01')) AS ""自定义 SQL 查询""
GROUP BY 1,
  2,
  3"
"SELECT SUM(""自定义 SQL 查询"".""audience_low_latency_last1"") AS ""TEMP(Calculation_230316907702542336)(2007846651)(0)"",
  SUM(""自定义 SQL 查询"".""audience_low_latency"") AS ""TEMP(Calculation_230316907702542336)(2627877912)(0)"",
  SUM(""自定义 SQL 查询"".""total"") AS ""TEMP(Calculation_5203557528859017219)(2253843611)(0)"",
  SUM(""自定义 SQL 查询"".""total_last1"") AS ""TEMP(Calculation_5203557528859017219)(3076278274)(0)"",
  SUM(""自定义 SQL 查询"".""audio_last1"") AS ""TEMP(Calculation_5203557528863870981)(2207581090)(0)"",
  SUM(""自定义 SQL 查询"".""audio"") AS ""TEMP(Calculation_5203557528863870981)(4234702922)(0)"",
  SUM(""自定义 SQL 查询"".""video_last1"") AS ""TEMP(Calculation_5203557528864096263)(1192334319)(0)"",
  SUM(""自定义 SQL 查询"".""video"") AS ""TEMP(Calculation_5203557528864096263)(3647352276)(0)"",
  SUM(""自定义 SQL 查询"".""audience"") AS ""TEMP(Calculation_534802460955746306)(1306364424)(0)"",
  SUM(""自定义 SQL 查询"".""audience_last1"") AS ""TEMP(Calculation_534802460955746306)(2505681848)(0)"",
  SUM(""自定义 SQL 查询"".""audience_audio"") AS ""TEMP(Calculation_534802460956037124)(1868547182)(0)"",
  SUM(""自定义 SQL 查询"".""audience_audio_last1"") AS ""TEMP(Calculation_534802460956037124)(2218970377)(0)"",
  SUM(""自定义 SQL 查询"".""audience_video_last1"") AS ""TEMP(Calculation_534802460956319750)(188915252)(0)"",
  SUM(""自定义 SQL 查询"".""audience_video"") AS ""TEMP(Calculation_534802460956319750)(2182583436)(0)"",
  MAX(""自定义 SQL 查询"".""stat_date"") AS ""TEMP(attr_stat_date_nk)(2102638629)(0)"",
  MIN(""自定义 SQL 查询"".""stat_date"") AS ""TEMP(attr_stat_date_nk)(2790680713)(0)"",
  SUM(""自定义 SQL 查询"".""audience_audio_low_latency_last1"") AS ""TEMP(audience_audio_last1_rate (复制)_230316907704033282)(67"",
  SUM(""自定义 SQL 查询"".""audience_audio_low_latency"") AS ""TEMP(audience_audio_last1_rate (复制)_230316907704033282)(83"",
  SUM(""自定义 SQL 查询"".""host_audio_last1"") AS ""TEMP(audience_audio_last1_rate (复制)_534802460956618761)(24"",
  SUM(""自定义 SQL 查询"".""host_audio"") AS ""TEMP(audience_audio_last1_rate (复制)_534802460956618761)(36"",
  SUM(""自定义 SQL 查询"".""host_last1"") AS ""TEMP(audience_last1_rate (复制)_534802460956647435)(15035501"",
  SUM(""自定义 SQL 查询"".""host"") AS ""TEMP(audience_last1_rate (复制)_534802460956647435)(24867219"",
  SUM(""自定义 SQL 查询"".""audience_video_low_latency_last1"") AS ""TEMP(audience_low_latency_last1_rate (复制)_2303169077218304"",
  SUM(""自定义 SQL 查询"".""audience_video_low_latency"") AS ""TEMP(audience_low_latency_last1_rate (复制)_2303169077218301"",
  SUM(""自定义 SQL 查询"".""host_video"") AS ""TEMP(audience_video_last1_rate (复制)_534802460956696589)(26"",
  SUM(""自定义 SQL 查询"".""host_video_last1"") AS ""TEMP(audience_video_last1_rate (复制)_534802460956696589)(42"",
  SUM(""自定义 SQL 查询"".""audience_video_low_latency"") AS ""sum_audience_video_low_latency_ok""
FROM (SELECT date,
      SUBSTR(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) AS date_range_1,
      SUBSTR(CAST(end_date AS VARCHAR), 1, 10) AS date_range_2,
      stat_period,
        CASE WHEN CAST(stat_period AS VARCHAR) = 'day' THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,
      area,
      vid,
      project,
      company_id AS cid,
      company_name AS company,
      customer_level AS level,
      vid_internal_industry_en AS industry,
      vid_use_case_cn,
      csdc_owner,
      os,
      ver,
      ver_type,
      product_level1,
      product_level2,
      product_level3,
      total,
      audio,
      video,
      video_sd,
      video_hd,
      video_hdp,
        host_audio + host_video AS host,
      host_audio,
      host_video,
      host_sd,
      host_hd,
      host_hdp,
        audience_audio + audience_video AS audience,
        audience_audio_low_latency + audience_video_low_latency AS audience_low_latency,
      audience_audio,
      audience_audio_low_latency,
      audience_video,
      audience_video_low_latency,
      audience_sd,
      audience_sd_low_latency,
      audience_hd,
      audience_hd_low_latency,
      audience_hdp,
      audience_hdp_low_latency,
      total_last1,
      audio_last1,
      video_last1,
      video_sd_last1,
      video_hd_last1,
      video_hdp_last1,
        host_audio_last1 + host_video_last1 AS host_last1,
      host_audio_last1,
      host_video_last1,
        audience_audio_last1 + audience_video_last1 AS audience_last1,
        audience_audio_low_latency_last1 + audience_video_low_latency_last1 AS audience_low_latency_last1,
      audience_audio_last1,
      audience_audio_low_latency_last1,
      audience_video_last1,
      audience_video_low_latency_last1,
      total_last7,
      audio_last7,
      video_last7,
      video_sd_last7,
      video_hd_last7,
      video_hdp_last7,
        host_audio_last7 + host_video_last7 AS host_last7,
      host_audio_last7,
      host_video_last7,
        audience_audio_last7 + audience_video_last7 AS audience_last7,
        audience_audio_low_latency_last7 + audience_video_low_latency_last7 AS audience_low_latency_last7,
      audience_audio_last7,
      audience_audio_low_latency_last7,
      audience_video_last7,
      audience_video_low_latency_last7
    FROM report_datahub.vendor_vid_usage_di_1
    WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-06') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-06') AND CAST(vid AS VARCHAR) = CAST(311291 AS VARCHAR) AND dim = 1) AS ""自定义 SQL 查询""
  CROSS JOIN (SELECT MAX(date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d')) AS ""__measure__0""
    FROM (SELECT date,
          SUBSTR(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) AS date_range_1,
          SUBSTR(CAST(end_date AS VARCHAR), 1, 10) AS date_range_2,
          stat_period,
            CASE WHEN CAST(stat_period AS VARCHAR) = 'day' THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,
          area,
          vid,
          project,
          company_id AS cid,
          company_name AS company,
          customer_level AS level,
          vid_internal_industry_en AS industry,
          vid_use_case_cn,
          csdc_owner,
          os,
          ver,
          ver_type,
          product_level1,
          product_level2,
          product_level3,
          total,
          audio,
          video,
          video_sd,
          video_hd,
          video_hdp,
            host_audio + host_video AS host,
          host_audio,
          host_video,
          host_sd,
          host_hd,
          host_hdp,
            audience_audio + audience_video AS audience,
            audience_audio_low_latency + audience_video_low_latency AS audience_low_latency,
          audience_audio,
          audience_audio_low_latency,
          audience_video,
          audience_video_low_latency,
          audience_sd,
          audience_sd_low_latency,
          audience_hd,
          audience_hd_low_latency,
          audience_hdp,
          audience_hdp_low_latency,
          total_last1,
          audio_last1,
          video_last1,
          video_sd_last1,
          video_hd_last1,
          video_hdp_last1,
            host_audio_last1 + host_video_last1 AS host_last1,
          host_audio_last1,
          host_video_last1,
            audience_audio_last1 + audience_video_last1 AS audience_last1,
            audience_audio_low_latency_last1 + audience_video_low_latency_last1 AS audience_low_latency_last1,
          audience_audio_last1,
          audience_audio_low_latency_last1,
          audience_video_last1,
          audience_video_low_latency_last1,
          total_last7,
          audio_last7,
          video_last7,
          video_sd_last7,
          video_hd_last7,
          video_hdp_last7,
            host_audio_last7 + host_video_last7 AS host_last7,
          host_audio_last7,
          host_video_last7,
            audience_audio_last7 + audience_video_last7 AS audience_last7,
            audience_audio_low_latency_last7 + audience_video_low_latency_last7 AS audience_low_latency_last7,
          audience_audio_last7,
          audience_audio_low_latency_last7,
          audience_video_last7,
          audience_video_low_latency_last7
        FROM report_datahub.vendor_vid_usage_di_1
        WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-06') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-06') AND CAST(vid AS VARCHAR) = CAST(311291 AS VARCHAR) AND dim = 1) AS ""自定义 SQL 查询""
    HAVING COUNT(1) > 0) AS ""t0""
WHERE date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d') = ""t0"".""__measure__0""
HAVING COUNT(1) > 0"
"SELECT SUM(""自定义 SQL 查询"".""s2l_25ms_delay_sec"") AS ""TEMP(Calculation_1430244791154503680)(2227145667)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_total_delay_sec"") AS ""TEMP(Calculation_1430244791154503680)(2460078802)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_total_delay_sec_last1"") AS ""TEMP(Calculation_1430244791161831425)(1533897333)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_25ms_delay_sec_last1"") AS ""TEMP(Calculation_1430244791161831425)(3105382701)(0)"",
  SUM(""自定义 SQL 查询"".""5s_succ_join_ap_cnt"") AS ""TEMP(Calculation_1430244791247978510)(1716451703)(0)"",
  SUM(""自定义 SQL 查询"".""total_join_ap_cnt"") AS ""TEMP(Calculation_1430244791247978510)(2681092799)(0)"",
  SUM(""自定义 SQL 查询"".""5s_succ_join_ap_cnt_last1"") AS ""TEMP(Calculation_1430244791248527375)(865560869)(0)"",
  SUM(""自定义 SQL 查询"".""total_join_ap_cnt_last1"") AS ""TEMP(Calculation_1430244791248527375)(97423155)(0)"",
  SUM(""自定义 SQL 查询"".""video_freeze_time_500"") AS ""TEMP(Calculation_1857594119395086336)(389023081)(0)"",
  SUM(""自定义 SQL 查询"".""video_totaltime_500"") AS ""TEMP(Calculation_1857594119395086336)(458654145)(0)"",
  SUM(""自定义 SQL 查询"".""video_totaltime_500_last1"") AS ""TEMP(Calculation_1857594119395348481)(3425883446)(0)"",
  SUM(""自定义 SQL 查询"".""video_freeze_time_500_last1"") AS ""TEMP(Calculation_1857594119395348481)(3450234468)(0)"",
  SUM(""自定义 SQL 查询"".""video_totaltime_200"") AS ""TEMP(Calculation_2033093767653158912)(2104207895)(0)"",
  SUM(""自定义 SQL 查询"".""video_freeze_time_200"") AS ""TEMP(Calculation_2033093767653158912)(530162565)(0)"",
  SUM(""自定义 SQL 查询"".""video_totaltime_200_last1"") AS ""TEMP(Calculation_2033093767653347329)(1909093697)(0)"",
  SUM(""自定义 SQL 查询"".""video_freeze_time_200_last1"") AS ""TEMP(Calculation_2033093767653347329)(2193258393)(0)"",
  SUM(""自定义 SQL 查询"".""totalJoin"") AS ""TEMP(Calculation_374009936508170240)(2073556184)(0)"",
  SUM(""自定义 SQL 查询"".""totalJoinSuccess"") AS ""TEMP(Calculation_374009936508170240)(2807417001)(0)"",
  SUM(""自定义 SQL 查询"".""threeSecJoinSuccess"") AS ""TEMP(Calculation_374009936508321793)(3693645608)(0)"",
  SUM(""自定义 SQL 查询"".""fiveSecJoinSuccess"") AS ""TEMP(Calculation_374009936508416002)(383616769)(0)"",
  SUM(""自定义 SQL 查询"".""video_totaltime"") AS ""TEMP(Calculation_374009936515215363)(2797449586)(0)"",
  SUM(""自定义 SQL 查询"".""video_freeze_time"") AS ""TEMP(Calculation_374009936515215363)(2940759860)(0)"",
  SUM(""自定义 SQL 查询"".""audio_totaltime"") AS ""TEMP(Calculation_374009936517861380)(1652566750)(0)"",
  SUM(""自定义 SQL 查询"".""audio_freeze_time"") AS ""TEMP(Calculation_374009936517861380)(2919389392)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_lost_Leq5"") AS ""TEMP(Calculation_374009936519704581)(1936123547)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_lost_all"") AS ""TEMP(Calculation_374009936519704581)(749826584)(0)"",
  SUM(""自定义 SQL 查询"".""total_join_session_cnt_last1"") AS ""TEMP(Calculation_374009936523853831)(2708102775)(0)"",
  SUM(""自定义 SQL 查询"".""succ_join_session_cnt_last1"") AS ""TEMP(Calculation_374009936523853831)(929207889)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_75ms_delay_sec"") AS ""TEMP(Calculation_6542393318886285312)(2003933318)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_total_delay_sec_last1"") AS ""TEMP(Calculation_6542393318886735875)(3088956105)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_75ms_delay_sec_last1"") AS ""TEMP(Calculation_6542393318886735875)(602483182)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_lost_Leq5"") AS ""TEMP(Calculation_7012034266496475136)(2745840127)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_lost_all"") AS ""TEMP(Calculation_7012034266496475136)(734589263)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_lost_all_last1"") AS ""TEMP(Calculation_7012034266496618497)(3348338895)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_lost_Leq5_last1"") AS ""TEMP(Calculation_7012034266496618497)(700826822)(0)"",
  SUM(""自定义 SQL 查询"".""3s_succ_join_session_cnt_last1"") AS ""TEMP(Calculation_7034341207020355584)(2445597373)(0)"",
  SUM(""自定义 SQL 查询"".""5s_succ_join_session_cnt_last1"") AS ""TEMP(Calculation_7034341207023706114)(2534022291)(0)"",
  SUM(""自定义 SQL 查询"".""video_totaltime_last1"") AS ""TEMP(Calculation_7034341207025315846)(1221500367)(0)"",
  SUM(""自定义 SQL 查询"".""video_freeze_time_last1"") AS ""TEMP(Calculation_7034341207025315846)(3506758486)(0)"",
  SUM(""自定义 SQL 查询"".""audio_totaltime_last1"") AS ""TEMP(Calculation_7034341207025774600)(803828507)(0)"",
  SUM(""自定义 SQL 查询"".""audio_freeze_time_last1"") AS ""TEMP(Calculation_7034341207025774600)(877259553)(0)"",
  SUM(""自定义 SQL 查询"".""crash_cnt"") AS ""TEMP(Calculation_7034341207372070925)(2360900687)(0)"",
  SUM(""自定义 SQL 查询"".""service_cnt"") AS ""TEMP(Calculation_7034341207372070925)(4291252132)(0)"",
  SUM(""自定义 SQL 查询"".""service_cnt_last1"") AS ""TEMP(Calculation_7034341207372197902)(2436060403)(0)"",
  SUM(""自定义 SQL 查询"".""crash_cnt_last1"") AS ""TEMP(Calculation_7034341207372197902)(651130603)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_lost_all_last1"") AS ""TEMP(Calculation_75998310509129730)(1975694301)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_lost_Leq5_last1"") AS ""TEMP(Calculation_75998310509129730)(1982054307)(0)""
FROM (SELECT t1.date,
        CASE WHEN CAST(stat_period AS VARCHAR) = 'day' THEN substr(CAST(date_parse(cast( t1.date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(substr(CAST(start_date AS VARCHAR), 1, 10) AS VARCHAR), '~', CAST(substr(CAST(end_date AS VARCHAR), 1, 10) AS VARCHAR)) END AS period,
      start_date,
      end_date,
      stat_period,
      tag,
      t1.dim,
      level1,
      level2,
      level3,
      level4,
      os,
      ver,
      ver_type,
      domain,
      country,
      region,
      net,
      vid,
      project,
      company_id,
      company_name,
      rowsnum,
      lastusage,
      thisusage,
      fiveSecJoinSuccess,
      totalJoin,
      cnt_sid,
      video_freeze_time,
      video_totaltime,
      audio_freeze_time,
      audio_totaltime,
      s2l_total_delay_sec,
      s2l_25ms_delay_sec,
      s2l_75ms_delay_sec,
      p2s_lost_Leq5,
      p2s_lost_all,
      crash_cnt,
      service_cnt,
      ""1s_succ_join_ap_cnt"",
      ""5s_succ_join_ap_cnt"",
      total_join_ap_cnt,
      totalJoinSuccess,
      threeSecJoinSuccess,
      video_freeze_time_200,
      video_totaltime_200,
      video_freeze_time_500,
      video_totaltime_500,
      ""3s_succ_join_session_cnt_last1"",
      ""5s_succ_join_session_cnt_last1"",
      succ_join_session_cnt_last1,
      total_join_session_cnt_last1,
      total_session_cnt_last1,
      ""1s_succ_join_ap_cnt_last1"",
      ""5s_succ_join_ap_cnt_last1"",
      total_join_ap_cnt_last1,
      ""3s_succ_join_session_cnt_last7"",
      ""5s_succ_join_session_cnt_last7"",
      succ_join_session_cnt_last7,
      total_join_session_cnt_last7,
      total_session_cnt_last7,
      ""1s_succ_join_ap_cnt_last7"",
      ""5s_succ_join_ap_cnt_last7"",
      total_join_ap_cnt_last7,
      video_freeze_time_last1,
      video_totaltime_last1,
      video_freeze_time_500_last1,
      video_totaltime_500_last1,
      video_freeze_time_200_last1,
      video_totaltime_200_last1,
      video_freeze_time_last7,
      video_totaltime_last7,
      video_freeze_time_500_last7,
      video_totaltime_500_last7,
      video_freeze_time_200_last7,
      video_totaltime_200_last7,
      audio_freeze_time_last1,
      audio_totaltime_last1,
      audio_freeze_time_last7,
      audio_totaltime_last7,
      s2l_total_delay_sec_last1,
      s2l_25ms_delay_sec_last1,
      s2l_75ms_delay_sec_last1,
      s2l_total_delay_sec_last7,
      s2l_25ms_delay_sec_last7,
      s2l_75ms_delay_sec_last7,
      p2s_lost_Leq5_last1,
      p2s_lost_all_last1,
      p2s_lost_Leq5_last7,
      p2s_lost_all_last7,
      crash_cnt_last1,
      service_cnt_last1,
      crash_cnt_last7,
      service_cnt_last7,
      product_level1,
      product_level2,
      product_level3,
      product_level4,
      s2l_lost_Leq5,
      s2l_lost_all,
      s2l_lost_Leq5_last1,
      s2l_lost_all_last1,
      s2l_lost_Leq5_last7,
      s2l_lost_all_last7,
      fiveSecJoinSuccess_total,
      totalJoin_total,
      cnt_sid_total,
      video_freeze_time_total,
      video_totaltime_total,
      audio_freeze_time_total,
      audio_totaltime_total,
      s2l_total_delay_sec_total,
      s2l_25ms_delay_sec_total,
      s2l_75ms_delay_sec_total,
      p2s_lost_Leq5_total,
      p2s_lost_all_total,
      crash_cnt_total,
      service_cnt_total,
      ""1s_succ_join_ap_cnt_total"",
      ""5s_succ_join_ap_cnt_total"",
      total_join_ap_cnt_total,
      totalJoinSuccess_total,
      threeSecJoinSuccess_total,
      video_freeze_time_200_total,
      video_totaltime_200_total,
      video_freeze_time_500_total,
      video_totaltime_500_total,
      ""3s_succ_join_session_cnt_last1_total"",
      ""5s_succ_join_session_cnt_last1_total"",
      succ_join_session_cnt_last1_total,
      total_join_session_cnt_last1_total,
      total_session_cnt_last1_total,
      ""1s_succ_join_ap_cnt_last1_total"",
      ""5s_succ_join_ap_cnt_last1_total"",
      total_join_ap_cnt_last1_total,
      ""3s_succ_join_session_cnt_last7_total"",
      ""5s_succ_join_session_cnt_last7_total"",
      succ_join_session_cnt_last7_total,
      total_join_session_cnt_last7_total,
      total_session_cnt_last7_total,
      ""1s_succ_join_ap_cnt_last7_total"",
      ""5s_succ_join_ap_cnt_last7_total"",
      total_join_ap_cnt_last7_total,
      video_freeze_time_last1_total,
      video_totaltime_last1_total,
      video_freeze_time_500_last1_total,
      video_totaltime_500_last1_total,
      video_freeze_time_200_last1_total,
      video_totaltime_200_last1_total,
      video_freeze_time_last7_total,
      video_totaltime_last7_total,
      video_freeze_time_500_last7_total,
      video_totaltime_500_last7_total,
      video_freeze_time_200_last7_total,
      video_totaltime_200_last7_total,
      audio_freeze_time_last1_total,
      audio_totaltime_last1_total,
      audio_freeze_time_last7_total,
      audio_totaltime_last7_total,
      s2l_total_delay_sec_last1_total,
      s2l_25ms_delay_sec_last1_total,
      s2l_75ms_delay_sec_last1_total,
      s2l_total_delay_sec_last7_total,
      s2l_25ms_delay_sec_last7_total,
      s2l_75ms_delay_sec_last7_total,
      p2s_lost_Leq5_last1_total,
      p2s_lost_all_last1_total,
      p2s_lost_Leq5_last7_total,
      p2s_lost_all_last7_total,
      crash_cnt_last1_total,
      service_cnt_last1_total,
      crash_cnt_last7_total,
      service_cnt_last7_total,
      s2l_lost_Leq5_total,
      s2l_lost_all_total,
      s2l_lost_Leq5_last1_total,
      s2l_lost_all_last1_total,
      s2l_lost_Leq5_last7_total,
      s2l_lost_all_last7_total
    FROM report_datahub.pub_levels_quality_di_1 AS t1
      LEFT JOIN (SELECT date,
          dim,
          SUM(fiveSecJoinSuccess) AS fiveSecJoinSuccess_total,
          SUM(totalJoin) AS totalJoin_total,
          SUM(cnt_sid) AS cnt_sid_total,
          SUM(video_freeze_time) AS video_freeze_time_total,
          SUM(video_totaltime) AS video_totaltime_total,
          SUM(audio_freeze_time) AS audio_freeze_time_total,
          SUM(audio_totaltime) AS audio_totaltime_total,
          SUM(s2l_total_delay_sec) AS s2l_total_delay_sec_total,
          SUM(s2l_25ms_delay_sec) AS s2l_25ms_delay_sec_total,
          SUM(s2l_75ms_delay_sec) AS s2l_75ms_delay_sec_total,
          SUM(p2s_lost_Leq5) AS p2s_lost_Leq5_total,
          SUM(p2s_lost_all) AS p2s_lost_all_total,
          SUM(crash_cnt) AS crash_cnt_total,
          SUM(service_cnt) AS service_cnt_total,
          SUM(""1s_succ_join_ap_cnt"") AS ""1s_succ_join_ap_cnt_total"",
          SUM(""5s_succ_join_ap_cnt"") AS ""5s_succ_join_ap_cnt_total"",
          SUM(total_join_ap_cnt) AS total_join_ap_cnt_total,
          SUM(totalJoinSuccess) AS totalJoinSuccess_total,
          SUM(threeSecJoinSuccess) AS threeSecJoinSuccess_total,
          SUM(video_freeze_time_200) AS video_freeze_time_200_total,
          SUM(video_totaltime_200) AS video_totaltime_200_total,
          SUM(video_freeze_time_500) AS video_freeze_time_500_total,
          SUM(video_totaltime_500) AS video_totaltime_500_total,
          SUM(""3s_succ_join_session_cnt_last1"") AS ""3s_succ_join_session_cnt_last1_total"",
          SUM(""5s_succ_join_session_cnt_last1"") AS ""5s_succ_join_session_cnt_last1_total"",
          SUM(succ_join_session_cnt_last1) AS succ_join_session_cnt_last1_total,
          SUM(total_join_session_cnt_last1) AS total_join_session_cnt_last1_total,
          SUM(total_session_cnt_last1) AS total_session_cnt_last1_total,
          SUM(""1s_succ_join_ap_cnt_last1"") AS ""1s_succ_join_ap_cnt_last1_total"",
          SUM(""5s_succ_join_ap_cnt_last1"") AS ""5s_succ_join_ap_cnt_last1_total"",
          SUM(total_join_ap_cnt_last1) AS total_join_ap_cnt_last1_total,
          SUM(""3s_succ_join_session_cnt_last7"") AS ""3s_succ_join_session_cnt_last7_total"",
          SUM(""5s_succ_join_session_cnt_last7"") AS ""5s_succ_join_session_cnt_last7_total"",
          SUM(succ_join_session_cnt_last7) AS succ_join_session_cnt_last7_total,
          SUM(total_join_session_cnt_last7) AS total_join_session_cnt_last7_total,
          SUM(total_session_cnt_last7) AS total_session_cnt_last7_total,
          SUM(""1s_succ_join_ap_cnt_last7"") AS ""1s_succ_join_ap_cnt_last7_total"",
          SUM(""5s_succ_join_ap_cnt_last7"") AS ""5s_succ_join_ap_cnt_last7_total"",
          SUM(total_join_ap_cnt_last7) AS total_join_ap_cnt_last7_total,
          SUM(video_freeze_time_last1) AS video_freeze_time_last1_total,
          SUM(video_totaltime_last1) AS video_totaltime_last1_total,
          SUM(video_freeze_time_500_last1) AS video_freeze_time_500_last1_total,
          SUM(video_totaltime_500_last1) AS video_totaltime_500_last1_total,
          SUM(video_freeze_time_200_last1) AS video_freeze_time_200_last1_total,
          SUM(video_totaltime_200_last1) AS video_totaltime_200_last1_total,
          SUM(video_freeze_time_last7) AS video_freeze_time_last7_total,
          SUM(video_totaltime_last7) AS video_totaltime_last7_total,
          SUM(video_freeze_time_500_last7) AS video_freeze_time_500_last7_total,
          SUM(video_totaltime_500_last7) AS video_totaltime_500_last7_total,
          SUM(video_freeze_time_200_last7) AS video_freeze_time_200_last7_total,
          SUM(video_totaltime_200_last7) AS video_totaltime_200_last7_total,
          SUM(audio_freeze_time_last1) AS audio_freeze_time_last1_total,
          SUM(audio_totaltime_last1) AS audio_totaltime_last1_total,
          SUM(audio_freeze_time_last7) AS audio_freeze_time_last7_total,
          SUM(audio_totaltime_last7) AS audio_totaltime_last7_total,
          SUM(s2l_total_delay_sec_last1) AS s2l_total_delay_sec_last1_total,
          SUM(s2l_25ms_delay_sec_last1) AS s2l_25ms_delay_sec_last1_total,
          SUM(s2l_75ms_delay_sec_last1) AS s2l_75ms_delay_sec_last1_total,
          SUM(s2l_total_delay_sec_last7) AS s2l_total_delay_sec_last7_total,
          SUM(s2l_25ms_delay_sec_last7) AS s2l_25ms_delay_sec_last7_total,
          SUM(s2l_75ms_delay_sec_last7) AS s2l_75ms_delay_sec_last7_total,
          SUM(p2s_lost_Leq5_last1) AS p2s_lost_Leq5_last1_total,
          SUM(p2s_lost_all_last1) AS p2s_lost_all_last1_total,
          SUM(p2s_lost_Leq5_last7) AS p2s_lost_Leq5_last7_total,
          SUM(p2s_lost_all_last7) AS p2s_lost_all_last7_total,
          SUM(crash_cnt_last1) AS crash_cnt_last1_total,
          SUM(service_cnt_last1) AS service_cnt_last1_total,
          SUM(crash_cnt_last7) AS crash_cnt_last7_total,
          SUM(service_cnt_last7) AS service_cnt_last7_total,
          SUM(s2l_lost_Leq5) AS s2l_lost_Leq5_total,
          SUM(s2l_lost_all) AS s2l_lost_all_total,
          SUM(s2l_lost_Leq5_last1) AS s2l_lost_Leq5_last1_total,
          SUM(s2l_lost_all_last1) AS s2l_lost_all_last1_total,
          SUM(s2l_lost_Leq5_last7) AS s2l_lost_Leq5_last7_total,
          SUM(s2l_lost_all_last7) AS s2l_lost_all_last7_total
        FROM report_datahub.pub_levels_quality_di_1
        WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-21') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-05') AND CAST(tag AS VARCHAR) = 'Product'
        GROUP BY date,
          dim) AS t2 ON t1.date = t2.date AND t1.dim = t2.dim
    WHERE date_parse(cast( t1.date as VARCHAR), '%Y%m%d') >= DATE('2021-11-21') AND date_parse(cast( t1.date as VARCHAR), '%Y%m%d') <= DATE('2021-12-05') AND CAST(tag AS VARCHAR) = 'Product') AS ""自定义 SQL 查询""
  CROSS JOIN (SELECT MAX(date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d')) AS ""__measure__0""
    FROM (SELECT t1.date,
            CASE WHEN CAST(stat_period AS VARCHAR) = 'day' THEN substr(CAST(date_parse(cast( t1.date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(substr(CAST(start_date AS VARCHAR), 1, 10) AS VARCHAR), '~', CAST(substr(CAST(end_date AS VARCHAR), 1, 10) AS VARCHAR)) END AS period,
          start_date,
          end_date,
          stat_period,
          tag,
          t1.dim,
          level1,
          level2,
          level3,
          level4,
          os,
          ver,
          ver_type,
          domain,
          country,
          region,
          net,
          vid,
          project,
          company_id,
          company_name,
          rowsnum,
          lastusage,
          thisusage,
          fiveSecJoinSuccess,
          totalJoin,
          cnt_sid,
          video_freeze_time,
          video_totaltime,
          audio_freeze_time,
          audio_totaltime,
          s2l_total_delay_sec,
          s2l_25ms_delay_sec,
          s2l_75ms_delay_sec,
          p2s_lost_Leq5,
          p2s_lost_all,
          crash_cnt,
          service_cnt,
          ""1s_succ_join_ap_cnt"",
          ""5s_succ_join_ap_cnt"",
          total_join_ap_cnt,
          totalJoinSuccess,
          threeSecJoinSuccess,
          video_freeze_time_200,
          video_totaltime_200,
          video_freeze_time_500,
          video_totaltime_500,
          ""3s_succ_join_session_cnt_last1"",
          ""5s_succ_join_session_cnt_last1"",
          succ_join_session_cnt_last1,
          total_join_session_cnt_last1,
          total_session_cnt_last1,
          ""1s_succ_join_ap_cnt_last1"",
          ""5s_succ_join_ap_cnt_last1"",
          total_join_ap_cnt_last1,
          ""3s_succ_join_session_cnt_last7"",
          ""5s_succ_join_session_cnt_last7"",
          succ_join_session_cnt_last7,
          total_join_session_cnt_last7,
          total_session_cnt_last7,
          ""1s_succ_join_ap_cnt_last7"",
          ""5s_succ_join_ap_cnt_last7"",
          total_join_ap_cnt_last7,
          video_freeze_time_last1,
          video_totaltime_last1,
          video_freeze_time_500_last1,
          video_totaltime_500_last1,
          video_freeze_time_200_last1,
          video_totaltime_200_last1,
          video_freeze_time_last7,
          video_totaltime_last7,
          video_freeze_time_500_last7,
          video_totaltime_500_last7,
          video_freeze_time_200_last7,
          video_totaltime_200_last7,
          audio_freeze_time_last1,
          audio_totaltime_last1,
          audio_freeze_time_last7,
          audio_totaltime_last7,
          s2l_total_delay_sec_last1,
          s2l_25ms_delay_sec_last1,
          s2l_75ms_delay_sec_last1,
          s2l_total_delay_sec_last7,
          s2l_25ms_delay_sec_last7,
          s2l_75ms_delay_sec_last7,
          p2s_lost_Leq5_last1,
          p2s_lost_all_last1,
          p2s_lost_Leq5_last7,
          p2s_lost_all_last7,
          crash_cnt_last1,
          service_cnt_last1,
          crash_cnt_last7,
          service_cnt_last7,
          product_level1,
          product_level2,
          product_level3,
          product_level4,
          s2l_lost_Leq5,
          s2l_lost_all,
          s2l_lost_Leq5_last1,
          s2l_lost_all_last1,
          s2l_lost_Leq5_last7,
          s2l_lost_all_last7,
          fiveSecJoinSuccess_total,
          totalJoin_total,
          cnt_sid_total,
          video_freeze_time_total,
          video_totaltime_total,
          audio_freeze_time_total,
          audio_totaltime_total,
          s2l_total_delay_sec_total,
          s2l_25ms_delay_sec_total,
          s2l_75ms_delay_sec_total,
          p2s_lost_Leq5_total,
          p2s_lost_all_total,
          crash_cnt_total,
          service_cnt_total,
          ""1s_succ_join_ap_cnt_total"",
          ""5s_succ_join_ap_cnt_total"",
          total_join_ap_cnt_total,
          totalJoinSuccess_total,
          threeSecJoinSuccess_total,
          video_freeze_time_200_total,
          video_totaltime_200_total,
          video_freeze_time_500_total,
          video_totaltime_500_total,
          ""3s_succ_join_session_cnt_last1_total"",
          ""5s_succ_join_session_cnt_last1_total"",
          succ_join_session_cnt_last1_total,
          total_join_session_cnt_last1_total,
          total_session_cnt_last1_total,
          ""1s_succ_join_ap_cnt_last1_total"",
          ""5s_succ_join_ap_cnt_last1_total"",
          total_join_ap_cnt_last1_total,
          ""3s_succ_join_session_cnt_last7_total"",
          ""5s_succ_join_session_cnt_last7_total"",
          succ_join_session_cnt_last7_total,
          total_join_session_cnt_last7_total,
          total_session_cnt_last7_total,
          ""1s_succ_join_ap_cnt_last7_total"",
          ""5s_succ_join_ap_cnt_last7_total"",
          total_join_ap_cnt_last7_total,
          video_freeze_time_last1_total,
          video_totaltime_last1_total,
          video_freeze_time_500_last1_total,
          video_totaltime_500_last1_total,
          video_freeze_time_200_last1_total,
          video_totaltime_200_last1_total,
          video_freeze_time_last7_total,
          video_totaltime_last7_total,
          video_freeze_time_500_last7_total,
          video_totaltime_500_last7_total,
          video_freeze_time_200_last7_total,
          video_totaltime_200_last7_total,
          audio_freeze_time_last1_total,
          audio_totaltime_last1_total,
          audio_freeze_time_last7_total,
          audio_totaltime_last7_total,
          s2l_total_delay_sec_last1_total,
          s2l_25ms_delay_sec_last1_total,
          s2l_75ms_delay_sec_last1_total,
          s2l_total_delay_sec_last7_total,
          s2l_25ms_delay_sec_last7_total,
          s2l_75ms_delay_sec_last7_total,
          p2s_lost_Leq5_last1_total,
          p2s_lost_all_last1_total,
          p2s_lost_Leq5_last7_total,
          p2s_lost_all_last7_total,
          crash_cnt_last1_total,
          service_cnt_last1_total,
          crash_cnt_last7_total,
          service_cnt_last7_total,
          s2l_lost_Leq5_total,
          s2l_lost_all_total,
          s2l_lost_Leq5_last1_total,
          s2l_lost_all_last1_total,
          s2l_lost_Leq5_last7_total,
          s2l_lost_all_last7_total
        FROM report_datahub.pub_levels_quality_di_1 AS t1
          LEFT JOIN (SELECT date,
              dim,
              SUM(fiveSecJoinSuccess) AS fiveSecJoinSuccess_total,
              SUM(totalJoin) AS totalJoin_total,
              SUM(cnt_sid) AS cnt_sid_total,
              SUM(video_freeze_time) AS video_freeze_time_total,
              SUM(video_totaltime) AS video_totaltime_total,
              SUM(audio_freeze_time) AS audio_freeze_time_total,
              SUM(audio_totaltime) AS audio_totaltime_total,
              SUM(s2l_total_delay_sec) AS s2l_total_delay_sec_total,
              SUM(s2l_25ms_delay_sec) AS s2l_25ms_delay_sec_total,
              SUM(s2l_75ms_delay_sec) AS s2l_75ms_delay_sec_total,
              SUM(p2s_lost_Leq5) AS p2s_lost_Leq5_total,
              SUM(p2s_lost_all) AS p2s_lost_all_total,
              SUM(crash_cnt) AS crash_cnt_total,
              SUM(service_cnt) AS service_cnt_total,
              SUM(""1s_succ_join_ap_cnt"") AS ""1s_succ_join_ap_cnt_total"",
              SUM(""5s_succ_join_ap_cnt"") AS ""5s_succ_join_ap_cnt_total"",
              SUM(total_join_ap_cnt) AS total_join_ap_cnt_total,
              SUM(totalJoinSuccess) AS totalJoinSuccess_total,
              SUM(threeSecJoinSuccess) AS threeSecJoinSuccess_total,
              SUM(video_freeze_time_200) AS video_freeze_time_200_total,
              SUM(video_totaltime_200) AS video_totaltime_200_total,
              SUM(video_freeze_time_500) AS video_freeze_time_500_total,
              SUM(video_totaltime_500) AS video_totaltime_500_total,
              SUM(""3s_succ_join_session_cnt_last1"") AS ""3s_succ_join_session_cnt_last1_total"",
              SUM(""5s_succ_join_session_cnt_last1"") AS ""5s_succ_join_session_cnt_last1_total"",
              SUM(succ_join_session_cnt_last1) AS succ_join_session_cnt_last1_total,
              SUM(total_join_session_cnt_last1) AS total_join_session_cnt_last1_total,
              SUM(total_session_cnt_last1) AS total_session_cnt_last1_total,
              SUM(""1s_succ_join_ap_cnt_last1"") AS ""1s_succ_join_ap_cnt_last1_total"",
              SUM(""5s_succ_join_ap_cnt_last1"") AS ""5s_succ_join_ap_cnt_last1_total"",
              SUM(total_join_ap_cnt_last1) AS total_join_ap_cnt_last1_total,
              SUM(""3s_succ_join_session_cnt_last7"") AS ""3s_succ_join_session_cnt_last7_total"",
              SUM(""5s_succ_join_session_cnt_last7"") AS ""5s_succ_join_session_cnt_last7_total"",
              SUM(succ_join_session_cnt_last7) AS succ_join_session_cnt_last7_total,
              SUM(total_join_session_cnt_last7) AS total_join_session_cnt_last7_total,
              SUM(total_session_cnt_last7) AS total_session_cnt_last7_total,
              SUM(""1s_succ_join_ap_cnt_last7"") AS ""1s_succ_join_ap_cnt_last7_total"",
              SUM(""5s_succ_join_ap_cnt_last7"") AS ""5s_succ_join_ap_cnt_last7_total"",
              SUM(total_join_ap_cnt_last7) AS total_join_ap_cnt_last7_total,
              SUM(video_freeze_time_last1) AS video_freeze_time_last1_total,
              SUM(video_totaltime_last1) AS video_totaltime_last1_total,
              SUM(video_freeze_time_500_last1) AS video_freeze_time_500_last1_total,
              SUM(video_totaltime_500_last1) AS video_totaltime_500_last1_total,
              SUM(video_freeze_time_200_last1) AS video_freeze_time_200_last1_total,
              SUM(video_totaltime_200_last1) AS video_totaltime_200_last1_total,
              SUM(video_freeze_time_last7) AS video_freeze_time_last7_total,
              SUM(video_totaltime_last7) AS video_totaltime_last7_total,
              SUM(video_freeze_time_500_last7) AS video_freeze_time_500_last7_total,
              SUM(video_totaltime_500_last7) AS video_totaltime_500_last7_total,
              SUM(video_freeze_time_200_last7) AS video_freeze_time_200_last7_total,
              SUM(video_totaltime_200_last7) AS video_totaltime_200_last7_total,
              SUM(audio_freeze_time_last1) AS audio_freeze_time_last1_total,
              SUM(audio_totaltime_last1) AS audio_totaltime_last1_total,
              SUM(audio_freeze_time_last7) AS audio_freeze_time_last7_total,
              SUM(audio_totaltime_last7) AS audio_totaltime_last7_total,
              SUM(s2l_total_delay_sec_last1) AS s2l_total_delay_sec_last1_total,
              SUM(s2l_25ms_delay_sec_last1) AS s2l_25ms_delay_sec_last1_total,
              SUM(s2l_75ms_delay_sec_last1) AS s2l_75ms_delay_sec_last1_total,
              SUM(s2l_total_delay_sec_last7) AS s2l_total_delay_sec_last7_total,
              SUM(s2l_25ms_delay_sec_last7) AS s2l_25ms_delay_sec_last7_total,
              SUM(s2l_75ms_delay_sec_last7) AS s2l_75ms_delay_sec_last7_total,
              SUM(p2s_lost_Leq5_last1) AS p2s_lost_Leq5_last1_total,
              SUM(p2s_lost_all_last1) AS p2s_lost_all_last1_total,
              SUM(p2s_lost_Leq5_last7) AS p2s_lost_Leq5_last7_total,
              SUM(p2s_lost_all_last7) AS p2s_lost_all_last7_total,
              SUM(crash_cnt_last1) AS crash_cnt_last1_total,
              SUM(service_cnt_last1) AS service_cnt_last1_total,
              SUM(crash_cnt_last7) AS crash_cnt_last7_total,
              SUM(service_cnt_last7) AS service_cnt_last7_total,
              SUM(s2l_lost_Leq5) AS s2l_lost_Leq5_total,
              SUM(s2l_lost_all) AS s2l_lost_all_total,
              SUM(s2l_lost_Leq5_last1) AS s2l_lost_Leq5_last1_total,
              SUM(s2l_lost_all_last1) AS s2l_lost_all_last1_total,
              SUM(s2l_lost_Leq5_last7) AS s2l_lost_Leq5_last7_total,
              SUM(s2l_lost_all_last7) AS s2l_lost_all_last7_total
            FROM report_datahub.pub_levels_quality_di_1
            WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-21') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-05') AND CAST(tag AS VARCHAR) = 'Product'
            GROUP BY date,
              dim) AS t2 ON t1.date = t2.date AND t1.dim = t2.dim
        WHERE date_parse(cast( t1.date as VARCHAR), '%Y%m%d') >= DATE('2021-11-21') AND date_parse(cast( t1.date as VARCHAR), '%Y%m%d') <= DATE('2021-12-05') AND CAST(tag AS VARCHAR) = 'Product') AS ""自定义 SQL 查询""
    HAVING COUNT(1) > 0) AS ""t0""
WHERE CASE WHEN CAST(""自定义 SQL 查询"".""tag"" AS VARCHAR) = 'Industry' AND CAST(""自定义 SQL 查询"".""product_level1"" AS VARCHAR) = 'RTC' AND CAST(""自定义 SQL 查询"".""dim"" AS VARCHAR) = 'osver' THEN 0 WHEN CAST(""自定义 SQL 查询"".""tag"" AS VARCHAR) = 'VerType' AND CAST(""自定义 SQL 查询"".""product_level1"" AS VARCHAR) = 'RTC' AND CAST(""自定义 SQL 查询"".""dim"" AS VARCHAR) = 'osver' THEN 0 WHEN CAST(""自定义 SQL 查询"".""tag"" AS VARCHAR) = 'Product' AND CAST(""自定义 SQL 查询"".""dim"" AS VARCHAR) = 'osver' AND CAST(""自定义 SQL 查询"".""product_level1"" AS VARCHAR) = 'RTC' THEN 1 ELSE 0 END AND CAST(""自定义 SQL 查询"".""level2"" AS VARCHAR) = 'Native' AND DATE_ADD('SECOND', 0, date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d')) = DATE_ADD('SECOND', 0, ""t0"".""__measure__0"")
HAVING COUNT(1) > 0"
"SELECT SUM(""自定义 SQL 查询"".""s2l_25ms_delay_sec"") AS ""TEMP(Calculation_1430244791154503680)(2227145667)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_total_delay_sec"") AS ""TEMP(Calculation_1430244791154503680)(2460078802)(0)"",
  SUM(""自定义 SQL 查询"".""5s_succ_join_ap_cnt"") AS ""TEMP(Calculation_1430244791247978510)(1716451703)(0)"",
  SUM(""自定义 SQL 查询"".""total_join_ap_cnt"") AS ""TEMP(Calculation_1430244791247978510)(2681092799)(0)"",
  SUM(""自定义 SQL 查询"".""video_totaltime_200"") AS ""TEMP(Calculation_2810035073237950465)(2104207895)(0)"",
  SUM(""自定义 SQL 查询"".""video_freeze_time_200"") AS ""TEMP(Calculation_2810035073237950465)(530162565)(0)"",
  SUM(""自定义 SQL 查询"".""totalJoin"") AS ""TEMP(Calculation_374009936508170240)(2073556184)(0)"",
  SUM(""自定义 SQL 查询"".""totalJoinSuccess"") AS ""TEMP(Calculation_374009936508170240)(2807417001)(0)"",
  SUM(""自定义 SQL 查询"".""threeSecJoinSuccess"") AS ""TEMP(Calculation_374009936508321793)(3693645608)(0)"",
  SUM(""自定义 SQL 查询"".""fiveSecJoinSuccess"") AS ""TEMP(Calculation_374009936508416002)(383616769)(0)"",
  SUM(""自定义 SQL 查询"".""video_totaltime"") AS ""TEMP(Calculation_374009936515215363)(2797449586)(0)"",
  SUM(""自定义 SQL 查询"".""video_freeze_time"") AS ""TEMP(Calculation_374009936515215363)(2940759860)(0)"",
  SUM(""自定义 SQL 查询"".""audio_totaltime"") AS ""TEMP(Calculation_374009936517861380)(1652566750)(0)"",
  SUM(""自定义 SQL 查询"".""audio_freeze_time"") AS ""TEMP(Calculation_374009936517861380)(2919389392)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_lost_Leq5"") AS ""TEMP(Calculation_374009936519704581)(1936123547)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_lost_all"") AS ""TEMP(Calculation_374009936519704581)(749826584)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_75ms_delay_sec"") AS ""TEMP(Calculation_6542393318886285312)(2003933318)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_lost_Leq5"") AS ""TEMP(Calculation_7034341207026868236)(2745840127)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_lost_all"") AS ""TEMP(Calculation_7034341207026868236)(734589263)(0)"",
  SUM(""自定义 SQL 查询"".""crash_cnt"") AS ""TEMP(Calculation_7034341207372070925)(2360900687)(0)"",
  SUM(""自定义 SQL 查询"".""service_cnt"") AS ""TEMP(Calculation_7034341207372070925)(4291252132)(0)"",
  DATE_ADD('SECOND', 0, date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d')) AS ""tdy_date_ok""
FROM (SELECT date,
        CASE WHEN CAST(stat_period AS VARCHAR) = 'day' THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(substr(CAST(start_date AS VARCHAR), 1, 10) AS VARCHAR), '~', CAST(substr(CAST(end_date AS VARCHAR), 1, 10) AS VARCHAR)) END AS period,
      start_date,
      end_date,
      stat_period,
      tag,
      dim,
      level1,
      level2,
      level3,
      level4,
      '' AS pd,
      os,
      ver,
      ver_type,
      '' AS product_line,
      '' AS product_type,
      domain,
      country,
      region,
      net,
      vid,
      project,
      company_id,
      company_name,
      rowsnum,
      lastusage,
      thisusage,
      fiveSecJoinSuccess,
      totalJoin,
      cnt_sid,
      video_freeze_time,
      video_totaltime,
      audio_freeze_time,
      audio_totaltime,
      s2l_total_delay_sec,
      s2l_25ms_delay_sec,
      s2l_75ms_delay_sec,
      p2s_lost_Leq5,
      p2s_lost_all,
      crash_cnt,
      service_cnt,
      ""1s_succ_join_ap_cnt"",
      ""5s_succ_join_ap_cnt"",
      total_join_ap_cnt,
      totalJoinSuccess,
      threeSecJoinSuccess,
      video_freeze_time_200,
      video_totaltime_200,
      video_freeze_time_500,
      video_totaltime_500,
      ""3s_succ_join_session_cnt_last1"",
      ""5s_succ_join_session_cnt_last1"",
      succ_join_session_cnt_last1,
      total_join_session_cnt_last1,
      total_session_cnt_last1,
      ""1s_succ_join_ap_cnt_last1"",
      ""5s_succ_join_ap_cnt_last1"",
      total_join_ap_cnt_last1,
      ""3s_succ_join_session_cnt_last7"",
      ""5s_succ_join_session_cnt_last7"",
      succ_join_session_cnt_last7,
      total_join_session_cnt_last7,
      total_session_cnt_last7,
      ""1s_succ_join_ap_cnt_last7"",
      ""5s_succ_join_ap_cnt_last7"",
      total_join_ap_cnt_last7,
      video_freeze_time_last1,
      video_totaltime_last1,
      video_freeze_time_500_last1,
      video_totaltime_500_last1,
      video_freeze_time_200_last1,
      video_totaltime_200_last1,
      video_freeze_time_last7,
      video_totaltime_last7,
      video_freeze_time_500_last7,
      video_totaltime_500_last7,
      video_freeze_time_200_last7,
      video_totaltime_200_last7,
      audio_freeze_time_last1,
      audio_totaltime_last1,
      audio_freeze_time_last7,
      audio_totaltime_last7,
      s2l_total_delay_sec_last1,
      s2l_25ms_delay_sec_last1,
      s2l_75ms_delay_sec_last1,
      s2l_total_delay_sec_last7,
      s2l_25ms_delay_sec_last7,
      s2l_75ms_delay_sec_last7,
      p2s_lost_Leq5_last1,
      p2s_lost_all_last1,
      p2s_lost_Leq5_last7,
      p2s_lost_all_last7,
      crash_cnt_last1,
      service_cnt_last1,
      crash_cnt_last7,
      service_cnt_last7,
      product_level1,
      product_level2,
      product_level3,
      product_level4,
      s2l_lost_Leq5,
      s2l_lost_all,
      s2l_lost_Leq5_last1,
      s2l_lost_all_last1,
      s2l_lost_Leq5_last7,
      s2l_lost_all_last7
    FROM report_datahub.pub_levels_quality_di_1
    WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-21') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-05')) AS ""自定义 SQL 查询""
WHERE CASE WHEN CAST(""自定义 SQL 查询"".""tag"" AS VARCHAR) = 'Industry' AND CAST(""自定义 SQL 查询"".""product_level1"" AS VARCHAR) = 'RTC' AND CAST(""自定义 SQL 查询"".""dim"" AS VARCHAR) = 'osver' THEN 0 WHEN CAST(""自定义 SQL 查询"".""tag"" AS VARCHAR) = 'VerType' AND CAST(""自定义 SQL 查询"".""product_level1"" AS VARCHAR) = 'RTC' AND CAST(""自定义 SQL 查询"".""dim"" AS VARCHAR) = 'osver' THEN 0 WHEN CAST(""自定义 SQL 查询"".""tag"" AS VARCHAR) = 'Product' AND CAST(""自定义 SQL 查询"".""product_level1"" AS VARCHAR) = 'RTC' AND CAST(""自定义 SQL 查询"".""dim"" AS VARCHAR) = 'osver' THEN 1 ELSE 0 END
GROUP BY 22"
"SELECT SUM(""自定义 SQL 查询"".""delay25"") AS ""TEMP(Calculation_3094043381461364736)(3362377732)(0)"",
  SUM(""自定义 SQL 查询"".""delay_total"") AS ""TEMP(Calculation_3094043381461364736)(363980608)(0)"",
  SUM(""自定义 SQL 查询"".""delay75"") AS ""TEMP(Calculation_3094043381461454849)(2419700853)(0)"",
  SUM(""自定义 SQL 查询"".""lost_ratio_5"") AS ""TEMP(Calculation_3094043381461549058)(1479243093)(0)"",
  SUM(""自定义 SQL 查询"".""lost_total"") AS ""TEMP(Calculation_3094043381461549058)(154362899)(0)"",
  ""自定义 SQL 查询"".""country"" AS ""country"",
  SUM(""自定义 SQL 查询"".""delay_total"") AS ""sum_delay_total_ok""
FROM (SELECT *
    FROM media.sdrtn_okr_notvpn
    WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-16') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-11-29')) AS ""自定义 SQL 查询""
GROUP BY 6"
"SELECT SUM(""自定义 SQL 查询"".""host_4k"") AS ""TEMP(Calculation_3519281700079370244)(1075454865)(0)"",
  SUM(""自定义 SQL 查询"".""audience_sd"") AS ""TEMP(Calculation_3519281700079370244)(1133678835)(0)"",
  SUM(""自定义 SQL 查询"".""host_1080p"") AS ""TEMP(Calculation_3519281700079370244)(1312501967)(0)"",
  SUM(""自定义 SQL 查询"".""host_hd"") AS ""TEMP(Calculation_3519281700079370244)(276907208)(0)"",
  SUM(""自定义 SQL 查询"".""video"") AS ""TEMP(Calculation_3519281700079370244)(2929708110)(0)"",
  SUM(""自定义 SQL 查询"".""audience_hd"") AS ""TEMP(Calculation_3519281700079370244)(2930728935)(0)"",
  SUM(""自定义 SQL 查询"".""audience_hdp"") AS ""TEMP(Calculation_3519281700079370244)(3010533957)(0)"",
  SUM(""自定义 SQL 查询"".""host_hdp"") AS ""TEMP(Calculation_3519281700079370244)(30306054)(0)"",
  SUM(""自定义 SQL 查询"".""host_audio"") AS ""TEMP(Calculation_3519281700079370244)(3087054365)(0)"",
  SUM(""自定义 SQL 查询"".""audio"") AS ""TEMP(Calculation_3519281700079370244)(3299350010)(0)"",
  SUM(""自定义 SQL 查询"".""audience_1080p"") AS ""TEMP(Calculation_3519281700079370244)(3628946582)(0)"",
  SUM(""自定义 SQL 查询"".""totalUsage"") AS ""TEMP(Calculation_3519281700079370244)(3847882359)(0)"",
  SUM(""自定义 SQL 查询"".""audience_audio"") AS ""TEMP(Calculation_3519281700079370244)(4109514392)(0)"",
  SUM(""自定义 SQL 查询"".""host_2k"") AS ""TEMP(Calculation_3519281700079370244)(586790827)(0)"",
  SUM(""自定义 SQL 查询"".""host_sd"") AS ""TEMP(Calculation_3519281700079370244)(709512178)(0)"",
  SUM(""自定义 SQL 查询"".""audience_4k"") AS ""TEMP(Calculation_3519281700079370244)(764410224)(0)"",
  SUM(""自定义 SQL 查询"".""audience_2k"") AS ""TEMP(Calculation_3519281700079370244)(943764407)(0)"",
  MIN(""自定义 SQL 查询"".""level1"") AS ""TEMP(attr_level1_nk)(1482809429)(0)"",
  MAX(""自定义 SQL 查询"".""level1"") AS ""TEMP(attr_level1_nk)(3765460736)(0)"",
  MAX(""自定义 SQL 查询"".""stat_date"") AS ""TEMP(attr_stat_date_nk)(2102638629)(0)"",
  MIN(""自定义 SQL 查询"".""stat_date"") AS ""TEMP(attr_stat_date_nk)(2790680713)(0)"",
  ""自定义 SQL 查询"".""level3"" AS ""level3"",
  DATE_ADD('SECOND', 0, date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d')) AS ""tdy_date_ok""
FROM (SELECT date,
        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,
      start_date AS start_date_7,
      end_date AS end_date,
      tag,
      area AS Scope,
      dim,
        CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,
      level2,
      level3,
      level4,
      product_level1 AS product_line,
      product_level2,
      product_level3,
      product_level4,
      vid_internal_industry_en AS cid_industry,
      vid_use_case_en AS vid_use_case_cn,
      vid_sector_en,
      ver_type,
      ver,
      os,
      domain,
      country,
      region,
      dim_grouping_name,
        CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,
      total AS totalUsage,
      audio,
      video,
      host_audio,
      audience_audio,
      host_sd,
      host_hd,
      host_hdp,
      host_1080p,
      host_2k,
      host_4k,
      audience_sd,
      audience_hd,
      audience_hdp,
      audience_1080p,
      audience_2k,
      audience_4k,
      audience_audio_low_latency,
      audience_sd_low_latency,
      audience_hd_low_latency,
      audience_hdp_low_latency,
      audience_1080p_low_latency,
      audience_2k_low_latency,
      audience_4k_low_latency,
      audience_audio_ultra_low_latency,
      audience_sd_ultra_low_latency,
      audience_hd_ultra_low_latency,
      audience_hdp_ultra_low_latency,
      audience_1080p_ultra_low_latency,
      audience_2k_ultra_low_latency,
      audience_4k_ultra_low_latency,
      total_last1 AS audio_video_last,
      audio_last1 AS audio_last,
      video_last1 AS video_last,
      video_sd_last1 AS video_sd_last,
      video_hd_last1 AS video_hd_last,
      video_hdp_last1 AS video_hdp_last,
      host_sd_last1 AS host_video_sd_last,
      audience_sd_last1 AS audience_video_sd_last,
      host_hd_last1 AS host_video_hd_last,
      audience_hd_last1 AS audience_video_hd_last,
      host_hdp_last1 AS host_video_hdp_last,
      audience_hdp_last1 AS audience_video_hdp_last,
      host_audio_last1 AS host_audio_last,
      audience_audio_last1 AS audience_audio_last,
      host_video_last1 AS host_video_last,
      audience_video_last1 AS audience_video_last,
      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,
      audience_video_low_latency_last1 AS audience_video_low_latency_last,
      audience_total_low_latency_last1 AS audience_total_low_latency_last,
      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,
      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,
      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,
      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,
      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,
      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,
      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,
      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,
      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,
      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,
      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,
      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,
      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,
      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,
      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,
      audience_2k_last1 AS audience_2k_last,
      audience_4k_last1 AS audience_4k_last,
      audience_1080p_last1 AS audience_1080p_last,
      host_1080p_last1 AS host_1080p_last,
      host_2k_last1 AS host_2k_last,
      host_4k_last1 AS host_4k_last,
      total_last7,
      audio_last7,
      video_last7,
      video_sd_last7,
      video_hd_last7,
      video_hdp_last7,
      host_sd_last7,
      audience_sd_last7,
      host_hd_last7,
      audience_hd_last7,
      host_hdp_last7,
      audience_hdp_last7,
      host_audio_last7,
      audience_audio_last7,
      host_video_last7,
      audience_video_last7,
      audience_audio_low_latency_last7,
      audience_video_low_latency_last7,
      audience_total_low_latency_last7,
      audience_sd_low_latency_last7,
      audience_hd_low_latency_last7,
      audience_hdp_low_latency_last7,
      audience_1080p_low_latency_last7,
      audience_2k_low_latency_last7,
      audience_4k_low_latency_last7,
      audience_audio_ultra_low_latency_last7,
      audience_video_ultra_low_latency_last7,
      audience_total_ultra_low_latency_last7,
      audience_sd_ultra_low_latency_last7,
      audience_hd_ultra_low_latency_last7,
      audience_hdp_ultra_low_latency_last7,
      audience_1080p_ultra_low_latency_last7,
      audience_2k_ultra_low_latency_last7,
      audience_4k_ultra_low_latency_last7,
      audience_2k_last7,
      audience_4k_last7,
      audience_1080p_last7,
      host_1080p_last7,
      host_2k_last7,
      host_4k_last7
    FROM levels_usage_dod_di_1
    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-06') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-04') AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS ""自定义 SQL 查询""
WHERE ""自定义 SQL 查询"".""dim"" = 1
GROUP BY 22,
  23"
"SELECT SUM(""自定义 SQL 查询"".""p2s_Delay25"" * ""自定义 SQL 查询"".""delay_total"") AS ""TEMP(Calculation_1122874106494361604)(1461110105)(0)"",
  SUM(""自定义 SQL 查询"".""delay_total"") AS ""TEMP(Calculation_1122874106494361604)(363980608)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_Delay50"" * ""自定义 SQL 查询"".""delay_total"") AS ""TEMP(Calculation_1122874106494976005)(1551638771)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_Delay75"" * ""自定义 SQL 查询"".""delay_total"") AS ""TEMP(Calculation_1122874106495696902)(2562427304)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_lostRatio"" * ""自定义 SQL 查询"".""p2s_total"") AS ""TEMP(Calculation_1122874106495848455)(1741181994)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_total"") AS ""TEMP(Calculation_1122874106495848455)(2624355999)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_jitter95_100"" * ""自定义 SQL 查询"".""jitter95_total"") AS ""TEMP(Calculation_4208191644263628803)(3609783325)(0)"",
  SUM(""自定义 SQL 查询"".""jitter95_total"") AS ""TEMP(Calculation_4208191644263628803)(633698484)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_jitter95_50"" * ""自定义 SQL 查询"".""jitter95_total"") AS ""TEMP(Calculation_4208191644264697860)(1652714847)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_jitter95_200"" * ""自定义 SQL 查询"".""jitter95_total"") AS ""TEMP(Calculation_4208191644264935429)(206867949)(0)"",
  ""自定义 SQL 查询"".""idc"" AS ""idc"",
  ""自定义 SQL 查询"".""srcRegion"" AS ""srcRegion"",
  SUM(""自定义 SQL 查询"".""p2s_total"") AS ""sum_p2s_total_ok""
FROM (SELECT date AS ""date"",
      src_domain AS ""srcDomain"",
      src_region AS ""srcRegion"",
      dest_idc AS ""idc"",
      delay_25 AS ""p2s_Delay25"",
      delay_50 AS ""p2s_Delay50"",
      delay_75 AS ""p2s_Delay75"",
      delay_100 AS ""p2s_Delay100"",
      delay_125 AS ""p2s_Delay125"",
      delay_150 AS ""p2s_Delay150"",
      delay_total,
      lost_ratio_5 AS ""p2s_lostRatio"",
      lostratio_total AS ""p2s_total"",
      jitter95_50 AS ""p2s_jitter95_50"",
      jitter95_100 AS ""p2s_jitter95_100"",
      jitter95_200 AS ""p2s_jitter95_200"",
      jitter95_300 AS ""p2s_jitter95_300"",
      jitter95_total,
      product_line,
      product_type
    FROM media.p2s_cover_mainland_ip
    WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-25') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-01')) AS ""自定义 SQL 查询""
WHERE (""自定义 SQL 查询"".""idc"" IN ('aofei-frankfurt1g', 'aofei-hk1ga', 'aofei-japan', 'aofei-singapore1ga', 'aofei-tokyo9', 'changchun1g-cucc', 'changsha-cucc', 'changsha9-ctel', 'eq-newyork10', 'eq-newyork9', 'evc-chicago1g', 'evc-frankfurt1ga', 'evc-frankfurt9', 'evc-japan9a', 'evc-seattle1g', 'evc-singapore1ga', 'evc-singapore1gb', 'fuzhou1g-cmcc', 'guangzhou-cmcc', 'guangzhou0t-drpeng', 'guangzhou1g-cmcc', 'guangzhou6js-bgp', 'guangzhou99-cmcc', 'hangzhou6al-bgp', 'hangzhou9-ctel', 'hangzhou9b-cmcc', 'hefei9-cmcc', 'huainan1g-cmcc', 'huhehaote1g-ctel', 'huzhou9-ctel', 'huzhou9-cucc', 'jinan1g-3line', 'jinan1g-cucc', 'jinan6bdbm-cucc', 'jinan9-cmcc', 'jiujiang9-ctel', 'langfang6uc-cucc', 'nanchang1g-cmcc', 'neijiang1g-ctel', 'ningbo1g-3line', 'qingdao1g-ctel', 'qinhuangdao1g-cucc', 'shanghai6js-bgp', 'shantou1g-ctel', 'shenyang1g-cmcc', 'shenyang9a-cucc', 'suzhou1g-cmcc', 'suzhou6bdbm-ctel', 'taiyuan6bd-ctel', 'taiyuan6bdbm-ctel', 'taiyuan9-cucc', 'tangshan9-cucc', 'tangshan99-cucc', 'tianjin1ga-ctel', 'tianjin3g-3line', 'wujiang-ctel', 'wuxi3c-bgp', 'xiamen6bd-ctel', 'xiamen6bdbm-ctel', 'xinxiang1g-cucc', 'yancheng1g-ctel', 'yantai1g-cucc', 'yiyang1g-cucc', 'yueyang6bd-ctel', 'yueyang6bdbm-ctel', 'zaozhuang9b-cucc', 'zen-amsterdam9b', 'zen-bangalore1ga', 'zen-bangkok', 'zen-chennai1ga', 'zen-dallas1g', 'zen-frankfurt1g', 'zen-frankfurt1gb', 'zen-hk9b', 'zen-losangeles9', 'zen-losangeles9a', 'zen-melbourne9a', 'zen-miami1g', 'zen-moscow2', 'zen-saopaulo2', 'zen-singapore1ga', 'zen-singapore1gb', 'zen-singapore3a', 'zen-washington1ga') OR ( (  ""自定义 SQL 查询"".""idc""  ) is null) OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'baoji1g-ctel' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'beijing-bgp' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'beijing6-bgp' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'beijing8-bgp' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'changsha1g-3line' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'changsha1g-cucc' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'changzhou9a-drpeng' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'chengdu6al-bgp' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'chongqing1g-3line' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'chongqing1ga-ctel' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'dalian1g-cmcc' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'eq-losangeles9' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'foshan1g-ctel' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'foshan9-ctel' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'guizhou1g-ctel' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'hangzhou3g-3line' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'lishui1g-ctel' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'luoyang1g-ctel' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'nanchang6bd-ctel' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'nanchang6uc-ctel' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'qinhuangdao9-cucc' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'retn-amsterdam0t' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'shenzhen9-drpeng' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'singtel-singapore0t' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'taizhou1g-3line' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'taizhou9-cucc' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'tianjin1g-cmcc' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'tianjin1g-cucc' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'tianjin9-ctel' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'tianjin9d-cucc' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'wenzhou1g-cmcc' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'wenzhou9-cmcc' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'xian1g-cmcc' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'xiangyang1g-cmcc' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'xixian9-ctel' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'xuzhou9b-ctel' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'yancheng9-cmcc' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'yancheng9b-ctel' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'yangzhou1g-cmcc' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'yangzhou6uc-3line' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'zen-amsterdam1' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'zen-amsterdam3' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'zen-frankfurt9a' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'zen-hk1gb' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'zen-japan' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'zen-japan9' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'zen-london1ga' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'zen-london3' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'zen-london9a' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'zen-losangeles3' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'zen-mumbai1ga' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'zen-mumbai9' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'zen-singapore9b' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'zen-tokyo1g' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'zhangjiakou1gb-cmcc' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'zhengzhou6bd-cucc' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'zhenjiang1g-3line' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'zhuzhou1g-ctel') AND CAST(""自定义 SQL 查询"".""srcRegion"" AS VARCHAR) >= 'Anhui' AND CAST(""自定义 SQL 查询"".""srcRegion"" AS VARCHAR) <= 'Zhejiang'
GROUP BY 11,
  12
HAVING CAST(CASE WHEN SUM(""自定义 SQL 查询"".""p2s_total"") >= 0 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100 THEN '0-100' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 1000 THEN '100-1000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 1000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 10000 THEN '1000-10000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 10000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100000 THEN '10000-100000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100000 THEN '100000以上' ELSE 'other' END AS VARCHAR) = '0-100' OR CAST(CASE WHEN SUM(""自定义 SQL 查询"".""p2s_total"") >= 0 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100 THEN '0-100' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 1000 THEN '100-1000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 1000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 10000 THEN '1000-10000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 10000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100000 THEN '10000-100000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100000 THEN '100000以上' ELSE 'other' END AS VARCHAR) = '100-1000' OR CAST(CASE WHEN SUM(""自定义 SQL 查询"".""p2s_total"") >= 0 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100 THEN '0-100' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 1000 THEN '100-1000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 1000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 10000 THEN '1000-10000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 10000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100000 THEN '10000-100000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100000 THEN '100000以上' ELSE 'other' END AS VARCHAR) = '1000-10000' OR CAST(CASE WHEN SUM(""自定义 SQL 查询"".""p2s_total"") >= 0 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100 THEN '0-100' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 1000 THEN '100-1000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 1000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 10000 THEN '1000-10000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 10000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100000 THEN '10000-100000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100000 THEN '100000以上' ELSE 'other' END AS VARCHAR) = '10000-100000' OR CAST(CASE WHEN SUM(""自定义 SQL 查询"".""p2s_total"") >= 0 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100 THEN '0-100' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 1000 THEN '100-1000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 1000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 10000 THEN '1000-10000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 10000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100000 THEN '10000-100000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100000 THEN '100000以上' ELSE 'other' END AS VARCHAR) = '100000以上'"
"SELECT ""自定义 SQL 查询"".""level2"" AS ""level2"",
  SUM(""自定义 SQL 查询"".""totalUsage"") AS ""usr_Calculation_3519281700079370244_ok""
FROM (SELECT date,
        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,
      start_date AS start_date_7,
      end_date AS end_date,
      tag,
      area AS Scope,
      dim,
        CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,
      level2,
      level3,
      level4,
      product_level1 AS product_line,
      product_level2,
      product_level3,
      product_level4,
      vid_internal_industry_en AS cid_industry,
      vid_use_case_en AS vid_use_case_cn,
      vid_sector_en,
      ver_type,
      ver,
      os,
      domain,
      country,
      region,
      dim_grouping_name,
        CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,
      total AS totalUsage,
      audio,
      video,
      host_audio,
      audience_audio,
      host_sd,
      host_hd,
      host_hdp,
      host_1080p,
      host_2k,
      host_4k,
      audience_sd,
      audience_hd,
      audience_hdp,
      audience_1080p,
      audience_2k,
      audience_4k,
      audience_audio_low_latency,
      audience_sd_low_latency,
      audience_hd_low_latency,
      audience_hdp_low_latency,
      audience_1080p_low_latency,
      audience_2k_low_latency,
      audience_4k_low_latency,
      audience_audio_ultra_low_latency,
      audience_sd_ultra_low_latency,
      audience_hd_ultra_low_latency,
      audience_hdp_ultra_low_latency,
      audience_1080p_ultra_low_latency,
      audience_2k_ultra_low_latency,
      audience_4k_ultra_low_latency,
      total_last1 AS audio_video_last,
      audio_last1 AS audio_last,
      video_last1 AS video_last,
      video_sd_last1 AS video_sd_last,
      video_hd_last1 AS video_hd_last,
      video_hdp_last1 AS video_hdp_last,
      host_sd_last1 AS host_video_sd_last,
      audience_sd_last1 AS audience_video_sd_last,
      host_hd_last1 AS host_video_hd_last,
      audience_hd_last1 AS audience_video_hd_last,
      host_hdp_last1 AS host_video_hdp_last,
      audience_hdp_last1 AS audience_video_hdp_last,
      host_audio_last1 AS host_audio_last,
      audience_audio_last1 AS audience_audio_last,
      host_video_last1 AS host_video_last,
      audience_video_last1 AS audience_video_last,
      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,
      audience_video_low_latency_last1 AS audience_video_low_latency_last,
      audience_total_low_latency_last1 AS audience_total_low_latency_last,
      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,
      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,
      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,
      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,
      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,
      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,
      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,
      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,
      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,
      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,
      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,
      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,
      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,
      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,
      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,
      audience_2k_last1 AS audience_2k_last,
      audience_4k_last1 AS audience_4k_last,
      audience_1080p_last1 AS audience_1080p_last,
      host_1080p_last1 AS host_1080p_last,
      host_2k_last1 AS host_2k_last,
      host_4k_last1 AS host_4k_last,
      total_last7,
      audio_last7,
      video_last7,
      video_sd_last7,
      video_hd_last7,
      video_hdp_last7,
      host_sd_last7,
      audience_sd_last7,
      host_hd_last7,
      audience_hd_last7,
      host_hdp_last7,
      audience_hdp_last7,
      host_audio_last7,
      audience_audio_last7,
      host_video_last7,
      audience_video_last7,
      audience_audio_low_latency_last7,
      audience_video_low_latency_last7,
      audience_total_low_latency_last7,
      audience_sd_low_latency_last7,
      audience_hd_low_latency_last7,
      audience_hdp_low_latency_last7,
      audience_1080p_low_latency_last7,
      audience_2k_low_latency_last7,
      audience_4k_low_latency_last7,
      audience_audio_ultra_low_latency_last7,
      audience_video_ultra_low_latency_last7,
      audience_total_ultra_low_latency_last7,
      audience_sd_ultra_low_latency_last7,
      audience_hd_ultra_low_latency_last7,
      audience_hdp_ultra_low_latency_last7,
      audience_1080p_ultra_low_latency_last7,
      audience_2k_ultra_low_latency_last7,
      audience_4k_ultra_low_latency_last7,
      audience_2k_last7,
      audience_4k_last7,
      audience_1080p_last7,
      host_1080p_last7,
      host_2k_last7,
      host_4k_last7
    FROM levels_usage_dod_di_1
    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-06') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-04') AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS ""自定义 SQL 查询""
  CROSS JOIN (SELECT MAX(date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d')) AS ""__measure__0""
    FROM (SELECT date,
            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,
          start_date AS start_date_7,
          end_date AS end_date,
          tag,
          area AS Scope,
          dim,
            CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,
          level2,
          level3,
          level4,
          product_level1 AS product_line,
          product_level2,
          product_level3,
          product_level4,
          vid_internal_industry_en AS cid_industry,
          vid_use_case_en AS vid_use_case_cn,
          vid_sector_en,
          ver_type,
          ver,
          os,
          domain,
          country,
          region,
          dim_grouping_name,
            CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,
          total AS totalUsage,
          audio,
          video,
          host_audio,
          audience_audio,
          host_sd,
          host_hd,
          host_hdp,
          host_1080p,
          host_2k,
          host_4k,
          audience_sd,
          audience_hd,
          audience_hdp,
          audience_1080p,
          audience_2k,
          audience_4k,
          audience_audio_low_latency,
          audience_sd_low_latency,
          audience_hd_low_latency,
          audience_hdp_low_latency,
          audience_1080p_low_latency,
          audience_2k_low_latency,
          audience_4k_low_latency,
          audience_audio_ultra_low_latency,
          audience_sd_ultra_low_latency,
          audience_hd_ultra_low_latency,
          audience_hdp_ultra_low_latency,
          audience_1080p_ultra_low_latency,
          audience_2k_ultra_low_latency,
          audience_4k_ultra_low_latency,
          total_last1 AS audio_video_last,
          audio_last1 AS audio_last,
          video_last1 AS video_last,
          video_sd_last1 AS video_sd_last,
          video_hd_last1 AS video_hd_last,
          video_hdp_last1 AS video_hdp_last,
          host_sd_last1 AS host_video_sd_last,
          audience_sd_last1 AS audience_video_sd_last,
          host_hd_last1 AS host_video_hd_last,
          audience_hd_last1 AS audience_video_hd_last,
          host_hdp_last1 AS host_video_hdp_last,
          audience_hdp_last1 AS audience_video_hdp_last,
          host_audio_last1 AS host_audio_last,
          audience_audio_last1 AS audience_audio_last,
          host_video_last1 AS host_video_last,
          audience_video_last1 AS audience_video_last,
          audience_audio_low_latency_last1 AS audience_audio_low_latency_last,
          audience_video_low_latency_last1 AS audience_video_low_latency_last,
          audience_total_low_latency_last1 AS audience_total_low_latency_last,
          audience_sd_low_latency_last1 AS audience_sd_low_latency_last,
          audience_hd_low_latency_last1 AS audience_hd_low_latency_last,
          audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,
          audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,
          audience_2k_low_latency_last1 AS audience_2k_low_latency_last,
          audience_4k_low_latency_last1 AS audience_4k_low_latency_last,
          audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,
          audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,
          audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,
          audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,
          audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,
          audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,
          audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,
          audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,
          audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,
          audience_2k_last1 AS audience_2k_last,
          audience_4k_last1 AS audience_4k_last,
          audience_1080p_last1 AS audience_1080p_last,
          host_1080p_last1 AS host_1080p_last,
          host_2k_last1 AS host_2k_last,
          host_4k_last1 AS host_4k_last,
          total_last7,
          audio_last7,
          video_last7,
          video_sd_last7,
          video_hd_last7,
          video_hdp_last7,
          host_sd_last7,
          audience_sd_last7,
          host_hd_last7,
          audience_hd_last7,
          host_hdp_last7,
          audience_hdp_last7,
          host_audio_last7,
          audience_audio_last7,
          host_video_last7,
          audience_video_last7,
          audience_audio_low_latency_last7,
          audience_video_low_latency_last7,
          audience_total_low_latency_last7,
          audience_sd_low_latency_last7,
          audience_hd_low_latency_last7,
          audience_hdp_low_latency_last7,
          audience_1080p_low_latency_last7,
          audience_2k_low_latency_last7,
          audience_4k_low_latency_last7,
          audience_audio_ultra_low_latency_last7,
          audience_video_ultra_low_latency_last7,
          audience_total_ultra_low_latency_last7,
          audience_sd_ultra_low_latency_last7,
          audience_hd_ultra_low_latency_last7,
          audience_hdp_ultra_low_latency_last7,
          audience_1080p_ultra_low_latency_last7,
          audience_2k_ultra_low_latency_last7,
          audience_4k_ultra_low_latency_last7,
          audience_2k_last7,
          audience_4k_last7,
          audience_1080p_last7,
          host_1080p_last7,
          host_2k_last7,
          host_4k_last7
        FROM levels_usage_dod_di_1
        WHERE CAST(tag AS VARCHAR) = 'Industry' AND date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-06') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-04') AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS ""自定义 SQL 查询""
    HAVING COUNT(1) > 0) AS ""t0""
WHERE ""自定义 SQL 查询"".""dim"" = 1 AND date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d') = ""t0"".""__measure__0""
GROUP BY 1"
"SELECT SUM(""自定义 SQL 查询"".""host_4k_last"") AS ""TEMP(Calculation_3519281700083154949)(101123376)(0)"",
  SUM(""自定义 SQL 查询"".""host_4k"") AS ""TEMP(Calculation_3519281700083154949)(1075454865)(0)"",
  SUM(""自定义 SQL 查询"".""audience_sd"") AS ""TEMP(Calculation_3519281700083154949)(1133678835)(0)"",
  SUM(""自定义 SQL 查询"".""audience_video_hdp_last"") AS ""TEMP(Calculation_3519281700083154949)(1200517625)(0)"",
  SUM(""自定义 SQL 查询"".""host_1080p"") AS ""TEMP(Calculation_3519281700083154949)(1312501967)(0)"",
  SUM(""自定义 SQL 查询"".""audience_1080p_last"") AS ""TEMP(Calculation_3519281700083154949)(1314346200)(0)"",
  SUM(""自定义 SQL 查询"".""audience_video_hd_last"") AS ""TEMP(Calculation_3519281700083154949)(146570423)(0)"",
  SUM(""自定义 SQL 查询"".""audience_2k_last"") AS ""TEMP(Calculation_3519281700083154949)(1717771635)(0)"",
  SUM(""自定义 SQL 查询"".""audience_audio_last"") AS ""TEMP(Calculation_3519281700083154949)(2313111073)(0)"",
  SUM(""自定义 SQL 查询"".""host_video_hdp_last"") AS ""TEMP(Calculation_3519281700083154949)(258310559)(0)"",
  SUM(""自定义 SQL 查询"".""host_hd"") AS ""TEMP(Calculation_3519281700083154949)(276907208)(0)"",
  SUM(""自定义 SQL 查询"".""audio_video_last"") AS ""TEMP(Calculation_3519281700083154949)(2820618408)(0)"",
  SUM(""自定义 SQL 查询"".""video"") AS ""TEMP(Calculation_3519281700083154949)(2929708110)(0)"",
  SUM(""自定义 SQL 查询"".""audience_hd"") AS ""TEMP(Calculation_3519281700083154949)(2930728935)(0)"",
  SUM(""自定义 SQL 查询"".""audience_hdp"") AS ""TEMP(Calculation_3519281700083154949)(3010533957)(0)"",
  SUM(""自定义 SQL 查询"".""host_hdp"") AS ""TEMP(Calculation_3519281700083154949)(30306054)(0)"",
  SUM(""自定义 SQL 查询"".""host_audio"") AS ""TEMP(Calculation_3519281700083154949)(3087054365)(0)"",
  SUM(""自定义 SQL 查询"".""audience_4k_last"") AS ""TEMP(Calculation_3519281700083154949)(3121859593)(0)"",
  SUM(""自定义 SQL 查询"".""host_1080p_last"") AS ""TEMP(Calculation_3519281700083154949)(3222422303)(0)"",
  SUM(""自定义 SQL 查询"".""host_audio_last"") AS ""TEMP(Calculation_3519281700083154949)(3227677803)(0)"",
  SUM(""自定义 SQL 查询"".""audio"") AS ""TEMP(Calculation_3519281700083154949)(3299350010)(0)"",
  SUM(""自定义 SQL 查询"".""audience_1080p"") AS ""TEMP(Calculation_3519281700083154949)(3628946582)(0)"",
  SUM(""自定义 SQL 查询"".""totalUsage"") AS ""TEMP(Calculation_3519281700083154949)(3847882359)(0)"",
  SUM(""自定义 SQL 查询"".""video_last"") AS ""TEMP(Calculation_3519281700083154949)(3934387163)(0)"",
  SUM(""自定义 SQL 查询"".""host_2k_last"") AS ""TEMP(Calculation_3519281700083154949)(4055292783)(0)"",
  SUM(""自定义 SQL 查询"".""audio_last"") AS ""TEMP(Calculation_3519281700083154949)(4091190060)(0)"",
  SUM(""自定义 SQL 查询"".""audience_audio"") AS ""TEMP(Calculation_3519281700083154949)(4109514392)(0)"",
  SUM(""自定义 SQL 查询"".""host_video_hd_last"") AS ""TEMP(Calculation_3519281700083154949)(4170367250)(0)"",
  SUM(""自定义 SQL 查询"".""host_video_sd_last"") AS ""TEMP(Calculation_3519281700083154949)(4190307025)(0)"",
  SUM(""自定义 SQL 查询"".""host_2k"") AS ""TEMP(Calculation_3519281700083154949)(586790827)(0)"",
  SUM(""自定义 SQL 查询"".""host_sd"") AS ""TEMP(Calculation_3519281700083154949)(709512178)(0)"",
  SUM(""自定义 SQL 查询"".""audience_4k"") AS ""TEMP(Calculation_3519281700083154949)(764410224)(0)"",
  SUM(""自定义 SQL 查询"".""audience_video_sd_last"") AS ""TEMP(Calculation_3519281700083154949)(933007102)(0)"",
  SUM(""自定义 SQL 查询"".""audience_2k"") AS ""TEMP(Calculation_3519281700083154949)(943764407)(0)"",
  AVG(""自定义 SQL 查询"".""totalUsage"") AS ""avg_totalUsage_ok"",
  ""自定义 SQL 查询"".""level1"" AS ""level1"",
  SUM(""自定义 SQL 查询"".""totalUsage"") AS ""sum_totalUsage_ok""
FROM (SELECT date,
        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,
      start_date AS start_date_7,
      end_date AS end_date,
      tag,
      area AS Scope,
      dim,
        CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,
      level2,
      level3,
      level4,
      product_level1 AS product_line,
      product_level2,
      product_level3,
      product_level4,
      vid_internal_industry_en AS cid_industry,
      vid_use_case_en AS vid_use_case_cn,
      vid_sector_en,
      ver_type,
      ver,
      os,
      domain,
      country,
      region,
      dim_grouping_name,
        CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,
      total AS totalUsage,
      audio,
      video,
      host_audio,
      audience_audio,
      host_sd,
      host_hd,
      host_hdp,
      host_1080p,
      host_2k,
      host_4k,
      audience_sd,
      audience_hd,
      audience_hdp,
      audience_1080p,
      audience_2k,
      audience_4k,
      audience_audio_low_latency,
      audience_sd_low_latency,
      audience_hd_low_latency,
      audience_hdp_low_latency,
      audience_1080p_low_latency,
      audience_2k_low_latency,
      audience_4k_low_latency,
      audience_audio_ultra_low_latency,
      audience_sd_ultra_low_latency,
      audience_hd_ultra_low_latency,
      audience_hdp_ultra_low_latency,
      audience_1080p_ultra_low_latency,
      audience_2k_ultra_low_latency,
      audience_4k_ultra_low_latency,
      total_last1 AS audio_video_last,
      audio_last1 AS audio_last,
      video_last1 AS video_last,
      video_sd_last1 AS video_sd_last,
      video_hd_last1 AS video_hd_last,
      video_hdp_last1 AS video_hdp_last,
      host_sd_last1 AS host_video_sd_last,
      audience_sd_last1 AS audience_video_sd_last,
      host_hd_last1 AS host_video_hd_last,
      audience_hd_last1 AS audience_video_hd_last,
      host_hdp_last1 AS host_video_hdp_last,
      audience_hdp_last1 AS audience_video_hdp_last,
      host_audio_last1 AS host_audio_last,
      audience_audio_last1 AS audience_audio_last,
      host_video_last1 AS host_video_last,
      audience_video_last1 AS audience_video_last,
      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,
      audience_video_low_latency_last1 AS audience_video_low_latency_last,
      audience_total_low_latency_last1 AS audience_total_low_latency_last,
      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,
      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,
      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,
      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,
      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,
      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,
      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,
      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,
      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,
      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,
      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,
      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,
      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,
      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,
      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,
      audience_2k_last1 AS audience_2k_last,
      audience_4k_last1 AS audience_4k_last,
      audience_1080p_last1 AS audience_1080p_last,
      host_1080p_last1 AS host_1080p_last,
      host_2k_last1 AS host_2k_last,
      host_4k_last1 AS host_4k_last,
      total_last7,
      audio_last7,
      video_last7,
      video_sd_last7,
      video_hd_last7,
      video_hdp_last7,
      host_sd_last7,
      audience_sd_last7,
      host_hd_last7,
      audience_hd_last7,
      host_hdp_last7,
      audience_hdp_last7,
      host_audio_last7,
      audience_audio_last7,
      host_video_last7,
      audience_video_last7,
      audience_audio_low_latency_last7,
      audience_video_low_latency_last7,
      audience_total_low_latency_last7,
      audience_sd_low_latency_last7,
      audience_hd_low_latency_last7,
      audience_hdp_low_latency_last7,
      audience_1080p_low_latency_last7,
      audience_2k_low_latency_last7,
      audience_4k_low_latency_last7,
      audience_audio_ultra_low_latency_last7,
      audience_video_ultra_low_latency_last7,
      audience_total_ultra_low_latency_last7,
      audience_sd_ultra_low_latency_last7,
      audience_hd_ultra_low_latency_last7,
      audience_hdp_ultra_low_latency_last7,
      audience_1080p_ultra_low_latency_last7,
      audience_2k_ultra_low_latency_last7,
      audience_4k_ultra_low_latency_last7,
      audience_2k_last7,
      audience_4k_last7,
      audience_1080p_last7,
      host_1080p_last7,
      host_2k_last7,
      host_4k_last7
    FROM levels_usage_dod_di_1
    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-06') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-04') AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS ""自定义 SQL 查询""
  CROSS JOIN (SELECT MAX(date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d')) AS ""__measure__0""
    FROM (SELECT date,
            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,
          start_date AS start_date_7,
          end_date AS end_date,
          tag,
          area AS Scope,
          dim,
            CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,
          level2,
          level3,
          level4,
          product_level1 AS product_line,
          product_level2,
          product_level3,
          product_level4,
          vid_internal_industry_en AS cid_industry,
          vid_use_case_en AS vid_use_case_cn,
          vid_sector_en,
          ver_type,
          ver,
          os,
          domain,
          country,
          region,
          dim_grouping_name,
            CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,
          total AS totalUsage,
          audio,
          video,
          host_audio,
          audience_audio,
          host_sd,
          host_hd,
          host_hdp,
          host_1080p,
          host_2k,
          host_4k,
          audience_sd,
          audience_hd,
          audience_hdp,
          audience_1080p,
          audience_2k,
          audience_4k,
          audience_audio_low_latency,
          audience_sd_low_latency,
          audience_hd_low_latency,
          audience_hdp_low_latency,
          audience_1080p_low_latency,
          audience_2k_low_latency,
          audience_4k_low_latency,
          audience_audio_ultra_low_latency,
          audience_sd_ultra_low_latency,
          audience_hd_ultra_low_latency,
          audience_hdp_ultra_low_latency,
          audience_1080p_ultra_low_latency,
          audience_2k_ultra_low_latency,
          audience_4k_ultra_low_latency,
          total_last1 AS audio_video_last,
          audio_last1 AS audio_last,
          video_last1 AS video_last,
          video_sd_last1 AS video_sd_last,
          video_hd_last1 AS video_hd_last,
          video_hdp_last1 AS video_hdp_last,
          host_sd_last1 AS host_video_sd_last,
          audience_sd_last1 AS audience_video_sd_last,
          host_hd_last1 AS host_video_hd_last,
          audience_hd_last1 AS audience_video_hd_last,
          host_hdp_last1 AS host_video_hdp_last,
          audience_hdp_last1 AS audience_video_hdp_last,
          host_audio_last1 AS host_audio_last,
          audience_audio_last1 AS audience_audio_last,
          host_video_last1 AS host_video_last,
          audience_video_last1 AS audience_video_last,
          audience_audio_low_latency_last1 AS audience_audio_low_latency_last,
          audience_video_low_latency_last1 AS audience_video_low_latency_last,
          audience_total_low_latency_last1 AS audience_total_low_latency_last,
          audience_sd_low_latency_last1 AS audience_sd_low_latency_last,
          audience_hd_low_latency_last1 AS audience_hd_low_latency_last,
          audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,
          audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,
          audience_2k_low_latency_last1 AS audience_2k_low_latency_last,
          audience_4k_low_latency_last1 AS audience_4k_low_latency_last,
          audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,
          audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,
          audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,
          audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,
          audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,
          audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,
          audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,
          audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,
          audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,
          audience_2k_last1 AS audience_2k_last,
          audience_4k_last1 AS audience_4k_last,
          audience_1080p_last1 AS audience_1080p_last,
          host_1080p_last1 AS host_1080p_last,
          host_2k_last1 AS host_2k_last,
          host_4k_last1 AS host_4k_last,
          total_last7,
          audio_last7,
          video_last7,
          video_sd_last7,
          video_hd_last7,
          video_hdp_last7,
          host_sd_last7,
          audience_sd_last7,
          host_hd_last7,
          audience_hd_last7,
          host_hdp_last7,
          audience_hdp_last7,
          host_audio_last7,
          audience_audio_last7,
          host_video_last7,
          audience_video_last7,
          audience_audio_low_latency_last7,
          audience_video_low_latency_last7,
          audience_total_low_latency_last7,
          audience_sd_low_latency_last7,
          audience_hd_low_latency_last7,
          audience_hdp_low_latency_last7,
          audience_1080p_low_latency_last7,
          audience_2k_low_latency_last7,
          audience_4k_low_latency_last7,
          audience_audio_ultra_low_latency_last7,
          audience_video_ultra_low_latency_last7,
          audience_total_ultra_low_latency_last7,
          audience_sd_ultra_low_latency_last7,
          audience_hd_ultra_low_latency_last7,
          audience_hdp_ultra_low_latency_last7,
          audience_1080p_ultra_low_latency_last7,
          audience_2k_ultra_low_latency_last7,
          audience_4k_ultra_low_latency_last7,
          audience_2k_last7,
          audience_4k_last7,
          audience_1080p_last7,
          host_1080p_last7,
          host_2k_last7,
          host_4k_last7
        FROM levels_usage_dod_di_1
        WHERE CAST(tag AS VARCHAR) = 'Industry' AND date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-06') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-04') AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS ""自定义 SQL 查询""
    HAVING COUNT(1) > 0) AS ""t0""
WHERE ""自定义 SQL 查询"".""dim"" = 1 AND ""自定义 SQL 查询"".""rank_level1"" = 7 AND date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d') = ""t0"".""__measure__0""
GROUP BY 36"
"SELECT '跳转：音频可用性' AS ""Calculation_5876704998653468673""
FROM (SELECT date,
        CASE WHEN CAST(stat_period AS VARCHAR) = 'day' THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(substr(CAST(start_date AS VARCHAR), 1, 10) AS VARCHAR), '~', CAST(substr(CAST(end_date AS VARCHAR), 1, 10) AS VARCHAR)) END AS period,
      start_date,
      end_date,
      stat_period,
      tag,
      dim,
      level1,
      level2,
      level3,
      level4,
      '' AS pd,
      os,
      ver,
      ver_type,
      '' AS product_line,
      '' AS product_type,
      domain,
      country,
      region,
      net,
      vid,
      project,
      company_id,
      company_name,
      rowsnum,
      lastusage,
      thisusage,
      fiveSecJoinSuccess,
      totalJoin,
      cnt_sid,
      video_freeze_time,
      video_totaltime,
      audio_freeze_time,
      audio_totaltime,
      s2l_total_delay_sec,
      s2l_25ms_delay_sec,
      s2l_75ms_delay_sec,
      p2s_lost_Leq5,
      p2s_lost_all,
      crash_cnt,
      service_cnt,
      ""1s_succ_join_ap_cnt"",
      ""5s_succ_join_ap_cnt"",
      total_join_ap_cnt,
      totalJoinSuccess,
      threeSecJoinSuccess,
      video_freeze_time_200,
      video_totaltime_200,
      video_freeze_time_500,
      video_totaltime_500,
      ""3s_succ_join_session_cnt_last1"",
      ""5s_succ_join_session_cnt_last1"",
      succ_join_session_cnt_last1,
      total_join_session_cnt_last1,
      total_session_cnt_last1,
      ""1s_succ_join_ap_cnt_last1"",
      ""5s_succ_join_ap_cnt_last1"",
      total_join_ap_cnt_last1,
      ""3s_succ_join_session_cnt_last7"",
      ""5s_succ_join_session_cnt_last7"",
      succ_join_session_cnt_last7,
      total_join_session_cnt_last7,
      total_session_cnt_last7,
      ""1s_succ_join_ap_cnt_last7"",
      ""5s_succ_join_ap_cnt_last7"",
      total_join_ap_cnt_last7,
      video_freeze_time_last1,
      video_totaltime_last1,
      video_freeze_time_500_last1,
      video_totaltime_500_last1,
      video_freeze_time_200_last1,
      video_totaltime_200_last1,
      video_freeze_time_last7,
      video_totaltime_last7,
      video_freeze_time_500_last7,
      video_totaltime_500_last7,
      video_freeze_time_200_last7,
      video_totaltime_200_last7,
      audio_freeze_time_last1,
      audio_totaltime_last1,
      audio_freeze_time_last7,
      audio_totaltime_last7,
      s2l_total_delay_sec_last1,
      s2l_25ms_delay_sec_last1,
      s2l_75ms_delay_sec_last1,
      s2l_total_delay_sec_last7,
      s2l_25ms_delay_sec_last7,
      s2l_75ms_delay_sec_last7,
      p2s_lost_Leq5_last1,
      p2s_lost_all_last1,
      p2s_lost_Leq5_last7,
      p2s_lost_all_last7,
      crash_cnt_last1,
      service_cnt_last1,
      crash_cnt_last7,
      service_cnt_last7,
      product_level1,
      product_level2,
      product_level3,
      product_level4,
      s2l_lost_Leq5,
      s2l_lost_all,
      s2l_lost_Leq5_last1,
      s2l_lost_all_last1,
      s2l_lost_Leq5_last7,
      s2l_lost_all_last7
    FROM report_datahub.pub_levels_quality_di_1
    WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-21') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-11-21')) AS ""自定义 SQL 查询""
HAVING COUNT(1) > 0"
"SELECT SUM(""自定义 SQL 查询"".""s2l_25ms_delay_sec"") AS ""TEMP(Calculation_1430244791154503680)(2227145667)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_total_delay_sec"") AS ""TEMP(Calculation_1430244791154503680)(2460078802)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_total_delay_sec_last1"") AS ""TEMP(Calculation_1430244791161831425)(1533897333)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_25ms_delay_sec_last1"") AS ""TEMP(Calculation_1430244791161831425)(3105382701)(0)"",
  SUM(""自定义 SQL 查询"".""5s_succ_join_ap_cnt"") AS ""TEMP(Calculation_1430244791247978510)(1716451703)(0)"",
  SUM(""自定义 SQL 查询"".""total_join_ap_cnt"") AS ""TEMP(Calculation_1430244791247978510)(2681092799)(0)"",
  SUM(""自定义 SQL 查询"".""5s_succ_join_ap_cnt_last1"") AS ""TEMP(Calculation_1430244791248527375)(865560869)(0)"",
  SUM(""自定义 SQL 查询"".""total_join_ap_cnt_last1"") AS ""TEMP(Calculation_1430244791248527375)(97423155)(0)"",
  SUM(""自定义 SQL 查询"".""video_totaltime_200"") AS ""TEMP(Calculation_3430124447289356289)(2104207895)(0)"",
  SUM(""自定义 SQL 查询"".""video_freeze_time_200"") AS ""TEMP(Calculation_3430124447289356289)(530162565)(0)"",
  SUM(""自定义 SQL 查询"".""video_freeze_time_500"") AS ""TEMP(Calculation_3430124447289524226)(389023081)(0)"",
  SUM(""自定义 SQL 查询"".""video_totaltime_500"") AS ""TEMP(Calculation_3430124447289524226)(458654145)(0)"",
  SUM(""自定义 SQL 查询"".""video_totaltime_200_last1"") AS ""TEMP(Calculation_3430124447289634819)(1909093697)(0)"",
  SUM(""自定义 SQL 查询"".""video_freeze_time_200_last1"") AS ""TEMP(Calculation_3430124447289634819)(356123728)(0)"",
  SUM(""自定义 SQL 查询"".""video_freeze_time_200_last7"") AS ""TEMP(Calculation_3430124447291072516)(1003246719)(0)"",
  SUM(""自定义 SQL 查询"".""video_totaltime_200_last7"") AS ""TEMP(Calculation_3430124447291072516)(3922744675)(0)"",
  SUM(""自定义 SQL 查询"".""video_totaltime_500_last1"") AS ""TEMP(Calculation_3430124447291166725)(3425883446)(0)"",
  SUM(""自定义 SQL 查询"".""video_freeze_time_500_last1"") AS ""TEMP(Calculation_3430124447291166725)(3450234468)(0)"",
  SUM(""自定义 SQL 查询"".""video_freeze_time_500_last7"") AS ""TEMP(Calculation_3430124447291371526)(1458194667)(0)"",
  SUM(""自定义 SQL 查询"".""video_totaltime_500_last7"") AS ""TEMP(Calculation_3430124447291371526)(2161412938)(0)"",
  SUM(""自定义 SQL 查询"".""totalJoin"") AS ""TEMP(Calculation_374009936508170240)(2073556184)(0)"",
  SUM(""自定义 SQL 查询"".""totalJoinSuccess"") AS ""TEMP(Calculation_374009936508170240)(2807417001)(0)"",
  SUM(""自定义 SQL 查询"".""threeSecJoinSuccess"") AS ""TEMP(Calculation_374009936508321793)(3693645608)(0)"",
  SUM(""自定义 SQL 查询"".""fiveSecJoinSuccess"") AS ""TEMP(Calculation_374009936508416002)(383616769)(0)"",
  SUM(""自定义 SQL 查询"".""video_totaltime"") AS ""TEMP(Calculation_374009936515215363)(2797449586)(0)"",
  SUM(""自定义 SQL 查询"".""video_freeze_time"") AS ""TEMP(Calculation_374009936515215363)(2940759860)(0)"",
  SUM(""自定义 SQL 查询"".""audio_freeze_time_200"") AS ""TEMP(Calculation_374009936517861380)(1946708283)(0)"",
  SUM(""自定义 SQL 查询"".""audio_totaltime_200"") AS ""TEMP(Calculation_374009936517861380)(784477006)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_lost_Leq5"") AS ""TEMP(Calculation_374009936519704581)(1936123547)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_lost_all"") AS ""TEMP(Calculation_374009936519704581)(749826584)(0)"",
  SUM(""自定义 SQL 查询"".""total_join_session_cnt_last1"") AS ""TEMP(Calculation_374009936523853831)(2708102775)(0)"",
  SUM(""自定义 SQL 查询"".""succ_join_session_cnt_last1"") AS ""TEMP(Calculation_374009936523853831)(929207889)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_75ms_delay_sec"") AS ""TEMP(Calculation_6542393318886285312)(2003933318)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_total_delay_sec_last1"") AS ""TEMP(Calculation_6542393318886735875)(3088956105)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_75ms_delay_sec_last1"") AS ""TEMP(Calculation_6542393318886735875)(602483182)(0)"",
  SUM(""自定义 SQL 查询"".""3s_succ_join_session_cnt_last1"") AS ""TEMP(Calculation_7034341207020355584)(2445597373)(0)"",
  SUM(""自定义 SQL 查询"".""5s_succ_join_session_cnt_last1"") AS ""TEMP(Calculation_7034341207023706114)(2534022291)(0)"",
  SUM(""自定义 SQL 查询"".""video_totaltime_last1"") AS ""TEMP(Calculation_7034341207025315846)(1221500367)(0)"",
  SUM(""自定义 SQL 查询"".""video_freeze_time_last1"") AS ""TEMP(Calculation_7034341207025315846)(3506758486)(0)"",
  SUM(""自定义 SQL 查询"".""audio_freeze_time_200_last1"") AS ""TEMP(Calculation_7034341207025774600)(2924651060)(0)"",
  SUM(""自定义 SQL 查询"".""audio_totaltime_200_last1"") AS ""TEMP(Calculation_7034341207025774600)(3563519446)(0)"",
  SUM(""自定义 SQL 查询"".""crash_cnt"") AS ""TEMP(Calculation_7034341207372070925)(2360900687)(0)"",
  SUM(""自定义 SQL 查询"".""service_cnt"") AS ""TEMP(Calculation_7034341207372070925)(4291252132)(0)"",
  SUM(""自定义 SQL 查询"".""service_cnt_last1"") AS ""TEMP(Calculation_7034341207372197902)(2436060403)(0)"",
  SUM(""自定义 SQL 查询"".""crash_cnt_last1"") AS ""TEMP(Calculation_7034341207372197902)(651130603)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_lost_all_last1"") AS ""TEMP(Calculation_75998310509129730)(1975694301)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_lost_Leq5_last1"") AS ""TEMP(Calculation_75998310509129730)(1982054307)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_lost_Leq5"") AS ""TEMP(Calculation_939915332871118850)(2745840127)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_lost_all"") AS ""TEMP(Calculation_939915332871118850)(734589263)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_lost_all_last1"") AS ""TEMP(Calculation_939915332871299075)(3978556066)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_lost_Leq5_last1"") AS ""TEMP(Calculation_939915332871299075)(700826822)(0)""
FROM (SELECT ts.*,
      fiveSecJoinSuccess_total,
      threeSecJoinSuccess_total,
      totalJoinSuccess_total,
      totalJoin_total,
      cnt_sid_total,
      ""1s_succ_join_ap_cnt_total"",
      ""5s_succ_join_ap_cnt_total"",
      total_join_ap_cnt_total,
      audio_freeze_time_200_total,
      audio_totaltime_200_total,
      video_freeze_time_total,
      video_totaltime_total,
      p2s_lost_Leq5_total,
      p2s_lost_all_total,
      s2l_25ms_delay_sec_total,
      s2l_75ms_delay_sec_total,
      s2l_total_delay_sec_total,
      crash_cnt_total,
      service_cnt_total,
      ""5s_succ_join_session_cnt_last1_total"",
      ""3s_succ_join_session_cnt_last1_total"",
      succ_join_session_cnt_last1_total,
      total_join_session_cnt_last1_total,
      total_session_cnt_last1_total,
      ""1s_succ_join_ap_cnt_last1_total"",
      ""5s_succ_join_ap_cnt_last1_total"",
      total_join_ap_cnt_last1_total,
      video_freeze_time_last1_total,
      video_totaltime_last1_total,
      p2s_lost_Leq5_last1_total,
      p2s_lost_all_last1_total,
      s2l_25ms_delay_sec_last1_total,
      s2l_75ms_delay_sec_last1_total,
      s2l_total_delay_sec_last1_total,
      crash_cnt_last1_total,
      service_cnt_last1_total,
      audio_freeze_time_200_last1_total,
      audio_totaltime_200_last1_total,
      ""5s_succ_join_session_cnt_last7_total"",
      ""3s_succ_join_session_cnt_last7_total"",
      succ_join_session_cnt_last7_total,
      total_join_session_cnt_last7_total,
      total_session_cnt_last7_total,
      ""7s_succ_join_ap_cnt_last7_total"",
      ""5s_succ_join_ap_cnt_last7_total"",
      total_join_ap_cnt_last7_total,
      video_freeze_time_last7_total,
      video_totaltime_last7_total,
      p2s_lost_Leq5_last7_total,
      p2s_lost_all_last7_total,
      s2l_25ms_delay_sec_last7_total,
      s2l_75ms_delay_sec_last7_total,
      s2l_total_delay_sec_last7_total,
      crash_cnt_last7_total,
      service_cnt_last7_total,
      audio_freeze_time_200_last7_total,
      audio_totaltime_200_last7_total,
      video_freeze_time_500_total,
      video_totaltime_500_total,
      video_freeze_time_200_total,
      video_totaltime_200_total,
      video_freeze_time_500_last1_total,
      video_totaltime_500_last1_total,
      video_freeze_time_200_last1_total,
      video_totaltime_200_last1_total,
      video_freeze_time_500_last7_total,
      video_totaltime_500_last7_total,
      video_freeze_time_200_last7_total,
      video_totaltime_200_last7_total,
      s2l_lost_Leq5_total,
      s2l_lost_all_total,
      s2l_lost_Leq5_last1_total,
      s2l_lost_all_last1_total,
      s2l_lost_Leq5_last7_total,
      s2l_lost_all_last7_total
    FROM (SELECT vid,
          project,
          company_id,
          area,
          company_name,
          industry_name,
          date,
            CASE WHEN CAST(stat_period AS VARCHAR) = 'day' THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(substr(CAST(start_date AS VARCHAR), 1, 10) AS VARCHAR), '~', CAST(substr(CAST(end_date AS VARCHAR), 1, 10) AS VARCHAR)) END AS period,
          net,
          os,
          ver,
          'osver' AS dim,
          product_level_1,
          product_level_2,
          ver_type,
          SUM(fiveSecJoinSuccess) AS fiveSecJoinSuccess,
          SUM(threeSecJoinSuccess) AS threeSecJoinSuccess,
          SUM(totalJoinSuccess) AS totalJoinSuccess,
          SUM(totalJoin) AS totalJoin,
          SUM(cnt_sid) AS cnt_sid,
          SUM(""1s_succ_join_ap_cnt"") AS ""1s_succ_join_ap_cnt"",
          SUM(""5s_succ_join_ap_cnt"") AS ""5s_succ_join_ap_cnt"",
          SUM(total_join_ap_cnt) AS total_join_ap_cnt,
          SUM(audio_freeze_time_200) AS audio_freeze_time_200,
          SUM(audio_totaltime_200) AS audio_totaltime_200,
          SUM(video_freeze_time) AS video_freeze_time,
          SUM(video_totaltime) AS video_totaltime,
          SUM(p2s_lost_Leq5) AS p2s_lost_Leq5,
          SUM(p2s_lost_all) AS p2s_lost_all,
          SUM(s2l_25ms_delay_sec) AS s2l_25ms_delay_sec,
          SUM(s2l_75ms_delay_sec) AS s2l_75ms_delay_sec,
          SUM(s2l_total_delay_sec) AS s2l_total_delay_sec,
          SUM(crash_cnt) AS crash_cnt,
          SUM(service_cnt) AS service_cnt,
          SUM(""5s_succ_join_session_cnt_last1"") AS ""5s_succ_join_session_cnt_last1"",
          SUM(""3s_succ_join_session_cnt_last1"") AS ""3s_succ_join_session_cnt_last1"",
          SUM(succ_join_session_cnt_last1) AS succ_join_session_cnt_last1,
          SUM(total_join_session_cnt_last1) AS total_join_session_cnt_last1,
          SUM(total_session_cnt_last1) AS total_session_cnt_last1,
          SUM(""1s_succ_join_ap_cnt_last1"") AS ""1s_succ_join_ap_cnt_last1"",
          SUM(""5s_succ_join_ap_cnt_last1"") AS ""5s_succ_join_ap_cnt_last1"",
          SUM(total_join_ap_cnt_last1) AS total_join_ap_cnt_last1,
          SUM(video_freeze_time_last1) AS video_freeze_time_last1,
          SUM(video_totaltime_last1) AS video_totaltime_last1,
          SUM(p2s_lost_Leq5_last1) AS p2s_lost_Leq5_last1,
          SUM(p2s_lost_all_last1) AS p2s_lost_all_last1,
          SUM(s2l_25ms_delay_sec_last1) AS s2l_25ms_delay_sec_last1,
          SUM(s2l_75ms_delay_sec_last1) AS s2l_75ms_delay_sec_last1,
          SUM(s2l_total_delay_sec_last1) AS s2l_total_delay_sec_last1,
          SUM(crash_cnt_last1) AS crash_cnt_last1,
          SUM(service_cnt_last1) AS service_cnt_last1,
          SUM(audio_freeze_time_200_last1) AS audio_freeze_time_200_last1,
          SUM(audio_totaltime_200_last1) AS audio_totaltime_200_last1,
          SUM(""5s_succ_join_session_cnt_last7"") AS ""5s_succ_join_session_cnt_last7"",
          SUM(""3s_succ_join_session_cnt_last7"") AS ""3s_succ_join_session_cnt_last7"",
          SUM(succ_join_session_cnt_last7) AS succ_join_session_cnt_last7,
          SUM(total_join_session_cnt_last7) AS total_join_session_cnt_last7,
          SUM(total_session_cnt_last7) AS total_session_cnt_last7,
          SUM(""1s_succ_join_ap_cnt_last7"") AS ""7s_succ_join_ap_cnt_last7"",
          SUM(""5s_succ_join_ap_cnt_last7"") AS ""5s_succ_join_ap_cnt_last7"",
          SUM(total_join_ap_cnt_last7) AS total_join_ap_cnt_last7,
          SUM(video_freeze_time_last7) AS video_freeze_time_last7,
          SUM(video_totaltime_last7) AS video_totaltime_last7,
          SUM(p2s_lost_Leq5_last7) AS p2s_lost_Leq5_last7,
          SUM(p2s_lost_all_last7) AS p2s_lost_all_last7,
          SUM(s2l_25ms_delay_sec_last7) AS s2l_25ms_delay_sec_last7,
          SUM(s2l_75ms_delay_sec_last7) AS s2l_75ms_delay_sec_last7,
          SUM(s2l_total_delay_sec_last7) AS s2l_total_delay_sec_last7,
          SUM(crash_cnt_last7) AS crash_cnt_last7,
          SUM(service_cnt_last7) AS service_cnt_last7,
          SUM(audio_freeze_time_200_last7) AS audio_freeze_time_200_last7,
          SUM(audio_totaltime_200_last7) AS audio_totaltime_200_last7,
          SUM(video_freeze_time_500) AS video_freeze_time_500,
          SUM(video_totaltime_500) AS video_totaltime_500,
          SUM(video_freeze_time_200) AS video_freeze_time_200,
          SUM(video_totaltime_200) AS video_totaltime_200,
          SUM(video_freeze_time_500_last1) AS video_freeze_time_500_last1,
          SUM(video_totaltime_500_last1) AS video_totaltime_500_last1,
          SUM(video_freeze_time_200_last1) AS video_freeze_time_200_last1,
          SUM(video_totaltime_200_last1) AS video_totaltime_200_last1,
          SUM(video_freeze_time_500_last7) AS video_freeze_time_500_last7,
          SUM(video_totaltime_500_last7) AS video_totaltime_500_last7,
          SUM(video_freeze_time_200_last7) AS video_freeze_time_200_last7,
          SUM(video_totaltime_200_last7) AS video_totaltime_200_last7,
          SUM(s2l_lost_Leq5) AS s2l_lost_Leq5,
          SUM(s2l_lost_all) AS s2l_lost_all,
          SUM(s2l_lost_Leq5_last1) AS s2l_lost_Leq5_last1,
          SUM(s2l_lost_all_last1) AS s2l_lost_all_last1,
          SUM(s2l_lost_Leq5_last7) AS s2l_lost_Leq5_last7,
          SUM(s2l_lost_all_last7) AS s2l_lost_all_last7
        FROM report_datahub.vid_osver_net_cp_domain_quality_di_1
        WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-21') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-11-21') AND CAST(vid AS VARCHAR) = CAST(281104 AS VARCHAR) AND CAST(product_level_2 AS VARCHAR) = 'Native'
        GROUP BY vid,
          project,
          company_id,
          area,
          company_name,
          industry_name,
          date,
          net,
          os,
          ver,
          product_level_1,
          product_level_2,
          ver_type,
            CASE WHEN CAST(stat_period AS VARCHAR) = 'day' THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(substr(CAST(start_date AS VARCHAR), 1, 10) AS VARCHAR), '~', CAST(substr(CAST(end_date AS VARCHAR), 1, 10) AS VARCHAR)) END) AS ts
      LEFT JOIN (SELECT vid,
          date,
          SUM(fiveSecJoinSuccess) AS fiveSecJoinSuccess_total,
          SUM(threeSecJoinSuccess) AS threeSecJoinSuccess_total,
          SUM(totalJoinSuccess) AS totalJoinSuccess_total,
          SUM(totalJoin) AS totalJoin_total,
          SUM(cnt_sid) AS cnt_sid_total,
          SUM(""1s_succ_join_ap_cnt"") AS ""1s_succ_join_ap_cnt_total"",
          SUM(""5s_succ_join_ap_cnt"") AS ""5s_succ_join_ap_cnt_total"",
          SUM(total_join_ap_cnt) AS total_join_ap_cnt_total,
          SUM(audio_freeze_time_200) AS audio_freeze_time_200_total,
          SUM(audio_totaltime_200) AS audio_totaltime_200_total,
          SUM(video_freeze_time) AS video_freeze_time_total,
          SUM(video_totaltime) AS video_totaltime_total,
          SUM(p2s_lost_Leq5) AS p2s_lost_Leq5_total,
          SUM(p2s_lost_all) AS p2s_lost_all_total,
          SUM(s2l_25ms_delay_sec) AS s2l_25ms_delay_sec_total,
          SUM(s2l_75ms_delay_sec) AS s2l_75ms_delay_sec_total,
          SUM(s2l_total_delay_sec) AS s2l_total_delay_sec_total,
          SUM(crash_cnt) AS crash_cnt_total,
          SUM(service_cnt) AS service_cnt_total,
          SUM(""5s_succ_join_session_cnt_last1"") AS ""5s_succ_join_session_cnt_last1_total"",
          SUM(""3s_succ_join_session_cnt_last1"") AS ""3s_succ_join_session_cnt_last1_total"",
          SUM(succ_join_session_cnt_last1) AS succ_join_session_cnt_last1_total,
          SUM(total_join_session_cnt_last1) AS total_join_session_cnt_last1_total,
          SUM(total_session_cnt_last1) AS total_session_cnt_last1_total,
          SUM(""1s_succ_join_ap_cnt_last1"") AS ""1s_succ_join_ap_cnt_last1_total"",
          SUM(""5s_succ_join_ap_cnt_last1"") AS ""5s_succ_join_ap_cnt_last1_total"",
          SUM(total_join_ap_cnt_last1) AS total_join_ap_cnt_last1_total,
          SUM(video_freeze_time_last1) AS video_freeze_time_last1_total,
          SUM(video_totaltime_last1) AS video_totaltime_last1_total,
          SUM(p2s_lost_Leq5_last1) AS p2s_lost_Leq5_last1_total,
          SUM(p2s_lost_all_last1) AS p2s_lost_all_last1_total,
          SUM(s2l_25ms_delay_sec_last1) AS s2l_25ms_delay_sec_last1_total,
          SUM(s2l_75ms_delay_sec_last1) AS s2l_75ms_delay_sec_last1_total,
          SUM(s2l_total_delay_sec_last1) AS s2l_total_delay_sec_last1_total,
          SUM(crash_cnt_last1) AS crash_cnt_last1_total,
          SUM(service_cnt_last1) AS service_cnt_last1_total,
          SUM(audio_freeze_time_200_last1) AS audio_freeze_time_200_last1_total,
          SUM(audio_totaltime_200_last1) AS audio_totaltime_200_last1_total,
          SUM(""5s_succ_join_session_cnt_last7"") AS ""5s_succ_join_session_cnt_last7_total"",
          SUM(""3s_succ_join_session_cnt_last7"") AS ""3s_succ_join_session_cnt_last7_total"",
          SUM(succ_join_session_cnt_last7) AS succ_join_session_cnt_last7_total,
          SUM(total_join_session_cnt_last7) AS total_join_session_cnt_last7_total,
          SUM(total_session_cnt_last7) AS total_session_cnt_last7_total,
          SUM(""1s_succ_join_ap_cnt_last7"") AS ""7s_succ_join_ap_cnt_last7_total"",
          SUM(""5s_succ_join_ap_cnt_last7"") AS ""5s_succ_join_ap_cnt_last7_total"",
          SUM(total_join_ap_cnt_last7) AS total_join_ap_cnt_last7_total,
          SUM(video_freeze_time_last7) AS video_freeze_time_last7_total,
          SUM(video_totaltime_last7) AS video_totaltime_last7_total,
          SUM(p2s_lost_Leq5_last7) AS p2s_lost_Leq5_last7_total,
          SUM(p2s_lost_all_last7) AS p2s_lost_all_last7_total,
          SUM(s2l_25ms_delay_sec_last7) AS s2l_25ms_delay_sec_last7_total,
          SUM(s2l_75ms_delay_sec_last7) AS s2l_75ms_delay_sec_last7_total,
          SUM(s2l_total_delay_sec_last7) AS s2l_total_delay_sec_last7_total,
          SUM(crash_cnt_last7) AS crash_cnt_last7_total,
          SUM(service_cnt_last7) AS service_cnt_last7_total,
          SUM(audio_freeze_time_200_last7) AS audio_freeze_time_200_last7_total,
          SUM(audio_totaltime_200_last7) AS audio_totaltime_200_last7_total,
          SUM(video_freeze_time_500) AS video_freeze_time_500_total,
          SUM(video_totaltime_500) AS video_totaltime_500_total,
          SUM(video_freeze_time_200) AS video_freeze_time_200_total,
          SUM(video_totaltime_200) AS video_totaltime_200_total,
          SUM(video_freeze_time_500_last1) AS video_freeze_time_500_last1_total,
          SUM(video_totaltime_500_last1) AS video_totaltime_500_last1_total,
          SUM(video_freeze_time_200_last1) AS video_freeze_time_200_last1_total,
          SUM(video_totaltime_200_last1) AS video_totaltime_200_last1_total,
          SUM(video_freeze_time_500_last7) AS video_freeze_time_500_last7_total,
          SUM(video_totaltime_500_last7) AS video_totaltime_500_last7_total,
          SUM(video_freeze_time_200_last7) AS video_freeze_time_200_last7_total,
          SUM(video_totaltime_200_last7) AS video_totaltime_200_last7_total,
          SUM(s2l_lost_Leq5) AS s2l_lost_Leq5_total,
          SUM(s2l_lost_all) AS s2l_lost_all_total,
          SUM(s2l_lost_Leq5_last1) AS s2l_lost_Leq5_last1_total,
          SUM(s2l_lost_all_last1) AS s2l_lost_all_last1_total,
          SUM(s2l_lost_Leq5_last7) AS s2l_lost_Leq5_last7_total,
          SUM(s2l_lost_all_last7) AS s2l_lost_all_last7_total
        FROM report_datahub.vid_osver_net_cp_domain_quality_di_1
        WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-21') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-11-21') AND CAST(vid AS VARCHAR) = CAST(281104 AS VARCHAR) AND CAST(product_level_2 AS VARCHAR) = 'Native'
        GROUP BY vid,
          date) AS tt ON CAST(ts.vid AS VARCHAR) = CAST(tt.vid AS VARCHAR) AND ts.date = tt.date) AS ""自定义 SQL 查询""
  CROSS JOIN (SELECT MAX(date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d')) AS ""__measure__0""
    FROM (SELECT ts.*,
          fiveSecJoinSuccess_total,
          threeSecJoinSuccess_total,
          totalJoinSuccess_total,
          totalJoin_total,
          cnt_sid_total,
          ""1s_succ_join_ap_cnt_total"",
          ""5s_succ_join_ap_cnt_total"",
          total_join_ap_cnt_total,
          audio_freeze_time_200_total,
          audio_totaltime_200_total,
          video_freeze_time_total,
          video_totaltime_total,
          p2s_lost_Leq5_total,
          p2s_lost_all_total,
          s2l_25ms_delay_sec_total,
          s2l_75ms_delay_sec_total,
          s2l_total_delay_sec_total,
          crash_cnt_total,
          service_cnt_total,
          ""5s_succ_join_session_cnt_last1_total"",
          ""3s_succ_join_session_cnt_last1_total"",
          succ_join_session_cnt_last1_total,
          total_join_session_cnt_last1_total,
          total_session_cnt_last1_total,
          ""1s_succ_join_ap_cnt_last1_total"",
          ""5s_succ_join_ap_cnt_last1_total"",
          total_join_ap_cnt_last1_total,
          video_freeze_time_last1_total,
          video_totaltime_last1_total,
          p2s_lost_Leq5_last1_total,
          p2s_lost_all_last1_total,
          s2l_25ms_delay_sec_last1_total,
          s2l_75ms_delay_sec_last1_total,
          s2l_total_delay_sec_last1_total,
          crash_cnt_last1_total,
          service_cnt_last1_total,
          audio_freeze_time_200_last1_total,
          audio_totaltime_200_last1_total,
          ""5s_succ_join_session_cnt_last7_total"",
          ""3s_succ_join_session_cnt_last7_total"",
          succ_join_session_cnt_last7_total,
          total_join_session_cnt_last7_total,
          total_session_cnt_last7_total,
          ""7s_succ_join_ap_cnt_last7_total"",
          ""5s_succ_join_ap_cnt_last7_total"",
          total_join_ap_cnt_last7_total,
          video_freeze_time_last7_total,
          video_totaltime_last7_total,
          p2s_lost_Leq5_last7_total,
          p2s_lost_all_last7_total,
          s2l_25ms_delay_sec_last7_total,
          s2l_75ms_delay_sec_last7_total,
          s2l_total_delay_sec_last7_total,
          crash_cnt_last7_total,
          service_cnt_last7_total,
          audio_freeze_time_200_last7_total,
          audio_totaltime_200_last7_total,
          video_freeze_time_500_total,
          video_totaltime_500_total,
          video_freeze_time_200_total,
          video_totaltime_200_total,
          video_freeze_time_500_last1_total,
          video_totaltime_500_last1_total,
          video_freeze_time_200_last1_total,
          video_totaltime_200_last1_total,
          video_freeze_time_500_last7_total,
          video_totaltime_500_last7_total,
          video_freeze_time_200_last7_total,
          video_totaltime_200_last7_total,
          s2l_lost_Leq5_total,
          s2l_lost_all_total,
          s2l_lost_Leq5_last1_total,
          s2l_lost_all_last1_total,
          s2l_lost_Leq5_last7_total,
          s2l_lost_all_last7_total
        FROM (SELECT vid,
              project,
              company_id,
              area,
              company_name,
              industry_name,
              date,
                CASE WHEN CAST(stat_period AS VARCHAR) = 'day' THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(substr(CAST(start_date AS VARCHAR), 1, 10) AS VARCHAR), '~', CAST(substr(CAST(end_date AS VARCHAR), 1, 10) AS VARCHAR)) END AS period,
              net,
              os,
              ver,
              'osver' AS dim,
              product_level_1,
              product_level_2,
              ver_type,
              SUM(fiveSecJoinSuccess) AS fiveSecJoinSuccess,
              SUM(threeSecJoinSuccess) AS threeSecJoinSuccess,
              SUM(totalJoinSuccess) AS totalJoinSuccess,
              SUM(totalJoin) AS totalJoin,
              SUM(cnt_sid) AS cnt_sid,
              SUM(""1s_succ_join_ap_cnt"") AS ""1s_succ_join_ap_cnt"",
              SUM(""5s_succ_join_ap_cnt"") AS ""5s_succ_join_ap_cnt"",
              SUM(total_join_ap_cnt) AS total_join_ap_cnt,
              SUM(audio_freeze_time_200) AS audio_freeze_time_200,
              SUM(audio_totaltime_200) AS audio_totaltime_200,
              SUM(video_freeze_time) AS video_freeze_time,
              SUM(video_totaltime) AS video_totaltime,
              SUM(p2s_lost_Leq5) AS p2s_lost_Leq5,
              SUM(p2s_lost_all) AS p2s_lost_all,
              SUM(s2l_25ms_delay_sec) AS s2l_25ms_delay_sec,
              SUM(s2l_75ms_delay_sec) AS s2l_75ms_delay_sec,
              SUM(s2l_total_delay_sec) AS s2l_total_delay_sec,
              SUM(crash_cnt) AS crash_cnt,
              SUM(service_cnt) AS service_cnt,
              SUM(""5s_succ_join_session_cnt_last1"") AS ""5s_succ_join_session_cnt_last1"",
              SUM(""3s_succ_join_session_cnt_last1"") AS ""3s_succ_join_session_cnt_last1"",
              SUM(succ_join_session_cnt_last1) AS succ_join_session_cnt_last1,
              SUM(total_join_session_cnt_last1) AS total_join_session_cnt_last1,
              SUM(total_session_cnt_last1) AS total_session_cnt_last1,
              SUM(""1s_succ_join_ap_cnt_last1"") AS ""1s_succ_join_ap_cnt_last1"",
              SUM(""5s_succ_join_ap_cnt_last1"") AS ""5s_succ_join_ap_cnt_last1"",
              SUM(total_join_ap_cnt_last1) AS total_join_ap_cnt_last1,
              SUM(video_freeze_time_last1) AS video_freeze_time_last1,
              SUM(video_totaltime_last1) AS video_totaltime_last1,
              SUM(p2s_lost_Leq5_last1) AS p2s_lost_Leq5_last1,
              SUM(p2s_lost_all_last1) AS p2s_lost_all_last1,
              SUM(s2l_25ms_delay_sec_last1) AS s2l_25ms_delay_sec_last1,
              SUM(s2l_75ms_delay_sec_last1) AS s2l_75ms_delay_sec_last1,
              SUM(s2l_total_delay_sec_last1) AS s2l_total_delay_sec_last1,
              SUM(crash_cnt_last1) AS crash_cnt_last1,
              SUM(service_cnt_last1) AS service_cnt_last1,
              SUM(audio_freeze_time_200_last1) AS audio_freeze_time_200_last1,
              SUM(audio_totaltime_200_last1) AS audio_totaltime_200_last1,
              SUM(""5s_succ_join_session_cnt_last7"") AS ""5s_succ_join_session_cnt_last7"",
              SUM(""3s_succ_join_session_cnt_last7"") AS ""3s_succ_join_session_cnt_last7"",
              SUM(succ_join_session_cnt_last7) AS succ_join_session_cnt_last7,
              SUM(total_join_session_cnt_last7) AS total_join_session_cnt_last7,
              SUM(total_session_cnt_last7) AS total_session_cnt_last7,
              SUM(""1s_succ_join_ap_cnt_last7"") AS ""7s_succ_join_ap_cnt_last7"",
              SUM(""5s_succ_join_ap_cnt_last7"") AS ""5s_succ_join_ap_cnt_last7"",
              SUM(total_join_ap_cnt_last7) AS total_join_ap_cnt_last7,
              SUM(video_freeze_time_last7) AS video_freeze_time_last7,
              SUM(video_totaltime_last7) AS video_totaltime_last7,
              SUM(p2s_lost_Leq5_last7) AS p2s_lost_Leq5_last7,
              SUM(p2s_lost_all_last7) AS p2s_lost_all_last7,
              SUM(s2l_25ms_delay_sec_last7) AS s2l_25ms_delay_sec_last7,
              SUM(s2l_75ms_delay_sec_last7) AS s2l_75ms_delay_sec_last7,
              SUM(s2l_total_delay_sec_last7) AS s2l_total_delay_sec_last7,
              SUM(crash_cnt_last7) AS crash_cnt_last7,
              SUM(service_cnt_last7) AS service_cnt_last7,
              SUM(audio_freeze_time_200_last7) AS audio_freeze_time_200_last7,
              SUM(audio_totaltime_200_last7) AS audio_totaltime_200_last7,
              SUM(video_freeze_time_500) AS video_freeze_time_500,
              SUM(video_totaltime_500) AS video_totaltime_500,
              SUM(video_freeze_time_200) AS video_freeze_time_200,
              SUM(video_totaltime_200) AS video_totaltime_200,
              SUM(video_freeze_time_500_last1) AS video_freeze_time_500_last1,
              SUM(video_totaltime_500_last1) AS video_totaltime_500_last1,
              SUM(video_freeze_time_200_last1) AS video_freeze_time_200_last1,
              SUM(video_totaltime_200_last1) AS video_totaltime_200_last1,
              SUM(video_freeze_time_500_last7) AS video_freeze_time_500_last7,
              SUM(video_totaltime_500_last7) AS video_totaltime_500_last7,
              SUM(video_freeze_time_200_last7) AS video_freeze_time_200_last7,
              SUM(video_totaltime_200_last7) AS video_totaltime_200_last7,
              SUM(s2l_lost_Leq5) AS s2l_lost_Leq5,
              SUM(s2l_lost_all) AS s2l_lost_all,
              SUM(s2l_lost_Leq5_last1) AS s2l_lost_Leq5_last1,
              SUM(s2l_lost_all_last1) AS s2l_lost_all_last1,
              SUM(s2l_lost_Leq5_last7) AS s2l_lost_Leq5_last7,
              SUM(s2l_lost_all_last7) AS s2l_lost_all_last7
            FROM report_datahub.vid_osver_net_cp_domain_quality_di_1
            WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-21') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-11-21') AND CAST(vid AS VARCHAR) = CAST(281104 AS VARCHAR) AND CAST(product_level_2 AS VARCHAR) = 'Native'
            GROUP BY vid,
              project,
              company_id,
              area,
              company_name,
              industry_name,
              date,
              net,
              os,
              ver,
              product_level_1,
              product_level_2,
              ver_type,
                CASE WHEN CAST(stat_period AS VARCHAR) = 'day' THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(substr(CAST(start_date AS VARCHAR), 1, 10) AS VARCHAR), '~', CAST(substr(CAST(end_date AS VARCHAR), 1, 10) AS VARCHAR)) END) AS ts
          LEFT JOIN (SELECT vid,
              date,
              SUM(fiveSecJoinSuccess) AS fiveSecJoinSuccess_total,
              SUM(threeSecJoinSuccess) AS threeSecJoinSuccess_total,
              SUM(totalJoinSuccess) AS totalJoinSuccess_total,
              SUM(totalJoin) AS totalJoin_total,
              SUM(cnt_sid) AS cnt_sid_total,
              SUM(""1s_succ_join_ap_cnt"") AS ""1s_succ_join_ap_cnt_total"",
              SUM(""5s_succ_join_ap_cnt"") AS ""5s_succ_join_ap_cnt_total"",
              SUM(total_join_ap_cnt) AS total_join_ap_cnt_total,
              SUM(audio_freeze_time_200) AS audio_freeze_time_200_total,
              SUM(audio_totaltime_200) AS audio_totaltime_200_total,
              SUM(video_freeze_time) AS video_freeze_time_total,
              SUM(video_totaltime) AS video_totaltime_total,
              SUM(p2s_lost_Leq5) AS p2s_lost_Leq5_total,
              SUM(p2s_lost_all) AS p2s_lost_all_total,
              SUM(s2l_25ms_delay_sec) AS s2l_25ms_delay_sec_total,
              SUM(s2l_75ms_delay_sec) AS s2l_75ms_delay_sec_total,
              SUM(s2l_total_delay_sec) AS s2l_total_delay_sec_total,
              SUM(crash_cnt) AS crash_cnt_total,
              SUM(service_cnt) AS service_cnt_total,
              SUM(""5s_succ_join_session_cnt_last1"") AS ""5s_succ_join_session_cnt_last1_total"",
              SUM(""3s_succ_join_session_cnt_last1"") AS ""3s_succ_join_session_cnt_last1_total"",
              SUM(succ_join_session_cnt_last1) AS succ_join_session_cnt_last1_total,
              SUM(total_join_session_cnt_last1) AS total_join_session_cnt_last1_total,
              SUM(total_session_cnt_last1) AS total_session_cnt_last1_total,
              SUM(""1s_succ_join_ap_cnt_last1"") AS ""1s_succ_join_ap_cnt_last1_total"",
              SUM(""5s_succ_join_ap_cnt_last1"") AS ""5s_succ_join_ap_cnt_last1_total"",
              SUM(total_join_ap_cnt_last1) AS total_join_ap_cnt_last1_total,
              SUM(video_freeze_time_last1) AS video_freeze_time_last1_total,
              SUM(video_totaltime_last1) AS video_totaltime_last1_total,
              SUM(p2s_lost_Leq5_last1) AS p2s_lost_Leq5_last1_total,
              SUM(p2s_lost_all_last1) AS p2s_lost_all_last1_total,
              SUM(s2l_25ms_delay_sec_last1) AS s2l_25ms_delay_sec_last1_total,
              SUM(s2l_75ms_delay_sec_last1) AS s2l_75ms_delay_sec_last1_total,
              SUM(s2l_total_delay_sec_last1) AS s2l_total_delay_sec_last1_total,
              SUM(crash_cnt_last1) AS crash_cnt_last1_total,
              SUM(service_cnt_last1) AS service_cnt_last1_total,
              SUM(audio_freeze_time_200_last1) AS audio_freeze_time_200_last1_total,
              SUM(audio_totaltime_200_last1) AS audio_totaltime_200_last1_total,
              SUM(""5s_succ_join_session_cnt_last7"") AS ""5s_succ_join_session_cnt_last7_total"",
              SUM(""3s_succ_join_session_cnt_last7"") AS ""3s_succ_join_session_cnt_last7_total"",
              SUM(succ_join_session_cnt_last7) AS succ_join_session_cnt_last7_total,
              SUM(total_join_session_cnt_last7) AS total_join_session_cnt_last7_total,
              SUM(total_session_cnt_last7) AS total_session_cnt_last7_total,
              SUM(""1s_succ_join_ap_cnt_last7"") AS ""7s_succ_join_ap_cnt_last7_total"",
              SUM(""5s_succ_join_ap_cnt_last7"") AS ""5s_succ_join_ap_cnt_last7_total"",
              SUM(total_join_ap_cnt_last7) AS total_join_ap_cnt_last7_total,
              SUM(video_freeze_time_last7) AS video_freeze_time_last7_total,
              SUM(video_totaltime_last7) AS video_totaltime_last7_total,
              SUM(p2s_lost_Leq5_last7) AS p2s_lost_Leq5_last7_total,
              SUM(p2s_lost_all_last7) AS p2s_lost_all_last7_total,
              SUM(s2l_25ms_delay_sec_last7) AS s2l_25ms_delay_sec_last7_total,
              SUM(s2l_75ms_delay_sec_last7) AS s2l_75ms_delay_sec_last7_total,
              SUM(s2l_total_delay_sec_last7) AS s2l_total_delay_sec_last7_total,
              SUM(crash_cnt_last7) AS crash_cnt_last7_total,
              SUM(service_cnt_last7) AS service_cnt_last7_total,
              SUM(audio_freeze_time_200_last7) AS audio_freeze_time_200_last7_total,
              SUM(audio_totaltime_200_last7) AS audio_totaltime_200_last7_total,
              SUM(video_freeze_time_500) AS video_freeze_time_500_total,
              SUM(video_totaltime_500) AS video_totaltime_500_total,
              SUM(video_freeze_time_200) AS video_freeze_time_200_total,
              SUM(video_totaltime_200) AS video_totaltime_200_total,
              SUM(video_freeze_time_500_last1) AS video_freeze_time_500_last1_total,
              SUM(video_totaltime_500_last1) AS video_totaltime_500_last1_total,
              SUM(video_freeze_time_200_last1) AS video_freeze_time_200_last1_total,
              SUM(video_totaltime_200_last1) AS video_totaltime_200_last1_total,
              SUM(video_freeze_time_500_last7) AS video_freeze_time_500_last7_total,
              SUM(video_totaltime_500_last7) AS video_totaltime_500_last7_total,
              SUM(video_freeze_time_200_last7) AS video_freeze_time_200_last7_total,
              SUM(video_totaltime_200_last7) AS video_totaltime_200_last7_total,
              SUM(s2l_lost_Leq5) AS s2l_lost_Leq5_total,
              SUM(s2l_lost_all) AS s2l_lost_all_total,
              SUM(s2l_lost_Leq5_last1) AS s2l_lost_Leq5_last1_total,
              SUM(s2l_lost_all_last1) AS s2l_lost_all_last1_total,
              SUM(s2l_lost_Leq5_last7) AS s2l_lost_Leq5_last7_total,
              SUM(s2l_lost_all_last7) AS s2l_lost_all_last7_total
            FROM report_datahub.vid_osver_net_cp_domain_quality_di_1
            WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-21') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-11-21') AND CAST(vid AS VARCHAR) = CAST(281104 AS VARCHAR) AND CAST(product_level_2 AS VARCHAR) = 'Native'
            GROUP BY vid,
              date) AS tt ON CAST(ts.vid AS VARCHAR) = CAST(tt.vid AS VARCHAR) AND ts.date = tt.date) AS ""自定义 SQL 查询""
    HAVING COUNT(1) > 0) AS ""t0""
WHERE CAST(""自定义 SQL 查询"".""dim"" AS VARCHAR) = 'osver' AND DATE_ADD('SECOND', 0, date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d')) = DATE_ADD('SECOND', 0, ""t0"".""__measure__0"")
HAVING COUNT(1) > 0"
"SELECT ""t0"".""srcCountry"" AS ""srcCountry""
FROM (SELECT ""自定义 SQL 查询"".""srcCountry"" AS ""srcCountry""
    FROM (SELECT date AS ""date"",
          src_domain AS ""srcDomain"",
          src_country AS ""srcCountry"",
          dest_idc AS ""idc"",
          delay_25 AS ""p2s_Delay25"",
          delay_50 AS ""p2s_Delay50"",
          delay_75 AS ""p2s_Delay75"",
          delay_100 AS ""p2s_Delay100"",
          delay_125 AS ""p2s_Delay125"",
          delay_150 AS ""p2s_Delay150"",
          delay_total,
          lost_ratio_5 AS ""p2s_lostRatio"",
          lostratio_total AS ""p2s_total"",
          jitter95_50 AS ""p2s_jitter95_50"",
          jitter95_100 AS ""p2s_jitter95_100"",
          jitter95_200 AS ""p2s_jitter95_200"",
          jitter95_300 AS ""p2s_jitter95_300"",
          jitter95_total,
          product_line,
          product_type
        FROM media.p2s_cover_oversea_idc
        WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-25') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-01')) AS ""自定义 SQL 查询""
    WHERE CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'aofei-frankfurt1g' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'zhuzhou1g-ctel'
    GROUP BY ""自定义 SQL 查询"".""idc"",
      1,
      ""自定义 SQL 查询"".""srcDomain""
    HAVING CAST(CASE WHEN SUM(""自定义 SQL 查询"".""p2s_total"") >= 0 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100 THEN '0-100' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 1000 THEN '100-1000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 1000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 10000 THEN '1000-10000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 10000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100000 THEN '10000-100000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100000 THEN '100000以上' ELSE 'other' END AS VARCHAR) = '100-1000' OR CAST(CASE WHEN SUM(""自定义 SQL 查询"".""p2s_total"") >= 0 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100 THEN '0-100' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 1000 THEN '100-1000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 1000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 10000 THEN '1000-10000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 10000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100000 THEN '10000-100000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100000 THEN '100000以上' ELSE 'other' END AS VARCHAR) = '1000-10000' OR CAST(CASE WHEN SUM(""自定义 SQL 查询"".""p2s_total"") >= 0 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100 THEN '0-100' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 1000 THEN '100-1000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 1000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 10000 THEN '1000-10000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 10000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100000 THEN '10000-100000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100000 THEN '100000以上' ELSE 'other' END AS VARCHAR) = '10000-100000' OR CAST(CASE WHEN SUM(""自定义 SQL 查询"".""p2s_total"") >= 0 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100 THEN '0-100' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 1000 THEN '100-1000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 1000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 10000 THEN '1000-10000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 10000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100000 THEN '10000-100000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100000 THEN '100000以上' ELSE 'other' END AS VARCHAR) = '100000以上') AS ""t0""
GROUP BY 1"
"SELECT ""自定义 SQL 查询"".""product_line"" AS ""product_line""
FROM (SELECT date,
      src_domain AS ""srcDomain"",
      delay_25 AS ""p2s_Delay25"",
      delay_50 AS ""p2s_Delay50"",
      delay_75 AS ""p2s_Delay75"",
      delay_100 AS ""p2s_Delay100"",
      delay_125 AS ""p2s_Delay125"",
      delay_150 AS ""p2s_Delay150"",
      delay_total,
      lost_ratio_5 AS ""p2s_lostRatio"",
      lostratio_total AS ""p2s_total"",
      jitter95_50 AS ""p2s_jitter95_50"",
      jitter95_100 AS ""p2s_jitter95_100"",
      jitter95_200 AS ""p2s_jitter95_200"",
      jitter95_300 AS ""p2s_jitter95_300"",
      jitter95_total,
      product_line,
      product_type
    FROM media.p2s_cover_domain
    WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-25') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-01')) AS ""自定义 SQL 查询""
GROUP BY 1
ORDER BY ""product_line"""
"SELECT ""自定义 SQL 查询"".""product_level2"" AS ""product_level2""
FROM (SELECT date,
      SUBSTR(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) AS date_range_1,
      SUBSTR(CAST(end_date AS VARCHAR), 1, 10) AS date_range_2,
      stat_period,
        CASE WHEN CAST(stat_period AS VARCHAR) = 'day' THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,
      area,
      vid,
      project,
      company_id AS cid,
      company_name AS company,
      customer_level AS level,
      vid_internal_industry_en AS industry,
      vid_use_case_cn,
      csdc_owner,
      os,
      ver,
      ver_type,
      product_level1,
      product_level2,
      product_level3,
      total,
      audio,
      video,
      video_sd,
      video_hd,
      video_hdp,
        host_audio + host_video AS host,
      host_audio,
      host_video,
      host_sd,
      host_hd,
      host_hdp,
        audience_audio + audience_video AS audience,
        audience_audio_low_latency + audience_video_low_latency AS audience_low_latency,
      audience_audio,
      audience_audio_low_latency,
      audience_video,
      audience_video_low_latency,
      audience_sd,
      audience_sd_low_latency,
      audience_hd,
      audience_hd_low_latency,
      audience_hdp,
      audience_hdp_low_latency,
      total_last1,
      audio_last1,
      video_last1,
      video_sd_last1,
      video_hd_last1,
      video_hdp_last1,
        host_audio_last1 + host_video_last1 AS host_last1,
      host_audio_last1,
      host_video_last1,
        audience_audio_last1 + audience_video_last1 AS audience_last1,
        audience_audio_low_latency_last1 + audience_video_low_latency_last1 AS audience_low_latency_last1,
      audience_audio_last1,
      audience_audio_low_latency_last1,
      audience_video_last1,
      audience_video_low_latency_last1,
      total_last7,
      audio_last7,
      video_last7,
      video_sd_last7,
      video_hd_last7,
      video_hdp_last7,
        host_audio_last7 + host_video_last7 AS host_last7,
      host_audio_last7,
      host_video_last7,
        audience_audio_last7 + audience_video_last7 AS audience_last7,
        audience_audio_low_latency_last7 + audience_video_low_latency_last7 AS audience_low_latency_last7,
      audience_audio_last7,
      audience_audio_low_latency_last7,
      audience_video_last7,
      audience_video_low_latency_last7
    FROM report_datahub.vendor_vid_usage_di_1
    WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-06') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-06') AND CAST(vid AS VARCHAR) = CAST(428342 AS VARCHAR) AND dim = 1) AS ""自定义 SQL 查询""
GROUP BY 1
ORDER BY ""product_level2"""
"SELECT '跳转：视频可用性' AS ""Calculation_5876704998657425411""
FROM (SELECT date,
        CASE WHEN CAST(stat_period AS VARCHAR) = 'day' THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(substr(CAST(start_date AS VARCHAR), 1, 10) AS VARCHAR), '~', CAST(substr(CAST(end_date AS VARCHAR), 1, 10) AS VARCHAR)) END AS period,
      start_date,
      end_date,
      stat_period,
      tag,
      dim,
      level1,
      level2,
      level3,
      level4,
      '' AS pd,
      os,
      ver,
      ver_type,
      '' AS product_line,
      '' AS product_type,
      domain,
      country,
      region,
      net,
      vid,
      project,
      company_id,
      company_name,
      rowsnum,
      lastusage,
      thisusage,
      fiveSecJoinSuccess,
      totalJoin,
      cnt_sid,
      video_freeze_time,
      video_totaltime,
      audio_freeze_time,
      audio_totaltime,
      s2l_total_delay_sec,
      s2l_25ms_delay_sec,
      s2l_75ms_delay_sec,
      p2s_lost_Leq5,
      p2s_lost_all,
      crash_cnt,
      service_cnt,
      ""1s_succ_join_ap_cnt"",
      ""5s_succ_join_ap_cnt"",
      total_join_ap_cnt,
      totalJoinSuccess,
      threeSecJoinSuccess,
      video_freeze_time_200,
      video_totaltime_200,
      video_freeze_time_500,
      video_totaltime_500,
      ""3s_succ_join_session_cnt_last1"",
      ""5s_succ_join_session_cnt_last1"",
      succ_join_session_cnt_last1,
      total_join_session_cnt_last1,
      total_session_cnt_last1,
      ""1s_succ_join_ap_cnt_last1"",
      ""5s_succ_join_ap_cnt_last1"",
      total_join_ap_cnt_last1,
      ""3s_succ_join_session_cnt_last7"",
      ""5s_succ_join_session_cnt_last7"",
      succ_join_session_cnt_last7,
      total_join_session_cnt_last7,
      total_session_cnt_last7,
      ""1s_succ_join_ap_cnt_last7"",
      ""5s_succ_join_ap_cnt_last7"",
      total_join_ap_cnt_last7,
      video_freeze_time_last1,
      video_totaltime_last1,
      video_freeze_time_500_last1,
      video_totaltime_500_last1,
      video_freeze_time_200_last1,
      video_totaltime_200_last1,
      video_freeze_time_last7,
      video_totaltime_last7,
      video_freeze_time_500_last7,
      video_totaltime_500_last7,
      video_freeze_time_200_last7,
      video_totaltime_200_last7,
      audio_freeze_time_last1,
      audio_totaltime_last1,
      audio_freeze_time_last7,
      audio_totaltime_last7,
      s2l_total_delay_sec_last1,
      s2l_25ms_delay_sec_last1,
      s2l_75ms_delay_sec_last1,
      s2l_total_delay_sec_last7,
      s2l_25ms_delay_sec_last7,
      s2l_75ms_delay_sec_last7,
      p2s_lost_Leq5_last1,
      p2s_lost_all_last1,
      p2s_lost_Leq5_last7,
      p2s_lost_all_last7,
      crash_cnt_last1,
      service_cnt_last1,
      crash_cnt_last7,
      service_cnt_last7,
      product_level1,
      product_level2,
      product_level3,
      product_level4,
      s2l_lost_Leq5,
      s2l_lost_all,
      s2l_lost_Leq5_last1,
      s2l_lost_all_last1,
      s2l_lost_Leq5_last7,
      s2l_lost_all_last7
    FROM report_datahub.pub_levels_quality_di_1
    WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-21') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-05')) AS ""自定义 SQL 查询""
HAVING COUNT(1) > 0"
"SELECT SUM(""自定义 SQL 查询"".""audience_low_latency_last1"") AS ""TEMP(Calculation_230316907702542336)(2007846651)(0)"",
  SUM(""自定义 SQL 查询"".""audience_low_latency"") AS ""TEMP(Calculation_230316907702542336)(2627877912)(0)"",
  SUM(""自定义 SQL 查询"".""total"") AS ""TEMP(Calculation_5203557528859017219)(2253843611)(0)"",
  SUM(""自定义 SQL 查询"".""total_last1"") AS ""TEMP(Calculation_5203557528859017219)(3076278274)(0)"",
  SUM(""自定义 SQL 查询"".""audio_last1"") AS ""TEMP(Calculation_5203557528863870981)(2207581090)(0)"",
  SUM(""自定义 SQL 查询"".""audio"") AS ""TEMP(Calculation_5203557528863870981)(4234702922)(0)"",
  SUM(""自定义 SQL 查询"".""video_last1"") AS ""TEMP(Calculation_5203557528864096263)(1192334319)(0)"",
  SUM(""自定义 SQL 查询"".""video"") AS ""TEMP(Calculation_5203557528864096263)(3647352276)(0)"",
  SUM(""自定义 SQL 查询"".""audience"") AS ""TEMP(Calculation_534802460955746306)(1306364424)(0)"",
  SUM(""自定义 SQL 查询"".""audience_last1"") AS ""TEMP(Calculation_534802460955746306)(2505681848)(0)"",
  SUM(""自定义 SQL 查询"".""audience_audio"") AS ""TEMP(Calculation_534802460956037124)(1868547182)(0)"",
  SUM(""自定义 SQL 查询"".""audience_audio_last1"") AS ""TEMP(Calculation_534802460956037124)(2218970377)(0)"",
  SUM(""自定义 SQL 查询"".""audience_video_last1"") AS ""TEMP(Calculation_534802460956319750)(188915252)(0)"",
  SUM(""自定义 SQL 查询"".""audience_video"") AS ""TEMP(Calculation_534802460956319750)(2182583436)(0)"",
  SUM(""自定义 SQL 查询"".""video_sd"") AS ""TEMP(Calculation_6762858532789223429)(2567841492)(0)"",
  SUM(""自定义 SQL 查询"".""video_hd"") AS ""TEMP(Calculation_6762858532789321734)(3091062117)(0)"",
  SUM(""自定义 SQL 查询"".""video_hdp"") AS ""TEMP(Calculation_6762858532789395463)(207731858)(0)"",
  MAX(""自定义 SQL 查询"".""stat_date"") AS ""TEMP(attr_stat_date_nk)(2102638629)(0)"",
  MIN(""自定义 SQL 查询"".""stat_date"") AS ""TEMP(attr_stat_date_nk)(2790680713)(0)"",
  SUM(""自定义 SQL 查询"".""host_audio_last1"") AS ""TEMP(audience_audio_last1_rate (复制)_534802460956618761)(24"",
  SUM(""自定义 SQL 查询"".""host_audio"") AS ""TEMP(audience_audio_last1_rate (复制)_534802460956618761)(36"",
  SUM(""自定义 SQL 查询"".""host_last1"") AS ""TEMP(audience_last1_rate (复制)_534802460956647435)(15035501"",
  SUM(""自定义 SQL 查询"".""host"") AS ""TEMP(audience_last1_rate (复制)_534802460956647435)(24867219"",
  SUM(""自定义 SQL 查询"".""audience_video_low_latency_last1"") AS ""TEMP(audience_low_latency_last1_rate (复制)_2303169077218304"",
  SUM(""自定义 SQL 查询"".""audience_video_low_latency"") AS ""TEMP(audience_low_latency_last1_rate (复制)_2303169077218301"",
  SUM(""自定义 SQL 查询"".""host_video"") AS ""TEMP(audience_video_last1_rate (复制)_534802460956696589)(26"",
  SUM(""自定义 SQL 查询"".""host_video_last1"") AS ""TEMP(audience_video_last1_rate (复制)_534802460956696589)(42"",
  SUM(""自定义 SQL 查询"".""audience_audio_low_latency"") AS ""sum_audience_audio_low_latency_ok"",
  SUM(""自定义 SQL 查询"".""audience_audio_low_latency_last1"") AS ""sum_audience_audio_low_latency_last1_ok"",
  SUM(""自定义 SQL 查询"".""audience_hd"") AS ""sum_audience_hd_ok"",
  SUM(""自定义 SQL 查询"".""audience_hd_low_latency"") AS ""sum_audience_hd_low_latency_ok"",
  SUM(""自定义 SQL 查询"".""audience_hdp"") AS ""sum_audience_hdp_ok"",
  SUM(""自定义 SQL 查询"".""audience_hdp_low_latency"") AS ""sum_audience_hdp_low_latency_ok"",
  SUM(""自定义 SQL 查询"".""audience_sd"") AS ""sum_audience_sd_ok"",
  SUM(""自定义 SQL 查询"".""audience_sd_low_latency"") AS ""sum_audience_sd_low_latency_ok"",
  SUM(""自定义 SQL 查询"".""audience_video_low_latency"") AS ""sum_audience_video_low_latency_ok"",
  SUM(""自定义 SQL 查询"".""host_hd"") AS ""sum_host_hd_ok"",
  SUM(""自定义 SQL 查询"".""host_hdp"") AS ""sum_host_hdp_ok"",
  SUM(""自定义 SQL 查询"".""host_sd"") AS ""sum_host_sd_ok"",
  DATE_ADD('SECOND', 0, date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d')) AS ""tdy_date_ok""
FROM (SELECT date,
      SUBSTR(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) AS date_range_1,
      SUBSTR(CAST(end_date AS VARCHAR), 1, 10) AS date_range_2,
      stat_period,
        CASE WHEN CAST(stat_period AS VARCHAR) = 'day' THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,
      area,
      vid,
      project,
      company_id AS cid,
      company_name AS company,
      customer_level AS level,
      vid_internal_industry_en AS industry,
      vid_use_case_cn,
      csdc_owner,
      os,
      ver,
      ver_type,
      product_level1,
      product_level2,
      product_level3,
      total,
      audio,
      video,
      video_sd,
      video_hd,
      video_hdp,
        host_audio + host_video AS host,
      host_audio,
      host_video,
      host_sd,
      host_hd,
      host_hdp,
        audience_audio + audience_video AS audience,
        audience_audio_low_latency + audience_video_low_latency AS audience_low_latency,
      audience_audio,
      audience_audio_low_latency,
      audience_video,
      audience_video_low_latency,
      audience_sd,
      audience_sd_low_latency,
      audience_hd,
      audience_hd_low_latency,
      audience_hdp,
      audience_hdp_low_latency,
      total_last1,
      audio_last1,
      video_last1,
      video_sd_last1,
      video_hd_last1,
      video_hdp_last1,
        host_audio_last1 + host_video_last1 AS host_last1,
      host_audio_last1,
      host_video_last1,
        audience_audio_last1 + audience_video_last1 AS audience_last1,
        audience_audio_low_latency_last1 + audience_video_low_latency_last1 AS audience_low_latency_last1,
      audience_audio_last1,
      audience_audio_low_latency_last1,
      audience_video_last1,
      audience_video_low_latency_last1,
      total_last7,
      audio_last7,
      video_last7,
      video_sd_last7,
      video_hd_last7,
      video_hdp_last7,
        host_audio_last7 + host_video_last7 AS host_last7,
      host_audio_last7,
      host_video_last7,
        audience_audio_last7 + audience_video_last7 AS audience_last7,
        audience_audio_low_latency_last7 + audience_video_low_latency_last7 AS audience_low_latency_last7,
      audience_audio_last7,
      audience_audio_low_latency_last7,
      audience_video_last7,
      audience_video_low_latency_last7
    FROM report_datahub.vendor_vid_usage_di_1
    WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-06') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-06') AND CAST(vid AS VARCHAR) = CAST(311291 AS VARCHAR) AND dim = 1) AS ""自定义 SQL 查询""
GROUP BY 40"
"SELECT SUM(""自定义 SQL 查询"".""thisusage"") AS ""TEMP(TC_)(949910004)(0)"",
  SUM(""自定义 SQL 查询"".""thisusage"") AS ""sum_thisusage_ok"",
  MAX(""自定义 SQL 查询"".""period"") AS ""usr_Calculation_6733444459377328128_nk"",
  ""自定义 SQL 查询"".""vid"" AS ""vid""
FROM (SELECT date,
        CASE WHEN CAST(stat_period AS VARCHAR) = 'day' THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(substr(CAST(start_date AS VARCHAR), 1, 10) AS VARCHAR), '~', CAST(substr(CAST(end_date AS VARCHAR), 1, 10) AS VARCHAR)) END AS period,
      start_date,
      end_date,
      stat_period,
      tag,
      dim,
      level1,
      level2,
      level3,
      level4,
      '' AS pd,
      os,
      ver,
      ver_type,
      '' AS product_line,
      '' AS product_type,
      domain,
      country,
      region,
      net,
      vid,
      project,
      company_id,
      company_name,
      rowsnum,
      lastusage,
      thisusage,
      fiveSecJoinSuccess,
      totalJoin,
      cnt_sid,
      video_freeze_time,
      video_totaltime,
      audio_freeze_time,
      audio_totaltime,
      s2l_total_delay_sec,
      s2l_25ms_delay_sec,
      s2l_75ms_delay_sec,
      p2s_lost_Leq5,
      p2s_lost_all,
      crash_cnt,
      service_cnt,
      ""1s_succ_join_ap_cnt"",
      ""5s_succ_join_ap_cnt"",
      total_join_ap_cnt,
      totalJoinSuccess,
      threeSecJoinSuccess,
      video_freeze_time_200,
      video_totaltime_200,
      video_freeze_time_500,
      video_totaltime_500,
      ""3s_succ_join_session_cnt_last1"",
      ""5s_succ_join_session_cnt_last1"",
      succ_join_session_cnt_last1,
      total_join_session_cnt_last1,
      total_session_cnt_last1,
      ""1s_succ_join_ap_cnt_last1"",
      ""5s_succ_join_ap_cnt_last1"",
      total_join_ap_cnt_last1,
      ""3s_succ_join_session_cnt_last7"",
      ""5s_succ_join_session_cnt_last7"",
      succ_join_session_cnt_last7,
      total_join_session_cnt_last7,
      total_session_cnt_last7,
      ""1s_succ_join_ap_cnt_last7"",
      ""5s_succ_join_ap_cnt_last7"",
      total_join_ap_cnt_last7,
      video_freeze_time_last1,
      video_totaltime_last1,
      video_freeze_time_500_last1,
      video_totaltime_500_last1,
      video_freeze_time_200_last1,
      video_totaltime_200_last1,
      video_freeze_time_last7,
      video_totaltime_last7,
      video_freeze_time_500_last7,
      video_totaltime_500_last7,
      video_freeze_time_200_last7,
      video_totaltime_200_last7,
      audio_freeze_time_last1,
      audio_totaltime_last1,
      audio_freeze_time_last7,
      audio_totaltime_last7,
      s2l_total_delay_sec_last1,
      s2l_25ms_delay_sec_last1,
      s2l_75ms_delay_sec_last1,
      s2l_total_delay_sec_last7,
      s2l_25ms_delay_sec_last7,
      s2l_75ms_delay_sec_last7,
      p2s_lost_Leq5_last1,
      p2s_lost_all_last1,
      p2s_lost_Leq5_last7,
      p2s_lost_all_last7,
      crash_cnt_last1,
      service_cnt_last1,
      crash_cnt_last7,
      service_cnt_last7,
      product_level1,
      product_level2,
      product_level3,
      product_level4,
      s2l_lost_Leq5,
      s2l_lost_all,
      s2l_lost_Leq5_last1,
      s2l_lost_all_last1,
      s2l_lost_Leq5_last7,
      s2l_lost_all_last7
    FROM report_datahub.pub_levels_quality_di_1
    WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-21') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-11-21')) AS ""自定义 SQL 查询""
  CROSS JOIN (SELECT MAX(date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d')) AS ""__measure__0""
    FROM (SELECT date,
            CASE WHEN CAST(stat_period AS VARCHAR) = 'day' THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(substr(CAST(start_date AS VARCHAR), 1, 10) AS VARCHAR), '~', CAST(substr(CAST(end_date AS VARCHAR), 1, 10) AS VARCHAR)) END AS period,
          start_date,
          end_date,
          stat_period,
          tag,
          dim,
          level1,
          level2,
          level3,
          level4,
          '' AS pd,
          os,
          ver,
          ver_type,
          '' AS product_line,
          '' AS product_type,
          domain,
          country,
          region,
          net,
          vid,
          project,
          company_id,
          company_name,
          rowsnum,
          lastusage,
          thisusage,
          fiveSecJoinSuccess,
          totalJoin,
          cnt_sid,
          video_freeze_time,
          video_totaltime,
          audio_freeze_time,
          audio_totaltime,
          s2l_total_delay_sec,
          s2l_25ms_delay_sec,
          s2l_75ms_delay_sec,
          p2s_lost_Leq5,
          p2s_lost_all,
          crash_cnt,
          service_cnt,
          ""1s_succ_join_ap_cnt"",
          ""5s_succ_join_ap_cnt"",
          total_join_ap_cnt,
          totalJoinSuccess,
          threeSecJoinSuccess,
          video_freeze_time_200,
          video_totaltime_200,
          video_freeze_time_500,
          video_totaltime_500,
          ""3s_succ_join_session_cnt_last1"",
          ""5s_succ_join_session_cnt_last1"",
          succ_join_session_cnt_last1,
          total_join_session_cnt_last1,
          total_session_cnt_last1,
          ""1s_succ_join_ap_cnt_last1"",
          ""5s_succ_join_ap_cnt_last1"",
          total_join_ap_cnt_last1,
          ""3s_succ_join_session_cnt_last7"",
          ""5s_succ_join_session_cnt_last7"",
          succ_join_session_cnt_last7,
          total_join_session_cnt_last7,
          total_session_cnt_last7,
          ""1s_succ_join_ap_cnt_last7"",
          ""5s_succ_join_ap_cnt_last7"",
          total_join_ap_cnt_last7,
          video_freeze_time_last1,
          video_totaltime_last1,
          video_freeze_time_500_last1,
          video_totaltime_500_last1,
          video_freeze_time_200_last1,
          video_totaltime_200_last1,
          video_freeze_time_last7,
          video_totaltime_last7,
          video_freeze_time_500_last7,
          video_totaltime_500_last7,
          video_freeze_time_200_last7,
          video_totaltime_200_last7,
          audio_freeze_time_last1,
          audio_totaltime_last1,
          audio_freeze_time_last7,
          audio_totaltime_last7,
          s2l_total_delay_sec_last1,
          s2l_25ms_delay_sec_last1,
          s2l_75ms_delay_sec_last1,
          s2l_total_delay_sec_last7,
          s2l_25ms_delay_sec_last7,
          s2l_75ms_delay_sec_last7,
          p2s_lost_Leq5_last1,
          p2s_lost_all_last1,
          p2s_lost_Leq5_last7,
          p2s_lost_all_last7,
          crash_cnt_last1,
          service_cnt_last1,
          crash_cnt_last7,
          service_cnt_last7,
          product_level1,
          product_level2,
          product_level3,
          product_level4,
          s2l_lost_Leq5,
          s2l_lost_all,
          s2l_lost_Leq5_last1,
          s2l_lost_all_last1,
          s2l_lost_Leq5_last7,
          s2l_lost_all_last7
        FROM report_datahub.pub_levels_quality_di_1
        WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-21') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-11-21')) AS ""自定义 SQL 查询""
    HAVING COUNT(1) > 0) AS ""t0""
WHERE NOT ( (  ""自定义 SQL 查询"".""vid""  ) is null) AND CAST(""自定义 SQL 查询"".""dim"" AS VARCHAR) = '103' AND CAST(""自定义 SQL 查询"".""level1"" AS VARCHAR) = 'RTC' AND CAST(""自定义 SQL 查询"".""level2"" AS VARCHAR) = 'ALL' AND CAST(""自定义 SQL 查询"".""level3"" AS VARCHAR) = 'ALL' AND CAST(""自定义 SQL 查询"".""tag"" AS VARCHAR) = 'Product' AND DATE_ADD('SECOND', 0, date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d')) = DATE_ADD('SECOND', 0, ""t0"".""__measure__0"")
GROUP BY 4"
"SELECT SUM(""自定义 SQL 查询"".""host_4k"") AS ""TEMP(Calculation_3519281700341563406)(1075454865)(0)"",
  SUM(""自定义 SQL 查询"".""audience_audio_last7"") AS ""TEMP(Calculation_3519281700341563406)(1077563395)(0)"",
  SUM(""自定义 SQL 查询"".""audience_sd"") AS ""TEMP(Calculation_3519281700341563406)(1133678835)(0)"",
  SUM(""自定义 SQL 查询"".""host_1080p"") AS ""TEMP(Calculation_3519281700341563406)(1312501967)(0)"",
  SUM(""自定义 SQL 查询"".""audience_sd_last7"") AS ""TEMP(Calculation_3519281700341563406)(1456465729)(0)"",
  SUM(""自定义 SQL 查询"".""host_hd_last7"") AS ""TEMP(Calculation_3519281700341563406)(1635749653)(0)"",
  SUM(""自定义 SQL 查询"".""audience_hd_last7"") AS ""TEMP(Calculation_3519281700341563406)(1747046964)(0)"",
  SUM(""自定义 SQL 查询"".""audience_2k_last7"") AS ""TEMP(Calculation_3519281700341563406)(1747524570)(0)"",
  SUM(""自定义 SQL 查询"".""host_hdp_last7"") AS ""TEMP(Calculation_3519281700341563406)(2044136109)(0)"",
  SUM(""自定义 SQL 查询"".""host_audio_last7"") AS ""TEMP(Calculation_3519281700341563406)(2464388580)(0)"",
  SUM(""自定义 SQL 查询"".""audio_last7"") AS ""TEMP(Calculation_3519281700341563406)(2589233512)(0)"",
  SUM(""自定义 SQL 查询"".""host_hd"") AS ""TEMP(Calculation_3519281700341563406)(276907208)(0)"",
  SUM(""自定义 SQL 查询"".""host_2k_last7"") AS ""TEMP(Calculation_3519281700341563406)(280796653)(0)"",
  SUM(""自定义 SQL 查询"".""video"") AS ""TEMP(Calculation_3519281700341563406)(2929708110)(0)"",
  SUM(""自定义 SQL 查询"".""audience_hd"") AS ""TEMP(Calculation_3519281700341563406)(2930728935)(0)"",
  SUM(""自定义 SQL 查询"".""audience_hdp"") AS ""TEMP(Calculation_3519281700341563406)(3010533957)(0)"",
  SUM(""自定义 SQL 查询"".""host_hdp"") AS ""TEMP(Calculation_3519281700341563406)(30306054)(0)"",
  SUM(""自定义 SQL 查询"".""host_audio"") AS ""TEMP(Calculation_3519281700341563406)(3087054365)(0)"",
  SUM(""自定义 SQL 查询"".""host_4k_last7"") AS ""TEMP(Calculation_3519281700341563406)(3127348545)(0)"",
  SUM(""自定义 SQL 查询"".""audio"") AS ""TEMP(Calculation_3519281700341563406)(3299350010)(0)"",
  SUM(""自定义 SQL 查询"".""total_last7"") AS ""TEMP(Calculation_3519281700341563406)(346677966)(0)"",
  SUM(""自定义 SQL 查询"".""audience_4k_last7"") AS ""TEMP(Calculation_3519281700341563406)(3543669678)(0)"",
  SUM(""自定义 SQL 查询"".""host_1080p_last7"") AS ""TEMP(Calculation_3519281700341563406)(3624983014)(0)"",
  SUM(""自定义 SQL 查询"".""audience_1080p"") AS ""TEMP(Calculation_3519281700341563406)(3628946582)(0)"",
  SUM(""自定义 SQL 查询"".""totalUsage"") AS ""TEMP(Calculation_3519281700341563406)(3847882359)(0)"",
  SUM(""自定义 SQL 查询"".""host_sd_last7"") AS ""TEMP(Calculation_3519281700341563406)(3905372418)(0)"",
  SUM(""自定义 SQL 查询"".""video_last7"") AS ""TEMP(Calculation_3519281700341563406)(4107040267)(0)"",
  SUM(""自定义 SQL 查询"".""audience_audio"") AS ""TEMP(Calculation_3519281700341563406)(4109514392)(0)"",
  SUM(""自定义 SQL 查询"".""host_2k"") AS ""TEMP(Calculation_3519281700341563406)(586790827)(0)"",
  SUM(""自定义 SQL 查询"".""audience_1080p_last7"") AS ""TEMP(Calculation_3519281700341563406)(632977665)(0)"",
  SUM(""自定义 SQL 查询"".""host_sd"") AS ""TEMP(Calculation_3519281700341563406)(709512178)(0)"",
  SUM(""自定义 SQL 查询"".""audience_hdp_last7"") AS ""TEMP(Calculation_3519281700341563406)(750340200)(0)"",
  SUM(""自定义 SQL 查询"".""audience_4k"") AS ""TEMP(Calculation_3519281700341563406)(764410224)(0)"",
  SUM(""自定义 SQL 查询"".""audience_2k"") AS ""TEMP(Calculation_3519281700341563406)(943764407)(0)"",
  ""自定义 SQL 查询"".""level1"" AS ""level1"",
  SUM(""自定义 SQL 查询"".""audio_video_last"") AS ""sum_audio_video_last_ok""
FROM (SELECT date,
        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,
      start_date AS start_date_7,
      end_date AS end_date,
      tag,
      area AS Scope,
      dim,
        CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,
      level2,
      level3,
      level4,
      product_level1 AS product_line,
      product_level2,
      product_level3,
      product_level4,
      vid_internal_industry_en AS cid_industry,
      vid_use_case_en AS vid_use_case_cn,
      vid_sector_en,
      ver_type,
      ver,
      os,
      domain,
      country,
      region,
      dim_grouping_name,
        CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,
      total AS totalUsage,
      audio,
      video,
      host_audio,
      audience_audio,
      host_sd,
      host_hd,
      host_hdp,
      host_1080p,
      host_2k,
      host_4k,
      audience_sd,
      audience_hd,
      audience_hdp,
      audience_1080p,
      audience_2k,
      audience_4k,
      audience_audio_low_latency,
      audience_sd_low_latency,
      audience_hd_low_latency,
      audience_hdp_low_latency,
      audience_1080p_low_latency,
      audience_2k_low_latency,
      audience_4k_low_latency,
      audience_audio_ultra_low_latency,
      audience_sd_ultra_low_latency,
      audience_hd_ultra_low_latency,
      audience_hdp_ultra_low_latency,
      audience_1080p_ultra_low_latency,
      audience_2k_ultra_low_latency,
      audience_4k_ultra_low_latency,
      total_last1 AS audio_video_last,
      audio_last1 AS audio_last,
      video_last1 AS video_last,
      video_sd_last1 AS video_sd_last,
      video_hd_last1 AS video_hd_last,
      video_hdp_last1 AS video_hdp_last,
      host_sd_last1 AS host_video_sd_last,
      audience_sd_last1 AS audience_video_sd_last,
      host_hd_last1 AS host_video_hd_last,
      audience_hd_last1 AS audience_video_hd_last,
      host_hdp_last1 AS host_video_hdp_last,
      audience_hdp_last1 AS audience_video_hdp_last,
      host_audio_last1 AS host_audio_last,
      audience_audio_last1 AS audience_audio_last,
      host_video_last1 AS host_video_last,
      audience_video_last1 AS audience_video_last,
      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,
      audience_video_low_latency_last1 AS audience_video_low_latency_last,
      audience_total_low_latency_last1 AS audience_total_low_latency_last,
      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,
      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,
      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,
      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,
      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,
      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,
      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,
      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,
      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,
      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,
      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,
      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,
      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,
      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,
      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,
      audience_2k_last1 AS audience_2k_last,
      audience_4k_last1 AS audience_4k_last,
      audience_1080p_last1 AS audience_1080p_last,
      host_1080p_last1 AS host_1080p_last,
      host_2k_last1 AS host_2k_last,
      host_4k_last1 AS host_4k_last,
      total_last7,
      audio_last7,
      video_last7,
      video_sd_last7,
      video_hd_last7,
      video_hdp_last7,
      host_sd_last7,
      audience_sd_last7,
      host_hd_last7,
      audience_hd_last7,
      host_hdp_last7,
      audience_hdp_last7,
      host_audio_last7,
      audience_audio_last7,
      host_video_last7,
      audience_video_last7,
      audience_audio_low_latency_last7,
      audience_video_low_latency_last7,
      audience_total_low_latency_last7,
      audience_sd_low_latency_last7,
      audience_hd_low_latency_last7,
      audience_hdp_low_latency_last7,
      audience_1080p_low_latency_last7,
      audience_2k_low_latency_last7,
      audience_4k_low_latency_last7,
      audience_audio_ultra_low_latency_last7,
      audience_video_ultra_low_latency_last7,
      audience_total_ultra_low_latency_last7,
      audience_sd_ultra_low_latency_last7,
      audience_hd_ultra_low_latency_last7,
      audience_hdp_ultra_low_latency_last7,
      audience_1080p_ultra_low_latency_last7,
      audience_2k_ultra_low_latency_last7,
      audience_4k_ultra_low_latency_last7,
      audience_2k_last7,
      audience_4k_last7,
      audience_1080p_last7,
      host_1080p_last7,
      host_2k_last7,
      host_4k_last7
    FROM levels_usage_dod_di_1
    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-06') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-04') AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS ""自定义 SQL 查询""
  CROSS JOIN (SELECT MAX(date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d')) AS ""__measure__0""
    FROM (SELECT date,
            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,
          start_date AS start_date_7,
          end_date AS end_date,
          tag,
          area AS Scope,
          dim,
            CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,
          level2,
          level3,
          level4,
          product_level1 AS product_line,
          product_level2,
          product_level3,
          product_level4,
          vid_internal_industry_en AS cid_industry,
          vid_use_case_en AS vid_use_case_cn,
          vid_sector_en,
          ver_type,
          ver,
          os,
          domain,
          country,
          region,
          dim_grouping_name,
            CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,
          total AS totalUsage,
          audio,
          video,
          host_audio,
          audience_audio,
          host_sd,
          host_hd,
          host_hdp,
          host_1080p,
          host_2k,
          host_4k,
          audience_sd,
          audience_hd,
          audience_hdp,
          audience_1080p,
          audience_2k,
          audience_4k,
          audience_audio_low_latency,
          audience_sd_low_latency,
          audience_hd_low_latency,
          audience_hdp_low_latency,
          audience_1080p_low_latency,
          audience_2k_low_latency,
          audience_4k_low_latency,
          audience_audio_ultra_low_latency,
          audience_sd_ultra_low_latency,
          audience_hd_ultra_low_latency,
          audience_hdp_ultra_low_latency,
          audience_1080p_ultra_low_latency,
          audience_2k_ultra_low_latency,
          audience_4k_ultra_low_latency,
          total_last1 AS audio_video_last,
          audio_last1 AS audio_last,
          video_last1 AS video_last,
          video_sd_last1 AS video_sd_last,
          video_hd_last1 AS video_hd_last,
          video_hdp_last1 AS video_hdp_last,
          host_sd_last1 AS host_video_sd_last,
          audience_sd_last1 AS audience_video_sd_last,
          host_hd_last1 AS host_video_hd_last,
          audience_hd_last1 AS audience_video_hd_last,
          host_hdp_last1 AS host_video_hdp_last,
          audience_hdp_last1 AS audience_video_hdp_last,
          host_audio_last1 AS host_audio_last,
          audience_audio_last1 AS audience_audio_last,
          host_video_last1 AS host_video_last,
          audience_video_last1 AS audience_video_last,
          audience_audio_low_latency_last1 AS audience_audio_low_latency_last,
          audience_video_low_latency_last1 AS audience_video_low_latency_last,
          audience_total_low_latency_last1 AS audience_total_low_latency_last,
          audience_sd_low_latency_last1 AS audience_sd_low_latency_last,
          audience_hd_low_latency_last1 AS audience_hd_low_latency_last,
          audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,
          audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,
          audience_2k_low_latency_last1 AS audience_2k_low_latency_last,
          audience_4k_low_latency_last1 AS audience_4k_low_latency_last,
          audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,
          audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,
          audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,
          audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,
          audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,
          audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,
          audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,
          audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,
          audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,
          audience_2k_last1 AS audience_2k_last,
          audience_4k_last1 AS audience_4k_last,
          audience_1080p_last1 AS audience_1080p_last,
          host_1080p_last1 AS host_1080p_last,
          host_2k_last1 AS host_2k_last,
          host_4k_last1 AS host_4k_last,
          total_last7,
          audio_last7,
          video_last7,
          video_sd_last7,
          video_hd_last7,
          video_hdp_last7,
          host_sd_last7,
          audience_sd_last7,
          host_hd_last7,
          audience_hd_last7,
          host_hdp_last7,
          audience_hdp_last7,
          host_audio_last7,
          audience_audio_last7,
          host_video_last7,
          audience_video_last7,
          audience_audio_low_latency_last7,
          audience_video_low_latency_last7,
          audience_total_low_latency_last7,
          audience_sd_low_latency_last7,
          audience_hd_low_latency_last7,
          audience_hdp_low_latency_last7,
          audience_1080p_low_latency_last7,
          audience_2k_low_latency_last7,
          audience_4k_low_latency_last7,
          audience_audio_ultra_low_latency_last7,
          audience_video_ultra_low_latency_last7,
          audience_total_ultra_low_latency_last7,
          audience_sd_ultra_low_latency_last7,
          audience_hd_ultra_low_latency_last7,
          audience_hdp_ultra_low_latency_last7,
          audience_1080p_ultra_low_latency_last7,
          audience_2k_ultra_low_latency_last7,
          audience_4k_ultra_low_latency_last7,
          audience_2k_last7,
          audience_4k_last7,
          audience_1080p_last7,
          host_1080p_last7,
          host_2k_last7,
          host_4k_last7
        FROM levels_usage_dod_di_1
        WHERE CAST(tag AS VARCHAR) = 'Industry' AND date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-06') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-04') AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS ""自定义 SQL 查询""
    HAVING COUNT(1) > 0) AS ""t0""
WHERE ""自定义 SQL 查询"".""dim"" = 1 AND ""自定义 SQL 查询"".""rank_level1"" = 2 AND date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d') = ""t0"".""__measure__0""
GROUP BY 35"
"SELECT ""自定义 SQL 查询"".""dest_ip"" AS ""dest_ip""
FROM (SELECT date AS ""date"",
      src_domain AS ""srcDomain"",
      src_region AS ""srcRegion"",
      dest_idc AS ""idc"",
      src_isp,
      dest_ip,
      delay_25 AS ""p2s_Delay25"",
      delay_50 AS ""p2s_Delay50"",
      delay_75 AS ""p2s_Delay75"",
      delay_100 AS ""p2s_Delay100"",
      delay_125 AS ""p2s_Delay125"",
      delay_150 AS ""p2s_Delay150"",
      delay_total,
      lost_ratio_5 AS ""p2s_lostRatio"",
      lostratio_total AS ""p2s_total"",
      jitter95_50 AS ""p2s_jitter95_50"",
      jitter95_100 AS ""p2s_jitter95_100"",
      jitter95_200 AS ""p2s_jitter95_200"",
      jitter95_300 AS ""p2s_jitter95_300"",
      jitter95_total,
      product_line,
      product_type
    FROM media.p2s_cover_mainland_ip
    WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-25') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-01')) AS ""自定义 SQL 查询""
GROUP BY 1
ORDER BY ""dest_ip"""
"SELECT CONCAT(CONCAT(CAST(MIN(""t0"".""__measure__0"") AS VARCHAR), '~'), CAST(MIN(""t0"".""__measure__1"") AS VARCHAR)) AS ""Calculation_534802460924358656"",
  ""自定义 SQL 查询"".""product_level1"" AS ""product_level1"",
  ""自定义 SQL 查询"".""product_level2"" AS ""product_level2"",
  ""自定义 SQL 查询"".""product_level3"" AS ""product_level3"",
  SUM(""自定义 SQL 查询"".""audience"") AS ""sum_audience_ok"",
  SUM(""自定义 SQL 查询"".""audience_low_latency"") AS ""sum_audience_low_latency_ok"",
  SUM(""自定义 SQL 查询"".""audio"") AS ""sum_audio_ok"",
  SUM(""自定义 SQL 查询"".""host"") AS ""sum_host_ok"",
  SUM(""自定义 SQL 查询"".""total"") AS ""sum_total_ok"",
  SUM(""自定义 SQL 查询"".""video"") AS ""sum_video_ok"",
  SUM(""自定义 SQL 查询"".""video_hd"") AS ""sum_video_hd_ok"",
  SUM(""自定义 SQL 查询"".""video_hdp"") AS ""sum_video_hdp_ok"",
  SUM(""自定义 SQL 查询"".""video_sd"") AS ""sum_video_sd_ok""
FROM (SELECT date,
      SUBSTR(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) AS date_range_1,
      SUBSTR(CAST(end_date AS VARCHAR), 1, 10) AS date_range_2,
      stat_period,
        CASE WHEN CAST(stat_period AS VARCHAR) = 'day' THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,
      area,
      vid,
      project,
      company_id AS cid,
      company_name AS company,
      customer_level AS level,
      vid_internal_industry_en AS industry,
      vid_use_case_cn,
      csdc_owner,
      os,
      ver,
      ver_type,
      product_level1,
      product_level2,
      product_level3,
      total,
      audio,
      video,
      video_sd,
      video_hd,
      video_hdp,
        host_audio + host_video AS host,
      host_audio,
      host_video,
      host_sd,
      host_hd,
      host_hdp,
        audience_audio + audience_video AS audience,
        audience_audio_low_latency + audience_video_low_latency AS audience_low_latency,
      audience_audio,
      audience_audio_low_latency,
      audience_video,
      audience_video_low_latency,
      audience_sd,
      audience_sd_low_latency,
      audience_hd,
      audience_hd_low_latency,
      audience_hdp,
      audience_hdp_low_latency,
      total_last1,
      audio_last1,
      video_last1,
      video_sd_last1,
      video_hd_last1,
      video_hdp_last1,
        host_audio_last1 + host_video_last1 AS host_last1,
      host_audio_last1,
      host_video_last1,
        audience_audio_last1 + audience_video_last1 AS audience_last1,
        audience_audio_low_latency_last1 + audience_video_low_latency_last1 AS audience_low_latency_last1,
      audience_audio_last1,
      audience_audio_low_latency_last1,
      audience_video_last1,
      audience_video_low_latency_last1,
      total_last7,
      audio_last7,
      video_last7,
      video_sd_last7,
      video_hd_last7,
      video_hdp_last7,
        host_audio_last7 + host_video_last7 AS host_last7,
      host_audio_last7,
      host_video_last7,
        audience_audio_last7 + audience_video_last7 AS audience_last7,
        audience_audio_low_latency_last7 + audience_video_low_latency_last7 AS audience_low_latency_last7,
      audience_audio_last7,
      audience_audio_low_latency_last7,
      audience_video_last7,
      audience_video_low_latency_last7
    FROM report_datahub.vendor_vid_usage_di_1
    WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-06') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-06') AND CAST(vid AS VARCHAR) = CAST(428342 AS VARCHAR) AND dim = 1) AS ""自定义 SQL 查询""
  CROSS JOIN (SELECT MIN(""自定义 SQL 查询"".""date_range_1"") AS ""__measure__0"",
      MAX(""自定义 SQL 查询"".""date_range_2"") AS ""__measure__1""
    FROM (SELECT date,
          SUBSTR(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) AS date_range_1,
          SUBSTR(CAST(end_date AS VARCHAR), 1, 10) AS date_range_2,
          stat_period,
            CASE WHEN CAST(stat_period AS VARCHAR) = 'day' THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,
          area,
          vid,
          project,
          company_id AS cid,
          company_name AS company,
          customer_level AS level,
          vid_internal_industry_en AS industry,
          vid_use_case_cn,
          csdc_owner,
          os,
          ver,
          ver_type,
          product_level1,
          product_level2,
          product_level3,
          total,
          audio,
          video,
          video_sd,
          video_hd,
          video_hdp,
            host_audio + host_video AS host,
          host_audio,
          host_video,
          host_sd,
          host_hd,
          host_hdp,
            audience_audio + audience_video AS audience,
            audience_audio_low_latency + audience_video_low_latency AS audience_low_latency,
          audience_audio,
          audience_audio_low_latency,
          audience_video,
          audience_video_low_latency,
          audience_sd,
          audience_sd_low_latency,
          audience_hd,
          audience_hd_low_latency,
          audience_hdp,
          audience_hdp_low_latency,
          total_last1,
          audio_last1,
          video_last1,
          video_sd_last1,
          video_hd_last1,
          video_hdp_last1,
            host_audio_last1 + host_video_last1 AS host_last1,
          host_audio_last1,
          host_video_last1,
            audience_audio_last1 + audience_video_last1 AS audience_last1,
            audience_audio_low_latency_last1 + audience_video_low_latency_last1 AS audience_low_latency_last1,
          audience_audio_last1,
          audience_audio_low_latency_last1,
          audience_video_last1,
          audience_video_low_latency_last1,
          total_last7,
          audio_last7,
          video_last7,
          video_sd_last7,
          video_hd_last7,
          video_hdp_last7,
            host_audio_last7 + host_video_last7 AS host_last7,
          host_audio_last7,
          host_video_last7,
            audience_audio_last7 + audience_video_last7 AS audience_last7,
            audience_audio_low_latency_last7 + audience_video_low_latency_last7 AS audience_low_latency_last7,
          audience_audio_last7,
          audience_audio_low_latency_last7,
          audience_video_last7,
          audience_video_low_latency_last7
        FROM report_datahub.vendor_vid_usage_di_1
        WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-06') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-06') AND CAST(vid AS VARCHAR) = CAST(428342 AS VARCHAR) AND dim = 1) AS ""自定义 SQL 查询""
    HAVING COUNT(1) > 0) AS ""t0""
GROUP BY 2,
  3,
  4"
"SELECT MAX(""自定义 SQL 查询"".""period"") AS ""usr_Calculation_6733444459377328128_nk""
FROM (SELECT t1.date,
        CASE WHEN CAST(stat_period AS VARCHAR) = 'day' THEN substr(CAST(date_parse(cast( t1.date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(substr(CAST(start_date AS VARCHAR), 1, 10) AS VARCHAR), '~', CAST(substr(CAST(end_date AS VARCHAR), 1, 10) AS VARCHAR)) END AS period,
      start_date,
      end_date,
      stat_period,
      tag,
      t1.dim,
      level1,
      level2,
      level3,
      level4,
      os,
      ver,
      ver_type,
      domain,
      country,
      region,
      net,
      vid,
      project,
      company_id,
      company_name,
      rowsnum,
      lastusage,
      thisusage,
      fiveSecJoinSuccess,
      totalJoin,
      cnt_sid,
      video_freeze_time,
      video_totaltime,
      audio_freeze_time,
      audio_totaltime,
      s2l_total_delay_sec,
      s2l_25ms_delay_sec,
      s2l_75ms_delay_sec,
      p2s_lost_Leq5,
      p2s_lost_all,
      crash_cnt,
      service_cnt,
      ""1s_succ_join_ap_cnt"",
      ""5s_succ_join_ap_cnt"",
      total_join_ap_cnt,
      totalJoinSuccess,
      threeSecJoinSuccess,
      video_freeze_time_200,
      video_totaltime_200,
      video_freeze_time_500,
      video_totaltime_500,
      ""3s_succ_join_session_cnt_last1"",
      ""5s_succ_join_session_cnt_last1"",
      succ_join_session_cnt_last1,
      total_join_session_cnt_last1,
      total_session_cnt_last1,
      ""1s_succ_join_ap_cnt_last1"",
      ""5s_succ_join_ap_cnt_last1"",
      total_join_ap_cnt_last1,
      ""3s_succ_join_session_cnt_last7"",
      ""5s_succ_join_session_cnt_last7"",
      succ_join_session_cnt_last7,
      total_join_session_cnt_last7,
      total_session_cnt_last7,
      ""1s_succ_join_ap_cnt_last7"",
      ""5s_succ_join_ap_cnt_last7"",
      total_join_ap_cnt_last7,
      video_freeze_time_last1,
      video_totaltime_last1,
      video_freeze_time_500_last1,
      video_totaltime_500_last1,
      video_freeze_time_200_last1,
      video_totaltime_200_last1,
      video_freeze_time_last7,
      video_totaltime_last7,
      video_freeze_time_500_last7,
      video_totaltime_500_last7,
      video_freeze_time_200_last7,
      video_totaltime_200_last7,
      audio_freeze_time_last1,
      audio_totaltime_last1,
      audio_freeze_time_last7,
      audio_totaltime_last7,
      s2l_total_delay_sec_last1,
      s2l_25ms_delay_sec_last1,
      s2l_75ms_delay_sec_last1,
      s2l_total_delay_sec_last7,
      s2l_25ms_delay_sec_last7,
      s2l_75ms_delay_sec_last7,
      p2s_lost_Leq5_last1,
      p2s_lost_all_last1,
      p2s_lost_Leq5_last7,
      p2s_lost_all_last7,
      crash_cnt_last1,
      service_cnt_last1,
      crash_cnt_last7,
      service_cnt_last7,
      product_level1,
      product_level2,
      product_level3,
      product_level4,
      s2l_lost_Leq5,
      s2l_lost_all,
      s2l_lost_Leq5_last1,
      s2l_lost_all_last1,
      s2l_lost_Leq5_last7,
      s2l_lost_all_last7,
      fiveSecJoinSuccess_total,
      totalJoin_total,
      cnt_sid_total,
      video_freeze_time_total,
      video_totaltime_total,
      audio_freeze_time_total,
      audio_totaltime_total,
      s2l_total_delay_sec_total,
      s2l_25ms_delay_sec_total,
      s2l_75ms_delay_sec_total,
      p2s_lost_Leq5_total,
      p2s_lost_all_total,
      crash_cnt_total,
      service_cnt_total,
      ""1s_succ_join_ap_cnt_total"",
      ""5s_succ_join_ap_cnt_total"",
      total_join_ap_cnt_total,
      totalJoinSuccess_total,
      threeSecJoinSuccess_total,
      video_freeze_time_200_total,
      video_totaltime_200_total,
      video_freeze_time_500_total,
      video_totaltime_500_total,
      ""3s_succ_join_session_cnt_last1_total"",
      ""5s_succ_join_session_cnt_last1_total"",
      succ_join_session_cnt_last1_total,
      total_join_session_cnt_last1_total,
      total_session_cnt_last1_total,
      ""1s_succ_join_ap_cnt_last1_total"",
      ""5s_succ_join_ap_cnt_last1_total"",
      total_join_ap_cnt_last1_total,
      ""3s_succ_join_session_cnt_last7_total"",
      ""5s_succ_join_session_cnt_last7_total"",
      succ_join_session_cnt_last7_total,
      total_join_session_cnt_last7_total,
      total_session_cnt_last7_total,
      ""1s_succ_join_ap_cnt_last7_total"",
      ""5s_succ_join_ap_cnt_last7_total"",
      total_join_ap_cnt_last7_total,
      video_freeze_time_last1_total,
      video_totaltime_last1_total,
      video_freeze_time_500_last1_total,
      video_totaltime_500_last1_total,
      video_freeze_time_200_last1_total,
      video_totaltime_200_last1_total,
      video_freeze_time_last7_total,
      video_totaltime_last7_total,
      video_freeze_time_500_last7_total,
      video_totaltime_500_last7_total,
      video_freeze_time_200_last7_total,
      video_totaltime_200_last7_total,
      audio_freeze_time_last1_total,
      audio_totaltime_last1_total,
      audio_freeze_time_last7_total,
      audio_totaltime_last7_total,
      s2l_total_delay_sec_last1_total,
      s2l_25ms_delay_sec_last1_total,
      s2l_75ms_delay_sec_last1_total,
      s2l_total_delay_sec_last7_total,
      s2l_25ms_delay_sec_last7_total,
      s2l_75ms_delay_sec_last7_total,
      p2s_lost_Leq5_last1_total,
      p2s_lost_all_last1_total,
      p2s_lost_Leq5_last7_total,
      p2s_lost_all_last7_total,
      crash_cnt_last1_total,
      service_cnt_last1_total,
      crash_cnt_last7_total,
      service_cnt_last7_total,
      s2l_lost_Leq5_total,
      s2l_lost_all_total,
      s2l_lost_Leq5_last1_total,
      s2l_lost_all_last1_total,
      s2l_lost_Leq5_last7_total,
      s2l_lost_all_last7_total
    FROM report_datahub.pub_levels_quality_di_1 AS t1
      LEFT JOIN (SELECT date,
          dim,
          SUM(fiveSecJoinSuccess) AS fiveSecJoinSuccess_total,
          SUM(totalJoin) AS totalJoin_total,
          SUM(cnt_sid) AS cnt_sid_total,
          SUM(video_freeze_time) AS video_freeze_time_total,
          SUM(video_totaltime) AS video_totaltime_total,
          SUM(audio_freeze_time) AS audio_freeze_time_total,
          SUM(audio_totaltime) AS audio_totaltime_total,
          SUM(s2l_total_delay_sec) AS s2l_total_delay_sec_total,
          SUM(s2l_25ms_delay_sec) AS s2l_25ms_delay_sec_total,
          SUM(s2l_75ms_delay_sec) AS s2l_75ms_delay_sec_total,
          SUM(p2s_lost_Leq5) AS p2s_lost_Leq5_total,
          SUM(p2s_lost_all) AS p2s_lost_all_total,
          SUM(crash_cnt) AS crash_cnt_total,
          SUM(service_cnt) AS service_cnt_total,
          SUM(""1s_succ_join_ap_cnt"") AS ""1s_succ_join_ap_cnt_total"",
          SUM(""5s_succ_join_ap_cnt"") AS ""5s_succ_join_ap_cnt_total"",
          SUM(total_join_ap_cnt) AS total_join_ap_cnt_total,
          SUM(totalJoinSuccess) AS totalJoinSuccess_total,
          SUM(threeSecJoinSuccess) AS threeSecJoinSuccess_total,
          SUM(video_freeze_time_200) AS video_freeze_time_200_total,
          SUM(video_totaltime_200) AS video_totaltime_200_total,
          SUM(video_freeze_time_500) AS video_freeze_time_500_total,
          SUM(video_totaltime_500) AS video_totaltime_500_total,
          SUM(""3s_succ_join_session_cnt_last1"") AS ""3s_succ_join_session_cnt_last1_total"",
          SUM(""5s_succ_join_session_cnt_last1"") AS ""5s_succ_join_session_cnt_last1_total"",
          SUM(succ_join_session_cnt_last1) AS succ_join_session_cnt_last1_total,
          SUM(total_join_session_cnt_last1) AS total_join_session_cnt_last1_total,
          SUM(total_session_cnt_last1) AS total_session_cnt_last1_total,
          SUM(""1s_succ_join_ap_cnt_last1"") AS ""1s_succ_join_ap_cnt_last1_total"",
          SUM(""5s_succ_join_ap_cnt_last1"") AS ""5s_succ_join_ap_cnt_last1_total"",
          SUM(total_join_ap_cnt_last1) AS total_join_ap_cnt_last1_total,
          SUM(""3s_succ_join_session_cnt_last7"") AS ""3s_succ_join_session_cnt_last7_total"",
          SUM(""5s_succ_join_session_cnt_last7"") AS ""5s_succ_join_session_cnt_last7_total"",
          SUM(succ_join_session_cnt_last7) AS succ_join_session_cnt_last7_total,
          SUM(total_join_session_cnt_last7) AS total_join_session_cnt_last7_total,
          SUM(total_session_cnt_last7) AS total_session_cnt_last7_total,
          SUM(""1s_succ_join_ap_cnt_last7"") AS ""1s_succ_join_ap_cnt_last7_total"",
          SUM(""5s_succ_join_ap_cnt_last7"") AS ""5s_succ_join_ap_cnt_last7_total"",
          SUM(total_join_ap_cnt_last7) AS total_join_ap_cnt_last7_total,
          SUM(video_freeze_time_last1) AS video_freeze_time_last1_total,
          SUM(video_totaltime_last1) AS video_totaltime_last1_total,
          SUM(video_freeze_time_500_last1) AS video_freeze_time_500_last1_total,
          SUM(video_totaltime_500_last1) AS video_totaltime_500_last1_total,
          SUM(video_freeze_time_200_last1) AS video_freeze_time_200_last1_total,
          SUM(video_totaltime_200_last1) AS video_totaltime_200_last1_total,
          SUM(video_freeze_time_last7) AS video_freeze_time_last7_total,
          SUM(video_totaltime_last7) AS video_totaltime_last7_total,
          SUM(video_freeze_time_500_last7) AS video_freeze_time_500_last7_total,
          SUM(video_totaltime_500_last7) AS video_totaltime_500_last7_total,
          SUM(video_freeze_time_200_last7) AS video_freeze_time_200_last7_total,
          SUM(video_totaltime_200_last7) AS video_totaltime_200_last7_total,
          SUM(audio_freeze_time_last1) AS audio_freeze_time_last1_total,
          SUM(audio_totaltime_last1) AS audio_totaltime_last1_total,
          SUM(audio_freeze_time_last7) AS audio_freeze_time_last7_total,
          SUM(audio_totaltime_last7) AS audio_totaltime_last7_total,
          SUM(s2l_total_delay_sec_last1) AS s2l_total_delay_sec_last1_total,
          SUM(s2l_25ms_delay_sec_last1) AS s2l_25ms_delay_sec_last1_total,
          SUM(s2l_75ms_delay_sec_last1) AS s2l_75ms_delay_sec_last1_total,
          SUM(s2l_total_delay_sec_last7) AS s2l_total_delay_sec_last7_total,
          SUM(s2l_25ms_delay_sec_last7) AS s2l_25ms_delay_sec_last7_total,
          SUM(s2l_75ms_delay_sec_last7) AS s2l_75ms_delay_sec_last7_total,
          SUM(p2s_lost_Leq5_last1) AS p2s_lost_Leq5_last1_total,
          SUM(p2s_lost_all_last1) AS p2s_lost_all_last1_total,
          SUM(p2s_lost_Leq5_last7) AS p2s_lost_Leq5_last7_total,
          SUM(p2s_lost_all_last7) AS p2s_lost_all_last7_total,
          SUM(crash_cnt_last1) AS crash_cnt_last1_total,
          SUM(service_cnt_last1) AS service_cnt_last1_total,
          SUM(crash_cnt_last7) AS crash_cnt_last7_total,
          SUM(service_cnt_last7) AS service_cnt_last7_total,
          SUM(s2l_lost_Leq5) AS s2l_lost_Leq5_total,
          SUM(s2l_lost_all) AS s2l_lost_all_total,
          SUM(s2l_lost_Leq5_last1) AS s2l_lost_Leq5_last1_total,
          SUM(s2l_lost_all_last1) AS s2l_lost_all_last1_total,
          SUM(s2l_lost_Leq5_last7) AS s2l_lost_Leq5_last7_total,
          SUM(s2l_lost_all_last7) AS s2l_lost_all_last7_total
        FROM report_datahub.pub_levels_quality_di_1
        WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-21') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-05') AND CAST(tag AS VARCHAR) = 'Product'
        GROUP BY date,
          dim) AS t2 ON t1.date = t2.date AND t1.dim = t2.dim
    WHERE date_parse(cast( t1.date as VARCHAR), '%Y%m%d') >= DATE('2021-11-21') AND date_parse(cast( t1.date as VARCHAR), '%Y%m%d') <= DATE('2021-12-05') AND CAST(tag AS VARCHAR) = 'Product') AS ""自定义 SQL 查询""
  CROSS JOIN (SELECT MAX(date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d')) AS ""__measure__0""
    FROM (SELECT t1.date,
            CASE WHEN CAST(stat_period AS VARCHAR) = 'day' THEN substr(CAST(date_parse(cast( t1.date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(substr(CAST(start_date AS VARCHAR), 1, 10) AS VARCHAR), '~', CAST(substr(CAST(end_date AS VARCHAR), 1, 10) AS VARCHAR)) END AS period,
          start_date,
          end_date,
          stat_period,
          tag,
          t1.dim,
          level1,
          level2,
          level3,
          level4,
          os,
          ver,
          ver_type,
          domain,
          country,
          region,
          net,
          vid,
          project,
          company_id,
          company_name,
          rowsnum,
          lastusage,
          thisusage,
          fiveSecJoinSuccess,
          totalJoin,
          cnt_sid,
          video_freeze_time,
          video_totaltime,
          audio_freeze_time,
          audio_totaltime,
          s2l_total_delay_sec,
          s2l_25ms_delay_sec,
          s2l_75ms_delay_sec,
          p2s_lost_Leq5,
          p2s_lost_all,
          crash_cnt,
          service_cnt,
          ""1s_succ_join_ap_cnt"",
          ""5s_succ_join_ap_cnt"",
          total_join_ap_cnt,
          totalJoinSuccess,
          threeSecJoinSuccess,
          video_freeze_time_200,
          video_totaltime_200,
          video_freeze_time_500,
          video_totaltime_500,
          ""3s_succ_join_session_cnt_last1"",
          ""5s_succ_join_session_cnt_last1"",
          succ_join_session_cnt_last1,
          total_join_session_cnt_last1,
          total_session_cnt_last1,
          ""1s_succ_join_ap_cnt_last1"",
          ""5s_succ_join_ap_cnt_last1"",
          total_join_ap_cnt_last1,
          ""3s_succ_join_session_cnt_last7"",
          ""5s_succ_join_session_cnt_last7"",
          succ_join_session_cnt_last7,
          total_join_session_cnt_last7,
          total_session_cnt_last7,
          ""1s_succ_join_ap_cnt_last7"",
          ""5s_succ_join_ap_cnt_last7"",
          total_join_ap_cnt_last7,
          video_freeze_time_last1,
          video_totaltime_last1,
          video_freeze_time_500_last1,
          video_totaltime_500_last1,
          video_freeze_time_200_last1,
          video_totaltime_200_last1,
          video_freeze_time_last7,
          video_totaltime_last7,
          video_freeze_time_500_last7,
          video_totaltime_500_last7,
          video_freeze_time_200_last7,
          video_totaltime_200_last7,
          audio_freeze_time_last1,
          audio_totaltime_last1,
          audio_freeze_time_last7,
          audio_totaltime_last7,
          s2l_total_delay_sec_last1,
          s2l_25ms_delay_sec_last1,
          s2l_75ms_delay_sec_last1,
          s2l_total_delay_sec_last7,
          s2l_25ms_delay_sec_last7,
          s2l_75ms_delay_sec_last7,
          p2s_lost_Leq5_last1,
          p2s_lost_all_last1,
          p2s_lost_Leq5_last7,
          p2s_lost_all_last7,
          crash_cnt_last1,
          service_cnt_last1,
          crash_cnt_last7,
          service_cnt_last7,
          product_level1,
          product_level2,
          product_level3,
          product_level4,
          s2l_lost_Leq5,
          s2l_lost_all,
          s2l_lost_Leq5_last1,
          s2l_lost_all_last1,
          s2l_lost_Leq5_last7,
          s2l_lost_all_last7,
          fiveSecJoinSuccess_total,
          totalJoin_total,
          cnt_sid_total,
          video_freeze_time_total,
          video_totaltime_total,
          audio_freeze_time_total,
          audio_totaltime_total,
          s2l_total_delay_sec_total,
          s2l_25ms_delay_sec_total,
          s2l_75ms_delay_sec_total,
          p2s_lost_Leq5_total,
          p2s_lost_all_total,
          crash_cnt_total,
          service_cnt_total,
          ""1s_succ_join_ap_cnt_total"",
          ""5s_succ_join_ap_cnt_total"",
          total_join_ap_cnt_total,
          totalJoinSuccess_total,
          threeSecJoinSuccess_total,
          video_freeze_time_200_total,
          video_totaltime_200_total,
          video_freeze_time_500_total,
          video_totaltime_500_total,
          ""3s_succ_join_session_cnt_last1_total"",
          ""5s_succ_join_session_cnt_last1_total"",
          succ_join_session_cnt_last1_total,
          total_join_session_cnt_last1_total,
          total_session_cnt_last1_total,
          ""1s_succ_join_ap_cnt_last1_total"",
          ""5s_succ_join_ap_cnt_last1_total"",
          total_join_ap_cnt_last1_total,
          ""3s_succ_join_session_cnt_last7_total"",
          ""5s_succ_join_session_cnt_last7_total"",
          succ_join_session_cnt_last7_total,
          total_join_session_cnt_last7_total,
          total_session_cnt_last7_total,
          ""1s_succ_join_ap_cnt_last7_total"",
          ""5s_succ_join_ap_cnt_last7_total"",
          total_join_ap_cnt_last7_total,
          video_freeze_time_last1_total,
          video_totaltime_last1_total,
          video_freeze_time_500_last1_total,
          video_totaltime_500_last1_total,
          video_freeze_time_200_last1_total,
          video_totaltime_200_last1_total,
          video_freeze_time_last7_total,
          video_totaltime_last7_total,
          video_freeze_time_500_last7_total,
          video_totaltime_500_last7_total,
          video_freeze_time_200_last7_total,
          video_totaltime_200_last7_total,
          audio_freeze_time_last1_total,
          audio_totaltime_last1_total,
          audio_freeze_time_last7_total,
          audio_totaltime_last7_total,
          s2l_total_delay_sec_last1_total,
          s2l_25ms_delay_sec_last1_total,
          s2l_75ms_delay_sec_last1_total,
          s2l_total_delay_sec_last7_total,
          s2l_25ms_delay_sec_last7_total,
          s2l_75ms_delay_sec_last7_total,
          p2s_lost_Leq5_last1_total,
          p2s_lost_all_last1_total,
          p2s_lost_Leq5_last7_total,
          p2s_lost_all_last7_total,
          crash_cnt_last1_total,
          service_cnt_last1_total,
          crash_cnt_last7_total,
          service_cnt_last7_total,
          s2l_lost_Leq5_total,
          s2l_lost_all_total,
          s2l_lost_Leq5_last1_total,
          s2l_lost_all_last1_total,
          s2l_lost_Leq5_last7_total,
          s2l_lost_all_last7_total
        FROM report_datahub.pub_levels_quality_di_1 AS t1
          LEFT JOIN (SELECT date,
              dim,
              SUM(fiveSecJoinSuccess) AS fiveSecJoinSuccess_total,
              SUM(totalJoin) AS totalJoin_total,
              SUM(cnt_sid) AS cnt_sid_total,
              SUM(video_freeze_time) AS video_freeze_time_total,
              SUM(video_totaltime) AS video_totaltime_total,
              SUM(audio_freeze_time) AS audio_freeze_time_total,
              SUM(audio_totaltime) AS audio_totaltime_total,
              SUM(s2l_total_delay_sec) AS s2l_total_delay_sec_total,
              SUM(s2l_25ms_delay_sec) AS s2l_25ms_delay_sec_total,
              SUM(s2l_75ms_delay_sec) AS s2l_75ms_delay_sec_total,
              SUM(p2s_lost_Leq5) AS p2s_lost_Leq5_total,
              SUM(p2s_lost_all) AS p2s_lost_all_total,
              SUM(crash_cnt) AS crash_cnt_total,
              SUM(service_cnt) AS service_cnt_total,
              SUM(""1s_succ_join_ap_cnt"") AS ""1s_succ_join_ap_cnt_total"",
              SUM(""5s_succ_join_ap_cnt"") AS ""5s_succ_join_ap_cnt_total"",
              SUM(total_join_ap_cnt) AS total_join_ap_cnt_total,
              SUM(totalJoinSuccess) AS totalJoinSuccess_total,
              SUM(threeSecJoinSuccess) AS threeSecJoinSuccess_total,
              SUM(video_freeze_time_200) AS video_freeze_time_200_total,
              SUM(video_totaltime_200) AS video_totaltime_200_total,
              SUM(video_freeze_time_500) AS video_freeze_time_500_total,
              SUM(video_totaltime_500) AS video_totaltime_500_total,
              SUM(""3s_succ_join_session_cnt_last1"") AS ""3s_succ_join_session_cnt_last1_total"",
              SUM(""5s_succ_join_session_cnt_last1"") AS ""5s_succ_join_session_cnt_last1_total"",
              SUM(succ_join_session_cnt_last1) AS succ_join_session_cnt_last1_total,
              SUM(total_join_session_cnt_last1) AS total_join_session_cnt_last1_total,
              SUM(total_session_cnt_last1) AS total_session_cnt_last1_total,
              SUM(""1s_succ_join_ap_cnt_last1"") AS ""1s_succ_join_ap_cnt_last1_total"",
              SUM(""5s_succ_join_ap_cnt_last1"") AS ""5s_succ_join_ap_cnt_last1_total"",
              SUM(total_join_ap_cnt_last1) AS total_join_ap_cnt_last1_total,
              SUM(""3s_succ_join_session_cnt_last7"") AS ""3s_succ_join_session_cnt_last7_total"",
              SUM(""5s_succ_join_session_cnt_last7"") AS ""5s_succ_join_session_cnt_last7_total"",
              SUM(succ_join_session_cnt_last7) AS succ_join_session_cnt_last7_total,
              SUM(total_join_session_cnt_last7) AS total_join_session_cnt_last7_total,
              SUM(total_session_cnt_last7) AS total_session_cnt_last7_total,
              SUM(""1s_succ_join_ap_cnt_last7"") AS ""1s_succ_join_ap_cnt_last7_total"",
              SUM(""5s_succ_join_ap_cnt_last7"") AS ""5s_succ_join_ap_cnt_last7_total"",
              SUM(total_join_ap_cnt_last7) AS total_join_ap_cnt_last7_total,
              SUM(video_freeze_time_last1) AS video_freeze_time_last1_total,
              SUM(video_totaltime_last1) AS video_totaltime_last1_total,
              SUM(video_freeze_time_500_last1) AS video_freeze_time_500_last1_total,
              SUM(video_totaltime_500_last1) AS video_totaltime_500_last1_total,
              SUM(video_freeze_time_200_last1) AS video_freeze_time_200_last1_total,
              SUM(video_totaltime_200_last1) AS video_totaltime_200_last1_total,
              SUM(video_freeze_time_last7) AS video_freeze_time_last7_total,
              SUM(video_totaltime_last7) AS video_totaltime_last7_total,
              SUM(video_freeze_time_500_last7) AS video_freeze_time_500_last7_total,
              SUM(video_totaltime_500_last7) AS video_totaltime_500_last7_total,
              SUM(video_freeze_time_200_last7) AS video_freeze_time_200_last7_total,
              SUM(video_totaltime_200_last7) AS video_totaltime_200_last7_total,
              SUM(audio_freeze_time_last1) AS audio_freeze_time_last1_total,
              SUM(audio_totaltime_last1) AS audio_totaltime_last1_total,
              SUM(audio_freeze_time_last7) AS audio_freeze_time_last7_total,
              SUM(audio_totaltime_last7) AS audio_totaltime_last7_total,
              SUM(s2l_total_delay_sec_last1) AS s2l_total_delay_sec_last1_total,
              SUM(s2l_25ms_delay_sec_last1) AS s2l_25ms_delay_sec_last1_total,
              SUM(s2l_75ms_delay_sec_last1) AS s2l_75ms_delay_sec_last1_total,
              SUM(s2l_total_delay_sec_last7) AS s2l_total_delay_sec_last7_total,
              SUM(s2l_25ms_delay_sec_last7) AS s2l_25ms_delay_sec_last7_total,
              SUM(s2l_75ms_delay_sec_last7) AS s2l_75ms_delay_sec_last7_total,
              SUM(p2s_lost_Leq5_last1) AS p2s_lost_Leq5_last1_total,
              SUM(p2s_lost_all_last1) AS p2s_lost_all_last1_total,
              SUM(p2s_lost_Leq5_last7) AS p2s_lost_Leq5_last7_total,
              SUM(p2s_lost_all_last7) AS p2s_lost_all_last7_total,
              SUM(crash_cnt_last1) AS crash_cnt_last1_total,
              SUM(service_cnt_last1) AS service_cnt_last1_total,
              SUM(crash_cnt_last7) AS crash_cnt_last7_total,
              SUM(service_cnt_last7) AS service_cnt_last7_total,
              SUM(s2l_lost_Leq5) AS s2l_lost_Leq5_total,
              SUM(s2l_lost_all) AS s2l_lost_all_total,
              SUM(s2l_lost_Leq5_last1) AS s2l_lost_Leq5_last1_total,
              SUM(s2l_lost_all_last1) AS s2l_lost_all_last1_total,
              SUM(s2l_lost_Leq5_last7) AS s2l_lost_Leq5_last7_total,
              SUM(s2l_lost_all_last7) AS s2l_lost_all_last7_total
            FROM report_datahub.pub_levels_quality_di_1
            WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-21') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-05') AND CAST(tag AS VARCHAR) = 'Product'
            GROUP BY date,
              dim) AS t2 ON t1.date = t2.date AND t1.dim = t2.dim
        WHERE date_parse(cast( t1.date as VARCHAR), '%Y%m%d') >= DATE('2021-11-21') AND date_parse(cast( t1.date as VARCHAR), '%Y%m%d') <= DATE('2021-12-05') AND CAST(tag AS VARCHAR) = 'Product') AS ""自定义 SQL 查询""
    HAVING COUNT(1) > 0) AS ""t0""
WHERE CASE WHEN CAST(""自定义 SQL 查询"".""tag"" AS VARCHAR) = 'Industry' AND CAST(""自定义 SQL 查询"".""product_level1"" AS VARCHAR) = 'RTC' AND CAST(""自定义 SQL 查询"".""dim"" AS VARCHAR) = 'osver' THEN 0 WHEN CAST(""自定义 SQL 查询"".""tag"" AS VARCHAR) = 'VerType' AND CAST(""自定义 SQL 查询"".""product_level1"" AS VARCHAR) = 'RTC' AND CAST(""自定义 SQL 查询"".""dim"" AS VARCHAR) = 'osver' THEN 0 WHEN CAST(""自定义 SQL 查询"".""tag"" AS VARCHAR) = 'Product' AND CAST(""自定义 SQL 查询"".""dim"" AS VARCHAR) = 'osver' AND CAST(""自定义 SQL 查询"".""product_level1"" AS VARCHAR) = 'RTC' THEN 1 ELSE 0 END AND DATE_ADD('SECOND', 0, date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d')) = DATE_ADD('SECOND', 0, ""t0"".""__measure__0"")
HAVING COUNT(1) > 0"
"SELECT ""自定义 SQL 查询"".""level2"" AS ""level2"",
  SUM(""自定义 SQL 查询"".""totalUsage"") AS ""usr_Calculation_3519281700079370244_ok""
FROM (SELECT date,
        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,
      start_date AS start_date_7,
      end_date AS end_date,
      tag,
      area AS Scope,
      dim,
        CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,
      level2,
      level3,
      level4,
      product_level1 AS product_line,
      product_level2,
      product_level3,
      product_level4,
      vid_internal_industry_en AS cid_industry,
      vid_use_case_en AS vid_use_case_cn,
      vid_sector_en,
      ver_type,
      ver,
      os,
      domain,
      country,
      region,
      dim_grouping_name,
        CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,
      total AS totalUsage,
      audio,
      video,
      host_audio,
      audience_audio,
      host_sd,
      host_hd,
      host_hdp,
      host_1080p,
      host_2k,
      host_4k,
      audience_sd,
      audience_hd,
      audience_hdp,
      audience_1080p,
      audience_2k,
      audience_4k,
      audience_audio_low_latency,
      audience_sd_low_latency,
      audience_hd_low_latency,
      audience_hdp_low_latency,
      audience_1080p_low_latency,
      audience_2k_low_latency,
      audience_4k_low_latency,
      audience_audio_ultra_low_latency,
      audience_sd_ultra_low_latency,
      audience_hd_ultra_low_latency,
      audience_hdp_ultra_low_latency,
      audience_1080p_ultra_low_latency,
      audience_2k_ultra_low_latency,
      audience_4k_ultra_low_latency,
      total_last1 AS audio_video_last,
      audio_last1 AS audio_last,
      video_last1 AS video_last,
      video_sd_last1 AS video_sd_last,
      video_hd_last1 AS video_hd_last,
      video_hdp_last1 AS video_hdp_last,
      host_sd_last1 AS host_video_sd_last,
      audience_sd_last1 AS audience_video_sd_last,
      host_hd_last1 AS host_video_hd_last,
      audience_hd_last1 AS audience_video_hd_last,
      host_hdp_last1 AS host_video_hdp_last,
      audience_hdp_last1 AS audience_video_hdp_last,
      host_audio_last1 AS host_audio_last,
      audience_audio_last1 AS audience_audio_last,
      host_video_last1 AS host_video_last,
      audience_video_last1 AS audience_video_last,
      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,
      audience_video_low_latency_last1 AS audience_video_low_latency_last,
      audience_total_low_latency_last1 AS audience_total_low_latency_last,
      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,
      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,
      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,
      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,
      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,
      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,
      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,
      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,
      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,
      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,
      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,
      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,
      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,
      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,
      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,
      audience_2k_last1 AS audience_2k_last,
      audience_4k_last1 AS audience_4k_last,
      audience_1080p_last1 AS audience_1080p_last,
      host_1080p_last1 AS host_1080p_last,
      host_2k_last1 AS host_2k_last,
      host_4k_last1 AS host_4k_last,
      total_last7,
      audio_last7,
      video_last7,
      video_sd_last7,
      video_hd_last7,
      video_hdp_last7,
      host_sd_last7,
      audience_sd_last7,
      host_hd_last7,
      audience_hd_last7,
      host_hdp_last7,
      audience_hdp_last7,
      host_audio_last7,
      audience_audio_last7,
      host_video_last7,
      audience_video_last7,
      audience_audio_low_latency_last7,
      audience_video_low_latency_last7,
      audience_total_low_latency_last7,
      audience_sd_low_latency_last7,
      audience_hd_low_latency_last7,
      audience_hdp_low_latency_last7,
      audience_1080p_low_latency_last7,
      audience_2k_low_latency_last7,
      audience_4k_low_latency_last7,
      audience_audio_ultra_low_latency_last7,
      audience_video_ultra_low_latency_last7,
      audience_total_ultra_low_latency_last7,
      audience_sd_ultra_low_latency_last7,
      audience_hd_ultra_low_latency_last7,
      audience_hdp_ultra_low_latency_last7,
      audience_1080p_ultra_low_latency_last7,
      audience_2k_ultra_low_latency_last7,
      audience_4k_ultra_low_latency_last7,
      audience_2k_last7,
      audience_4k_last7,
      audience_1080p_last7,
      host_1080p_last7,
      host_2k_last7,
      host_4k_last7
    FROM levels_usage_dod_di_1
    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-06') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-04') AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS ""自定义 SQL 查询""
WHERE ""自定义 SQL 查询"".""dim"" = 1
GROUP BY 1"
"SELECT SUM(""自定义 SQL 查询"".""host_4k_last"") AS ""TEMP(Calculation_3519281700083154949)(101123376)(0)"",
  SUM(""自定义 SQL 查询"".""host_4k"") AS ""TEMP(Calculation_3519281700083154949)(1075454865)(0)"",
  SUM(""自定义 SQL 查询"".""audience_sd"") AS ""TEMP(Calculation_3519281700083154949)(1133678835)(0)"",
  SUM(""自定义 SQL 查询"".""audience_video_hdp_last"") AS ""TEMP(Calculation_3519281700083154949)(1200517625)(0)"",
  SUM(""自定义 SQL 查询"".""host_1080p"") AS ""TEMP(Calculation_3519281700083154949)(1312501967)(0)"",
  SUM(""自定义 SQL 查询"".""audience_1080p_last"") AS ""TEMP(Calculation_3519281700083154949)(1314346200)(0)"",
  SUM(""自定义 SQL 查询"".""audience_video_hd_last"") AS ""TEMP(Calculation_3519281700083154949)(146570423)(0)"",
  SUM(""自定义 SQL 查询"".""audience_2k_last"") AS ""TEMP(Calculation_3519281700083154949)(1717771635)(0)"",
  SUM(""自定义 SQL 查询"".""audience_audio_last"") AS ""TEMP(Calculation_3519281700083154949)(2313111073)(0)"",
  SUM(""自定义 SQL 查询"".""host_video_hdp_last"") AS ""TEMP(Calculation_3519281700083154949)(258310559)(0)"",
  SUM(""自定义 SQL 查询"".""host_hd"") AS ""TEMP(Calculation_3519281700083154949)(276907208)(0)"",
  SUM(""自定义 SQL 查询"".""audio_video_last"") AS ""TEMP(Calculation_3519281700083154949)(2820618408)(0)"",
  SUM(""自定义 SQL 查询"".""video"") AS ""TEMP(Calculation_3519281700083154949)(2929708110)(0)"",
  SUM(""自定义 SQL 查询"".""audience_hd"") AS ""TEMP(Calculation_3519281700083154949)(2930728935)(0)"",
  SUM(""自定义 SQL 查询"".""audience_hdp"") AS ""TEMP(Calculation_3519281700083154949)(3010533957)(0)"",
  SUM(""自定义 SQL 查询"".""host_hdp"") AS ""TEMP(Calculation_3519281700083154949)(30306054)(0)"",
  SUM(""自定义 SQL 查询"".""host_audio"") AS ""TEMP(Calculation_3519281700083154949)(3087054365)(0)"",
  SUM(""自定义 SQL 查询"".""audience_4k_last"") AS ""TEMP(Calculation_3519281700083154949)(3121859593)(0)"",
  SUM(""自定义 SQL 查询"".""host_1080p_last"") AS ""TEMP(Calculation_3519281700083154949)(3222422303)(0)"",
  SUM(""自定义 SQL 查询"".""host_audio_last"") AS ""TEMP(Calculation_3519281700083154949)(3227677803)(0)"",
  SUM(""自定义 SQL 查询"".""audio"") AS ""TEMP(Calculation_3519281700083154949)(3299350010)(0)"",
  SUM(""自定义 SQL 查询"".""audience_1080p"") AS ""TEMP(Calculation_3519281700083154949)(3628946582)(0)"",
  SUM(""自定义 SQL 查询"".""totalUsage"") AS ""TEMP(Calculation_3519281700083154949)(3847882359)(0)"",
  SUM(""自定义 SQL 查询"".""video_last"") AS ""TEMP(Calculation_3519281700083154949)(3934387163)(0)"",
  SUM(""自定义 SQL 查询"".""host_2k_last"") AS ""TEMP(Calculation_3519281700083154949)(4055292783)(0)"",
  SUM(""自定义 SQL 查询"".""audio_last"") AS ""TEMP(Calculation_3519281700083154949)(4091190060)(0)"",
  SUM(""自定义 SQL 查询"".""audience_audio"") AS ""TEMP(Calculation_3519281700083154949)(4109514392)(0)"",
  SUM(""自定义 SQL 查询"".""host_video_hd_last"") AS ""TEMP(Calculation_3519281700083154949)(4170367250)(0)"",
  SUM(""自定义 SQL 查询"".""host_video_sd_last"") AS ""TEMP(Calculation_3519281700083154949)(4190307025)(0)"",
  SUM(""自定义 SQL 查询"".""host_2k"") AS ""TEMP(Calculation_3519281700083154949)(586790827)(0)"",
  SUM(""自定义 SQL 查询"".""host_sd"") AS ""TEMP(Calculation_3519281700083154949)(709512178)(0)"",
  SUM(""自定义 SQL 查询"".""audience_4k"") AS ""TEMP(Calculation_3519281700083154949)(764410224)(0)"",
  SUM(""自定义 SQL 查询"".""audience_video_sd_last"") AS ""TEMP(Calculation_3519281700083154949)(933007102)(0)"",
  SUM(""自定义 SQL 查询"".""audience_2k"") AS ""TEMP(Calculation_3519281700083154949)(943764407)(0)"",
  AVG(""自定义 SQL 查询"".""totalUsage"") AS ""avg_totalUsage_ok"",
  ""自定义 SQL 查询"".""level1"" AS ""level1"",
  SUM(""自定义 SQL 查询"".""totalUsage"") AS ""sum_totalUsage_ok""
FROM (SELECT date,
        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,
      start_date AS start_date_7,
      end_date AS end_date,
      tag,
      area AS Scope,
      dim,
        CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,
      level2,
      level3,
      level4,
      product_level1 AS product_line,
      product_level2,
      product_level3,
      product_level4,
      vid_internal_industry_en AS cid_industry,
      vid_use_case_en AS vid_use_case_cn,
      vid_sector_en,
      ver_type,
      ver,
      os,
      domain,
      country,
      region,
      dim_grouping_name,
        CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,
      total AS totalUsage,
      audio,
      video,
      host_audio,
      audience_audio,
      host_sd,
      host_hd,
      host_hdp,
      host_1080p,
      host_2k,
      host_4k,
      audience_sd,
      audience_hd,
      audience_hdp,
      audience_1080p,
      audience_2k,
      audience_4k,
      audience_audio_low_latency,
      audience_sd_low_latency,
      audience_hd_low_latency,
      audience_hdp_low_latency,
      audience_1080p_low_latency,
      audience_2k_low_latency,
      audience_4k_low_latency,
      audience_audio_ultra_low_latency,
      audience_sd_ultra_low_latency,
      audience_hd_ultra_low_latency,
      audience_hdp_ultra_low_latency,
      audience_1080p_ultra_low_latency,
      audience_2k_ultra_low_latency,
      audience_4k_ultra_low_latency,
      total_last1 AS audio_video_last,
      audio_last1 AS audio_last,
      video_last1 AS video_last,
      video_sd_last1 AS video_sd_last,
      video_hd_last1 AS video_hd_last,
      video_hdp_last1 AS video_hdp_last,
      host_sd_last1 AS host_video_sd_last,
      audience_sd_last1 AS audience_video_sd_last,
      host_hd_last1 AS host_video_hd_last,
      audience_hd_last1 AS audience_video_hd_last,
      host_hdp_last1 AS host_video_hdp_last,
      audience_hdp_last1 AS audience_video_hdp_last,
      host_audio_last1 AS host_audio_last,
      audience_audio_last1 AS audience_audio_last,
      host_video_last1 AS host_video_last,
      audience_video_last1 AS audience_video_last,
      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,
      audience_video_low_latency_last1 AS audience_video_low_latency_last,
      audience_total_low_latency_last1 AS audience_total_low_latency_last,
      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,
      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,
      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,
      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,
      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,
      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,
      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,
      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,
      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,
      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,
      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,
      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,
      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,
      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,
      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,
      audience_2k_last1 AS audience_2k_last,
      audience_4k_last1 AS audience_4k_last,
      audience_1080p_last1 AS audience_1080p_last,
      host_1080p_last1 AS host_1080p_last,
      host_2k_last1 AS host_2k_last,
      host_4k_last1 AS host_4k_last,
      total_last7,
      audio_last7,
      video_last7,
      video_sd_last7,
      video_hd_last7,
      video_hdp_last7,
      host_sd_last7,
      audience_sd_last7,
      host_hd_last7,
      audience_hd_last7,
      host_hdp_last7,
      audience_hdp_last7,
      host_audio_last7,
      audience_audio_last7,
      host_video_last7,
      audience_video_last7,
      audience_audio_low_latency_last7,
      audience_video_low_latency_last7,
      audience_total_low_latency_last7,
      audience_sd_low_latency_last7,
      audience_hd_low_latency_last7,
      audience_hdp_low_latency_last7,
      audience_1080p_low_latency_last7,
      audience_2k_low_latency_last7,
      audience_4k_low_latency_last7,
      audience_audio_ultra_low_latency_last7,
      audience_video_ultra_low_latency_last7,
      audience_total_ultra_low_latency_last7,
      audience_sd_ultra_low_latency_last7,
      audience_hd_ultra_low_latency_last7,
      audience_hdp_ultra_low_latency_last7,
      audience_1080p_ultra_low_latency_last7,
      audience_2k_ultra_low_latency_last7,
      audience_4k_ultra_low_latency_last7,
      audience_2k_last7,
      audience_4k_last7,
      audience_1080p_last7,
      host_1080p_last7,
      host_2k_last7,
      host_4k_last7
    FROM levels_usage_dod_di_1
    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-06') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-04') AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS ""自定义 SQL 查询""
  CROSS JOIN (SELECT MAX(date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d')) AS ""__measure__0""
    FROM (SELECT date,
            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,
          start_date AS start_date_7,
          end_date AS end_date,
          tag,
          area AS Scope,
          dim,
            CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,
          level2,
          level3,
          level4,
          product_level1 AS product_line,
          product_level2,
          product_level3,
          product_level4,
          vid_internal_industry_en AS cid_industry,
          vid_use_case_en AS vid_use_case_cn,
          vid_sector_en,
          ver_type,
          ver,
          os,
          domain,
          country,
          region,
          dim_grouping_name,
            CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,
          total AS totalUsage,
          audio,
          video,
          host_audio,
          audience_audio,
          host_sd,
          host_hd,
          host_hdp,
          host_1080p,
          host_2k,
          host_4k,
          audience_sd,
          audience_hd,
          audience_hdp,
          audience_1080p,
          audience_2k,
          audience_4k,
          audience_audio_low_latency,
          audience_sd_low_latency,
          audience_hd_low_latency,
          audience_hdp_low_latency,
          audience_1080p_low_latency,
          audience_2k_low_latency,
          audience_4k_low_latency,
          audience_audio_ultra_low_latency,
          audience_sd_ultra_low_latency,
          audience_hd_ultra_low_latency,
          audience_hdp_ultra_low_latency,
          audience_1080p_ultra_low_latency,
          audience_2k_ultra_low_latency,
          audience_4k_ultra_low_latency,
          total_last1 AS audio_video_last,
          audio_last1 AS audio_last,
          video_last1 AS video_last,
          video_sd_last1 AS video_sd_last,
          video_hd_last1 AS video_hd_last,
          video_hdp_last1 AS video_hdp_last,
          host_sd_last1 AS host_video_sd_last,
          audience_sd_last1 AS audience_video_sd_last,
          host_hd_last1 AS host_video_hd_last,
          audience_hd_last1 AS audience_video_hd_last,
          host_hdp_last1 AS host_video_hdp_last,
          audience_hdp_last1 AS audience_video_hdp_last,
          host_audio_last1 AS host_audio_last,
          audience_audio_last1 AS audience_audio_last,
          host_video_last1 AS host_video_last,
          audience_video_last1 AS audience_video_last,
          audience_audio_low_latency_last1 AS audience_audio_low_latency_last,
          audience_video_low_latency_last1 AS audience_video_low_latency_last,
          audience_total_low_latency_last1 AS audience_total_low_latency_last,
          audience_sd_low_latency_last1 AS audience_sd_low_latency_last,
          audience_hd_low_latency_last1 AS audience_hd_low_latency_last,
          audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,
          audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,
          audience_2k_low_latency_last1 AS audience_2k_low_latency_last,
          audience_4k_low_latency_last1 AS audience_4k_low_latency_last,
          audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,
          audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,
          audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,
          audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,
          audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,
          audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,
          audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,
          audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,
          audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,
          audience_2k_last1 AS audience_2k_last,
          audience_4k_last1 AS audience_4k_last,
          audience_1080p_last1 AS audience_1080p_last,
          host_1080p_last1 AS host_1080p_last,
          host_2k_last1 AS host_2k_last,
          host_4k_last1 AS host_4k_last,
          total_last7,
          audio_last7,
          video_last7,
          video_sd_last7,
          video_hd_last7,
          video_hdp_last7,
          host_sd_last7,
          audience_sd_last7,
          host_hd_last7,
          audience_hd_last7,
          host_hdp_last7,
          audience_hdp_last7,
          host_audio_last7,
          audience_audio_last7,
          host_video_last7,
          audience_video_last7,
          audience_audio_low_latency_last7,
          audience_video_low_latency_last7,
          audience_total_low_latency_last7,
          audience_sd_low_latency_last7,
          audience_hd_low_latency_last7,
          audience_hdp_low_latency_last7,
          audience_1080p_low_latency_last7,
          audience_2k_low_latency_last7,
          audience_4k_low_latency_last7,
          audience_audio_ultra_low_latency_last7,
          audience_video_ultra_low_latency_last7,
          audience_total_ultra_low_latency_last7,
          audience_sd_ultra_low_latency_last7,
          audience_hd_ultra_low_latency_last7,
          audience_hdp_ultra_low_latency_last7,
          audience_1080p_ultra_low_latency_last7,
          audience_2k_ultra_low_latency_last7,
          audience_4k_ultra_low_latency_last7,
          audience_2k_last7,
          audience_4k_last7,
          audience_1080p_last7,
          host_1080p_last7,
          host_2k_last7,
          host_4k_last7
        FROM levels_usage_dod_di_1
        WHERE CAST(tag AS VARCHAR) = 'Industry' AND date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-06') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-04') AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS ""自定义 SQL 查询""
    HAVING COUNT(1) > 0) AS ""t0""
WHERE ""自定义 SQL 查询"".""dim"" = 1 AND ""自定义 SQL 查询"".""rank_level1"" = 5 AND date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d') = ""t0"".""__measure__0""
GROUP BY 36"
"SELECT ""自定义 SQL 查询"".""country"" AS ""country""
FROM (SELECT *
    FROM media.sdrtn_okr_notvpn
    WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-16') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-11-29')) AS ""自定义 SQL 查询""
GROUP BY 1
ORDER BY ""country"""
"SELECT ""t0"".""idc"" AS ""idc""
FROM (SELECT ""自定义 SQL 查询"".""idc"" AS ""idc""
    FROM (SELECT date AS ""date"",
          src_domain AS ""srcDomain"",
          src_region AS ""srcRegion"",
          dest_idc AS ""idc"",
          delay_25 AS ""p2s_Delay25"",
          delay_50 AS ""p2s_Delay50"",
          delay_75 AS ""p2s_Delay75"",
          delay_100 AS ""p2s_Delay100"",
          delay_125 AS ""p2s_Delay125"",
          delay_150 AS ""p2s_Delay150"",
          delay_total,
          lost_ratio_5 AS ""p2s_lostRatio"",
          lostratio_total AS ""p2s_total"",
          jitter95_50 AS ""p2s_jitter95_50"",
          jitter95_100 AS ""p2s_jitter95_100"",
          jitter95_200 AS ""p2s_jitter95_200"",
          jitter95_300 AS ""p2s_jitter95_300"",
          jitter95_total,
          product_line,
          product_type
        FROM media.p2s_cover_mainland_ip
        WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-25') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-01')) AS ""自定义 SQL 查询""
    WHERE CAST(""自定义 SQL 查询"".""srcRegion"" AS VARCHAR) >= 'Anhui' AND CAST(""自定义 SQL 查询"".""srcRegion"" AS VARCHAR) <= 'Zhejiang'
    GROUP BY 1,
      ""自定义 SQL 查询"".""srcRegion""
    HAVING CAST(CASE WHEN SUM(""自定义 SQL 查询"".""p2s_total"") >= 0 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100 THEN '0-100' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 1000 THEN '100-1000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 1000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 10000 THEN '1000-10000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 10000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100000 THEN '10000-100000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100000 THEN '100000以上' ELSE 'other' END AS VARCHAR) = '0-100' OR CAST(CASE WHEN SUM(""自定义 SQL 查询"".""p2s_total"") >= 0 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100 THEN '0-100' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 1000 THEN '100-1000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 1000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 10000 THEN '1000-10000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 10000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100000 THEN '10000-100000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100000 THEN '100000以上' ELSE 'other' END AS VARCHAR) = '100-1000' OR CAST(CASE WHEN SUM(""自定义 SQL 查询"".""p2s_total"") >= 0 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100 THEN '0-100' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 1000 THEN '100-1000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 1000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 10000 THEN '1000-10000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 10000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100000 THEN '10000-100000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100000 THEN '100000以上' ELSE 'other' END AS VARCHAR) = '1000-10000' OR CAST(CASE WHEN SUM(""自定义 SQL 查询"".""p2s_total"") >= 0 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100 THEN '0-100' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 1000 THEN '100-1000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 1000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 10000 THEN '1000-10000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 10000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100000 THEN '10000-100000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100000 THEN '100000以上' ELSE 'other' END AS VARCHAR) = '10000-100000' OR CAST(CASE WHEN SUM(""自定义 SQL 查询"".""p2s_total"") >= 0 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100 THEN '0-100' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 1000 THEN '100-1000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 1000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 10000 THEN '1000-10000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 10000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100000 THEN '10000-100000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100000 THEN '100000以上' ELSE 'other' END AS VARCHAR) = '100000以上') AS ""t0""
GROUP BY 1"
"SELECT SUM(""自定义 SQL 查询"".""s2l_25ms_delay_sec_last7"") AS ""TEMP(Calculation_1430244791162150914)(10119751)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_25ms_delay_sec"") AS ""TEMP(Calculation_1430244791162150914)(2227145667)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_total_delay_sec"") AS ""TEMP(Calculation_1430244791162150914)(2460078802)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_total_delay_sec_last7"") AS ""TEMP(Calculation_1430244791162150914)(3558359569)(0)"",
  SUM(""自定义 SQL 查询"".""5s_succ_join_ap_cnt"") AS ""TEMP(Calculation_1430244791249522705)(1716451703)(0)"",
  SUM(""自定义 SQL 查询"".""total_join_ap_cnt_last7"") AS ""TEMP(Calculation_1430244791249522705)(2573436739)(0)"",
  SUM(""自定义 SQL 查询"".""total_join_ap_cnt"") AS ""TEMP(Calculation_1430244791249522705)(2681092799)(0)"",
  SUM(""自定义 SQL 查询"".""5s_succ_join_ap_cnt_last7"") AS ""TEMP(Calculation_1430244791249522705)(2802323494)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_75ms_delay_sec"") AS ""TEMP(Calculation_6542393318886535170)(2003933318)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_75ms_delay_sec_last7"") AS ""TEMP(Calculation_6542393318886535170)(775655446)(0)"",
  SUM(""自定义 SQL 查询"".""totalJoin"") AS ""TEMP(Calculation_7034341207023464449)(2073556184)(0)"",
  SUM(""自定义 SQL 查询"".""3s_succ_join_session_cnt_last7"") AS ""TEMP(Calculation_7034341207023464449)(2344416377)(0)"",
  SUM(""自定义 SQL 查询"".""total_join_session_cnt_last7"") AS ""TEMP(Calculation_7034341207023464449)(3093209995)(0)"",
  SUM(""自定义 SQL 查询"".""threeSecJoinSuccess"") AS ""TEMP(Calculation_7034341207023464449)(3693645608)(0)"",
  SUM(""自定义 SQL 查询"".""5s_succ_join_session_cnt_last7"") AS ""TEMP(Calculation_7034341207023988739)(1073906376)(0)"",
  SUM(""自定义 SQL 查询"".""fiveSecJoinSuccess"") AS ""TEMP(Calculation_7034341207023988739)(383616769)(0)"",
  SUM(""自定义 SQL 查询"".""succ_join_session_cnt_last7"") AS ""TEMP(Calculation_7034341207025020933)(2300438540)(0)"",
  SUM(""自定义 SQL 查询"".""totalJoinSuccess"") AS ""TEMP(Calculation_7034341207025020933)(2807417001)(0)"",
  SUM(""自定义 SQL 查询"".""video_totaltime_last7"") AS ""TEMP(Calculation_7034341207025557511)(2411308906)(0)"",
  SUM(""自定义 SQL 查询"".""video_totaltime"") AS ""TEMP(Calculation_7034341207025557511)(2797449586)(0)"",
  SUM(""自定义 SQL 查询"".""video_freeze_time"") AS ""TEMP(Calculation_7034341207025557511)(2940759860)(0)"",
  SUM(""自定义 SQL 查询"".""video_freeze_time_last7"") AS ""TEMP(Calculation_7034341207025557511)(3152166089)(0)"",
  SUM(""自定义 SQL 查询"".""audio_totaltime"") AS ""TEMP(Calculation_7034341207025938441)(1652566750)(0)"",
  SUM(""自定义 SQL 查询"".""audio_freeze_time"") AS ""TEMP(Calculation_7034341207025938441)(2919389392)(0)"",
  SUM(""自定义 SQL 查询"".""audio_freeze_time_last7"") AS ""TEMP(Calculation_7034341207025938441)(3377500597)(0)"",
  SUM(""自定义 SQL 查询"".""audio_totaltime_last7"") AS ""TEMP(Calculation_7034341207025938441)(489775499)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_lost_Leq5_last7"") AS ""TEMP(Calculation_7034341207026606091)(2526464233)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_lost_Leq5"") AS ""TEMP(Calculation_7034341207026606091)(2745840127)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_lost_all_last7"") AS ""TEMP(Calculation_7034341207026606091)(453870284)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_lost_all"") AS ""TEMP(Calculation_7034341207026606091)(734589263)(0)"",
  SUM(""自定义 SQL 查询"".""crash_cnt_last7"") AS ""TEMP(Calculation_7034341207372492815)(2315319037)(0)"",
  SUM(""自定义 SQL 查询"".""crash_cnt"") AS ""TEMP(Calculation_7034341207372492815)(2360900687)(0)"",
  SUM(""自定义 SQL 查询"".""service_cnt_last7"") AS ""TEMP(Calculation_7034341207372492815)(3843063028)(0)"",
  SUM(""自定义 SQL 查询"".""service_cnt"") AS ""TEMP(Calculation_7034341207372492815)(4291252132)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_lost_all_last7"") AS ""TEMP(Calculation_75998310508670977)(1411695322)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_lost_Leq5"") AS ""TEMP(Calculation_75998310508670977)(1936123547)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_lost_all"") AS ""TEMP(Calculation_75998310508670977)(749826584)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_lost_Leq5_last7"") AS ""TEMP(Calculation_75998310508670977)(790094525)(0)""
FROM (SELECT date,
        CASE WHEN CAST(stat_period AS VARCHAR) = 'day' THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(substr(CAST(start_date AS VARCHAR), 1, 10) AS VARCHAR), '~', CAST(substr(CAST(end_date AS VARCHAR), 1, 10) AS VARCHAR)) END AS period,
      start_date,
      end_date,
      stat_period,
      tag,
      dim,
      level1,
      level2,
      level3,
      level4,
      '' AS pd,
      os,
      ver,
      ver_type,
      '' AS product_line,
      '' AS product_type,
      domain,
      country,
      region,
      net,
      vid,
      project,
      company_id,
      company_name,
      rowsnum,
      lastusage,
      thisusage,
      fiveSecJoinSuccess,
      totalJoin,
      cnt_sid,
      video_freeze_time,
      video_totaltime,
      audio_freeze_time,
      audio_totaltime,
      s2l_total_delay_sec,
      s2l_25ms_delay_sec,
      s2l_75ms_delay_sec,
      p2s_lost_Leq5,
      p2s_lost_all,
      crash_cnt,
      service_cnt,
      ""1s_succ_join_ap_cnt"",
      ""5s_succ_join_ap_cnt"",
      total_join_ap_cnt,
      totalJoinSuccess,
      threeSecJoinSuccess,
      video_freeze_time_200,
      video_totaltime_200,
      video_freeze_time_500,
      video_totaltime_500,
      ""3s_succ_join_session_cnt_last1"",
      ""5s_succ_join_session_cnt_last1"",
      succ_join_session_cnt_last1,
      total_join_session_cnt_last1,
      total_session_cnt_last1,
      ""1s_succ_join_ap_cnt_last1"",
      ""5s_succ_join_ap_cnt_last1"",
      total_join_ap_cnt_last1,
      ""3s_succ_join_session_cnt_last7"",
      ""5s_succ_join_session_cnt_last7"",
      succ_join_session_cnt_last7,
      total_join_session_cnt_last7,
      total_session_cnt_last7,
      ""1s_succ_join_ap_cnt_last7"",
      ""5s_succ_join_ap_cnt_last7"",
      total_join_ap_cnt_last7,
      video_freeze_time_last1,
      video_totaltime_last1,
      video_freeze_time_500_last1,
      video_totaltime_500_last1,
      video_freeze_time_200_last1,
      video_totaltime_200_last1,
      video_freeze_time_last7,
      video_totaltime_last7,
      video_freeze_time_500_last7,
      video_totaltime_500_last7,
      video_freeze_time_200_last7,
      video_totaltime_200_last7,
      audio_freeze_time_last1,
      audio_totaltime_last1,
      audio_freeze_time_last7,
      audio_totaltime_last7,
      s2l_total_delay_sec_last1,
      s2l_25ms_delay_sec_last1,
      s2l_75ms_delay_sec_last1,
      s2l_total_delay_sec_last7,
      s2l_25ms_delay_sec_last7,
      s2l_75ms_delay_sec_last7,
      p2s_lost_Leq5_last1,
      p2s_lost_all_last1,
      p2s_lost_Leq5_last7,
      p2s_lost_all_last7,
      crash_cnt_last1,
      service_cnt_last1,
      crash_cnt_last7,
      service_cnt_last7,
      product_level1,
      product_level2,
      product_level3,
      product_level4,
      s2l_lost_Leq5,
      s2l_lost_all,
      s2l_lost_Leq5_last1,
      s2l_lost_all_last1,
      s2l_lost_Leq5_last7,
      s2l_lost_all_last7
    FROM report_datahub.pub_levels_quality_di_1
    WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-21') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-11-21')) AS ""自定义 SQL 查询""
  CROSS JOIN (SELECT MAX(date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d')) AS ""__measure__0""
    FROM (SELECT date,
            CASE WHEN CAST(stat_period AS VARCHAR) = 'day' THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(substr(CAST(start_date AS VARCHAR), 1, 10) AS VARCHAR), '~', CAST(substr(CAST(end_date AS VARCHAR), 1, 10) AS VARCHAR)) END AS period,
          start_date,
          end_date,
          stat_period,
          tag,
          dim,
          level1,
          level2,
          level3,
          level4,
          '' AS pd,
          os,
          ver,
          ver_type,
          '' AS product_line,
          '' AS product_type,
          domain,
          country,
          region,
          net,
          vid,
          project,
          company_id,
          company_name,
          rowsnum,
          lastusage,
          thisusage,
          fiveSecJoinSuccess,
          totalJoin,
          cnt_sid,
          video_freeze_time,
          video_totaltime,
          audio_freeze_time,
          audio_totaltime,
          s2l_total_delay_sec,
          s2l_25ms_delay_sec,
          s2l_75ms_delay_sec,
          p2s_lost_Leq5,
          p2s_lost_all,
          crash_cnt,
          service_cnt,
          ""1s_succ_join_ap_cnt"",
          ""5s_succ_join_ap_cnt"",
          total_join_ap_cnt,
          totalJoinSuccess,
          threeSecJoinSuccess,
          video_freeze_time_200,
          video_totaltime_200,
          video_freeze_time_500,
          video_totaltime_500,
          ""3s_succ_join_session_cnt_last1"",
          ""5s_succ_join_session_cnt_last1"",
          succ_join_session_cnt_last1,
          total_join_session_cnt_last1,
          total_session_cnt_last1,
          ""1s_succ_join_ap_cnt_last1"",
          ""5s_succ_join_ap_cnt_last1"",
          total_join_ap_cnt_last1,
          ""3s_succ_join_session_cnt_last7"",
          ""5s_succ_join_session_cnt_last7"",
          succ_join_session_cnt_last7,
          total_join_session_cnt_last7,
          total_session_cnt_last7,
          ""1s_succ_join_ap_cnt_last7"",
          ""5s_succ_join_ap_cnt_last7"",
          total_join_ap_cnt_last7,
          video_freeze_time_last1,
          video_totaltime_last1,
          video_freeze_time_500_last1,
          video_totaltime_500_last1,
          video_freeze_time_200_last1,
          video_totaltime_200_last1,
          video_freeze_time_last7,
          video_totaltime_last7,
          video_freeze_time_500_last7,
          video_totaltime_500_last7,
          video_freeze_time_200_last7,
          video_totaltime_200_last7,
          audio_freeze_time_last1,
          audio_totaltime_last1,
          audio_freeze_time_last7,
          audio_totaltime_last7,
          s2l_total_delay_sec_last1,
          s2l_25ms_delay_sec_last1,
          s2l_75ms_delay_sec_last1,
          s2l_total_delay_sec_last7,
          s2l_25ms_delay_sec_last7,
          s2l_75ms_delay_sec_last7,
          p2s_lost_Leq5_last1,
          p2s_lost_all_last1,
          p2s_lost_Leq5_last7,
          p2s_lost_all_last7,
          crash_cnt_last1,
          service_cnt_last1,
          crash_cnt_last7,
          service_cnt_last7,
          product_level1,
          product_level2,
          product_level3,
          product_level4,
          s2l_lost_Leq5,
          s2l_lost_all,
          s2l_lost_Leq5_last1,
          s2l_lost_all_last1,
          s2l_lost_Leq5_last7,
          s2l_lost_all_last7
        FROM report_datahub.pub_levels_quality_di_1
        WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-21') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-11-21')) AS ""自定义 SQL 查询""
    HAVING COUNT(1) > 0) AS ""t0""
WHERE CASE WHEN CAST(""自定义 SQL 查询"".""tag"" AS VARCHAR) = 'Industry' AND CAST(""自定义 SQL 查询"".""product_level1"" AS VARCHAR) = 'RTC' AND CAST(""自定义 SQL 查询"".""dim"" AS VARCHAR) = 'osver' THEN 0 WHEN CAST(""自定义 SQL 查询"".""tag"" AS VARCHAR) = 'VerType' AND CAST(""自定义 SQL 查询"".""product_level1"" AS VARCHAR) = 'RTC' AND CAST(""自定义 SQL 查询"".""dim"" AS VARCHAR) = 'osver' THEN 0 WHEN CAST(""自定义 SQL 查询"".""tag"" AS VARCHAR) = 'Product' AND CAST(""自定义 SQL 查询"".""product_level1"" AS VARCHAR) = 'RTC' AND CAST(""自定义 SQL 查询"".""dim"" AS VARCHAR) = 'osver' THEN 1 ELSE 0 END AND DATE_ADD('SECOND', 0, date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d')) = DATE_ADD('SECOND', 0, ""t0"".""__measure__0"")
HAVING COUNT(1) > 0"
"SELECT ""自定义 SQL 查询"".""product_type"" AS ""product_type""
FROM (SELECT date AS ""date"",
      src_domain AS ""srcDomain"",
      src_region AS ""srcRegion"",
      dest_idc AS ""idc"",
      src_isp,
      dest_ip,
      delay_25 AS ""p2s_Delay25"",
      delay_50 AS ""p2s_Delay50"",
      delay_75 AS ""p2s_Delay75"",
      delay_100 AS ""p2s_Delay100"",
      delay_125 AS ""p2s_Delay125"",
      delay_150 AS ""p2s_Delay150"",
      delay_total,
      lost_ratio_5 AS ""p2s_lostRatio"",
      lostratio_total AS ""p2s_total"",
      jitter95_50 AS ""p2s_jitter95_50"",
      jitter95_100 AS ""p2s_jitter95_100"",
      jitter95_200 AS ""p2s_jitter95_200"",
      jitter95_300 AS ""p2s_jitter95_300"",
      jitter95_total,
      product_line,
      product_type
    FROM media.p2s_cover_mainland_ip
    WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-25') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-01')) AS ""自定义 SQL 查询""
GROUP BY 1
ORDER BY ""product_type"""
"SELECT SUM(""自定义 SQL 查询"".""host_4k"") AS ""TEMP(Calculation_3519281700079370244)(1075454865)(0)"",
  SUM(""自定义 SQL 查询"".""audience_sd"") AS ""TEMP(Calculation_3519281700079370244)(1133678835)(0)"",
  SUM(""自定义 SQL 查询"".""host_1080p"") AS ""TEMP(Calculation_3519281700079370244)(1312501967)(0)"",
  SUM(""自定义 SQL 查询"".""host_hd"") AS ""TEMP(Calculation_3519281700079370244)(276907208)(0)"",
  SUM(""自定义 SQL 查询"".""video"") AS ""TEMP(Calculation_3519281700079370244)(2929708110)(0)"",
  SUM(""自定义 SQL 查询"".""audience_hd"") AS ""TEMP(Calculation_3519281700079370244)(2930728935)(0)"",
  SUM(""自定义 SQL 查询"".""audience_hdp"") AS ""TEMP(Calculation_3519281700079370244)(3010533957)(0)"",
  SUM(""自定义 SQL 查询"".""host_hdp"") AS ""TEMP(Calculation_3519281700079370244)(30306054)(0)"",
  SUM(""自定义 SQL 查询"".""host_audio"") AS ""TEMP(Calculation_3519281700079370244)(3087054365)(0)"",
  SUM(""自定义 SQL 查询"".""audio"") AS ""TEMP(Calculation_3519281700079370244)(3299350010)(0)"",
  SUM(""自定义 SQL 查询"".""audience_1080p"") AS ""TEMP(Calculation_3519281700079370244)(3628946582)(0)"",
  SUM(""自定义 SQL 查询"".""totalUsage"") AS ""TEMP(Calculation_3519281700079370244)(3847882359)(0)"",
  SUM(""自定义 SQL 查询"".""audience_audio"") AS ""TEMP(Calculation_3519281700079370244)(4109514392)(0)"",
  SUM(""自定义 SQL 查询"".""host_2k"") AS ""TEMP(Calculation_3519281700079370244)(586790827)(0)"",
  SUM(""自定义 SQL 查询"".""host_sd"") AS ""TEMP(Calculation_3519281700079370244)(709512178)(0)"",
  SUM(""自定义 SQL 查询"".""audience_4k"") AS ""TEMP(Calculation_3519281700079370244)(764410224)(0)"",
  SUM(""自定义 SQL 查询"".""audience_2k"") AS ""TEMP(Calculation_3519281700079370244)(943764407)(0)"",
  SUM(""自定义 SQL 查询"".""host_4k_last"") AS ""TEMP(Calculation_3519281700083154949)(101123376)(0)"",
  SUM(""自定义 SQL 查询"".""audience_video_hdp_last"") AS ""TEMP(Calculation_3519281700083154949)(1200517625)(0)"",
  SUM(""自定义 SQL 查询"".""audience_1080p_last"") AS ""TEMP(Calculation_3519281700083154949)(1314346200)(0)"",
  SUM(""自定义 SQL 查询"".""audience_video_hd_last"") AS ""TEMP(Calculation_3519281700083154949)(146570423)(0)"",
  SUM(""自定义 SQL 查询"".""audience_2k_last"") AS ""TEMP(Calculation_3519281700083154949)(1717771635)(0)"",
  SUM(""自定义 SQL 查询"".""audience_audio_last"") AS ""TEMP(Calculation_3519281700083154949)(2313111073)(0)"",
  SUM(""自定义 SQL 查询"".""host_video_hdp_last"") AS ""TEMP(Calculation_3519281700083154949)(258310559)(0)"",
  SUM(""自定义 SQL 查询"".""audio_video_last"") AS ""TEMP(Calculation_3519281700083154949)(2820618408)(0)"",
  SUM(""自定义 SQL 查询"".""audience_4k_last"") AS ""TEMP(Calculation_3519281700083154949)(3121859593)(0)"",
  SUM(""自定义 SQL 查询"".""host_1080p_last"") AS ""TEMP(Calculation_3519281700083154949)(3222422303)(0)"",
  SUM(""自定义 SQL 查询"".""host_audio_last"") AS ""TEMP(Calculation_3519281700083154949)(3227677803)(0)"",
  SUM(""自定义 SQL 查询"".""video_last"") AS ""TEMP(Calculation_3519281700083154949)(3934387163)(0)"",
  SUM(""自定义 SQL 查询"".""host_2k_last"") AS ""TEMP(Calculation_3519281700083154949)(4055292783)(0)"",
  SUM(""自定义 SQL 查询"".""audio_last"") AS ""TEMP(Calculation_3519281700083154949)(4091190060)(0)"",
  SUM(""自定义 SQL 查询"".""host_video_hd_last"") AS ""TEMP(Calculation_3519281700083154949)(4170367250)(0)"",
  SUM(""自定义 SQL 查询"".""host_video_sd_last"") AS ""TEMP(Calculation_3519281700083154949)(4190307025)(0)"",
  SUM(""自定义 SQL 查询"".""audience_video_sd_last"") AS ""TEMP(Calculation_3519281700083154949)(933007102)(0)"",
  MAX(""自定义 SQL 查询"".""stat_date"") AS ""TEMP(attr_stat_date_nk)(2102638629)(0)"",
  MIN(""自定义 SQL 查询"".""stat_date"") AS ""TEMP(attr_stat_date_nk)(2790680713)(0)"",
  ""自定义 SQL 查询"".""level1"" AS ""level1"",
  SUM(""自定义 SQL 查询"".""totalUsage"") AS ""sum_totalUsage_ok"",
  DATE_ADD('SECOND', 0, date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d')) AS ""tdy_date_ok""
FROM (SELECT date,
        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,
      start_date AS start_date_7,
      end_date AS end_date,
      tag,
      area AS Scope,
      dim,
        CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,
      level2,
      level3,
      level4,
      product_level1 AS product_line,
      product_level2,
      product_level3,
      product_level4,
      vid_internal_industry_en AS cid_industry,
      vid_use_case_en AS vid_use_case_cn,
      vid_sector_en,
      ver_type,
      ver,
      os,
      domain,
      country,
      region,
      dim_grouping_name,
        CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,
      total AS totalUsage,
      audio,
      video,
      host_audio,
      audience_audio,
      host_sd,
      host_hd,
      host_hdp,
      host_1080p,
      host_2k,
      host_4k,
      audience_sd,
      audience_hd,
      audience_hdp,
      audience_1080p,
      audience_2k,
      audience_4k,
      audience_audio_low_latency,
      audience_sd_low_latency,
      audience_hd_low_latency,
      audience_hdp_low_latency,
      audience_1080p_low_latency,
      audience_2k_low_latency,
      audience_4k_low_latency,
      audience_audio_ultra_low_latency,
      audience_sd_ultra_low_latency,
      audience_hd_ultra_low_latency,
      audience_hdp_ultra_low_latency,
      audience_1080p_ultra_low_latency,
      audience_2k_ultra_low_latency,
      audience_4k_ultra_low_latency,
      total_last1 AS audio_video_last,
      audio_last1 AS audio_last,
      video_last1 AS video_last,
      video_sd_last1 AS video_sd_last,
      video_hd_last1 AS video_hd_last,
      video_hdp_last1 AS video_hdp_last,
      host_sd_last1 AS host_video_sd_last,
      audience_sd_last1 AS audience_video_sd_last,
      host_hd_last1 AS host_video_hd_last,
      audience_hd_last1 AS audience_video_hd_last,
      host_hdp_last1 AS host_video_hdp_last,
      audience_hdp_last1 AS audience_video_hdp_last,
      host_audio_last1 AS host_audio_last,
      audience_audio_last1 AS audience_audio_last,
      host_video_last1 AS host_video_last,
      audience_video_last1 AS audience_video_last,
      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,
      audience_video_low_latency_last1 AS audience_video_low_latency_last,
      audience_total_low_latency_last1 AS audience_total_low_latency_last,
      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,
      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,
      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,
      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,
      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,
      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,
      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,
      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,
      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,
      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,
      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,
      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,
      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,
      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,
      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,
      audience_2k_last1 AS audience_2k_last,
      audience_4k_last1 AS audience_4k_last,
      audience_1080p_last1 AS audience_1080p_last,
      host_1080p_last1 AS host_1080p_last,
      host_2k_last1 AS host_2k_last,
      host_4k_last1 AS host_4k_last,
      total_last7,
      audio_last7,
      video_last7,
      video_sd_last7,
      video_hd_last7,
      video_hdp_last7,
      host_sd_last7,
      audience_sd_last7,
      host_hd_last7,
      audience_hd_last7,
      host_hdp_last7,
      audience_hdp_last7,
      host_audio_last7,
      audience_audio_last7,
      host_video_last7,
      audience_video_last7,
      audience_audio_low_latency_last7,
      audience_video_low_latency_last7,
      audience_total_low_latency_last7,
      audience_sd_low_latency_last7,
      audience_hd_low_latency_last7,
      audience_hdp_low_latency_last7,
      audience_1080p_low_latency_last7,
      audience_2k_low_latency_last7,
      audience_4k_low_latency_last7,
      audience_audio_ultra_low_latency_last7,
      audience_video_ultra_low_latency_last7,
      audience_total_ultra_low_latency_last7,
      audience_sd_ultra_low_latency_last7,
      audience_hd_ultra_low_latency_last7,
      audience_hdp_ultra_low_latency_last7,
      audience_1080p_ultra_low_latency_last7,
      audience_2k_ultra_low_latency_last7,
      audience_4k_ultra_low_latency_last7,
      audience_2k_last7,
      audience_4k_last7,
      audience_1080p_last7,
      host_1080p_last7,
      host_2k_last7,
      host_4k_last7
    FROM levels_usage_dod_di_1
    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-06') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-04') AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS ""自定义 SQL 查询""
WHERE ""自定义 SQL 查询"".""dim"" = 1 AND ""自定义 SQL 查询"".""rank_level1"" = 7
GROUP BY 37,
  39"
"SELECT SUM(""自定义 SQL 查询"".""p2s_Delay25"" * ""自定义 SQL 查询"".""delay_total"") AS ""TEMP(Calculation_1122874106494361604)(1461110105)(0)"",
  SUM(""自定义 SQL 查询"".""delay_total"") AS ""TEMP(Calculation_1122874106494361604)(363980608)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_Delay50"" * ""自定义 SQL 查询"".""delay_total"") AS ""TEMP(Calculation_1122874106494976005)(1551638771)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_Delay75"" * ""自定义 SQL 查询"".""delay_total"") AS ""TEMP(Calculation_1122874106495696902)(2562427304)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_lostRatio"" * ""自定义 SQL 查询"".""p2s_total"") AS ""TEMP(Calculation_1122874106495848455)(1741181994)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_total"") AS ""TEMP(Calculation_1122874106495848455)(2624355999)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_jitter95_100"" * ""自定义 SQL 查询"".""jitter95_total"") AS ""TEMP(Calculation_4208191644263628803)(3609783325)(0)"",
  SUM(""自定义 SQL 查询"".""jitter95_total"") AS ""TEMP(Calculation_4208191644263628803)(633698484)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_jitter95_50"" * ""自定义 SQL 查询"".""jitter95_total"") AS ""TEMP(Calculation_4208191644264697860)(1652714847)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_jitter95_200"" * ""自定义 SQL 查询"".""jitter95_total"") AS ""TEMP(Calculation_4208191644264935429)(206867949)(0)"",
  ""自定义 SQL 查询"".""idc"" AS ""idc"",
  ""自定义 SQL 查询"".""srcRegion"" AS ""srcRegion"",
  ""自定义 SQL 查询"".""src_isp"" AS ""src_isp"",
  SUM(""自定义 SQL 查询"".""p2s_total"") AS ""sum_p2s_total_ok""
FROM (SELECT date AS ""date"",
      src_domain AS ""srcDomain"",
      src_region AS ""srcRegion"",
      dest_idc AS ""idc"",
      src_isp,
      dest_ip,
      delay_25 AS ""p2s_Delay25"",
      delay_50 AS ""p2s_Delay50"",
      delay_75 AS ""p2s_Delay75"",
      delay_100 AS ""p2s_Delay100"",
      delay_125 AS ""p2s_Delay125"",
      delay_150 AS ""p2s_Delay150"",
      delay_total,
      lost_ratio_5 AS ""p2s_lostRatio"",
      lostratio_total AS ""p2s_total"",
      jitter95_50 AS ""p2s_jitter95_50"",
      jitter95_100 AS ""p2s_jitter95_100"",
      jitter95_200 AS ""p2s_jitter95_200"",
      jitter95_300 AS ""p2s_jitter95_300"",
      jitter95_total,
      product_line,
      product_type
    FROM media.p2s_cover_mainland_ip
    WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-25') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-01')) AS ""自定义 SQL 查询""
WHERE (""自定义 SQL 查询"".""idc"" IN ('aofei-hk1ga', 'aofei-singapore1ga', 'evc-singapore1ga', 'evc-singapore1gb', 'huhehaote1g-ctel', 'yancheng1g-ctel', 'zen-saopaulo2') OR ( (  ""自定义 SQL 查询"".""idc""  ) is null) OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'baoji1g-ctel' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'beijing8-bgp' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'changchun1g-cucc' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'changsha1g-cucc' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'changzhou9a-drpeng' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'eq-frankfurt1g' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'evc-chicago1g' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'evc-japan9a' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'foshan1g-ctel' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'huainan1g-cmcc' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'jinan1g-3line' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'jinan9-cmcc' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'jiujiang9-ctel' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'luoyang1g-ctel' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'nanchang1g-cmcc' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'taiyuan6bdbm-ctel' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'taiyuan9-cucc' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'wuxi3c-bgp' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'xiamen6bd-ctel' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'xuzhou9b-ctel' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'yancheng9-cmcc' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'zen-frankfurt1gb' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'zen-frankfurt9a' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'zen-japan9' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'zen-london1ga' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'zen-losangeles9' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'zen-melbourne9a' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'zen-mumbai9' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'zen-singapore1ga' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'zen-washington1ga' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'zhangjiakou1gb-cmcc' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'zhengzhou6bd-cucc' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'zhenjiang1g-3line' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'zhuzhou1g-ctel') AND CAST(""自定义 SQL 查询"".""srcRegion"" AS VARCHAR) >= 'Anhui' AND CAST(""自定义 SQL 查询"".""srcRegion"" AS VARCHAR) <= 'Zhejiang' AND (( (  ""自定义 SQL 查询"".""product_type""  ) is null) OR CAST(""自定义 SQL 查询"".""product_type"" AS VARCHAR) >= 'CloudPlayer' AND CAST(""自定义 SQL 查询"".""product_type"" AS VARCHAR) <= 'WebRTS')
GROUP BY 11,
  12,
  13
HAVING CASE WHEN SUM(""自定义 SQL 查询"".""p2s_total"") >= 0 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100 THEN 0 WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 1000 THEN 1 WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 1000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 10000 THEN 0 WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 10000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100000 THEN 0 WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100000 THEN 0 ELSE 0 END OR CASE WHEN SUM(""自定义 SQL 查询"".""p2s_total"") >= 0 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100 THEN 0 WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 1000 THEN 0 WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 1000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 10000 THEN 1 WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 10000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100000 THEN 0 WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100000 THEN 0 ELSE 0 END OR CASE WHEN SUM(""自定义 SQL 查询"".""p2s_total"") >= 0 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100 THEN 0 WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 1000 THEN 0 WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 1000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 10000 THEN 0 WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 10000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100000 THEN 1 WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100000 THEN 0 ELSE 0 END OR CASE WHEN SUM(""自定义 SQL 查询"".""p2s_total"") >= 0 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100 THEN 0 WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 1000 THEN 0 WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 1000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 10000 THEN 0 WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 10000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100000 THEN 0 WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100000 THEN 1 ELSE 0 END"
"SELECT SUM(""自定义 SQL 查询"".""s2l_25ms_delay_sec_last7"") AS ""TEMP(Calculation_1430244791162150914)(10119751)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_25ms_delay_sec"") AS ""TEMP(Calculation_1430244791162150914)(2227145667)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_total_delay_sec"") AS ""TEMP(Calculation_1430244791162150914)(2460078802)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_total_delay_sec_last7"") AS ""TEMP(Calculation_1430244791162150914)(3558359569)(0)"",
  SUM(""自定义 SQL 查询"".""5s_succ_join_ap_cnt"") AS ""TEMP(Calculation_1430244791249522705)(1716451703)(0)"",
  SUM(""自定义 SQL 查询"".""total_join_ap_cnt_last7"") AS ""TEMP(Calculation_1430244791249522705)(2573436739)(0)"",
  SUM(""自定义 SQL 查询"".""total_join_ap_cnt"") AS ""TEMP(Calculation_1430244791249522705)(2681092799)(0)"",
  SUM(""自定义 SQL 查询"".""5s_succ_join_ap_cnt_last7"") AS ""TEMP(Calculation_1430244791249522705)(2802323494)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_75ms_delay_sec"") AS ""TEMP(Calculation_6542393318886535170)(2003933318)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_75ms_delay_sec_last7"") AS ""TEMP(Calculation_6542393318886535170)(775655446)(0)"",
  SUM(""自定义 SQL 查询"".""totalJoin"") AS ""TEMP(Calculation_7034341207023464449)(2073556184)(0)"",
  SUM(""自定义 SQL 查询"".""3s_succ_join_session_cnt_last7"") AS ""TEMP(Calculation_7034341207023464449)(2344416377)(0)"",
  SUM(""自定义 SQL 查询"".""total_join_session_cnt_last7"") AS ""TEMP(Calculation_7034341207023464449)(3093209995)(0)"",
  SUM(""自定义 SQL 查询"".""threeSecJoinSuccess"") AS ""TEMP(Calculation_7034341207023464449)(3693645608)(0)"",
  SUM(""自定义 SQL 查询"".""5s_succ_join_session_cnt_last7"") AS ""TEMP(Calculation_7034341207023988739)(1073906376)(0)"",
  SUM(""自定义 SQL 查询"".""fiveSecJoinSuccess"") AS ""TEMP(Calculation_7034341207023988739)(383616769)(0)"",
  SUM(""自定义 SQL 查询"".""succ_join_session_cnt_last7"") AS ""TEMP(Calculation_7034341207025020933)(2300438540)(0)"",
  SUM(""自定义 SQL 查询"".""totalJoinSuccess"") AS ""TEMP(Calculation_7034341207025020933)(2807417001)(0)"",
  SUM(""自定义 SQL 查询"".""video_totaltime_last7"") AS ""TEMP(Calculation_7034341207025557511)(2411308906)(0)"",
  SUM(""自定义 SQL 查询"".""video_totaltime"") AS ""TEMP(Calculation_7034341207025557511)(2797449586)(0)"",
  SUM(""自定义 SQL 查询"".""video_freeze_time"") AS ""TEMP(Calculation_7034341207025557511)(2940759860)(0)"",
  SUM(""自定义 SQL 查询"".""video_freeze_time_last7"") AS ""TEMP(Calculation_7034341207025557511)(3152166089)(0)"",
  SUM(""自定义 SQL 查询"".""audio_freeze_time_200"") AS ""TEMP(Calculation_7034341207025938441)(1946708283)(0)"",
  SUM(""自定义 SQL 查询"".""audio_freeze_time_200_last7"") AS ""TEMP(Calculation_7034341207025938441)(2396952428)(0)"",
  SUM(""自定义 SQL 查询"".""audio_totaltime_200_last7"") AS ""TEMP(Calculation_7034341207025938441)(2558991611)(0)"",
  SUM(""自定义 SQL 查询"".""audio_totaltime_200"") AS ""TEMP(Calculation_7034341207025938441)(784477006)(0)"",
  SUM(""自定义 SQL 查询"".""crash_cnt_last7"") AS ""TEMP(Calculation_7034341207372492815)(2315319037)(0)"",
  SUM(""自定义 SQL 查询"".""crash_cnt"") AS ""TEMP(Calculation_7034341207372492815)(2360900687)(0)"",
  SUM(""自定义 SQL 查询"".""service_cnt_last7"") AS ""TEMP(Calculation_7034341207372492815)(3843063028)(0)"",
  SUM(""自定义 SQL 查询"".""service_cnt"") AS ""TEMP(Calculation_7034341207372492815)(4291252132)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_lost_all_last7"") AS ""TEMP(Calculation_75998310508670977)(1411695322)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_lost_Leq5"") AS ""TEMP(Calculation_75998310508670977)(1936123547)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_lost_all"") AS ""TEMP(Calculation_75998310508670977)(749826584)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_lost_Leq5_last7"") AS ""TEMP(Calculation_75998310508670977)(790094525)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_lost_all_last7"") AS ""TEMP(Calculation_939915332871626757)(2193540190)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_lost_Leq5_last7"") AS ""TEMP(Calculation_939915332871626757)(2526464233)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_lost_Leq5"") AS ""TEMP(Calculation_939915332871626757)(2745840127)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_lost_all"") AS ""TEMP(Calculation_939915332871626757)(734589263)(0)""
FROM (SELECT ts.*,
      fiveSecJoinSuccess_total,
      threeSecJoinSuccess_total,
      totalJoinSuccess_total,
      totalJoin_total,
      cnt_sid_total,
      ""1s_succ_join_ap_cnt_total"",
      ""5s_succ_join_ap_cnt_total"",
      total_join_ap_cnt_total,
      audio_freeze_time_200_total,
      audio_totaltime_200_total,
      video_freeze_time_total,
      video_totaltime_total,
      p2s_lost_Leq5_total,
      p2s_lost_all_total,
      s2l_25ms_delay_sec_total,
      s2l_75ms_delay_sec_total,
      s2l_total_delay_sec_total,
      crash_cnt_total,
      service_cnt_total,
      ""5s_succ_join_session_cnt_last1_total"",
      ""3s_succ_join_session_cnt_last1_total"",
      succ_join_session_cnt_last1_total,
      total_join_session_cnt_last1_total,
      total_session_cnt_last1_total,
      ""1s_succ_join_ap_cnt_last1_total"",
      ""5s_succ_join_ap_cnt_last1_total"",
      total_join_ap_cnt_last1_total,
      video_freeze_time_last1_total,
      video_totaltime_last1_total,
      p2s_lost_Leq5_last1_total,
      p2s_lost_all_last1_total,
      s2l_25ms_delay_sec_last1_total,
      s2l_75ms_delay_sec_last1_total,
      s2l_total_delay_sec_last1_total,
      crash_cnt_last1_total,
      service_cnt_last1_total,
      audio_freeze_time_200_last1_total,
      audio_totaltime_200_last1_total,
      ""5s_succ_join_session_cnt_last7_total"",
      ""3s_succ_join_session_cnt_last7_total"",
      succ_join_session_cnt_last7_total,
      total_join_session_cnt_last7_total,
      total_session_cnt_last7_total,
      ""7s_succ_join_ap_cnt_last7_total"",
      ""5s_succ_join_ap_cnt_last7_total"",
      total_join_ap_cnt_last7_total,
      video_freeze_time_last7_total,
      video_totaltime_last7_total,
      p2s_lost_Leq5_last7_total,
      p2s_lost_all_last7_total,
      s2l_25ms_delay_sec_last7_total,
      s2l_75ms_delay_sec_last7_total,
      s2l_total_delay_sec_last7_total,
      crash_cnt_last7_total,
      service_cnt_last7_total,
      audio_freeze_time_200_last7_total,
      audio_totaltime_200_last7_total,
      video_freeze_time_500_total,
      video_totaltime_500_total,
      video_freeze_time_200_total,
      video_totaltime_200_total,
      video_freeze_time_500_last1_total,
      video_totaltime_500_last1_total,
      video_freeze_time_200_last1_total,
      video_totaltime_200_last1_total,
      video_freeze_time_500_last7_total,
      video_totaltime_500_last7_total,
      video_freeze_time_200_last7_total,
      video_totaltime_200_last7_total,
      s2l_lost_Leq5_total,
      s2l_lost_all_total,
      s2l_lost_Leq5_last1_total,
      s2l_lost_all_last1_total,
      s2l_lost_Leq5_last7_total,
      s2l_lost_all_last7_total
    FROM (SELECT vid,
          project,
          company_id,
          area,
          company_name,
          industry_name,
          date,
            CASE WHEN CAST(stat_period AS VARCHAR) = 'day' THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(substr(CAST(start_date AS VARCHAR), 1, 10) AS VARCHAR), '~', CAST(substr(CAST(end_date AS VARCHAR), 1, 10) AS VARCHAR)) END AS period,
          net,
          os,
          ver,
          'osver' AS dim,
          product_level_1,
          product_level_2,
          ver_type,
          SUM(fiveSecJoinSuccess) AS fiveSecJoinSuccess,
          SUM(threeSecJoinSuccess) AS threeSecJoinSuccess,
          SUM(totalJoinSuccess) AS totalJoinSuccess,
          SUM(totalJoin) AS totalJoin,
          SUM(cnt_sid) AS cnt_sid,
          SUM(""1s_succ_join_ap_cnt"") AS ""1s_succ_join_ap_cnt"",
          SUM(""5s_succ_join_ap_cnt"") AS ""5s_succ_join_ap_cnt"",
          SUM(total_join_ap_cnt) AS total_join_ap_cnt,
          SUM(audio_freeze_time_200) AS audio_freeze_time_200,
          SUM(audio_totaltime_200) AS audio_totaltime_200,
          SUM(video_freeze_time) AS video_freeze_time,
          SUM(video_totaltime) AS video_totaltime,
          SUM(p2s_lost_Leq5) AS p2s_lost_Leq5,
          SUM(p2s_lost_all) AS p2s_lost_all,
          SUM(s2l_25ms_delay_sec) AS s2l_25ms_delay_sec,
          SUM(s2l_75ms_delay_sec) AS s2l_75ms_delay_sec,
          SUM(s2l_total_delay_sec) AS s2l_total_delay_sec,
          SUM(crash_cnt) AS crash_cnt,
          SUM(service_cnt) AS service_cnt,
          SUM(""5s_succ_join_session_cnt_last1"") AS ""5s_succ_join_session_cnt_last1"",
          SUM(""3s_succ_join_session_cnt_last1"") AS ""3s_succ_join_session_cnt_last1"",
          SUM(succ_join_session_cnt_last1) AS succ_join_session_cnt_last1,
          SUM(total_join_session_cnt_last1) AS total_join_session_cnt_last1,
          SUM(total_session_cnt_last1) AS total_session_cnt_last1,
          SUM(""1s_succ_join_ap_cnt_last1"") AS ""1s_succ_join_ap_cnt_last1"",
          SUM(""5s_succ_join_ap_cnt_last1"") AS ""5s_succ_join_ap_cnt_last1"",
          SUM(total_join_ap_cnt_last1) AS total_join_ap_cnt_last1,
          SUM(video_freeze_time_last1) AS video_freeze_time_last1,
          SUM(video_totaltime_last1) AS video_totaltime_last1,
          SUM(p2s_lost_Leq5_last1) AS p2s_lost_Leq5_last1,
          SUM(p2s_lost_all_last1) AS p2s_lost_all_last1,
          SUM(s2l_25ms_delay_sec_last1) AS s2l_25ms_delay_sec_last1,
          SUM(s2l_75ms_delay_sec_last1) AS s2l_75ms_delay_sec_last1,
          SUM(s2l_total_delay_sec_last1) AS s2l_total_delay_sec_last1,
          SUM(crash_cnt_last1) AS crash_cnt_last1,
          SUM(service_cnt_last1) AS service_cnt_last1,
          SUM(audio_freeze_time_200_last1) AS audio_freeze_time_200_last1,
          SUM(audio_totaltime_200_last1) AS audio_totaltime_200_last1,
          SUM(""5s_succ_join_session_cnt_last7"") AS ""5s_succ_join_session_cnt_last7"",
          SUM(""3s_succ_join_session_cnt_last7"") AS ""3s_succ_join_session_cnt_last7"",
          SUM(succ_join_session_cnt_last7) AS succ_join_session_cnt_last7,
          SUM(total_join_session_cnt_last7) AS total_join_session_cnt_last7,
          SUM(total_session_cnt_last7) AS total_session_cnt_last7,
          SUM(""1s_succ_join_ap_cnt_last7"") AS ""7s_succ_join_ap_cnt_last7"",
          SUM(""5s_succ_join_ap_cnt_last7"") AS ""5s_succ_join_ap_cnt_last7"",
          SUM(total_join_ap_cnt_last7) AS total_join_ap_cnt_last7,
          SUM(video_freeze_time_last7) AS video_freeze_time_last7,
          SUM(video_totaltime_last7) AS video_totaltime_last7,
          SUM(p2s_lost_Leq5_last7) AS p2s_lost_Leq5_last7,
          SUM(p2s_lost_all_last7) AS p2s_lost_all_last7,
          SUM(s2l_25ms_delay_sec_last7) AS s2l_25ms_delay_sec_last7,
          SUM(s2l_75ms_delay_sec_last7) AS s2l_75ms_delay_sec_last7,
          SUM(s2l_total_delay_sec_last7) AS s2l_total_delay_sec_last7,
          SUM(crash_cnt_last7) AS crash_cnt_last7,
          SUM(service_cnt_last7) AS service_cnt_last7,
          SUM(audio_freeze_time_200_last7) AS audio_freeze_time_200_last7,
          SUM(audio_totaltime_200_last7) AS audio_totaltime_200_last7,
          SUM(video_freeze_time_500) AS video_freeze_time_500,
          SUM(video_totaltime_500) AS video_totaltime_500,
          SUM(video_freeze_time_200) AS video_freeze_time_200,
          SUM(video_totaltime_200) AS video_totaltime_200,
          SUM(video_freeze_time_500_last1) AS video_freeze_time_500_last1,
          SUM(video_totaltime_500_last1) AS video_totaltime_500_last1,
          SUM(video_freeze_time_200_last1) AS video_freeze_time_200_last1,
          SUM(video_totaltime_200_last1) AS video_totaltime_200_last1,
          SUM(video_freeze_time_500_last7) AS video_freeze_time_500_last7,
          SUM(video_totaltime_500_last7) AS video_totaltime_500_last7,
          SUM(video_freeze_time_200_last7) AS video_freeze_time_200_last7,
          SUM(video_totaltime_200_last7) AS video_totaltime_200_last7,
          SUM(s2l_lost_Leq5) AS s2l_lost_Leq5,
          SUM(s2l_lost_all) AS s2l_lost_all,
          SUM(s2l_lost_Leq5_last1) AS s2l_lost_Leq5_last1,
          SUM(s2l_lost_all_last1) AS s2l_lost_all_last1,
          SUM(s2l_lost_Leq5_last7) AS s2l_lost_Leq5_last7,
          SUM(s2l_lost_all_last7) AS s2l_lost_all_last7
        FROM report_datahub.vid_osver_net_cp_domain_quality_di_1
        WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-21') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-11-21') AND CAST(vid AS VARCHAR) = CAST(281104 AS VARCHAR) AND CAST(product_level_2 AS VARCHAR) = 'Native'
        GROUP BY vid,
          project,
          company_id,
          area,
          company_name,
          industry_name,
          date,
          net,
          os,
          ver,
          product_level_1,
          product_level_2,
          ver_type,
            CASE WHEN CAST(stat_period AS VARCHAR) = 'day' THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(substr(CAST(start_date AS VARCHAR), 1, 10) AS VARCHAR), '~', CAST(substr(CAST(end_date AS VARCHAR), 1, 10) AS VARCHAR)) END) AS ts
      LEFT JOIN (SELECT vid,
          date,
          SUM(fiveSecJoinSuccess) AS fiveSecJoinSuccess_total,
          SUM(threeSecJoinSuccess) AS threeSecJoinSuccess_total,
          SUM(totalJoinSuccess) AS totalJoinSuccess_total,
          SUM(totalJoin) AS totalJoin_total,
          SUM(cnt_sid) AS cnt_sid_total,
          SUM(""1s_succ_join_ap_cnt"") AS ""1s_succ_join_ap_cnt_total"",
          SUM(""5s_succ_join_ap_cnt"") AS ""5s_succ_join_ap_cnt_total"",
          SUM(total_join_ap_cnt) AS total_join_ap_cnt_total,
          SUM(audio_freeze_time_200) AS audio_freeze_time_200_total,
          SUM(audio_totaltime_200) AS audio_totaltime_200_total,
          SUM(video_freeze_time) AS video_freeze_time_total,
          SUM(video_totaltime) AS video_totaltime_total,
          SUM(p2s_lost_Leq5) AS p2s_lost_Leq5_total,
          SUM(p2s_lost_all) AS p2s_lost_all_total,
          SUM(s2l_25ms_delay_sec) AS s2l_25ms_delay_sec_total,
          SUM(s2l_75ms_delay_sec) AS s2l_75ms_delay_sec_total,
          SUM(s2l_total_delay_sec) AS s2l_total_delay_sec_total,
          SUM(crash_cnt) AS crash_cnt_total,
          SUM(service_cnt) AS service_cnt_total,
          SUM(""5s_succ_join_session_cnt_last1"") AS ""5s_succ_join_session_cnt_last1_total"",
          SUM(""3s_succ_join_session_cnt_last1"") AS ""3s_succ_join_session_cnt_last1_total"",
          SUM(succ_join_session_cnt_last1) AS succ_join_session_cnt_last1_total,
          SUM(total_join_session_cnt_last1) AS total_join_session_cnt_last1_total,
          SUM(total_session_cnt_last1) AS total_session_cnt_last1_total,
          SUM(""1s_succ_join_ap_cnt_last1"") AS ""1s_succ_join_ap_cnt_last1_total"",
          SUM(""5s_succ_join_ap_cnt_last1"") AS ""5s_succ_join_ap_cnt_last1_total"",
          SUM(total_join_ap_cnt_last1) AS total_join_ap_cnt_last1_total,
          SUM(video_freeze_time_last1) AS video_freeze_time_last1_total,
          SUM(video_totaltime_last1) AS video_totaltime_last1_total,
          SUM(p2s_lost_Leq5_last1) AS p2s_lost_Leq5_last1_total,
          SUM(p2s_lost_all_last1) AS p2s_lost_all_last1_total,
          SUM(s2l_25ms_delay_sec_last1) AS s2l_25ms_delay_sec_last1_total,
          SUM(s2l_75ms_delay_sec_last1) AS s2l_75ms_delay_sec_last1_total,
          SUM(s2l_total_delay_sec_last1) AS s2l_total_delay_sec_last1_total,
          SUM(crash_cnt_last1) AS crash_cnt_last1_total,
          SUM(service_cnt_last1) AS service_cnt_last1_total,
          SUM(audio_freeze_time_200_last1) AS audio_freeze_time_200_last1_total,
          SUM(audio_totaltime_200_last1) AS audio_totaltime_200_last1_total,
          SUM(""5s_succ_join_session_cnt_last7"") AS ""5s_succ_join_session_cnt_last7_total"",
          SUM(""3s_succ_join_session_cnt_last7"") AS ""3s_succ_join_session_cnt_last7_total"",
          SUM(succ_join_session_cnt_last7) AS succ_join_session_cnt_last7_total,
          SUM(total_join_session_cnt_last7) AS total_join_session_cnt_last7_total,
          SUM(total_session_cnt_last7) AS total_session_cnt_last7_total,
          SUM(""1s_succ_join_ap_cnt_last7"") AS ""7s_succ_join_ap_cnt_last7_total"",
          SUM(""5s_succ_join_ap_cnt_last7"") AS ""5s_succ_join_ap_cnt_last7_total"",
          SUM(total_join_ap_cnt_last7) AS total_join_ap_cnt_last7_total,
          SUM(video_freeze_time_last7) AS video_freeze_time_last7_total,
          SUM(video_totaltime_last7) AS video_totaltime_last7_total,
          SUM(p2s_lost_Leq5_last7) AS p2s_lost_Leq5_last7_total,
          SUM(p2s_lost_all_last7) AS p2s_lost_all_last7_total,
          SUM(s2l_25ms_delay_sec_last7) AS s2l_25ms_delay_sec_last7_total,
          SUM(s2l_75ms_delay_sec_last7) AS s2l_75ms_delay_sec_last7_total,
          SUM(s2l_total_delay_sec_last7) AS s2l_total_delay_sec_last7_total,
          SUM(crash_cnt_last7) AS crash_cnt_last7_total,
          SUM(service_cnt_last7) AS service_cnt_last7_total,
          SUM(audio_freeze_time_200_last7) AS audio_freeze_time_200_last7_total,
          SUM(audio_totaltime_200_last7) AS audio_totaltime_200_last7_total,
          SUM(video_freeze_time_500) AS video_freeze_time_500_total,
          SUM(video_totaltime_500) AS video_totaltime_500_total,
          SUM(video_freeze_time_200) AS video_freeze_time_200_total,
          SUM(video_totaltime_200) AS video_totaltime_200_total,
          SUM(video_freeze_time_500_last1) AS video_freeze_time_500_last1_total,
          SUM(video_totaltime_500_last1) AS video_totaltime_500_last1_total,
          SUM(video_freeze_time_200_last1) AS video_freeze_time_200_last1_total,
          SUM(video_totaltime_200_last1) AS video_totaltime_200_last1_total,
          SUM(video_freeze_time_500_last7) AS video_freeze_time_500_last7_total,
          SUM(video_totaltime_500_last7) AS video_totaltime_500_last7_total,
          SUM(video_freeze_time_200_last7) AS video_freeze_time_200_last7_total,
          SUM(video_totaltime_200_last7) AS video_totaltime_200_last7_total,
          SUM(s2l_lost_Leq5) AS s2l_lost_Leq5_total,
          SUM(s2l_lost_all) AS s2l_lost_all_total,
          SUM(s2l_lost_Leq5_last1) AS s2l_lost_Leq5_last1_total,
          SUM(s2l_lost_all_last1) AS s2l_lost_all_last1_total,
          SUM(s2l_lost_Leq5_last7) AS s2l_lost_Leq5_last7_total,
          SUM(s2l_lost_all_last7) AS s2l_lost_all_last7_total
        FROM report_datahub.vid_osver_net_cp_domain_quality_di_1
        WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-21') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-11-21') AND CAST(vid AS VARCHAR) = CAST(281104 AS VARCHAR) AND CAST(product_level_2 AS VARCHAR) = 'Native'
        GROUP BY vid,
          date) AS tt ON CAST(ts.vid AS VARCHAR) = CAST(tt.vid AS VARCHAR) AND ts.date = tt.date) AS ""自定义 SQL 查询""
  CROSS JOIN (SELECT MAX(date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d')) AS ""__measure__0""
    FROM (SELECT ts.*,
          fiveSecJoinSuccess_total,
          threeSecJoinSuccess_total,
          totalJoinSuccess_total,
          totalJoin_total,
          cnt_sid_total,
          ""1s_succ_join_ap_cnt_total"",
          ""5s_succ_join_ap_cnt_total"",
          total_join_ap_cnt_total,
          audio_freeze_time_200_total,
          audio_totaltime_200_total,
          video_freeze_time_total,
          video_totaltime_total,
          p2s_lost_Leq5_total,
          p2s_lost_all_total,
          s2l_25ms_delay_sec_total,
          s2l_75ms_delay_sec_total,
          s2l_total_delay_sec_total,
          crash_cnt_total,
          service_cnt_total,
          ""5s_succ_join_session_cnt_last1_total"",
          ""3s_succ_join_session_cnt_last1_total"",
          succ_join_session_cnt_last1_total,
          total_join_session_cnt_last1_total,
          total_session_cnt_last1_total,
          ""1s_succ_join_ap_cnt_last1_total"",
          ""5s_succ_join_ap_cnt_last1_total"",
          total_join_ap_cnt_last1_total,
          video_freeze_time_last1_total,
          video_totaltime_last1_total,
          p2s_lost_Leq5_last1_total,
          p2s_lost_all_last1_total,
          s2l_25ms_delay_sec_last1_total,
          s2l_75ms_delay_sec_last1_total,
          s2l_total_delay_sec_last1_total,
          crash_cnt_last1_total,
          service_cnt_last1_total,
          audio_freeze_time_200_last1_total,
          audio_totaltime_200_last1_total,
          ""5s_succ_join_session_cnt_last7_total"",
          ""3s_succ_join_session_cnt_last7_total"",
          succ_join_session_cnt_last7_total,
          total_join_session_cnt_last7_total,
          total_session_cnt_last7_total,
          ""7s_succ_join_ap_cnt_last7_total"",
          ""5s_succ_join_ap_cnt_last7_total"",
          total_join_ap_cnt_last7_total,
          video_freeze_time_last7_total,
          video_totaltime_last7_total,
          p2s_lost_Leq5_last7_total,
          p2s_lost_all_last7_total,
          s2l_25ms_delay_sec_last7_total,
          s2l_75ms_delay_sec_last7_total,
          s2l_total_delay_sec_last7_total,
          crash_cnt_last7_total,
          service_cnt_last7_total,
          audio_freeze_time_200_last7_total,
          audio_totaltime_200_last7_total,
          video_freeze_time_500_total,
          video_totaltime_500_total,
          video_freeze_time_200_total,
          video_totaltime_200_total,
          video_freeze_time_500_last1_total,
          video_totaltime_500_last1_total,
          video_freeze_time_200_last1_total,
          video_totaltime_200_last1_total,
          video_freeze_time_500_last7_total,
          video_totaltime_500_last7_total,
          video_freeze_time_200_last7_total,
          video_totaltime_200_last7_total,
          s2l_lost_Leq5_total,
          s2l_lost_all_total,
          s2l_lost_Leq5_last1_total,
          s2l_lost_all_last1_total,
          s2l_lost_Leq5_last7_total,
          s2l_lost_all_last7_total
        FROM (SELECT vid,
              project,
              company_id,
              area,
              company_name,
              industry_name,
              date,
                CASE WHEN CAST(stat_period AS VARCHAR) = 'day' THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(substr(CAST(start_date AS VARCHAR), 1, 10) AS VARCHAR), '~', CAST(substr(CAST(end_date AS VARCHAR), 1, 10) AS VARCHAR)) END AS period,
              net,
              os,
              ver,
              'osver' AS dim,
              product_level_1,
              product_level_2,
              ver_type,
              SUM(fiveSecJoinSuccess) AS fiveSecJoinSuccess,
              SUM(threeSecJoinSuccess) AS threeSecJoinSuccess,
              SUM(totalJoinSuccess) AS totalJoinSuccess,
              SUM(totalJoin) AS totalJoin,
              SUM(cnt_sid) AS cnt_sid,
              SUM(""1s_succ_join_ap_cnt"") AS ""1s_succ_join_ap_cnt"",
              SUM(""5s_succ_join_ap_cnt"") AS ""5s_succ_join_ap_cnt"",
              SUM(total_join_ap_cnt) AS total_join_ap_cnt,
              SUM(audio_freeze_time_200) AS audio_freeze_time_200,
              SUM(audio_totaltime_200) AS audio_totaltime_200,
              SUM(video_freeze_time) AS video_freeze_time,
              SUM(video_totaltime) AS video_totaltime,
              SUM(p2s_lost_Leq5) AS p2s_lost_Leq5,
              SUM(p2s_lost_all) AS p2s_lost_all,
              SUM(s2l_25ms_delay_sec) AS s2l_25ms_delay_sec,
              SUM(s2l_75ms_delay_sec) AS s2l_75ms_delay_sec,
              SUM(s2l_total_delay_sec) AS s2l_total_delay_sec,
              SUM(crash_cnt) AS crash_cnt,
              SUM(service_cnt) AS service_cnt,
              SUM(""5s_succ_join_session_cnt_last1"") AS ""5s_succ_join_session_cnt_last1"",
              SUM(""3s_succ_join_session_cnt_last1"") AS ""3s_succ_join_session_cnt_last1"",
              SUM(succ_join_session_cnt_last1) AS succ_join_session_cnt_last1,
              SUM(total_join_session_cnt_last1) AS total_join_session_cnt_last1,
              SUM(total_session_cnt_last1) AS total_session_cnt_last1,
              SUM(""1s_succ_join_ap_cnt_last1"") AS ""1s_succ_join_ap_cnt_last1"",
              SUM(""5s_succ_join_ap_cnt_last1"") AS ""5s_succ_join_ap_cnt_last1"",
              SUM(total_join_ap_cnt_last1) AS total_join_ap_cnt_last1,
              SUM(video_freeze_time_last1) AS video_freeze_time_last1,
              SUM(video_totaltime_last1) AS video_totaltime_last1,
              SUM(p2s_lost_Leq5_last1) AS p2s_lost_Leq5_last1,
              SUM(p2s_lost_all_last1) AS p2s_lost_all_last1,
              SUM(s2l_25ms_delay_sec_last1) AS s2l_25ms_delay_sec_last1,
              SUM(s2l_75ms_delay_sec_last1) AS s2l_75ms_delay_sec_last1,
              SUM(s2l_total_delay_sec_last1) AS s2l_total_delay_sec_last1,
              SUM(crash_cnt_last1) AS crash_cnt_last1,
              SUM(service_cnt_last1) AS service_cnt_last1,
              SUM(audio_freeze_time_200_last1) AS audio_freeze_time_200_last1,
              SUM(audio_totaltime_200_last1) AS audio_totaltime_200_last1,
              SUM(""5s_succ_join_session_cnt_last7"") AS ""5s_succ_join_session_cnt_last7"",
              SUM(""3s_succ_join_session_cnt_last7"") AS ""3s_succ_join_session_cnt_last7"",
              SUM(succ_join_session_cnt_last7) AS succ_join_session_cnt_last7,
              SUM(total_join_session_cnt_last7) AS total_join_session_cnt_last7,
              SUM(total_session_cnt_last7) AS total_session_cnt_last7,
              SUM(""1s_succ_join_ap_cnt_last7"") AS ""7s_succ_join_ap_cnt_last7"",
              SUM(""5s_succ_join_ap_cnt_last7"") AS ""5s_succ_join_ap_cnt_last7"",
              SUM(total_join_ap_cnt_last7) AS total_join_ap_cnt_last7,
              SUM(video_freeze_time_last7) AS video_freeze_time_last7,
              SUM(video_totaltime_last7) AS video_totaltime_last7,
              SUM(p2s_lost_Leq5_last7) AS p2s_lost_Leq5_last7,
              SUM(p2s_lost_all_last7) AS p2s_lost_all_last7,
              SUM(s2l_25ms_delay_sec_last7) AS s2l_25ms_delay_sec_last7,
              SUM(s2l_75ms_delay_sec_last7) AS s2l_75ms_delay_sec_last7,
              SUM(s2l_total_delay_sec_last7) AS s2l_total_delay_sec_last7,
              SUM(crash_cnt_last7) AS crash_cnt_last7,
              SUM(service_cnt_last7) AS service_cnt_last7,
              SUM(audio_freeze_time_200_last7) AS audio_freeze_time_200_last7,
              SUM(audio_totaltime_200_last7) AS audio_totaltime_200_last7,
              SUM(video_freeze_time_500) AS video_freeze_time_500,
              SUM(video_totaltime_500) AS video_totaltime_500,
              SUM(video_freeze_time_200) AS video_freeze_time_200,
              SUM(video_totaltime_200) AS video_totaltime_200,
              SUM(video_freeze_time_500_last1) AS video_freeze_time_500_last1,
              SUM(video_totaltime_500_last1) AS video_totaltime_500_last1,
              SUM(video_freeze_time_200_last1) AS video_freeze_time_200_last1,
              SUM(video_totaltime_200_last1) AS video_totaltime_200_last1,
              SUM(video_freeze_time_500_last7) AS video_freeze_time_500_last7,
              SUM(video_totaltime_500_last7) AS video_totaltime_500_last7,
              SUM(video_freeze_time_200_last7) AS video_freeze_time_200_last7,
              SUM(video_totaltime_200_last7) AS video_totaltime_200_last7,
              SUM(s2l_lost_Leq5) AS s2l_lost_Leq5,
              SUM(s2l_lost_all) AS s2l_lost_all,
              SUM(s2l_lost_Leq5_last1) AS s2l_lost_Leq5_last1,
              SUM(s2l_lost_all_last1) AS s2l_lost_all_last1,
              SUM(s2l_lost_Leq5_last7) AS s2l_lost_Leq5_last7,
              SUM(s2l_lost_all_last7) AS s2l_lost_all_last7
            FROM report_datahub.vid_osver_net_cp_domain_quality_di_1
            WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-21') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-11-21') AND CAST(vid AS VARCHAR) = CAST(281104 AS VARCHAR) AND CAST(product_level_2 AS VARCHAR) = 'Native'
            GROUP BY vid,
              project,
              company_id,
              area,
              company_name,
              industry_name,
              date,
              net,
              os,
              ver,
              product_level_1,
              product_level_2,
              ver_type,
                CASE WHEN CAST(stat_period AS VARCHAR) = 'day' THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(substr(CAST(start_date AS VARCHAR), 1, 10) AS VARCHAR), '~', CAST(substr(CAST(end_date AS VARCHAR), 1, 10) AS VARCHAR)) END) AS ts
          LEFT JOIN (SELECT vid,
              date,
              SUM(fiveSecJoinSuccess) AS fiveSecJoinSuccess_total,
              SUM(threeSecJoinSuccess) AS threeSecJoinSuccess_total,
              SUM(totalJoinSuccess) AS totalJoinSuccess_total,
              SUM(totalJoin) AS totalJoin_total,
              SUM(cnt_sid) AS cnt_sid_total,
              SUM(""1s_succ_join_ap_cnt"") AS ""1s_succ_join_ap_cnt_total"",
              SUM(""5s_succ_join_ap_cnt"") AS ""5s_succ_join_ap_cnt_total"",
              SUM(total_join_ap_cnt) AS total_join_ap_cnt_total,
              SUM(audio_freeze_time_200) AS audio_freeze_time_200_total,
              SUM(audio_totaltime_200) AS audio_totaltime_200_total,
              SUM(video_freeze_time) AS video_freeze_time_total,
              SUM(video_totaltime) AS video_totaltime_total,
              SUM(p2s_lost_Leq5) AS p2s_lost_Leq5_total,
              SUM(p2s_lost_all) AS p2s_lost_all_total,
              SUM(s2l_25ms_delay_sec) AS s2l_25ms_delay_sec_total,
              SUM(s2l_75ms_delay_sec) AS s2l_75ms_delay_sec_total,
              SUM(s2l_total_delay_sec) AS s2l_total_delay_sec_total,
              SUM(crash_cnt) AS crash_cnt_total,
              SUM(service_cnt) AS service_cnt_total,
              SUM(""5s_succ_join_session_cnt_last1"") AS ""5s_succ_join_session_cnt_last1_total"",
              SUM(""3s_succ_join_session_cnt_last1"") AS ""3s_succ_join_session_cnt_last1_total"",
              SUM(succ_join_session_cnt_last1) AS succ_join_session_cnt_last1_total,
              SUM(total_join_session_cnt_last1) AS total_join_session_cnt_last1_total,
              SUM(total_session_cnt_last1) AS total_session_cnt_last1_total,
              SUM(""1s_succ_join_ap_cnt_last1"") AS ""1s_succ_join_ap_cnt_last1_total"",
              SUM(""5s_succ_join_ap_cnt_last1"") AS ""5s_succ_join_ap_cnt_last1_total"",
              SUM(total_join_ap_cnt_last1) AS total_join_ap_cnt_last1_total,
              SUM(video_freeze_time_last1) AS video_freeze_time_last1_total,
              SUM(video_totaltime_last1) AS video_totaltime_last1_total,
              SUM(p2s_lost_Leq5_last1) AS p2s_lost_Leq5_last1_total,
              SUM(p2s_lost_all_last1) AS p2s_lost_all_last1_total,
              SUM(s2l_25ms_delay_sec_last1) AS s2l_25ms_delay_sec_last1_total,
              SUM(s2l_75ms_delay_sec_last1) AS s2l_75ms_delay_sec_last1_total,
              SUM(s2l_total_delay_sec_last1) AS s2l_total_delay_sec_last1_total,
              SUM(crash_cnt_last1) AS crash_cnt_last1_total,
              SUM(service_cnt_last1) AS service_cnt_last1_total,
              SUM(audio_freeze_time_200_last1) AS audio_freeze_time_200_last1_total,
              SUM(audio_totaltime_200_last1) AS audio_totaltime_200_last1_total,
              SUM(""5s_succ_join_session_cnt_last7"") AS ""5s_succ_join_session_cnt_last7_total"",
              SUM(""3s_succ_join_session_cnt_last7"") AS ""3s_succ_join_session_cnt_last7_total"",
              SUM(succ_join_session_cnt_last7) AS succ_join_session_cnt_last7_total,
              SUM(total_join_session_cnt_last7) AS total_join_session_cnt_last7_total,
              SUM(total_session_cnt_last7) AS total_session_cnt_last7_total,
              SUM(""1s_succ_join_ap_cnt_last7"") AS ""7s_succ_join_ap_cnt_last7_total"",
              SUM(""5s_succ_join_ap_cnt_last7"") AS ""5s_succ_join_ap_cnt_last7_total"",
              SUM(total_join_ap_cnt_last7) AS total_join_ap_cnt_last7_total,
              SUM(video_freeze_time_last7) AS video_freeze_time_last7_total,
              SUM(video_totaltime_last7) AS video_totaltime_last7_total,
              SUM(p2s_lost_Leq5_last7) AS p2s_lost_Leq5_last7_total,
              SUM(p2s_lost_all_last7) AS p2s_lost_all_last7_total,
              SUM(s2l_25ms_delay_sec_last7) AS s2l_25ms_delay_sec_last7_total,
              SUM(s2l_75ms_delay_sec_last7) AS s2l_75ms_delay_sec_last7_total,
              SUM(s2l_total_delay_sec_last7) AS s2l_total_delay_sec_last7_total,
              SUM(crash_cnt_last7) AS crash_cnt_last7_total,
              SUM(service_cnt_last7) AS service_cnt_last7_total,
              SUM(audio_freeze_time_200_last7) AS audio_freeze_time_200_last7_total,
              SUM(audio_totaltime_200_last7) AS audio_totaltime_200_last7_total,
              SUM(video_freeze_time_500) AS video_freeze_time_500_total,
              SUM(video_totaltime_500) AS video_totaltime_500_total,
              SUM(video_freeze_time_200) AS video_freeze_time_200_total,
              SUM(video_totaltime_200) AS video_totaltime_200_total,
              SUM(video_freeze_time_500_last1) AS video_freeze_time_500_last1_total,
              SUM(video_totaltime_500_last1) AS video_totaltime_500_last1_total,
              SUM(video_freeze_time_200_last1) AS video_freeze_time_200_last1_total,
              SUM(video_totaltime_200_last1) AS video_totaltime_200_last1_total,
              SUM(video_freeze_time_500_last7) AS video_freeze_time_500_last7_total,
              SUM(video_totaltime_500_last7) AS video_totaltime_500_last7_total,
              SUM(video_freeze_time_200_last7) AS video_freeze_time_200_last7_total,
              SUM(video_totaltime_200_last7) AS video_totaltime_200_last7_total,
              SUM(s2l_lost_Leq5) AS s2l_lost_Leq5_total,
              SUM(s2l_lost_all) AS s2l_lost_all_total,
              SUM(s2l_lost_Leq5_last1) AS s2l_lost_Leq5_last1_total,
              SUM(s2l_lost_all_last1) AS s2l_lost_all_last1_total,
              SUM(s2l_lost_Leq5_last7) AS s2l_lost_Leq5_last7_total,
              SUM(s2l_lost_all_last7) AS s2l_lost_all_last7_total
            FROM report_datahub.vid_osver_net_cp_domain_quality_di_1
            WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-21') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-11-21') AND CAST(vid AS VARCHAR) = CAST(281104 AS VARCHAR) AND CAST(product_level_2 AS VARCHAR) = 'Native'
            GROUP BY vid,
              date) AS tt ON CAST(ts.vid AS VARCHAR) = CAST(tt.vid AS VARCHAR) AND ts.date = tt.date) AS ""自定义 SQL 查询""
    HAVING COUNT(1) > 0) AS ""t0""
WHERE CAST(""自定义 SQL 查询"".""dim"" AS VARCHAR) = 'osver' AND DATE_ADD('SECOND', 0, date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d')) = DATE_ADD('SECOND', 0, ""t0"".""__measure__0"")
HAVING COUNT(1) > 0"
"SELECT ""t0"".""srcisp"" AS ""srcisp""
FROM (SELECT ""自定义 SQL 查询"".""srcisp"" AS ""srcisp""
    FROM (SELECT date AS ""date"",
          src_domain AS ""srcDomain"",
          src_country AS ""srcCountry"",
          dest_idc AS ""idc"",
          speaker_ip_isp AS ""srcisp"",
          speaker_vos_ip,
          delay_25 AS ""p2s_Delay25"",
          delay_50 AS ""p2s_Delay50"",
          delay_75 AS ""p2s_Delay75"",
          delay_100 AS ""p2s_Delay100"",
          delay_125 AS ""p2s_Delay125"",
          delay_150 AS ""p2s_Delay150"",
          delay_total,
          lost_ratio_5 AS ""p2s_lostRatio"",
          lostratio_total AS ""p2s_total"",
          jitter95_50 AS ""p2s_jitter95_50"",
          jitter95_100 AS ""p2s_jitter95_100"",
          jitter95_200 AS ""p2s_jitter95_200"",
          jitter95_300 AS ""p2s_jitter95_300"",
          jitter95_total,
          product_line,
          product_type
        FROM media.p2s_cover_oversea_ip
        WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-25') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-01')) AS ""自定义 SQL 查询""
    GROUP BY ""自定义 SQL 查询"".""idc"",
      ""自定义 SQL 查询"".""srcCountry"",
      ""自定义 SQL 查询"".""srcDomain"",
      1
    HAVING CAST(CASE WHEN SUM(""自定义 SQL 查询"".""p2s_total"") >= 0 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100 THEN '0-100' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 1000 THEN '100-1000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 1000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 10000 THEN '1000-10000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 10000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100000 THEN '10000-100000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100000 THEN '100000以上' ELSE 'other' END AS VARCHAR) = '100-1000' OR CAST(CASE WHEN SUM(""自定义 SQL 查询"".""p2s_total"") >= 0 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100 THEN '0-100' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 1000 THEN '100-1000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 1000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 10000 THEN '1000-10000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 10000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100000 THEN '10000-100000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100000 THEN '100000以上' ELSE 'other' END AS VARCHAR) = '1000-10000' OR CAST(CASE WHEN SUM(""自定义 SQL 查询"".""p2s_total"") >= 0 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100 THEN '0-100' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 1000 THEN '100-1000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 1000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 10000 THEN '1000-10000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 10000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100000 THEN '10000-100000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100000 THEN '100000以上' ELSE 'other' END AS VARCHAR) = '10000-100000' OR CAST(CASE WHEN SUM(""自定义 SQL 查询"".""p2s_total"") >= 0 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100 THEN '0-100' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 1000 THEN '100-1000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 1000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 10000 THEN '1000-10000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 10000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100000 THEN '10000-100000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100000 THEN '100000以上' ELSE 'other' END AS VARCHAR) = '100000以上') AS ""t0""
GROUP BY 1"
"SELECT ""自定义 SQL 查询"".""srcDomain"" AS ""srcDomain""
FROM (SELECT date,
      src_domain AS ""srcDomain"",
      delay_25 AS ""p2s_Delay25"",
      delay_50 AS ""p2s_Delay50"",
      delay_75 AS ""p2s_Delay75"",
      delay_100 AS ""p2s_Delay100"",
      delay_125 AS ""p2s_Delay125"",
      delay_150 AS ""p2s_Delay150"",
      delay_total,
      lost_ratio_5 AS ""p2s_lostRatio"",
      lostratio_total AS ""p2s_total"",
      jitter95_50 AS ""p2s_jitter95_50"",
      jitter95_100 AS ""p2s_jitter95_100"",
      jitter95_200 AS ""p2s_jitter95_200"",
      jitter95_300 AS ""p2s_jitter95_300"",
      jitter95_total,
      product_line,
      product_type
    FROM media.p2s_cover_domain
    WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-25') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-01')) AS ""自定义 SQL 查询""
GROUP BY 1
ORDER BY ""srcDomain"""
"SELECT SUM(""自定义 SQL 查询"".""host_4k"") AS ""TEMP(Calculation_3519281700079370244)(1075454865)(0)"",
  SUM(""自定义 SQL 查询"".""audience_sd"") AS ""TEMP(Calculation_3519281700079370244)(1133678835)(0)"",
  SUM(""自定义 SQL 查询"".""host_1080p"") AS ""TEMP(Calculation_3519281700079370244)(1312501967)(0)"",
  SUM(""自定义 SQL 查询"".""host_hd"") AS ""TEMP(Calculation_3519281700079370244)(276907208)(0)"",
  SUM(""自定义 SQL 查询"".""video"") AS ""TEMP(Calculation_3519281700079370244)(2929708110)(0)"",
  SUM(""自定义 SQL 查询"".""audience_hd"") AS ""TEMP(Calculation_3519281700079370244)(2930728935)(0)"",
  SUM(""自定义 SQL 查询"".""audience_hdp"") AS ""TEMP(Calculation_3519281700079370244)(3010533957)(0)"",
  SUM(""自定义 SQL 查询"".""host_hdp"") AS ""TEMP(Calculation_3519281700079370244)(30306054)(0)"",
  SUM(""自定义 SQL 查询"".""host_audio"") AS ""TEMP(Calculation_3519281700079370244)(3087054365)(0)"",
  SUM(""自定义 SQL 查询"".""audio"") AS ""TEMP(Calculation_3519281700079370244)(3299350010)(0)"",
  SUM(""自定义 SQL 查询"".""audience_1080p"") AS ""TEMP(Calculation_3519281700079370244)(3628946582)(0)"",
  SUM(""自定义 SQL 查询"".""totalUsage"") AS ""TEMP(Calculation_3519281700079370244)(3847882359)(0)"",
  SUM(""自定义 SQL 查询"".""audience_audio"") AS ""TEMP(Calculation_3519281700079370244)(4109514392)(0)"",
  SUM(""自定义 SQL 查询"".""host_2k"") AS ""TEMP(Calculation_3519281700079370244)(586790827)(0)"",
  SUM(""自定义 SQL 查询"".""host_sd"") AS ""TEMP(Calculation_3519281700079370244)(709512178)(0)"",
  SUM(""自定义 SQL 查询"".""audience_4k"") AS ""TEMP(Calculation_3519281700079370244)(764410224)(0)"",
  SUM(""自定义 SQL 查询"".""audience_2k"") AS ""TEMP(Calculation_3519281700079370244)(943764407)(0)"",
  SUM(""自定义 SQL 查询"".""host_4k_last"") AS ""TEMP(Calculation_3519281700083154949)(101123376)(0)"",
  SUM(""自定义 SQL 查询"".""audience_video_hdp_last"") AS ""TEMP(Calculation_3519281700083154949)(1200517625)(0)"",
  SUM(""自定义 SQL 查询"".""audience_1080p_last"") AS ""TEMP(Calculation_3519281700083154949)(1314346200)(0)"",
  SUM(""自定义 SQL 查询"".""audience_video_hd_last"") AS ""TEMP(Calculation_3519281700083154949)(146570423)(0)"",
  SUM(""自定义 SQL 查询"".""audience_2k_last"") AS ""TEMP(Calculation_3519281700083154949)(1717771635)(0)"",
  SUM(""自定义 SQL 查询"".""audience_audio_last"") AS ""TEMP(Calculation_3519281700083154949)(2313111073)(0)"",
  SUM(""自定义 SQL 查询"".""host_video_hdp_last"") AS ""TEMP(Calculation_3519281700083154949)(258310559)(0)"",
  SUM(""自定义 SQL 查询"".""audio_video_last"") AS ""TEMP(Calculation_3519281700083154949)(2820618408)(0)"",
  SUM(""自定义 SQL 查询"".""audience_4k_last"") AS ""TEMP(Calculation_3519281700083154949)(3121859593)(0)"",
  SUM(""自定义 SQL 查询"".""host_1080p_last"") AS ""TEMP(Calculation_3519281700083154949)(3222422303)(0)"",
  SUM(""自定义 SQL 查询"".""host_audio_last"") AS ""TEMP(Calculation_3519281700083154949)(3227677803)(0)"",
  SUM(""自定义 SQL 查询"".""video_last"") AS ""TEMP(Calculation_3519281700083154949)(3934387163)(0)"",
  SUM(""自定义 SQL 查询"".""host_2k_last"") AS ""TEMP(Calculation_3519281700083154949)(4055292783)(0)"",
  SUM(""自定义 SQL 查询"".""audio_last"") AS ""TEMP(Calculation_3519281700083154949)(4091190060)(0)"",
  SUM(""自定义 SQL 查询"".""host_video_hd_last"") AS ""TEMP(Calculation_3519281700083154949)(4170367250)(0)"",
  SUM(""自定义 SQL 查询"".""host_video_sd_last"") AS ""TEMP(Calculation_3519281700083154949)(4190307025)(0)"",
  SUM(""自定义 SQL 查询"".""audience_video_sd_last"") AS ""TEMP(Calculation_3519281700083154949)(933007102)(0)"",
  MAX(""自定义 SQL 查询"".""stat_date"") AS ""TEMP(attr_stat_date_nk)(2102638629)(0)"",
  MIN(""自定义 SQL 查询"".""stat_date"") AS ""TEMP(attr_stat_date_nk)(2790680713)(0)"",
  ""自定义 SQL 查询"".""level1"" AS ""level1"",
  SUM(""自定义 SQL 查询"".""totalUsage"") AS ""sum_totalUsage_ok"",
  DATE_ADD('SECOND', 0, date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d')) AS ""tdy_date_ok""
FROM (SELECT date,
        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,
      start_date AS start_date_7,
      end_date AS end_date,
      tag,
      area AS Scope,
      dim,
        CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,
      level2,
      level3,
      level4,
      product_level1 AS product_line,
      product_level2,
      product_level3,
      product_level4,
      vid_internal_industry_en AS cid_industry,
      vid_use_case_en AS vid_use_case_cn,
      vid_sector_en,
      ver_type,
      ver,
      os,
      domain,
      country,
      region,
      dim_grouping_name,
        CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,
      total AS totalUsage,
      audio,
      video,
      host_audio,
      audience_audio,
      host_sd,
      host_hd,
      host_hdp,
      host_1080p,
      host_2k,
      host_4k,
      audience_sd,
      audience_hd,
      audience_hdp,
      audience_1080p,
      audience_2k,
      audience_4k,
      audience_audio_low_latency,
      audience_sd_low_latency,
      audience_hd_low_latency,
      audience_hdp_low_latency,
      audience_1080p_low_latency,
      audience_2k_low_latency,
      audience_4k_low_latency,
      audience_audio_ultra_low_latency,
      audience_sd_ultra_low_latency,
      audience_hd_ultra_low_latency,
      audience_hdp_ultra_low_latency,
      audience_1080p_ultra_low_latency,
      audience_2k_ultra_low_latency,
      audience_4k_ultra_low_latency,
      total_last1 AS audio_video_last,
      audio_last1 AS audio_last,
      video_last1 AS video_last,
      video_sd_last1 AS video_sd_last,
      video_hd_last1 AS video_hd_last,
      video_hdp_last1 AS video_hdp_last,
      host_sd_last1 AS host_video_sd_last,
      audience_sd_last1 AS audience_video_sd_last,
      host_hd_last1 AS host_video_hd_last,
      audience_hd_last1 AS audience_video_hd_last,
      host_hdp_last1 AS host_video_hdp_last,
      audience_hdp_last1 AS audience_video_hdp_last,
      host_audio_last1 AS host_audio_last,
      audience_audio_last1 AS audience_audio_last,
      host_video_last1 AS host_video_last,
      audience_video_last1 AS audience_video_last,
      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,
      audience_video_low_latency_last1 AS audience_video_low_latency_last,
      audience_total_low_latency_last1 AS audience_total_low_latency_last,
      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,
      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,
      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,
      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,
      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,
      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,
      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,
      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,
      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,
      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,
      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,
      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,
      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,
      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,
      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,
      audience_2k_last1 AS audience_2k_last,
      audience_4k_last1 AS audience_4k_last,
      audience_1080p_last1 AS audience_1080p_last,
      host_1080p_last1 AS host_1080p_last,
      host_2k_last1 AS host_2k_last,
      host_4k_last1 AS host_4k_last,
      total_last7,
      audio_last7,
      video_last7,
      video_sd_last7,
      video_hd_last7,
      video_hdp_last7,
      host_sd_last7,
      audience_sd_last7,
      host_hd_last7,
      audience_hd_last7,
      host_hdp_last7,
      audience_hdp_last7,
      host_audio_last7,
      audience_audio_last7,
      host_video_last7,
      audience_video_last7,
      audience_audio_low_latency_last7,
      audience_video_low_latency_last7,
      audience_total_low_latency_last7,
      audience_sd_low_latency_last7,
      audience_hd_low_latency_last7,
      audience_hdp_low_latency_last7,
      audience_1080p_low_latency_last7,
      audience_2k_low_latency_last7,
      audience_4k_low_latency_last7,
      audience_audio_ultra_low_latency_last7,
      audience_video_ultra_low_latency_last7,
      audience_total_ultra_low_latency_last7,
      audience_sd_ultra_low_latency_last7,
      audience_hd_ultra_low_latency_last7,
      audience_hdp_ultra_low_latency_last7,
      audience_1080p_ultra_low_latency_last7,
      audience_2k_ultra_low_latency_last7,
      audience_4k_ultra_low_latency_last7,
      audience_2k_last7,
      audience_4k_last7,
      audience_1080p_last7,
      host_1080p_last7,
      host_2k_last7,
      host_4k_last7
    FROM levels_usage_dod_di_1
    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-06') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-04') AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS ""自定义 SQL 查询""
WHERE ""自定义 SQL 查询"".""dim"" = 1 AND ""自定义 SQL 查询"".""rank_level1"" = 2
GROUP BY 37,
  39"
"SELECT ""自定义 SQL 查询"".""srcDomain"" AS ""srcDomain""
FROM (SELECT date AS ""date"",
      src_domain AS ""srcDomain"",
      src_country AS ""srcCountry"",
      dest_idc AS ""idc"",
      delay_25 AS ""p2s_Delay25"",
      delay_50 AS ""p2s_Delay50"",
      delay_75 AS ""p2s_Delay75"",
      delay_100 AS ""p2s_Delay100"",
      delay_125 AS ""p2s_Delay125"",
      delay_150 AS ""p2s_Delay150"",
      delay_total,
      lost_ratio_5 AS ""p2s_lostRatio"",
      lostratio_total AS ""p2s_total"",
      jitter95_50 AS ""p2s_jitter95_50"",
      jitter95_100 AS ""p2s_jitter95_100"",
      jitter95_200 AS ""p2s_jitter95_200"",
      jitter95_300 AS ""p2s_jitter95_300"",
      jitter95_total,
      product_line,
      product_type
    FROM media.p2s_cover_oversea_idc
    WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-25') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-01')) AS ""自定义 SQL 查询""
WHERE CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'aofei-frankfurt1g' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'zhuzhou1g-ctel' AND ""自定义 SQL 查询"".""srcCountry"" NOT IN ('Falkland Islands', 'British Indian Ocean Territory', 'Montserrat', 'North Korea', 'Tuvalu', 'Niue')
GROUP BY 1"
"SELECT SUM(""自定义 SQL 查询"".""host_4k"") AS ""TEMP(Calculation_3519281700079370244)(1075454865)(0)"",
  SUM(""自定义 SQL 查询"".""audience_sd"") AS ""TEMP(Calculation_3519281700079370244)(1133678835)(0)"",
  SUM(""自定义 SQL 查询"".""host_1080p"") AS ""TEMP(Calculation_3519281700079370244)(1312501967)(0)"",
  SUM(""自定义 SQL 查询"".""host_hd"") AS ""TEMP(Calculation_3519281700079370244)(276907208)(0)"",
  SUM(""自定义 SQL 查询"".""video"") AS ""TEMP(Calculation_3519281700079370244)(2929708110)(0)"",
  SUM(""自定义 SQL 查询"".""audience_hd"") AS ""TEMP(Calculation_3519281700079370244)(2930728935)(0)"",
  SUM(""自定义 SQL 查询"".""audience_hdp"") AS ""TEMP(Calculation_3519281700079370244)(3010533957)(0)"",
  SUM(""自定义 SQL 查询"".""host_hdp"") AS ""TEMP(Calculation_3519281700079370244)(30306054)(0)"",
  SUM(""自定义 SQL 查询"".""host_audio"") AS ""TEMP(Calculation_3519281700079370244)(3087054365)(0)"",
  SUM(""自定义 SQL 查询"".""audio"") AS ""TEMP(Calculation_3519281700079370244)(3299350010)(0)"",
  SUM(""自定义 SQL 查询"".""audience_1080p"") AS ""TEMP(Calculation_3519281700079370244)(3628946582)(0)"",
  SUM(""自定义 SQL 查询"".""totalUsage"") AS ""TEMP(Calculation_3519281700079370244)(3847882359)(0)"",
  SUM(""自定义 SQL 查询"".""audience_audio"") AS ""TEMP(Calculation_3519281700079370244)(4109514392)(0)"",
  SUM(""自定义 SQL 查询"".""host_2k"") AS ""TEMP(Calculation_3519281700079370244)(586790827)(0)"",
  SUM(""自定义 SQL 查询"".""host_sd"") AS ""TEMP(Calculation_3519281700079370244)(709512178)(0)"",
  SUM(""自定义 SQL 查询"".""audience_4k"") AS ""TEMP(Calculation_3519281700079370244)(764410224)(0)"",
  SUM(""自定义 SQL 查询"".""audience_2k"") AS ""TEMP(Calculation_3519281700079370244)(943764407)(0)"",
  ""自定义 SQL 查询"".""level1"" AS ""level1"",
  SUM(""自定义 SQL 查询"".""totalUsage"") AS ""sum_totalUsage_ok"",
  DATE_ADD('SECOND', 0, date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d')) AS ""tdy_date_ok""
FROM (SELECT date,
        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,
      start_date AS start_date_7,
      end_date AS end_date,
      tag,
      area AS Scope,
      dim,
        CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,
      level2,
      level3,
      level4,
      product_level1 AS product_line,
      product_level2,
      product_level3,
      product_level4,
      vid_internal_industry_en AS cid_industry,
      vid_use_case_en AS vid_use_case_cn,
      vid_sector_en,
      ver_type,
      ver,
      os,
      domain,
      country,
      region,
      dim_grouping_name,
        CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,
      total AS totalUsage,
      audio,
      video,
      host_audio,
      audience_audio,
      host_sd,
      host_hd,
      host_hdp,
      host_1080p,
      host_2k,
      host_4k,
      audience_sd,
      audience_hd,
      audience_hdp,
      audience_1080p,
      audience_2k,
      audience_4k,
      audience_audio_low_latency,
      audience_sd_low_latency,
      audience_hd_low_latency,
      audience_hdp_low_latency,
      audience_1080p_low_latency,
      audience_2k_low_latency,
      audience_4k_low_latency,
      audience_audio_ultra_low_latency,
      audience_sd_ultra_low_latency,
      audience_hd_ultra_low_latency,
      audience_hdp_ultra_low_latency,
      audience_1080p_ultra_low_latency,
      audience_2k_ultra_low_latency,
      audience_4k_ultra_low_latency,
      total_last1 AS audio_video_last,
      audio_last1 AS audio_last,
      video_last1 AS video_last,
      video_sd_last1 AS video_sd_last,
      video_hd_last1 AS video_hd_last,
      video_hdp_last1 AS video_hdp_last,
      host_sd_last1 AS host_video_sd_last,
      audience_sd_last1 AS audience_video_sd_last,
      host_hd_last1 AS host_video_hd_last,
      audience_hd_last1 AS audience_video_hd_last,
      host_hdp_last1 AS host_video_hdp_last,
      audience_hdp_last1 AS audience_video_hdp_last,
      host_audio_last1 AS host_audio_last,
      audience_audio_last1 AS audience_audio_last,
      host_video_last1 AS host_video_last,
      audience_video_last1 AS audience_video_last,
      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,
      audience_video_low_latency_last1 AS audience_video_low_latency_last,
      audience_total_low_latency_last1 AS audience_total_low_latency_last,
      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,
      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,
      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,
      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,
      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,
      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,
      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,
      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,
      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,
      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,
      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,
      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,
      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,
      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,
      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,
      audience_2k_last1 AS audience_2k_last,
      audience_4k_last1 AS audience_4k_last,
      audience_1080p_last1 AS audience_1080p_last,
      host_1080p_last1 AS host_1080p_last,
      host_2k_last1 AS host_2k_last,
      host_4k_last1 AS host_4k_last,
      total_last7,
      audio_last7,
      video_last7,
      video_sd_last7,
      video_hd_last7,
      video_hdp_last7,
      host_sd_last7,
      audience_sd_last7,
      host_hd_last7,
      audience_hd_last7,
      host_hdp_last7,
      audience_hdp_last7,
      host_audio_last7,
      audience_audio_last7,
      host_video_last7,
      audience_video_last7,
      audience_audio_low_latency_last7,
      audience_video_low_latency_last7,
      audience_total_low_latency_last7,
      audience_sd_low_latency_last7,
      audience_hd_low_latency_last7,
      audience_hdp_low_latency_last7,
      audience_1080p_low_latency_last7,
      audience_2k_low_latency_last7,
      audience_4k_low_latency_last7,
      audience_audio_ultra_low_latency_last7,
      audience_video_ultra_low_latency_last7,
      audience_total_ultra_low_latency_last7,
      audience_sd_ultra_low_latency_last7,
      audience_hd_ultra_low_latency_last7,
      audience_hdp_ultra_low_latency_last7,
      audience_1080p_ultra_low_latency_last7,
      audience_2k_ultra_low_latency_last7,
      audience_4k_ultra_low_latency_last7,
      audience_2k_last7,
      audience_4k_last7,
      audience_1080p_last7,
      host_1080p_last7,
      host_2k_last7,
      host_4k_last7
    FROM levels_usage_dod_di_1
    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-06') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-04') AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS ""自定义 SQL 查询""
  CROSS JOIN (SELECT MAX(date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d')) AS ""__measure__0""
    FROM (SELECT date,
            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,
          start_date AS start_date_7,
          end_date AS end_date,
          tag,
          area AS Scope,
          dim,
            CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,
          level2,
          level3,
          level4,
          product_level1 AS product_line,
          product_level2,
          product_level3,
          product_level4,
          vid_internal_industry_en AS cid_industry,
          vid_use_case_en AS vid_use_case_cn,
          vid_sector_en,
          ver_type,
          ver,
          os,
          domain,
          country,
          region,
          dim_grouping_name,
            CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,
          total AS totalUsage,
          audio,
          video,
          host_audio,
          audience_audio,
          host_sd,
          host_hd,
          host_hdp,
          host_1080p,
          host_2k,
          host_4k,
          audience_sd,
          audience_hd,
          audience_hdp,
          audience_1080p,
          audience_2k,
          audience_4k,
          audience_audio_low_latency,
          audience_sd_low_latency,
          audience_hd_low_latency,
          audience_hdp_low_latency,
          audience_1080p_low_latency,
          audience_2k_low_latency,
          audience_4k_low_latency,
          audience_audio_ultra_low_latency,
          audience_sd_ultra_low_latency,
          audience_hd_ultra_low_latency,
          audience_hdp_ultra_low_latency,
          audience_1080p_ultra_low_latency,
          audience_2k_ultra_low_latency,
          audience_4k_ultra_low_latency,
          total_last1 AS audio_video_last,
          audio_last1 AS audio_last,
          video_last1 AS video_last,
          video_sd_last1 AS video_sd_last,
          video_hd_last1 AS video_hd_last,
          video_hdp_last1 AS video_hdp_last,
          host_sd_last1 AS host_video_sd_last,
          audience_sd_last1 AS audience_video_sd_last,
          host_hd_last1 AS host_video_hd_last,
          audience_hd_last1 AS audience_video_hd_last,
          host_hdp_last1 AS host_video_hdp_last,
          audience_hdp_last1 AS audience_video_hdp_last,
          host_audio_last1 AS host_audio_last,
          audience_audio_last1 AS audience_audio_last,
          host_video_last1 AS host_video_last,
          audience_video_last1 AS audience_video_last,
          audience_audio_low_latency_last1 AS audience_audio_low_latency_last,
          audience_video_low_latency_last1 AS audience_video_low_latency_last,
          audience_total_low_latency_last1 AS audience_total_low_latency_last,
          audience_sd_low_latency_last1 AS audience_sd_low_latency_last,
          audience_hd_low_latency_last1 AS audience_hd_low_latency_last,
          audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,
          audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,
          audience_2k_low_latency_last1 AS audience_2k_low_latency_last,
          audience_4k_low_latency_last1 AS audience_4k_low_latency_last,
          audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,
          audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,
          audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,
          audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,
          audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,
          audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,
          audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,
          audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,
          audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,
          audience_2k_last1 AS audience_2k_last,
          audience_4k_last1 AS audience_4k_last,
          audience_1080p_last1 AS audience_1080p_last,
          host_1080p_last1 AS host_1080p_last,
          host_2k_last1 AS host_2k_last,
          host_4k_last1 AS host_4k_last,
          total_last7,
          audio_last7,
          video_last7,
          video_sd_last7,
          video_hd_last7,
          video_hdp_last7,
          host_sd_last7,
          audience_sd_last7,
          host_hd_last7,
          audience_hd_last7,
          host_hdp_last7,
          audience_hdp_last7,
          host_audio_last7,
          audience_audio_last7,
          host_video_last7,
          audience_video_last7,
          audience_audio_low_latency_last7,
          audience_video_low_latency_last7,
          audience_total_low_latency_last7,
          audience_sd_low_latency_last7,
          audience_hd_low_latency_last7,
          audience_hdp_low_latency_last7,
          audience_1080p_low_latency_last7,
          audience_2k_low_latency_last7,
          audience_4k_low_latency_last7,
          audience_audio_ultra_low_latency_last7,
          audience_video_ultra_low_latency_last7,
          audience_total_ultra_low_latency_last7,
          audience_sd_ultra_low_latency_last7,
          audience_hd_ultra_low_latency_last7,
          audience_hdp_ultra_low_latency_last7,
          audience_1080p_ultra_low_latency_last7,
          audience_2k_ultra_low_latency_last7,
          audience_4k_ultra_low_latency_last7,
          audience_2k_last7,
          audience_4k_last7,
          audience_1080p_last7,
          host_1080p_last7,
          host_2k_last7,
          host_4k_last7
        FROM levels_usage_dod_di_1
        WHERE CAST(tag AS VARCHAR) = 'Industry' AND date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-06') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-04') AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS ""自定义 SQL 查询""
    HAVING COUNT(1) > 0) AS ""t0""
WHERE ""自定义 SQL 查询"".""dim"" = 1 AND ""自定义 SQL 查询"".""rank_level1"" = 7 AND date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d') = ""t0"".""__measure__0""
GROUP BY 18,
  20"
"SELECT SUM(""自定义 SQL 查询"".""host_4k"") AS ""TEMP(Calculation_3519281700341563406)(1075454865)(0)"",
  SUM(""自定义 SQL 查询"".""audience_audio_last7"") AS ""TEMP(Calculation_3519281700341563406)(1077563395)(0)"",
  SUM(""自定义 SQL 查询"".""audience_sd"") AS ""TEMP(Calculation_3519281700341563406)(1133678835)(0)"",
  SUM(""自定义 SQL 查询"".""host_1080p"") AS ""TEMP(Calculation_3519281700341563406)(1312501967)(0)"",
  SUM(""自定义 SQL 查询"".""audience_sd_last7"") AS ""TEMP(Calculation_3519281700341563406)(1456465729)(0)"",
  SUM(""自定义 SQL 查询"".""host_hd_last7"") AS ""TEMP(Calculation_3519281700341563406)(1635749653)(0)"",
  SUM(""自定义 SQL 查询"".""audience_hd_last7"") AS ""TEMP(Calculation_3519281700341563406)(1747046964)(0)"",
  SUM(""自定义 SQL 查询"".""audience_2k_last7"") AS ""TEMP(Calculation_3519281700341563406)(1747524570)(0)"",
  SUM(""自定义 SQL 查询"".""host_hdp_last7"") AS ""TEMP(Calculation_3519281700341563406)(2044136109)(0)"",
  SUM(""自定义 SQL 查询"".""host_audio_last7"") AS ""TEMP(Calculation_3519281700341563406)(2464388580)(0)"",
  SUM(""自定义 SQL 查询"".""audio_last7"") AS ""TEMP(Calculation_3519281700341563406)(2589233512)(0)"",
  SUM(""自定义 SQL 查询"".""host_hd"") AS ""TEMP(Calculation_3519281700341563406)(276907208)(0)"",
  SUM(""自定义 SQL 查询"".""host_2k_last7"") AS ""TEMP(Calculation_3519281700341563406)(280796653)(0)"",
  SUM(""自定义 SQL 查询"".""video"") AS ""TEMP(Calculation_3519281700341563406)(2929708110)(0)"",
  SUM(""自定义 SQL 查询"".""audience_hd"") AS ""TEMP(Calculation_3519281700341563406)(2930728935)(0)"",
  SUM(""自定义 SQL 查询"".""audience_hdp"") AS ""TEMP(Calculation_3519281700341563406)(3010533957)(0)"",
  SUM(""自定义 SQL 查询"".""host_hdp"") AS ""TEMP(Calculation_3519281700341563406)(30306054)(0)"",
  SUM(""自定义 SQL 查询"".""host_audio"") AS ""TEMP(Calculation_3519281700341563406)(3087054365)(0)"",
  SUM(""自定义 SQL 查询"".""host_4k_last7"") AS ""TEMP(Calculation_3519281700341563406)(3127348545)(0)"",
  SUM(""自定义 SQL 查询"".""audio"") AS ""TEMP(Calculation_3519281700341563406)(3299350010)(0)"",
  SUM(""自定义 SQL 查询"".""total_last7"") AS ""TEMP(Calculation_3519281700341563406)(346677966)(0)"",
  SUM(""自定义 SQL 查询"".""audience_4k_last7"") AS ""TEMP(Calculation_3519281700341563406)(3543669678)(0)"",
  SUM(""自定义 SQL 查询"".""host_1080p_last7"") AS ""TEMP(Calculation_3519281700341563406)(3624983014)(0)"",
  SUM(""自定义 SQL 查询"".""audience_1080p"") AS ""TEMP(Calculation_3519281700341563406)(3628946582)(0)"",
  SUM(""自定义 SQL 查询"".""totalUsage"") AS ""TEMP(Calculation_3519281700341563406)(3847882359)(0)"",
  SUM(""自定义 SQL 查询"".""host_sd_last7"") AS ""TEMP(Calculation_3519281700341563406)(3905372418)(0)"",
  SUM(""自定义 SQL 查询"".""video_last7"") AS ""TEMP(Calculation_3519281700341563406)(4107040267)(0)"",
  SUM(""自定义 SQL 查询"".""audience_audio"") AS ""TEMP(Calculation_3519281700341563406)(4109514392)(0)"",
  SUM(""自定义 SQL 查询"".""host_2k"") AS ""TEMP(Calculation_3519281700341563406)(586790827)(0)"",
  SUM(""自定义 SQL 查询"".""audience_1080p_last7"") AS ""TEMP(Calculation_3519281700341563406)(632977665)(0)"",
  SUM(""自定义 SQL 查询"".""host_sd"") AS ""TEMP(Calculation_3519281700341563406)(709512178)(0)"",
  SUM(""自定义 SQL 查询"".""audience_hdp_last7"") AS ""TEMP(Calculation_3519281700341563406)(750340200)(0)"",
  SUM(""自定义 SQL 查询"".""audience_4k"") AS ""TEMP(Calculation_3519281700341563406)(764410224)(0)"",
  SUM(""自定义 SQL 查询"".""audience_2k"") AS ""TEMP(Calculation_3519281700341563406)(943764407)(0)"",
  ""自定义 SQL 查询"".""level1"" AS ""level1"",
  SUM(""自定义 SQL 查询"".""audio_video_last"") AS ""sum_audio_video_last_ok""
FROM (SELECT date,
        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,
      start_date AS start_date_7,
      end_date AS end_date,
      tag,
      area AS Scope,
      dim,
        CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,
      level2,
      level3,
      level4,
      product_level1 AS product_line,
      product_level2,
      product_level3,
      product_level4,
      vid_internal_industry_en AS cid_industry,
      vid_use_case_en AS vid_use_case_cn,
      vid_sector_en,
      ver_type,
      ver,
      os,
      domain,
      country,
      region,
      dim_grouping_name,
        CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,
      total AS totalUsage,
      audio,
      video,
      host_audio,
      audience_audio,
      host_sd,
      host_hd,
      host_hdp,
      host_1080p,
      host_2k,
      host_4k,
      audience_sd,
      audience_hd,
      audience_hdp,
      audience_1080p,
      audience_2k,
      audience_4k,
      audience_audio_low_latency,
      audience_sd_low_latency,
      audience_hd_low_latency,
      audience_hdp_low_latency,
      audience_1080p_low_latency,
      audience_2k_low_latency,
      audience_4k_low_latency,
      audience_audio_ultra_low_latency,
      audience_sd_ultra_low_latency,
      audience_hd_ultra_low_latency,
      audience_hdp_ultra_low_latency,
      audience_1080p_ultra_low_latency,
      audience_2k_ultra_low_latency,
      audience_4k_ultra_low_latency,
      total_last1 AS audio_video_last,
      audio_last1 AS audio_last,
      video_last1 AS video_last,
      video_sd_last1 AS video_sd_last,
      video_hd_last1 AS video_hd_last,
      video_hdp_last1 AS video_hdp_last,
      host_sd_last1 AS host_video_sd_last,
      audience_sd_last1 AS audience_video_sd_last,
      host_hd_last1 AS host_video_hd_last,
      audience_hd_last1 AS audience_video_hd_last,
      host_hdp_last1 AS host_video_hdp_last,
      audience_hdp_last1 AS audience_video_hdp_last,
      host_audio_last1 AS host_audio_last,
      audience_audio_last1 AS audience_audio_last,
      host_video_last1 AS host_video_last,
      audience_video_last1 AS audience_video_last,
      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,
      audience_video_low_latency_last1 AS audience_video_low_latency_last,
      audience_total_low_latency_last1 AS audience_total_low_latency_last,
      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,
      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,
      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,
      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,
      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,
      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,
      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,
      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,
      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,
      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,
      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,
      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,
      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,
      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,
      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,
      audience_2k_last1 AS audience_2k_last,
      audience_4k_last1 AS audience_4k_last,
      audience_1080p_last1 AS audience_1080p_last,
      host_1080p_last1 AS host_1080p_last,
      host_2k_last1 AS host_2k_last,
      host_4k_last1 AS host_4k_last,
      total_last7,
      audio_last7,
      video_last7,
      video_sd_last7,
      video_hd_last7,
      video_hdp_last7,
      host_sd_last7,
      audience_sd_last7,
      host_hd_last7,
      audience_hd_last7,
      host_hdp_last7,
      audience_hdp_last7,
      host_audio_last7,
      audience_audio_last7,
      host_video_last7,
      audience_video_last7,
      audience_audio_low_latency_last7,
      audience_video_low_latency_last7,
      audience_total_low_latency_last7,
      audience_sd_low_latency_last7,
      audience_hd_low_latency_last7,
      audience_hdp_low_latency_last7,
      audience_1080p_low_latency_last7,
      audience_2k_low_latency_last7,
      audience_4k_low_latency_last7,
      audience_audio_ultra_low_latency_last7,
      audience_video_ultra_low_latency_last7,
      audience_total_ultra_low_latency_last7,
      audience_sd_ultra_low_latency_last7,
      audience_hd_ultra_low_latency_last7,
      audience_hdp_ultra_low_latency_last7,
      audience_1080p_ultra_low_latency_last7,
      audience_2k_ultra_low_latency_last7,
      audience_4k_ultra_low_latency_last7,
      audience_2k_last7,
      audience_4k_last7,
      audience_1080p_last7,
      host_1080p_last7,
      host_2k_last7,
      host_4k_last7
    FROM levels_usage_dod_di_1
    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-06') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-04') AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS ""自定义 SQL 查询""
  CROSS JOIN (SELECT MAX(date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d')) AS ""__measure__0""
    FROM (SELECT date,
            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,
          start_date AS start_date_7,
          end_date AS end_date,
          tag,
          area AS Scope,
          dim,
            CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,
          level2,
          level3,
          level4,
          product_level1 AS product_line,
          product_level2,
          product_level3,
          product_level4,
          vid_internal_industry_en AS cid_industry,
          vid_use_case_en AS vid_use_case_cn,
          vid_sector_en,
          ver_type,
          ver,
          os,
          domain,
          country,
          region,
          dim_grouping_name,
            CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,
          total AS totalUsage,
          audio,
          video,
          host_audio,
          audience_audio,
          host_sd,
          host_hd,
          host_hdp,
          host_1080p,
          host_2k,
          host_4k,
          audience_sd,
          audience_hd,
          audience_hdp,
          audience_1080p,
          audience_2k,
          audience_4k,
          audience_audio_low_latency,
          audience_sd_low_latency,
          audience_hd_low_latency,
          audience_hdp_low_latency,
          audience_1080p_low_latency,
          audience_2k_low_latency,
          audience_4k_low_latency,
          audience_audio_ultra_low_latency,
          audience_sd_ultra_low_latency,
          audience_hd_ultra_low_latency,
          audience_hdp_ultra_low_latency,
          audience_1080p_ultra_low_latency,
          audience_2k_ultra_low_latency,
          audience_4k_ultra_low_latency,
          total_last1 AS audio_video_last,
          audio_last1 AS audio_last,
          video_last1 AS video_last,
          video_sd_last1 AS video_sd_last,
          video_hd_last1 AS video_hd_last,
          video_hdp_last1 AS video_hdp_last,
          host_sd_last1 AS host_video_sd_last,
          audience_sd_last1 AS audience_video_sd_last,
          host_hd_last1 AS host_video_hd_last,
          audience_hd_last1 AS audience_video_hd_last,
          host_hdp_last1 AS host_video_hdp_last,
          audience_hdp_last1 AS audience_video_hdp_last,
          host_audio_last1 AS host_audio_last,
          audience_audio_last1 AS audience_audio_last,
          host_video_last1 AS host_video_last,
          audience_video_last1 AS audience_video_last,
          audience_audio_low_latency_last1 AS audience_audio_low_latency_last,
          audience_video_low_latency_last1 AS audience_video_low_latency_last,
          audience_total_low_latency_last1 AS audience_total_low_latency_last,
          audience_sd_low_latency_last1 AS audience_sd_low_latency_last,
          audience_hd_low_latency_last1 AS audience_hd_low_latency_last,
          audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,
          audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,
          audience_2k_low_latency_last1 AS audience_2k_low_latency_last,
          audience_4k_low_latency_last1 AS audience_4k_low_latency_last,
          audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,
          audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,
          audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,
          audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,
          audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,
          audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,
          audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,
          audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,
          audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,
          audience_2k_last1 AS audience_2k_last,
          audience_4k_last1 AS audience_4k_last,
          audience_1080p_last1 AS audience_1080p_last,
          host_1080p_last1 AS host_1080p_last,
          host_2k_last1 AS host_2k_last,
          host_4k_last1 AS host_4k_last,
          total_last7,
          audio_last7,
          video_last7,
          video_sd_last7,
          video_hd_last7,
          video_hdp_last7,
          host_sd_last7,
          audience_sd_last7,
          host_hd_last7,
          audience_hd_last7,
          host_hdp_last7,
          audience_hdp_last7,
          host_audio_last7,
          audience_audio_last7,
          host_video_last7,
          audience_video_last7,
          audience_audio_low_latency_last7,
          audience_video_low_latency_last7,
          audience_total_low_latency_last7,
          audience_sd_low_latency_last7,
          audience_hd_low_latency_last7,
          audience_hdp_low_latency_last7,
          audience_1080p_low_latency_last7,
          audience_2k_low_latency_last7,
          audience_4k_low_latency_last7,
          audience_audio_ultra_low_latency_last7,
          audience_video_ultra_low_latency_last7,
          audience_total_ultra_low_latency_last7,
          audience_sd_ultra_low_latency_last7,
          audience_hd_ultra_low_latency_last7,
          audience_hdp_ultra_low_latency_last7,
          audience_1080p_ultra_low_latency_last7,
          audience_2k_ultra_low_latency_last7,
          audience_4k_ultra_low_latency_last7,
          audience_2k_last7,
          audience_4k_last7,
          audience_1080p_last7,
          host_1080p_last7,
          host_2k_last7,
          host_4k_last7
        FROM levels_usage_dod_di_1
        WHERE CAST(tag AS VARCHAR) = 'Industry' AND date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-06') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-04') AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS ""自定义 SQL 查询""
    HAVING COUNT(1) > 0) AS ""t0""
WHERE ""自定义 SQL 查询"".""dim"" = 1 AND ""自定义 SQL 查询"".""rank_level1"" = 5 AND date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d') = ""t0"".""__measure__0""
GROUP BY 35"
"SELECT '跳转：视频可用性' AS ""Calculation_5876704998657425411""
FROM (SELECT ts.*,
      fiveSecJoinSuccess_total,
      threeSecJoinSuccess_total,
      totalJoinSuccess_total,
      totalJoin_total,
      cnt_sid_total,
      ""1s_succ_join_ap_cnt_total"",
      ""5s_succ_join_ap_cnt_total"",
      total_join_ap_cnt_total,
      audio_freeze_time_200_total,
      audio_totaltime_200_total,
      video_freeze_time_total,
      video_totaltime_total,
      p2s_lost_Leq5_total,
      p2s_lost_all_total,
      s2l_25ms_delay_sec_total,
      s2l_75ms_delay_sec_total,
      s2l_total_delay_sec_total,
      crash_cnt_total,
      service_cnt_total,
      ""5s_succ_join_session_cnt_last1_total"",
      ""3s_succ_join_session_cnt_last1_total"",
      succ_join_session_cnt_last1_total,
      total_join_session_cnt_last1_total,
      total_session_cnt_last1_total,
      ""1s_succ_join_ap_cnt_last1_total"",
      ""5s_succ_join_ap_cnt_last1_total"",
      total_join_ap_cnt_last1_total,
      video_freeze_time_last1_total,
      video_totaltime_last1_total,
      p2s_lost_Leq5_last1_total,
      p2s_lost_all_last1_total,
      s2l_25ms_delay_sec_last1_total,
      s2l_75ms_delay_sec_last1_total,
      s2l_total_delay_sec_last1_total,
      crash_cnt_last1_total,
      service_cnt_last1_total,
      audio_freeze_time_200_last1_total,
      audio_totaltime_200_last1_total,
      ""5s_succ_join_session_cnt_last7_total"",
      ""3s_succ_join_session_cnt_last7_total"",
      succ_join_session_cnt_last7_total,
      total_join_session_cnt_last7_total,
      total_session_cnt_last7_total,
      ""7s_succ_join_ap_cnt_last7_total"",
      ""5s_succ_join_ap_cnt_last7_total"",
      total_join_ap_cnt_last7_total,
      video_freeze_time_last7_total,
      video_totaltime_last7_total,
      p2s_lost_Leq5_last7_total,
      p2s_lost_all_last7_total,
      s2l_25ms_delay_sec_last7_total,
      s2l_75ms_delay_sec_last7_total,
      s2l_total_delay_sec_last7_total,
      crash_cnt_last7_total,
      service_cnt_last7_total,
      audio_freeze_time_200_last7_total,
      audio_totaltime_200_last7_total,
      video_freeze_time_500_total,
      video_totaltime_500_total,
      video_freeze_time_200_total,
      video_totaltime_200_total,
      video_freeze_time_500_last1_total,
      video_totaltime_500_last1_total,
      video_freeze_time_200_last1_total,
      video_totaltime_200_last1_total,
      video_freeze_time_500_last7_total,
      video_totaltime_500_last7_total,
      video_freeze_time_200_last7_total,
      video_totaltime_200_last7_total,
      s2l_lost_Leq5_total,
      s2l_lost_all_total,
      s2l_lost_Leq5_last1_total,
      s2l_lost_all_last1_total,
      s2l_lost_Leq5_last7_total,
      s2l_lost_all_last7_total
    FROM (SELECT vid,
          project,
          company_id,
          area,
          company_name,
          industry_name,
          date,
            CASE WHEN CAST(stat_period AS VARCHAR) = 'day' THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(substr(CAST(start_date AS VARCHAR), 1, 10) AS VARCHAR), '~', CAST(substr(CAST(end_date AS VARCHAR), 1, 10) AS VARCHAR)) END AS period,
          net,
          os,
          ver,
          'osver' AS dim,
          product_level_1,
          product_level_2,
          ver_type,
          SUM(fiveSecJoinSuccess) AS fiveSecJoinSuccess,
          SUM(threeSecJoinSuccess) AS threeSecJoinSuccess,
          SUM(totalJoinSuccess) AS totalJoinSuccess,
          SUM(totalJoin) AS totalJoin,
          SUM(cnt_sid) AS cnt_sid,
          SUM(""1s_succ_join_ap_cnt"") AS ""1s_succ_join_ap_cnt"",
          SUM(""5s_succ_join_ap_cnt"") AS ""5s_succ_join_ap_cnt"",
          SUM(total_join_ap_cnt) AS total_join_ap_cnt,
          SUM(audio_freeze_time_200) AS audio_freeze_time_200,
          SUM(audio_totaltime_200) AS audio_totaltime_200,
          SUM(video_freeze_time) AS video_freeze_time,
          SUM(video_totaltime) AS video_totaltime,
          SUM(p2s_lost_Leq5) AS p2s_lost_Leq5,
          SUM(p2s_lost_all) AS p2s_lost_all,
          SUM(s2l_25ms_delay_sec) AS s2l_25ms_delay_sec,
          SUM(s2l_75ms_delay_sec) AS s2l_75ms_delay_sec,
          SUM(s2l_total_delay_sec) AS s2l_total_delay_sec,
          SUM(crash_cnt) AS crash_cnt,
          SUM(service_cnt) AS service_cnt,
          SUM(""5s_succ_join_session_cnt_last1"") AS ""5s_succ_join_session_cnt_last1"",
          SUM(""3s_succ_join_session_cnt_last1"") AS ""3s_succ_join_session_cnt_last1"",
          SUM(succ_join_session_cnt_last1) AS succ_join_session_cnt_last1,
          SUM(total_join_session_cnt_last1) AS total_join_session_cnt_last1,
          SUM(total_session_cnt_last1) AS total_session_cnt_last1,
          SUM(""1s_succ_join_ap_cnt_last1"") AS ""1s_succ_join_ap_cnt_last1"",
          SUM(""5s_succ_join_ap_cnt_last1"") AS ""5s_succ_join_ap_cnt_last1"",
          SUM(total_join_ap_cnt_last1) AS total_join_ap_cnt_last1,
          SUM(video_freeze_time_last1) AS video_freeze_time_last1,
          SUM(video_totaltime_last1) AS video_totaltime_last1,
          SUM(p2s_lost_Leq5_last1) AS p2s_lost_Leq5_last1,
          SUM(p2s_lost_all_last1) AS p2s_lost_all_last1,
          SUM(s2l_25ms_delay_sec_last1) AS s2l_25ms_delay_sec_last1,
          SUM(s2l_75ms_delay_sec_last1) AS s2l_75ms_delay_sec_last1,
          SUM(s2l_total_delay_sec_last1) AS s2l_total_delay_sec_last1,
          SUM(crash_cnt_last1) AS crash_cnt_last1,
          SUM(service_cnt_last1) AS service_cnt_last1,
          SUM(audio_freeze_time_200_last1) AS audio_freeze_time_200_last1,
          SUM(audio_totaltime_200_last1) AS audio_totaltime_200_last1,
          SUM(""5s_succ_join_session_cnt_last7"") AS ""5s_succ_join_session_cnt_last7"",
          SUM(""3s_succ_join_session_cnt_last7"") AS ""3s_succ_join_session_cnt_last7"",
          SUM(succ_join_session_cnt_last7) AS succ_join_session_cnt_last7,
          SUM(total_join_session_cnt_last7) AS total_join_session_cnt_last7,
          SUM(total_session_cnt_last7) AS total_session_cnt_last7,
          SUM(""1s_succ_join_ap_cnt_last7"") AS ""7s_succ_join_ap_cnt_last7"",
          SUM(""5s_succ_join_ap_cnt_last7"") AS ""5s_succ_join_ap_cnt_last7"",
          SUM(total_join_ap_cnt_last7) AS total_join_ap_cnt_last7,
          SUM(video_freeze_time_last7) AS video_freeze_time_last7,
          SUM(video_totaltime_last7) AS video_totaltime_last7,
          SUM(p2s_lost_Leq5_last7) AS p2s_lost_Leq5_last7,
          SUM(p2s_lost_all_last7) AS p2s_lost_all_last7,
          SUM(s2l_25ms_delay_sec_last7) AS s2l_25ms_delay_sec_last7,
          SUM(s2l_75ms_delay_sec_last7) AS s2l_75ms_delay_sec_last7,
          SUM(s2l_total_delay_sec_last7) AS s2l_total_delay_sec_last7,
          SUM(crash_cnt_last7) AS crash_cnt_last7,
          SUM(service_cnt_last7) AS service_cnt_last7,
          SUM(audio_freeze_time_200_last7) AS audio_freeze_time_200_last7,
          SUM(audio_totaltime_200_last7) AS audio_totaltime_200_last7,
          SUM(video_freeze_time_500) AS video_freeze_time_500,
          SUM(video_totaltime_500) AS video_totaltime_500,
          SUM(video_freeze_time_200) AS video_freeze_time_200,
          SUM(video_totaltime_200) AS video_totaltime_200,
          SUM(video_freeze_time_500_last1) AS video_freeze_time_500_last1,
          SUM(video_totaltime_500_last1) AS video_totaltime_500_last1,
          SUM(video_freeze_time_200_last1) AS video_freeze_time_200_last1,
          SUM(video_totaltime_200_last1) AS video_totaltime_200_last1,
          SUM(video_freeze_time_500_last7) AS video_freeze_time_500_last7,
          SUM(video_totaltime_500_last7) AS video_totaltime_500_last7,
          SUM(video_freeze_time_200_last7) AS video_freeze_time_200_last7,
          SUM(video_totaltime_200_last7) AS video_totaltime_200_last7,
          SUM(s2l_lost_Leq5) AS s2l_lost_Leq5,
          SUM(s2l_lost_all) AS s2l_lost_all,
          SUM(s2l_lost_Leq5_last1) AS s2l_lost_Leq5_last1,
          SUM(s2l_lost_all_last1) AS s2l_lost_all_last1,
          SUM(s2l_lost_Leq5_last7) AS s2l_lost_Leq5_last7,
          SUM(s2l_lost_all_last7) AS s2l_lost_all_last7
        FROM report_datahub.vid_osver_net_cp_domain_quality_di_1
        WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-21') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-11-21') AND CAST(vid AS VARCHAR) = CAST(281104 AS VARCHAR) AND CAST(product_level_2 AS VARCHAR) = 'Native'
        GROUP BY vid,
          project,
          company_id,
          area,
          company_name,
          industry_name,
          date,
          net,
          os,
          ver,
          product_level_1,
          product_level_2,
          ver_type,
            CASE WHEN CAST(stat_period AS VARCHAR) = 'day' THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(substr(CAST(start_date AS VARCHAR), 1, 10) AS VARCHAR), '~', CAST(substr(CAST(end_date AS VARCHAR), 1, 10) AS VARCHAR)) END) AS ts
      LEFT JOIN (SELECT vid,
          date,
          SUM(fiveSecJoinSuccess) AS fiveSecJoinSuccess_total,
          SUM(threeSecJoinSuccess) AS threeSecJoinSuccess_total,
          SUM(totalJoinSuccess) AS totalJoinSuccess_total,
          SUM(totalJoin) AS totalJoin_total,
          SUM(cnt_sid) AS cnt_sid_total,
          SUM(""1s_succ_join_ap_cnt"") AS ""1s_succ_join_ap_cnt_total"",
          SUM(""5s_succ_join_ap_cnt"") AS ""5s_succ_join_ap_cnt_total"",
          SUM(total_join_ap_cnt) AS total_join_ap_cnt_total,
          SUM(audio_freeze_time_200) AS audio_freeze_time_200_total,
          SUM(audio_totaltime_200) AS audio_totaltime_200_total,
          SUM(video_freeze_time) AS video_freeze_time_total,
          SUM(video_totaltime) AS video_totaltime_total,
          SUM(p2s_lost_Leq5) AS p2s_lost_Leq5_total,
          SUM(p2s_lost_all) AS p2s_lost_all_total,
          SUM(s2l_25ms_delay_sec) AS s2l_25ms_delay_sec_total,
          SUM(s2l_75ms_delay_sec) AS s2l_75ms_delay_sec_total,
          SUM(s2l_total_delay_sec) AS s2l_total_delay_sec_total,
          SUM(crash_cnt) AS crash_cnt_total,
          SUM(service_cnt) AS service_cnt_total,
          SUM(""5s_succ_join_session_cnt_last1"") AS ""5s_succ_join_session_cnt_last1_total"",
          SUM(""3s_succ_join_session_cnt_last1"") AS ""3s_succ_join_session_cnt_last1_total"",
          SUM(succ_join_session_cnt_last1) AS succ_join_session_cnt_last1_total,
          SUM(total_join_session_cnt_last1) AS total_join_session_cnt_last1_total,
          SUM(total_session_cnt_last1) AS total_session_cnt_last1_total,
          SUM(""1s_succ_join_ap_cnt_last1"") AS ""1s_succ_join_ap_cnt_last1_total"",
          SUM(""5s_succ_join_ap_cnt_last1"") AS ""5s_succ_join_ap_cnt_last1_total"",
          SUM(total_join_ap_cnt_last1) AS total_join_ap_cnt_last1_total,
          SUM(video_freeze_time_last1) AS video_freeze_time_last1_total,
          SUM(video_totaltime_last1) AS video_totaltime_last1_total,
          SUM(p2s_lost_Leq5_last1) AS p2s_lost_Leq5_last1_total,
          SUM(p2s_lost_all_last1) AS p2s_lost_all_last1_total,
          SUM(s2l_25ms_delay_sec_last1) AS s2l_25ms_delay_sec_last1_total,
          SUM(s2l_75ms_delay_sec_last1) AS s2l_75ms_delay_sec_last1_total,
          SUM(s2l_total_delay_sec_last1) AS s2l_total_delay_sec_last1_total,
          SUM(crash_cnt_last1) AS crash_cnt_last1_total,
          SUM(service_cnt_last1) AS service_cnt_last1_total,
          SUM(audio_freeze_time_200_last1) AS audio_freeze_time_200_last1_total,
          SUM(audio_totaltime_200_last1) AS audio_totaltime_200_last1_total,
          SUM(""5s_succ_join_session_cnt_last7"") AS ""5s_succ_join_session_cnt_last7_total"",
          SUM(""3s_succ_join_session_cnt_last7"") AS ""3s_succ_join_session_cnt_last7_total"",
          SUM(succ_join_session_cnt_last7) AS succ_join_session_cnt_last7_total,
          SUM(total_join_session_cnt_last7) AS total_join_session_cnt_last7_total,
          SUM(total_session_cnt_last7) AS total_session_cnt_last7_total,
          SUM(""1s_succ_join_ap_cnt_last7"") AS ""7s_succ_join_ap_cnt_last7_total"",
          SUM(""5s_succ_join_ap_cnt_last7"") AS ""5s_succ_join_ap_cnt_last7_total"",
          SUM(total_join_ap_cnt_last7) AS total_join_ap_cnt_last7_total,
          SUM(video_freeze_time_last7) AS video_freeze_time_last7_total,
          SUM(video_totaltime_last7) AS video_totaltime_last7_total,
          SUM(p2s_lost_Leq5_last7) AS p2s_lost_Leq5_last7_total,
          SUM(p2s_lost_all_last7) AS p2s_lost_all_last7_total,
          SUM(s2l_25ms_delay_sec_last7) AS s2l_25ms_delay_sec_last7_total,
          SUM(s2l_75ms_delay_sec_last7) AS s2l_75ms_delay_sec_last7_total,
          SUM(s2l_total_delay_sec_last7) AS s2l_total_delay_sec_last7_total,
          SUM(crash_cnt_last7) AS crash_cnt_last7_total,
          SUM(service_cnt_last7) AS service_cnt_last7_total,
          SUM(audio_freeze_time_200_last7) AS audio_freeze_time_200_last7_total,
          SUM(audio_totaltime_200_last7) AS audio_totaltime_200_last7_total,
          SUM(video_freeze_time_500) AS video_freeze_time_500_total,
          SUM(video_totaltime_500) AS video_totaltime_500_total,
          SUM(video_freeze_time_200) AS video_freeze_time_200_total,
          SUM(video_totaltime_200) AS video_totaltime_200_total,
          SUM(video_freeze_time_500_last1) AS video_freeze_time_500_last1_total,
          SUM(video_totaltime_500_last1) AS video_totaltime_500_last1_total,
          SUM(video_freeze_time_200_last1) AS video_freeze_time_200_last1_total,
          SUM(video_totaltime_200_last1) AS video_totaltime_200_last1_total,
          SUM(video_freeze_time_500_last7) AS video_freeze_time_500_last7_total,
          SUM(video_totaltime_500_last7) AS video_totaltime_500_last7_total,
          SUM(video_freeze_time_200_last7) AS video_freeze_time_200_last7_total,
          SUM(video_totaltime_200_last7) AS video_totaltime_200_last7_total,
          SUM(s2l_lost_Leq5) AS s2l_lost_Leq5_total,
          SUM(s2l_lost_all) AS s2l_lost_all_total,
          SUM(s2l_lost_Leq5_last1) AS s2l_lost_Leq5_last1_total,
          SUM(s2l_lost_all_last1) AS s2l_lost_all_last1_total,
          SUM(s2l_lost_Leq5_last7) AS s2l_lost_Leq5_last7_total,
          SUM(s2l_lost_all_last7) AS s2l_lost_all_last7_total
        FROM report_datahub.vid_osver_net_cp_domain_quality_di_1
        WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-21') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-11-21') AND CAST(vid AS VARCHAR) = CAST(281104 AS VARCHAR) AND CAST(product_level_2 AS VARCHAR) = 'Native'
        GROUP BY vid,
          date) AS tt ON CAST(ts.vid AS VARCHAR) = CAST(tt.vid AS VARCHAR) AND ts.date = tt.date) AS ""自定义 SQL 查询""
HAVING COUNT(1) > 0"
"show create table queries"
"SELECT SUM(""自定义 SQL 查询"".""s2l_25ms_delay_sec"") AS ""TEMP(Calculation_1430244791154503680)(2227145667)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_total_delay_sec"") AS ""TEMP(Calculation_1430244791154503680)(2460078802)(0)"",
  SUM(""自定义 SQL 查询"".""5s_succ_join_ap_cnt"") AS ""TEMP(Calculation_1430244791247978510)(1716451703)(0)"",
  SUM(""自定义 SQL 查询"".""total_join_ap_cnt"") AS ""TEMP(Calculation_1430244791247978510)(2681092799)(0)"",
  SUM(""自定义 SQL 查询"".""video_freeze_time_500"") AS ""TEMP(Calculation_1857594119395086336)(389023081)(0)"",
  SUM(""自定义 SQL 查询"".""video_totaltime_500"") AS ""TEMP(Calculation_1857594119395086336)(458654145)(0)"",
  SUM(""自定义 SQL 查询"".""video_totaltime_200"") AS ""TEMP(Calculation_2033093767653158912)(2104207895)(0)"",
  SUM(""自定义 SQL 查询"".""video_freeze_time_200"") AS ""TEMP(Calculation_2033093767653158912)(530162565)(0)"",
  SUM(""自定义 SQL 查询"".""totalJoin"") AS ""TEMP(Calculation_374009936508170240)(2073556184)(0)"",
  SUM(""自定义 SQL 查询"".""totalJoinSuccess"") AS ""TEMP(Calculation_374009936508170240)(2807417001)(0)"",
  SUM(""自定义 SQL 查询"".""threeSecJoinSuccess"") AS ""TEMP(Calculation_374009936508321793)(3693645608)(0)"",
  SUM(""自定义 SQL 查询"".""fiveSecJoinSuccess"") AS ""TEMP(Calculation_374009936508416002)(383616769)(0)"",
  SUM(""自定义 SQL 查询"".""video_totaltime"") AS ""TEMP(Calculation_374009936515215363)(2797449586)(0)"",
  SUM(""自定义 SQL 查询"".""video_freeze_time"") AS ""TEMP(Calculation_374009936515215363)(2940759860)(0)"",
  SUM(""自定义 SQL 查询"".""audio_totaltime"") AS ""TEMP(Calculation_374009936517861380)(1652566750)(0)"",
  SUM(""自定义 SQL 查询"".""audio_freeze_time"") AS ""TEMP(Calculation_374009936517861380)(2919389392)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_lost_Leq5"") AS ""TEMP(Calculation_374009936519704581)(1936123547)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_lost_all"") AS ""TEMP(Calculation_374009936519704581)(749826584)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_75ms_delay_sec"") AS ""TEMP(Calculation_6542393318886285312)(2003933318)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_lost_Leq5"") AS ""TEMP(Calculation_7012034266496475136)(2745840127)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_lost_all"") AS ""TEMP(Calculation_7012034266496475136)(734589263)(0)"",
  SUM(""自定义 SQL 查询"".""crash_cnt"") AS ""TEMP(Calculation_7034341207372070925)(2360900687)(0)"",
  SUM(""自定义 SQL 查询"".""service_cnt"") AS ""TEMP(Calculation_7034341207372070925)(4291252132)(0)"",
  SUM(""自定义 SQL 查询"".""thisusage"") AS ""TEMP(TC_)(949910004)(0)"",
  ""自定义 SQL 查询"".""company_id"" AS ""company_id"",
  ""自定义 SQL 查询"".""company_name"" AS ""company_name"",
  ""自定义 SQL 查询"".""project"" AS ""project"",
  SUM(""自定义 SQL 查询"".""cnt_sid"") AS ""sum_cnt_sid_ok"",
  SUM(""自定义 SQL 查询"".""thisusage"") AS ""sum_thisusage_ok"",
  MAX(""自定义 SQL 查询"".""period"") AS ""usr_Calculation_6733444459377328128_nk"",
  ""自定义 SQL 查询"".""vid"" AS ""vid""
FROM (SELECT t1.date,
        CASE WHEN CAST(stat_period AS VARCHAR) = 'day' THEN substr(CAST(date_parse(cast( t1.date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(substr(CAST(start_date AS VARCHAR), 1, 10) AS VARCHAR), '~', CAST(substr(CAST(end_date AS VARCHAR), 1, 10) AS VARCHAR)) END AS period,
      start_date,
      end_date,
      stat_period,
      tag,
      t1.dim,
      level1,
      level2,
      level3,
      level4,
      os,
      ver,
      ver_type,
      domain,
      country,
      region,
      net,
      vid,
      project,
      company_id,
      company_name,
      rowsnum,
      lastusage,
      thisusage,
      fiveSecJoinSuccess,
      totalJoin,
      cnt_sid,
      video_freeze_time,
      video_totaltime,
      audio_freeze_time,
      audio_totaltime,
      s2l_total_delay_sec,
      s2l_25ms_delay_sec,
      s2l_75ms_delay_sec,
      p2s_lost_Leq5,
      p2s_lost_all,
      crash_cnt,
      service_cnt,
      ""1s_succ_join_ap_cnt"",
      ""5s_succ_join_ap_cnt"",
      total_join_ap_cnt,
      totalJoinSuccess,
      threeSecJoinSuccess,
      video_freeze_time_200,
      video_totaltime_200,
      video_freeze_time_500,
      video_totaltime_500,
      ""3s_succ_join_session_cnt_last1"",
      ""5s_succ_join_session_cnt_last1"",
      succ_join_session_cnt_last1,
      total_join_session_cnt_last1,
      total_session_cnt_last1,
      ""1s_succ_join_ap_cnt_last1"",
      ""5s_succ_join_ap_cnt_last1"",
      total_join_ap_cnt_last1,
      ""3s_succ_join_session_cnt_last7"",
      ""5s_succ_join_session_cnt_last7"",
      succ_join_session_cnt_last7,
      total_join_session_cnt_last7,
      total_session_cnt_last7,
      ""1s_succ_join_ap_cnt_last7"",
      ""5s_succ_join_ap_cnt_last7"",
      total_join_ap_cnt_last7,
      video_freeze_time_last1,
      video_totaltime_last1,
      video_freeze_time_500_last1,
      video_totaltime_500_last1,
      video_freeze_time_200_last1,
      video_totaltime_200_last1,
      video_freeze_time_last7,
      video_totaltime_last7,
      video_freeze_time_500_last7,
      video_totaltime_500_last7,
      video_freeze_time_200_last7,
      video_totaltime_200_last7,
      audio_freeze_time_last1,
      audio_totaltime_last1,
      audio_freeze_time_last7,
      audio_totaltime_last7,
      s2l_total_delay_sec_last1,
      s2l_25ms_delay_sec_last1,
      s2l_75ms_delay_sec_last1,
      s2l_total_delay_sec_last7,
      s2l_25ms_delay_sec_last7,
      s2l_75ms_delay_sec_last7,
      p2s_lost_Leq5_last1,
      p2s_lost_all_last1,
      p2s_lost_Leq5_last7,
      p2s_lost_all_last7,
      crash_cnt_last1,
      service_cnt_last1,
      crash_cnt_last7,
      service_cnt_last7,
      product_level1,
      product_level2,
      product_level3,
      product_level4,
      s2l_lost_Leq5,
      s2l_lost_all,
      s2l_lost_Leq5_last1,
      s2l_lost_all_last1,
      s2l_lost_Leq5_last7,
      s2l_lost_all_last7,
      fiveSecJoinSuccess_total,
      totalJoin_total,
      cnt_sid_total,
      video_freeze_time_total,
      video_totaltime_total,
      audio_freeze_time_total,
      audio_totaltime_total,
      s2l_total_delay_sec_total,
      s2l_25ms_delay_sec_total,
      s2l_75ms_delay_sec_total,
      p2s_lost_Leq5_total,
      p2s_lost_all_total,
      crash_cnt_total,
      service_cnt_total,
      ""1s_succ_join_ap_cnt_total"",
      ""5s_succ_join_ap_cnt_total"",
      total_join_ap_cnt_total,
      totalJoinSuccess_total,
      threeSecJoinSuccess_total,
      video_freeze_time_200_total,
      video_totaltime_200_total,
      video_freeze_time_500_total,
      video_totaltime_500_total,
      ""3s_succ_join_session_cnt_last1_total"",
      ""5s_succ_join_session_cnt_last1_total"",
      succ_join_session_cnt_last1_total,
      total_join_session_cnt_last1_total,
      total_session_cnt_last1_total,
      ""1s_succ_join_ap_cnt_last1_total"",
      ""5s_succ_join_ap_cnt_last1_total"",
      total_join_ap_cnt_last1_total,
      ""3s_succ_join_session_cnt_last7_total"",
      ""5s_succ_join_session_cnt_last7_total"",
      succ_join_session_cnt_last7_total,
      total_join_session_cnt_last7_total,
      total_session_cnt_last7_total,
      ""1s_succ_join_ap_cnt_last7_total"",
      ""5s_succ_join_ap_cnt_last7_total"",
      total_join_ap_cnt_last7_total,
      video_freeze_time_last1_total,
      video_totaltime_last1_total,
      video_freeze_time_500_last1_total,
      video_totaltime_500_last1_total,
      video_freeze_time_200_last1_total,
      video_totaltime_200_last1_total,
      video_freeze_time_last7_total,
      video_totaltime_last7_total,
      video_freeze_time_500_last7_total,
      video_totaltime_500_last7_total,
      video_freeze_time_200_last7_total,
      video_totaltime_200_last7_total,
      audio_freeze_time_last1_total,
      audio_totaltime_last1_total,
      audio_freeze_time_last7_total,
      audio_totaltime_last7_total,
      s2l_total_delay_sec_last1_total,
      s2l_25ms_delay_sec_last1_total,
      s2l_75ms_delay_sec_last1_total,
      s2l_total_delay_sec_last7_total,
      s2l_25ms_delay_sec_last7_total,
      s2l_75ms_delay_sec_last7_total,
      p2s_lost_Leq5_last1_total,
      p2s_lost_all_last1_total,
      p2s_lost_Leq5_last7_total,
      p2s_lost_all_last7_total,
      crash_cnt_last1_total,
      service_cnt_last1_total,
      crash_cnt_last7_total,
      service_cnt_last7_total,
      s2l_lost_Leq5_total,
      s2l_lost_all_total,
      s2l_lost_Leq5_last1_total,
      s2l_lost_all_last1_total,
      s2l_lost_Leq5_last7_total,
      s2l_lost_all_last7_total
    FROM report_datahub.pub_levels_quality_di_1 AS t1
      LEFT JOIN (SELECT date,
          dim,
          SUM(fiveSecJoinSuccess) AS fiveSecJoinSuccess_total,
          SUM(totalJoin) AS totalJoin_total,
          SUM(cnt_sid) AS cnt_sid_total,
          SUM(video_freeze_time) AS video_freeze_time_total,
          SUM(video_totaltime) AS video_totaltime_total,
          SUM(audio_freeze_time) AS audio_freeze_time_total,
          SUM(audio_totaltime) AS audio_totaltime_total,
          SUM(s2l_total_delay_sec) AS s2l_total_delay_sec_total,
          SUM(s2l_25ms_delay_sec) AS s2l_25ms_delay_sec_total,
          SUM(s2l_75ms_delay_sec) AS s2l_75ms_delay_sec_total,
          SUM(p2s_lost_Leq5) AS p2s_lost_Leq5_total,
          SUM(p2s_lost_all) AS p2s_lost_all_total,
          SUM(crash_cnt) AS crash_cnt_total,
          SUM(service_cnt) AS service_cnt_total,
          SUM(""1s_succ_join_ap_cnt"") AS ""1s_succ_join_ap_cnt_total"",
          SUM(""5s_succ_join_ap_cnt"") AS ""5s_succ_join_ap_cnt_total"",
          SUM(total_join_ap_cnt) AS total_join_ap_cnt_total,
          SUM(totalJoinSuccess) AS totalJoinSuccess_total,
          SUM(threeSecJoinSuccess) AS threeSecJoinSuccess_total,
          SUM(video_freeze_time_200) AS video_freeze_time_200_total,
          SUM(video_totaltime_200) AS video_totaltime_200_total,
          SUM(video_freeze_time_500) AS video_freeze_time_500_total,
          SUM(video_totaltime_500) AS video_totaltime_500_total,
          SUM(""3s_succ_join_session_cnt_last1"") AS ""3s_succ_join_session_cnt_last1_total"",
          SUM(""5s_succ_join_session_cnt_last1"") AS ""5s_succ_join_session_cnt_last1_total"",
          SUM(succ_join_session_cnt_last1) AS succ_join_session_cnt_last1_total,
          SUM(total_join_session_cnt_last1) AS total_join_session_cnt_last1_total,
          SUM(total_session_cnt_last1) AS total_session_cnt_last1_total,
          SUM(""1s_succ_join_ap_cnt_last1"") AS ""1s_succ_join_ap_cnt_last1_total"",
          SUM(""5s_succ_join_ap_cnt_last1"") AS ""5s_succ_join_ap_cnt_last1_total"",
          SUM(total_join_ap_cnt_last1) AS total_join_ap_cnt_last1_total,
          SUM(""3s_succ_join_session_cnt_last7"") AS ""3s_succ_join_session_cnt_last7_total"",
          SUM(""5s_succ_join_session_cnt_last7"") AS ""5s_succ_join_session_cnt_last7_total"",
          SUM(succ_join_session_cnt_last7) AS succ_join_session_cnt_last7_total,
          SUM(total_join_session_cnt_last7) AS total_join_session_cnt_last7_total,
          SUM(total_session_cnt_last7) AS total_session_cnt_last7_total,
          SUM(""1s_succ_join_ap_cnt_last7"") AS ""1s_succ_join_ap_cnt_last7_total"",
          SUM(""5s_succ_join_ap_cnt_last7"") AS ""5s_succ_join_ap_cnt_last7_total"",
          SUM(total_join_ap_cnt_last7) AS total_join_ap_cnt_last7_total,
          SUM(video_freeze_time_last1) AS video_freeze_time_last1_total,
          SUM(video_totaltime_last1) AS video_totaltime_last1_total,
          SUM(video_freeze_time_500_last1) AS video_freeze_time_500_last1_total,
          SUM(video_totaltime_500_last1) AS video_totaltime_500_last1_total,
          SUM(video_freeze_time_200_last1) AS video_freeze_time_200_last1_total,
          SUM(video_totaltime_200_last1) AS video_totaltime_200_last1_total,
          SUM(video_freeze_time_last7) AS video_freeze_time_last7_total,
          SUM(video_totaltime_last7) AS video_totaltime_last7_total,
          SUM(video_freeze_time_500_last7) AS video_freeze_time_500_last7_total,
          SUM(video_totaltime_500_last7) AS video_totaltime_500_last7_total,
          SUM(video_freeze_time_200_last7) AS video_freeze_time_200_last7_total,
          SUM(video_totaltime_200_last7) AS video_totaltime_200_last7_total,
          SUM(audio_freeze_time_last1) AS audio_freeze_time_last1_total,
          SUM(audio_totaltime_last1) AS audio_totaltime_last1_total,
          SUM(audio_freeze_time_last7) AS audio_freeze_time_last7_total,
          SUM(audio_totaltime_last7) AS audio_totaltime_last7_total,
          SUM(s2l_total_delay_sec_last1) AS s2l_total_delay_sec_last1_total,
          SUM(s2l_25ms_delay_sec_last1) AS s2l_25ms_delay_sec_last1_total,
          SUM(s2l_75ms_delay_sec_last1) AS s2l_75ms_delay_sec_last1_total,
          SUM(s2l_total_delay_sec_last7) AS s2l_total_delay_sec_last7_total,
          SUM(s2l_25ms_delay_sec_last7) AS s2l_25ms_delay_sec_last7_total,
          SUM(s2l_75ms_delay_sec_last7) AS s2l_75ms_delay_sec_last7_total,
          SUM(p2s_lost_Leq5_last1) AS p2s_lost_Leq5_last1_total,
          SUM(p2s_lost_all_last1) AS p2s_lost_all_last1_total,
          SUM(p2s_lost_Leq5_last7) AS p2s_lost_Leq5_last7_total,
          SUM(p2s_lost_all_last7) AS p2s_lost_all_last7_total,
          SUM(crash_cnt_last1) AS crash_cnt_last1_total,
          SUM(service_cnt_last1) AS service_cnt_last1_total,
          SUM(crash_cnt_last7) AS crash_cnt_last7_total,
          SUM(service_cnt_last7) AS service_cnt_last7_total,
          SUM(s2l_lost_Leq5) AS s2l_lost_Leq5_total,
          SUM(s2l_lost_all) AS s2l_lost_all_total,
          SUM(s2l_lost_Leq5_last1) AS s2l_lost_Leq5_last1_total,
          SUM(s2l_lost_all_last1) AS s2l_lost_all_last1_total,
          SUM(s2l_lost_Leq5_last7) AS s2l_lost_Leq5_last7_total,
          SUM(s2l_lost_all_last7) AS s2l_lost_all_last7_total
        FROM report_datahub.pub_levels_quality_di_1
        WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-21') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-05') AND CAST(tag AS VARCHAR) = 'Product'
        GROUP BY date,
          dim) AS t2 ON t1.date = t2.date AND t1.dim = t2.dim
    WHERE date_parse(cast( t1.date as VARCHAR), '%Y%m%d') >= DATE('2021-11-21') AND date_parse(cast( t1.date as VARCHAR), '%Y%m%d') <= DATE('2021-12-05') AND CAST(tag AS VARCHAR) = 'Product') AS ""自定义 SQL 查询""
  CROSS JOIN (SELECT MAX(date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d')) AS ""__measure__0""
    FROM (SELECT t1.date,
            CASE WHEN CAST(stat_period AS VARCHAR) = 'day' THEN substr(CAST(date_parse(cast( t1.date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(substr(CAST(start_date AS VARCHAR), 1, 10) AS VARCHAR), '~', CAST(substr(CAST(end_date AS VARCHAR), 1, 10) AS VARCHAR)) END AS period,
          start_date,
          end_date,
          stat_period,
          tag,
          t1.dim,
          level1,
          level2,
          level3,
          level4,
          os,
          ver,
          ver_type,
          domain,
          country,
          region,
          net,
          vid,
          project,
          company_id,
          company_name,
          rowsnum,
          lastusage,
          thisusage,
          fiveSecJoinSuccess,
          totalJoin,
          cnt_sid,
          video_freeze_time,
          video_totaltime,
          audio_freeze_time,
          audio_totaltime,
          s2l_total_delay_sec,
          s2l_25ms_delay_sec,
          s2l_75ms_delay_sec,
          p2s_lost_Leq5,
          p2s_lost_all,
          crash_cnt,
          service_cnt,
          ""1s_succ_join_ap_cnt"",
          ""5s_succ_join_ap_cnt"",
          total_join_ap_cnt,
          totalJoinSuccess,
          threeSecJoinSuccess,
          video_freeze_time_200,
          video_totaltime_200,
          video_freeze_time_500,
          video_totaltime_500,
          ""3s_succ_join_session_cnt_last1"",
          ""5s_succ_join_session_cnt_last1"",
          succ_join_session_cnt_last1,
          total_join_session_cnt_last1,
          total_session_cnt_last1,
          ""1s_succ_join_ap_cnt_last1"",
          ""5s_succ_join_ap_cnt_last1"",
          total_join_ap_cnt_last1,
          ""3s_succ_join_session_cnt_last7"",
          ""5s_succ_join_session_cnt_last7"",
          succ_join_session_cnt_last7,
          total_join_session_cnt_last7,
          total_session_cnt_last7,
          ""1s_succ_join_ap_cnt_last7"",
          ""5s_succ_join_ap_cnt_last7"",
          total_join_ap_cnt_last7,
          video_freeze_time_last1,
          video_totaltime_last1,
          video_freeze_time_500_last1,
          video_totaltime_500_last1,
          video_freeze_time_200_last1,
          video_totaltime_200_last1,
          video_freeze_time_last7,
          video_totaltime_last7,
          video_freeze_time_500_last7,
          video_totaltime_500_last7,
          video_freeze_time_200_last7,
          video_totaltime_200_last7,
          audio_freeze_time_last1,
          audio_totaltime_last1,
          audio_freeze_time_last7,
          audio_totaltime_last7,
          s2l_total_delay_sec_last1,
          s2l_25ms_delay_sec_last1,
          s2l_75ms_delay_sec_last1,
          s2l_total_delay_sec_last7,
          s2l_25ms_delay_sec_last7,
          s2l_75ms_delay_sec_last7,
          p2s_lost_Leq5_last1,
          p2s_lost_all_last1,
          p2s_lost_Leq5_last7,
          p2s_lost_all_last7,
          crash_cnt_last1,
          service_cnt_last1,
          crash_cnt_last7,
          service_cnt_last7,
          product_level1,
          product_level2,
          product_level3,
          product_level4,
          s2l_lost_Leq5,
          s2l_lost_all,
          s2l_lost_Leq5_last1,
          s2l_lost_all_last1,
          s2l_lost_Leq5_last7,
          s2l_lost_all_last7,
          fiveSecJoinSuccess_total,
          totalJoin_total,
          cnt_sid_total,
          video_freeze_time_total,
          video_totaltime_total,
          audio_freeze_time_total,
          audio_totaltime_total,
          s2l_total_delay_sec_total,
          s2l_25ms_delay_sec_total,
          s2l_75ms_delay_sec_total,
          p2s_lost_Leq5_total,
          p2s_lost_all_total,
          crash_cnt_total,
          service_cnt_total,
          ""1s_succ_join_ap_cnt_total"",
          ""5s_succ_join_ap_cnt_total"",
          total_join_ap_cnt_total,
          totalJoinSuccess_total,
          threeSecJoinSuccess_total,
          video_freeze_time_200_total,
          video_totaltime_200_total,
          video_freeze_time_500_total,
          video_totaltime_500_total,
          ""3s_succ_join_session_cnt_last1_total"",
          ""5s_succ_join_session_cnt_last1_total"",
          succ_join_session_cnt_last1_total,
          total_join_session_cnt_last1_total,
          total_session_cnt_last1_total,
          ""1s_succ_join_ap_cnt_last1_total"",
          ""5s_succ_join_ap_cnt_last1_total"",
          total_join_ap_cnt_last1_total,
          ""3s_succ_join_session_cnt_last7_total"",
          ""5s_succ_join_session_cnt_last7_total"",
          succ_join_session_cnt_last7_total,
          total_join_session_cnt_last7_total,
          total_session_cnt_last7_total,
          ""1s_succ_join_ap_cnt_last7_total"",
          ""5s_succ_join_ap_cnt_last7_total"",
          total_join_ap_cnt_last7_total,
          video_freeze_time_last1_total,
          video_totaltime_last1_total,
          video_freeze_time_500_last1_total,
          video_totaltime_500_last1_total,
          video_freeze_time_200_last1_total,
          video_totaltime_200_last1_total,
          video_freeze_time_last7_total,
          video_totaltime_last7_total,
          video_freeze_time_500_last7_total,
          video_totaltime_500_last7_total,
          video_freeze_time_200_last7_total,
          video_totaltime_200_last7_total,
          audio_freeze_time_last1_total,
          audio_totaltime_last1_total,
          audio_freeze_time_last7_total,
          audio_totaltime_last7_total,
          s2l_total_delay_sec_last1_total,
          s2l_25ms_delay_sec_last1_total,
          s2l_75ms_delay_sec_last1_total,
          s2l_total_delay_sec_last7_total,
          s2l_25ms_delay_sec_last7_total,
          s2l_75ms_delay_sec_last7_total,
          p2s_lost_Leq5_last1_total,
          p2s_lost_all_last1_total,
          p2s_lost_Leq5_last7_total,
          p2s_lost_all_last7_total,
          crash_cnt_last1_total,
          service_cnt_last1_total,
          crash_cnt_last7_total,
          service_cnt_last7_total,
          s2l_lost_Leq5_total,
          s2l_lost_all_total,
          s2l_lost_Leq5_last1_total,
          s2l_lost_all_last1_total,
          s2l_lost_Leq5_last7_total,
          s2l_lost_all_last7_total
        FROM report_datahub.pub_levels_quality_di_1 AS t1
          LEFT JOIN (SELECT date,
              dim,
              SUM(fiveSecJoinSuccess) AS fiveSecJoinSuccess_total,
              SUM(totalJoin) AS totalJoin_total,
              SUM(cnt_sid) AS cnt_sid_total,
              SUM(video_freeze_time) AS video_freeze_time_total,
              SUM(video_totaltime) AS video_totaltime_total,
              SUM(audio_freeze_time) AS audio_freeze_time_total,
              SUM(audio_totaltime) AS audio_totaltime_total,
              SUM(s2l_total_delay_sec) AS s2l_total_delay_sec_total,
              SUM(s2l_25ms_delay_sec) AS s2l_25ms_delay_sec_total,
              SUM(s2l_75ms_delay_sec) AS s2l_75ms_delay_sec_total,
              SUM(p2s_lost_Leq5) AS p2s_lost_Leq5_total,
              SUM(p2s_lost_all) AS p2s_lost_all_total,
              SUM(crash_cnt) AS crash_cnt_total,
              SUM(service_cnt) AS service_cnt_total,
              SUM(""1s_succ_join_ap_cnt"") AS ""1s_succ_join_ap_cnt_total"",
              SUM(""5s_succ_join_ap_cnt"") AS ""5s_succ_join_ap_cnt_total"",
              SUM(total_join_ap_cnt) AS total_join_ap_cnt_total,
              SUM(totalJoinSuccess) AS totalJoinSuccess_total,
              SUM(threeSecJoinSuccess) AS threeSecJoinSuccess_total,
              SUM(video_freeze_time_200) AS video_freeze_time_200_total,
              SUM(video_totaltime_200) AS video_totaltime_200_total,
              SUM(video_freeze_time_500) AS video_freeze_time_500_total,
              SUM(video_totaltime_500) AS video_totaltime_500_total,
              SUM(""3s_succ_join_session_cnt_last1"") AS ""3s_succ_join_session_cnt_last1_total"",
              SUM(""5s_succ_join_session_cnt_last1"") AS ""5s_succ_join_session_cnt_last1_total"",
              SUM(succ_join_session_cnt_last1) AS succ_join_session_cnt_last1_total,
              SUM(total_join_session_cnt_last1) AS total_join_session_cnt_last1_total,
              SUM(total_session_cnt_last1) AS total_session_cnt_last1_total,
              SUM(""1s_succ_join_ap_cnt_last1"") AS ""1s_succ_join_ap_cnt_last1_total"",
              SUM(""5s_succ_join_ap_cnt_last1"") AS ""5s_succ_join_ap_cnt_last1_total"",
              SUM(total_join_ap_cnt_last1) AS total_join_ap_cnt_last1_total,
              SUM(""3s_succ_join_session_cnt_last7"") AS ""3s_succ_join_session_cnt_last7_total"",
              SUM(""5s_succ_join_session_cnt_last7"") AS ""5s_succ_join_session_cnt_last7_total"",
              SUM(succ_join_session_cnt_last7) AS succ_join_session_cnt_last7_total,
              SUM(total_join_session_cnt_last7) AS total_join_session_cnt_last7_total,
              SUM(total_session_cnt_last7) AS total_session_cnt_last7_total,
              SUM(""1s_succ_join_ap_cnt_last7"") AS ""1s_succ_join_ap_cnt_last7_total"",
              SUM(""5s_succ_join_ap_cnt_last7"") AS ""5s_succ_join_ap_cnt_last7_total"",
              SUM(total_join_ap_cnt_last7) AS total_join_ap_cnt_last7_total,
              SUM(video_freeze_time_last1) AS video_freeze_time_last1_total,
              SUM(video_totaltime_last1) AS video_totaltime_last1_total,
              SUM(video_freeze_time_500_last1) AS video_freeze_time_500_last1_total,
              SUM(video_totaltime_500_last1) AS video_totaltime_500_last1_total,
              SUM(video_freeze_time_200_last1) AS video_freeze_time_200_last1_total,
              SUM(video_totaltime_200_last1) AS video_totaltime_200_last1_total,
              SUM(video_freeze_time_last7) AS video_freeze_time_last7_total,
              SUM(video_totaltime_last7) AS video_totaltime_last7_total,
              SUM(video_freeze_time_500_last7) AS video_freeze_time_500_last7_total,
              SUM(video_totaltime_500_last7) AS video_totaltime_500_last7_total,
              SUM(video_freeze_time_200_last7) AS video_freeze_time_200_last7_total,
              SUM(video_totaltime_200_last7) AS video_totaltime_200_last7_total,
              SUM(audio_freeze_time_last1) AS audio_freeze_time_last1_total,
              SUM(audio_totaltime_last1) AS audio_totaltime_last1_total,
              SUM(audio_freeze_time_last7) AS audio_freeze_time_last7_total,
              SUM(audio_totaltime_last7) AS audio_totaltime_last7_total,
              SUM(s2l_total_delay_sec_last1) AS s2l_total_delay_sec_last1_total,
              SUM(s2l_25ms_delay_sec_last1) AS s2l_25ms_delay_sec_last1_total,
              SUM(s2l_75ms_delay_sec_last1) AS s2l_75ms_delay_sec_last1_total,
              SUM(s2l_total_delay_sec_last7) AS s2l_total_delay_sec_last7_total,
              SUM(s2l_25ms_delay_sec_last7) AS s2l_25ms_delay_sec_last7_total,
              SUM(s2l_75ms_delay_sec_last7) AS s2l_75ms_delay_sec_last7_total,
              SUM(p2s_lost_Leq5_last1) AS p2s_lost_Leq5_last1_total,
              SUM(p2s_lost_all_last1) AS p2s_lost_all_last1_total,
              SUM(p2s_lost_Leq5_last7) AS p2s_lost_Leq5_last7_total,
              SUM(p2s_lost_all_last7) AS p2s_lost_all_last7_total,
              SUM(crash_cnt_last1) AS crash_cnt_last1_total,
              SUM(service_cnt_last1) AS service_cnt_last1_total,
              SUM(crash_cnt_last7) AS crash_cnt_last7_total,
              SUM(service_cnt_last7) AS service_cnt_last7_total,
              SUM(s2l_lost_Leq5) AS s2l_lost_Leq5_total,
              SUM(s2l_lost_all) AS s2l_lost_all_total,
              SUM(s2l_lost_Leq5_last1) AS s2l_lost_Leq5_last1_total,
              SUM(s2l_lost_all_last1) AS s2l_lost_all_last1_total,
              SUM(s2l_lost_Leq5_last7) AS s2l_lost_Leq5_last7_total,
              SUM(s2l_lost_all_last7) AS s2l_lost_all_last7_total
            FROM report_datahub.pub_levels_quality_di_1
            WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-21') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-05') AND CAST(tag AS VARCHAR) = 'Product'
            GROUP BY date,
              dim) AS t2 ON t1.date = t2.date AND t1.dim = t2.dim
        WHERE date_parse(cast( t1.date as VARCHAR), '%Y%m%d') >= DATE('2021-11-21') AND date_parse(cast( t1.date as VARCHAR), '%Y%m%d') <= DATE('2021-12-05') AND CAST(tag AS VARCHAR) = 'Product') AS ""自定义 SQL 查询""
    HAVING COUNT(1) > 0) AS ""t0""
WHERE NOT ( (  ""自定义 SQL 查询"".""vid""  ) is null) AND CAST(""自定义 SQL 查询"".""dim"" AS VARCHAR) = '103' AND CAST(""自定义 SQL 查询"".""level1"" AS VARCHAR) = 'RTC' AND CAST(""自定义 SQL 查询"".""level2"" AS VARCHAR) = 'Native' AND CAST(""自定义 SQL 查询"".""level3"" AS VARCHAR) = 'ALL' AND CAST(""自定义 SQL 查询"".""tag"" AS VARCHAR) = 'Product' AND DATE_ADD('SECOND', 0, date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d')) = DATE_ADD('SECOND', 0, ""t0"".""__measure__0"")
GROUP BY 25,
  26,
  27,
  31"
"SELECT SUM(""自定义 SQL 查询"".""host_4k_last"") AS ""TEMP(Calculation_3519281700083154949)(101123376)(0)"",
  SUM(""自定义 SQL 查询"".""host_4k"") AS ""TEMP(Calculation_3519281700083154949)(1075454865)(0)"",
  SUM(""自定义 SQL 查询"".""audience_sd"") AS ""TEMP(Calculation_3519281700083154949)(1133678835)(0)"",
  SUM(""自定义 SQL 查询"".""audience_video_hdp_last"") AS ""TEMP(Calculation_3519281700083154949)(1200517625)(0)"",
  SUM(""自定义 SQL 查询"".""host_1080p"") AS ""TEMP(Calculation_3519281700083154949)(1312501967)(0)"",
  SUM(""自定义 SQL 查询"".""audience_1080p_last"") AS ""TEMP(Calculation_3519281700083154949)(1314346200)(0)"",
  SUM(""自定义 SQL 查询"".""audience_video_hd_last"") AS ""TEMP(Calculation_3519281700083154949)(146570423)(0)"",
  SUM(""自定义 SQL 查询"".""audience_2k_last"") AS ""TEMP(Calculation_3519281700083154949)(1717771635)(0)"",
  SUM(""自定义 SQL 查询"".""audience_audio_last"") AS ""TEMP(Calculation_3519281700083154949)(2313111073)(0)"",
  SUM(""自定义 SQL 查询"".""host_video_hdp_last"") AS ""TEMP(Calculation_3519281700083154949)(258310559)(0)"",
  SUM(""自定义 SQL 查询"".""host_hd"") AS ""TEMP(Calculation_3519281700083154949)(276907208)(0)"",
  SUM(""自定义 SQL 查询"".""audio_video_last"") AS ""TEMP(Calculation_3519281700083154949)(2820618408)(0)"",
  SUM(""自定义 SQL 查询"".""video"") AS ""TEMP(Calculation_3519281700083154949)(2929708110)(0)"",
  SUM(""自定义 SQL 查询"".""audience_hd"") AS ""TEMP(Calculation_3519281700083154949)(2930728935)(0)"",
  SUM(""自定义 SQL 查询"".""audience_hdp"") AS ""TEMP(Calculation_3519281700083154949)(3010533957)(0)"",
  SUM(""自定义 SQL 查询"".""host_hdp"") AS ""TEMP(Calculation_3519281700083154949)(30306054)(0)"",
  SUM(""自定义 SQL 查询"".""host_audio"") AS ""TEMP(Calculation_3519281700083154949)(3087054365)(0)"",
  SUM(""自定义 SQL 查询"".""audience_4k_last"") AS ""TEMP(Calculation_3519281700083154949)(3121859593)(0)"",
  SUM(""自定义 SQL 查询"".""host_1080p_last"") AS ""TEMP(Calculation_3519281700083154949)(3222422303)(0)"",
  SUM(""自定义 SQL 查询"".""host_audio_last"") AS ""TEMP(Calculation_3519281700083154949)(3227677803)(0)"",
  SUM(""自定义 SQL 查询"".""audio"") AS ""TEMP(Calculation_3519281700083154949)(3299350010)(0)"",
  SUM(""自定义 SQL 查询"".""audience_1080p"") AS ""TEMP(Calculation_3519281700083154949)(3628946582)(0)"",
  SUM(""自定义 SQL 查询"".""totalUsage"") AS ""TEMP(Calculation_3519281700083154949)(3847882359)(0)"",
  SUM(""自定义 SQL 查询"".""video_last"") AS ""TEMP(Calculation_3519281700083154949)(3934387163)(0)"",
  SUM(""自定义 SQL 查询"".""host_2k_last"") AS ""TEMP(Calculation_3519281700083154949)(4055292783)(0)"",
  SUM(""自定义 SQL 查询"".""audio_last"") AS ""TEMP(Calculation_3519281700083154949)(4091190060)(0)"",
  SUM(""自定义 SQL 查询"".""audience_audio"") AS ""TEMP(Calculation_3519281700083154949)(4109514392)(0)"",
  SUM(""自定义 SQL 查询"".""host_video_hd_last"") AS ""TEMP(Calculation_3519281700083154949)(4170367250)(0)"",
  SUM(""自定义 SQL 查询"".""host_video_sd_last"") AS ""TEMP(Calculation_3519281700083154949)(4190307025)(0)"",
  SUM(""自定义 SQL 查询"".""host_2k"") AS ""TEMP(Calculation_3519281700083154949)(586790827)(0)"",
  SUM(""自定义 SQL 查询"".""host_sd"") AS ""TEMP(Calculation_3519281700083154949)(709512178)(0)"",
  SUM(""自定义 SQL 查询"".""audience_4k"") AS ""TEMP(Calculation_3519281700083154949)(764410224)(0)"",
  SUM(""自定义 SQL 查询"".""audience_video_sd_last"") AS ""TEMP(Calculation_3519281700083154949)(933007102)(0)"",
  SUM(""自定义 SQL 查询"".""audience_2k"") AS ""TEMP(Calculation_3519281700083154949)(943764407)(0)"",
  ""自定义 SQL 查询"".""level1"" AS ""level1"",
  SUM(""自定义 SQL 查询"".""audio_video_last"") AS ""sum_audio_video_last_ok""
FROM (SELECT date,
        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,
      start_date AS start_date_7,
      end_date AS end_date,
      tag,
      area AS Scope,
      dim,
        CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,
      level2,
      level3,
      level4,
      product_level1 AS product_line,
      product_level2,
      product_level3,
      product_level4,
      vid_internal_industry_en AS cid_industry,
      vid_use_case_en AS vid_use_case_cn,
      vid_sector_en,
      ver_type,
      ver,
      os,
      domain,
      country,
      region,
      dim_grouping_name,
        CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,
      total AS totalUsage,
      audio,
      video,
      host_audio,
      audience_audio,
      host_sd,
      host_hd,
      host_hdp,
      host_1080p,
      host_2k,
      host_4k,
      audience_sd,
      audience_hd,
      audience_hdp,
      audience_1080p,
      audience_2k,
      audience_4k,
      audience_audio_low_latency,
      audience_sd_low_latency,
      audience_hd_low_latency,
      audience_hdp_low_latency,
      audience_1080p_low_latency,
      audience_2k_low_latency,
      audience_4k_low_latency,
      audience_audio_ultra_low_latency,
      audience_sd_ultra_low_latency,
      audience_hd_ultra_low_latency,
      audience_hdp_ultra_low_latency,
      audience_1080p_ultra_low_latency,
      audience_2k_ultra_low_latency,
      audience_4k_ultra_low_latency,
      total_last1 AS audio_video_last,
      audio_last1 AS audio_last,
      video_last1 AS video_last,
      video_sd_last1 AS video_sd_last,
      video_hd_last1 AS video_hd_last,
      video_hdp_last1 AS video_hdp_last,
      host_sd_last1 AS host_video_sd_last,
      audience_sd_last1 AS audience_video_sd_last,
      host_hd_last1 AS host_video_hd_last,
      audience_hd_last1 AS audience_video_hd_last,
      host_hdp_last1 AS host_video_hdp_last,
      audience_hdp_last1 AS audience_video_hdp_last,
      host_audio_last1 AS host_audio_last,
      audience_audio_last1 AS audience_audio_last,
      host_video_last1 AS host_video_last,
      audience_video_last1 AS audience_video_last,
      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,
      audience_video_low_latency_last1 AS audience_video_low_latency_last,
      audience_total_low_latency_last1 AS audience_total_low_latency_last,
      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,
      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,
      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,
      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,
      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,
      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,
      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,
      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,
      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,
      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,
      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,
      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,
      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,
      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,
      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,
      audience_2k_last1 AS audience_2k_last,
      audience_4k_last1 AS audience_4k_last,
      audience_1080p_last1 AS audience_1080p_last,
      host_1080p_last1 AS host_1080p_last,
      host_2k_last1 AS host_2k_last,
      host_4k_last1 AS host_4k_last,
      total_last7,
      audio_last7,
      video_last7,
      video_sd_last7,
      video_hd_last7,
      video_hdp_last7,
      host_sd_last7,
      audience_sd_last7,
      host_hd_last7,
      audience_hd_last7,
      host_hdp_last7,
      audience_hdp_last7,
      host_audio_last7,
      audience_audio_last7,
      host_video_last7,
      audience_video_last7,
      audience_audio_low_latency_last7,
      audience_video_low_latency_last7,
      audience_total_low_latency_last7,
      audience_sd_low_latency_last7,
      audience_hd_low_latency_last7,
      audience_hdp_low_latency_last7,
      audience_1080p_low_latency_last7,
      audience_2k_low_latency_last7,
      audience_4k_low_latency_last7,
      audience_audio_ultra_low_latency_last7,
      audience_video_ultra_low_latency_last7,
      audience_total_ultra_low_latency_last7,
      audience_sd_ultra_low_latency_last7,
      audience_hd_ultra_low_latency_last7,
      audience_hdp_ultra_low_latency_last7,
      audience_1080p_ultra_low_latency_last7,
      audience_2k_ultra_low_latency_last7,
      audience_4k_ultra_low_latency_last7,
      audience_2k_last7,
      audience_4k_last7,
      audience_1080p_last7,
      host_1080p_last7,
      host_2k_last7,
      host_4k_last7
    FROM levels_usage_dod_di_1
    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-06') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-04') AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS ""自定义 SQL 查询""
  CROSS JOIN (SELECT MAX(date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d')) AS ""__measure__0""
    FROM (SELECT date,
            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,
          start_date AS start_date_7,
          end_date AS end_date,
          tag,
          area AS Scope,
          dim,
            CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,
          level2,
          level3,
          level4,
          product_level1 AS product_line,
          product_level2,
          product_level3,
          product_level4,
          vid_internal_industry_en AS cid_industry,
          vid_use_case_en AS vid_use_case_cn,
          vid_sector_en,
          ver_type,
          ver,
          os,
          domain,
          country,
          region,
          dim_grouping_name,
            CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,
          total AS totalUsage,
          audio,
          video,
          host_audio,
          audience_audio,
          host_sd,
          host_hd,
          host_hdp,
          host_1080p,
          host_2k,
          host_4k,
          audience_sd,
          audience_hd,
          audience_hdp,
          audience_1080p,
          audience_2k,
          audience_4k,
          audience_audio_low_latency,
          audience_sd_low_latency,
          audience_hd_low_latency,
          audience_hdp_low_latency,
          audience_1080p_low_latency,
          audience_2k_low_latency,
          audience_4k_low_latency,
          audience_audio_ultra_low_latency,
          audience_sd_ultra_low_latency,
          audience_hd_ultra_low_latency,
          audience_hdp_ultra_low_latency,
          audience_1080p_ultra_low_latency,
          audience_2k_ultra_low_latency,
          audience_4k_ultra_low_latency,
          total_last1 AS audio_video_last,
          audio_last1 AS audio_last,
          video_last1 AS video_last,
          video_sd_last1 AS video_sd_last,
          video_hd_last1 AS video_hd_last,
          video_hdp_last1 AS video_hdp_last,
          host_sd_last1 AS host_video_sd_last,
          audience_sd_last1 AS audience_video_sd_last,
          host_hd_last1 AS host_video_hd_last,
          audience_hd_last1 AS audience_video_hd_last,
          host_hdp_last1 AS host_video_hdp_last,
          audience_hdp_last1 AS audience_video_hdp_last,
          host_audio_last1 AS host_audio_last,
          audience_audio_last1 AS audience_audio_last,
          host_video_last1 AS host_video_last,
          audience_video_last1 AS audience_video_last,
          audience_audio_low_latency_last1 AS audience_audio_low_latency_last,
          audience_video_low_latency_last1 AS audience_video_low_latency_last,
          audience_total_low_latency_last1 AS audience_total_low_latency_last,
          audience_sd_low_latency_last1 AS audience_sd_low_latency_last,
          audience_hd_low_latency_last1 AS audience_hd_low_latency_last,
          audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,
          audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,
          audience_2k_low_latency_last1 AS audience_2k_low_latency_last,
          audience_4k_low_latency_last1 AS audience_4k_low_latency_last,
          audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,
          audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,
          audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,
          audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,
          audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,
          audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,
          audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,
          audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,
          audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,
          audience_2k_last1 AS audience_2k_last,
          audience_4k_last1 AS audience_4k_last,
          audience_1080p_last1 AS audience_1080p_last,
          host_1080p_last1 AS host_1080p_last,
          host_2k_last1 AS host_2k_last,
          host_4k_last1 AS host_4k_last,
          total_last7,
          audio_last7,
          video_last7,
          video_sd_last7,
          video_hd_last7,
          video_hdp_last7,
          host_sd_last7,
          audience_sd_last7,
          host_hd_last7,
          audience_hd_last7,
          host_hdp_last7,
          audience_hdp_last7,
          host_audio_last7,
          audience_audio_last7,
          host_video_last7,
          audience_video_last7,
          audience_audio_low_latency_last7,
          audience_video_low_latency_last7,
          audience_total_low_latency_last7,
          audience_sd_low_latency_last7,
          audience_hd_low_latency_last7,
          audience_hdp_low_latency_last7,
          audience_1080p_low_latency_last7,
          audience_2k_low_latency_last7,
          audience_4k_low_latency_last7,
          audience_audio_ultra_low_latency_last7,
          audience_video_ultra_low_latency_last7,
          audience_total_ultra_low_latency_last7,
          audience_sd_ultra_low_latency_last7,
          audience_hd_ultra_low_latency_last7,
          audience_hdp_ultra_low_latency_last7,
          audience_1080p_ultra_low_latency_last7,
          audience_2k_ultra_low_latency_last7,
          audience_4k_ultra_low_latency_last7,
          audience_2k_last7,
          audience_4k_last7,
          audience_1080p_last7,
          host_1080p_last7,
          host_2k_last7,
          host_4k_last7
        FROM levels_usage_dod_di_1
        WHERE CAST(tag AS VARCHAR) = 'Industry' AND date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-06') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-04') AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS ""自定义 SQL 查询""
    HAVING COUNT(1) > 0) AS ""t0""
WHERE ""自定义 SQL 查询"".""dim"" = 1 AND ""自定义 SQL 查询"".""rank_level1"" = 1 AND date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d') = ""t0"".""__measure__0""
GROUP BY 35"
"SELECT ""自定义 SQL 查询"".""level1"" AS ""level1""
FROM (SELECT date,
        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,
      start_date AS start_date_7,
      end_date AS end_date,
      tag,
      area AS Scope,
      dim,
        CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,
      level2,
      level3,
      level4,
      product_level1 AS product_line,
      product_level2,
      product_level3,
      product_level4,
      vid_internal_industry_en AS cid_industry,
      vid_use_case_en AS vid_use_case_cn,
      vid_sector_en,
      ver_type,
      ver,
      os,
      domain,
      country,
      region,
      dim_grouping_name,
        CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,
      total AS totalUsage,
      audio,
      video,
      host_audio,
      audience_audio,
      host_sd,
      host_hd,
      host_hdp,
      host_1080p,
      host_2k,
      host_4k,
      audience_sd,
      audience_hd,
      audience_hdp,
      audience_1080p,
      audience_2k,
      audience_4k,
      audience_audio_low_latency,
      audience_sd_low_latency,
      audience_hd_low_latency,
      audience_hdp_low_latency,
      audience_1080p_low_latency,
      audience_2k_low_latency,
      audience_4k_low_latency,
      audience_audio_ultra_low_latency,
      audience_sd_ultra_low_latency,
      audience_hd_ultra_low_latency,
      audience_hdp_ultra_low_latency,
      audience_1080p_ultra_low_latency,
      audience_2k_ultra_low_latency,
      audience_4k_ultra_low_latency,
      total_last1 AS audio_video_last,
      audio_last1 AS audio_last,
      video_last1 AS video_last,
      video_sd_last1 AS video_sd_last,
      video_hd_last1 AS video_hd_last,
      video_hdp_last1 AS video_hdp_last,
      host_sd_last1 AS host_video_sd_last,
      audience_sd_last1 AS audience_video_sd_last,
      host_hd_last1 AS host_video_hd_last,
      audience_hd_last1 AS audience_video_hd_last,
      host_hdp_last1 AS host_video_hdp_last,
      audience_hdp_last1 AS audience_video_hdp_last,
      host_audio_last1 AS host_audio_last,
      audience_audio_last1 AS audience_audio_last,
      host_video_last1 AS host_video_last,
      audience_video_last1 AS audience_video_last,
      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,
      audience_video_low_latency_last1 AS audience_video_low_latency_last,
      audience_total_low_latency_last1 AS audience_total_low_latency_last,
      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,
      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,
      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,
      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,
      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,
      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,
      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,
      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,
      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,
      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,
      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,
      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,
      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,
      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,
      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,
      audience_2k_last1 AS audience_2k_last,
      audience_4k_last1 AS audience_4k_last,
      audience_1080p_last1 AS audience_1080p_last,
      host_1080p_last1 AS host_1080p_last,
      host_2k_last1 AS host_2k_last,
      host_4k_last1 AS host_4k_last,
      total_last7,
      audio_last7,
      video_last7,
      video_sd_last7,
      video_hd_last7,
      video_hdp_last7,
      host_sd_last7,
      audience_sd_last7,
      host_hd_last7,
      audience_hd_last7,
      host_hdp_last7,
      audience_hdp_last7,
      host_audio_last7,
      audience_audio_last7,
      host_video_last7,
      audience_video_last7,
      audience_audio_low_latency_last7,
      audience_video_low_latency_last7,
      audience_total_low_latency_last7,
      audience_sd_low_latency_last7,
      audience_hd_low_latency_last7,
      audience_hdp_low_latency_last7,
      audience_1080p_low_latency_last7,
      audience_2k_low_latency_last7,
      audience_4k_low_latency_last7,
      audience_audio_ultra_low_latency_last7,
      audience_video_ultra_low_latency_last7,
      audience_total_ultra_low_latency_last7,
      audience_sd_ultra_low_latency_last7,
      audience_hd_ultra_low_latency_last7,
      audience_hdp_ultra_low_latency_last7,
      audience_1080p_ultra_low_latency_last7,
      audience_2k_ultra_low_latency_last7,
      audience_4k_ultra_low_latency_last7,
      audience_2k_last7,
      audience_4k_last7,
      audience_1080p_last7,
      host_1080p_last7,
      host_2k_last7,
      host_4k_last7
    FROM levels_usage_dod_di_1
    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-06') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-04') AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS ""自定义 SQL 查询""
GROUP BY 1
ORDER BY ""level1"""
"SELECT MAX(""自定义 SQL 查询"".""period"") AS ""usr_Calculation_6733444459377328128_nk""
FROM (SELECT ts.*,
      fiveSecJoinSuccess_total,
      threeSecJoinSuccess_total,
      totalJoinSuccess_total,
      totalJoin_total,
      cnt_sid_total,
      ""1s_succ_join_ap_cnt_total"",
      ""5s_succ_join_ap_cnt_total"",
      total_join_ap_cnt_total,
      audio_freeze_time_200_total,
      audio_totaltime_200_total,
      video_freeze_time_total,
      video_totaltime_total,
      p2s_lost_Leq5_total,
      p2s_lost_all_total,
      s2l_25ms_delay_sec_total,
      s2l_75ms_delay_sec_total,
      s2l_total_delay_sec_total,
      crash_cnt_total,
      service_cnt_total,
      ""5s_succ_join_session_cnt_last1_total"",
      ""3s_succ_join_session_cnt_last1_total"",
      succ_join_session_cnt_last1_total,
      total_join_session_cnt_last1_total,
      total_session_cnt_last1_total,
      ""1s_succ_join_ap_cnt_last1_total"",
      ""5s_succ_join_ap_cnt_last1_total"",
      total_join_ap_cnt_last1_total,
      video_freeze_time_last1_total,
      video_totaltime_last1_total,
      p2s_lost_Leq5_last1_total,
      p2s_lost_all_last1_total,
      s2l_25ms_delay_sec_last1_total,
      s2l_75ms_delay_sec_last1_total,
      s2l_total_delay_sec_last1_total,
      crash_cnt_last1_total,
      service_cnt_last1_total,
      audio_freeze_time_200_last1_total,
      audio_totaltime_200_last1_total,
      ""5s_succ_join_session_cnt_last7_total"",
      ""3s_succ_join_session_cnt_last7_total"",
      succ_join_session_cnt_last7_total,
      total_join_session_cnt_last7_total,
      total_session_cnt_last7_total,
      ""7s_succ_join_ap_cnt_last7_total"",
      ""5s_succ_join_ap_cnt_last7_total"",
      total_join_ap_cnt_last7_total,
      video_freeze_time_last7_total,
      video_totaltime_last7_total,
      p2s_lost_Leq5_last7_total,
      p2s_lost_all_last7_total,
      s2l_25ms_delay_sec_last7_total,
      s2l_75ms_delay_sec_last7_total,
      s2l_total_delay_sec_last7_total,
      crash_cnt_last7_total,
      service_cnt_last7_total,
      audio_freeze_time_200_last7_total,
      audio_totaltime_200_last7_total,
      video_freeze_time_500_total,
      video_totaltime_500_total,
      video_freeze_time_200_total,
      video_totaltime_200_total,
      video_freeze_time_500_last1_total,
      video_totaltime_500_last1_total,
      video_freeze_time_200_last1_total,
      video_totaltime_200_last1_total,
      video_freeze_time_500_last7_total,
      video_totaltime_500_last7_total,
      video_freeze_time_200_last7_total,
      video_totaltime_200_last7_total,
      s2l_lost_Leq5_total,
      s2l_lost_all_total,
      s2l_lost_Leq5_last1_total,
      s2l_lost_all_last1_total,
      s2l_lost_Leq5_last7_total,
      s2l_lost_all_last7_total
    FROM (SELECT vid,
          project,
          company_id,
          area,
          company_name,
          industry_name,
          date,
            CASE WHEN CAST(stat_period AS VARCHAR) = 'day' THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(substr(CAST(start_date AS VARCHAR), 1, 10) AS VARCHAR), '~', CAST(substr(CAST(end_date AS VARCHAR), 1, 10) AS VARCHAR)) END AS period,
          net,
          os,
          ver,
          'osver' AS dim,
          product_level_1,
          product_level_2,
          ver_type,
          SUM(fiveSecJoinSuccess) AS fiveSecJoinSuccess,
          SUM(threeSecJoinSuccess) AS threeSecJoinSuccess,
          SUM(totalJoinSuccess) AS totalJoinSuccess,
          SUM(totalJoin) AS totalJoin,
          SUM(cnt_sid) AS cnt_sid,
          SUM(""1s_succ_join_ap_cnt"") AS ""1s_succ_join_ap_cnt"",
          SUM(""5s_succ_join_ap_cnt"") AS ""5s_succ_join_ap_cnt"",
          SUM(total_join_ap_cnt) AS total_join_ap_cnt,
          SUM(audio_freeze_time_200) AS audio_freeze_time_200,
          SUM(audio_totaltime_200) AS audio_totaltime_200,
          SUM(video_freeze_time) AS video_freeze_time,
          SUM(video_totaltime) AS video_totaltime,
          SUM(p2s_lost_Leq5) AS p2s_lost_Leq5,
          SUM(p2s_lost_all) AS p2s_lost_all,
          SUM(s2l_25ms_delay_sec) AS s2l_25ms_delay_sec,
          SUM(s2l_75ms_delay_sec) AS s2l_75ms_delay_sec,
          SUM(s2l_total_delay_sec) AS s2l_total_delay_sec,
          SUM(crash_cnt) AS crash_cnt,
          SUM(service_cnt) AS service_cnt,
          SUM(""5s_succ_join_session_cnt_last1"") AS ""5s_succ_join_session_cnt_last1"",
          SUM(""3s_succ_join_session_cnt_last1"") AS ""3s_succ_join_session_cnt_last1"",
          SUM(succ_join_session_cnt_last1) AS succ_join_session_cnt_last1,
          SUM(total_join_session_cnt_last1) AS total_join_session_cnt_last1,
          SUM(total_session_cnt_last1) AS total_session_cnt_last1,
          SUM(""1s_succ_join_ap_cnt_last1"") AS ""1s_succ_join_ap_cnt_last1"",
          SUM(""5s_succ_join_ap_cnt_last1"") AS ""5s_succ_join_ap_cnt_last1"",
          SUM(total_join_ap_cnt_last1) AS total_join_ap_cnt_last1,
          SUM(video_freeze_time_last1) AS video_freeze_time_last1,
          SUM(video_totaltime_last1) AS video_totaltime_last1,
          SUM(p2s_lost_Leq5_last1) AS p2s_lost_Leq5_last1,
          SUM(p2s_lost_all_last1) AS p2s_lost_all_last1,
          SUM(s2l_25ms_delay_sec_last1) AS s2l_25ms_delay_sec_last1,
          SUM(s2l_75ms_delay_sec_last1) AS s2l_75ms_delay_sec_last1,
          SUM(s2l_total_delay_sec_last1) AS s2l_total_delay_sec_last1,
          SUM(crash_cnt_last1) AS crash_cnt_last1,
          SUM(service_cnt_last1) AS service_cnt_last1,
          SUM(audio_freeze_time_200_last1) AS audio_freeze_time_200_last1,
          SUM(audio_totaltime_200_last1) AS audio_totaltime_200_last1,
          SUM(""5s_succ_join_session_cnt_last7"") AS ""5s_succ_join_session_cnt_last7"",
          SUM(""3s_succ_join_session_cnt_last7"") AS ""3s_succ_join_session_cnt_last7"",
          SUM(succ_join_session_cnt_last7) AS succ_join_session_cnt_last7,
          SUM(total_join_session_cnt_last7) AS total_join_session_cnt_last7,
          SUM(total_session_cnt_last7) AS total_session_cnt_last7,
          SUM(""1s_succ_join_ap_cnt_last7"") AS ""7s_succ_join_ap_cnt_last7"",
          SUM(""5s_succ_join_ap_cnt_last7"") AS ""5s_succ_join_ap_cnt_last7"",
          SUM(total_join_ap_cnt_last7) AS total_join_ap_cnt_last7,
          SUM(video_freeze_time_last7) AS video_freeze_time_last7,
          SUM(video_totaltime_last7) AS video_totaltime_last7,
          SUM(p2s_lost_Leq5_last7) AS p2s_lost_Leq5_last7,
          SUM(p2s_lost_all_last7) AS p2s_lost_all_last7,
          SUM(s2l_25ms_delay_sec_last7) AS s2l_25ms_delay_sec_last7,
          SUM(s2l_75ms_delay_sec_last7) AS s2l_75ms_delay_sec_last7,
          SUM(s2l_total_delay_sec_last7) AS s2l_total_delay_sec_last7,
          SUM(crash_cnt_last7) AS crash_cnt_last7,
          SUM(service_cnt_last7) AS service_cnt_last7,
          SUM(audio_freeze_time_200_last7) AS audio_freeze_time_200_last7,
          SUM(audio_totaltime_200_last7) AS audio_totaltime_200_last7,
          SUM(video_freeze_time_500) AS video_freeze_time_500,
          SUM(video_totaltime_500) AS video_totaltime_500,
          SUM(video_freeze_time_200) AS video_freeze_time_200,
          SUM(video_totaltime_200) AS video_totaltime_200,
          SUM(video_freeze_time_500_last1) AS video_freeze_time_500_last1,
          SUM(video_totaltime_500_last1) AS video_totaltime_500_last1,
          SUM(video_freeze_time_200_last1) AS video_freeze_time_200_last1,
          SUM(video_totaltime_200_last1) AS video_totaltime_200_last1,
          SUM(video_freeze_time_500_last7) AS video_freeze_time_500_last7,
          SUM(video_totaltime_500_last7) AS video_totaltime_500_last7,
          SUM(video_freeze_time_200_last7) AS video_freeze_time_200_last7,
          SUM(video_totaltime_200_last7) AS video_totaltime_200_last7,
          SUM(s2l_lost_Leq5) AS s2l_lost_Leq5,
          SUM(s2l_lost_all) AS s2l_lost_all,
          SUM(s2l_lost_Leq5_last1) AS s2l_lost_Leq5_last1,
          SUM(s2l_lost_all_last1) AS s2l_lost_all_last1,
          SUM(s2l_lost_Leq5_last7) AS s2l_lost_Leq5_last7,
          SUM(s2l_lost_all_last7) AS s2l_lost_all_last7
        FROM report_datahub.vid_osver_net_cp_domain_quality_di_1
        WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-21') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-11-21') AND CAST(vid AS VARCHAR) = CAST(281104 AS VARCHAR) AND CAST(product_level_2 AS VARCHAR) = 'Native'
        GROUP BY vid,
          project,
          company_id,
          area,
          company_name,
          industry_name,
          date,
          net,
          os,
          ver,
          product_level_1,
          product_level_2,
          ver_type,
            CASE WHEN CAST(stat_period AS VARCHAR) = 'day' THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(substr(CAST(start_date AS VARCHAR), 1, 10) AS VARCHAR), '~', CAST(substr(CAST(end_date AS VARCHAR), 1, 10) AS VARCHAR)) END) AS ts
      LEFT JOIN (SELECT vid,
          date,
          SUM(fiveSecJoinSuccess) AS fiveSecJoinSuccess_total,
          SUM(threeSecJoinSuccess) AS threeSecJoinSuccess_total,
          SUM(totalJoinSuccess) AS totalJoinSuccess_total,
          SUM(totalJoin) AS totalJoin_total,
          SUM(cnt_sid) AS cnt_sid_total,
          SUM(""1s_succ_join_ap_cnt"") AS ""1s_succ_join_ap_cnt_total"",
          SUM(""5s_succ_join_ap_cnt"") AS ""5s_succ_join_ap_cnt_total"",
          SUM(total_join_ap_cnt) AS total_join_ap_cnt_total,
          SUM(audio_freeze_time_200) AS audio_freeze_time_200_total,
          SUM(audio_totaltime_200) AS audio_totaltime_200_total,
          SUM(video_freeze_time) AS video_freeze_time_total,
          SUM(video_totaltime) AS video_totaltime_total,
          SUM(p2s_lost_Leq5) AS p2s_lost_Leq5_total,
          SUM(p2s_lost_all) AS p2s_lost_all_total,
          SUM(s2l_25ms_delay_sec) AS s2l_25ms_delay_sec_total,
          SUM(s2l_75ms_delay_sec) AS s2l_75ms_delay_sec_total,
          SUM(s2l_total_delay_sec) AS s2l_total_delay_sec_total,
          SUM(crash_cnt) AS crash_cnt_total,
          SUM(service_cnt) AS service_cnt_total,
          SUM(""5s_succ_join_session_cnt_last1"") AS ""5s_succ_join_session_cnt_last1_total"",
          SUM(""3s_succ_join_session_cnt_last1"") AS ""3s_succ_join_session_cnt_last1_total"",
          SUM(succ_join_session_cnt_last1) AS succ_join_session_cnt_last1_total,
          SUM(total_join_session_cnt_last1) AS total_join_session_cnt_last1_total,
          SUM(total_session_cnt_last1) AS total_session_cnt_last1_total,
          SUM(""1s_succ_join_ap_cnt_last1"") AS ""1s_succ_join_ap_cnt_last1_total"",
          SUM(""5s_succ_join_ap_cnt_last1"") AS ""5s_succ_join_ap_cnt_last1_total"",
          SUM(total_join_ap_cnt_last1) AS total_join_ap_cnt_last1_total,
          SUM(video_freeze_time_last1) AS video_freeze_time_last1_total,
          SUM(video_totaltime_last1) AS video_totaltime_last1_total,
          SUM(p2s_lost_Leq5_last1) AS p2s_lost_Leq5_last1_total,
          SUM(p2s_lost_all_last1) AS p2s_lost_all_last1_total,
          SUM(s2l_25ms_delay_sec_last1) AS s2l_25ms_delay_sec_last1_total,
          SUM(s2l_75ms_delay_sec_last1) AS s2l_75ms_delay_sec_last1_total,
          SUM(s2l_total_delay_sec_last1) AS s2l_total_delay_sec_last1_total,
          SUM(crash_cnt_last1) AS crash_cnt_last1_total,
          SUM(service_cnt_last1) AS service_cnt_last1_total,
          SUM(audio_freeze_time_200_last1) AS audio_freeze_time_200_last1_total,
          SUM(audio_totaltime_200_last1) AS audio_totaltime_200_last1_total,
          SUM(""5s_succ_join_session_cnt_last7"") AS ""5s_succ_join_session_cnt_last7_total"",
          SUM(""3s_succ_join_session_cnt_last7"") AS ""3s_succ_join_session_cnt_last7_total"",
          SUM(succ_join_session_cnt_last7) AS succ_join_session_cnt_last7_total,
          SUM(total_join_session_cnt_last7) AS total_join_session_cnt_last7_total,
          SUM(total_session_cnt_last7) AS total_session_cnt_last7_total,
          SUM(""1s_succ_join_ap_cnt_last7"") AS ""7s_succ_join_ap_cnt_last7_total"",
          SUM(""5s_succ_join_ap_cnt_last7"") AS ""5s_succ_join_ap_cnt_last7_total"",
          SUM(total_join_ap_cnt_last7) AS total_join_ap_cnt_last7_total,
          SUM(video_freeze_time_last7) AS video_freeze_time_last7_total,
          SUM(video_totaltime_last7) AS video_totaltime_last7_total,
          SUM(p2s_lost_Leq5_last7) AS p2s_lost_Leq5_last7_total,
          SUM(p2s_lost_all_last7) AS p2s_lost_all_last7_total,
          SUM(s2l_25ms_delay_sec_last7) AS s2l_25ms_delay_sec_last7_total,
          SUM(s2l_75ms_delay_sec_last7) AS s2l_75ms_delay_sec_last7_total,
          SUM(s2l_total_delay_sec_last7) AS s2l_total_delay_sec_last7_total,
          SUM(crash_cnt_last7) AS crash_cnt_last7_total,
          SUM(service_cnt_last7) AS service_cnt_last7_total,
          SUM(audio_freeze_time_200_last7) AS audio_freeze_time_200_last7_total,
          SUM(audio_totaltime_200_last7) AS audio_totaltime_200_last7_total,
          SUM(video_freeze_time_500) AS video_freeze_time_500_total,
          SUM(video_totaltime_500) AS video_totaltime_500_total,
          SUM(video_freeze_time_200) AS video_freeze_time_200_total,
          SUM(video_totaltime_200) AS video_totaltime_200_total,
          SUM(video_freeze_time_500_last1) AS video_freeze_time_500_last1_total,
          SUM(video_totaltime_500_last1) AS video_totaltime_500_last1_total,
          SUM(video_freeze_time_200_last1) AS video_freeze_time_200_last1_total,
          SUM(video_totaltime_200_last1) AS video_totaltime_200_last1_total,
          SUM(video_freeze_time_500_last7) AS video_freeze_time_500_last7_total,
          SUM(video_totaltime_500_last7) AS video_totaltime_500_last7_total,
          SUM(video_freeze_time_200_last7) AS video_freeze_time_200_last7_total,
          SUM(video_totaltime_200_last7) AS video_totaltime_200_last7_total,
          SUM(s2l_lost_Leq5) AS s2l_lost_Leq5_total,
          SUM(s2l_lost_all) AS s2l_lost_all_total,
          SUM(s2l_lost_Leq5_last1) AS s2l_lost_Leq5_last1_total,
          SUM(s2l_lost_all_last1) AS s2l_lost_all_last1_total,
          SUM(s2l_lost_Leq5_last7) AS s2l_lost_Leq5_last7_total,
          SUM(s2l_lost_all_last7) AS s2l_lost_all_last7_total
        FROM report_datahub.vid_osver_net_cp_domain_quality_di_1
        WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-21') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-11-21') AND CAST(vid AS VARCHAR) = CAST(281104 AS VARCHAR) AND CAST(product_level_2 AS VARCHAR) = 'Native'
        GROUP BY vid,
          date) AS tt ON CAST(ts.vid AS VARCHAR) = CAST(tt.vid AS VARCHAR) AND ts.date = tt.date) AS ""自定义 SQL 查询""
  CROSS JOIN (SELECT MAX(date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d')) AS ""__measure__0""
    FROM (SELECT ts.*,
          fiveSecJoinSuccess_total,
          threeSecJoinSuccess_total,
          totalJoinSuccess_total,
          totalJoin_total,
          cnt_sid_total,
          ""1s_succ_join_ap_cnt_total"",
          ""5s_succ_join_ap_cnt_total"",
          total_join_ap_cnt_total,
          audio_freeze_time_200_total,
          audio_totaltime_200_total,
          video_freeze_time_total,
          video_totaltime_total,
          p2s_lost_Leq5_total,
          p2s_lost_all_total,
          s2l_25ms_delay_sec_total,
          s2l_75ms_delay_sec_total,
          s2l_total_delay_sec_total,
          crash_cnt_total,
          service_cnt_total,
          ""5s_succ_join_session_cnt_last1_total"",
          ""3s_succ_join_session_cnt_last1_total"",
          succ_join_session_cnt_last1_total,
          total_join_session_cnt_last1_total,
          total_session_cnt_last1_total,
          ""1s_succ_join_ap_cnt_last1_total"",
          ""5s_succ_join_ap_cnt_last1_total"",
          total_join_ap_cnt_last1_total,
          video_freeze_time_last1_total,
          video_totaltime_last1_total,
          p2s_lost_Leq5_last1_total,
          p2s_lost_all_last1_total,
          s2l_25ms_delay_sec_last1_total,
          s2l_75ms_delay_sec_last1_total,
          s2l_total_delay_sec_last1_total,
          crash_cnt_last1_total,
          service_cnt_last1_total,
          audio_freeze_time_200_last1_total,
          audio_totaltime_200_last1_total,
          ""5s_succ_join_session_cnt_last7_total"",
          ""3s_succ_join_session_cnt_last7_total"",
          succ_join_session_cnt_last7_total,
          total_join_session_cnt_last7_total,
          total_session_cnt_last7_total,
          ""7s_succ_join_ap_cnt_last7_total"",
          ""5s_succ_join_ap_cnt_last7_total"",
          total_join_ap_cnt_last7_total,
          video_freeze_time_last7_total,
          video_totaltime_last7_total,
          p2s_lost_Leq5_last7_total,
          p2s_lost_all_last7_total,
          s2l_25ms_delay_sec_last7_total,
          s2l_75ms_delay_sec_last7_total,
          s2l_total_delay_sec_last7_total,
          crash_cnt_last7_total,
          service_cnt_last7_total,
          audio_freeze_time_200_last7_total,
          audio_totaltime_200_last7_total,
          video_freeze_time_500_total,
          video_totaltime_500_total,
          video_freeze_time_200_total,
          video_totaltime_200_total,
          video_freeze_time_500_last1_total,
          video_totaltime_500_last1_total,
          video_freeze_time_200_last1_total,
          video_totaltime_200_last1_total,
          video_freeze_time_500_last7_total,
          video_totaltime_500_last7_total,
          video_freeze_time_200_last7_total,
          video_totaltime_200_last7_total,
          s2l_lost_Leq5_total,
          s2l_lost_all_total,
          s2l_lost_Leq5_last1_total,
          s2l_lost_all_last1_total,
          s2l_lost_Leq5_last7_total,
          s2l_lost_all_last7_total
        FROM (SELECT vid,
              project,
              company_id,
              area,
              company_name,
              industry_name,
              date,
                CASE WHEN CAST(stat_period AS VARCHAR) = 'day' THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(substr(CAST(start_date AS VARCHAR), 1, 10) AS VARCHAR), '~', CAST(substr(CAST(end_date AS VARCHAR), 1, 10) AS VARCHAR)) END AS period,
              net,
              os,
              ver,
              'osver' AS dim,
              product_level_1,
              product_level_2,
              ver_type,
              SUM(fiveSecJoinSuccess) AS fiveSecJoinSuccess,
              SUM(threeSecJoinSuccess) AS threeSecJoinSuccess,
              SUM(totalJoinSuccess) AS totalJoinSuccess,
              SUM(totalJoin) AS totalJoin,
              SUM(cnt_sid) AS cnt_sid,
              SUM(""1s_succ_join_ap_cnt"") AS ""1s_succ_join_ap_cnt"",
              SUM(""5s_succ_join_ap_cnt"") AS ""5s_succ_join_ap_cnt"",
              SUM(total_join_ap_cnt) AS total_join_ap_cnt,
              SUM(audio_freeze_time_200) AS audio_freeze_time_200,
              SUM(audio_totaltime_200) AS audio_totaltime_200,
              SUM(video_freeze_time) AS video_freeze_time,
              SUM(video_totaltime) AS video_totaltime,
              SUM(p2s_lost_Leq5) AS p2s_lost_Leq5,
              SUM(p2s_lost_all) AS p2s_lost_all,
              SUM(s2l_25ms_delay_sec) AS s2l_25ms_delay_sec,
              SUM(s2l_75ms_delay_sec) AS s2l_75ms_delay_sec,
              SUM(s2l_total_delay_sec) AS s2l_total_delay_sec,
              SUM(crash_cnt) AS crash_cnt,
              SUM(service_cnt) AS service_cnt,
              SUM(""5s_succ_join_session_cnt_last1"") AS ""5s_succ_join_session_cnt_last1"",
              SUM(""3s_succ_join_session_cnt_last1"") AS ""3s_succ_join_session_cnt_last1"",
              SUM(succ_join_session_cnt_last1) AS succ_join_session_cnt_last1,
              SUM(total_join_session_cnt_last1) AS total_join_session_cnt_last1,
              SUM(total_session_cnt_last1) AS total_session_cnt_last1,
              SUM(""1s_succ_join_ap_cnt_last1"") AS ""1s_succ_join_ap_cnt_last1"",
              SUM(""5s_succ_join_ap_cnt_last1"") AS ""5s_succ_join_ap_cnt_last1"",
              SUM(total_join_ap_cnt_last1) AS total_join_ap_cnt_last1,
              SUM(video_freeze_time_last1) AS video_freeze_time_last1,
              SUM(video_totaltime_last1) AS video_totaltime_last1,
              SUM(p2s_lost_Leq5_last1) AS p2s_lost_Leq5_last1,
              SUM(p2s_lost_all_last1) AS p2s_lost_all_last1,
              SUM(s2l_25ms_delay_sec_last1) AS s2l_25ms_delay_sec_last1,
              SUM(s2l_75ms_delay_sec_last1) AS s2l_75ms_delay_sec_last1,
              SUM(s2l_total_delay_sec_last1) AS s2l_total_delay_sec_last1,
              SUM(crash_cnt_last1) AS crash_cnt_last1,
              SUM(service_cnt_last1) AS service_cnt_last1,
              SUM(audio_freeze_time_200_last1) AS audio_freeze_time_200_last1,
              SUM(audio_totaltime_200_last1) AS audio_totaltime_200_last1,
              SUM(""5s_succ_join_session_cnt_last7"") AS ""5s_succ_join_session_cnt_last7"",
              SUM(""3s_succ_join_session_cnt_last7"") AS ""3s_succ_join_session_cnt_last7"",
              SUM(succ_join_session_cnt_last7) AS succ_join_session_cnt_last7,
              SUM(total_join_session_cnt_last7) AS total_join_session_cnt_last7,
              SUM(total_session_cnt_last7) AS total_session_cnt_last7,
              SUM(""1s_succ_join_ap_cnt_last7"") AS ""7s_succ_join_ap_cnt_last7"",
              SUM(""5s_succ_join_ap_cnt_last7"") AS ""5s_succ_join_ap_cnt_last7"",
              SUM(total_join_ap_cnt_last7) AS total_join_ap_cnt_last7,
              SUM(video_freeze_time_last7) AS video_freeze_time_last7,
              SUM(video_totaltime_last7) AS video_totaltime_last7,
              SUM(p2s_lost_Leq5_last7) AS p2s_lost_Leq5_last7,
              SUM(p2s_lost_all_last7) AS p2s_lost_all_last7,
              SUM(s2l_25ms_delay_sec_last7) AS s2l_25ms_delay_sec_last7,
              SUM(s2l_75ms_delay_sec_last7) AS s2l_75ms_delay_sec_last7,
              SUM(s2l_total_delay_sec_last7) AS s2l_total_delay_sec_last7,
              SUM(crash_cnt_last7) AS crash_cnt_last7,
              SUM(service_cnt_last7) AS service_cnt_last7,
              SUM(audio_freeze_time_200_last7) AS audio_freeze_time_200_last7,
              SUM(audio_totaltime_200_last7) AS audio_totaltime_200_last7,
              SUM(video_freeze_time_500) AS video_freeze_time_500,
              SUM(video_totaltime_500) AS video_totaltime_500,
              SUM(video_freeze_time_200) AS video_freeze_time_200,
              SUM(video_totaltime_200) AS video_totaltime_200,
              SUM(video_freeze_time_500_last1) AS video_freeze_time_500_last1,
              SUM(video_totaltime_500_last1) AS video_totaltime_500_last1,
              SUM(video_freeze_time_200_last1) AS video_freeze_time_200_last1,
              SUM(video_totaltime_200_last1) AS video_totaltime_200_last1,
              SUM(video_freeze_time_500_last7) AS video_freeze_time_500_last7,
              SUM(video_totaltime_500_last7) AS video_totaltime_500_last7,
              SUM(video_freeze_time_200_last7) AS video_freeze_time_200_last7,
              SUM(video_totaltime_200_last7) AS video_totaltime_200_last7,
              SUM(s2l_lost_Leq5) AS s2l_lost_Leq5,
              SUM(s2l_lost_all) AS s2l_lost_all,
              SUM(s2l_lost_Leq5_last1) AS s2l_lost_Leq5_last1,
              SUM(s2l_lost_all_last1) AS s2l_lost_all_last1,
              SUM(s2l_lost_Leq5_last7) AS s2l_lost_Leq5_last7,
              SUM(s2l_lost_all_last7) AS s2l_lost_all_last7
            FROM report_datahub.vid_osver_net_cp_domain_quality_di_1
            WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-21') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-11-21') AND CAST(vid AS VARCHAR) = CAST(281104 AS VARCHAR) AND CAST(product_level_2 AS VARCHAR) = 'Native'
            GROUP BY vid,
              project,
              company_id,
              area,
              company_name,
              industry_name,
              date,
              net,
              os,
              ver,
              product_level_1,
              product_level_2,
              ver_type,
                CASE WHEN CAST(stat_period AS VARCHAR) = 'day' THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(substr(CAST(start_date AS VARCHAR), 1, 10) AS VARCHAR), '~', CAST(substr(CAST(end_date AS VARCHAR), 1, 10) AS VARCHAR)) END) AS ts
          LEFT JOIN (SELECT vid,
              date,
              SUM(fiveSecJoinSuccess) AS fiveSecJoinSuccess_total,
              SUM(threeSecJoinSuccess) AS threeSecJoinSuccess_total,
              SUM(totalJoinSuccess) AS totalJoinSuccess_total,
              SUM(totalJoin) AS totalJoin_total,
              SUM(cnt_sid) AS cnt_sid_total,
              SUM(""1s_succ_join_ap_cnt"") AS ""1s_succ_join_ap_cnt_total"",
              SUM(""5s_succ_join_ap_cnt"") AS ""5s_succ_join_ap_cnt_total"",
              SUM(total_join_ap_cnt) AS total_join_ap_cnt_total,
              SUM(audio_freeze_time_200) AS audio_freeze_time_200_total,
              SUM(audio_totaltime_200) AS audio_totaltime_200_total,
              SUM(video_freeze_time) AS video_freeze_time_total,
              SUM(video_totaltime) AS video_totaltime_total,
              SUM(p2s_lost_Leq5) AS p2s_lost_Leq5_total,
              SUM(p2s_lost_all) AS p2s_lost_all_total,
              SUM(s2l_25ms_delay_sec) AS s2l_25ms_delay_sec_total,
              SUM(s2l_75ms_delay_sec) AS s2l_75ms_delay_sec_total,
              SUM(s2l_total_delay_sec) AS s2l_total_delay_sec_total,
              SUM(crash_cnt) AS crash_cnt_total,
              SUM(service_cnt) AS service_cnt_total,
              SUM(""5s_succ_join_session_cnt_last1"") AS ""5s_succ_join_session_cnt_last1_total"",
              SUM(""3s_succ_join_session_cnt_last1"") AS ""3s_succ_join_session_cnt_last1_total"",
              SUM(succ_join_session_cnt_last1) AS succ_join_session_cnt_last1_total,
              SUM(total_join_session_cnt_last1) AS total_join_session_cnt_last1_total,
              SUM(total_session_cnt_last1) AS total_session_cnt_last1_total,
              SUM(""1s_succ_join_ap_cnt_last1"") AS ""1s_succ_join_ap_cnt_last1_total"",
              SUM(""5s_succ_join_ap_cnt_last1"") AS ""5s_succ_join_ap_cnt_last1_total"",
              SUM(total_join_ap_cnt_last1) AS total_join_ap_cnt_last1_total,
              SUM(video_freeze_time_last1) AS video_freeze_time_last1_total,
              SUM(video_totaltime_last1) AS video_totaltime_last1_total,
              SUM(p2s_lost_Leq5_last1) AS p2s_lost_Leq5_last1_total,
              SUM(p2s_lost_all_last1) AS p2s_lost_all_last1_total,
              SUM(s2l_25ms_delay_sec_last1) AS s2l_25ms_delay_sec_last1_total,
              SUM(s2l_75ms_delay_sec_last1) AS s2l_75ms_delay_sec_last1_total,
              SUM(s2l_total_delay_sec_last1) AS s2l_total_delay_sec_last1_total,
              SUM(crash_cnt_last1) AS crash_cnt_last1_total,
              SUM(service_cnt_last1) AS service_cnt_last1_total,
              SUM(audio_freeze_time_200_last1) AS audio_freeze_time_200_last1_total,
              SUM(audio_totaltime_200_last1) AS audio_totaltime_200_last1_total,
              SUM(""5s_succ_join_session_cnt_last7"") AS ""5s_succ_join_session_cnt_last7_total"",
              SUM(""3s_succ_join_session_cnt_last7"") AS ""3s_succ_join_session_cnt_last7_total"",
              SUM(succ_join_session_cnt_last7) AS succ_join_session_cnt_last7_total,
              SUM(total_join_session_cnt_last7) AS total_join_session_cnt_last7_total,
              SUM(total_session_cnt_last7) AS total_session_cnt_last7_total,
              SUM(""1s_succ_join_ap_cnt_last7"") AS ""7s_succ_join_ap_cnt_last7_total"",
              SUM(""5s_succ_join_ap_cnt_last7"") AS ""5s_succ_join_ap_cnt_last7_total"",
              SUM(total_join_ap_cnt_last7) AS total_join_ap_cnt_last7_total,
              SUM(video_freeze_time_last7) AS video_freeze_time_last7_total,
              SUM(video_totaltime_last7) AS video_totaltime_last7_total,
              SUM(p2s_lost_Leq5_last7) AS p2s_lost_Leq5_last7_total,
              SUM(p2s_lost_all_last7) AS p2s_lost_all_last7_total,
              SUM(s2l_25ms_delay_sec_last7) AS s2l_25ms_delay_sec_last7_total,
              SUM(s2l_75ms_delay_sec_last7) AS s2l_75ms_delay_sec_last7_total,
              SUM(s2l_total_delay_sec_last7) AS s2l_total_delay_sec_last7_total,
              SUM(crash_cnt_last7) AS crash_cnt_last7_total,
              SUM(service_cnt_last7) AS service_cnt_last7_total,
              SUM(audio_freeze_time_200_last7) AS audio_freeze_time_200_last7_total,
              SUM(audio_totaltime_200_last7) AS audio_totaltime_200_last7_total,
              SUM(video_freeze_time_500) AS video_freeze_time_500_total,
              SUM(video_totaltime_500) AS video_totaltime_500_total,
              SUM(video_freeze_time_200) AS video_freeze_time_200_total,
              SUM(video_totaltime_200) AS video_totaltime_200_total,
              SUM(video_freeze_time_500_last1) AS video_freeze_time_500_last1_total,
              SUM(video_totaltime_500_last1) AS video_totaltime_500_last1_total,
              SUM(video_freeze_time_200_last1) AS video_freeze_time_200_last1_total,
              SUM(video_totaltime_200_last1) AS video_totaltime_200_last1_total,
              SUM(video_freeze_time_500_last7) AS video_freeze_time_500_last7_total,
              SUM(video_totaltime_500_last7) AS video_totaltime_500_last7_total,
              SUM(video_freeze_time_200_last7) AS video_freeze_time_200_last7_total,
              SUM(video_totaltime_200_last7) AS video_totaltime_200_last7_total,
              SUM(s2l_lost_Leq5) AS s2l_lost_Leq5_total,
              SUM(s2l_lost_all) AS s2l_lost_all_total,
              SUM(s2l_lost_Leq5_last1) AS s2l_lost_Leq5_last1_total,
              SUM(s2l_lost_all_last1) AS s2l_lost_all_last1_total,
              SUM(s2l_lost_Leq5_last7) AS s2l_lost_Leq5_last7_total,
              SUM(s2l_lost_all_last7) AS s2l_lost_all_last7_total
            FROM report_datahub.vid_osver_net_cp_domain_quality_di_1
            WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-21') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-11-21') AND CAST(vid AS VARCHAR) = CAST(281104 AS VARCHAR) AND CAST(product_level_2 AS VARCHAR) = 'Native'
            GROUP BY vid,
              date) AS tt ON CAST(ts.vid AS VARCHAR) = CAST(tt.vid AS VARCHAR) AND ts.date = tt.date) AS ""自定义 SQL 查询""
    HAVING COUNT(1) > 0) AS ""t0""
WHERE DATE_ADD('SECOND', 0, date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d')) = DATE_ADD('SECOND', 0, ""t0"".""__measure__0"")
HAVING COUNT(1) > 0"
"SELECT ""自定义 SQL 查询"".""product_level1"" AS ""product_level1"",
  ""自定义 SQL 查询"".""product_level2"" AS ""product_level2"",
  ""自定义 SQL 查询"".""product_level3"" AS ""product_level3"",
  SUM(""自定义 SQL 查询"".""total"") AS ""sum_total_ok""
FROM (SELECT date,
      SUBSTR(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) AS date_range_1,
      SUBSTR(CAST(end_date AS VARCHAR), 1, 10) AS date_range_2,
      stat_period,
        CASE WHEN CAST(stat_period AS VARCHAR) = 'day' THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,
      area,
      vid,
      project,
      company_id AS cid,
      company_name AS company,
      customer_level AS level,
      vid_internal_industry_en AS industry,
      vid_use_case_cn,
      csdc_owner,
      os,
      ver,
      ver_type,
      product_level1,
      product_level2,
      product_level3,
      total,
      audio,
      video,
      video_sd,
      video_hd,
      video_hdp,
        host_audio + host_video AS host,
      host_audio,
      host_video,
      host_sd,
      host_hd,
      host_hdp,
        audience_audio + audience_video AS audience,
        audience_audio_low_latency + audience_video_low_latency AS audience_low_latency,
      audience_audio,
      audience_audio_low_latency,
      audience_video,
      audience_video_low_latency,
      audience_sd,
      audience_sd_low_latency,
      audience_hd,
      audience_hd_low_latency,
      audience_hdp,
      audience_hdp_low_latency,
      total_last1,
      audio_last1,
      video_last1,
      video_sd_last1,
      video_hd_last1,
      video_hdp_last1,
        host_audio_last1 + host_video_last1 AS host_last1,
      host_audio_last1,
      host_video_last1,
        audience_audio_last1 + audience_video_last1 AS audience_last1,
        audience_audio_low_latency_last1 + audience_video_low_latency_last1 AS audience_low_latency_last1,
      audience_audio_last1,
      audience_audio_low_latency_last1,
      audience_video_last1,
      audience_video_low_latency_last1,
      total_last7,
      audio_last7,
      video_last7,
      video_sd_last7,
      video_hd_last7,
      video_hdp_last7,
        host_audio_last7 + host_video_last7 AS host_last7,
      host_audio_last7,
      host_video_last7,
        audience_audio_last7 + audience_video_last7 AS audience_last7,
        audience_audio_low_latency_last7 + audience_video_low_latency_last7 AS audience_low_latency_last7,
      audience_audio_last7,
      audience_audio_low_latency_last7,
      audience_video_last7,
      audience_video_low_latency_last7
    FROM report_datahub.vendor_vid_usage_di_1
    WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-06') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-06') AND CAST(vid AS VARCHAR) = CAST(311291 AS VARCHAR) AND dim = 1) AS ""自定义 SQL 查询""
GROUP BY 1,
  2,
  3"
"SELECT SUM(""自定义 SQL 查询"".""delay25"") AS ""TEMP(Calculation_3094043381461364736)(3362377732)(0)"",
  SUM(""自定义 SQL 查询"".""delay_total"") AS ""TEMP(Calculation_3094043381461364736)(363980608)(0)"",
  SUM(""自定义 SQL 查询"".""delay75"") AS ""TEMP(Calculation_3094043381461454849)(2419700853)(0)"",
  SUM(""自定义 SQL 查询"".""lost_ratio_5"") AS ""TEMP(Calculation_3094043381461549058)(1479243093)(0)"",
  SUM(""自定义 SQL 查询"".""lost_total"") AS ""TEMP(Calculation_3094043381461549058)(154362899)(0)"",
  ""自定义 SQL 查询"".""country"" AS ""country"",
  DATE_ADD('SECOND', 0, date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d')) AS ""tdy_date_ok""
FROM (SELECT *
    FROM media.sdrtn_okr_notvpn
    WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-16') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-11-29')) AS ""自定义 SQL 查询""
WHERE CASE WHEN CAST(""自定义 SQL 查询"".""country"" AS VARCHAR) = 'Brazil' AND CAST(""自定义 SQL 查询"".""speaker_vos_idc"" AS VARCHAR) = 'zen-saopaulo2' OR CAST(""自定义 SQL 查询"".""country"" AS VARCHAR) = 'Philippines' AND CAST(""自定义 SQL 查询"".""speaker_vos_idc"" AS VARCHAR) = 'zen-manila9p' OR CAST(""自定义 SQL 查询"".""country"" AS VARCHAR) = 'United Arab Emirates' AND CAST(""自定义 SQL 查询"".""speaker_vos_idc"" AS VARCHAR) = 'zen-fujairah' OR CAST(""自定义 SQL 查询"".""country"" AS VARCHAR) = 'Saudi Arabia' AND CAST(""自定义 SQL 查询"".""speaker_vos_idc"" AS VARCHAR) = 'kaopuyun-saudi' OR CAST(""自定义 SQL 查询"".""country"" AS VARCHAR) = 'Turkey' AND CAST(""自定义 SQL 查询"".""speaker_vos_idc"" AS VARCHAR) = 'zen-istanbul' OR CAST(""自定义 SQL 查询"".""country"" AS VARCHAR) = 'Indonesia' AND CAST(""自定义 SQL 查询"".""speaker_vos_idc"" AS VARCHAR) = 'zen-jakarta1a' THEN 1 ELSE 0 END
GROUP BY 6,
  7
HAVING CASE WHEN SUM(""自定义 SQL 查询"".""delay25"") / SUM(""自定义 SQL 查询"".""delay_total"") >= 0.5 AND SUM(""自定义 SQL 查询"".""delay75"") / SUM(""自定义 SQL 查询"".""delay_total"") >= 0.90000000000000002 AND SUM(""自定义 SQL 查询"".""lost_ratio_5"") / SUM(""自定义 SQL 查询"".""lost_total"") >= 0.96499999999999997 THEN 0 ELSE 1 END"
"SELECT SUM(""自定义 SQL 查询"".""p2s_Delay25"" * ""自定义 SQL 查询"".""delay_total"") AS ""TEMP(Calculation_6634083767547871232)(1563607262)(0)"",
  SUM(""自定义 SQL 查询"".""delay_total"") AS ""TEMP(Calculation_6634083767547871232)(363980608)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_Delay50"" * ""自定义 SQL 查询"".""delay_total"") AS ""TEMP(Calculation_6634083767548375041)(1551638771)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_Delay75"" * ""自定义 SQL 查询"".""delay_total"") AS ""TEMP(Calculation_6634083767548604418)(2562427304)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_Delay100"" * ""自定义 SQL 查询"".""delay_total"") AS ""TEMP(Calculation_6634083767549652995)(4273621395)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_Delay125"" * ""自定义 SQL 查询"".""delay_total"") AS ""TEMP(Calculation_6634083767550287876)(3242688810)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_lostRatio"" * ""自定义 SQL 查询"".""p2s_total"") AS ""TEMP(Calculation_6634083767550464005)(1741181994)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_total"") AS ""TEMP(Calculation_6634083767550464005)(2624355999)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_jitter95_50"" * ""自定义 SQL 查询"".""jitter95_total"") AS ""TEMP(Calculation_6634083767551082502)(1652714847)(0)"",
  SUM(""自定义 SQL 查询"".""jitter95_total"") AS ""TEMP(Calculation_6634083767551082502)(633698484)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_jitter95_100"" * ""自定义 SQL 查询"".""jitter95_total"") AS ""TEMP(Calculation_6634083767551520776)(3609783325)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_jitter95_200"" * ""自定义 SQL 查询"".""jitter95_total"") AS ""TEMP(Calculation_6634083767551815690)(206867949)(0)"",
  ""自定义 SQL 查询"".""srcDomain"" AS ""srcDomain"",
  SUM(""自定义 SQL 查询"".""p2s_total"") AS ""sum_p2s_total_ok""
FROM (SELECT date,
      src_domain AS ""srcDomain"",
      delay_25 AS ""p2s_Delay25"",
      delay_50 AS ""p2s_Delay50"",
      delay_75 AS ""p2s_Delay75"",
      delay_100 AS ""p2s_Delay100"",
      delay_125 AS ""p2s_Delay125"",
      delay_150 AS ""p2s_Delay150"",
      delay_total,
      lost_ratio_5 AS ""p2s_lostRatio"",
      lostratio_total AS ""p2s_total"",
      jitter95_50 AS ""p2s_jitter95_50"",
      jitter95_100 AS ""p2s_jitter95_100"",
      jitter95_200 AS ""p2s_jitter95_200"",
      jitter95_300 AS ""p2s_jitter95_300"",
      jitter95_total,
      product_line,
      product_type
    FROM media.p2s_cover_domain
    WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-25') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-01')) AS ""自定义 SQL 查询""
GROUP BY 13"
"SELECT SUM(""自定义 SQL 查询"".""s2l_25ms_delay_sec"") AS ""TEMP(Calculation_1430244791154503680)(2227145667)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_total_delay_sec"") AS ""TEMP(Calculation_1430244791154503680)(2460078802)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_total_delay_sec_last1"") AS ""TEMP(Calculation_1430244791161831425)(1533897333)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_25ms_delay_sec_last1"") AS ""TEMP(Calculation_1430244791161831425)(3105382701)(0)"",
  SUM(""自定义 SQL 查询"".""5s_succ_join_ap_cnt"") AS ""TEMP(Calculation_1430244791247978510)(1716451703)(0)"",
  SUM(""自定义 SQL 查询"".""total_join_ap_cnt"") AS ""TEMP(Calculation_1430244791247978510)(2681092799)(0)"",
  SUM(""自定义 SQL 查询"".""5s_succ_join_ap_cnt_last1"") AS ""TEMP(Calculation_1430244791248527375)(865560869)(0)"",
  SUM(""自定义 SQL 查询"".""total_join_ap_cnt_last1"") AS ""TEMP(Calculation_1430244791248527375)(97423155)(0)"",
  SUM(""自定义 SQL 查询"".""video_freeze_time_500"") AS ""TEMP(Calculation_1857594119395086336)(389023081)(0)"",
  SUM(""自定义 SQL 查询"".""video_totaltime_500"") AS ""TEMP(Calculation_1857594119395086336)(458654145)(0)"",
  SUM(""自定义 SQL 查询"".""video_totaltime_500_last1"") AS ""TEMP(Calculation_1857594119395348481)(3425883446)(0)"",
  SUM(""自定义 SQL 查询"".""video_freeze_time_500_last1"") AS ""TEMP(Calculation_1857594119395348481)(3450234468)(0)"",
  SUM(""自定义 SQL 查询"".""video_totaltime_200"") AS ""TEMP(Calculation_2033093767653158912)(2104207895)(0)"",
  SUM(""自定义 SQL 查询"".""video_freeze_time_200"") AS ""TEMP(Calculation_2033093767653158912)(530162565)(0)"",
  SUM(""自定义 SQL 查询"".""video_totaltime_200_last1"") AS ""TEMP(Calculation_2033093767653347329)(1909093697)(0)"",
  SUM(""自定义 SQL 查询"".""video_freeze_time_200_last1"") AS ""TEMP(Calculation_2033093767653347329)(2193258393)(0)"",
  SUM(""自定义 SQL 查询"".""totalJoin"") AS ""TEMP(Calculation_374009936508170240)(2073556184)(0)"",
  SUM(""自定义 SQL 查询"".""totalJoinSuccess"") AS ""TEMP(Calculation_374009936508170240)(2807417001)(0)"",
  SUM(""自定义 SQL 查询"".""threeSecJoinSuccess"") AS ""TEMP(Calculation_374009936508321793)(3693645608)(0)"",
  SUM(""自定义 SQL 查询"".""fiveSecJoinSuccess"") AS ""TEMP(Calculation_374009936508416002)(383616769)(0)"",
  SUM(""自定义 SQL 查询"".""video_totaltime"") AS ""TEMP(Calculation_374009936515215363)(2797449586)(0)"",
  SUM(""自定义 SQL 查询"".""video_freeze_time"") AS ""TEMP(Calculation_374009936515215363)(2940759860)(0)"",
  SUM(""自定义 SQL 查询"".""audio_totaltime"") AS ""TEMP(Calculation_374009936517861380)(1652566750)(0)"",
  SUM(""自定义 SQL 查询"".""audio_freeze_time"") AS ""TEMP(Calculation_374009936517861380)(2919389392)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_lost_Leq5"") AS ""TEMP(Calculation_374009936519704581)(1936123547)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_lost_all"") AS ""TEMP(Calculation_374009936519704581)(749826584)(0)"",
  SUM(""自定义 SQL 查询"".""total_join_session_cnt_last1"") AS ""TEMP(Calculation_374009936523853831)(2708102775)(0)"",
  SUM(""自定义 SQL 查询"".""succ_join_session_cnt_last1"") AS ""TEMP(Calculation_374009936523853831)(929207889)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_75ms_delay_sec"") AS ""TEMP(Calculation_6542393318886285312)(2003933318)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_total_delay_sec_last1"") AS ""TEMP(Calculation_6542393318886735875)(3088956105)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_75ms_delay_sec_last1"") AS ""TEMP(Calculation_6542393318886735875)(602483182)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_lost_Leq5"") AS ""TEMP(Calculation_7012034266496475136)(2745840127)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_lost_all"") AS ""TEMP(Calculation_7012034266496475136)(734589263)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_lost_all_last1"") AS ""TEMP(Calculation_7012034266496618497)(3348338895)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_lost_Leq5_last1"") AS ""TEMP(Calculation_7012034266496618497)(700826822)(0)"",
  SUM(""自定义 SQL 查询"".""3s_succ_join_session_cnt_last1"") AS ""TEMP(Calculation_7034341207020355584)(2445597373)(0)"",
  SUM(""自定义 SQL 查询"".""5s_succ_join_session_cnt_last1"") AS ""TEMP(Calculation_7034341207023706114)(2534022291)(0)"",
  SUM(""自定义 SQL 查询"".""video_totaltime_last1"") AS ""TEMP(Calculation_7034341207025315846)(1221500367)(0)"",
  SUM(""自定义 SQL 查询"".""video_freeze_time_last1"") AS ""TEMP(Calculation_7034341207025315846)(3506758486)(0)"",
  SUM(""自定义 SQL 查询"".""audio_totaltime_last1"") AS ""TEMP(Calculation_7034341207025774600)(803828507)(0)"",
  SUM(""自定义 SQL 查询"".""audio_freeze_time_last1"") AS ""TEMP(Calculation_7034341207025774600)(877259553)(0)"",
  SUM(""自定义 SQL 查询"".""crash_cnt"") AS ""TEMP(Calculation_7034341207372070925)(2360900687)(0)"",
  SUM(""自定义 SQL 查询"".""service_cnt"") AS ""TEMP(Calculation_7034341207372070925)(4291252132)(0)"",
  SUM(""自定义 SQL 查询"".""service_cnt_last1"") AS ""TEMP(Calculation_7034341207372197902)(2436060403)(0)"",
  SUM(""自定义 SQL 查询"".""crash_cnt_last1"") AS ""TEMP(Calculation_7034341207372197902)(651130603)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_lost_all_last1"") AS ""TEMP(Calculation_75998310509129730)(1975694301)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_lost_Leq5_last1"") AS ""TEMP(Calculation_75998310509129730)(1982054307)(0)""
FROM (SELECT t1.date,
        CASE WHEN CAST(stat_period AS VARCHAR) = 'day' THEN substr(CAST(date_parse(cast( t1.date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(substr(CAST(start_date AS VARCHAR), 1, 10) AS VARCHAR), '~', CAST(substr(CAST(end_date AS VARCHAR), 1, 10) AS VARCHAR)) END AS period,
      start_date,
      end_date,
      stat_period,
      tag,
      t1.dim,
      level1,
      level2,
      level3,
      level4,
      os,
      ver,
      ver_type,
      domain,
      country,
      region,
      net,
      vid,
      project,
      company_id,
      company_name,
      rowsnum,
      lastusage,
      thisusage,
      fiveSecJoinSuccess,
      totalJoin,
      cnt_sid,
      video_freeze_time,
      video_totaltime,
      audio_freeze_time,
      audio_totaltime,
      s2l_total_delay_sec,
      s2l_25ms_delay_sec,
      s2l_75ms_delay_sec,
      p2s_lost_Leq5,
      p2s_lost_all,
      crash_cnt,
      service_cnt,
      ""1s_succ_join_ap_cnt"",
      ""5s_succ_join_ap_cnt"",
      total_join_ap_cnt,
      totalJoinSuccess,
      threeSecJoinSuccess,
      video_freeze_time_200,
      video_totaltime_200,
      video_freeze_time_500,
      video_totaltime_500,
      ""3s_succ_join_session_cnt_last1"",
      ""5s_succ_join_session_cnt_last1"",
      succ_join_session_cnt_last1,
      total_join_session_cnt_last1,
      total_session_cnt_last1,
      ""1s_succ_join_ap_cnt_last1"",
      ""5s_succ_join_ap_cnt_last1"",
      total_join_ap_cnt_last1,
      ""3s_succ_join_session_cnt_last7"",
      ""5s_succ_join_session_cnt_last7"",
      succ_join_session_cnt_last7,
      total_join_session_cnt_last7,
      total_session_cnt_last7,
      ""1s_succ_join_ap_cnt_last7"",
      ""5s_succ_join_ap_cnt_last7"",
      total_join_ap_cnt_last7,
      video_freeze_time_last1,
      video_totaltime_last1,
      video_freeze_time_500_last1,
      video_totaltime_500_last1,
      video_freeze_time_200_last1,
      video_totaltime_200_last1,
      video_freeze_time_last7,
      video_totaltime_last7,
      video_freeze_time_500_last7,
      video_totaltime_500_last7,
      video_freeze_time_200_last7,
      video_totaltime_200_last7,
      audio_freeze_time_last1,
      audio_totaltime_last1,
      audio_freeze_time_last7,
      audio_totaltime_last7,
      s2l_total_delay_sec_last1,
      s2l_25ms_delay_sec_last1,
      s2l_75ms_delay_sec_last1,
      s2l_total_delay_sec_last7,
      s2l_25ms_delay_sec_last7,
      s2l_75ms_delay_sec_last7,
      p2s_lost_Leq5_last1,
      p2s_lost_all_last1,
      p2s_lost_Leq5_last7,
      p2s_lost_all_last7,
      crash_cnt_last1,
      service_cnt_last1,
      crash_cnt_last7,
      service_cnt_last7,
      product_level1,
      product_level2,
      product_level3,
      product_level4,
      s2l_lost_Leq5,
      s2l_lost_all,
      s2l_lost_Leq5_last1,
      s2l_lost_all_last1,
      s2l_lost_Leq5_last7,
      s2l_lost_all_last7,
      fiveSecJoinSuccess_total,
      totalJoin_total,
      cnt_sid_total,
      video_freeze_time_total,
      video_totaltime_total,
      audio_freeze_time_total,
      audio_totaltime_total,
      s2l_total_delay_sec_total,
      s2l_25ms_delay_sec_total,
      s2l_75ms_delay_sec_total,
      p2s_lost_Leq5_total,
      p2s_lost_all_total,
      crash_cnt_total,
      service_cnt_total,
      ""1s_succ_join_ap_cnt_total"",
      ""5s_succ_join_ap_cnt_total"",
      total_join_ap_cnt_total,
      totalJoinSuccess_total,
      threeSecJoinSuccess_total,
      video_freeze_time_200_total,
      video_totaltime_200_total,
      video_freeze_time_500_total,
      video_totaltime_500_total,
      ""3s_succ_join_session_cnt_last1_total"",
      ""5s_succ_join_session_cnt_last1_total"",
      succ_join_session_cnt_last1_total,
      total_join_session_cnt_last1_total,
      total_session_cnt_last1_total,
      ""1s_succ_join_ap_cnt_last1_total"",
      ""5s_succ_join_ap_cnt_last1_total"",
      total_join_ap_cnt_last1_total,
      ""3s_succ_join_session_cnt_last7_total"",
      ""5s_succ_join_session_cnt_last7_total"",
      succ_join_session_cnt_last7_total,
      total_join_session_cnt_last7_total,
      total_session_cnt_last7_total,
      ""1s_succ_join_ap_cnt_last7_total"",
      ""5s_succ_join_ap_cnt_last7_total"",
      total_join_ap_cnt_last7_total,
      video_freeze_time_last1_total,
      video_totaltime_last1_total,
      video_freeze_time_500_last1_total,
      video_totaltime_500_last1_total,
      video_freeze_time_200_last1_total,
      video_totaltime_200_last1_total,
      video_freeze_time_last7_total,
      video_totaltime_last7_total,
      video_freeze_time_500_last7_total,
      video_totaltime_500_last7_total,
      video_freeze_time_200_last7_total,
      video_totaltime_200_last7_total,
      audio_freeze_time_last1_total,
      audio_totaltime_last1_total,
      audio_freeze_time_last7_total,
      audio_totaltime_last7_total,
      s2l_total_delay_sec_last1_total,
      s2l_25ms_delay_sec_last1_total,
      s2l_75ms_delay_sec_last1_total,
      s2l_total_delay_sec_last7_total,
      s2l_25ms_delay_sec_last7_total,
      s2l_75ms_delay_sec_last7_total,
      p2s_lost_Leq5_last1_total,
      p2s_lost_all_last1_total,
      p2s_lost_Leq5_last7_total,
      p2s_lost_all_last7_total,
      crash_cnt_last1_total,
      service_cnt_last1_total,
      crash_cnt_last7_total,
      service_cnt_last7_total,
      s2l_lost_Leq5_total,
      s2l_lost_all_total,
      s2l_lost_Leq5_last1_total,
      s2l_lost_all_last1_total,
      s2l_lost_Leq5_last7_total,
      s2l_lost_all_last7_total
    FROM report_datahub.pub_levels_quality_di_1 AS t1
      LEFT JOIN (SELECT date,
          dim,
          SUM(fiveSecJoinSuccess) AS fiveSecJoinSuccess_total,
          SUM(totalJoin) AS totalJoin_total,
          SUM(cnt_sid) AS cnt_sid_total,
          SUM(video_freeze_time) AS video_freeze_time_total,
          SUM(video_totaltime) AS video_totaltime_total,
          SUM(audio_freeze_time) AS audio_freeze_time_total,
          SUM(audio_totaltime) AS audio_totaltime_total,
          SUM(s2l_total_delay_sec) AS s2l_total_delay_sec_total,
          SUM(s2l_25ms_delay_sec) AS s2l_25ms_delay_sec_total,
          SUM(s2l_75ms_delay_sec) AS s2l_75ms_delay_sec_total,
          SUM(p2s_lost_Leq5) AS p2s_lost_Leq5_total,
          SUM(p2s_lost_all) AS p2s_lost_all_total,
          SUM(crash_cnt) AS crash_cnt_total,
          SUM(service_cnt) AS service_cnt_total,
          SUM(""1s_succ_join_ap_cnt"") AS ""1s_succ_join_ap_cnt_total"",
          SUM(""5s_succ_join_ap_cnt"") AS ""5s_succ_join_ap_cnt_total"",
          SUM(total_join_ap_cnt) AS total_join_ap_cnt_total,
          SUM(totalJoinSuccess) AS totalJoinSuccess_total,
          SUM(threeSecJoinSuccess) AS threeSecJoinSuccess_total,
          SUM(video_freeze_time_200) AS video_freeze_time_200_total,
          SUM(video_totaltime_200) AS video_totaltime_200_total,
          SUM(video_freeze_time_500) AS video_freeze_time_500_total,
          SUM(video_totaltime_500) AS video_totaltime_500_total,
          SUM(""3s_succ_join_session_cnt_last1"") AS ""3s_succ_join_session_cnt_last1_total"",
          SUM(""5s_succ_join_session_cnt_last1"") AS ""5s_succ_join_session_cnt_last1_total"",
          SUM(succ_join_session_cnt_last1) AS succ_join_session_cnt_last1_total,
          SUM(total_join_session_cnt_last1) AS total_join_session_cnt_last1_total,
          SUM(total_session_cnt_last1) AS total_session_cnt_last1_total,
          SUM(""1s_succ_join_ap_cnt_last1"") AS ""1s_succ_join_ap_cnt_last1_total"",
          SUM(""5s_succ_join_ap_cnt_last1"") AS ""5s_succ_join_ap_cnt_last1_total"",
          SUM(total_join_ap_cnt_last1) AS total_join_ap_cnt_last1_total,
          SUM(""3s_succ_join_session_cnt_last7"") AS ""3s_succ_join_session_cnt_last7_total"",
          SUM(""5s_succ_join_session_cnt_last7"") AS ""5s_succ_join_session_cnt_last7_total"",
          SUM(succ_join_session_cnt_last7) AS succ_join_session_cnt_last7_total,
          SUM(total_join_session_cnt_last7) AS total_join_session_cnt_last7_total,
          SUM(total_session_cnt_last7) AS total_session_cnt_last7_total,
          SUM(""1s_succ_join_ap_cnt_last7"") AS ""1s_succ_join_ap_cnt_last7_total"",
          SUM(""5s_succ_join_ap_cnt_last7"") AS ""5s_succ_join_ap_cnt_last7_total"",
          SUM(total_join_ap_cnt_last7) AS total_join_ap_cnt_last7_total,
          SUM(video_freeze_time_last1) AS video_freeze_time_last1_total,
          SUM(video_totaltime_last1) AS video_totaltime_last1_total,
          SUM(video_freeze_time_500_last1) AS video_freeze_time_500_last1_total,
          SUM(video_totaltime_500_last1) AS video_totaltime_500_last1_total,
          SUM(video_freeze_time_200_last1) AS video_freeze_time_200_last1_total,
          SUM(video_totaltime_200_last1) AS video_totaltime_200_last1_total,
          SUM(video_freeze_time_last7) AS video_freeze_time_last7_total,
          SUM(video_totaltime_last7) AS video_totaltime_last7_total,
          SUM(video_freeze_time_500_last7) AS video_freeze_time_500_last7_total,
          SUM(video_totaltime_500_last7) AS video_totaltime_500_last7_total,
          SUM(video_freeze_time_200_last7) AS video_freeze_time_200_last7_total,
          SUM(video_totaltime_200_last7) AS video_totaltime_200_last7_total,
          SUM(audio_freeze_time_last1) AS audio_freeze_time_last1_total,
          SUM(audio_totaltime_last1) AS audio_totaltime_last1_total,
          SUM(audio_freeze_time_last7) AS audio_freeze_time_last7_total,
          SUM(audio_totaltime_last7) AS audio_totaltime_last7_total,
          SUM(s2l_total_delay_sec_last1) AS s2l_total_delay_sec_last1_total,
          SUM(s2l_25ms_delay_sec_last1) AS s2l_25ms_delay_sec_last1_total,
          SUM(s2l_75ms_delay_sec_last1) AS s2l_75ms_delay_sec_last1_total,
          SUM(s2l_total_delay_sec_last7) AS s2l_total_delay_sec_last7_total,
          SUM(s2l_25ms_delay_sec_last7) AS s2l_25ms_delay_sec_last7_total,
          SUM(s2l_75ms_delay_sec_last7) AS s2l_75ms_delay_sec_last7_total,
          SUM(p2s_lost_Leq5_last1) AS p2s_lost_Leq5_last1_total,
          SUM(p2s_lost_all_last1) AS p2s_lost_all_last1_total,
          SUM(p2s_lost_Leq5_last7) AS p2s_lost_Leq5_last7_total,
          SUM(p2s_lost_all_last7) AS p2s_lost_all_last7_total,
          SUM(crash_cnt_last1) AS crash_cnt_last1_total,
          SUM(service_cnt_last1) AS service_cnt_last1_total,
          SUM(crash_cnt_last7) AS crash_cnt_last7_total,
          SUM(service_cnt_last7) AS service_cnt_last7_total,
          SUM(s2l_lost_Leq5) AS s2l_lost_Leq5_total,
          SUM(s2l_lost_all) AS s2l_lost_all_total,
          SUM(s2l_lost_Leq5_last1) AS s2l_lost_Leq5_last1_total,
          SUM(s2l_lost_all_last1) AS s2l_lost_all_last1_total,
          SUM(s2l_lost_Leq5_last7) AS s2l_lost_Leq5_last7_total,
          SUM(s2l_lost_all_last7) AS s2l_lost_all_last7_total
        FROM report_datahub.pub_levels_quality_di_1
        WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-21') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-11-21') AND CAST(tag AS VARCHAR) = 'Product'
        GROUP BY date,
          dim) AS t2 ON t1.date = t2.date AND t1.dim = t2.dim
    WHERE date_parse(cast( t1.date as VARCHAR), '%Y%m%d') >= DATE('2021-11-21') AND date_parse(cast( t1.date as VARCHAR), '%Y%m%d') <= DATE('2021-11-21') AND CAST(tag AS VARCHAR) = 'Product') AS ""自定义 SQL 查询""
  CROSS JOIN (SELECT MAX(date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d')) AS ""__measure__0""
    FROM (SELECT t1.date,
            CASE WHEN CAST(stat_period AS VARCHAR) = 'day' THEN substr(CAST(date_parse(cast( t1.date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(substr(CAST(start_date AS VARCHAR), 1, 10) AS VARCHAR), '~', CAST(substr(CAST(end_date AS VARCHAR), 1, 10) AS VARCHAR)) END AS period,
          start_date,
          end_date,
          stat_period,
          tag,
          t1.dim,
          level1,
          level2,
          level3,
          level4,
          os,
          ver,
          ver_type,
          domain,
          country,
          region,
          net,
          vid,
          project,
          company_id,
          company_name,
          rowsnum,
          lastusage,
          thisusage,
          fiveSecJoinSuccess,
          totalJoin,
          cnt_sid,
          video_freeze_time,
          video_totaltime,
          audio_freeze_time,
          audio_totaltime,
          s2l_total_delay_sec,
          s2l_25ms_delay_sec,
          s2l_75ms_delay_sec,
          p2s_lost_Leq5,
          p2s_lost_all,
          crash_cnt,
          service_cnt,
          ""1s_succ_join_ap_cnt"",
          ""5s_succ_join_ap_cnt"",
          total_join_ap_cnt,
          totalJoinSuccess,
          threeSecJoinSuccess,
          video_freeze_time_200,
          video_totaltime_200,
          video_freeze_time_500,
          video_totaltime_500,
          ""3s_succ_join_session_cnt_last1"",
          ""5s_succ_join_session_cnt_last1"",
          succ_join_session_cnt_last1,
          total_join_session_cnt_last1,
          total_session_cnt_last1,
          ""1s_succ_join_ap_cnt_last1"",
          ""5s_succ_join_ap_cnt_last1"",
          total_join_ap_cnt_last1,
          ""3s_succ_join_session_cnt_last7"",
          ""5s_succ_join_session_cnt_last7"",
          succ_join_session_cnt_last7,
          total_join_session_cnt_last7,
          total_session_cnt_last7,
          ""1s_succ_join_ap_cnt_last7"",
          ""5s_succ_join_ap_cnt_last7"",
          total_join_ap_cnt_last7,
          video_freeze_time_last1,
          video_totaltime_last1,
          video_freeze_time_500_last1,
          video_totaltime_500_last1,
          video_freeze_time_200_last1,
          video_totaltime_200_last1,
          video_freeze_time_last7,
          video_totaltime_last7,
          video_freeze_time_500_last7,
          video_totaltime_500_last7,
          video_freeze_time_200_last7,
          video_totaltime_200_last7,
          audio_freeze_time_last1,
          audio_totaltime_last1,
          audio_freeze_time_last7,
          audio_totaltime_last7,
          s2l_total_delay_sec_last1,
          s2l_25ms_delay_sec_last1,
          s2l_75ms_delay_sec_last1,
          s2l_total_delay_sec_last7,
          s2l_25ms_delay_sec_last7,
          s2l_75ms_delay_sec_last7,
          p2s_lost_Leq5_last1,
          p2s_lost_all_last1,
          p2s_lost_Leq5_last7,
          p2s_lost_all_last7,
          crash_cnt_last1,
          service_cnt_last1,
          crash_cnt_last7,
          service_cnt_last7,
          product_level1,
          product_level2,
          product_level3,
          product_level4,
          s2l_lost_Leq5,
          s2l_lost_all,
          s2l_lost_Leq5_last1,
          s2l_lost_all_last1,
          s2l_lost_Leq5_last7,
          s2l_lost_all_last7,
          fiveSecJoinSuccess_total,
          totalJoin_total,
          cnt_sid_total,
          video_freeze_time_total,
          video_totaltime_total,
          audio_freeze_time_total,
          audio_totaltime_total,
          s2l_total_delay_sec_total,
          s2l_25ms_delay_sec_total,
          s2l_75ms_delay_sec_total,
          p2s_lost_Leq5_total,
          p2s_lost_all_total,
          crash_cnt_total,
          service_cnt_total,
          ""1s_succ_join_ap_cnt_total"",
          ""5s_succ_join_ap_cnt_total"",
          total_join_ap_cnt_total,
          totalJoinSuccess_total,
          threeSecJoinSuccess_total,
          video_freeze_time_200_total,
          video_totaltime_200_total,
          video_freeze_time_500_total,
          video_totaltime_500_total,
          ""3s_succ_join_session_cnt_last1_total"",
          ""5s_succ_join_session_cnt_last1_total"",
          succ_join_session_cnt_last1_total,
          total_join_session_cnt_last1_total,
          total_session_cnt_last1_total,
          ""1s_succ_join_ap_cnt_last1_total"",
          ""5s_succ_join_ap_cnt_last1_total"",
          total_join_ap_cnt_last1_total,
          ""3s_succ_join_session_cnt_last7_total"",
          ""5s_succ_join_session_cnt_last7_total"",
          succ_join_session_cnt_last7_total,
          total_join_session_cnt_last7_total,
          total_session_cnt_last7_total,
          ""1s_succ_join_ap_cnt_last7_total"",
          ""5s_succ_join_ap_cnt_last7_total"",
          total_join_ap_cnt_last7_total,
          video_freeze_time_last1_total,
          video_totaltime_last1_total,
          video_freeze_time_500_last1_total,
          video_totaltime_500_last1_total,
          video_freeze_time_200_last1_total,
          video_totaltime_200_last1_total,
          video_freeze_time_last7_total,
          video_totaltime_last7_total,
          video_freeze_time_500_last7_total,
          video_totaltime_500_last7_total,
          video_freeze_time_200_last7_total,
          video_totaltime_200_last7_total,
          audio_freeze_time_last1_total,
          audio_totaltime_last1_total,
          audio_freeze_time_last7_total,
          audio_totaltime_last7_total,
          s2l_total_delay_sec_last1_total,
          s2l_25ms_delay_sec_last1_total,
          s2l_75ms_delay_sec_last1_total,
          s2l_total_delay_sec_last7_total,
          s2l_25ms_delay_sec_last7_total,
          s2l_75ms_delay_sec_last7_total,
          p2s_lost_Leq5_last1_total,
          p2s_lost_all_last1_total,
          p2s_lost_Leq5_last7_total,
          p2s_lost_all_last7_total,
          crash_cnt_last1_total,
          service_cnt_last1_total,
          crash_cnt_last7_total,
          service_cnt_last7_total,
          s2l_lost_Leq5_total,
          s2l_lost_all_total,
          s2l_lost_Leq5_last1_total,
          s2l_lost_all_last1_total,
          s2l_lost_Leq5_last7_total,
          s2l_lost_all_last7_total
        FROM report_datahub.pub_levels_quality_di_1 AS t1
          LEFT JOIN (SELECT date,
              dim,
              SUM(fiveSecJoinSuccess) AS fiveSecJoinSuccess_total,
              SUM(totalJoin) AS totalJoin_total,
              SUM(cnt_sid) AS cnt_sid_total,
              SUM(video_freeze_time) AS video_freeze_time_total,
              SUM(video_totaltime) AS video_totaltime_total,
              SUM(audio_freeze_time) AS audio_freeze_time_total,
              SUM(audio_totaltime) AS audio_totaltime_total,
              SUM(s2l_total_delay_sec) AS s2l_total_delay_sec_total,
              SUM(s2l_25ms_delay_sec) AS s2l_25ms_delay_sec_total,
              SUM(s2l_75ms_delay_sec) AS s2l_75ms_delay_sec_total,
              SUM(p2s_lost_Leq5) AS p2s_lost_Leq5_total,
              SUM(p2s_lost_all) AS p2s_lost_all_total,
              SUM(crash_cnt) AS crash_cnt_total,
              SUM(service_cnt) AS service_cnt_total,
              SUM(""1s_succ_join_ap_cnt"") AS ""1s_succ_join_ap_cnt_total"",
              SUM(""5s_succ_join_ap_cnt"") AS ""5s_succ_join_ap_cnt_total"",
              SUM(total_join_ap_cnt) AS total_join_ap_cnt_total,
              SUM(totalJoinSuccess) AS totalJoinSuccess_total,
              SUM(threeSecJoinSuccess) AS threeSecJoinSuccess_total,
              SUM(video_freeze_time_200) AS video_freeze_time_200_total,
              SUM(video_totaltime_200) AS video_totaltime_200_total,
              SUM(video_freeze_time_500) AS video_freeze_time_500_total,
              SUM(video_totaltime_500) AS video_totaltime_500_total,
              SUM(""3s_succ_join_session_cnt_last1"") AS ""3s_succ_join_session_cnt_last1_total"",
              SUM(""5s_succ_join_session_cnt_last1"") AS ""5s_succ_join_session_cnt_last1_total"",
              SUM(succ_join_session_cnt_last1) AS succ_join_session_cnt_last1_total,
              SUM(total_join_session_cnt_last1) AS total_join_session_cnt_last1_total,
              SUM(total_session_cnt_last1) AS total_session_cnt_last1_total,
              SUM(""1s_succ_join_ap_cnt_last1"") AS ""1s_succ_join_ap_cnt_last1_total"",
              SUM(""5s_succ_join_ap_cnt_last1"") AS ""5s_succ_join_ap_cnt_last1_total"",
              SUM(total_join_ap_cnt_last1) AS total_join_ap_cnt_last1_total,
              SUM(""3s_succ_join_session_cnt_last7"") AS ""3s_succ_join_session_cnt_last7_total"",
              SUM(""5s_succ_join_session_cnt_last7"") AS ""5s_succ_join_session_cnt_last7_total"",
              SUM(succ_join_session_cnt_last7) AS succ_join_session_cnt_last7_total,
              SUM(total_join_session_cnt_last7) AS total_join_session_cnt_last7_total,
              SUM(total_session_cnt_last7) AS total_session_cnt_last7_total,
              SUM(""1s_succ_join_ap_cnt_last7"") AS ""1s_succ_join_ap_cnt_last7_total"",
              SUM(""5s_succ_join_ap_cnt_last7"") AS ""5s_succ_join_ap_cnt_last7_total"",
              SUM(total_join_ap_cnt_last7) AS total_join_ap_cnt_last7_total,
              SUM(video_freeze_time_last1) AS video_freeze_time_last1_total,
              SUM(video_totaltime_last1) AS video_totaltime_last1_total,
              SUM(video_freeze_time_500_last1) AS video_freeze_time_500_last1_total,
              SUM(video_totaltime_500_last1) AS video_totaltime_500_last1_total,
              SUM(video_freeze_time_200_last1) AS video_freeze_time_200_last1_total,
              SUM(video_totaltime_200_last1) AS video_totaltime_200_last1_total,
              SUM(video_freeze_time_last7) AS video_freeze_time_last7_total,
              SUM(video_totaltime_last7) AS video_totaltime_last7_total,
              SUM(video_freeze_time_500_last7) AS video_freeze_time_500_last7_total,
              SUM(video_totaltime_500_last7) AS video_totaltime_500_last7_total,
              SUM(video_freeze_time_200_last7) AS video_freeze_time_200_last7_total,
              SUM(video_totaltime_200_last7) AS video_totaltime_200_last7_total,
              SUM(audio_freeze_time_last1) AS audio_freeze_time_last1_total,
              SUM(audio_totaltime_last1) AS audio_totaltime_last1_total,
              SUM(audio_freeze_time_last7) AS audio_freeze_time_last7_total,
              SUM(audio_totaltime_last7) AS audio_totaltime_last7_total,
              SUM(s2l_total_delay_sec_last1) AS s2l_total_delay_sec_last1_total,
              SUM(s2l_25ms_delay_sec_last1) AS s2l_25ms_delay_sec_last1_total,
              SUM(s2l_75ms_delay_sec_last1) AS s2l_75ms_delay_sec_last1_total,
              SUM(s2l_total_delay_sec_last7) AS s2l_total_delay_sec_last7_total,
              SUM(s2l_25ms_delay_sec_last7) AS s2l_25ms_delay_sec_last7_total,
              SUM(s2l_75ms_delay_sec_last7) AS s2l_75ms_delay_sec_last7_total,
              SUM(p2s_lost_Leq5_last1) AS p2s_lost_Leq5_last1_total,
              SUM(p2s_lost_all_last1) AS p2s_lost_all_last1_total,
              SUM(p2s_lost_Leq5_last7) AS p2s_lost_Leq5_last7_total,
              SUM(p2s_lost_all_last7) AS p2s_lost_all_last7_total,
              SUM(crash_cnt_last1) AS crash_cnt_last1_total,
              SUM(service_cnt_last1) AS service_cnt_last1_total,
              SUM(crash_cnt_last7) AS crash_cnt_last7_total,
              SUM(service_cnt_last7) AS service_cnt_last7_total,
              SUM(s2l_lost_Leq5) AS s2l_lost_Leq5_total,
              SUM(s2l_lost_all) AS s2l_lost_all_total,
              SUM(s2l_lost_Leq5_last1) AS s2l_lost_Leq5_last1_total,
              SUM(s2l_lost_all_last1) AS s2l_lost_all_last1_total,
              SUM(s2l_lost_Leq5_last7) AS s2l_lost_Leq5_last7_total,
              SUM(s2l_lost_all_last7) AS s2l_lost_all_last7_total
            FROM report_datahub.pub_levels_quality_di_1
            WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-21') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-11-21') AND CAST(tag AS VARCHAR) = 'Product'
            GROUP BY date,
              dim) AS t2 ON t1.date = t2.date AND t1.dim = t2.dim
        WHERE date_parse(cast( t1.date as VARCHAR), '%Y%m%d') >= DATE('2021-11-21') AND date_parse(cast( t1.date as VARCHAR), '%Y%m%d') <= DATE('2021-11-21') AND CAST(tag AS VARCHAR) = 'Product') AS ""自定义 SQL 查询""
    HAVING COUNT(1) > 0) AS ""t0""
WHERE CASE WHEN CAST(""自定义 SQL 查询"".""tag"" AS VARCHAR) = 'Industry' AND CAST(""自定义 SQL 查询"".""product_level1"" AS VARCHAR) = 'RTC' AND CAST(""自定义 SQL 查询"".""dim"" AS VARCHAR) = 'osver' THEN 0 WHEN CAST(""自定义 SQL 查询"".""tag"" AS VARCHAR) = 'VerType' AND CAST(""自定义 SQL 查询"".""product_level1"" AS VARCHAR) = 'RTC' AND CAST(""自定义 SQL 查询"".""dim"" AS VARCHAR) = 'osver' THEN 0 WHEN CAST(""自定义 SQL 查询"".""tag"" AS VARCHAR) = 'Product' AND CAST(""自定义 SQL 查询"".""dim"" AS VARCHAR) = 'osver' AND CAST(""自定义 SQL 查询"".""product_level1"" AS VARCHAR) = 'RTC' THEN 1 ELSE 0 END AND CAST(""自定义 SQL 查询"".""level2"" AS VARCHAR) = 'Native' AND DATE_ADD('SECOND', 0, date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d')) = DATE_ADD('SECOND', 0, ""t0"".""__measure__0"")
HAVING COUNT(1) > 0"
"SELECT SUM(""自定义 SQL 查询"".""p2s_Delay25"" * ""自定义 SQL 查询"".""delay_total"") AS ""TEMP(Calculation_1231523447811919872)(1563607262)(0)"",
  SUM(""自定义 SQL 查询"".""delay_total"") AS ""TEMP(Calculation_1231523447811919872)(363980608)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_Delay50"" * ""自定义 SQL 查询"".""delay_total"") AS ""TEMP(Calculation_1231523447812059137)(1551638771)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_Delay75"" * ""自定义 SQL 查询"".""delay_total"") AS ""TEMP(Calculation_1231523447812194306)(2562427304)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_lostRatio"" * ""自定义 SQL 查询"".""p2s_total"") AS ""TEMP(Calculation_1231523447812321283)(1741181994)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_total"") AS ""TEMP(Calculation_1231523447812321283)(2624355999)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_Delay125"" * ""自定义 SQL 查询"".""delay_total"") AS ""TEMP(Calculation_4208191644284768271)(3242688810)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_Delay150"" * ""自定义 SQL 查询"".""delay_total"") AS ""TEMP(Calculation_4208191644285206544)(1276673441)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_jitter95_50"" * ""自定义 SQL 查询"".""jitter95_total"") AS ""TEMP(Calculation_4208191644285542417)(1652714847)(0)"",
  SUM(""自定义 SQL 查询"".""jitter95_total"") AS ""TEMP(Calculation_4208191644285542417)(633698484)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_jitter95_100"" * ""自定义 SQL 查询"".""jitter95_total"") AS ""TEMP(Calculation_4208191644285714450)(3609783325)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_jitter95_200"" * ""自定义 SQL 查询"".""jitter95_total"") AS ""TEMP(Calculation_4208191644285919251)(206867949)(0)"",
  ""自定义 SQL 查询"".""srcCountry"" AS ""srcCountry"",
  ""自定义 SQL 查询"".""srcDomain"" AS ""srcDomain"",
  ""自定义 SQL 查询"".""srcisp"" AS ""srcisp"",
  SUM(""自定义 SQL 查询"".""p2s_total"") AS ""sum_p2s_total_ok""
FROM (SELECT date AS ""date"",
      src_domain AS ""srcDomain"",
      src_country AS ""srcCountry"",
      dest_idc AS ""idc"",
      speaker_ip_isp AS ""srcisp"",
      speaker_vos_ip,
      delay_25 AS ""p2s_Delay25"",
      delay_50 AS ""p2s_Delay50"",
      delay_75 AS ""p2s_Delay75"",
      delay_100 AS ""p2s_Delay100"",
      delay_125 AS ""p2s_Delay125"",
      delay_150 AS ""p2s_Delay150"",
      delay_total,
      lost_ratio_5 AS ""p2s_lostRatio"",
      lostratio_total AS ""p2s_total"",
      jitter95_50 AS ""p2s_jitter95_50"",
      jitter95_100 AS ""p2s_jitter95_100"",
      jitter95_200 AS ""p2s_jitter95_200"",
      jitter95_300 AS ""p2s_jitter95_300"",
      jitter95_total,
      product_line,
      product_type
    FROM media.p2s_cover_oversea_ip
    WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-25') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-01')) AS ""自定义 SQL 查询""
WHERE ""自定义 SQL 查询"".""srcisp"" IN ('1telecom.com.br', '21.com.pk', '3s.com.tn', '4inet.com.br', '73s.com.br', 'a1.by', 'a1.si', 'a3.se', 'aan-ict.com', 'aapt.com.au', 'abcom.al', 'absolutnet.com.br', 'accesshaiti.com', 'acelerate.com', 'acertelecom.com.br', 'acesso10.net.br', 'acessotelecomunicacoes.com.br', 'actcorp.in', 'afghan-wireless.com', 'afghantelecom.af', 'africell.ug', 'afriqnetworks.co.ke', 'agatangelo.com.br', 'agni.com', 'aguasdelcolorado-lp.com.ar', 'airmax.com.pk', 'airnet.net.br', 'airtel.cd', 'airtel.cg', 'airtel.co.rw', 'airtel.co.tz', 'airtel.co.ug', 'airtel.co.zm', 'airtel.com', 'airtel.mg', 'airtel.mw', 'airtel.ne', 'airtel.td', 'ais.co.th', 'aknet.kg', 'albtelecom.al', 'alfa.com.lb', 'alfanet.az', 'alfanet.tv', 'algartelecom.com.br', 'algerietelecom.dz', 'ALIYUN', 'aljeel.ly', 'allconecta.com.br', 'allo.my', 'almadarisp.com', 'aloo.com.br', 'alriyada-net.net', 'alsardfiber.com', 'altanettelecom.com.br', 'altice.com.do', 'amatelecom.com.br', 'amazon.com', 'americanet.com.br', 'americatel.com.pe', 'amorimtelecom.com.br', 'amplia.co.tt', 'amturbonet.com.br', 'anditel.com.co', 'angolacables.co.ao', 'ans.af', 'antel.com.uy', 'aoun-networks.com', 'apsfl.in', 'aptg.com.tw', 'aranetinfo.com.br', 'ariasat.af', 'ariastelecom.com.br', 'ario.net', 'arn.dz', 'arsat.com.ar', 'artnet.pl', 'asiabtelecom.com', 'asiacell.com', 'asianvision.com.ph', 'ask4.com', 'asnet.com.br', 'asolucaoinfo.com.br', 'aster.com.do', 'ativanetwork.com.br', 'att.com', 'avantel.co', 'avianet.com.br', 'awasr.com', 'aya.sy', 'azercell.com', 'azeronline.com', 'azeurotel.com', 'azqtel.com', 'azstarnet.az', 'aztecacomunicaciones.com', 'aztelekom.az', 'babilon-t.tj', 'baehost.com', 'baghdad-link.com', 'bakcell.com', 'baktelecom.az', 'baktun.com.gt', 'batelco.com', 'bayan.com.ph', 'beeline.am', 'beeline.kg', 'beeline.kz', 'beeline.ru', 'beeline.tj', 'beeline.uz', 'belizetelemedia.net', 'beltelecom.by', 'beskidmedia.pl', 'bezeqint.net', 'bhtelecom.ba', 'bitakat.sy', 'bitcom.psi.br', 'bitel.com.pe', 'blinkload.cloud', 'blue.net.gt', 'bmjnet.com.br', 'bnet.ps', 'bouyguestelecom.fr', 'brasilinfo.net.br', 'brasilnetcp.net.br', 'brasnetinformatica.com.br', 'brcentral.com.br', 'bredband2.com', 'brisanet.com.br', 'brsite.com.br', 'brxtelecom.com.br', 'bsnl.co.in', 'bt.bt', 'bt.com', 'btc.bw', 'btcbahamas.com', 'buana.net', 'buechele-networks.de', 'bvitourism.com', 'bwtelecom.com', 'cabangu.com.br', 'cablebahamas.com', 'cablecolor.hn', 'cabledelancer.com', 'cabledelnorte.com', 'cablelink.com.ph', 'cablemar.net', 'cablemax.com.do', 'cablenet.com.cy', 'cableonda.com', 'cableondaoriental.com', 'cabletica.com', 'cablevision.com.ar', 'canal-plus.com', 'canar.sd', 'cantv.com.ve', 'caribcable.com', 'caribserve.net', 'caxiasontelecom.com.br', 'cdn77.com', 'cdns.net', 'cednet.com.br', 'celcom.com.my', 'cell-net.net', 'cellc.co.za', 'cellcom.co.il', 'centraltv.bz', 'centurylink.com', 'ceranetworks.com', 'ceretechs.com', 'charter.com', 'ChinaMobile', 'ChinaTelecom', 'ChinaUnicom', 'chinguitel.mr', 'chltech.net', 'choopa.com', 'cht.com.tw', 'citicableworld.com', 'claro.com.ar', 'claro.com.br', 'claro.com.co', 'claro.com.do', 'claro.com.ec', 'claro.com.gt', 'claro.com.hn', 'claro.com.ni', 'claro.com.pa', 'claro.com.pe', 'claro.com.sv', 'claro.cr', 'clarochile.cl', 'claropr.com', 'clearpath.net.ph', 'clig.com.br', 'clnetworks-sa.com', 'cloudflare.com', 'cloudinnovation.org', 'clouvider.co.uk', 'clubnet.co.mz', 'cmet.net', 'cnet.af', 'cnt.gob.ec', 'cogentco.com', 'colombiamastv.co', 'colombiatel.co', 'colsecor.com.ar', 'comcast.com', 'comhem.se', 'comnt.com.br', 'comteco.com.bo', 'conectaminas.com.br', 'conectbm.com.br', 'conectcor.com.br', 'conective.sv', 'conexaotelecom.net.br', 'connect.az', 'connect.net.pk', 'connecti.net.br', 'connectinternet.com.br', 'conquesttelecom.com.br', 'convergeict.com', 'convergenze.it', 'coolnet.ps', 'coopetel.org', 'cooptortu.com.ar', 'copaco.com.py', 'copeltelecom.com', 'cosmote.gr', 'costadosol.tv.br', 'cotas.com', 'cotecal.com.ar', 'cotel.bo', 'cprm.net', 'csuc.cat', 'cte.net.br', 'cwc.com', 'cwnetworks.com', 'cwpanama.com', 'cyber.net.pk', 'cyberia.net.lb', 'cyberwave.com.ar', 'dascacable.com', 'datanet.iq', 'dauphintelecom.com', 'davitel.com.ar', 'dcc.ps', 'dctv.com.ph', 'delta-telecom.net', 'delta-x.ua', 'desktop.com.br', 'destinycable.com.ph', 'dflash.com.br', 'dialnet.net', 'dialog.lk', 'digi.com.my', 'digicelgroup.com', 'digimobil.es', 'digital-vm.com', 'digitalocean.com', 'digitel.com.ve', 'digitel.ph', 'dimensiondata.com', 'directv.com.ar', 'directvla.com.co', 'discoverflow.co', 'dishtele.com', 'djiboutitelecom.dj', 'dna.fi', 'docomopacific.com', 'domru.ru', 'DRPENG', 'dtac.co.th', 'du.ae', 'dumaimandirinet.id', 'e-lcom.sy', 'eaglenet.net.lb', 'earthlink.iq', 'eastlink.ca', 'ecom.net.do', 'edatel.com.co', 'ee.co.uk', 'elcat.kg', 'elisa.ee', 'elsuhdnet.com', 'embratel.com.br', 'emcali.net.co', 'emtel.net.co', 'engeplus.com.br', 'enlacevision.com', 'enredhn.com', 'entel.bo', 'entel.cl', 'entel.pe', 'enteriw.com.br', 'ert.com.co', 'estnoc.ee', 'estrelatel.com', 'etapa.net.ec', 'etb.com', 'etecsa.cu', 'ethiotelecom.et', 'ethtelecom.com.br', 'etisalat.ae', 'etisalat.af', 'etisalat.eg', 'etllao.com', 'evo.uz', 'exitovision.com', 'expand.tv.br', 'express.com.ar', 'faciliti.com.br', 'falco-networks.com', 'farahnet.net.lb', 'fariya.com', 'farsroute.af', 'fastiraq.com', 'fastnetisp.com', 'fastprovedor.net.br', 'fdnet.com.br', 'fetnet.net', 'fiber-sat.net', 'fiberathome.my', 'fiberbandalarga.com.br', 'fibercom.com.pk', 'fibergrid.net', 'fiberlink.net.pk', 'fibernet.uz', 'fibertelecom-isp.com.br', 'fiberwaves.com', 'fiberway.com.ar', 'fiberx.net', 'fibra1.com.br', 'fibralink.com.br', 'fibranet.ec', 'filprod-dgte.ph', 'fittelecom.com.br', 'flashfibra.net.br', 'flink.uz', 'flx.com.pe', 'flybyte.com.br', 'foaaa.com', 'forthnet.gr', 'fourtelecom.com', 'free.fr', 'freenet-group.de', 'fsmtc.fm', 'ft.fo', 'fusion.ps', 'g8.net.br', 'gals.uz', 'gcore.lu', 'gd.tt', 'gegatelecom.net', 'gemzo.ps', 'genettelecom.net.br', 'gerrys.net', 'gigaline.com.br', 'gigalink.com.br', 'giganor.com', 'gigared.com.ar', 'gironetfibra.com.br', 'glink.net.br', 'glnet.com.br', 'global-layer.com', 'globe.com.ph', 'globenet.net', 'gloworld.com', 'glpnet.com.br', 'gmo.jp', 'go.com.mt', 'godnet.com.br', 'golddata.net', 'google.com', 'goonet.com.br', 'gorannet.net', 'gptc.ly', 'grajaunet.com.br', 'grameenphone.com', 'gramnet.com.br', 'groupnet-iq.com', 'gruponewlife.com.br', 'grupotvcable.com', 'gtd.cl', 'gthost.com', 'gtt.co.gy', 'gtt.net', 'guestchoicerd.com', 'hadara.ps', 'halasat.net', 'hayat-isp.net', 'hbinfo.com.br', 'heficed.com', 'hetzner.com', 'highspeed.com.tr', 'hilink.com.br', 'holistica.com.br', 'homenet.cl', 'homenet.sumy.ua', 'hondutel.hn', 'hopnet.com.br', 'hormuud.com', 'hosteam.pl', 'hosteurope.de', 'hostroyale.com', 'hotnet.net.il', 'hrins.net', 'hughes.com', 'hughes.com.br', 'hvtv.co', 'hypernet.sy', 'i-tower.net', 'iam.ma', 'ibaaco.net', 'ibitelecom.com.br', 'ibiunet.com.br', 'ibw.com.ni', 'ice.no', 'iclik.co', 'ideay.com', 'idm.net.lb', 'ifxnetworks.com', 'ifxnw.com.ve', 'iij.ad.jp', 'iinet.net.au', 'impactnet.com.br', 'indosatooredoo.com', 'inea.pl', 'inet.sy', 'inethn.com', 'inetminas.com.br', 'infinity.iq', 'infologti.com.br', 'infonet.ee', 'infornet.in', 'instatelecom.com', 'intelsat.com', 'inter.com.ve', 'interbourg.com.ar', 'interconnects.us', 'interlink.com.ar', 'internexa.com', 'internexsolutions.com', 'internext.cz', 'intesanet.net', 'inwi.ma', 'io-global.com', 'iomart.com', 'iontel.ly', 'ip.ro', 'iparatodos.com.ar', 'ipc.ph', 'ipcore.com.my', 'iplan.com.ar', 'iptp.net', 'iqnet.com', 'iranettelecom.com.br', 'is.com.gh', 'istanbuldc.com', 'istv.uz', 'it7.net', 'ite.net', 'itelkom.co', 'itldc.com', 'itsbrasil.net', 'iveloz.net.br', 'ivitelecom.com.br', 'jdimax.com', 'jetnet.ps', 'jhcs.com', 'jio.com', 'jotazo.com.br', 'jpproviders.com.br', 'jrconect.com', 'jt.iq', 'jtglobal.com', 'juquianet.net.br', 'k2telecom.com.br', 'kabayancablegroup.com', 'kalibocable.net', 'kamatera.com', 'kaopuyun.com', 'karibcable.com', 'katv1.com', 'knet-telecom.com', 'korektel.com', 'kt.kg', 'kyivstar.ua', 'lagoon.nc', 'laotel.com', 'lazertelecom.com', 'leadertelecom.ru', 'leaseweb.com', 'level3.com', 'libyana.ly', 'ligue.net', 'link.net.pk', 'linkem.com', 'linode.com', 'linxbr.com.br', 'liquidtelecom.com', 'liquidtelecom.net', 'litc.ly', 'litoraltibau.com.br', 'lizcat.com', 'logic.ky', 'logicweb.com', 'logix.com', 'loina.wf', 'lonsdalenet.co.uk', 'lpinternet.com.br', 'lpnet.com.br', 'ltt.ly', 'lunasat.com', 'm247.com', 'mada.ps', 'maisinternet.net.br', 'maisprovedor.com.br', 'maksnet.net', 'marandu.com.ar', 'masaratcom.com', 'masternet.net.br', 'matelecon.com.br', 'matosnet.com.br', 'matrixisp.com', 'mavnet.com.br', 'maxcomm.com.br', 'maxis.com.my', 'mayatama.net', 'mbgtecnologias.com.br', 'mc.inf.br', 'mc.net.co', 'mediaserv.com', 'megacable.com.ar', 'megacable.com.mx', 'megacom.kg', 'megafon.ru', 'megafon.tj', 'megaline.kg', 'megalinkcorp.com.br', 'meganetsalto.com.br', 'megared.com.gt', 'melita.com', 'metronethn.com', 'metrotel.com.ar', 'metrotel.com.co', 'mhnet.com.br', 'microsoft.com', 'microtell.com.br', 'mimonet.com.br', 'minasnet.net', 'mksnet.com.br', 'mnets.net', 'mobi.net.lb', 'mobile.free.fr', 'mobilinkgsm.com', 'mobily.com.sa', 'mobitel.lk', 'mobtelecom.com.br', 'mountainview.com.ph', 'movistar.com.pa', 'mrynet.com.br', 'mtilabs.com', 'mtn.ci', 'mtn.co.rw', 'mtn.co.ug', 'mtn.com.af', 'mtn.com.gh', 'mtn.com.sy', 'mtn.sd', 'mtncongo.net', 'mtnirancell.ir', 'mtnonline.com', 'mts.rs', 'mts.ru', 'mts.ua', 'multicablehonduras.com', 'multiplaytelecom.com.br', 'mundopacifico.cl', 'musurit.com', 'myrepublic.net', 'mysky.com.ph', 'nar.az', 'natcom.com.ht', 'nawand.net', 'nayatel.com', 'neda.af', 'nedetel.net', 'neotel.co.za', 'net.sy', 'net11.com.br', 'netbarretos.com.br', 'netcartelecom.com.br', 'netco.uz', 'netcomplusve.com', 'netfibra.com', 'netfibratelecomunicacoes.com.br', 'netforcetelecom.com.br', 'netglobal.it', 'netia.pl', 'netiontelecom.com.br', 'netiq.sk', 'netlife.ec', 'netlinetelecom.com.br', 'netprolb.com', 'netsaojose.com.br', 'netseg.net.br', 'netserv.com.br', 'netstream.ps', 'netuno.net', 'neunet.com.ar', 'newcloudnetworks.com', 'newertech.com.br', 'newnet.psi.br', 'newroztelecom.com', 'newstarmax.ps', 'nextel.com.br', 'nextnetwork.com.br', 'nexttel.cm', 'nile-online.com', 'nipcable.com.br', 'niponet.com.br', 'niqturbo.com.br', 'nmultifibra.com.br', 'nortech.com.ar', 'northtelecom.af', 'nortis.ma', 'nos.pt', 'nova.is', 'novafibratelecom.com.br', 'novanetwork.com.br', 'ntcnet.com.br', 'nterconexionhn.com', 'nurtelecom.kg', 'oeste-rede.com.br', 'oesteline.com.br', 'oi.com.br', 'olafibra.com.br', 'omantel.om', 'omni.net.br', 'omniya.sy', 'omnya.co', 'onatel.bf', 'onemax.com', 'online.net', 'online.net.br', 'onnethn.com', 'oops.tv.br', 'ooredoo.com.mm', 'ooredoo.om', 'ooredoo.qa', 'ooredoo.tn', 'opstelecom.com.br', 'opt.nc', 'optus.com.au', 'oracle.com', 'orange-bissau.com', 'orange.bf', 'orange.cd', 'orange.ci', 'orange.com', 'orange.eg', 'orange.jo', 'orange.ma', 'orange.mg', 'orange.ne', 'orange.pl', 'orange.ps', 'orange.sk', 'orange.tn', 'orangemali.com', 'orbitcable.com.do', 'orbitelecom.com.br', 'oriontelekom.rs', 'outremer-telecom.fr', 'ovh.com', 'paikltd.com', 'palautelecoms.com', 'paltel.ps', 'palwifi.net', 'pandanetwork.com.br', 'pccw.com', 'personal.com.py', 'petaexpress.com', 'petrynet.com.br', 'pinspb.ru', 'pirmamgroup.com', 'planetcabletv.com', 'platinum.uz', 'play.pl', 'pldt.com', 'plus.pl', 'plusnetfoz.com', 'pnccpalau.com', 'pointtelecom.com.br', 'post.lu', 'powerline.com.br', 'powernetsolutions.com.br', 'pratatelecom.com.br', 'predialnet.com.br', 'primatecmt.com.br', 'privatelayer.com', 'privax.com', 'prodatanet.com.ph', 'prokk.net', 'provale.com.br', 'provedorsuperconnect.com.br', 'provedoruniversal.com.br', 'providersnet.com.br', 'psn.co.id', 'psychz.net', 'ptcl.com.pk', 'puntonet.ec', 'qitelecom.net.br', 'qnax.com.br', 'qubee.com.pk', 'quick.com.br', 'quickline.ch', 'radiolan.sk', 'ragtek.com.br', 'rahanet.af', 'ramnet.com.br', 'rapidatelecom.com.br', 'razaoinfo.com.br', 'rdconlinebd.net', 'redecom.net.br', 'redenilf.com.br', 'redetelecom.com.br', 'redfoxtelecom.com.br', 'redintercable.com.ar', 'researchsrl.com.ar', 'rightel.ir', 'riotel.com.ar', 'rmsconnect.net.br', 'rnova.com.br', 'rnp.br', 'robi.com.bd', 'rogers.com', 'roshan.af', 'royalcable.com.ph', 'rsonet.com.ar', 'rt.ru', 'runnet.sy', 'rvrnetworks.com', 'sadattelecom.af', 'safaricom.co.ke', 'salartel.com', 'salestelecom.net.br', 'samanet.sy', 'sanluisctv.com.ar', 'sattrakt.com', 'sawaisp.sy', 'sbb.rs', 'sco.gov.pk', 'sconfibras.com.br', 'scopesky.com', 'scrio.com.br', 'scs-net.org', 'seacom.mu', 'sebratel.com.br', 'sepcom.com.co', 'sercomtel.com.br', 'ses.com', 'seven-sky.net', 'sfox.com.br', 'sfr.com', 'sfr.re', 'sglinknet.com.br', 'shams-tele.com', 'sharktech.net', 'sigmanet.com.br', 'simbanet.net', 'simbatv.co.ug', 'sinusnet.pl', 'sion.com', 'sitel.com.br', 'sjnettelecom.com.br', 'sky.com', 'sky.com.br', 'sky.net.co', 'skylogic.it', 'skylonhost.com', 'skyonline.net.ar', 'slt.lk', 'smart-bz.com', 'smart.com.ph', 'smartlink-isp.com', 'smartwavesnetwork.com', 'sobralnet.com.br', 'socitel.com.br', 'sodobrasil.net.br', 'softether.jp', 'softlinknet.com', 'sol.az', 'solucaonetwork.com', 'solunet.com.ar', 'somtelnetwork.net', 'sonatel.sn', 'speedclick.ps', 'speedjettelecom.com.br', 'speednetcomunicacoes.com.br', 'speedrs.com.br', 'spinservers.com', 'splink.net.br', 'sprint.com', 'st.uz', 'stantelecom.net', 'star1.com.br', 'starcommunicationbd.com', 'starktel.com', 'starman.com.br', 'starnet.cz', 'starnettelecom.com.br', 'stationnet.com.br', 'stc.com.sa', 'stem.co.za', 'strongvpn.com', 'stv.ee', 'suanet.net.br', 'suatelecom.com.br', 'sudatel.sd', 'sudatel.sn', 'sudoestetelecom.com.br', 'sumicity.net.br', 'supercable.com.ve', 'supercabotv.com.br', 'supercanal-arlink.com.ar', 'supercellnetwork.com', 'superlink.ps', 'superonline.net', 'supranet.com.br', 'sure.com', 'surfshark.com', 'swan.sk', 'swisscom.ch', 'sygo.com.br', 'synapsecom.gr', 'syriatel.sy', 't-mobile.com', 't-mobile.cz', 't-mobile.pl', 't1chihuahua.com', 'tajnet.tj', 'takamol.sy', 'talia.net', 'talktalkgroup.com', 'tangerine.co.ug', 'tarinnet.info', 'tascom.com.br', 'tashicell.com', 'tbtelecom.net.br', 'tca.com.br', 'tcell.tj', 'tchenet.net', 'tcheturbo.com.br', 'tci.ir', 'tct.ir', 'tcvnet.com.br', 'tdc.dk', 'tdkom.com.br', 'techcomprovedor.com.br', 'tecnologiasvirtuales.com', 'tedata.net', 'teko.com.ni', 'telbru.com.bn', 'telconet.ec', 'telcorp.com.ve', 'tele2.com', 'tele2.kz', 'tele2.ru', 'telebras.com.br', 'telebucaramanga.com.co', 'telecablecentral.com', 'telecablecr.com', 'telecablelaunion.com', 'telecel-rca.com', 'telecelfaso.bf', 'telecentro.com.ar', 'telecom.com.ar', 'telecom.kz', 'telecom.pt', 'telecom.tm', 'telecomdados.com.br', 'telecomitalia.it', 'telecomitalia.sm', 'telecomprovider.com.br', 'telefonica.co', 'telefonica.com', 'telefonica.com.pe', 'telefonica.es', 'telefonicachile.cl', 'teleguam.net', 'teleimagensatelital.com', 'telekom.de', 'telekom.hu', 'telekom.mk', 'telekom.sk', 'telemach.si', 'telemgroup.sx', 'telemontv.com', 'telenet.be', 'telenor.com', 'telenor.com.pk', 'telenor.rs', 'telenord.com', 'telepost.gl', 'telered.com.ar', 'telesis.hn', 'telesur.sr', 'televiaducto.com.do', 'teleyemen.com.ye', 'telia.com', 'telia.ee', 'telium.com.br', 'telkom.co.id', 'telkomsel.com', 'tellcorpce.com.br', 'telmex.com', 'telmexchile.cl', 'telnets.com.br', 'telpin.com.ar', 'telstra.com', 'telsur.cl', 'telvgg.coop', 'tely.com.br', 'tencent.com', 'tepenet.com.tr', 'terra.net.lb', 'terratransit.de', 'tfl.com.fj', 'thecable.net', 'thegeniusisp.com', 'thglobalvision.net', 'thinkhuge.net', 'thsprovider.com.br', 'thundertecnologia.com.br', 'tigo.co.rw', 'tigo.com.bo', 'tigo.com.co', 'tigo.com.gt', 'tigo.com.hn', 'tigo.com.py', 'tigo.com.sv', 'tigo.cr', 'tigo.sn', 'tigrisnet.net', 'tim.com.br', 'time.com.my', 'timortelecom.tl', 'tiqanyatalshabaka.com', 'titania.com.br', 'tixtelecom.com.br', 'tm.com.my', 'togotelecom.tg', 'toledonet.com.br', 'tolrs.com.br', 'topcomunications.com', 'topnet.tn', 'tot.co.th', 'totalplay.com.mx', 'toya.net.pl', 'tpg.com.au', 'tpp.com.ar', 'tps.uz', 'transdatelecom.com', 'transeurocom.az', 'transnexa.com', 'tre.se', 'tremnet.com.br', 'tri.co.id', 'trixnet.com.br', 'truecorp.co.th', 'tstt.co.tt', 'tsukaeru.net', 'ttcl.co.tz', 'tunisietelecom.tn', 'turbonetwifi.com.br', 'turk.net', 'turkcell.com.tr', 'turktelekom.com.tr', 'turontelecom.uz', 'tvc.tv.br', 'tvkhajnowka.pl', 'tvn.tv.br', 'tvsom.com.br', 'tw1.com', 'twmbroadband.com', 'u.com.my', 'uatelecom.af', 'ucell.uz', 'ufinet.com', 'ufone.com', 'ukrtelecom.ua', 'ultranetpb.com.br', 'umniah.com', 'unartel.cz', 'une.com.co', 'unifi.com.my', 'unifique.com.br', 'unitel.com.la', 'uniteltmais.cv', 'unonet.com.br', 'unusinc.com', 'uolsinectis.com.ar', 'upc.at', 'upc.cz', 'upcspl.in', 'upfournet.com.br', 'upnettelecom.net.br', 'usatv.port48.com', 'uts.cw', 'uztelecom.uz', 'vcnetwork.com.br', 'verizon.com', 'vextelecom.com.br', 'vh.net', 'vi.choice-wireless.com', 'viaband.net.br', 'vianet.com.br', 'vianovatelecom.com.br', 'viaradiodourados.com.br', 'viareal.com.br', 'viettel.com.vn', 'view.sy', 'vilanovanet.com', 'vini.pf', 'vip.mk', 'vipbrtelecom.com.br', 'vipnettelecom.com.br', 'virginmedia.com', 'virginmedia.ie', 'virtex.com.br', 'visp.net.lb', 'vitaltelecom.net', 'viva.com.bh', 'viva.com.do', 'viyavi.com', 'vmnettelecom.com.br', 'vnpt.vn', 'vocetelecom.vc', 'vocus.co.nz', 'vodacom.cd', 'vodacom.co.ls', 'vodafone.com', 'vodafone.com.au', 'vodafone.com.eg', 'vodafone.com.fj', 'vodafone.com.gh', 'vodafone.de', 'vodafone.gr', 'vodafone.ie', 'vodafone.in', 'vodafone.is', 'vodafone.it', 'vodafone.qa', 'vogeltelecom.com', 'vtr.com', 'w2i.net.br', 'wananchi.com', 'wateen.com', 'wavenet-lb.net', 'webbytelecom.com.br', 'websurfer.com.np', 'wildpark.net', 'wind.com.do', 'wind.gr', 'windtelecom.com.br', 'windtre.it', 'winetbrasil.com.br', 'winfnet.com.br', 'wiretelecom.com.br', 'wise.net.lb', 'wmservice.com.do', 'worldstream.nl', 'wsinternet.com.br', 'wsnetfibra.com.br', 'wznet.com.br', 'xl.co.id', 'xolbroadband.com', 'yellownet.com.br', 'yemen.net.ye', 'yeptv.com.br', 'yes.my', 'yota.com.ni', 'zain.com', 'zamtel.zm', 'zap.cvmultimedia.cv', 'zaytona.ps', 'zenlayer.com', 'zetro.com.ar', 'ziggo.nl', 'zong.com.pk')
GROUP BY 13,
  14,
  15
HAVING CAST(CASE WHEN SUM(""自定义 SQL 查询"".""p2s_total"") >= 0 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100 THEN '0-100' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 1000 THEN '100-1000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 1000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 10000 THEN '1000-10000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 10000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100000 THEN '10000-100000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100000 THEN '100000以上' ELSE 'other' END AS VARCHAR) = '100-1000' OR CAST(CASE WHEN SUM(""自定义 SQL 查询"".""p2s_total"") >= 0 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100 THEN '0-100' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 1000 THEN '100-1000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 1000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 10000 THEN '1000-10000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 10000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100000 THEN '10000-100000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100000 THEN '100000以上' ELSE 'other' END AS VARCHAR) = '1000-10000' OR CAST(CASE WHEN SUM(""自定义 SQL 查询"".""p2s_total"") >= 0 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100 THEN '0-100' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 1000 THEN '100-1000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 1000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 10000 THEN '1000-10000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 10000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100000 THEN '10000-100000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100000 THEN '100000以上' ELSE 'other' END AS VARCHAR) = '10000-100000' OR CAST(CASE WHEN SUM(""自定义 SQL 查询"".""p2s_total"") >= 0 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100 THEN '0-100' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 1000 THEN '100-1000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 1000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 10000 THEN '1000-10000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 10000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100000 THEN '10000-100000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100000 THEN '100000以上' ELSE 'other' END AS VARCHAR) = '100000以上'"
"SELECT SUM(""自定义 SQL 查询"".""host_4k"") AS ""TEMP(Calculation_3519281700079370244)(1075454865)(0)"",
  SUM(""自定义 SQL 查询"".""audience_sd"") AS ""TEMP(Calculation_3519281700079370244)(1133678835)(0)"",
  SUM(""自定义 SQL 查询"".""host_1080p"") AS ""TEMP(Calculation_3519281700079370244)(1312501967)(0)"",
  SUM(""自定义 SQL 查询"".""host_hd"") AS ""TEMP(Calculation_3519281700079370244)(276907208)(0)"",
  SUM(""自定义 SQL 查询"".""video"") AS ""TEMP(Calculation_3519281700079370244)(2929708110)(0)"",
  SUM(""自定义 SQL 查询"".""audience_hd"") AS ""TEMP(Calculation_3519281700079370244)(2930728935)(0)"",
  SUM(""自定义 SQL 查询"".""audience_hdp"") AS ""TEMP(Calculation_3519281700079370244)(3010533957)(0)"",
  SUM(""自定义 SQL 查询"".""host_hdp"") AS ""TEMP(Calculation_3519281700079370244)(30306054)(0)"",
  SUM(""自定义 SQL 查询"".""host_audio"") AS ""TEMP(Calculation_3519281700079370244)(3087054365)(0)"",
  SUM(""自定义 SQL 查询"".""audio"") AS ""TEMP(Calculation_3519281700079370244)(3299350010)(0)"",
  SUM(""自定义 SQL 查询"".""audience_1080p"") AS ""TEMP(Calculation_3519281700079370244)(3628946582)(0)"",
  SUM(""自定义 SQL 查询"".""totalUsage"") AS ""TEMP(Calculation_3519281700079370244)(3847882359)(0)"",
  SUM(""自定义 SQL 查询"".""audience_audio"") AS ""TEMP(Calculation_3519281700079370244)(4109514392)(0)"",
  SUM(""自定义 SQL 查询"".""host_2k"") AS ""TEMP(Calculation_3519281700079370244)(586790827)(0)"",
  SUM(""自定义 SQL 查询"".""host_sd"") AS ""TEMP(Calculation_3519281700079370244)(709512178)(0)"",
  SUM(""自定义 SQL 查询"".""audience_4k"") AS ""TEMP(Calculation_3519281700079370244)(764410224)(0)"",
  SUM(""自定义 SQL 查询"".""audience_2k"") AS ""TEMP(Calculation_3519281700079370244)(943764407)(0)"",
  SUM(""自定义 SQL 查询"".""host_4k_last"") AS ""TEMP(Calculation_3519281700083154949)(101123376)(0)"",
  SUM(""自定义 SQL 查询"".""audience_video_hdp_last"") AS ""TEMP(Calculation_3519281700083154949)(1200517625)(0)"",
  SUM(""自定义 SQL 查询"".""audience_1080p_last"") AS ""TEMP(Calculation_3519281700083154949)(1314346200)(0)"",
  SUM(""自定义 SQL 查询"".""audience_video_hd_last"") AS ""TEMP(Calculation_3519281700083154949)(146570423)(0)"",
  SUM(""自定义 SQL 查询"".""audience_2k_last"") AS ""TEMP(Calculation_3519281700083154949)(1717771635)(0)"",
  SUM(""自定义 SQL 查询"".""audience_audio_last"") AS ""TEMP(Calculation_3519281700083154949)(2313111073)(0)"",
  SUM(""自定义 SQL 查询"".""host_video_hdp_last"") AS ""TEMP(Calculation_3519281700083154949)(258310559)(0)"",
  SUM(""自定义 SQL 查询"".""audio_video_last"") AS ""TEMP(Calculation_3519281700083154949)(2820618408)(0)"",
  SUM(""自定义 SQL 查询"".""audience_4k_last"") AS ""TEMP(Calculation_3519281700083154949)(3121859593)(0)"",
  SUM(""自定义 SQL 查询"".""host_1080p_last"") AS ""TEMP(Calculation_3519281700083154949)(3222422303)(0)"",
  SUM(""自定义 SQL 查询"".""host_audio_last"") AS ""TEMP(Calculation_3519281700083154949)(3227677803)(0)"",
  SUM(""自定义 SQL 查询"".""video_last"") AS ""TEMP(Calculation_3519281700083154949)(3934387163)(0)"",
  SUM(""自定义 SQL 查询"".""host_2k_last"") AS ""TEMP(Calculation_3519281700083154949)(4055292783)(0)"",
  SUM(""自定义 SQL 查询"".""audio_last"") AS ""TEMP(Calculation_3519281700083154949)(4091190060)(0)"",
  SUM(""自定义 SQL 查询"".""host_video_hd_last"") AS ""TEMP(Calculation_3519281700083154949)(4170367250)(0)"",
  SUM(""自定义 SQL 查询"".""host_video_sd_last"") AS ""TEMP(Calculation_3519281700083154949)(4190307025)(0)"",
  SUM(""自定义 SQL 查询"".""audience_video_sd_last"") AS ""TEMP(Calculation_3519281700083154949)(933007102)(0)"",
  MAX(""自定义 SQL 查询"".""stat_date"") AS ""TEMP(attr_stat_date_nk)(2102638629)(0)"",
  MIN(""自定义 SQL 查询"".""stat_date"") AS ""TEMP(attr_stat_date_nk)(2790680713)(0)"",
  ""自定义 SQL 查询"".""level1"" AS ""level1"",
  SUM(""自定义 SQL 查询"".""totalUsage"") AS ""sum_totalUsage_ok"",
  DATE_ADD('SECOND', 0, date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d')) AS ""tdy_date_ok""
FROM (SELECT date,
        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,
      start_date AS start_date_7,
      end_date AS end_date,
      tag,
      area AS Scope,
      dim,
        CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,
      level2,
      level3,
      level4,
      product_level1 AS product_line,
      product_level2,
      product_level3,
      product_level4,
      vid_internal_industry_en AS cid_industry,
      vid_use_case_en AS vid_use_case_cn,
      vid_sector_en,
      ver_type,
      ver,
      os,
      domain,
      country,
      region,
      dim_grouping_name,
        CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,
      total AS totalUsage,
      audio,
      video,
      host_audio,
      audience_audio,
      host_sd,
      host_hd,
      host_hdp,
      host_1080p,
      host_2k,
      host_4k,
      audience_sd,
      audience_hd,
      audience_hdp,
      audience_1080p,
      audience_2k,
      audience_4k,
      audience_audio_low_latency,
      audience_sd_low_latency,
      audience_hd_low_latency,
      audience_hdp_low_latency,
      audience_1080p_low_latency,
      audience_2k_low_latency,
      audience_4k_low_latency,
      audience_audio_ultra_low_latency,
      audience_sd_ultra_low_latency,
      audience_hd_ultra_low_latency,
      audience_hdp_ultra_low_latency,
      audience_1080p_ultra_low_latency,
      audience_2k_ultra_low_latency,
      audience_4k_ultra_low_latency,
      total_last1 AS audio_video_last,
      audio_last1 AS audio_last,
      video_last1 AS video_last,
      video_sd_last1 AS video_sd_last,
      video_hd_last1 AS video_hd_last,
      video_hdp_last1 AS video_hdp_last,
      host_sd_last1 AS host_video_sd_last,
      audience_sd_last1 AS audience_video_sd_last,
      host_hd_last1 AS host_video_hd_last,
      audience_hd_last1 AS audience_video_hd_last,
      host_hdp_last1 AS host_video_hdp_last,
      audience_hdp_last1 AS audience_video_hdp_last,
      host_audio_last1 AS host_audio_last,
      audience_audio_last1 AS audience_audio_last,
      host_video_last1 AS host_video_last,
      audience_video_last1 AS audience_video_last,
      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,
      audience_video_low_latency_last1 AS audience_video_low_latency_last,
      audience_total_low_latency_last1 AS audience_total_low_latency_last,
      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,
      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,
      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,
      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,
      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,
      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,
      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,
      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,
      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,
      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,
      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,
      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,
      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,
      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,
      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,
      audience_2k_last1 AS audience_2k_last,
      audience_4k_last1 AS audience_4k_last,
      audience_1080p_last1 AS audience_1080p_last,
      host_1080p_last1 AS host_1080p_last,
      host_2k_last1 AS host_2k_last,
      host_4k_last1 AS host_4k_last,
      total_last7,
      audio_last7,
      video_last7,
      video_sd_last7,
      video_hd_last7,
      video_hdp_last7,
      host_sd_last7,
      audience_sd_last7,
      host_hd_last7,
      audience_hd_last7,
      host_hdp_last7,
      audience_hdp_last7,
      host_audio_last7,
      audience_audio_last7,
      host_video_last7,
      audience_video_last7,
      audience_audio_low_latency_last7,
      audience_video_low_latency_last7,
      audience_total_low_latency_last7,
      audience_sd_low_latency_last7,
      audience_hd_low_latency_last7,
      audience_hdp_low_latency_last7,
      audience_1080p_low_latency_last7,
      audience_2k_low_latency_last7,
      audience_4k_low_latency_last7,
      audience_audio_ultra_low_latency_last7,
      audience_video_ultra_low_latency_last7,
      audience_total_ultra_low_latency_last7,
      audience_sd_ultra_low_latency_last7,
      audience_hd_ultra_low_latency_last7,
      audience_hdp_ultra_low_latency_last7,
      audience_1080p_ultra_low_latency_last7,
      audience_2k_ultra_low_latency_last7,
      audience_4k_ultra_low_latency_last7,
      audience_2k_last7,
      audience_4k_last7,
      audience_1080p_last7,
      host_1080p_last7,
      host_2k_last7,
      host_4k_last7
    FROM levels_usage_dod_di_1
    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-06') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-04') AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS ""自定义 SQL 查询""
WHERE ""自定义 SQL 查询"".""dim"" = 1 AND ""自定义 SQL 查询"".""rank_level1"" = 4
GROUP BY 37,
  39"
"select created from system.runtime.queries where created >= TIMESTAMP '2021-12-05 16:00:00.000 UTC' order by created desc limit 10"
"SELECT SUM(""自定义 SQL 查询"".""host_4k"") AS ""TEMP(Calculation_3519281700079370244)(1075454865)(0)"",
  SUM(""自定义 SQL 查询"".""audience_sd"") AS ""TEMP(Calculation_3519281700079370244)(1133678835)(0)"",
  SUM(""自定义 SQL 查询"".""host_1080p"") AS ""TEMP(Calculation_3519281700079370244)(1312501967)(0)"",
  SUM(""自定义 SQL 查询"".""host_hd"") AS ""TEMP(Calculation_3519281700079370244)(276907208)(0)"",
  SUM(""自定义 SQL 查询"".""video"") AS ""TEMP(Calculation_3519281700079370244)(2929708110)(0)"",
  SUM(""自定义 SQL 查询"".""audience_hd"") AS ""TEMP(Calculation_3519281700079370244)(2930728935)(0)"",
  SUM(""自定义 SQL 查询"".""audience_hdp"") AS ""TEMP(Calculation_3519281700079370244)(3010533957)(0)"",
  SUM(""自定义 SQL 查询"".""host_hdp"") AS ""TEMP(Calculation_3519281700079370244)(30306054)(0)"",
  SUM(""自定义 SQL 查询"".""host_audio"") AS ""TEMP(Calculation_3519281700079370244)(3087054365)(0)"",
  SUM(""自定义 SQL 查询"".""audio"") AS ""TEMP(Calculation_3519281700079370244)(3299350010)(0)"",
  SUM(""自定义 SQL 查询"".""audience_1080p"") AS ""TEMP(Calculation_3519281700079370244)(3628946582)(0)"",
  SUM(""自定义 SQL 查询"".""totalUsage"") AS ""TEMP(Calculation_3519281700079370244)(3847882359)(0)"",
  SUM(""自定义 SQL 查询"".""audience_audio"") AS ""TEMP(Calculation_3519281700079370244)(4109514392)(0)"",
  SUM(""自定义 SQL 查询"".""host_2k"") AS ""TEMP(Calculation_3519281700079370244)(586790827)(0)"",
  SUM(""自定义 SQL 查询"".""host_sd"") AS ""TEMP(Calculation_3519281700079370244)(709512178)(0)"",
  SUM(""自定义 SQL 查询"".""audience_4k"") AS ""TEMP(Calculation_3519281700079370244)(764410224)(0)"",
  SUM(""自定义 SQL 查询"".""audience_2k"") AS ""TEMP(Calculation_3519281700079370244)(943764407)(0)"",
  SUM(""自定义 SQL 查询"".""host_4k_last"") AS ""TEMP(Calculation_3519281700083154949)(101123376)(0)"",
  SUM(""自定义 SQL 查询"".""audience_video_hdp_last"") AS ""TEMP(Calculation_3519281700083154949)(1200517625)(0)"",
  SUM(""自定义 SQL 查询"".""audience_1080p_last"") AS ""TEMP(Calculation_3519281700083154949)(1314346200)(0)"",
  SUM(""自定义 SQL 查询"".""audience_video_hd_last"") AS ""TEMP(Calculation_3519281700083154949)(146570423)(0)"",
  SUM(""自定义 SQL 查询"".""audience_2k_last"") AS ""TEMP(Calculation_3519281700083154949)(1717771635)(0)"",
  SUM(""自定义 SQL 查询"".""audience_audio_last"") AS ""TEMP(Calculation_3519281700083154949)(2313111073)(0)"",
  SUM(""自定义 SQL 查询"".""host_video_hdp_last"") AS ""TEMP(Calculation_3519281700083154949)(258310559)(0)"",
  SUM(""自定义 SQL 查询"".""audio_video_last"") AS ""TEMP(Calculation_3519281700083154949)(2820618408)(0)"",
  SUM(""自定义 SQL 查询"".""audience_4k_last"") AS ""TEMP(Calculation_3519281700083154949)(3121859593)(0)"",
  SUM(""自定义 SQL 查询"".""host_1080p_last"") AS ""TEMP(Calculation_3519281700083154949)(3222422303)(0)"",
  SUM(""自定义 SQL 查询"".""host_audio_last"") AS ""TEMP(Calculation_3519281700083154949)(3227677803)(0)"",
  SUM(""自定义 SQL 查询"".""video_last"") AS ""TEMP(Calculation_3519281700083154949)(3934387163)(0)"",
  SUM(""自定义 SQL 查询"".""host_2k_last"") AS ""TEMP(Calculation_3519281700083154949)(4055292783)(0)"",
  SUM(""自定义 SQL 查询"".""audio_last"") AS ""TEMP(Calculation_3519281700083154949)(4091190060)(0)"",
  SUM(""自定义 SQL 查询"".""host_video_hd_last"") AS ""TEMP(Calculation_3519281700083154949)(4170367250)(0)"",
  SUM(""自定义 SQL 查询"".""host_video_sd_last"") AS ""TEMP(Calculation_3519281700083154949)(4190307025)(0)"",
  SUM(""自定义 SQL 查询"".""audience_video_sd_last"") AS ""TEMP(Calculation_3519281700083154949)(933007102)(0)"",
  MAX(""自定义 SQL 查询"".""stat_date"") AS ""TEMP(attr_stat_date_nk)(2102638629)(0)"",
  MIN(""自定义 SQL 查询"".""stat_date"") AS ""TEMP(attr_stat_date_nk)(2790680713)(0)"",
  ""自定义 SQL 查询"".""level1"" AS ""level1"",
  SUM(""自定义 SQL 查询"".""totalUsage"") AS ""sum_totalUsage_ok"",
  DATE_ADD('SECOND', 0, date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d')) AS ""tdy_date_ok""
FROM (SELECT date,
        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,
      start_date AS start_date_7,
      end_date AS end_date,
      tag,
      area AS Scope,
      dim,
        CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,
      level2,
      level3,
      level4,
      product_level1 AS product_line,
      product_level2,
      product_level3,
      product_level4,
      vid_internal_industry_en AS cid_industry,
      vid_use_case_en AS vid_use_case_cn,
      vid_sector_en,
      ver_type,
      ver,
      os,
      domain,
      country,
      region,
      dim_grouping_name,
        CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,
      total AS totalUsage,
      audio,
      video,
      host_audio,
      audience_audio,
      host_sd,
      host_hd,
      host_hdp,
      host_1080p,
      host_2k,
      host_4k,
      audience_sd,
      audience_hd,
      audience_hdp,
      audience_1080p,
      audience_2k,
      audience_4k,
      audience_audio_low_latency,
      audience_sd_low_latency,
      audience_hd_low_latency,
      audience_hdp_low_latency,
      audience_1080p_low_latency,
      audience_2k_low_latency,
      audience_4k_low_latency,
      audience_audio_ultra_low_latency,
      audience_sd_ultra_low_latency,
      audience_hd_ultra_low_latency,
      audience_hdp_ultra_low_latency,
      audience_1080p_ultra_low_latency,
      audience_2k_ultra_low_latency,
      audience_4k_ultra_low_latency,
      total_last1 AS audio_video_last,
      audio_last1 AS audio_last,
      video_last1 AS video_last,
      video_sd_last1 AS video_sd_last,
      video_hd_last1 AS video_hd_last,
      video_hdp_last1 AS video_hdp_last,
      host_sd_last1 AS host_video_sd_last,
      audience_sd_last1 AS audience_video_sd_last,
      host_hd_last1 AS host_video_hd_last,
      audience_hd_last1 AS audience_video_hd_last,
      host_hdp_last1 AS host_video_hdp_last,
      audience_hdp_last1 AS audience_video_hdp_last,
      host_audio_last1 AS host_audio_last,
      audience_audio_last1 AS audience_audio_last,
      host_video_last1 AS host_video_last,
      audience_video_last1 AS audience_video_last,
      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,
      audience_video_low_latency_last1 AS audience_video_low_latency_last,
      audience_total_low_latency_last1 AS audience_total_low_latency_last,
      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,
      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,
      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,
      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,
      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,
      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,
      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,
      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,
      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,
      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,
      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,
      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,
      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,
      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,
      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,
      audience_2k_last1 AS audience_2k_last,
      audience_4k_last1 AS audience_4k_last,
      audience_1080p_last1 AS audience_1080p_last,
      host_1080p_last1 AS host_1080p_last,
      host_2k_last1 AS host_2k_last,
      host_4k_last1 AS host_4k_last,
      total_last7,
      audio_last7,
      video_last7,
      video_sd_last7,
      video_hd_last7,
      video_hdp_last7,
      host_sd_last7,
      audience_sd_last7,
      host_hd_last7,
      audience_hd_last7,
      host_hdp_last7,
      audience_hdp_last7,
      host_audio_last7,
      audience_audio_last7,
      host_video_last7,
      audience_video_last7,
      audience_audio_low_latency_last7,
      audience_video_low_latency_last7,
      audience_total_low_latency_last7,
      audience_sd_low_latency_last7,
      audience_hd_low_latency_last7,
      audience_hdp_low_latency_last7,
      audience_1080p_low_latency_last7,
      audience_2k_low_latency_last7,
      audience_4k_low_latency_last7,
      audience_audio_ultra_low_latency_last7,
      audience_video_ultra_low_latency_last7,
      audience_total_ultra_low_latency_last7,
      audience_sd_ultra_low_latency_last7,
      audience_hd_ultra_low_latency_last7,
      audience_hdp_ultra_low_latency_last7,
      audience_1080p_ultra_low_latency_last7,
      audience_2k_ultra_low_latency_last7,
      audience_4k_ultra_low_latency_last7,
      audience_2k_last7,
      audience_4k_last7,
      audience_1080p_last7,
      host_1080p_last7,
      host_2k_last7,
      host_4k_last7
    FROM levels_usage_dod_di_1
    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-06') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-04') AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS ""自定义 SQL 查询""
WHERE ""自定义 SQL 查询"".""dim"" = 1 AND ""自定义 SQL 查询"".""rank_level1"" = 3
GROUP BY 37,
  39"
"SELECT ""自定义 SQL 查询"".""product_level1"" AS ""product_level1""
FROM (SELECT date,
      SUBSTR(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) AS date_range_1,
      SUBSTR(CAST(end_date AS VARCHAR), 1, 10) AS date_range_2,
      stat_period,
        CASE WHEN CAST(stat_period AS VARCHAR) = 'day' THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,
      area,
      vid,
      project,
      company_id AS cid,
      company_name AS company,
      customer_level AS level,
      vid_internal_industry_en AS industry,
      vid_use_case_cn,
      csdc_owner,
      os,
      ver,
      ver_type,
      product_level1,
      product_level2,
      product_level3,
      total,
      audio,
      video,
      video_sd,
      video_hd,
      video_hdp,
        host_audio + host_video AS host,
      host_audio,
      host_video,
      host_sd,
      host_hd,
      host_hdp,
        audience_audio + audience_video AS audience,
        audience_audio_low_latency + audience_video_low_latency AS audience_low_latency,
      audience_audio,
      audience_audio_low_latency,
      audience_video,
      audience_video_low_latency,
      audience_sd,
      audience_sd_low_latency,
      audience_hd,
      audience_hd_low_latency,
      audience_hdp,
      audience_hdp_low_latency,
      total_last1,
      audio_last1,
      video_last1,
      video_sd_last1,
      video_hd_last1,
      video_hdp_last1,
        host_audio_last1 + host_video_last1 AS host_last1,
      host_audio_last1,
      host_video_last1,
        audience_audio_last1 + audience_video_last1 AS audience_last1,
        audience_audio_low_latency_last1 + audience_video_low_latency_last1 AS audience_low_latency_last1,
      audience_audio_last1,
      audience_audio_low_latency_last1,
      audience_video_last1,
      audience_video_low_latency_last1,
      total_last7,
      audio_last7,
      video_last7,
      video_sd_last7,
      video_hd_last7,
      video_hdp_last7,
        host_audio_last7 + host_video_last7 AS host_last7,
      host_audio_last7,
      host_video_last7,
        audience_audio_last7 + audience_video_last7 AS audience_last7,
        audience_audio_low_latency_last7 + audience_video_low_latency_last7 AS audience_low_latency_last7,
      audience_audio_last7,
      audience_audio_low_latency_last7,
      audience_video_last7,
      audience_video_low_latency_last7
    FROM report_datahub.vendor_vid_usage_di_1
    WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-06') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-06') AND CAST(vid AS VARCHAR) = CAST(428342 AS VARCHAR) AND dim = 1) AS ""自定义 SQL 查询""
GROUP BY 1
ORDER BY ""product_level1"""
"SELECT ""自定义 SQL 查询"".""product_line"" AS ""product_line""
FROM (SELECT date AS ""date"",
      src_domain AS ""srcDomain"",
      src_region AS ""srcRegion"",
      dest_idc AS ""idc"",
      delay_25 AS ""p2s_Delay25"",
      delay_50 AS ""p2s_Delay50"",
      delay_75 AS ""p2s_Delay75"",
      delay_100 AS ""p2s_Delay100"",
      delay_125 AS ""p2s_Delay125"",
      delay_150 AS ""p2s_Delay150"",
      delay_total,
      lost_ratio_5 AS ""p2s_lostRatio"",
      lostratio_total AS ""p2s_total"",
      jitter95_50 AS ""p2s_jitter95_50"",
      jitter95_100 AS ""p2s_jitter95_100"",
      jitter95_200 AS ""p2s_jitter95_200"",
      jitter95_300 AS ""p2s_jitter95_300"",
      jitter95_total,
      product_line,
      product_type
    FROM media.p2s_cover_mainland_ip
    WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-25') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-01')) AS ""自定义 SQL 查询""
GROUP BY 1
ORDER BY ""product_line"""
"SELECT ""自定义 SQL 查询"".""product_level1"" AS ""product_level1"",
  SUM(""自定义 SQL 查询"".""total"") AS ""sum_total_ok""
FROM (SELECT date,
      SUBSTR(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) AS date_range_1,
      SUBSTR(CAST(end_date AS VARCHAR), 1, 10) AS date_range_2,
      stat_period,
        CASE WHEN CAST(stat_period AS VARCHAR) = 'day' THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,
      area,
      vid,
      project,
      company_id AS cid,
      company_name AS company,
      customer_level AS level,
      vid_internal_industry_en AS industry,
      vid_use_case_cn,
      csdc_owner,
      os,
      ver,
      ver_type,
      product_level1,
      product_level2,
      product_level3,
      total,
      audio,
      video,
      video_sd,
      video_hd,
      video_hdp,
        host_audio + host_video AS host,
      host_audio,
      host_video,
      host_sd,
      host_hd,
      host_hdp,
        audience_audio + audience_video AS audience,
        audience_audio_low_latency + audience_video_low_latency AS audience_low_latency,
      audience_audio,
      audience_audio_low_latency,
      audience_video,
      audience_video_low_latency,
      audience_sd,
      audience_sd_low_latency,
      audience_hd,
      audience_hd_low_latency,
      audience_hdp,
      audience_hdp_low_latency,
      total_last1,
      audio_last1,
      video_last1,
      video_sd_last1,
      video_hd_last1,
      video_hdp_last1,
        host_audio_last1 + host_video_last1 AS host_last1,
      host_audio_last1,
      host_video_last1,
        audience_audio_last1 + audience_video_last1 AS audience_last1,
        audience_audio_low_latency_last1 + audience_video_low_latency_last1 AS audience_low_latency_last1,
      audience_audio_last1,
      audience_audio_low_latency_last1,
      audience_video_last1,
      audience_video_low_latency_last1,
      total_last7,
      audio_last7,
      video_last7,
      video_sd_last7,
      video_hd_last7,
      video_hdp_last7,
        host_audio_last7 + host_video_last7 AS host_last7,
      host_audio_last7,
      host_video_last7,
        audience_audio_last7 + audience_video_last7 AS audience_last7,
        audience_audio_low_latency_last7 + audience_video_low_latency_last7 AS audience_low_latency_last7,
      audience_audio_last7,
      audience_audio_low_latency_last7,
      audience_video_last7,
      audience_video_low_latency_last7
    FROM report_datahub.vendor_vid_usage_di_1
    WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-06') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-06') AND CAST(vid AS VARCHAR) = CAST(428342 AS VARCHAR) AND dim = 1) AS ""自定义 SQL 查询""
GROUP BY 1"
"SELECT ""自定义 SQL 查询"".""product_line"" AS ""product_line""
FROM (SELECT date AS ""date"",
      src_domain AS ""srcDomain"",
      src_region AS ""srcRegion"",
      dest_idc AS ""idc"",
      src_isp,
      dest_ip,
      delay_25 AS ""p2s_Delay25"",
      delay_50 AS ""p2s_Delay50"",
      delay_75 AS ""p2s_Delay75"",
      delay_100 AS ""p2s_Delay100"",
      delay_125 AS ""p2s_Delay125"",
      delay_150 AS ""p2s_Delay150"",
      delay_total,
      lost_ratio_5 AS ""p2s_lostRatio"",
      lostratio_total AS ""p2s_total"",
      jitter95_50 AS ""p2s_jitter95_50"",
      jitter95_100 AS ""p2s_jitter95_100"",
      jitter95_200 AS ""p2s_jitter95_200"",
      jitter95_300 AS ""p2s_jitter95_300"",
      jitter95_total,
      product_line,
      product_type
    FROM media.p2s_cover_mainland_ip
    WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-25') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-01')) AS ""自定义 SQL 查询""
GROUP BY 1
ORDER BY ""product_line"""
"SELECT SUM(""自定义 SQL 查询"".""s2l_25ms_delay_sec"") AS ""TEMP(Calculation_1430244791154503680)(2227145667)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_total_delay_sec"") AS ""TEMP(Calculation_1430244791154503680)(2460078802)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_total_delay_sec_last1"") AS ""TEMP(Calculation_1430244791161831425)(1533897333)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_25ms_delay_sec_last1"") AS ""TEMP(Calculation_1430244791161831425)(3105382701)(0)"",
  SUM(""自定义 SQL 查询"".""5s_succ_join_ap_cnt"") AS ""TEMP(Calculation_1430244791247978510)(1716451703)(0)"",
  SUM(""自定义 SQL 查询"".""total_join_ap_cnt"") AS ""TEMP(Calculation_1430244791247978510)(2681092799)(0)"",
  SUM(""自定义 SQL 查询"".""5s_succ_join_ap_cnt_last1"") AS ""TEMP(Calculation_1430244791248527375)(865560869)(0)"",
  SUM(""自定义 SQL 查询"".""total_join_ap_cnt_last1"") AS ""TEMP(Calculation_1430244791248527375)(97423155)(0)"",
  SUM(""自定义 SQL 查询"".""video_freeze_time_500"") AS ""TEMP(Calculation_2810035073237774336)(389023081)(0)"",
  SUM(""自定义 SQL 查询"".""video_totaltime_500"") AS ""TEMP(Calculation_2810035073237774336)(458654145)(0)"",
  SUM(""自定义 SQL 查询"".""video_totaltime_200"") AS ""TEMP(Calculation_2810035073237950465)(2104207895)(0)"",
  SUM(""自定义 SQL 查询"".""video_freeze_time_200"") AS ""TEMP(Calculation_2810035073237950465)(530162565)(0)"",
  SUM(""自定义 SQL 查询"".""video_totaltime_200_last1"") AS ""TEMP(Calculation_2810035073238130690)(1909093697)(0)"",
  SUM(""自定义 SQL 查询"".""video_freeze_time_200_last1"") AS ""TEMP(Calculation_2810035073238130690)(356123728)(0)"",
  SUM(""自定义 SQL 查询"".""video_freeze_time_200_last7"") AS ""TEMP(Calculation_2810035073238458371)(1003246719)(0)"",
  SUM(""自定义 SQL 查询"".""video_totaltime_200_last7"") AS ""TEMP(Calculation_2810035073238458371)(3922744675)(0)"",
  SUM(""自定义 SQL 查询"".""video_totaltime_500_last1"") AS ""TEMP(Calculation_2810035073238695940)(3425883446)(0)"",
  SUM(""自定义 SQL 查询"".""video_freeze_time_500_last1"") AS ""TEMP(Calculation_2810035073238695940)(3450234468)(0)"",
  SUM(""自定义 SQL 查询"".""video_freeze_time_500_last7"") AS ""TEMP(Calculation_2810035073239027717)(1458194667)(0)"",
  SUM(""自定义 SQL 查询"".""video_totaltime_500_last7"") AS ""TEMP(Calculation_2810035073239027717)(2161412938)(0)"",
  SUM(""自定义 SQL 查询"".""totalJoin"") AS ""TEMP(Calculation_374009936508170240)(2073556184)(0)"",
  SUM(""自定义 SQL 查询"".""totalJoinSuccess"") AS ""TEMP(Calculation_374009936508170240)(2807417001)(0)"",
  SUM(""自定义 SQL 查询"".""threeSecJoinSuccess"") AS ""TEMP(Calculation_374009936508321793)(3693645608)(0)"",
  SUM(""自定义 SQL 查询"".""fiveSecJoinSuccess"") AS ""TEMP(Calculation_374009936508416002)(383616769)(0)"",
  SUM(""自定义 SQL 查询"".""video_totaltime"") AS ""TEMP(Calculation_374009936515215363)(2797449586)(0)"",
  SUM(""自定义 SQL 查询"".""video_freeze_time"") AS ""TEMP(Calculation_374009936515215363)(2940759860)(0)"",
  SUM(""自定义 SQL 查询"".""audio_totaltime"") AS ""TEMP(Calculation_374009936517861380)(1652566750)(0)"",
  SUM(""自定义 SQL 查询"".""audio_freeze_time"") AS ""TEMP(Calculation_374009936517861380)(2919389392)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_lost_Leq5"") AS ""TEMP(Calculation_374009936519704581)(1936123547)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_lost_all"") AS ""TEMP(Calculation_374009936519704581)(749826584)(0)"",
  SUM(""自定义 SQL 查询"".""total_join_session_cnt_last1"") AS ""TEMP(Calculation_374009936523853831)(2708102775)(0)"",
  SUM(""自定义 SQL 查询"".""succ_join_session_cnt_last1"") AS ""TEMP(Calculation_374009936523853831)(929207889)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_75ms_delay_sec"") AS ""TEMP(Calculation_6542393318886285312)(2003933318)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_total_delay_sec_last1"") AS ""TEMP(Calculation_6542393318886735875)(3088956105)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_75ms_delay_sec_last1"") AS ""TEMP(Calculation_6542393318886735875)(602483182)(0)"",
  SUM(""自定义 SQL 查询"".""3s_succ_join_session_cnt_last1"") AS ""TEMP(Calculation_7034341207020355584)(2445597373)(0)"",
  SUM(""自定义 SQL 查询"".""5s_succ_join_session_cnt_last1"") AS ""TEMP(Calculation_7034341207023706114)(2534022291)(0)"",
  SUM(""自定义 SQL 查询"".""video_totaltime_last1"") AS ""TEMP(Calculation_7034341207025315846)(1221500367)(0)"",
  SUM(""自定义 SQL 查询"".""video_freeze_time_last1"") AS ""TEMP(Calculation_7034341207025315846)(3506758486)(0)"",
  SUM(""自定义 SQL 查询"".""audio_totaltime_last1"") AS ""TEMP(Calculation_7034341207025774600)(803828507)(0)"",
  SUM(""自定义 SQL 查询"".""audio_freeze_time_last1"") AS ""TEMP(Calculation_7034341207025774600)(877259553)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_lost_Leq5"") AS ""TEMP(Calculation_7034341207026102282)(2745840127)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_lost_all_last1"") AS ""TEMP(Calculation_7034341207026102282)(3348338895)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_lost_Leq5_last1"") AS ""TEMP(Calculation_7034341207026102282)(700826822)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_lost_all"") AS ""TEMP(Calculation_7034341207026102282)(734589263)(0)"",
  SUM(""自定义 SQL 查询"".""crash_cnt"") AS ""TEMP(Calculation_7034341207372070925)(2360900687)(0)"",
  SUM(""自定义 SQL 查询"".""service_cnt"") AS ""TEMP(Calculation_7034341207372070925)(4291252132)(0)"",
  SUM(""自定义 SQL 查询"".""service_cnt_last1"") AS ""TEMP(Calculation_7034341207372197902)(2436060403)(0)"",
  SUM(""自定义 SQL 查询"".""crash_cnt_last1"") AS ""TEMP(Calculation_7034341207372197902)(651130603)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_lost_all_last1"") AS ""TEMP(Calculation_75998310509129730)(1975694301)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_lost_Leq5_last1"") AS ""TEMP(Calculation_75998310509129730)(1982054307)(0)""
FROM (SELECT date,
        CASE WHEN CAST(stat_period AS VARCHAR) = 'day' THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(substr(CAST(start_date AS VARCHAR), 1, 10) AS VARCHAR), '~', CAST(substr(CAST(end_date AS VARCHAR), 1, 10) AS VARCHAR)) END AS period,
      start_date,
      end_date,
      stat_period,
      tag,
      dim,
      level1,
      level2,
      level3,
      level4,
      '' AS pd,
      os,
      ver,
      ver_type,
      '' AS product_line,
      '' AS product_type,
      domain,
      country,
      region,
      net,
      vid,
      project,
      company_id,
      company_name,
      rowsnum,
      lastusage,
      thisusage,
      fiveSecJoinSuccess,
      totalJoin,
      cnt_sid,
      video_freeze_time,
      video_totaltime,
      audio_freeze_time,
      audio_totaltime,
      s2l_total_delay_sec,
      s2l_25ms_delay_sec,
      s2l_75ms_delay_sec,
      p2s_lost_Leq5,
      p2s_lost_all,
      crash_cnt,
      service_cnt,
      ""1s_succ_join_ap_cnt"",
      ""5s_succ_join_ap_cnt"",
      total_join_ap_cnt,
      totalJoinSuccess,
      threeSecJoinSuccess,
      video_freeze_time_200,
      video_totaltime_200,
      video_freeze_time_500,
      video_totaltime_500,
      ""3s_succ_join_session_cnt_last1"",
      ""5s_succ_join_session_cnt_last1"",
      succ_join_session_cnt_last1,
      total_join_session_cnt_last1,
      total_session_cnt_last1,
      ""1s_succ_join_ap_cnt_last1"",
      ""5s_succ_join_ap_cnt_last1"",
      total_join_ap_cnt_last1,
      ""3s_succ_join_session_cnt_last7"",
      ""5s_succ_join_session_cnt_last7"",
      succ_join_session_cnt_last7,
      total_join_session_cnt_last7,
      total_session_cnt_last7,
      ""1s_succ_join_ap_cnt_last7"",
      ""5s_succ_join_ap_cnt_last7"",
      total_join_ap_cnt_last7,
      video_freeze_time_last1,
      video_totaltime_last1,
      video_freeze_time_500_last1,
      video_totaltime_500_last1,
      video_freeze_time_200_last1,
      video_totaltime_200_last1,
      video_freeze_time_last7,
      video_totaltime_last7,
      video_freeze_time_500_last7,
      video_totaltime_500_last7,
      video_freeze_time_200_last7,
      video_totaltime_200_last7,
      audio_freeze_time_last1,
      audio_totaltime_last1,
      audio_freeze_time_last7,
      audio_totaltime_last7,
      s2l_total_delay_sec_last1,
      s2l_25ms_delay_sec_last1,
      s2l_75ms_delay_sec_last1,
      s2l_total_delay_sec_last7,
      s2l_25ms_delay_sec_last7,
      s2l_75ms_delay_sec_last7,
      p2s_lost_Leq5_last1,
      p2s_lost_all_last1,
      p2s_lost_Leq5_last7,
      p2s_lost_all_last7,
      crash_cnt_last1,
      service_cnt_last1,
      crash_cnt_last7,
      service_cnt_last7,
      product_level1,
      product_level2,
      product_level3,
      product_level4,
      s2l_lost_Leq5,
      s2l_lost_all,
      s2l_lost_Leq5_last1,
      s2l_lost_all_last1,
      s2l_lost_Leq5_last7,
      s2l_lost_all_last7
    FROM report_datahub.pub_levels_quality_di_1
    WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-21') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-11-21')) AS ""自定义 SQL 查询""
  CROSS JOIN (SELECT MAX(date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d')) AS ""__measure__0""
    FROM (SELECT date,
            CASE WHEN CAST(stat_period AS VARCHAR) = 'day' THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(substr(CAST(start_date AS VARCHAR), 1, 10) AS VARCHAR), '~', CAST(substr(CAST(end_date AS VARCHAR), 1, 10) AS VARCHAR)) END AS period,
          start_date,
          end_date,
          stat_period,
          tag,
          dim,
          level1,
          level2,
          level3,
          level4,
          '' AS pd,
          os,
          ver,
          ver_type,
          '' AS product_line,
          '' AS product_type,
          domain,
          country,
          region,
          net,
          vid,
          project,
          company_id,
          company_name,
          rowsnum,
          lastusage,
          thisusage,
          fiveSecJoinSuccess,
          totalJoin,
          cnt_sid,
          video_freeze_time,
          video_totaltime,
          audio_freeze_time,
          audio_totaltime,
          s2l_total_delay_sec,
          s2l_25ms_delay_sec,
          s2l_75ms_delay_sec,
          p2s_lost_Leq5,
          p2s_lost_all,
          crash_cnt,
          service_cnt,
          ""1s_succ_join_ap_cnt"",
          ""5s_succ_join_ap_cnt"",
          total_join_ap_cnt,
          totalJoinSuccess,
          threeSecJoinSuccess,
          video_freeze_time_200,
          video_totaltime_200,
          video_freeze_time_500,
          video_totaltime_500,
          ""3s_succ_join_session_cnt_last1"",
          ""5s_succ_join_session_cnt_last1"",
          succ_join_session_cnt_last1,
          total_join_session_cnt_last1,
          total_session_cnt_last1,
          ""1s_succ_join_ap_cnt_last1"",
          ""5s_succ_join_ap_cnt_last1"",
          total_join_ap_cnt_last1,
          ""3s_succ_join_session_cnt_last7"",
          ""5s_succ_join_session_cnt_last7"",
          succ_join_session_cnt_last7,
          total_join_session_cnt_last7,
          total_session_cnt_last7,
          ""1s_succ_join_ap_cnt_last7"",
          ""5s_succ_join_ap_cnt_last7"",
          total_join_ap_cnt_last7,
          video_freeze_time_last1,
          video_totaltime_last1,
          video_freeze_time_500_last1,
          video_totaltime_500_last1,
          video_freeze_time_200_last1,
          video_totaltime_200_last1,
          video_freeze_time_last7,
          video_totaltime_last7,
          video_freeze_time_500_last7,
          video_totaltime_500_last7,
          video_freeze_time_200_last7,
          video_totaltime_200_last7,
          audio_freeze_time_last1,
          audio_totaltime_last1,
          audio_freeze_time_last7,
          audio_totaltime_last7,
          s2l_total_delay_sec_last1,
          s2l_25ms_delay_sec_last1,
          s2l_75ms_delay_sec_last1,
          s2l_total_delay_sec_last7,
          s2l_25ms_delay_sec_last7,
          s2l_75ms_delay_sec_last7,
          p2s_lost_Leq5_last1,
          p2s_lost_all_last1,
          p2s_lost_Leq5_last7,
          p2s_lost_all_last7,
          crash_cnt_last1,
          service_cnt_last1,
          crash_cnt_last7,
          service_cnt_last7,
          product_level1,
          product_level2,
          product_level3,
          product_level4,
          s2l_lost_Leq5,
          s2l_lost_all,
          s2l_lost_Leq5_last1,
          s2l_lost_all_last1,
          s2l_lost_Leq5_last7,
          s2l_lost_all_last7
        FROM report_datahub.pub_levels_quality_di_1
        WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-21') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-11-21')) AS ""自定义 SQL 查询""
    HAVING COUNT(1) > 0) AS ""t0""
WHERE CASE WHEN CAST(""自定义 SQL 查询"".""tag"" AS VARCHAR) = 'Industry' AND CAST(""自定义 SQL 查询"".""product_level1"" AS VARCHAR) = 'RTC' AND CAST(""自定义 SQL 查询"".""dim"" AS VARCHAR) = 'osver' THEN 0 WHEN CAST(""自定义 SQL 查询"".""tag"" AS VARCHAR) = 'VerType' AND CAST(""自定义 SQL 查询"".""product_level1"" AS VARCHAR) = 'RTC' AND CAST(""自定义 SQL 查询"".""dim"" AS VARCHAR) = 'osver' THEN 0 WHEN CAST(""自定义 SQL 查询"".""tag"" AS VARCHAR) = 'Product' AND CAST(""自定义 SQL 查询"".""product_level1"" AS VARCHAR) = 'RTC' AND CAST(""自定义 SQL 查询"".""dim"" AS VARCHAR) = 'osver' THEN 1 ELSE 0 END AND DATE_ADD('SECOND', 0, date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d')) = DATE_ADD('SECOND', 0, ""t0"".""__measure__0"")
HAVING COUNT(1) > 0"
"SELECT SUM(""自定义 SQL 查询"".""host_4k_last"") AS ""TEMP(Calculation_3519281700083154949)(101123376)(0)"",
  SUM(""自定义 SQL 查询"".""host_4k"") AS ""TEMP(Calculation_3519281700083154949)(1075454865)(0)"",
  SUM(""自定义 SQL 查询"".""audience_sd"") AS ""TEMP(Calculation_3519281700083154949)(1133678835)(0)"",
  SUM(""自定义 SQL 查询"".""audience_video_hdp_last"") AS ""TEMP(Calculation_3519281700083154949)(1200517625)(0)"",
  SUM(""自定义 SQL 查询"".""host_1080p"") AS ""TEMP(Calculation_3519281700083154949)(1312501967)(0)"",
  SUM(""自定义 SQL 查询"".""audience_1080p_last"") AS ""TEMP(Calculation_3519281700083154949)(1314346200)(0)"",
  SUM(""自定义 SQL 查询"".""audience_video_hd_last"") AS ""TEMP(Calculation_3519281700083154949)(146570423)(0)"",
  SUM(""自定义 SQL 查询"".""audience_2k_last"") AS ""TEMP(Calculation_3519281700083154949)(1717771635)(0)"",
  SUM(""自定义 SQL 查询"".""audience_audio_last"") AS ""TEMP(Calculation_3519281700083154949)(2313111073)(0)"",
  SUM(""自定义 SQL 查询"".""host_video_hdp_last"") AS ""TEMP(Calculation_3519281700083154949)(258310559)(0)"",
  SUM(""自定义 SQL 查询"".""host_hd"") AS ""TEMP(Calculation_3519281700083154949)(276907208)(0)"",
  SUM(""自定义 SQL 查询"".""audio_video_last"") AS ""TEMP(Calculation_3519281700083154949)(2820618408)(0)"",
  SUM(""自定义 SQL 查询"".""video"") AS ""TEMP(Calculation_3519281700083154949)(2929708110)(0)"",
  SUM(""自定义 SQL 查询"".""audience_hd"") AS ""TEMP(Calculation_3519281700083154949)(2930728935)(0)"",
  SUM(""自定义 SQL 查询"".""audience_hdp"") AS ""TEMP(Calculation_3519281700083154949)(3010533957)(0)"",
  SUM(""自定义 SQL 查询"".""host_hdp"") AS ""TEMP(Calculation_3519281700083154949)(30306054)(0)"",
  SUM(""自定义 SQL 查询"".""host_audio"") AS ""TEMP(Calculation_3519281700083154949)(3087054365)(0)"",
  SUM(""自定义 SQL 查询"".""audience_4k_last"") AS ""TEMP(Calculation_3519281700083154949)(3121859593)(0)"",
  SUM(""自定义 SQL 查询"".""host_1080p_last"") AS ""TEMP(Calculation_3519281700083154949)(3222422303)(0)"",
  SUM(""自定义 SQL 查询"".""host_audio_last"") AS ""TEMP(Calculation_3519281700083154949)(3227677803)(0)"",
  SUM(""自定义 SQL 查询"".""audio"") AS ""TEMP(Calculation_3519281700083154949)(3299350010)(0)"",
  SUM(""自定义 SQL 查询"".""audience_1080p"") AS ""TEMP(Calculation_3519281700083154949)(3628946582)(0)"",
  SUM(""自定义 SQL 查询"".""totalUsage"") AS ""TEMP(Calculation_3519281700083154949)(3847882359)(0)"",
  SUM(""自定义 SQL 查询"".""video_last"") AS ""TEMP(Calculation_3519281700083154949)(3934387163)(0)"",
  SUM(""自定义 SQL 查询"".""host_2k_last"") AS ""TEMP(Calculation_3519281700083154949)(4055292783)(0)"",
  SUM(""自定义 SQL 查询"".""audio_last"") AS ""TEMP(Calculation_3519281700083154949)(4091190060)(0)"",
  SUM(""自定义 SQL 查询"".""audience_audio"") AS ""TEMP(Calculation_3519281700083154949)(4109514392)(0)"",
  SUM(""自定义 SQL 查询"".""host_video_hd_last"") AS ""TEMP(Calculation_3519281700083154949)(4170367250)(0)"",
  SUM(""自定义 SQL 查询"".""host_video_sd_last"") AS ""TEMP(Calculation_3519281700083154949)(4190307025)(0)"",
  SUM(""自定义 SQL 查询"".""host_2k"") AS ""TEMP(Calculation_3519281700083154949)(586790827)(0)"",
  SUM(""自定义 SQL 查询"".""host_sd"") AS ""TEMP(Calculation_3519281700083154949)(709512178)(0)"",
  SUM(""自定义 SQL 查询"".""audience_4k"") AS ""TEMP(Calculation_3519281700083154949)(764410224)(0)"",
  SUM(""自定义 SQL 查询"".""audience_video_sd_last"") AS ""TEMP(Calculation_3519281700083154949)(933007102)(0)"",
  SUM(""自定义 SQL 查询"".""audience_2k"") AS ""TEMP(Calculation_3519281700083154949)(943764407)(0)"",
  AVG(""自定义 SQL 查询"".""totalUsage"") AS ""avg_totalUsage_ok"",
  ""自定义 SQL 查询"".""level1"" AS ""level1"",
  SUM(""自定义 SQL 查询"".""totalUsage"") AS ""sum_totalUsage_ok""
FROM (SELECT date,
        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,
      start_date AS start_date_7,
      end_date AS end_date,
      tag,
      area AS Scope,
      dim,
        CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,
      level2,
      level3,
      level4,
      product_level1 AS product_line,
      product_level2,
      product_level3,
      product_level4,
      vid_internal_industry_en AS cid_industry,
      vid_use_case_en AS vid_use_case_cn,
      vid_sector_en,
      ver_type,
      ver,
      os,
      domain,
      country,
      region,
      dim_grouping_name,
        CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,
      total AS totalUsage,
      audio,
      video,
      host_audio,
      audience_audio,
      host_sd,
      host_hd,
      host_hdp,
      host_1080p,
      host_2k,
      host_4k,
      audience_sd,
      audience_hd,
      audience_hdp,
      audience_1080p,
      audience_2k,
      audience_4k,
      audience_audio_low_latency,
      audience_sd_low_latency,
      audience_hd_low_latency,
      audience_hdp_low_latency,
      audience_1080p_low_latency,
      audience_2k_low_latency,
      audience_4k_low_latency,
      audience_audio_ultra_low_latency,
      audience_sd_ultra_low_latency,
      audience_hd_ultra_low_latency,
      audience_hdp_ultra_low_latency,
      audience_1080p_ultra_low_latency,
      audience_2k_ultra_low_latency,
      audience_4k_ultra_low_latency,
      total_last1 AS audio_video_last,
      audio_last1 AS audio_last,
      video_last1 AS video_last,
      video_sd_last1 AS video_sd_last,
      video_hd_last1 AS video_hd_last,
      video_hdp_last1 AS video_hdp_last,
      host_sd_last1 AS host_video_sd_last,
      audience_sd_last1 AS audience_video_sd_last,
      host_hd_last1 AS host_video_hd_last,
      audience_hd_last1 AS audience_video_hd_last,
      host_hdp_last1 AS host_video_hdp_last,
      audience_hdp_last1 AS audience_video_hdp_last,
      host_audio_last1 AS host_audio_last,
      audience_audio_last1 AS audience_audio_last,
      host_video_last1 AS host_video_last,
      audience_video_last1 AS audience_video_last,
      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,
      audience_video_low_latency_last1 AS audience_video_low_latency_last,
      audience_total_low_latency_last1 AS audience_total_low_latency_last,
      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,
      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,
      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,
      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,
      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,
      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,
      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,
      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,
      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,
      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,
      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,
      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,
      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,
      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,
      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,
      audience_2k_last1 AS audience_2k_last,
      audience_4k_last1 AS audience_4k_last,
      audience_1080p_last1 AS audience_1080p_last,
      host_1080p_last1 AS host_1080p_last,
      host_2k_last1 AS host_2k_last,
      host_4k_last1 AS host_4k_last,
      total_last7,
      audio_last7,
      video_last7,
      video_sd_last7,
      video_hd_last7,
      video_hdp_last7,
      host_sd_last7,
      audience_sd_last7,
      host_hd_last7,
      audience_hd_last7,
      host_hdp_last7,
      audience_hdp_last7,
      host_audio_last7,
      audience_audio_last7,
      host_video_last7,
      audience_video_last7,
      audience_audio_low_latency_last7,
      audience_video_low_latency_last7,
      audience_total_low_latency_last7,
      audience_sd_low_latency_last7,
      audience_hd_low_latency_last7,
      audience_hdp_low_latency_last7,
      audience_1080p_low_latency_last7,
      audience_2k_low_latency_last7,
      audience_4k_low_latency_last7,
      audience_audio_ultra_low_latency_last7,
      audience_video_ultra_low_latency_last7,
      audience_total_ultra_low_latency_last7,
      audience_sd_ultra_low_latency_last7,
      audience_hd_ultra_low_latency_last7,
      audience_hdp_ultra_low_latency_last7,
      audience_1080p_ultra_low_latency_last7,
      audience_2k_ultra_low_latency_last7,
      audience_4k_ultra_low_latency_last7,
      audience_2k_last7,
      audience_4k_last7,
      audience_1080p_last7,
      host_1080p_last7,
      host_2k_last7,
      host_4k_last7
    FROM levels_usage_dod_di_1
    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-06') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-04') AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS ""自定义 SQL 查询""
  CROSS JOIN (SELECT MAX(date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d')) AS ""__measure__0""
    FROM (SELECT date,
            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,
          start_date AS start_date_7,
          end_date AS end_date,
          tag,
          area AS Scope,
          dim,
            CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,
          level2,
          level3,
          level4,
          product_level1 AS product_line,
          product_level2,
          product_level3,
          product_level4,
          vid_internal_industry_en AS cid_industry,
          vid_use_case_en AS vid_use_case_cn,
          vid_sector_en,
          ver_type,
          ver,
          os,
          domain,
          country,
          region,
          dim_grouping_name,
            CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,
          total AS totalUsage,
          audio,
          video,
          host_audio,
          audience_audio,
          host_sd,
          host_hd,
          host_hdp,
          host_1080p,
          host_2k,
          host_4k,
          audience_sd,
          audience_hd,
          audience_hdp,
          audience_1080p,
          audience_2k,
          audience_4k,
          audience_audio_low_latency,
          audience_sd_low_latency,
          audience_hd_low_latency,
          audience_hdp_low_latency,
          audience_1080p_low_latency,
          audience_2k_low_latency,
          audience_4k_low_latency,
          audience_audio_ultra_low_latency,
          audience_sd_ultra_low_latency,
          audience_hd_ultra_low_latency,
          audience_hdp_ultra_low_latency,
          audience_1080p_ultra_low_latency,
          audience_2k_ultra_low_latency,
          audience_4k_ultra_low_latency,
          total_last1 AS audio_video_last,
          audio_last1 AS audio_last,
          video_last1 AS video_last,
          video_sd_last1 AS video_sd_last,
          video_hd_last1 AS video_hd_last,
          video_hdp_last1 AS video_hdp_last,
          host_sd_last1 AS host_video_sd_last,
          audience_sd_last1 AS audience_video_sd_last,
          host_hd_last1 AS host_video_hd_last,
          audience_hd_last1 AS audience_video_hd_last,
          host_hdp_last1 AS host_video_hdp_last,
          audience_hdp_last1 AS audience_video_hdp_last,
          host_audio_last1 AS host_audio_last,
          audience_audio_last1 AS audience_audio_last,
          host_video_last1 AS host_video_last,
          audience_video_last1 AS audience_video_last,
          audience_audio_low_latency_last1 AS audience_audio_low_latency_last,
          audience_video_low_latency_last1 AS audience_video_low_latency_last,
          audience_total_low_latency_last1 AS audience_total_low_latency_last,
          audience_sd_low_latency_last1 AS audience_sd_low_latency_last,
          audience_hd_low_latency_last1 AS audience_hd_low_latency_last,
          audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,
          audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,
          audience_2k_low_latency_last1 AS audience_2k_low_latency_last,
          audience_4k_low_latency_last1 AS audience_4k_low_latency_last,
          audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,
          audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,
          audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,
          audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,
          audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,
          audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,
          audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,
          audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,
          audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,
          audience_2k_last1 AS audience_2k_last,
          audience_4k_last1 AS audience_4k_last,
          audience_1080p_last1 AS audience_1080p_last,
          host_1080p_last1 AS host_1080p_last,
          host_2k_last1 AS host_2k_last,
          host_4k_last1 AS host_4k_last,
          total_last7,
          audio_last7,
          video_last7,
          video_sd_last7,
          video_hd_last7,
          video_hdp_last7,
          host_sd_last7,
          audience_sd_last7,
          host_hd_last7,
          audience_hd_last7,
          host_hdp_last7,
          audience_hdp_last7,
          host_audio_last7,
          audience_audio_last7,
          host_video_last7,
          audience_video_last7,
          audience_audio_low_latency_last7,
          audience_video_low_latency_last7,
          audience_total_low_latency_last7,
          audience_sd_low_latency_last7,
          audience_hd_low_latency_last7,
          audience_hdp_low_latency_last7,
          audience_1080p_low_latency_last7,
          audience_2k_low_latency_last7,
          audience_4k_low_latency_last7,
          audience_audio_ultra_low_latency_last7,
          audience_video_ultra_low_latency_last7,
          audience_total_ultra_low_latency_last7,
          audience_sd_ultra_low_latency_last7,
          audience_hd_ultra_low_latency_last7,
          audience_hdp_ultra_low_latency_last7,
          audience_1080p_ultra_low_latency_last7,
          audience_2k_ultra_low_latency_last7,
          audience_4k_ultra_low_latency_last7,
          audience_2k_last7,
          audience_4k_last7,
          audience_1080p_last7,
          host_1080p_last7,
          host_2k_last7,
          host_4k_last7
        FROM levels_usage_dod_di_1
        WHERE CAST(tag AS VARCHAR) = 'Industry' AND date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-06') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-04') AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS ""自定义 SQL 查询""
    HAVING COUNT(1) > 0) AS ""t0""
WHERE ""自定义 SQL 查询"".""dim"" = 1 AND ""自定义 SQL 查询"".""rank_level1"" = 4 AND date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d') = ""t0"".""__measure__0""
GROUP BY 36"
"SELECT ""自定义 SQL 查询"".""srcCountry"" AS ""srcCountry"",
  ""自定义 SQL 查询"".""srcDomain"" AS ""srcDomain"",
  ""自定义 SQL 查询"".""srcisp"" AS ""srcisp"",
    CASE WHEN SUM(""自定义 SQL 查询"".""p2s_total"") >= 0 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100 THEN '0-100' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 1000 THEN '100-1000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 1000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 10000 THEN '1000-10000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 10000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100000 THEN '10000-100000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100000 THEN '100000以上' ELSE 'other' END AS ""usr_Calculation_5363224211563417605_nk""
FROM (SELECT date AS ""date"",
      src_domain AS ""srcDomain"",
      src_country AS ""srcCountry"",
      dest_idc AS ""idc"",
      speaker_ip_isp AS ""srcisp"",
      speaker_vos_ip,
      delay_25 AS ""p2s_Delay25"",
      delay_50 AS ""p2s_Delay50"",
      delay_75 AS ""p2s_Delay75"",
      delay_100 AS ""p2s_Delay100"",
      delay_125 AS ""p2s_Delay125"",
      delay_150 AS ""p2s_Delay150"",
      delay_total,
      lost_ratio_5 AS ""p2s_lostRatio"",
      lostratio_total AS ""p2s_total"",
      jitter95_50 AS ""p2s_jitter95_50"",
      jitter95_100 AS ""p2s_jitter95_100"",
      jitter95_200 AS ""p2s_jitter95_200"",
      jitter95_300 AS ""p2s_jitter95_300"",
      jitter95_total,
      product_line,
      product_type
    FROM media.p2s_cover_oversea_ip
    WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-25') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-01')) AS ""自定义 SQL 查询""
GROUP BY 1,
  2,
  3"
"SELECT '跳转：视频可用性' AS ""Calculation_5876704998657425411""
FROM (SELECT t1.date,
        CASE WHEN CAST(stat_period AS VARCHAR) = 'day' THEN substr(CAST(date_parse(cast( t1.date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(substr(CAST(start_date AS VARCHAR), 1, 10) AS VARCHAR), '~', CAST(substr(CAST(end_date AS VARCHAR), 1, 10) AS VARCHAR)) END AS period,
      start_date,
      end_date,
      stat_period,
      tag,
      t1.dim,
      level1,
      level2,
      level3,
      level4,
      os,
      ver,
      ver_type,
      domain,
      country,
      region,
      net,
      vid,
      project,
      company_id,
      company_name,
      rowsnum,
      lastusage,
      thisusage,
      fiveSecJoinSuccess,
      totalJoin,
      cnt_sid,
      video_freeze_time,
      video_totaltime,
      audio_freeze_time,
      audio_totaltime,
      s2l_total_delay_sec,
      s2l_25ms_delay_sec,
      s2l_75ms_delay_sec,
      p2s_lost_Leq5,
      p2s_lost_all,
      crash_cnt,
      service_cnt,
      ""1s_succ_join_ap_cnt"",
      ""5s_succ_join_ap_cnt"",
      total_join_ap_cnt,
      totalJoinSuccess,
      threeSecJoinSuccess,
      video_freeze_time_200,
      video_totaltime_200,
      video_freeze_time_500,
      video_totaltime_500,
      ""3s_succ_join_session_cnt_last1"",
      ""5s_succ_join_session_cnt_last1"",
      succ_join_session_cnt_last1,
      total_join_session_cnt_last1,
      total_session_cnt_last1,
      ""1s_succ_join_ap_cnt_last1"",
      ""5s_succ_join_ap_cnt_last1"",
      total_join_ap_cnt_last1,
      ""3s_succ_join_session_cnt_last7"",
      ""5s_succ_join_session_cnt_last7"",
      succ_join_session_cnt_last7,
      total_join_session_cnt_last7,
      total_session_cnt_last7,
      ""1s_succ_join_ap_cnt_last7"",
      ""5s_succ_join_ap_cnt_last7"",
      total_join_ap_cnt_last7,
      video_freeze_time_last1,
      video_totaltime_last1,
      video_freeze_time_500_last1,
      video_totaltime_500_last1,
      video_freeze_time_200_last1,
      video_totaltime_200_last1,
      video_freeze_time_last7,
      video_totaltime_last7,
      video_freeze_time_500_last7,
      video_totaltime_500_last7,
      video_freeze_time_200_last7,
      video_totaltime_200_last7,
      audio_freeze_time_last1,
      audio_totaltime_last1,
      audio_freeze_time_last7,
      audio_totaltime_last7,
      s2l_total_delay_sec_last1,
      s2l_25ms_delay_sec_last1,
      s2l_75ms_delay_sec_last1,
      s2l_total_delay_sec_last7,
      s2l_25ms_delay_sec_last7,
      s2l_75ms_delay_sec_last7,
      p2s_lost_Leq5_last1,
      p2s_lost_all_last1,
      p2s_lost_Leq5_last7,
      p2s_lost_all_last7,
      crash_cnt_last1,
      service_cnt_last1,
      crash_cnt_last7,
      service_cnt_last7,
      product_level1,
      product_level2,
      product_level3,
      product_level4,
      s2l_lost_Leq5,
      s2l_lost_all,
      s2l_lost_Leq5_last1,
      s2l_lost_all_last1,
      s2l_lost_Leq5_last7,
      s2l_lost_all_last7,
      fiveSecJoinSuccess_total,
      totalJoin_total,
      cnt_sid_total,
      video_freeze_time_total,
      video_totaltime_total,
      audio_freeze_time_total,
      audio_totaltime_total,
      s2l_total_delay_sec_total,
      s2l_25ms_delay_sec_total,
      s2l_75ms_delay_sec_total,
      p2s_lost_Leq5_total,
      p2s_lost_all_total,
      crash_cnt_total,
      service_cnt_total,
      ""1s_succ_join_ap_cnt_total"",
      ""5s_succ_join_ap_cnt_total"",
      total_join_ap_cnt_total,
      totalJoinSuccess_total,
      threeSecJoinSuccess_total,
      video_freeze_time_200_total,
      video_totaltime_200_total,
      video_freeze_time_500_total,
      video_totaltime_500_total,
      ""3s_succ_join_session_cnt_last1_total"",
      ""5s_succ_join_session_cnt_last1_total"",
      succ_join_session_cnt_last1_total,
      total_join_session_cnt_last1_total,
      total_session_cnt_last1_total,
      ""1s_succ_join_ap_cnt_last1_total"",
      ""5s_succ_join_ap_cnt_last1_total"",
      total_join_ap_cnt_last1_total,
      ""3s_succ_join_session_cnt_last7_total"",
      ""5s_succ_join_session_cnt_last7_total"",
      succ_join_session_cnt_last7_total,
      total_join_session_cnt_last7_total,
      total_session_cnt_last7_total,
      ""1s_succ_join_ap_cnt_last7_total"",
      ""5s_succ_join_ap_cnt_last7_total"",
      total_join_ap_cnt_last7_total,
      video_freeze_time_last1_total,
      video_totaltime_last1_total,
      video_freeze_time_500_last1_total,
      video_totaltime_500_last1_total,
      video_freeze_time_200_last1_total,
      video_totaltime_200_last1_total,
      video_freeze_time_last7_total,
      video_totaltime_last7_total,
      video_freeze_time_500_last7_total,
      video_totaltime_500_last7_total,
      video_freeze_time_200_last7_total,
      video_totaltime_200_last7_total,
      audio_freeze_time_last1_total,
      audio_totaltime_last1_total,
      audio_freeze_time_last7_total,
      audio_totaltime_last7_total,
      s2l_total_delay_sec_last1_total,
      s2l_25ms_delay_sec_last1_total,
      s2l_75ms_delay_sec_last1_total,
      s2l_total_delay_sec_last7_total,
      s2l_25ms_delay_sec_last7_total,
      s2l_75ms_delay_sec_last7_total,
      p2s_lost_Leq5_last1_total,
      p2s_lost_all_last1_total,
      p2s_lost_Leq5_last7_total,
      p2s_lost_all_last7_total,
      crash_cnt_last1_total,
      service_cnt_last1_total,
      crash_cnt_last7_total,
      service_cnt_last7_total,
      s2l_lost_Leq5_total,
      s2l_lost_all_total,
      s2l_lost_Leq5_last1_total,
      s2l_lost_all_last1_total,
      s2l_lost_Leq5_last7_total,
      s2l_lost_all_last7_total
    FROM report_datahub.pub_levels_quality_di_1 AS t1
      LEFT JOIN (SELECT date,
          dim,
          SUM(fiveSecJoinSuccess) AS fiveSecJoinSuccess_total,
          SUM(totalJoin) AS totalJoin_total,
          SUM(cnt_sid) AS cnt_sid_total,
          SUM(video_freeze_time) AS video_freeze_time_total,
          SUM(video_totaltime) AS video_totaltime_total,
          SUM(audio_freeze_time) AS audio_freeze_time_total,
          SUM(audio_totaltime) AS audio_totaltime_total,
          SUM(s2l_total_delay_sec) AS s2l_total_delay_sec_total,
          SUM(s2l_25ms_delay_sec) AS s2l_25ms_delay_sec_total,
          SUM(s2l_75ms_delay_sec) AS s2l_75ms_delay_sec_total,
          SUM(p2s_lost_Leq5) AS p2s_lost_Leq5_total,
          SUM(p2s_lost_all) AS p2s_lost_all_total,
          SUM(crash_cnt) AS crash_cnt_total,
          SUM(service_cnt) AS service_cnt_total,
          SUM(""1s_succ_join_ap_cnt"") AS ""1s_succ_join_ap_cnt_total"",
          SUM(""5s_succ_join_ap_cnt"") AS ""5s_succ_join_ap_cnt_total"",
          SUM(total_join_ap_cnt) AS total_join_ap_cnt_total,
          SUM(totalJoinSuccess) AS totalJoinSuccess_total,
          SUM(threeSecJoinSuccess) AS threeSecJoinSuccess_total,
          SUM(video_freeze_time_200) AS video_freeze_time_200_total,
          SUM(video_totaltime_200) AS video_totaltime_200_total,
          SUM(video_freeze_time_500) AS video_freeze_time_500_total,
          SUM(video_totaltime_500) AS video_totaltime_500_total,
          SUM(""3s_succ_join_session_cnt_last1"") AS ""3s_succ_join_session_cnt_last1_total"",
          SUM(""5s_succ_join_session_cnt_last1"") AS ""5s_succ_join_session_cnt_last1_total"",
          SUM(succ_join_session_cnt_last1) AS succ_join_session_cnt_last1_total,
          SUM(total_join_session_cnt_last1) AS total_join_session_cnt_last1_total,
          SUM(total_session_cnt_last1) AS total_session_cnt_last1_total,
          SUM(""1s_succ_join_ap_cnt_last1"") AS ""1s_succ_join_ap_cnt_last1_total"",
          SUM(""5s_succ_join_ap_cnt_last1"") AS ""5s_succ_join_ap_cnt_last1_total"",
          SUM(total_join_ap_cnt_last1) AS total_join_ap_cnt_last1_total,
          SUM(""3s_succ_join_session_cnt_last7"") AS ""3s_succ_join_session_cnt_last7_total"",
          SUM(""5s_succ_join_session_cnt_last7"") AS ""5s_succ_join_session_cnt_last7_total"",
          SUM(succ_join_session_cnt_last7) AS succ_join_session_cnt_last7_total,
          SUM(total_join_session_cnt_last7) AS total_join_session_cnt_last7_total,
          SUM(total_session_cnt_last7) AS total_session_cnt_last7_total,
          SUM(""1s_succ_join_ap_cnt_last7"") AS ""1s_succ_join_ap_cnt_last7_total"",
          SUM(""5s_succ_join_ap_cnt_last7"") AS ""5s_succ_join_ap_cnt_last7_total"",
          SUM(total_join_ap_cnt_last7) AS total_join_ap_cnt_last7_total,
          SUM(video_freeze_time_last1) AS video_freeze_time_last1_total,
          SUM(video_totaltime_last1) AS video_totaltime_last1_total,
          SUM(video_freeze_time_500_last1) AS video_freeze_time_500_last1_total,
          SUM(video_totaltime_500_last1) AS video_totaltime_500_last1_total,
          SUM(video_freeze_time_200_last1) AS video_freeze_time_200_last1_total,
          SUM(video_totaltime_200_last1) AS video_totaltime_200_last1_total,
          SUM(video_freeze_time_last7) AS video_freeze_time_last7_total,
          SUM(video_totaltime_last7) AS video_totaltime_last7_total,
          SUM(video_freeze_time_500_last7) AS video_freeze_time_500_last7_total,
          SUM(video_totaltime_500_last7) AS video_totaltime_500_last7_total,
          SUM(video_freeze_time_200_last7) AS video_freeze_time_200_last7_total,
          SUM(video_totaltime_200_last7) AS video_totaltime_200_last7_total,
          SUM(audio_freeze_time_last1) AS audio_freeze_time_last1_total,
          SUM(audio_totaltime_last1) AS audio_totaltime_last1_total,
          SUM(audio_freeze_time_last7) AS audio_freeze_time_last7_total,
          SUM(audio_totaltime_last7) AS audio_totaltime_last7_total,
          SUM(s2l_total_delay_sec_last1) AS s2l_total_delay_sec_last1_total,
          SUM(s2l_25ms_delay_sec_last1) AS s2l_25ms_delay_sec_last1_total,
          SUM(s2l_75ms_delay_sec_last1) AS s2l_75ms_delay_sec_last1_total,
          SUM(s2l_total_delay_sec_last7) AS s2l_total_delay_sec_last7_total,
          SUM(s2l_25ms_delay_sec_last7) AS s2l_25ms_delay_sec_last7_total,
          SUM(s2l_75ms_delay_sec_last7) AS s2l_75ms_delay_sec_last7_total,
          SUM(p2s_lost_Leq5_last1) AS p2s_lost_Leq5_last1_total,
          SUM(p2s_lost_all_last1) AS p2s_lost_all_last1_total,
          SUM(p2s_lost_Leq5_last7) AS p2s_lost_Leq5_last7_total,
          SUM(p2s_lost_all_last7) AS p2s_lost_all_last7_total,
          SUM(crash_cnt_last1) AS crash_cnt_last1_total,
          SUM(service_cnt_last1) AS service_cnt_last1_total,
          SUM(crash_cnt_last7) AS crash_cnt_last7_total,
          SUM(service_cnt_last7) AS service_cnt_last7_total,
          SUM(s2l_lost_Leq5) AS s2l_lost_Leq5_total,
          SUM(s2l_lost_all) AS s2l_lost_all_total,
          SUM(s2l_lost_Leq5_last1) AS s2l_lost_Leq5_last1_total,
          SUM(s2l_lost_all_last1) AS s2l_lost_all_last1_total,
          SUM(s2l_lost_Leq5_last7) AS s2l_lost_Leq5_last7_total,
          SUM(s2l_lost_all_last7) AS s2l_lost_all_last7_total
        FROM report_datahub.pub_levels_quality_di_1
        WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-21') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-05') AND CAST(tag AS VARCHAR) = 'Product'
        GROUP BY date,
          dim) AS t2 ON t1.date = t2.date AND t1.dim = t2.dim
    WHERE date_parse(cast( t1.date as VARCHAR), '%Y%m%d') >= DATE('2021-11-21') AND date_parse(cast( t1.date as VARCHAR), '%Y%m%d') <= DATE('2021-12-05') AND CAST(tag AS VARCHAR) = 'Product') AS ""自定义 SQL 查询""
WHERE CASE WHEN CAST(""自定义 SQL 查询"".""tag"" AS VARCHAR) = 'Industry' AND CAST(""自定义 SQL 查询"".""product_level1"" AS VARCHAR) = 'RTC' AND CAST(""自定义 SQL 查询"".""dim"" AS VARCHAR) = 'osver' THEN 0 WHEN CAST(""自定义 SQL 查询"".""tag"" AS VARCHAR) = 'VerType' AND CAST(""自定义 SQL 查询"".""product_level1"" AS VARCHAR) = 'RTC' AND CAST(""自定义 SQL 查询"".""dim"" AS VARCHAR) = 'osver' THEN 0 WHEN CAST(""自定义 SQL 查询"".""tag"" AS VARCHAR) = 'Product' AND CAST(""自定义 SQL 查询"".""dim"" AS VARCHAR) = 'osver' AND CAST(""自定义 SQL 查询"".""product_level1"" AS VARCHAR) = 'RTC' THEN 1 ELSE 0 END
HAVING COUNT(1) > 0"
"SELECT SUM(""自定义 SQL 查询"".""p2s_Delay25"" * ""自定义 SQL 查询"".""delay_total"") AS ""TEMP(Calculation_1122874106494361604)(1461110105)(0)"",
  SUM(""自定义 SQL 查询"".""delay_total"") AS ""TEMP(Calculation_1122874106494361604)(363980608)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_Delay50"" * ""自定义 SQL 查询"".""delay_total"") AS ""TEMP(Calculation_1122874106494976005)(1551638771)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_Delay75"" * ""自定义 SQL 查询"".""delay_total"") AS ""TEMP(Calculation_1122874106495696902)(2562427304)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_lostRatio"" * ""自定义 SQL 查询"".""p2s_total"") AS ""TEMP(Calculation_1122874106495848455)(1741181994)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_total"") AS ""TEMP(Calculation_1122874106495848455)(2624355999)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_jitter95_100"" * ""自定义 SQL 查询"".""jitter95_total"") AS ""TEMP(Calculation_4208191644263628803)(3609783325)(0)"",
  SUM(""自定义 SQL 查询"".""jitter95_total"") AS ""TEMP(Calculation_4208191644263628803)(633698484)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_jitter95_50"" * ""自定义 SQL 查询"".""jitter95_total"") AS ""TEMP(Calculation_4208191644264697860)(1652714847)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_jitter95_200"" * ""自定义 SQL 查询"".""jitter95_total"") AS ""TEMP(Calculation_4208191644264935429)(206867949)(0)"",
  ""自定义 SQL 查询"".""dest_ip"" AS ""dest_ip"",
  ""自定义 SQL 查询"".""idc"" AS ""idc"",
  ""自定义 SQL 查询"".""srcRegion"" AS ""srcRegion"",
  ""自定义 SQL 查询"".""src_isp"" AS ""src_isp"",
  SUM(""自定义 SQL 查询"".""p2s_total"") AS ""sum_p2s_total_ok""
FROM (SELECT date AS ""date"",
      src_domain AS ""srcDomain"",
      src_region AS ""srcRegion"",
      dest_idc AS ""idc"",
      src_isp,
      dest_ip,
      delay_25 AS ""p2s_Delay25"",
      delay_50 AS ""p2s_Delay50"",
      delay_75 AS ""p2s_Delay75"",
      delay_100 AS ""p2s_Delay100"",
      delay_125 AS ""p2s_Delay125"",
      delay_150 AS ""p2s_Delay150"",
      delay_total,
      lost_ratio_5 AS ""p2s_lostRatio"",
      lostratio_total AS ""p2s_total"",
      jitter95_50 AS ""p2s_jitter95_50"",
      jitter95_100 AS ""p2s_jitter95_100"",
      jitter95_200 AS ""p2s_jitter95_200"",
      jitter95_300 AS ""p2s_jitter95_300"",
      jitter95_total,
      product_line,
      product_type
    FROM media.p2s_cover_mainland_ip
    WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-25') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-01')) AS ""自定义 SQL 查询""
WHERE (""自定义 SQL 查询"".""idc"" IN ('aofei-hk1ga', 'aofei-singapore1ga', 'evc-singapore1ga', 'evc-singapore1gb', 'huhehaote1g-ctel', 'yancheng1g-ctel', 'zen-saopaulo2') OR ( (  ""自定义 SQL 查询"".""idc""  ) is null) OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'baoji1g-ctel' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'beijing8-bgp' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'changchun1g-cucc' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'changsha1g-cucc' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'changzhou9a-drpeng' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'eq-frankfurt1g' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'evc-chicago1g' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'evc-japan9a' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'foshan1g-ctel' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'huainan1g-cmcc' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'jinan1g-3line' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'jinan9-cmcc' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'jiujiang9-ctel' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'luoyang1g-ctel' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'nanchang1g-cmcc' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'taiyuan6bdbm-ctel' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'taiyuan9-cucc' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'wuxi3c-bgp' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'xiamen6bd-ctel' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'xuzhou9b-ctel' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'yancheng9-cmcc' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'zen-frankfurt1gb' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'zen-frankfurt9a' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'zen-japan9' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'zen-london1ga' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'zen-losangeles9' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'zen-melbourne9a' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'zen-mumbai9' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'zen-singapore1ga' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'zen-washington1ga' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'zhangjiakou1gb-cmcc' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'zhengzhou6bd-cucc' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'zhenjiang1g-3line' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'zhuzhou1g-ctel') AND CAST(""自定义 SQL 查询"".""srcRegion"" AS VARCHAR) >= 'Anhui' AND CAST(""自定义 SQL 查询"".""srcRegion"" AS VARCHAR) <= 'Zhejiang' AND (( (  ""自定义 SQL 查询"".""product_type""  ) is null) OR CAST(""自定义 SQL 查询"".""product_type"" AS VARCHAR) >= 'CloudPlayer' AND CAST(""自定义 SQL 查询"".""product_type"" AS VARCHAR) <= 'WebRTS')
GROUP BY 11,
  12,
  13,
  14
HAVING CASE WHEN SUM(""自定义 SQL 查询"".""p2s_total"") >= 0 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100 THEN 0 WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 1000 THEN 1 WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 1000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 10000 THEN 0 WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 10000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100000 THEN 0 WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100000 THEN 0 ELSE 0 END OR CASE WHEN SUM(""自定义 SQL 查询"".""p2s_total"") >= 0 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100 THEN 0 WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 1000 THEN 0 WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 1000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 10000 THEN 1 WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 10000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100000 THEN 0 WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100000 THEN 0 ELSE 0 END OR CASE WHEN SUM(""自定义 SQL 查询"".""p2s_total"") >= 0 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100 THEN 0 WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 1000 THEN 0 WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 1000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 10000 THEN 0 WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 10000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100000 THEN 1 WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100000 THEN 0 ELSE 0 END OR CASE WHEN SUM(""自定义 SQL 查询"".""p2s_total"") >= 0 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100 THEN 0 WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 1000 THEN 0 WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 1000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 10000 THEN 0 WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 10000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100000 THEN 0 WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100000 THEN 1 ELSE 0 END"
"SELECT CONCAT(CONCAT(CAST(MIN(""t0"".""__measure__0"") AS VARCHAR), '~'), CAST(MIN(""t0"".""__measure__1"") AS VARCHAR)) AS ""Calculation_534802460924358656"",
  ""自定义 SQL 查询"".""product_level1"" AS ""product_level1"",
  ""自定义 SQL 查询"".""product_level2"" AS ""product_level2"",
  ""自定义 SQL 查询"".""product_level3"" AS ""product_level3"",
  SUM(""自定义 SQL 查询"".""audience"") AS ""sum_audience_ok"",
  SUM(""自定义 SQL 查询"".""audience_low_latency"") AS ""sum_audience_low_latency_ok"",
  SUM(""自定义 SQL 查询"".""audio"") AS ""sum_audio_ok"",
  SUM(""自定义 SQL 查询"".""host"") AS ""sum_host_ok"",
  SUM(""自定义 SQL 查询"".""total"") AS ""sum_total_ok"",
  SUM(""自定义 SQL 查询"".""video"") AS ""sum_video_ok"",
  SUM(""自定义 SQL 查询"".""video_hd"") AS ""sum_video_hd_ok"",
  SUM(""自定义 SQL 查询"".""video_hdp"") AS ""sum_video_hdp_ok"",
  SUM(""自定义 SQL 查询"".""video_sd"") AS ""sum_video_sd_ok""
FROM (SELECT date,
      SUBSTR(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) AS date_range_1,
      SUBSTR(CAST(end_date AS VARCHAR), 1, 10) AS date_range_2,
      stat_period,
        CASE WHEN CAST(stat_period AS VARCHAR) = 'day' THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,
      area,
      vid,
      project,
      company_id AS cid,
      company_name AS company,
      customer_level AS level,
      vid_internal_industry_en AS industry,
      vid_use_case_cn,
      csdc_owner,
      os,
      ver,
      ver_type,
      product_level1,
      product_level2,
      product_level3,
      total,
      audio,
      video,
      video_sd,
      video_hd,
      video_hdp,
        host_audio + host_video AS host,
      host_audio,
      host_video,
      host_sd,
      host_hd,
      host_hdp,
        audience_audio + audience_video AS audience,
        audience_audio_low_latency + audience_video_low_latency AS audience_low_latency,
      audience_audio,
      audience_audio_low_latency,
      audience_video,
      audience_video_low_latency,
      audience_sd,
      audience_sd_low_latency,
      audience_hd,
      audience_hd_low_latency,
      audience_hdp,
      audience_hdp_low_latency,
      total_last1,
      audio_last1,
      video_last1,
      video_sd_last1,
      video_hd_last1,
      video_hdp_last1,
        host_audio_last1 + host_video_last1 AS host_last1,
      host_audio_last1,
      host_video_last1,
        audience_audio_last1 + audience_video_last1 AS audience_last1,
        audience_audio_low_latency_last1 + audience_video_low_latency_last1 AS audience_low_latency_last1,
      audience_audio_last1,
      audience_audio_low_latency_last1,
      audience_video_last1,
      audience_video_low_latency_last1,
      total_last7,
      audio_last7,
      video_last7,
      video_sd_last7,
      video_hd_last7,
      video_hdp_last7,
        host_audio_last7 + host_video_last7 AS host_last7,
      host_audio_last7,
      host_video_last7,
        audience_audio_last7 + audience_video_last7 AS audience_last7,
        audience_audio_low_latency_last7 + audience_video_low_latency_last7 AS audience_low_latency_last7,
      audience_audio_last7,
      audience_audio_low_latency_last7,
      audience_video_last7,
      audience_video_low_latency_last7
    FROM report_datahub.vendor_vid_usage_di_1
    WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-06') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-06') AND CAST(vid AS VARCHAR) = CAST(311291 AS VARCHAR) AND dim = 1) AS ""自定义 SQL 查询""
  CROSS JOIN (SELECT MIN(""自定义 SQL 查询"".""date_range_1"") AS ""__measure__0"",
      MAX(""自定义 SQL 查询"".""date_range_2"") AS ""__measure__1""
    FROM (SELECT date,
          SUBSTR(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) AS date_range_1,
          SUBSTR(CAST(end_date AS VARCHAR), 1, 10) AS date_range_2,
          stat_period,
            CASE WHEN CAST(stat_period AS VARCHAR) = 'day' THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,
          area,
          vid,
          project,
          company_id AS cid,
          company_name AS company,
          customer_level AS level,
          vid_internal_industry_en AS industry,
          vid_use_case_cn,
          csdc_owner,
          os,
          ver,
          ver_type,
          product_level1,
          product_level2,
          product_level3,
          total,
          audio,
          video,
          video_sd,
          video_hd,
          video_hdp,
            host_audio + host_video AS host,
          host_audio,
          host_video,
          host_sd,
          host_hd,
          host_hdp,
            audience_audio + audience_video AS audience,
            audience_audio_low_latency + audience_video_low_latency AS audience_low_latency,
          audience_audio,
          audience_audio_low_latency,
          audience_video,
          audience_video_low_latency,
          audience_sd,
          audience_sd_low_latency,
          audience_hd,
          audience_hd_low_latency,
          audience_hdp,
          audience_hdp_low_latency,
          total_last1,
          audio_last1,
          video_last1,
          video_sd_last1,
          video_hd_last1,
          video_hdp_last1,
            host_audio_last1 + host_video_last1 AS host_last1,
          host_audio_last1,
          host_video_last1,
            audience_audio_last1 + audience_video_last1 AS audience_last1,
            audience_audio_low_latency_last1 + audience_video_low_latency_last1 AS audience_low_latency_last1,
          audience_audio_last1,
          audience_audio_low_latency_last1,
          audience_video_last1,
          audience_video_low_latency_last1,
          total_last7,
          audio_last7,
          video_last7,
          video_sd_last7,
          video_hd_last7,
          video_hdp_last7,
            host_audio_last7 + host_video_last7 AS host_last7,
          host_audio_last7,
          host_video_last7,
            audience_audio_last7 + audience_video_last7 AS audience_last7,
            audience_audio_low_latency_last7 + audience_video_low_latency_last7 AS audience_low_latency_last7,
          audience_audio_last7,
          audience_audio_low_latency_last7,
          audience_video_last7,
          audience_video_low_latency_last7
        FROM report_datahub.vendor_vid_usage_di_1
        WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-06') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-06') AND CAST(vid AS VARCHAR) = CAST(311291 AS VARCHAR) AND dim = 1) AS ""自定义 SQL 查询""
    HAVING COUNT(1) > 0) AS ""t0""
GROUP BY 2,
  3,
  4"
"SELECT SUM(""自定义 SQL 查询"".""host_4k_last"") AS ""TEMP(Calculation_3519281700083154949)(101123376)(0)"",
  SUM(""自定义 SQL 查询"".""host_4k"") AS ""TEMP(Calculation_3519281700083154949)(1075454865)(0)"",
  SUM(""自定义 SQL 查询"".""audience_sd"") AS ""TEMP(Calculation_3519281700083154949)(1133678835)(0)"",
  SUM(""自定义 SQL 查询"".""audience_video_hdp_last"") AS ""TEMP(Calculation_3519281700083154949)(1200517625)(0)"",
  SUM(""自定义 SQL 查询"".""host_1080p"") AS ""TEMP(Calculation_3519281700083154949)(1312501967)(0)"",
  SUM(""自定义 SQL 查询"".""audience_1080p_last"") AS ""TEMP(Calculation_3519281700083154949)(1314346200)(0)"",
  SUM(""自定义 SQL 查询"".""audience_video_hd_last"") AS ""TEMP(Calculation_3519281700083154949)(146570423)(0)"",
  SUM(""自定义 SQL 查询"".""audience_2k_last"") AS ""TEMP(Calculation_3519281700083154949)(1717771635)(0)"",
  SUM(""自定义 SQL 查询"".""audience_audio_last"") AS ""TEMP(Calculation_3519281700083154949)(2313111073)(0)"",
  SUM(""自定义 SQL 查询"".""host_video_hdp_last"") AS ""TEMP(Calculation_3519281700083154949)(258310559)(0)"",
  SUM(""自定义 SQL 查询"".""host_hd"") AS ""TEMP(Calculation_3519281700083154949)(276907208)(0)"",
  SUM(""自定义 SQL 查询"".""audio_video_last"") AS ""TEMP(Calculation_3519281700083154949)(2820618408)(0)"",
  SUM(""自定义 SQL 查询"".""video"") AS ""TEMP(Calculation_3519281700083154949)(2929708110)(0)"",
  SUM(""自定义 SQL 查询"".""audience_hd"") AS ""TEMP(Calculation_3519281700083154949)(2930728935)(0)"",
  SUM(""自定义 SQL 查询"".""audience_hdp"") AS ""TEMP(Calculation_3519281700083154949)(3010533957)(0)"",
  SUM(""自定义 SQL 查询"".""host_hdp"") AS ""TEMP(Calculation_3519281700083154949)(30306054)(0)"",
  SUM(""自定义 SQL 查询"".""host_audio"") AS ""TEMP(Calculation_3519281700083154949)(3087054365)(0)"",
  SUM(""自定义 SQL 查询"".""audience_4k_last"") AS ""TEMP(Calculation_3519281700083154949)(3121859593)(0)"",
  SUM(""自定义 SQL 查询"".""host_1080p_last"") AS ""TEMP(Calculation_3519281700083154949)(3222422303)(0)"",
  SUM(""自定义 SQL 查询"".""host_audio_last"") AS ""TEMP(Calculation_3519281700083154949)(3227677803)(0)"",
  SUM(""自定义 SQL 查询"".""audio"") AS ""TEMP(Calculation_3519281700083154949)(3299350010)(0)"",
  SUM(""自定义 SQL 查询"".""audience_1080p"") AS ""TEMP(Calculation_3519281700083154949)(3628946582)(0)"",
  SUM(""自定义 SQL 查询"".""totalUsage"") AS ""TEMP(Calculation_3519281700083154949)(3847882359)(0)"",
  SUM(""自定义 SQL 查询"".""video_last"") AS ""TEMP(Calculation_3519281700083154949)(3934387163)(0)"",
  SUM(""自定义 SQL 查询"".""host_2k_last"") AS ""TEMP(Calculation_3519281700083154949)(4055292783)(0)"",
  SUM(""自定义 SQL 查询"".""audio_last"") AS ""TEMP(Calculation_3519281700083154949)(4091190060)(0)"",
  SUM(""自定义 SQL 查询"".""audience_audio"") AS ""TEMP(Calculation_3519281700083154949)(4109514392)(0)"",
  SUM(""自定义 SQL 查询"".""host_video_hd_last"") AS ""TEMP(Calculation_3519281700083154949)(4170367250)(0)"",
  SUM(""自定义 SQL 查询"".""host_video_sd_last"") AS ""TEMP(Calculation_3519281700083154949)(4190307025)(0)"",
  SUM(""自定义 SQL 查询"".""host_2k"") AS ""TEMP(Calculation_3519281700083154949)(586790827)(0)"",
  SUM(""自定义 SQL 查询"".""host_sd"") AS ""TEMP(Calculation_3519281700083154949)(709512178)(0)"",
  SUM(""自定义 SQL 查询"".""audience_4k"") AS ""TEMP(Calculation_3519281700083154949)(764410224)(0)"",
  SUM(""自定义 SQL 查询"".""audience_video_sd_last"") AS ""TEMP(Calculation_3519281700083154949)(933007102)(0)"",
  SUM(""自定义 SQL 查询"".""audience_2k"") AS ""TEMP(Calculation_3519281700083154949)(943764407)(0)"",
  AVG(""自定义 SQL 查询"".""totalUsage"") AS ""avg_totalUsage_ok"",
  ""自定义 SQL 查询"".""level1"" AS ""level1"",
  SUM(""自定义 SQL 查询"".""totalUsage"") AS ""sum_totalUsage_ok""
FROM (SELECT date,
        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,
      start_date AS start_date_7,
      end_date AS end_date,
      tag,
      area AS Scope,
      dim,
        CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,
      level2,
      level3,
      level4,
      product_level1 AS product_line,
      product_level2,
      product_level3,
      product_level4,
      vid_internal_industry_en AS cid_industry,
      vid_use_case_en AS vid_use_case_cn,
      vid_sector_en,
      ver_type,
      ver,
      os,
      domain,
      country,
      region,
      dim_grouping_name,
        CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,
      total AS totalUsage,
      audio,
      video,
      host_audio,
      audience_audio,
      host_sd,
      host_hd,
      host_hdp,
      host_1080p,
      host_2k,
      host_4k,
      audience_sd,
      audience_hd,
      audience_hdp,
      audience_1080p,
      audience_2k,
      audience_4k,
      audience_audio_low_latency,
      audience_sd_low_latency,
      audience_hd_low_latency,
      audience_hdp_low_latency,
      audience_1080p_low_latency,
      audience_2k_low_latency,
      audience_4k_low_latency,
      audience_audio_ultra_low_latency,
      audience_sd_ultra_low_latency,
      audience_hd_ultra_low_latency,
      audience_hdp_ultra_low_latency,
      audience_1080p_ultra_low_latency,
      audience_2k_ultra_low_latency,
      audience_4k_ultra_low_latency,
      total_last1 AS audio_video_last,
      audio_last1 AS audio_last,
      video_last1 AS video_last,
      video_sd_last1 AS video_sd_last,
      video_hd_last1 AS video_hd_last,
      video_hdp_last1 AS video_hdp_last,
      host_sd_last1 AS host_video_sd_last,
      audience_sd_last1 AS audience_video_sd_last,
      host_hd_last1 AS host_video_hd_last,
      audience_hd_last1 AS audience_video_hd_last,
      host_hdp_last1 AS host_video_hdp_last,
      audience_hdp_last1 AS audience_video_hdp_last,
      host_audio_last1 AS host_audio_last,
      audience_audio_last1 AS audience_audio_last,
      host_video_last1 AS host_video_last,
      audience_video_last1 AS audience_video_last,
      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,
      audience_video_low_latency_last1 AS audience_video_low_latency_last,
      audience_total_low_latency_last1 AS audience_total_low_latency_last,
      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,
      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,
      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,
      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,
      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,
      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,
      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,
      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,
      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,
      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,
      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,
      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,
      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,
      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,
      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,
      audience_2k_last1 AS audience_2k_last,
      audience_4k_last1 AS audience_4k_last,
      audience_1080p_last1 AS audience_1080p_last,
      host_1080p_last1 AS host_1080p_last,
      host_2k_last1 AS host_2k_last,
      host_4k_last1 AS host_4k_last,
      total_last7,
      audio_last7,
      video_last7,
      video_sd_last7,
      video_hd_last7,
      video_hdp_last7,
      host_sd_last7,
      audience_sd_last7,
      host_hd_last7,
      audience_hd_last7,
      host_hdp_last7,
      audience_hdp_last7,
      host_audio_last7,
      audience_audio_last7,
      host_video_last7,
      audience_video_last7,
      audience_audio_low_latency_last7,
      audience_video_low_latency_last7,
      audience_total_low_latency_last7,
      audience_sd_low_latency_last7,
      audience_hd_low_latency_last7,
      audience_hdp_low_latency_last7,
      audience_1080p_low_latency_last7,
      audience_2k_low_latency_last7,
      audience_4k_low_latency_last7,
      audience_audio_ultra_low_latency_last7,
      audience_video_ultra_low_latency_last7,
      audience_total_ultra_low_latency_last7,
      audience_sd_ultra_low_latency_last7,
      audience_hd_ultra_low_latency_last7,
      audience_hdp_ultra_low_latency_last7,
      audience_1080p_ultra_low_latency_last7,
      audience_2k_ultra_low_latency_last7,
      audience_4k_ultra_low_latency_last7,
      audience_2k_last7,
      audience_4k_last7,
      audience_1080p_last7,
      host_1080p_last7,
      host_2k_last7,
      host_4k_last7
    FROM levels_usage_dod_di_1
    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-06') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-04') AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS ""自定义 SQL 查询""
  CROSS JOIN (SELECT MAX(date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d')) AS ""__measure__0""
    FROM (SELECT date,
            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,
          start_date AS start_date_7,
          end_date AS end_date,
          tag,
          area AS Scope,
          dim,
            CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,
          level2,
          level3,
          level4,
          product_level1 AS product_line,
          product_level2,
          product_level3,
          product_level4,
          vid_internal_industry_en AS cid_industry,
          vid_use_case_en AS vid_use_case_cn,
          vid_sector_en,
          ver_type,
          ver,
          os,
          domain,
          country,
          region,
          dim_grouping_name,
            CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,
          total AS totalUsage,
          audio,
          video,
          host_audio,
          audience_audio,
          host_sd,
          host_hd,
          host_hdp,
          host_1080p,
          host_2k,
          host_4k,
          audience_sd,
          audience_hd,
          audience_hdp,
          audience_1080p,
          audience_2k,
          audience_4k,
          audience_audio_low_latency,
          audience_sd_low_latency,
          audience_hd_low_latency,
          audience_hdp_low_latency,
          audience_1080p_low_latency,
          audience_2k_low_latency,
          audience_4k_low_latency,
          audience_audio_ultra_low_latency,
          audience_sd_ultra_low_latency,
          audience_hd_ultra_low_latency,
          audience_hdp_ultra_low_latency,
          audience_1080p_ultra_low_latency,
          audience_2k_ultra_low_latency,
          audience_4k_ultra_low_latency,
          total_last1 AS audio_video_last,
          audio_last1 AS audio_last,
          video_last1 AS video_last,
          video_sd_last1 AS video_sd_last,
          video_hd_last1 AS video_hd_last,
          video_hdp_last1 AS video_hdp_last,
          host_sd_last1 AS host_video_sd_last,
          audience_sd_last1 AS audience_video_sd_last,
          host_hd_last1 AS host_video_hd_last,
          audience_hd_last1 AS audience_video_hd_last,
          host_hdp_last1 AS host_video_hdp_last,
          audience_hdp_last1 AS audience_video_hdp_last,
          host_audio_last1 AS host_audio_last,
          audience_audio_last1 AS audience_audio_last,
          host_video_last1 AS host_video_last,
          audience_video_last1 AS audience_video_last,
          audience_audio_low_latency_last1 AS audience_audio_low_latency_last,
          audience_video_low_latency_last1 AS audience_video_low_latency_last,
          audience_total_low_latency_last1 AS audience_total_low_latency_last,
          audience_sd_low_latency_last1 AS audience_sd_low_latency_last,
          audience_hd_low_latency_last1 AS audience_hd_low_latency_last,
          audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,
          audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,
          audience_2k_low_latency_last1 AS audience_2k_low_latency_last,
          audience_4k_low_latency_last1 AS audience_4k_low_latency_last,
          audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,
          audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,
          audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,
          audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,
          audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,
          audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,
          audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,
          audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,
          audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,
          audience_2k_last1 AS audience_2k_last,
          audience_4k_last1 AS audience_4k_last,
          audience_1080p_last1 AS audience_1080p_last,
          host_1080p_last1 AS host_1080p_last,
          host_2k_last1 AS host_2k_last,
          host_4k_last1 AS host_4k_last,
          total_last7,
          audio_last7,
          video_last7,
          video_sd_last7,
          video_hd_last7,
          video_hdp_last7,
          host_sd_last7,
          audience_sd_last7,
          host_hd_last7,
          audience_hd_last7,
          host_hdp_last7,
          audience_hdp_last7,
          host_audio_last7,
          audience_audio_last7,
          host_video_last7,
          audience_video_last7,
          audience_audio_low_latency_last7,
          audience_video_low_latency_last7,
          audience_total_low_latency_last7,
          audience_sd_low_latency_last7,
          audience_hd_low_latency_last7,
          audience_hdp_low_latency_last7,
          audience_1080p_low_latency_last7,
          audience_2k_low_latency_last7,
          audience_4k_low_latency_last7,
          audience_audio_ultra_low_latency_last7,
          audience_video_ultra_low_latency_last7,
          audience_total_ultra_low_latency_last7,
          audience_sd_ultra_low_latency_last7,
          audience_hd_ultra_low_latency_last7,
          audience_hdp_ultra_low_latency_last7,
          audience_1080p_ultra_low_latency_last7,
          audience_2k_ultra_low_latency_last7,
          audience_4k_ultra_low_latency_last7,
          audience_2k_last7,
          audience_4k_last7,
          audience_1080p_last7,
          host_1080p_last7,
          host_2k_last7,
          host_4k_last7
        FROM levels_usage_dod_di_1
        WHERE CAST(tag AS VARCHAR) = 'Industry' AND date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-06') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-04') AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS ""自定义 SQL 查询""
    HAVING COUNT(1) > 0) AS ""t0""
WHERE ""自定义 SQL 查询"".""dim"" = 1 AND ""自定义 SQL 查询"".""rank_level1"" = 3 AND date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d') = ""t0"".""__measure__0""
GROUP BY 36"
"SHOW FUNCTIONS"
"SELECT ""自定义 SQL 查询"".""srcCountry"" AS ""srcCountry""
FROM (SELECT date AS ""date"",
      src_domain AS ""srcDomain"",
      src_country AS ""srcCountry"",
      dest_idc AS ""idc"",
      delay_25 AS ""p2s_Delay25"",
      delay_50 AS ""p2s_Delay50"",
      delay_75 AS ""p2s_Delay75"",
      delay_100 AS ""p2s_Delay100"",
      delay_125 AS ""p2s_Delay125"",
      delay_150 AS ""p2s_Delay150"",
      delay_total,
      lost_ratio_5 AS ""p2s_lostRatio"",
      lostratio_total AS ""p2s_total"",
      jitter95_50 AS ""p2s_jitter95_50"",
      jitter95_100 AS ""p2s_jitter95_100"",
      jitter95_200 AS ""p2s_jitter95_200"",
      jitter95_300 AS ""p2s_jitter95_300"",
      jitter95_total,
      product_line,
      product_type
    FROM media.p2s_cover_oversea_idc
    WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-25') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-01')) AS ""自定义 SQL 查询""
GROUP BY 1
LIMIT 512"
"SELECT ""自定义 SQL 查询"".""product_line"" AS ""product_line""
FROM (SELECT date AS ""date"",
      src_domain AS ""srcDomain"",
      src_country AS ""srcCountry"",
      dest_idc AS ""idc"",
      speaker_ip_isp AS ""srcisp"",
      speaker_vos_ip,
      delay_25 AS ""p2s_Delay25"",
      delay_50 AS ""p2s_Delay50"",
      delay_75 AS ""p2s_Delay75"",
      delay_100 AS ""p2s_Delay100"",
      delay_125 AS ""p2s_Delay125"",
      delay_150 AS ""p2s_Delay150"",
      delay_total,
      lost_ratio_5 AS ""p2s_lostRatio"",
      lostratio_total AS ""p2s_total"",
      jitter95_50 AS ""p2s_jitter95_50"",
      jitter95_100 AS ""p2s_jitter95_100"",
      jitter95_200 AS ""p2s_jitter95_200"",
      jitter95_300 AS ""p2s_jitter95_300"",
      jitter95_total,
      product_line,
      product_type
    FROM media.p2s_cover_oversea_ip
    WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-25') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-01')) AS ""自定义 SQL 查询""
GROUP BY 1
ORDER BY ""product_line"""
"SELECT SUM(""自定义 SQL 查询"".""host_4k_last"") AS ""TEMP(Calculation_3519281700083154949)(101123376)(0)"",
  SUM(""自定义 SQL 查询"".""host_4k"") AS ""TEMP(Calculation_3519281700083154949)(1075454865)(0)"",
  SUM(""自定义 SQL 查询"".""audience_sd"") AS ""TEMP(Calculation_3519281700083154949)(1133678835)(0)"",
  SUM(""自定义 SQL 查询"".""audience_video_hdp_last"") AS ""TEMP(Calculation_3519281700083154949)(1200517625)(0)"",
  SUM(""自定义 SQL 查询"".""host_1080p"") AS ""TEMP(Calculation_3519281700083154949)(1312501967)(0)"",
  SUM(""自定义 SQL 查询"".""audience_1080p_last"") AS ""TEMP(Calculation_3519281700083154949)(1314346200)(0)"",
  SUM(""自定义 SQL 查询"".""audience_video_hd_last"") AS ""TEMP(Calculation_3519281700083154949)(146570423)(0)"",
  SUM(""自定义 SQL 查询"".""audience_2k_last"") AS ""TEMP(Calculation_3519281700083154949)(1717771635)(0)"",
  SUM(""自定义 SQL 查询"".""audience_audio_last"") AS ""TEMP(Calculation_3519281700083154949)(2313111073)(0)"",
  SUM(""自定义 SQL 查询"".""host_video_hdp_last"") AS ""TEMP(Calculation_3519281700083154949)(258310559)(0)"",
  SUM(""自定义 SQL 查询"".""host_hd"") AS ""TEMP(Calculation_3519281700083154949)(276907208)(0)"",
  SUM(""自定义 SQL 查询"".""audio_video_last"") AS ""TEMP(Calculation_3519281700083154949)(2820618408)(0)"",
  SUM(""自定义 SQL 查询"".""video"") AS ""TEMP(Calculation_3519281700083154949)(2929708110)(0)"",
  SUM(""自定义 SQL 查询"".""audience_hd"") AS ""TEMP(Calculation_3519281700083154949)(2930728935)(0)"",
  SUM(""自定义 SQL 查询"".""audience_hdp"") AS ""TEMP(Calculation_3519281700083154949)(3010533957)(0)"",
  SUM(""自定义 SQL 查询"".""host_hdp"") AS ""TEMP(Calculation_3519281700083154949)(30306054)(0)"",
  SUM(""自定义 SQL 查询"".""host_audio"") AS ""TEMP(Calculation_3519281700083154949)(3087054365)(0)"",
  SUM(""自定义 SQL 查询"".""audience_4k_last"") AS ""TEMP(Calculation_3519281700083154949)(3121859593)(0)"",
  SUM(""自定义 SQL 查询"".""host_1080p_last"") AS ""TEMP(Calculation_3519281700083154949)(3222422303)(0)"",
  SUM(""自定义 SQL 查询"".""host_audio_last"") AS ""TEMP(Calculation_3519281700083154949)(3227677803)(0)"",
  SUM(""自定义 SQL 查询"".""audio"") AS ""TEMP(Calculation_3519281700083154949)(3299350010)(0)"",
  SUM(""自定义 SQL 查询"".""audience_1080p"") AS ""TEMP(Calculation_3519281700083154949)(3628946582)(0)"",
  SUM(""自定义 SQL 查询"".""totalUsage"") AS ""TEMP(Calculation_3519281700083154949)(3847882359)(0)"",
  SUM(""自定义 SQL 查询"".""video_last"") AS ""TEMP(Calculation_3519281700083154949)(3934387163)(0)"",
  SUM(""自定义 SQL 查询"".""host_2k_last"") AS ""TEMP(Calculation_3519281700083154949)(4055292783)(0)"",
  SUM(""自定义 SQL 查询"".""audio_last"") AS ""TEMP(Calculation_3519281700083154949)(4091190060)(0)"",
  SUM(""自定义 SQL 查询"".""audience_audio"") AS ""TEMP(Calculation_3519281700083154949)(4109514392)(0)"",
  SUM(""自定义 SQL 查询"".""host_video_hd_last"") AS ""TEMP(Calculation_3519281700083154949)(4170367250)(0)"",
  SUM(""自定义 SQL 查询"".""host_video_sd_last"") AS ""TEMP(Calculation_3519281700083154949)(4190307025)(0)"",
  SUM(""自定义 SQL 查询"".""host_2k"") AS ""TEMP(Calculation_3519281700083154949)(586790827)(0)"",
  SUM(""自定义 SQL 查询"".""host_sd"") AS ""TEMP(Calculation_3519281700083154949)(709512178)(0)"",
  SUM(""自定义 SQL 查询"".""audience_4k"") AS ""TEMP(Calculation_3519281700083154949)(764410224)(0)"",
  SUM(""自定义 SQL 查询"".""audience_video_sd_last"") AS ""TEMP(Calculation_3519281700083154949)(933007102)(0)"",
  SUM(""自定义 SQL 查询"".""audience_2k"") AS ""TEMP(Calculation_3519281700083154949)(943764407)(0)"",
  AVG(""自定义 SQL 查询"".""totalUsage"") AS ""avg_totalUsage_ok"",
  ""自定义 SQL 查询"".""level1"" AS ""level1"",
  SUM(""自定义 SQL 查询"".""totalUsage"") AS ""sum_totalUsage_ok""
FROM (SELECT date,
        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,
      start_date AS start_date_7,
      end_date AS end_date,
      tag,
      area AS Scope,
      dim,
        CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,
      level2,
      level3,
      level4,
      product_level1 AS product_line,
      product_level2,
      product_level3,
      product_level4,
      vid_internal_industry_en AS cid_industry,
      vid_use_case_en AS vid_use_case_cn,
      vid_sector_en,
      ver_type,
      ver,
      os,
      domain,
      country,
      region,
      dim_grouping_name,
        CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,
      total AS totalUsage,
      audio,
      video,
      host_audio,
      audience_audio,
      host_sd,
      host_hd,
      host_hdp,
      host_1080p,
      host_2k,
      host_4k,
      audience_sd,
      audience_hd,
      audience_hdp,
      audience_1080p,
      audience_2k,
      audience_4k,
      audience_audio_low_latency,
      audience_sd_low_latency,
      audience_hd_low_latency,
      audience_hdp_low_latency,
      audience_1080p_low_latency,
      audience_2k_low_latency,
      audience_4k_low_latency,
      audience_audio_ultra_low_latency,
      audience_sd_ultra_low_latency,
      audience_hd_ultra_low_latency,
      audience_hdp_ultra_low_latency,
      audience_1080p_ultra_low_latency,
      audience_2k_ultra_low_latency,
      audience_4k_ultra_low_latency,
      total_last1 AS audio_video_last,
      audio_last1 AS audio_last,
      video_last1 AS video_last,
      video_sd_last1 AS video_sd_last,
      video_hd_last1 AS video_hd_last,
      video_hdp_last1 AS video_hdp_last,
      host_sd_last1 AS host_video_sd_last,
      audience_sd_last1 AS audience_video_sd_last,
      host_hd_last1 AS host_video_hd_last,
      audience_hd_last1 AS audience_video_hd_last,
      host_hdp_last1 AS host_video_hdp_last,
      audience_hdp_last1 AS audience_video_hdp_last,
      host_audio_last1 AS host_audio_last,
      audience_audio_last1 AS audience_audio_last,
      host_video_last1 AS host_video_last,
      audience_video_last1 AS audience_video_last,
      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,
      audience_video_low_latency_last1 AS audience_video_low_latency_last,
      audience_total_low_latency_last1 AS audience_total_low_latency_last,
      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,
      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,
      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,
      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,
      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,
      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,
      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,
      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,
      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,
      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,
      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,
      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,
      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,
      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,
      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,
      audience_2k_last1 AS audience_2k_last,
      audience_4k_last1 AS audience_4k_last,
      audience_1080p_last1 AS audience_1080p_last,
      host_1080p_last1 AS host_1080p_last,
      host_2k_last1 AS host_2k_last,
      host_4k_last1 AS host_4k_last,
      total_last7,
      audio_last7,
      video_last7,
      video_sd_last7,
      video_hd_last7,
      video_hdp_last7,
      host_sd_last7,
      audience_sd_last7,
      host_hd_last7,
      audience_hd_last7,
      host_hdp_last7,
      audience_hdp_last7,
      host_audio_last7,
      audience_audio_last7,
      host_video_last7,
      audience_video_last7,
      audience_audio_low_latency_last7,
      audience_video_low_latency_last7,
      audience_total_low_latency_last7,
      audience_sd_low_latency_last7,
      audience_hd_low_latency_last7,
      audience_hdp_low_latency_last7,
      audience_1080p_low_latency_last7,
      audience_2k_low_latency_last7,
      audience_4k_low_latency_last7,
      audience_audio_ultra_low_latency_last7,
      audience_video_ultra_low_latency_last7,
      audience_total_ultra_low_latency_last7,
      audience_sd_ultra_low_latency_last7,
      audience_hd_ultra_low_latency_last7,
      audience_hdp_ultra_low_latency_last7,
      audience_1080p_ultra_low_latency_last7,
      audience_2k_ultra_low_latency_last7,
      audience_4k_ultra_low_latency_last7,
      audience_2k_last7,
      audience_4k_last7,
      audience_1080p_last7,
      host_1080p_last7,
      host_2k_last7,
      host_4k_last7
    FROM levels_usage_dod_di_1
    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-06') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-04') AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS ""自定义 SQL 查询""
  CROSS JOIN (SELECT MAX(date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d')) AS ""__measure__0""
    FROM (SELECT date,
            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,
          start_date AS start_date_7,
          end_date AS end_date,
          tag,
          area AS Scope,
          dim,
            CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,
          level2,
          level3,
          level4,
          product_level1 AS product_line,
          product_level2,
          product_level3,
          product_level4,
          vid_internal_industry_en AS cid_industry,
          vid_use_case_en AS vid_use_case_cn,
          vid_sector_en,
          ver_type,
          ver,
          os,
          domain,
          country,
          region,
          dim_grouping_name,
            CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,
          total AS totalUsage,
          audio,
          video,
          host_audio,
          audience_audio,
          host_sd,
          host_hd,
          host_hdp,
          host_1080p,
          host_2k,
          host_4k,
          audience_sd,
          audience_hd,
          audience_hdp,
          audience_1080p,
          audience_2k,
          audience_4k,
          audience_audio_low_latency,
          audience_sd_low_latency,
          audience_hd_low_latency,
          audience_hdp_low_latency,
          audience_1080p_low_latency,
          audience_2k_low_latency,
          audience_4k_low_latency,
          audience_audio_ultra_low_latency,
          audience_sd_ultra_low_latency,
          audience_hd_ultra_low_latency,
          audience_hdp_ultra_low_latency,
          audience_1080p_ultra_low_latency,
          audience_2k_ultra_low_latency,
          audience_4k_ultra_low_latency,
          total_last1 AS audio_video_last,
          audio_last1 AS audio_last,
          video_last1 AS video_last,
          video_sd_last1 AS video_sd_last,
          video_hd_last1 AS video_hd_last,
          video_hdp_last1 AS video_hdp_last,
          host_sd_last1 AS host_video_sd_last,
          audience_sd_last1 AS audience_video_sd_last,
          host_hd_last1 AS host_video_hd_last,
          audience_hd_last1 AS audience_video_hd_last,
          host_hdp_last1 AS host_video_hdp_last,
          audience_hdp_last1 AS audience_video_hdp_last,
          host_audio_last1 AS host_audio_last,
          audience_audio_last1 AS audience_audio_last,
          host_video_last1 AS host_video_last,
          audience_video_last1 AS audience_video_last,
          audience_audio_low_latency_last1 AS audience_audio_low_latency_last,
          audience_video_low_latency_last1 AS audience_video_low_latency_last,
          audience_total_low_latency_last1 AS audience_total_low_latency_last,
          audience_sd_low_latency_last1 AS audience_sd_low_latency_last,
          audience_hd_low_latency_last1 AS audience_hd_low_latency_last,
          audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,
          audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,
          audience_2k_low_latency_last1 AS audience_2k_low_latency_last,
          audience_4k_low_latency_last1 AS audience_4k_low_latency_last,
          audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,
          audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,
          audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,
          audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,
          audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,
          audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,
          audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,
          audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,
          audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,
          audience_2k_last1 AS audience_2k_last,
          audience_4k_last1 AS audience_4k_last,
          audience_1080p_last1 AS audience_1080p_last,
          host_1080p_last1 AS host_1080p_last,
          host_2k_last1 AS host_2k_last,
          host_4k_last1 AS host_4k_last,
          total_last7,
          audio_last7,
          video_last7,
          video_sd_last7,
          video_hd_last7,
          video_hdp_last7,
          host_sd_last7,
          audience_sd_last7,
          host_hd_last7,
          audience_hd_last7,
          host_hdp_last7,
          audience_hdp_last7,
          host_audio_last7,
          audience_audio_last7,
          host_video_last7,
          audience_video_last7,
          audience_audio_low_latency_last7,
          audience_video_low_latency_last7,
          audience_total_low_latency_last7,
          audience_sd_low_latency_last7,
          audience_hd_low_latency_last7,
          audience_hdp_low_latency_last7,
          audience_1080p_low_latency_last7,
          audience_2k_low_latency_last7,
          audience_4k_low_latency_last7,
          audience_audio_ultra_low_latency_last7,
          audience_video_ultra_low_latency_last7,
          audience_total_ultra_low_latency_last7,
          audience_sd_ultra_low_latency_last7,
          audience_hd_ultra_low_latency_last7,
          audience_hdp_ultra_low_latency_last7,
          audience_1080p_ultra_low_latency_last7,
          audience_2k_ultra_low_latency_last7,
          audience_4k_ultra_low_latency_last7,
          audience_2k_last7,
          audience_4k_last7,
          audience_1080p_last7,
          host_1080p_last7,
          host_2k_last7,
          host_4k_last7
        FROM levels_usage_dod_di_1
        WHERE CAST(tag AS VARCHAR) = 'Industry' AND date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-06') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-04') AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS ""自定义 SQL 查询""
    HAVING COUNT(1) > 0) AS ""t0""
WHERE ""自定义 SQL 查询"".""dim"" = 1 AND ""自定义 SQL 查询"".""rank_level1"" = 6 AND date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d') = ""t0"".""__measure__0""
GROUP BY 36"
"SELECT ""自定义 SQL 查询"".""src_isp"" AS ""src_isp""
FROM (SELECT date AS ""date"",
      src_domain AS ""srcDomain"",
      src_region AS ""srcRegion"",
      dest_idc AS ""idc"",
      src_isp,
      dest_ip,
      delay_25 AS ""p2s_Delay25"",
      delay_50 AS ""p2s_Delay50"",
      delay_75 AS ""p2s_Delay75"",
      delay_100 AS ""p2s_Delay100"",
      delay_125 AS ""p2s_Delay125"",
      delay_150 AS ""p2s_Delay150"",
      delay_total,
      lost_ratio_5 AS ""p2s_lostRatio"",
      lostratio_total AS ""p2s_total"",
      jitter95_50 AS ""p2s_jitter95_50"",
      jitter95_100 AS ""p2s_jitter95_100"",
      jitter95_200 AS ""p2s_jitter95_200"",
      jitter95_300 AS ""p2s_jitter95_300"",
      jitter95_total,
      product_line,
      product_type
    FROM media.p2s_cover_mainland_ip
    WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-25') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-01')) AS ""自定义 SQL 查询""
GROUP BY 1
ORDER BY ""src_isp"""
"SELECT SUM(""自定义 SQL 查询"".""host_4k"") AS ""TEMP(Calculation_3519281700341563406)(1075454865)(0)"",
  SUM(""自定义 SQL 查询"".""audience_audio_last7"") AS ""TEMP(Calculation_3519281700341563406)(1077563395)(0)"",
  SUM(""自定义 SQL 查询"".""audience_sd"") AS ""TEMP(Calculation_3519281700341563406)(1133678835)(0)"",
  SUM(""自定义 SQL 查询"".""host_1080p"") AS ""TEMP(Calculation_3519281700341563406)(1312501967)(0)"",
  SUM(""自定义 SQL 查询"".""audience_sd_last7"") AS ""TEMP(Calculation_3519281700341563406)(1456465729)(0)"",
  SUM(""自定义 SQL 查询"".""host_hd_last7"") AS ""TEMP(Calculation_3519281700341563406)(1635749653)(0)"",
  SUM(""自定义 SQL 查询"".""audience_hd_last7"") AS ""TEMP(Calculation_3519281700341563406)(1747046964)(0)"",
  SUM(""自定义 SQL 查询"".""audience_2k_last7"") AS ""TEMP(Calculation_3519281700341563406)(1747524570)(0)"",
  SUM(""自定义 SQL 查询"".""host_hdp_last7"") AS ""TEMP(Calculation_3519281700341563406)(2044136109)(0)"",
  SUM(""自定义 SQL 查询"".""host_audio_last7"") AS ""TEMP(Calculation_3519281700341563406)(2464388580)(0)"",
  SUM(""自定义 SQL 查询"".""audio_last7"") AS ""TEMP(Calculation_3519281700341563406)(2589233512)(0)"",
  SUM(""自定义 SQL 查询"".""host_hd"") AS ""TEMP(Calculation_3519281700341563406)(276907208)(0)"",
  SUM(""自定义 SQL 查询"".""host_2k_last7"") AS ""TEMP(Calculation_3519281700341563406)(280796653)(0)"",
  SUM(""自定义 SQL 查询"".""video"") AS ""TEMP(Calculation_3519281700341563406)(2929708110)(0)"",
  SUM(""自定义 SQL 查询"".""audience_hd"") AS ""TEMP(Calculation_3519281700341563406)(2930728935)(0)"",
  SUM(""自定义 SQL 查询"".""audience_hdp"") AS ""TEMP(Calculation_3519281700341563406)(3010533957)(0)"",
  SUM(""自定义 SQL 查询"".""host_hdp"") AS ""TEMP(Calculation_3519281700341563406)(30306054)(0)"",
  SUM(""自定义 SQL 查询"".""host_audio"") AS ""TEMP(Calculation_3519281700341563406)(3087054365)(0)"",
  SUM(""自定义 SQL 查询"".""host_4k_last7"") AS ""TEMP(Calculation_3519281700341563406)(3127348545)(0)"",
  SUM(""自定义 SQL 查询"".""audio"") AS ""TEMP(Calculation_3519281700341563406)(3299350010)(0)"",
  SUM(""自定义 SQL 查询"".""total_last7"") AS ""TEMP(Calculation_3519281700341563406)(346677966)(0)"",
  SUM(""自定义 SQL 查询"".""audience_4k_last7"") AS ""TEMP(Calculation_3519281700341563406)(3543669678)(0)"",
  SUM(""自定义 SQL 查询"".""host_1080p_last7"") AS ""TEMP(Calculation_3519281700341563406)(3624983014)(0)"",
  SUM(""自定义 SQL 查询"".""audience_1080p"") AS ""TEMP(Calculation_3519281700341563406)(3628946582)(0)"",
  SUM(""自定义 SQL 查询"".""totalUsage"") AS ""TEMP(Calculation_3519281700341563406)(3847882359)(0)"",
  SUM(""自定义 SQL 查询"".""host_sd_last7"") AS ""TEMP(Calculation_3519281700341563406)(3905372418)(0)"",
  SUM(""自定义 SQL 查询"".""video_last7"") AS ""TEMP(Calculation_3519281700341563406)(4107040267)(0)"",
  SUM(""自定义 SQL 查询"".""audience_audio"") AS ""TEMP(Calculation_3519281700341563406)(4109514392)(0)"",
  SUM(""自定义 SQL 查询"".""host_2k"") AS ""TEMP(Calculation_3519281700341563406)(586790827)(0)"",
  SUM(""自定义 SQL 查询"".""audience_1080p_last7"") AS ""TEMP(Calculation_3519281700341563406)(632977665)(0)"",
  SUM(""自定义 SQL 查询"".""host_sd"") AS ""TEMP(Calculation_3519281700341563406)(709512178)(0)"",
  SUM(""自定义 SQL 查询"".""audience_hdp_last7"") AS ""TEMP(Calculation_3519281700341563406)(750340200)(0)"",
  SUM(""自定义 SQL 查询"".""audience_4k"") AS ""TEMP(Calculation_3519281700341563406)(764410224)(0)"",
  SUM(""自定义 SQL 查询"".""audience_2k"") AS ""TEMP(Calculation_3519281700341563406)(943764407)(0)"",
  ""自定义 SQL 查询"".""level1"" AS ""level1"",
  SUM(""自定义 SQL 查询"".""audio_video_last"") AS ""sum_audio_video_last_ok""
FROM (SELECT date,
        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,
      start_date AS start_date_7,
      end_date AS end_date,
      tag,
      area AS Scope,
      dim,
        CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,
      level2,
      level3,
      level4,
      product_level1 AS product_line,
      product_level2,
      product_level3,
      product_level4,
      vid_internal_industry_en AS cid_industry,
      vid_use_case_en AS vid_use_case_cn,
      vid_sector_en,
      ver_type,
      ver,
      os,
      domain,
      country,
      region,
      dim_grouping_name,
        CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,
      total AS totalUsage,
      audio,
      video,
      host_audio,
      audience_audio,
      host_sd,
      host_hd,
      host_hdp,
      host_1080p,
      host_2k,
      host_4k,
      audience_sd,
      audience_hd,
      audience_hdp,
      audience_1080p,
      audience_2k,
      audience_4k,
      audience_audio_low_latency,
      audience_sd_low_latency,
      audience_hd_low_latency,
      audience_hdp_low_latency,
      audience_1080p_low_latency,
      audience_2k_low_latency,
      audience_4k_low_latency,
      audience_audio_ultra_low_latency,
      audience_sd_ultra_low_latency,
      audience_hd_ultra_low_latency,
      audience_hdp_ultra_low_latency,
      audience_1080p_ultra_low_latency,
      audience_2k_ultra_low_latency,
      audience_4k_ultra_low_latency,
      total_last1 AS audio_video_last,
      audio_last1 AS audio_last,
      video_last1 AS video_last,
      video_sd_last1 AS video_sd_last,
      video_hd_last1 AS video_hd_last,
      video_hdp_last1 AS video_hdp_last,
      host_sd_last1 AS host_video_sd_last,
      audience_sd_last1 AS audience_video_sd_last,
      host_hd_last1 AS host_video_hd_last,
      audience_hd_last1 AS audience_video_hd_last,
      host_hdp_last1 AS host_video_hdp_last,
      audience_hdp_last1 AS audience_video_hdp_last,
      host_audio_last1 AS host_audio_last,
      audience_audio_last1 AS audience_audio_last,
      host_video_last1 AS host_video_last,
      audience_video_last1 AS audience_video_last,
      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,
      audience_video_low_latency_last1 AS audience_video_low_latency_last,
      audience_total_low_latency_last1 AS audience_total_low_latency_last,
      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,
      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,
      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,
      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,
      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,
      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,
      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,
      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,
      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,
      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,
      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,
      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,
      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,
      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,
      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,
      audience_2k_last1 AS audience_2k_last,
      audience_4k_last1 AS audience_4k_last,
      audience_1080p_last1 AS audience_1080p_last,
      host_1080p_last1 AS host_1080p_last,
      host_2k_last1 AS host_2k_last,
      host_4k_last1 AS host_4k_last,
      total_last7,
      audio_last7,
      video_last7,
      video_sd_last7,
      video_hd_last7,
      video_hdp_last7,
      host_sd_last7,
      audience_sd_last7,
      host_hd_last7,
      audience_hd_last7,
      host_hdp_last7,
      audience_hdp_last7,
      host_audio_last7,
      audience_audio_last7,
      host_video_last7,
      audience_video_last7,
      audience_audio_low_latency_last7,
      audience_video_low_latency_last7,
      audience_total_low_latency_last7,
      audience_sd_low_latency_last7,
      audience_hd_low_latency_last7,
      audience_hdp_low_latency_last7,
      audience_1080p_low_latency_last7,
      audience_2k_low_latency_last7,
      audience_4k_low_latency_last7,
      audience_audio_ultra_low_latency_last7,
      audience_video_ultra_low_latency_last7,
      audience_total_ultra_low_latency_last7,
      audience_sd_ultra_low_latency_last7,
      audience_hd_ultra_low_latency_last7,
      audience_hdp_ultra_low_latency_last7,
      audience_1080p_ultra_low_latency_last7,
      audience_2k_ultra_low_latency_last7,
      audience_4k_ultra_low_latency_last7,
      audience_2k_last7,
      audience_4k_last7,
      audience_1080p_last7,
      host_1080p_last7,
      host_2k_last7,
      host_4k_last7
    FROM levels_usage_dod_di_1
    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-06') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-04') AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS ""自定义 SQL 查询""
  CROSS JOIN (SELECT MAX(date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d')) AS ""__measure__0""
    FROM (SELECT date,
            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,
          start_date AS start_date_7,
          end_date AS end_date,
          tag,
          area AS Scope,
          dim,
            CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,
          level2,
          level3,
          level4,
          product_level1 AS product_line,
          product_level2,
          product_level3,
          product_level4,
          vid_internal_industry_en AS cid_industry,
          vid_use_case_en AS vid_use_case_cn,
          vid_sector_en,
          ver_type,
          ver,
          os,
          domain,
          country,
          region,
          dim_grouping_name,
            CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,
          total AS totalUsage,
          audio,
          video,
          host_audio,
          audience_audio,
          host_sd,
          host_hd,
          host_hdp,
          host_1080p,
          host_2k,
          host_4k,
          audience_sd,
          audience_hd,
          audience_hdp,
          audience_1080p,
          audience_2k,
          audience_4k,
          audience_audio_low_latency,
          audience_sd_low_latency,
          audience_hd_low_latency,
          audience_hdp_low_latency,
          audience_1080p_low_latency,
          audience_2k_low_latency,
          audience_4k_low_latency,
          audience_audio_ultra_low_latency,
          audience_sd_ultra_low_latency,
          audience_hd_ultra_low_latency,
          audience_hdp_ultra_low_latency,
          audience_1080p_ultra_low_latency,
          audience_2k_ultra_low_latency,
          audience_4k_ultra_low_latency,
          total_last1 AS audio_video_last,
          audio_last1 AS audio_last,
          video_last1 AS video_last,
          video_sd_last1 AS video_sd_last,
          video_hd_last1 AS video_hd_last,
          video_hdp_last1 AS video_hdp_last,
          host_sd_last1 AS host_video_sd_last,
          audience_sd_last1 AS audience_video_sd_last,
          host_hd_last1 AS host_video_hd_last,
          audience_hd_last1 AS audience_video_hd_last,
          host_hdp_last1 AS host_video_hdp_last,
          audience_hdp_last1 AS audience_video_hdp_last,
          host_audio_last1 AS host_audio_last,
          audience_audio_last1 AS audience_audio_last,
          host_video_last1 AS host_video_last,
          audience_video_last1 AS audience_video_last,
          audience_audio_low_latency_last1 AS audience_audio_low_latency_last,
          audience_video_low_latency_last1 AS audience_video_low_latency_last,
          audience_total_low_latency_last1 AS audience_total_low_latency_last,
          audience_sd_low_latency_last1 AS audience_sd_low_latency_last,
          audience_hd_low_latency_last1 AS audience_hd_low_latency_last,
          audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,
          audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,
          audience_2k_low_latency_last1 AS audience_2k_low_latency_last,
          audience_4k_low_latency_last1 AS audience_4k_low_latency_last,
          audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,
          audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,
          audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,
          audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,
          audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,
          audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,
          audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,
          audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,
          audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,
          audience_2k_last1 AS audience_2k_last,
          audience_4k_last1 AS audience_4k_last,
          audience_1080p_last1 AS audience_1080p_last,
          host_1080p_last1 AS host_1080p_last,
          host_2k_last1 AS host_2k_last,
          host_4k_last1 AS host_4k_last,
          total_last7,
          audio_last7,
          video_last7,
          video_sd_last7,
          video_hd_last7,
          video_hdp_last7,
          host_sd_last7,
          audience_sd_last7,
          host_hd_last7,
          audience_hd_last7,
          host_hdp_last7,
          audience_hdp_last7,
          host_audio_last7,
          audience_audio_last7,
          host_video_last7,
          audience_video_last7,
          audience_audio_low_latency_last7,
          audience_video_low_latency_last7,
          audience_total_low_latency_last7,
          audience_sd_low_latency_last7,
          audience_hd_low_latency_last7,
          audience_hdp_low_latency_last7,
          audience_1080p_low_latency_last7,
          audience_2k_low_latency_last7,
          audience_4k_low_latency_last7,
          audience_audio_ultra_low_latency_last7,
          audience_video_ultra_low_latency_last7,
          audience_total_ultra_low_latency_last7,
          audience_sd_ultra_low_latency_last7,
          audience_hd_ultra_low_latency_last7,
          audience_hdp_ultra_low_latency_last7,
          audience_1080p_ultra_low_latency_last7,
          audience_2k_ultra_low_latency_last7,
          audience_4k_ultra_low_latency_last7,
          audience_2k_last7,
          audience_4k_last7,
          audience_1080p_last7,
          host_1080p_last7,
          host_2k_last7,
          host_4k_last7
        FROM levels_usage_dod_di_1
        WHERE CAST(tag AS VARCHAR) = 'Industry' AND date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-06') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-04') AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS ""自定义 SQL 查询""
    HAVING COUNT(1) > 0) AS ""t0""
WHERE ""自定义 SQL 查询"".""dim"" = 1 AND ""自定义 SQL 查询"".""rank_level1"" = 4 AND date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d') = ""t0"".""__measure__0""
GROUP BY 35"
"SELECT SUM(""自定义 SQL 查询"".""p2s_Delay25"" * ""自定义 SQL 查询"".""delay_total"") AS ""TEMP(Calculation_1122874106494361604)(1461110105)(0)"",
  SUM(""自定义 SQL 查询"".""delay_total"") AS ""TEMP(Calculation_1122874106494361604)(363980608)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_Delay50"" * ""自定义 SQL 查询"".""delay_total"") AS ""TEMP(Calculation_1122874106494976005)(1551638771)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_Delay75"" * ""自定义 SQL 查询"".""delay_total"") AS ""TEMP(Calculation_1122874106495696902)(2562427304)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_lostRatio"" * ""自定义 SQL 查询"".""p2s_total"") AS ""TEMP(Calculation_1122874106495848455)(1741181994)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_total"") AS ""TEMP(Calculation_1122874106495848455)(2624355999)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_jitter95_100"" * ""自定义 SQL 查询"".""jitter95_total"") AS ""TEMP(Calculation_4208191644263628803)(3609783325)(0)"",
  SUM(""自定义 SQL 查询"".""jitter95_total"") AS ""TEMP(Calculation_4208191644263628803)(633698484)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_jitter95_50"" * ""自定义 SQL 查询"".""jitter95_total"") AS ""TEMP(Calculation_4208191644264697860)(1652714847)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_jitter95_200"" * ""自定义 SQL 查询"".""jitter95_total"") AS ""TEMP(Calculation_4208191644264935429)(206867949)(0)"",
  ""自定义 SQL 查询"".""srcRegion"" AS ""srcRegion""
FROM (SELECT date AS ""date"",
      src_domain AS ""srcDomain"",
      src_region AS ""srcRegion"",
      dest_idc AS ""idc"",
      delay_25 AS ""p2s_Delay25"",
      delay_50 AS ""p2s_Delay50"",
      delay_75 AS ""p2s_Delay75"",
      delay_100 AS ""p2s_Delay100"",
      delay_125 AS ""p2s_Delay125"",
      delay_150 AS ""p2s_Delay150"",
      delay_total,
      lost_ratio_5 AS ""p2s_lostRatio"",
      lostratio_total AS ""p2s_total"",
      jitter95_50 AS ""p2s_jitter95_50"",
      jitter95_100 AS ""p2s_jitter95_100"",
      jitter95_200 AS ""p2s_jitter95_200"",
      jitter95_300 AS ""p2s_jitter95_300"",
      jitter95_total,
      product_line,
      product_type
    FROM media.p2s_cover_mainland_ip
    WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-25') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-01')) AS ""自定义 SQL 查询""
WHERE CAST(""自定义 SQL 查询"".""srcRegion"" AS VARCHAR) >= 'Anhui' AND CAST(""自定义 SQL 查询"".""srcRegion"" AS VARCHAR) <= 'Zhejiang' AND (""自定义 SQL 查询"".""idc"" IN ('aofei-frankfurt1g', 'aofei-hk1ga', 'aofei-japan', 'aofei-singapore1ga', 'aofei-tokyo9', 'changchun1g-cucc', 'changsha-cucc', 'changsha9-ctel', 'eq-newyork10', 'eq-newyork9', 'evc-chicago1g', 'evc-frankfurt1ga', 'evc-frankfurt9', 'evc-japan9a', 'evc-seattle1g', 'evc-singapore1ga', 'evc-singapore1gb', 'fuzhou1g-cmcc', 'guangzhou-cmcc', 'guangzhou0t-drpeng', 'guangzhou1g-cmcc', 'guangzhou6js-bgp', 'guangzhou99-cmcc', 'hangzhou6al-bgp', 'hangzhou9-ctel', 'hangzhou9b-cmcc', 'hefei9-cmcc', 'huainan1g-cmcc', 'huhehaote1g-ctel', 'huzhou9-ctel', 'huzhou9-cucc', 'jinan1g-3line', 'jinan1g-cucc', 'jinan6bdbm-cucc', 'jinan9-cmcc', 'jiujiang9-ctel', 'langfang6uc-cucc', 'nanchang1g-cmcc', 'neijiang1g-ctel', 'ningbo1g-3line', 'qingdao1g-ctel', 'qinhuangdao1g-cucc', 'shanghai6js-bgp', 'shantou1g-ctel', 'shenyang1g-cmcc', 'shenyang9a-cucc', 'suzhou1g-cmcc', 'suzhou6bdbm-ctel', 'taiyuan6bd-ctel', 'taiyuan6bdbm-ctel', 'taiyuan9-cucc', 'tangshan9-cucc', 'tangshan99-cucc', 'tianjin1ga-ctel', 'tianjin3g-3line', 'wujiang-ctel', 'wuxi3c-bgp', 'xiamen6bd-ctel', 'xiamen6bdbm-ctel', 'xinxiang1g-cucc', 'yancheng1g-ctel', 'yantai1g-cucc', 'yiyang1g-cucc', 'yueyang6bd-ctel', 'yueyang6bdbm-ctel', 'zaozhuang9b-cucc', 'zen-amsterdam9b', 'zen-bangalore1ga', 'zen-bangkok', 'zen-chennai1ga', 'zen-dallas1g', 'zen-frankfurt1g', 'zen-frankfurt1gb', 'zen-hk9b', 'zen-losangeles9', 'zen-losangeles9a', 'zen-melbourne9a', 'zen-miami1g', 'zen-moscow2', 'zen-saopaulo2', 'zen-singapore1ga', 'zen-singapore1gb', 'zen-singapore3a', 'zen-washington1ga') OR ( (  ""自定义 SQL 查询"".""idc""  ) is null) OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'baoji1g-ctel' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'beijing-bgp' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'beijing6-bgp' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'beijing8-bgp' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'changsha1g-3line' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'changsha1g-cucc' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'changzhou9a-drpeng' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'chengdu6al-bgp' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'chongqing1g-3line' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'chongqing1ga-ctel' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'dalian1g-cmcc' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'eq-losangeles9' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'foshan1g-ctel' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'foshan9-ctel' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'guizhou1g-ctel' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'hangzhou3g-3line' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'lishui1g-ctel' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'luoyang1g-ctel' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'nanchang6bd-ctel' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'nanchang6uc-ctel' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'qinhuangdao9-cucc' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'retn-amsterdam0t' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'shenzhen9-drpeng' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'singtel-singapore0t' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'taizhou1g-3line' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'taizhou9-cucc' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'tianjin1g-cmcc' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'tianjin1g-cucc' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'tianjin9-ctel' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'tianjin9d-cucc' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'wenzhou1g-cmcc' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'wenzhou9-cmcc' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'xian1g-cmcc' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'xiangyang1g-cmcc' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'xixian9-ctel' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'xuzhou9b-ctel' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'yancheng9-cmcc' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'yancheng9b-ctel' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'yangzhou1g-cmcc' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'yangzhou6uc-3line' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'zen-amsterdam1' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'zen-amsterdam3' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'zen-frankfurt9a' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'zen-hk1gb' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'zen-japan' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'zen-japan9' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'zen-london1ga' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'zen-london3' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'zen-london9a' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'zen-losangeles3' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'zen-mumbai1ga' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'zen-mumbai9' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'zen-singapore9b' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'zen-tokyo1g' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'zhangjiakou1gb-cmcc' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'zhengzhou6bd-cucc' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'zhenjiang1g-3line' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'zhuzhou1g-ctel')
GROUP BY 11
HAVING CAST(CASE WHEN SUM(""自定义 SQL 查询"".""p2s_total"") >= 0 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100 THEN '0-100' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 1000 THEN '100-1000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 1000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 10000 THEN '1000-10000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 10000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100000 THEN '10000-100000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100000 THEN '100000以上' ELSE 'other' END AS VARCHAR) = '0-100' OR CAST(CASE WHEN SUM(""自定义 SQL 查询"".""p2s_total"") >= 0 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100 THEN '0-100' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 1000 THEN '100-1000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 1000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 10000 THEN '1000-10000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 10000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100000 THEN '10000-100000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100000 THEN '100000以上' ELSE 'other' END AS VARCHAR) = '100-1000' OR CAST(CASE WHEN SUM(""自定义 SQL 查询"".""p2s_total"") >= 0 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100 THEN '0-100' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 1000 THEN '100-1000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 1000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 10000 THEN '1000-10000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 10000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100000 THEN '10000-100000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100000 THEN '100000以上' ELSE 'other' END AS VARCHAR) = '1000-10000' OR CAST(CASE WHEN SUM(""自定义 SQL 查询"".""p2s_total"") >= 0 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100 THEN '0-100' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 1000 THEN '100-1000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 1000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 10000 THEN '1000-10000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 10000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100000 THEN '10000-100000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100000 THEN '100000以上' ELSE 'other' END AS VARCHAR) = '10000-100000' OR CAST(CASE WHEN SUM(""自定义 SQL 查询"".""p2s_total"") >= 0 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100 THEN '0-100' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 1000 THEN '100-1000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 1000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 10000 THEN '1000-10000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 10000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100000 THEN '10000-100000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100000 THEN '100000以上' ELSE 'other' END AS VARCHAR) = '100000以上'"
"SELECT SUM(""自定义 SQL 查询"".""p2s_Delay25"" * ""自定义 SQL 查询"".""delay_total"") AS ""TEMP(Calculation_6634083767547871232)(1563607262)(0)"",
  SUM(""自定义 SQL 查询"".""delay_total"") AS ""TEMP(Calculation_6634083767547871232)(363980608)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_Delay75"" * ""自定义 SQL 查询"".""delay_total"") AS ""TEMP(Calculation_6634083767548604418)(2562427304)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_lostRatio"" * ""自定义 SQL 查询"".""p2s_total"") AS ""TEMP(Calculation_6634083767550464005)(1741181994)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_total"") AS ""TEMP(Calculation_6634083767550464005)(2624355999)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_jitter95_50"" * ""自定义 SQL 查询"".""jitter95_total"") AS ""TEMP(Calculation_6634083767551082502)(1652714847)(0)"",
  SUM(""自定义 SQL 查询"".""jitter95_total"") AS ""TEMP(Calculation_6634083767551082502)(633698484)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_jitter95_200"" * ""自定义 SQL 查询"".""jitter95_total"") AS ""TEMP(Calculation_6634083767551815690)(206867949)(0)"",
  AVG(""自定义 SQL 查询"".""p2s_total"") AS ""avg_p2s_total_ok"",
  ""自定义 SQL 查询"".""srcDomain"" AS ""srcDomain""
FROM (SELECT date,
      src_domain AS ""srcDomain"",
      delay_25 AS ""p2s_Delay25"",
      delay_50 AS ""p2s_Delay50"",
      delay_75 AS ""p2s_Delay75"",
      delay_100 AS ""p2s_Delay100"",
      delay_125 AS ""p2s_Delay125"",
      delay_150 AS ""p2s_Delay150"",
      delay_total,
      lost_ratio_5 AS ""p2s_lostRatio"",
      lostratio_total AS ""p2s_total"",
      jitter95_50 AS ""p2s_jitter95_50"",
      jitter95_100 AS ""p2s_jitter95_100"",
      jitter95_200 AS ""p2s_jitter95_200"",
      jitter95_300 AS ""p2s_jitter95_300"",
      jitter95_total,
      product_line,
      product_type
    FROM media.p2s_cover_domain
    WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-25') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-01')) AS ""自定义 SQL 查询""
GROUP BY 10"
"SELECT '跳转：音频可用性' AS ""Calculation_5876704998653468673""
FROM (SELECT ts.*,
      fiveSecJoinSuccess_total,
      threeSecJoinSuccess_total,
      totalJoinSuccess_total,
      totalJoin_total,
      cnt_sid_total,
      ""1s_succ_join_ap_cnt_total"",
      ""5s_succ_join_ap_cnt_total"",
      total_join_ap_cnt_total,
      audio_freeze_time_200_total,
      audio_totaltime_200_total,
      video_freeze_time_total,
      video_totaltime_total,
      p2s_lost_Leq5_total,
      p2s_lost_all_total,
      s2l_25ms_delay_sec_total,
      s2l_75ms_delay_sec_total,
      s2l_total_delay_sec_total,
      crash_cnt_total,
      service_cnt_total,
      ""5s_succ_join_session_cnt_last1_total"",
      ""3s_succ_join_session_cnt_last1_total"",
      succ_join_session_cnt_last1_total,
      total_join_session_cnt_last1_total,
      total_session_cnt_last1_total,
      ""1s_succ_join_ap_cnt_last1_total"",
      ""5s_succ_join_ap_cnt_last1_total"",
      total_join_ap_cnt_last1_total,
      video_freeze_time_last1_total,
      video_totaltime_last1_total,
      p2s_lost_Leq5_last1_total,
      p2s_lost_all_last1_total,
      s2l_25ms_delay_sec_last1_total,
      s2l_75ms_delay_sec_last1_total,
      s2l_total_delay_sec_last1_total,
      crash_cnt_last1_total,
      service_cnt_last1_total,
      audio_freeze_time_200_last1_total,
      audio_totaltime_200_last1_total,
      ""5s_succ_join_session_cnt_last7_total"",
      ""3s_succ_join_session_cnt_last7_total"",
      succ_join_session_cnt_last7_total,
      total_join_session_cnt_last7_total,
      total_session_cnt_last7_total,
      ""7s_succ_join_ap_cnt_last7_total"",
      ""5s_succ_join_ap_cnt_last7_total"",
      total_join_ap_cnt_last7_total,
      video_freeze_time_last7_total,
      video_totaltime_last7_total,
      p2s_lost_Leq5_last7_total,
      p2s_lost_all_last7_total,
      s2l_25ms_delay_sec_last7_total,
      s2l_75ms_delay_sec_last7_total,
      s2l_total_delay_sec_last7_total,
      crash_cnt_last7_total,
      service_cnt_last7_total,
      audio_freeze_time_200_last7_total,
      audio_totaltime_200_last7_total,
      video_freeze_time_500_total,
      video_totaltime_500_total,
      video_freeze_time_200_total,
      video_totaltime_200_total,
      video_freeze_time_500_last1_total,
      video_totaltime_500_last1_total,
      video_freeze_time_200_last1_total,
      video_totaltime_200_last1_total,
      video_freeze_time_500_last7_total,
      video_totaltime_500_last7_total,
      video_freeze_time_200_last7_total,
      video_totaltime_200_last7_total,
      s2l_lost_Leq5_total,
      s2l_lost_all_total,
      s2l_lost_Leq5_last1_total,
      s2l_lost_all_last1_total,
      s2l_lost_Leq5_last7_total,
      s2l_lost_all_last7_total
    FROM (SELECT vid,
          project,
          company_id,
          area,
          company_name,
          industry_name,
          date,
            CASE WHEN CAST(stat_period AS VARCHAR) = 'day' THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(substr(CAST(start_date AS VARCHAR), 1, 10) AS VARCHAR), '~', CAST(substr(CAST(end_date AS VARCHAR), 1, 10) AS VARCHAR)) END AS period,
          net,
          os,
          ver,
          'osver' AS dim,
          product_level_1,
          product_level_2,
          ver_type,
          SUM(fiveSecJoinSuccess) AS fiveSecJoinSuccess,
          SUM(threeSecJoinSuccess) AS threeSecJoinSuccess,
          SUM(totalJoinSuccess) AS totalJoinSuccess,
          SUM(totalJoin) AS totalJoin,
          SUM(cnt_sid) AS cnt_sid,
          SUM(""1s_succ_join_ap_cnt"") AS ""1s_succ_join_ap_cnt"",
          SUM(""5s_succ_join_ap_cnt"") AS ""5s_succ_join_ap_cnt"",
          SUM(total_join_ap_cnt) AS total_join_ap_cnt,
          SUM(audio_freeze_time_200) AS audio_freeze_time_200,
          SUM(audio_totaltime_200) AS audio_totaltime_200,
          SUM(video_freeze_time) AS video_freeze_time,
          SUM(video_totaltime) AS video_totaltime,
          SUM(p2s_lost_Leq5) AS p2s_lost_Leq5,
          SUM(p2s_lost_all) AS p2s_lost_all,
          SUM(s2l_25ms_delay_sec) AS s2l_25ms_delay_sec,
          SUM(s2l_75ms_delay_sec) AS s2l_75ms_delay_sec,
          SUM(s2l_total_delay_sec) AS s2l_total_delay_sec,
          SUM(crash_cnt) AS crash_cnt,
          SUM(service_cnt) AS service_cnt,
          SUM(""5s_succ_join_session_cnt_last1"") AS ""5s_succ_join_session_cnt_last1"",
          SUM(""3s_succ_join_session_cnt_last1"") AS ""3s_succ_join_session_cnt_last1"",
          SUM(succ_join_session_cnt_last1) AS succ_join_session_cnt_last1,
          SUM(total_join_session_cnt_last1) AS total_join_session_cnt_last1,
          SUM(total_session_cnt_last1) AS total_session_cnt_last1,
          SUM(""1s_succ_join_ap_cnt_last1"") AS ""1s_succ_join_ap_cnt_last1"",
          SUM(""5s_succ_join_ap_cnt_last1"") AS ""5s_succ_join_ap_cnt_last1"",
          SUM(total_join_ap_cnt_last1) AS total_join_ap_cnt_last1,
          SUM(video_freeze_time_last1) AS video_freeze_time_last1,
          SUM(video_totaltime_last1) AS video_totaltime_last1,
          SUM(p2s_lost_Leq5_last1) AS p2s_lost_Leq5_last1,
          SUM(p2s_lost_all_last1) AS p2s_lost_all_last1,
          SUM(s2l_25ms_delay_sec_last1) AS s2l_25ms_delay_sec_last1,
          SUM(s2l_75ms_delay_sec_last1) AS s2l_75ms_delay_sec_last1,
          SUM(s2l_total_delay_sec_last1) AS s2l_total_delay_sec_last1,
          SUM(crash_cnt_last1) AS crash_cnt_last1,
          SUM(service_cnt_last1) AS service_cnt_last1,
          SUM(audio_freeze_time_200_last1) AS audio_freeze_time_200_last1,
          SUM(audio_totaltime_200_last1) AS audio_totaltime_200_last1,
          SUM(""5s_succ_join_session_cnt_last7"") AS ""5s_succ_join_session_cnt_last7"",
          SUM(""3s_succ_join_session_cnt_last7"") AS ""3s_succ_join_session_cnt_last7"",
          SUM(succ_join_session_cnt_last7) AS succ_join_session_cnt_last7,
          SUM(total_join_session_cnt_last7) AS total_join_session_cnt_last7,
          SUM(total_session_cnt_last7) AS total_session_cnt_last7,
          SUM(""1s_succ_join_ap_cnt_last7"") AS ""7s_succ_join_ap_cnt_last7"",
          SUM(""5s_succ_join_ap_cnt_last7"") AS ""5s_succ_join_ap_cnt_last7"",
          SUM(total_join_ap_cnt_last7) AS total_join_ap_cnt_last7,
          SUM(video_freeze_time_last7) AS video_freeze_time_last7,
          SUM(video_totaltime_last7) AS video_totaltime_last7,
          SUM(p2s_lost_Leq5_last7) AS p2s_lost_Leq5_last7,
          SUM(p2s_lost_all_last7) AS p2s_lost_all_last7,
          SUM(s2l_25ms_delay_sec_last7) AS s2l_25ms_delay_sec_last7,
          SUM(s2l_75ms_delay_sec_last7) AS s2l_75ms_delay_sec_last7,
          SUM(s2l_total_delay_sec_last7) AS s2l_total_delay_sec_last7,
          SUM(crash_cnt_last7) AS crash_cnt_last7,
          SUM(service_cnt_last7) AS service_cnt_last7,
          SUM(audio_freeze_time_200_last7) AS audio_freeze_time_200_last7,
          SUM(audio_totaltime_200_last7) AS audio_totaltime_200_last7,
          SUM(video_freeze_time_500) AS video_freeze_time_500,
          SUM(video_totaltime_500) AS video_totaltime_500,
          SUM(video_freeze_time_200) AS video_freeze_time_200,
          SUM(video_totaltime_200) AS video_totaltime_200,
          SUM(video_freeze_time_500_last1) AS video_freeze_time_500_last1,
          SUM(video_totaltime_500_last1) AS video_totaltime_500_last1,
          SUM(video_freeze_time_200_last1) AS video_freeze_time_200_last1,
          SUM(video_totaltime_200_last1) AS video_totaltime_200_last1,
          SUM(video_freeze_time_500_last7) AS video_freeze_time_500_last7,
          SUM(video_totaltime_500_last7) AS video_totaltime_500_last7,
          SUM(video_freeze_time_200_last7) AS video_freeze_time_200_last7,
          SUM(video_totaltime_200_last7) AS video_totaltime_200_last7,
          SUM(s2l_lost_Leq5) AS s2l_lost_Leq5,
          SUM(s2l_lost_all) AS s2l_lost_all,
          SUM(s2l_lost_Leq5_last1) AS s2l_lost_Leq5_last1,
          SUM(s2l_lost_all_last1) AS s2l_lost_all_last1,
          SUM(s2l_lost_Leq5_last7) AS s2l_lost_Leq5_last7,
          SUM(s2l_lost_all_last7) AS s2l_lost_all_last7
        FROM report_datahub.vid_osver_net_cp_domain_quality_di_1
        WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-21') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-11-21') AND CAST(vid AS VARCHAR) = CAST(281104 AS VARCHAR) AND CAST(product_level_2 AS VARCHAR) = 'Native'
        GROUP BY vid,
          project,
          company_id,
          area,
          company_name,
          industry_name,
          date,
          net,
          os,
          ver,
          product_level_1,
          product_level_2,
          ver_type,
            CASE WHEN CAST(stat_period AS VARCHAR) = 'day' THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(substr(CAST(start_date AS VARCHAR), 1, 10) AS VARCHAR), '~', CAST(substr(CAST(end_date AS VARCHAR), 1, 10) AS VARCHAR)) END) AS ts
      LEFT JOIN (SELECT vid,
          date,
          SUM(fiveSecJoinSuccess) AS fiveSecJoinSuccess_total,
          SUM(threeSecJoinSuccess) AS threeSecJoinSuccess_total,
          SUM(totalJoinSuccess) AS totalJoinSuccess_total,
          SUM(totalJoin) AS totalJoin_total,
          SUM(cnt_sid) AS cnt_sid_total,
          SUM(""1s_succ_join_ap_cnt"") AS ""1s_succ_join_ap_cnt_total"",
          SUM(""5s_succ_join_ap_cnt"") AS ""5s_succ_join_ap_cnt_total"",
          SUM(total_join_ap_cnt) AS total_join_ap_cnt_total,
          SUM(audio_freeze_time_200) AS audio_freeze_time_200_total,
          SUM(audio_totaltime_200) AS audio_totaltime_200_total,
          SUM(video_freeze_time) AS video_freeze_time_total,
          SUM(video_totaltime) AS video_totaltime_total,
          SUM(p2s_lost_Leq5) AS p2s_lost_Leq5_total,
          SUM(p2s_lost_all) AS p2s_lost_all_total,
          SUM(s2l_25ms_delay_sec) AS s2l_25ms_delay_sec_total,
          SUM(s2l_75ms_delay_sec) AS s2l_75ms_delay_sec_total,
          SUM(s2l_total_delay_sec) AS s2l_total_delay_sec_total,
          SUM(crash_cnt) AS crash_cnt_total,
          SUM(service_cnt) AS service_cnt_total,
          SUM(""5s_succ_join_session_cnt_last1"") AS ""5s_succ_join_session_cnt_last1_total"",
          SUM(""3s_succ_join_session_cnt_last1"") AS ""3s_succ_join_session_cnt_last1_total"",
          SUM(succ_join_session_cnt_last1) AS succ_join_session_cnt_last1_total,
          SUM(total_join_session_cnt_last1) AS total_join_session_cnt_last1_total,
          SUM(total_session_cnt_last1) AS total_session_cnt_last1_total,
          SUM(""1s_succ_join_ap_cnt_last1"") AS ""1s_succ_join_ap_cnt_last1_total"",
          SUM(""5s_succ_join_ap_cnt_last1"") AS ""5s_succ_join_ap_cnt_last1_total"",
          SUM(total_join_ap_cnt_last1) AS total_join_ap_cnt_last1_total,
          SUM(video_freeze_time_last1) AS video_freeze_time_last1_total,
          SUM(video_totaltime_last1) AS video_totaltime_last1_total,
          SUM(p2s_lost_Leq5_last1) AS p2s_lost_Leq5_last1_total,
          SUM(p2s_lost_all_last1) AS p2s_lost_all_last1_total,
          SUM(s2l_25ms_delay_sec_last1) AS s2l_25ms_delay_sec_last1_total,
          SUM(s2l_75ms_delay_sec_last1) AS s2l_75ms_delay_sec_last1_total,
          SUM(s2l_total_delay_sec_last1) AS s2l_total_delay_sec_last1_total,
          SUM(crash_cnt_last1) AS crash_cnt_last1_total,
          SUM(service_cnt_last1) AS service_cnt_last1_total,
          SUM(audio_freeze_time_200_last1) AS audio_freeze_time_200_last1_total,
          SUM(audio_totaltime_200_last1) AS audio_totaltime_200_last1_total,
          SUM(""5s_succ_join_session_cnt_last7"") AS ""5s_succ_join_session_cnt_last7_total"",
          SUM(""3s_succ_join_session_cnt_last7"") AS ""3s_succ_join_session_cnt_last7_total"",
          SUM(succ_join_session_cnt_last7) AS succ_join_session_cnt_last7_total,
          SUM(total_join_session_cnt_last7) AS total_join_session_cnt_last7_total,
          SUM(total_session_cnt_last7) AS total_session_cnt_last7_total,
          SUM(""1s_succ_join_ap_cnt_last7"") AS ""7s_succ_join_ap_cnt_last7_total"",
          SUM(""5s_succ_join_ap_cnt_last7"") AS ""5s_succ_join_ap_cnt_last7_total"",
          SUM(total_join_ap_cnt_last7) AS total_join_ap_cnt_last7_total,
          SUM(video_freeze_time_last7) AS video_freeze_time_last7_total,
          SUM(video_totaltime_last7) AS video_totaltime_last7_total,
          SUM(p2s_lost_Leq5_last7) AS p2s_lost_Leq5_last7_total,
          SUM(p2s_lost_all_last7) AS p2s_lost_all_last7_total,
          SUM(s2l_25ms_delay_sec_last7) AS s2l_25ms_delay_sec_last7_total,
          SUM(s2l_75ms_delay_sec_last7) AS s2l_75ms_delay_sec_last7_total,
          SUM(s2l_total_delay_sec_last7) AS s2l_total_delay_sec_last7_total,
          SUM(crash_cnt_last7) AS crash_cnt_last7_total,
          SUM(service_cnt_last7) AS service_cnt_last7_total,
          SUM(audio_freeze_time_200_last7) AS audio_freeze_time_200_last7_total,
          SUM(audio_totaltime_200_last7) AS audio_totaltime_200_last7_total,
          SUM(video_freeze_time_500) AS video_freeze_time_500_total,
          SUM(video_totaltime_500) AS video_totaltime_500_total,
          SUM(video_freeze_time_200) AS video_freeze_time_200_total,
          SUM(video_totaltime_200) AS video_totaltime_200_total,
          SUM(video_freeze_time_500_last1) AS video_freeze_time_500_last1_total,
          SUM(video_totaltime_500_last1) AS video_totaltime_500_last1_total,
          SUM(video_freeze_time_200_last1) AS video_freeze_time_200_last1_total,
          SUM(video_totaltime_200_last1) AS video_totaltime_200_last1_total,
          SUM(video_freeze_time_500_last7) AS video_freeze_time_500_last7_total,
          SUM(video_totaltime_500_last7) AS video_totaltime_500_last7_total,
          SUM(video_freeze_time_200_last7) AS video_freeze_time_200_last7_total,
          SUM(video_totaltime_200_last7) AS video_totaltime_200_last7_total,
          SUM(s2l_lost_Leq5) AS s2l_lost_Leq5_total,
          SUM(s2l_lost_all) AS s2l_lost_all_total,
          SUM(s2l_lost_Leq5_last1) AS s2l_lost_Leq5_last1_total,
          SUM(s2l_lost_all_last1) AS s2l_lost_all_last1_total,
          SUM(s2l_lost_Leq5_last7) AS s2l_lost_Leq5_last7_total,
          SUM(s2l_lost_all_last7) AS s2l_lost_all_last7_total
        FROM report_datahub.vid_osver_net_cp_domain_quality_di_1
        WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-21') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-11-21') AND CAST(vid AS VARCHAR) = CAST(281104 AS VARCHAR) AND CAST(product_level_2 AS VARCHAR) = 'Native'
        GROUP BY vid,
          date) AS tt ON CAST(ts.vid AS VARCHAR) = CAST(tt.vid AS VARCHAR) AND ts.date = tt.date) AS ""自定义 SQL 查询""
HAVING COUNT(1) > 0"
"SELECT SUM(""自定义 SQL 查询"".""host_4k"") AS ""TEMP(Calculation_3519281700341563406)(1075454865)(0)"",
  SUM(""自定义 SQL 查询"".""audience_audio_last7"") AS ""TEMP(Calculation_3519281700341563406)(1077563395)(0)"",
  SUM(""自定义 SQL 查询"".""audience_sd"") AS ""TEMP(Calculation_3519281700341563406)(1133678835)(0)"",
  SUM(""自定义 SQL 查询"".""host_1080p"") AS ""TEMP(Calculation_3519281700341563406)(1312501967)(0)"",
  SUM(""自定义 SQL 查询"".""audience_sd_last7"") AS ""TEMP(Calculation_3519281700341563406)(1456465729)(0)"",
  SUM(""自定义 SQL 查询"".""host_hd_last7"") AS ""TEMP(Calculation_3519281700341563406)(1635749653)(0)"",
  SUM(""自定义 SQL 查询"".""audience_hd_last7"") AS ""TEMP(Calculation_3519281700341563406)(1747046964)(0)"",
  SUM(""自定义 SQL 查询"".""audience_2k_last7"") AS ""TEMP(Calculation_3519281700341563406)(1747524570)(0)"",
  SUM(""自定义 SQL 查询"".""host_hdp_last7"") AS ""TEMP(Calculation_3519281700341563406)(2044136109)(0)"",
  SUM(""自定义 SQL 查询"".""host_audio_last7"") AS ""TEMP(Calculation_3519281700341563406)(2464388580)(0)"",
  SUM(""自定义 SQL 查询"".""audio_last7"") AS ""TEMP(Calculation_3519281700341563406)(2589233512)(0)"",
  SUM(""自定义 SQL 查询"".""host_hd"") AS ""TEMP(Calculation_3519281700341563406)(276907208)(0)"",
  SUM(""自定义 SQL 查询"".""host_2k_last7"") AS ""TEMP(Calculation_3519281700341563406)(280796653)(0)"",
  SUM(""自定义 SQL 查询"".""video"") AS ""TEMP(Calculation_3519281700341563406)(2929708110)(0)"",
  SUM(""自定义 SQL 查询"".""audience_hd"") AS ""TEMP(Calculation_3519281700341563406)(2930728935)(0)"",
  SUM(""自定义 SQL 查询"".""audience_hdp"") AS ""TEMP(Calculation_3519281700341563406)(3010533957)(0)"",
  SUM(""自定义 SQL 查询"".""host_hdp"") AS ""TEMP(Calculation_3519281700341563406)(30306054)(0)"",
  SUM(""自定义 SQL 查询"".""host_audio"") AS ""TEMP(Calculation_3519281700341563406)(3087054365)(0)"",
  SUM(""自定义 SQL 查询"".""host_4k_last7"") AS ""TEMP(Calculation_3519281700341563406)(3127348545)(0)"",
  SUM(""自定义 SQL 查询"".""audio"") AS ""TEMP(Calculation_3519281700341563406)(3299350010)(0)"",
  SUM(""自定义 SQL 查询"".""total_last7"") AS ""TEMP(Calculation_3519281700341563406)(346677966)(0)"",
  SUM(""自定义 SQL 查询"".""audience_4k_last7"") AS ""TEMP(Calculation_3519281700341563406)(3543669678)(0)"",
  SUM(""自定义 SQL 查询"".""host_1080p_last7"") AS ""TEMP(Calculation_3519281700341563406)(3624983014)(0)"",
  SUM(""自定义 SQL 查询"".""audience_1080p"") AS ""TEMP(Calculation_3519281700341563406)(3628946582)(0)"",
  SUM(""自定义 SQL 查询"".""totalUsage"") AS ""TEMP(Calculation_3519281700341563406)(3847882359)(0)"",
  SUM(""自定义 SQL 查询"".""host_sd_last7"") AS ""TEMP(Calculation_3519281700341563406)(3905372418)(0)"",
  SUM(""自定义 SQL 查询"".""video_last7"") AS ""TEMP(Calculation_3519281700341563406)(4107040267)(0)"",
  SUM(""自定义 SQL 查询"".""audience_audio"") AS ""TEMP(Calculation_3519281700341563406)(4109514392)(0)"",
  SUM(""自定义 SQL 查询"".""host_2k"") AS ""TEMP(Calculation_3519281700341563406)(586790827)(0)"",
  SUM(""自定义 SQL 查询"".""audience_1080p_last7"") AS ""TEMP(Calculation_3519281700341563406)(632977665)(0)"",
  SUM(""自定义 SQL 查询"".""host_sd"") AS ""TEMP(Calculation_3519281700341563406)(709512178)(0)"",
  SUM(""自定义 SQL 查询"".""audience_hdp_last7"") AS ""TEMP(Calculation_3519281700341563406)(750340200)(0)"",
  SUM(""自定义 SQL 查询"".""audience_4k"") AS ""TEMP(Calculation_3519281700341563406)(764410224)(0)"",
  SUM(""自定义 SQL 查询"".""audience_2k"") AS ""TEMP(Calculation_3519281700341563406)(943764407)(0)"",
  ""自定义 SQL 查询"".""level1"" AS ""level1"",
  SUM(""自定义 SQL 查询"".""audio_video_last"") AS ""sum_audio_video_last_ok""
FROM (SELECT date,
        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,
      start_date AS start_date_7,
      end_date AS end_date,
      tag,
      area AS Scope,
      dim,
        CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,
      level2,
      level3,
      level4,
      product_level1 AS product_line,
      product_level2,
      product_level3,
      product_level4,
      vid_internal_industry_en AS cid_industry,
      vid_use_case_en AS vid_use_case_cn,
      vid_sector_en,
      ver_type,
      ver,
      os,
      domain,
      country,
      region,
      dim_grouping_name,
        CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,
      total AS totalUsage,
      audio,
      video,
      host_audio,
      audience_audio,
      host_sd,
      host_hd,
      host_hdp,
      host_1080p,
      host_2k,
      host_4k,
      audience_sd,
      audience_hd,
      audience_hdp,
      audience_1080p,
      audience_2k,
      audience_4k,
      audience_audio_low_latency,
      audience_sd_low_latency,
      audience_hd_low_latency,
      audience_hdp_low_latency,
      audience_1080p_low_latency,
      audience_2k_low_latency,
      audience_4k_low_latency,
      audience_audio_ultra_low_latency,
      audience_sd_ultra_low_latency,
      audience_hd_ultra_low_latency,
      audience_hdp_ultra_low_latency,
      audience_1080p_ultra_low_latency,
      audience_2k_ultra_low_latency,
      audience_4k_ultra_low_latency,
      total_last1 AS audio_video_last,
      audio_last1 AS audio_last,
      video_last1 AS video_last,
      video_sd_last1 AS video_sd_last,
      video_hd_last1 AS video_hd_last,
      video_hdp_last1 AS video_hdp_last,
      host_sd_last1 AS host_video_sd_last,
      audience_sd_last1 AS audience_video_sd_last,
      host_hd_last1 AS host_video_hd_last,
      audience_hd_last1 AS audience_video_hd_last,
      host_hdp_last1 AS host_video_hdp_last,
      audience_hdp_last1 AS audience_video_hdp_last,
      host_audio_last1 AS host_audio_last,
      audience_audio_last1 AS audience_audio_last,
      host_video_last1 AS host_video_last,
      audience_video_last1 AS audience_video_last,
      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,
      audience_video_low_latency_last1 AS audience_video_low_latency_last,
      audience_total_low_latency_last1 AS audience_total_low_latency_last,
      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,
      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,
      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,
      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,
      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,
      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,
      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,
      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,
      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,
      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,
      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,
      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,
      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,
      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,
      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,
      audience_2k_last1 AS audience_2k_last,
      audience_4k_last1 AS audience_4k_last,
      audience_1080p_last1 AS audience_1080p_last,
      host_1080p_last1 AS host_1080p_last,
      host_2k_last1 AS host_2k_last,
      host_4k_last1 AS host_4k_last,
      total_last7,
      audio_last7,
      video_last7,
      video_sd_last7,
      video_hd_last7,
      video_hdp_last7,
      host_sd_last7,
      audience_sd_last7,
      host_hd_last7,
      audience_hd_last7,
      host_hdp_last7,
      audience_hdp_last7,
      host_audio_last7,
      audience_audio_last7,
      host_video_last7,
      audience_video_last7,
      audience_audio_low_latency_last7,
      audience_video_low_latency_last7,
      audience_total_low_latency_last7,
      audience_sd_low_latency_last7,
      audience_hd_low_latency_last7,
      audience_hdp_low_latency_last7,
      audience_1080p_low_latency_last7,
      audience_2k_low_latency_last7,
      audience_4k_low_latency_last7,
      audience_audio_ultra_low_latency_last7,
      audience_video_ultra_low_latency_last7,
      audience_total_ultra_low_latency_last7,
      audience_sd_ultra_low_latency_last7,
      audience_hd_ultra_low_latency_last7,
      audience_hdp_ultra_low_latency_last7,
      audience_1080p_ultra_low_latency_last7,
      audience_2k_ultra_low_latency_last7,
      audience_4k_ultra_low_latency_last7,
      audience_2k_last7,
      audience_4k_last7,
      audience_1080p_last7,
      host_1080p_last7,
      host_2k_last7,
      host_4k_last7
    FROM levels_usage_dod_di_1
    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-06') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-04') AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS ""自定义 SQL 查询""
  CROSS JOIN (SELECT MAX(date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d')) AS ""__measure__0""
    FROM (SELECT date,
            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,
          start_date AS start_date_7,
          end_date AS end_date,
          tag,
          area AS Scope,
          dim,
            CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,
          level2,
          level3,
          level4,
          product_level1 AS product_line,
          product_level2,
          product_level3,
          product_level4,
          vid_internal_industry_en AS cid_industry,
          vid_use_case_en AS vid_use_case_cn,
          vid_sector_en,
          ver_type,
          ver,
          os,
          domain,
          country,
          region,
          dim_grouping_name,
            CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,
          total AS totalUsage,
          audio,
          video,
          host_audio,
          audience_audio,
          host_sd,
          host_hd,
          host_hdp,
          host_1080p,
          host_2k,
          host_4k,
          audience_sd,
          audience_hd,
          audience_hdp,
          audience_1080p,
          audience_2k,
          audience_4k,
          audience_audio_low_latency,
          audience_sd_low_latency,
          audience_hd_low_latency,
          audience_hdp_low_latency,
          audience_1080p_low_latency,
          audience_2k_low_latency,
          audience_4k_low_latency,
          audience_audio_ultra_low_latency,
          audience_sd_ultra_low_latency,
          audience_hd_ultra_low_latency,
          audience_hdp_ultra_low_latency,
          audience_1080p_ultra_low_latency,
          audience_2k_ultra_low_latency,
          audience_4k_ultra_low_latency,
          total_last1 AS audio_video_last,
          audio_last1 AS audio_last,
          video_last1 AS video_last,
          video_sd_last1 AS video_sd_last,
          video_hd_last1 AS video_hd_last,
          video_hdp_last1 AS video_hdp_last,
          host_sd_last1 AS host_video_sd_last,
          audience_sd_last1 AS audience_video_sd_last,
          host_hd_last1 AS host_video_hd_last,
          audience_hd_last1 AS audience_video_hd_last,
          host_hdp_last1 AS host_video_hdp_last,
          audience_hdp_last1 AS audience_video_hdp_last,
          host_audio_last1 AS host_audio_last,
          audience_audio_last1 AS audience_audio_last,
          host_video_last1 AS host_video_last,
          audience_video_last1 AS audience_video_last,
          audience_audio_low_latency_last1 AS audience_audio_low_latency_last,
          audience_video_low_latency_last1 AS audience_video_low_latency_last,
          audience_total_low_latency_last1 AS audience_total_low_latency_last,
          audience_sd_low_latency_last1 AS audience_sd_low_latency_last,
          audience_hd_low_latency_last1 AS audience_hd_low_latency_last,
          audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,
          audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,
          audience_2k_low_latency_last1 AS audience_2k_low_latency_last,
          audience_4k_low_latency_last1 AS audience_4k_low_latency_last,
          audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,
          audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,
          audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,
          audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,
          audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,
          audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,
          audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,
          audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,
          audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,
          audience_2k_last1 AS audience_2k_last,
          audience_4k_last1 AS audience_4k_last,
          audience_1080p_last1 AS audience_1080p_last,
          host_1080p_last1 AS host_1080p_last,
          host_2k_last1 AS host_2k_last,
          host_4k_last1 AS host_4k_last,
          total_last7,
          audio_last7,
          video_last7,
          video_sd_last7,
          video_hd_last7,
          video_hdp_last7,
          host_sd_last7,
          audience_sd_last7,
          host_hd_last7,
          audience_hd_last7,
          host_hdp_last7,
          audience_hdp_last7,
          host_audio_last7,
          audience_audio_last7,
          host_video_last7,
          audience_video_last7,
          audience_audio_low_latency_last7,
          audience_video_low_latency_last7,
          audience_total_low_latency_last7,
          audience_sd_low_latency_last7,
          audience_hd_low_latency_last7,
          audience_hdp_low_latency_last7,
          audience_1080p_low_latency_last7,
          audience_2k_low_latency_last7,
          audience_4k_low_latency_last7,
          audience_audio_ultra_low_latency_last7,
          audience_video_ultra_low_latency_last7,
          audience_total_ultra_low_latency_last7,
          audience_sd_ultra_low_latency_last7,
          audience_hd_ultra_low_latency_last7,
          audience_hdp_ultra_low_latency_last7,
          audience_1080p_ultra_low_latency_last7,
          audience_2k_ultra_low_latency_last7,
          audience_4k_ultra_low_latency_last7,
          audience_2k_last7,
          audience_4k_last7,
          audience_1080p_last7,
          host_1080p_last7,
          host_2k_last7,
          host_4k_last7
        FROM levels_usage_dod_di_1
        WHERE CAST(tag AS VARCHAR) = 'Industry' AND date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-06') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-04') AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS ""自定义 SQL 查询""
    HAVING COUNT(1) > 0) AS ""t0""
WHERE ""自定义 SQL 查询"".""dim"" = 1 AND ""自定义 SQL 查询"".""rank_level1"" = 3 AND date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d') = ""t0"".""__measure__0""
GROUP BY 35"
"SELECT SUM(""自定义 SQL 查询"".""s2l_25ms_delay_sec_last7"") AS ""TEMP(Calculation_1430244791162150914)(10119751)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_25ms_delay_sec"") AS ""TEMP(Calculation_1430244791162150914)(2227145667)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_total_delay_sec"") AS ""TEMP(Calculation_1430244791162150914)(2460078802)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_total_delay_sec_last7"") AS ""TEMP(Calculation_1430244791162150914)(3558359569)(0)"",
  SUM(""自定义 SQL 查询"".""5s_succ_join_ap_cnt"") AS ""TEMP(Calculation_1430244791249522705)(1716451703)(0)"",
  SUM(""自定义 SQL 查询"".""total_join_ap_cnt_last7"") AS ""TEMP(Calculation_1430244791249522705)(2573436739)(0)"",
  SUM(""自定义 SQL 查询"".""total_join_ap_cnt"") AS ""TEMP(Calculation_1430244791249522705)(2681092799)(0)"",
  SUM(""自定义 SQL 查询"".""5s_succ_join_ap_cnt_last7"") AS ""TEMP(Calculation_1430244791249522705)(2802323494)(0)"",
  SUM(""自定义 SQL 查询"".""video_freeze_time_500_last7"") AS ""TEMP(Calculation_1857594119395786754)(1458194667)(0)"",
  SUM(""自定义 SQL 查询"".""video_totaltime_500_last7"") AS ""TEMP(Calculation_1857594119395786754)(2161412938)(0)"",
  SUM(""自定义 SQL 查询"".""video_freeze_time_500"") AS ""TEMP(Calculation_1857594119395786754)(389023081)(0)"",
  SUM(""自定义 SQL 查询"".""video_totaltime_500"") AS ""TEMP(Calculation_1857594119395786754)(458654145)(0)"",
  SUM(""自定义 SQL 查询"".""video_totaltime_200"") AS ""TEMP(Calculation_2033093767653715970)(2104207895)(0)"",
  SUM(""自定义 SQL 查询"".""video_freeze_time_200_last7"") AS ""TEMP(Calculation_2033093767653715970)(3354457873)(0)"",
  SUM(""自定义 SQL 查询"".""video_totaltime_200_last7"") AS ""TEMP(Calculation_2033093767653715970)(3922744675)(0)"",
  SUM(""自定义 SQL 查询"".""video_freeze_time_200"") AS ""TEMP(Calculation_2033093767653715970)(530162565)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_75ms_delay_sec"") AS ""TEMP(Calculation_6542393318886535170)(2003933318)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_75ms_delay_sec_last7"") AS ""TEMP(Calculation_6542393318886535170)(775655446)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_lost_Leq5_last7"") AS ""TEMP(Calculation_7012034266496974850)(2526464233)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_lost_Leq5"") AS ""TEMP(Calculation_7012034266496974850)(2745840127)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_lost_all_last7"") AS ""TEMP(Calculation_7012034266496974850)(453870284)(0)"",
  SUM(""自定义 SQL 查询"".""s2l_lost_all"") AS ""TEMP(Calculation_7012034266496974850)(734589263)(0)"",
  SUM(""自定义 SQL 查询"".""totalJoin"") AS ""TEMP(Calculation_7034341207023464449)(2073556184)(0)"",
  SUM(""自定义 SQL 查询"".""3s_succ_join_session_cnt_last7"") AS ""TEMP(Calculation_7034341207023464449)(2344416377)(0)"",
  SUM(""自定义 SQL 查询"".""total_join_session_cnt_last7"") AS ""TEMP(Calculation_7034341207023464449)(3093209995)(0)"",
  SUM(""自定义 SQL 查询"".""threeSecJoinSuccess"") AS ""TEMP(Calculation_7034341207023464449)(3693645608)(0)"",
  SUM(""自定义 SQL 查询"".""5s_succ_join_session_cnt_last7"") AS ""TEMP(Calculation_7034341207023988739)(1073906376)(0)"",
  SUM(""自定义 SQL 查询"".""fiveSecJoinSuccess"") AS ""TEMP(Calculation_7034341207023988739)(383616769)(0)"",
  SUM(""自定义 SQL 查询"".""succ_join_session_cnt_last7"") AS ""TEMP(Calculation_7034341207025020933)(2300438540)(0)"",
  SUM(""自定义 SQL 查询"".""totalJoinSuccess"") AS ""TEMP(Calculation_7034341207025020933)(2807417001)(0)"",
  SUM(""自定义 SQL 查询"".""video_totaltime_last7"") AS ""TEMP(Calculation_7034341207025557511)(2411308906)(0)"",
  SUM(""自定义 SQL 查询"".""video_totaltime"") AS ""TEMP(Calculation_7034341207025557511)(2797449586)(0)"",
  SUM(""自定义 SQL 查询"".""video_freeze_time"") AS ""TEMP(Calculation_7034341207025557511)(2940759860)(0)"",
  SUM(""自定义 SQL 查询"".""video_freeze_time_last7"") AS ""TEMP(Calculation_7034341207025557511)(3152166089)(0)"",
  SUM(""自定义 SQL 查询"".""audio_totaltime"") AS ""TEMP(Calculation_7034341207025938441)(1652566750)(0)"",
  SUM(""自定义 SQL 查询"".""audio_freeze_time"") AS ""TEMP(Calculation_7034341207025938441)(2919389392)(0)"",
  SUM(""自定义 SQL 查询"".""audio_freeze_time_last7"") AS ""TEMP(Calculation_7034341207025938441)(3377500597)(0)"",
  SUM(""自定义 SQL 查询"".""audio_totaltime_last7"") AS ""TEMP(Calculation_7034341207025938441)(489775499)(0)"",
  SUM(""自定义 SQL 查询"".""crash_cnt_last7"") AS ""TEMP(Calculation_7034341207372492815)(2315319037)(0)"",
  SUM(""自定义 SQL 查询"".""crash_cnt"") AS ""TEMP(Calculation_7034341207372492815)(2360900687)(0)"",
  SUM(""自定义 SQL 查询"".""service_cnt_last7"") AS ""TEMP(Calculation_7034341207372492815)(3843063028)(0)"",
  SUM(""自定义 SQL 查询"".""service_cnt"") AS ""TEMP(Calculation_7034341207372492815)(4291252132)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_lost_all_last7"") AS ""TEMP(Calculation_75998310508670977)(1411695322)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_lost_Leq5"") AS ""TEMP(Calculation_75998310508670977)(1936123547)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_lost_all"") AS ""TEMP(Calculation_75998310508670977)(749826584)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_lost_Leq5_last7"") AS ""TEMP(Calculation_75998310508670977)(790094525)(0)""
FROM (SELECT t1.date,
        CASE WHEN CAST(stat_period AS VARCHAR) = 'day' THEN substr(CAST(date_parse(cast( t1.date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(substr(CAST(start_date AS VARCHAR), 1, 10) AS VARCHAR), '~', CAST(substr(CAST(end_date AS VARCHAR), 1, 10) AS VARCHAR)) END AS period,
      start_date,
      end_date,
      stat_period,
      tag,
      t1.dim,
      level1,
      level2,
      level3,
      level4,
      os,
      ver,
      ver_type,
      domain,
      country,
      region,
      net,
      vid,
      project,
      company_id,
      company_name,
      rowsnum,
      lastusage,
      thisusage,
      fiveSecJoinSuccess,
      totalJoin,
      cnt_sid,
      video_freeze_time,
      video_totaltime,
      audio_freeze_time,
      audio_totaltime,
      s2l_total_delay_sec,
      s2l_25ms_delay_sec,
      s2l_75ms_delay_sec,
      p2s_lost_Leq5,
      p2s_lost_all,
      crash_cnt,
      service_cnt,
      ""1s_succ_join_ap_cnt"",
      ""5s_succ_join_ap_cnt"",
      total_join_ap_cnt,
      totalJoinSuccess,
      threeSecJoinSuccess,
      video_freeze_time_200,
      video_totaltime_200,
      video_freeze_time_500,
      video_totaltime_500,
      ""3s_succ_join_session_cnt_last1"",
      ""5s_succ_join_session_cnt_last1"",
      succ_join_session_cnt_last1,
      total_join_session_cnt_last1,
      total_session_cnt_last1,
      ""1s_succ_join_ap_cnt_last1"",
      ""5s_succ_join_ap_cnt_last1"",
      total_join_ap_cnt_last1,
      ""3s_succ_join_session_cnt_last7"",
      ""5s_succ_join_session_cnt_last7"",
      succ_join_session_cnt_last7,
      total_join_session_cnt_last7,
      total_session_cnt_last7,
      ""1s_succ_join_ap_cnt_last7"",
      ""5s_succ_join_ap_cnt_last7"",
      total_join_ap_cnt_last7,
      video_freeze_time_last1,
      video_totaltime_last1,
      video_freeze_time_500_last1,
      video_totaltime_500_last1,
      video_freeze_time_200_last1,
      video_totaltime_200_last1,
      video_freeze_time_last7,
      video_totaltime_last7,
      video_freeze_time_500_last7,
      video_totaltime_500_last7,
      video_freeze_time_200_last7,
      video_totaltime_200_last7,
      audio_freeze_time_last1,
      audio_totaltime_last1,
      audio_freeze_time_last7,
      audio_totaltime_last7,
      s2l_total_delay_sec_last1,
      s2l_25ms_delay_sec_last1,
      s2l_75ms_delay_sec_last1,
      s2l_total_delay_sec_last7,
      s2l_25ms_delay_sec_last7,
      s2l_75ms_delay_sec_last7,
      p2s_lost_Leq5_last1,
      p2s_lost_all_last1,
      p2s_lost_Leq5_last7,
      p2s_lost_all_last7,
      crash_cnt_last1,
      service_cnt_last1,
      crash_cnt_last7,
      service_cnt_last7,
      product_level1,
      product_level2,
      product_level3,
      product_level4,
      s2l_lost_Leq5,
      s2l_lost_all,
      s2l_lost_Leq5_last1,
      s2l_lost_all_last1,
      s2l_lost_Leq5_last7,
      s2l_lost_all_last7,
      fiveSecJoinSuccess_total,
      totalJoin_total,
      cnt_sid_total,
      video_freeze_time_total,
      video_totaltime_total,
      audio_freeze_time_total,
      audio_totaltime_total,
      s2l_total_delay_sec_total,
      s2l_25ms_delay_sec_total,
      s2l_75ms_delay_sec_total,
      p2s_lost_Leq5_total,
      p2s_lost_all_total,
      crash_cnt_total,
      service_cnt_total,
      ""1s_succ_join_ap_cnt_total"",
      ""5s_succ_join_ap_cnt_total"",
      total_join_ap_cnt_total,
      totalJoinSuccess_total,
      threeSecJoinSuccess_total,
      video_freeze_time_200_total,
      video_totaltime_200_total,
      video_freeze_time_500_total,
      video_totaltime_500_total,
      ""3s_succ_join_session_cnt_last1_total"",
      ""5s_succ_join_session_cnt_last1_total"",
      succ_join_session_cnt_last1_total,
      total_join_session_cnt_last1_total,
      total_session_cnt_last1_total,
      ""1s_succ_join_ap_cnt_last1_total"",
      ""5s_succ_join_ap_cnt_last1_total"",
      total_join_ap_cnt_last1_total,
      ""3s_succ_join_session_cnt_last7_total"",
      ""5s_succ_join_session_cnt_last7_total"",
      succ_join_session_cnt_last7_total,
      total_join_session_cnt_last7_total,
      total_session_cnt_last7_total,
      ""1s_succ_join_ap_cnt_last7_total"",
      ""5s_succ_join_ap_cnt_last7_total"",
      total_join_ap_cnt_last7_total,
      video_freeze_time_last1_total,
      video_totaltime_last1_total,
      video_freeze_time_500_last1_total,
      video_totaltime_500_last1_total,
      video_freeze_time_200_last1_total,
      video_totaltime_200_last1_total,
      video_freeze_time_last7_total,
      video_totaltime_last7_total,
      video_freeze_time_500_last7_total,
      video_totaltime_500_last7_total,
      video_freeze_time_200_last7_total,
      video_totaltime_200_last7_total,
      audio_freeze_time_last1_total,
      audio_totaltime_last1_total,
      audio_freeze_time_last7_total,
      audio_totaltime_last7_total,
      s2l_total_delay_sec_last1_total,
      s2l_25ms_delay_sec_last1_total,
      s2l_75ms_delay_sec_last1_total,
      s2l_total_delay_sec_last7_total,
      s2l_25ms_delay_sec_last7_total,
      s2l_75ms_delay_sec_last7_total,
      p2s_lost_Leq5_last1_total,
      p2s_lost_all_last1_total,
      p2s_lost_Leq5_last7_total,
      p2s_lost_all_last7_total,
      crash_cnt_last1_total,
      service_cnt_last1_total,
      crash_cnt_last7_total,
      service_cnt_last7_total,
      s2l_lost_Leq5_total,
      s2l_lost_all_total,
      s2l_lost_Leq5_last1_total,
      s2l_lost_all_last1_total,
      s2l_lost_Leq5_last7_total,
      s2l_lost_all_last7_total
    FROM report_datahub.pub_levels_quality_di_1 AS t1
      LEFT JOIN (SELECT date,
          dim,
          SUM(fiveSecJoinSuccess) AS fiveSecJoinSuccess_total,
          SUM(totalJoin) AS totalJoin_total,
          SUM(cnt_sid) AS cnt_sid_total,
          SUM(video_freeze_time) AS video_freeze_time_total,
          SUM(video_totaltime) AS video_totaltime_total,
          SUM(audio_freeze_time) AS audio_freeze_time_total,
          SUM(audio_totaltime) AS audio_totaltime_total,
          SUM(s2l_total_delay_sec) AS s2l_total_delay_sec_total,
          SUM(s2l_25ms_delay_sec) AS s2l_25ms_delay_sec_total,
          SUM(s2l_75ms_delay_sec) AS s2l_75ms_delay_sec_total,
          SUM(p2s_lost_Leq5) AS p2s_lost_Leq5_total,
          SUM(p2s_lost_all) AS p2s_lost_all_total,
          SUM(crash_cnt) AS crash_cnt_total,
          SUM(service_cnt) AS service_cnt_total,
          SUM(""1s_succ_join_ap_cnt"") AS ""1s_succ_join_ap_cnt_total"",
          SUM(""5s_succ_join_ap_cnt"") AS ""5s_succ_join_ap_cnt_total"",
          SUM(total_join_ap_cnt) AS total_join_ap_cnt_total,
          SUM(totalJoinSuccess) AS totalJoinSuccess_total,
          SUM(threeSecJoinSuccess) AS threeSecJoinSuccess_total,
          SUM(video_freeze_time_200) AS video_freeze_time_200_total,
          SUM(video_totaltime_200) AS video_totaltime_200_total,
          SUM(video_freeze_time_500) AS video_freeze_time_500_total,
          SUM(video_totaltime_500) AS video_totaltime_500_total,
          SUM(""3s_succ_join_session_cnt_last1"") AS ""3s_succ_join_session_cnt_last1_total"",
          SUM(""5s_succ_join_session_cnt_last1"") AS ""5s_succ_join_session_cnt_last1_total"",
          SUM(succ_join_session_cnt_last1) AS succ_join_session_cnt_last1_total,
          SUM(total_join_session_cnt_last1) AS total_join_session_cnt_last1_total,
          SUM(total_session_cnt_last1) AS total_session_cnt_last1_total,
          SUM(""1s_succ_join_ap_cnt_last1"") AS ""1s_succ_join_ap_cnt_last1_total"",
          SUM(""5s_succ_join_ap_cnt_last1"") AS ""5s_succ_join_ap_cnt_last1_total"",
          SUM(total_join_ap_cnt_last1) AS total_join_ap_cnt_last1_total,
          SUM(""3s_succ_join_session_cnt_last7"") AS ""3s_succ_join_session_cnt_last7_total"",
          SUM(""5s_succ_join_session_cnt_last7"") AS ""5s_succ_join_session_cnt_last7_total"",
          SUM(succ_join_session_cnt_last7) AS succ_join_session_cnt_last7_total,
          SUM(total_join_session_cnt_last7) AS total_join_session_cnt_last7_total,
          SUM(total_session_cnt_last7) AS total_session_cnt_last7_total,
          SUM(""1s_succ_join_ap_cnt_last7"") AS ""1s_succ_join_ap_cnt_last7_total"",
          SUM(""5s_succ_join_ap_cnt_last7"") AS ""5s_succ_join_ap_cnt_last7_total"",
          SUM(total_join_ap_cnt_last7) AS total_join_ap_cnt_last7_total,
          SUM(video_freeze_time_last1) AS video_freeze_time_last1_total,
          SUM(video_totaltime_last1) AS video_totaltime_last1_total,
          SUM(video_freeze_time_500_last1) AS video_freeze_time_500_last1_total,
          SUM(video_totaltime_500_last1) AS video_totaltime_500_last1_total,
          SUM(video_freeze_time_200_last1) AS video_freeze_time_200_last1_total,
          SUM(video_totaltime_200_last1) AS video_totaltime_200_last1_total,
          SUM(video_freeze_time_last7) AS video_freeze_time_last7_total,
          SUM(video_totaltime_last7) AS video_totaltime_last7_total,
          SUM(video_freeze_time_500_last7) AS video_freeze_time_500_last7_total,
          SUM(video_totaltime_500_last7) AS video_totaltime_500_last7_total,
          SUM(video_freeze_time_200_last7) AS video_freeze_time_200_last7_total,
          SUM(video_totaltime_200_last7) AS video_totaltime_200_last7_total,
          SUM(audio_freeze_time_last1) AS audio_freeze_time_last1_total,
          SUM(audio_totaltime_last1) AS audio_totaltime_last1_total,
          SUM(audio_freeze_time_last7) AS audio_freeze_time_last7_total,
          SUM(audio_totaltime_last7) AS audio_totaltime_last7_total,
          SUM(s2l_total_delay_sec_last1) AS s2l_total_delay_sec_last1_total,
          SUM(s2l_25ms_delay_sec_last1) AS s2l_25ms_delay_sec_last1_total,
          SUM(s2l_75ms_delay_sec_last1) AS s2l_75ms_delay_sec_last1_total,
          SUM(s2l_total_delay_sec_last7) AS s2l_total_delay_sec_last7_total,
          SUM(s2l_25ms_delay_sec_last7) AS s2l_25ms_delay_sec_last7_total,
          SUM(s2l_75ms_delay_sec_last7) AS s2l_75ms_delay_sec_last7_total,
          SUM(p2s_lost_Leq5_last1) AS p2s_lost_Leq5_last1_total,
          SUM(p2s_lost_all_last1) AS p2s_lost_all_last1_total,
          SUM(p2s_lost_Leq5_last7) AS p2s_lost_Leq5_last7_total,
          SUM(p2s_lost_all_last7) AS p2s_lost_all_last7_total,
          SUM(crash_cnt_last1) AS crash_cnt_last1_total,
          SUM(service_cnt_last1) AS service_cnt_last1_total,
          SUM(crash_cnt_last7) AS crash_cnt_last7_total,
          SUM(service_cnt_last7) AS service_cnt_last7_total,
          SUM(s2l_lost_Leq5) AS s2l_lost_Leq5_total,
          SUM(s2l_lost_all) AS s2l_lost_all_total,
          SUM(s2l_lost_Leq5_last1) AS s2l_lost_Leq5_last1_total,
          SUM(s2l_lost_all_last1) AS s2l_lost_all_last1_total,
          SUM(s2l_lost_Leq5_last7) AS s2l_lost_Leq5_last7_total,
          SUM(s2l_lost_all_last7) AS s2l_lost_all_last7_total
        FROM report_datahub.pub_levels_quality_di_1
        WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-21') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-05') AND CAST(tag AS VARCHAR) = 'Product'
        GROUP BY date,
          dim) AS t2 ON t1.date = t2.date AND t1.dim = t2.dim
    WHERE date_parse(cast( t1.date as VARCHAR), '%Y%m%d') >= DATE('2021-11-21') AND date_parse(cast( t1.date as VARCHAR), '%Y%m%d') <= DATE('2021-12-05') AND CAST(tag AS VARCHAR) = 'Product') AS ""自定义 SQL 查询""
  CROSS JOIN (SELECT MAX(date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d')) AS ""__measure__0""
    FROM (SELECT t1.date,
            CASE WHEN CAST(stat_period AS VARCHAR) = 'day' THEN substr(CAST(date_parse(cast( t1.date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(substr(CAST(start_date AS VARCHAR), 1, 10) AS VARCHAR), '~', CAST(substr(CAST(end_date AS VARCHAR), 1, 10) AS VARCHAR)) END AS period,
          start_date,
          end_date,
          stat_period,
          tag,
          t1.dim,
          level1,
          level2,
          level3,
          level4,
          os,
          ver,
          ver_type,
          domain,
          country,
          region,
          net,
          vid,
          project,
          company_id,
          company_name,
          rowsnum,
          lastusage,
          thisusage,
          fiveSecJoinSuccess,
          totalJoin,
          cnt_sid,
          video_freeze_time,
          video_totaltime,
          audio_freeze_time,
          audio_totaltime,
          s2l_total_delay_sec,
          s2l_25ms_delay_sec,
          s2l_75ms_delay_sec,
          p2s_lost_Leq5,
          p2s_lost_all,
          crash_cnt,
          service_cnt,
          ""1s_succ_join_ap_cnt"",
          ""5s_succ_join_ap_cnt"",
          total_join_ap_cnt,
          totalJoinSuccess,
          threeSecJoinSuccess,
          video_freeze_time_200,
          video_totaltime_200,
          video_freeze_time_500,
          video_totaltime_500,
          ""3s_succ_join_session_cnt_last1"",
          ""5s_succ_join_session_cnt_last1"",
          succ_join_session_cnt_last1,
          total_join_session_cnt_last1,
          total_session_cnt_last1,
          ""1s_succ_join_ap_cnt_last1"",
          ""5s_succ_join_ap_cnt_last1"",
          total_join_ap_cnt_last1,
          ""3s_succ_join_session_cnt_last7"",
          ""5s_succ_join_session_cnt_last7"",
          succ_join_session_cnt_last7,
          total_join_session_cnt_last7,
          total_session_cnt_last7,
          ""1s_succ_join_ap_cnt_last7"",
          ""5s_succ_join_ap_cnt_last7"",
          total_join_ap_cnt_last7,
          video_freeze_time_last1,
          video_totaltime_last1,
          video_freeze_time_500_last1,
          video_totaltime_500_last1,
          video_freeze_time_200_last1,
          video_totaltime_200_last1,
          video_freeze_time_last7,
          video_totaltime_last7,
          video_freeze_time_500_last7,
          video_totaltime_500_last7,
          video_freeze_time_200_last7,
          video_totaltime_200_last7,
          audio_freeze_time_last1,
          audio_totaltime_last1,
          audio_freeze_time_last7,
          audio_totaltime_last7,
          s2l_total_delay_sec_last1,
          s2l_25ms_delay_sec_last1,
          s2l_75ms_delay_sec_last1,
          s2l_total_delay_sec_last7,
          s2l_25ms_delay_sec_last7,
          s2l_75ms_delay_sec_last7,
          p2s_lost_Leq5_last1,
          p2s_lost_all_last1,
          p2s_lost_Leq5_last7,
          p2s_lost_all_last7,
          crash_cnt_last1,
          service_cnt_last1,
          crash_cnt_last7,
          service_cnt_last7,
          product_level1,
          product_level2,
          product_level3,
          product_level4,
          s2l_lost_Leq5,
          s2l_lost_all,
          s2l_lost_Leq5_last1,
          s2l_lost_all_last1,
          s2l_lost_Leq5_last7,
          s2l_lost_all_last7,
          fiveSecJoinSuccess_total,
          totalJoin_total,
          cnt_sid_total,
          video_freeze_time_total,
          video_totaltime_total,
          audio_freeze_time_total,
          audio_totaltime_total,
          s2l_total_delay_sec_total,
          s2l_25ms_delay_sec_total,
          s2l_75ms_delay_sec_total,
          p2s_lost_Leq5_total,
          p2s_lost_all_total,
          crash_cnt_total,
          service_cnt_total,
          ""1s_succ_join_ap_cnt_total"",
          ""5s_succ_join_ap_cnt_total"",
          total_join_ap_cnt_total,
          totalJoinSuccess_total,
          threeSecJoinSuccess_total,
          video_freeze_time_200_total,
          video_totaltime_200_total,
          video_freeze_time_500_total,
          video_totaltime_500_total,
          ""3s_succ_join_session_cnt_last1_total"",
          ""5s_succ_join_session_cnt_last1_total"",
          succ_join_session_cnt_last1_total,
          total_join_session_cnt_last1_total,
          total_session_cnt_last1_total,
          ""1s_succ_join_ap_cnt_last1_total"",
          ""5s_succ_join_ap_cnt_last1_total"",
          total_join_ap_cnt_last1_total,
          ""3s_succ_join_session_cnt_last7_total"",
          ""5s_succ_join_session_cnt_last7_total"",
          succ_join_session_cnt_last7_total,
          total_join_session_cnt_last7_total,
          total_session_cnt_last7_total,
          ""1s_succ_join_ap_cnt_last7_total"",
          ""5s_succ_join_ap_cnt_last7_total"",
          total_join_ap_cnt_last7_total,
          video_freeze_time_last1_total,
          video_totaltime_last1_total,
          video_freeze_time_500_last1_total,
          video_totaltime_500_last1_total,
          video_freeze_time_200_last1_total,
          video_totaltime_200_last1_total,
          video_freeze_time_last7_total,
          video_totaltime_last7_total,
          video_freeze_time_500_last7_total,
          video_totaltime_500_last7_total,
          video_freeze_time_200_last7_total,
          video_totaltime_200_last7_total,
          audio_freeze_time_last1_total,
          audio_totaltime_last1_total,
          audio_freeze_time_last7_total,
          audio_totaltime_last7_total,
          s2l_total_delay_sec_last1_total,
          s2l_25ms_delay_sec_last1_total,
          s2l_75ms_delay_sec_last1_total,
          s2l_total_delay_sec_last7_total,
          s2l_25ms_delay_sec_last7_total,
          s2l_75ms_delay_sec_last7_total,
          p2s_lost_Leq5_last1_total,
          p2s_lost_all_last1_total,
          p2s_lost_Leq5_last7_total,
          p2s_lost_all_last7_total,
          crash_cnt_last1_total,
          service_cnt_last1_total,
          crash_cnt_last7_total,
          service_cnt_last7_total,
          s2l_lost_Leq5_total,
          s2l_lost_all_total,
          s2l_lost_Leq5_last1_total,
          s2l_lost_all_last1_total,
          s2l_lost_Leq5_last7_total,
          s2l_lost_all_last7_total
        FROM report_datahub.pub_levels_quality_di_1 AS t1
          LEFT JOIN (SELECT date,
              dim,
              SUM(fiveSecJoinSuccess) AS fiveSecJoinSuccess_total,
              SUM(totalJoin) AS totalJoin_total,
              SUM(cnt_sid) AS cnt_sid_total,
              SUM(video_freeze_time) AS video_freeze_time_total,
              SUM(video_totaltime) AS video_totaltime_total,
              SUM(audio_freeze_time) AS audio_freeze_time_total,
              SUM(audio_totaltime) AS audio_totaltime_total,
              SUM(s2l_total_delay_sec) AS s2l_total_delay_sec_total,
              SUM(s2l_25ms_delay_sec) AS s2l_25ms_delay_sec_total,
              SUM(s2l_75ms_delay_sec) AS s2l_75ms_delay_sec_total,
              SUM(p2s_lost_Leq5) AS p2s_lost_Leq5_total,
              SUM(p2s_lost_all) AS p2s_lost_all_total,
              SUM(crash_cnt) AS crash_cnt_total,
              SUM(service_cnt) AS service_cnt_total,
              SUM(""1s_succ_join_ap_cnt"") AS ""1s_succ_join_ap_cnt_total"",
              SUM(""5s_succ_join_ap_cnt"") AS ""5s_succ_join_ap_cnt_total"",
              SUM(total_join_ap_cnt) AS total_join_ap_cnt_total,
              SUM(totalJoinSuccess) AS totalJoinSuccess_total,
              SUM(threeSecJoinSuccess) AS threeSecJoinSuccess_total,
              SUM(video_freeze_time_200) AS video_freeze_time_200_total,
              SUM(video_totaltime_200) AS video_totaltime_200_total,
              SUM(video_freeze_time_500) AS video_freeze_time_500_total,
              SUM(video_totaltime_500) AS video_totaltime_500_total,
              SUM(""3s_succ_join_session_cnt_last1"") AS ""3s_succ_join_session_cnt_last1_total"",
              SUM(""5s_succ_join_session_cnt_last1"") AS ""5s_succ_join_session_cnt_last1_total"",
              SUM(succ_join_session_cnt_last1) AS succ_join_session_cnt_last1_total,
              SUM(total_join_session_cnt_last1) AS total_join_session_cnt_last1_total,
              SUM(total_session_cnt_last1) AS total_session_cnt_last1_total,
              SUM(""1s_succ_join_ap_cnt_last1"") AS ""1s_succ_join_ap_cnt_last1_total"",
              SUM(""5s_succ_join_ap_cnt_last1"") AS ""5s_succ_join_ap_cnt_last1_total"",
              SUM(total_join_ap_cnt_last1) AS total_join_ap_cnt_last1_total,
              SUM(""3s_succ_join_session_cnt_last7"") AS ""3s_succ_join_session_cnt_last7_total"",
              SUM(""5s_succ_join_session_cnt_last7"") AS ""5s_succ_join_session_cnt_last7_total"",
              SUM(succ_join_session_cnt_last7) AS succ_join_session_cnt_last7_total,
              SUM(total_join_session_cnt_last7) AS total_join_session_cnt_last7_total,
              SUM(total_session_cnt_last7) AS total_session_cnt_last7_total,
              SUM(""1s_succ_join_ap_cnt_last7"") AS ""1s_succ_join_ap_cnt_last7_total"",
              SUM(""5s_succ_join_ap_cnt_last7"") AS ""5s_succ_join_ap_cnt_last7_total"",
              SUM(total_join_ap_cnt_last7) AS total_join_ap_cnt_last7_total,
              SUM(video_freeze_time_last1) AS video_freeze_time_last1_total,
              SUM(video_totaltime_last1) AS video_totaltime_last1_total,
              SUM(video_freeze_time_500_last1) AS video_freeze_time_500_last1_total,
              SUM(video_totaltime_500_last1) AS video_totaltime_500_last1_total,
              SUM(video_freeze_time_200_last1) AS video_freeze_time_200_last1_total,
              SUM(video_totaltime_200_last1) AS video_totaltime_200_last1_total,
              SUM(video_freeze_time_last7) AS video_freeze_time_last7_total,
              SUM(video_totaltime_last7) AS video_totaltime_last7_total,
              SUM(video_freeze_time_500_last7) AS video_freeze_time_500_last7_total,
              SUM(video_totaltime_500_last7) AS video_totaltime_500_last7_total,
              SUM(video_freeze_time_200_last7) AS video_freeze_time_200_last7_total,
              SUM(video_totaltime_200_last7) AS video_totaltime_200_last7_total,
              SUM(audio_freeze_time_last1) AS audio_freeze_time_last1_total,
              SUM(audio_totaltime_last1) AS audio_totaltime_last1_total,
              SUM(audio_freeze_time_last7) AS audio_freeze_time_last7_total,
              SUM(audio_totaltime_last7) AS audio_totaltime_last7_total,
              SUM(s2l_total_delay_sec_last1) AS s2l_total_delay_sec_last1_total,
              SUM(s2l_25ms_delay_sec_last1) AS s2l_25ms_delay_sec_last1_total,
              SUM(s2l_75ms_delay_sec_last1) AS s2l_75ms_delay_sec_last1_total,
              SUM(s2l_total_delay_sec_last7) AS s2l_total_delay_sec_last7_total,
              SUM(s2l_25ms_delay_sec_last7) AS s2l_25ms_delay_sec_last7_total,
              SUM(s2l_75ms_delay_sec_last7) AS s2l_75ms_delay_sec_last7_total,
              SUM(p2s_lost_Leq5_last1) AS p2s_lost_Leq5_last1_total,
              SUM(p2s_lost_all_last1) AS p2s_lost_all_last1_total,
              SUM(p2s_lost_Leq5_last7) AS p2s_lost_Leq5_last7_total,
              SUM(p2s_lost_all_last7) AS p2s_lost_all_last7_total,
              SUM(crash_cnt_last1) AS crash_cnt_last1_total,
              SUM(service_cnt_last1) AS service_cnt_last1_total,
              SUM(crash_cnt_last7) AS crash_cnt_last7_total,
              SUM(service_cnt_last7) AS service_cnt_last7_total,
              SUM(s2l_lost_Leq5) AS s2l_lost_Leq5_total,
              SUM(s2l_lost_all) AS s2l_lost_all_total,
              SUM(s2l_lost_Leq5_last1) AS s2l_lost_Leq5_last1_total,
              SUM(s2l_lost_all_last1) AS s2l_lost_all_last1_total,
              SUM(s2l_lost_Leq5_last7) AS s2l_lost_Leq5_last7_total,
              SUM(s2l_lost_all_last7) AS s2l_lost_all_last7_total
            FROM report_datahub.pub_levels_quality_di_1
            WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-21') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-05') AND CAST(tag AS VARCHAR) = 'Product'
            GROUP BY date,
              dim) AS t2 ON t1.date = t2.date AND t1.dim = t2.dim
        WHERE date_parse(cast( t1.date as VARCHAR), '%Y%m%d') >= DATE('2021-11-21') AND date_parse(cast( t1.date as VARCHAR), '%Y%m%d') <= DATE('2021-12-05') AND CAST(tag AS VARCHAR) = 'Product') AS ""自定义 SQL 查询""
    HAVING COUNT(1) > 0) AS ""t0""
WHERE CASE WHEN CAST(""自定义 SQL 查询"".""tag"" AS VARCHAR) = 'Industry' AND CAST(""自定义 SQL 查询"".""product_level1"" AS VARCHAR) = 'RTC' AND CAST(""自定义 SQL 查询"".""dim"" AS VARCHAR) = 'osver' THEN 0 WHEN CAST(""自定义 SQL 查询"".""tag"" AS VARCHAR) = 'VerType' AND CAST(""自定义 SQL 查询"".""product_level1"" AS VARCHAR) = 'RTC' AND CAST(""自定义 SQL 查询"".""dim"" AS VARCHAR) = 'osver' THEN 0 WHEN CAST(""自定义 SQL 查询"".""tag"" AS VARCHAR) = 'Product' AND CAST(""自定义 SQL 查询"".""dim"" AS VARCHAR) = 'osver' AND CAST(""自定义 SQL 查询"".""product_level1"" AS VARCHAR) = 'RTC' THEN 1 ELSE 0 END AND CAST(""自定义 SQL 查询"".""level2"" AS VARCHAR) = 'Native' AND DATE_ADD('SECOND', 0, date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d')) = DATE_ADD('SECOND', 0, ""t0"".""__measure__0"")
HAVING COUNT(1) > 0"
"SELECT SUM(""自定义 SQL 查询"".""p2s_Delay25"" * ""自定义 SQL 查询"".""delay_total"") AS ""TEMP(Calculation_1122874106494361604)(1461110105)(0)"",
  SUM(""自定义 SQL 查询"".""delay_total"") AS ""TEMP(Calculation_1122874106494361604)(363980608)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_Delay50"" * ""自定义 SQL 查询"".""delay_total"") AS ""TEMP(Calculation_1122874106494976005)(1551638771)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_Delay75"" * ""自定义 SQL 查询"".""delay_total"") AS ""TEMP(Calculation_1122874106495696902)(2562427304)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_lostRatio"" * ""自定义 SQL 查询"".""p2s_total"") AS ""TEMP(Calculation_1122874106495848455)(1741181994)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_total"") AS ""TEMP(Calculation_1122874106495848455)(2624355999)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_jitter95_100"" * ""自定义 SQL 查询"".""jitter95_total"") AS ""TEMP(Calculation_4208191644263628803)(3609783325)(0)"",
  SUM(""自定义 SQL 查询"".""jitter95_total"") AS ""TEMP(Calculation_4208191644263628803)(633698484)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_jitter95_50"" * ""自定义 SQL 查询"".""jitter95_total"") AS ""TEMP(Calculation_4208191644264697860)(1652714847)(0)"",
  SUM(""自定义 SQL 查询"".""p2s_jitter95_200"" * ""自定义 SQL 查询"".""jitter95_total"") AS ""TEMP(Calculation_4208191644264935429)(206867949)(0)"",
  ""自定义 SQL 查询"".""srcRegion"" AS ""srcRegion"",
  ""自定义 SQL 查询"".""src_isp"" AS ""src_isp"",
  SUM(""自定义 SQL 查询"".""p2s_total"") AS ""sum_p2s_total_ok""
FROM (SELECT date AS ""date"",
      src_domain AS ""srcDomain"",
      src_region AS ""srcRegion"",
      dest_idc AS ""idc"",
      src_isp,
      dest_ip,
      delay_25 AS ""p2s_Delay25"",
      delay_50 AS ""p2s_Delay50"",
      delay_75 AS ""p2s_Delay75"",
      delay_100 AS ""p2s_Delay100"",
      delay_125 AS ""p2s_Delay125"",
      delay_150 AS ""p2s_Delay150"",
      delay_total,
      lost_ratio_5 AS ""p2s_lostRatio"",
      lostratio_total AS ""p2s_total"",
      jitter95_50 AS ""p2s_jitter95_50"",
      jitter95_100 AS ""p2s_jitter95_100"",
      jitter95_200 AS ""p2s_jitter95_200"",
      jitter95_300 AS ""p2s_jitter95_300"",
      jitter95_total,
      product_line,
      product_type
    FROM media.p2s_cover_mainland_ip
    WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-25') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-01')) AS ""自定义 SQL 查询""
WHERE CAST(""自定义 SQL 查询"".""srcRegion"" AS VARCHAR) >= 'Anhui' AND CAST(""自定义 SQL 查询"".""srcRegion"" AS VARCHAR) <= 'Zhejiang' AND (""自定义 SQL 查询"".""idc"" IN ('aofei-hk1ga', 'aofei-singapore1ga', 'evc-singapore1ga', 'evc-singapore1gb', 'huhehaote1g-ctel', 'yancheng1g-ctel', 'zen-saopaulo2') OR ( (  ""自定义 SQL 查询"".""idc""  ) is null) OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'baoji1g-ctel' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'beijing8-bgp' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'changchun1g-cucc' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'changsha1g-cucc' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'changzhou9a-drpeng' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'eq-frankfurt1g' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'evc-chicago1g' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'evc-japan9a' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'foshan1g-ctel' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'huainan1g-cmcc' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'jinan1g-3line' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'jinan9-cmcc' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'jiujiang9-ctel' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'luoyang1g-ctel' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'nanchang1g-cmcc' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'taiyuan6bdbm-ctel' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'taiyuan9-cucc' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'wuxi3c-bgp' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'xiamen6bd-ctel' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'xuzhou9b-ctel' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'yancheng9-cmcc' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'zen-frankfurt1gb' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'zen-frankfurt9a' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'zen-japan9' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'zen-london1ga' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'zen-losangeles9' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'zen-melbourne9a' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'zen-mumbai9' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'zen-singapore1ga' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'zen-washington1ga' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'zhangjiakou1gb-cmcc' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'zhengzhou6bd-cucc' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'zhenjiang1g-3line' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'zhuzhou1g-ctel') AND (( (  ""自定义 SQL 查询"".""product_type""  ) is null) OR CAST(""自定义 SQL 查询"".""product_type"" AS VARCHAR) >= 'CloudPlayer' AND CAST(""自定义 SQL 查询"".""product_type"" AS VARCHAR) <= 'WebRTS')
GROUP BY 11,
  12
HAVING CASE WHEN SUM(""自定义 SQL 查询"".""p2s_total"") >= 0 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100 THEN 0 WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 1000 THEN 1 WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 1000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 10000 THEN 0 WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 10000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100000 THEN 0 WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100000 THEN 0 ELSE 0 END OR CASE WHEN SUM(""自定义 SQL 查询"".""p2s_total"") >= 0 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100 THEN 0 WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 1000 THEN 0 WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 1000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 10000 THEN 1 WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 10000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100000 THEN 0 WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100000 THEN 0 ELSE 0 END OR CASE WHEN SUM(""自定义 SQL 查询"".""p2s_total"") >= 0 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100 THEN 0 WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 1000 THEN 0 WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 1000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 10000 THEN 0 WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 10000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100000 THEN 1 WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100000 THEN 0 ELSE 0 END OR CASE WHEN SUM(""自定义 SQL 查询"".""p2s_total"") >= 0 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100 THEN 0 WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 1000 THEN 0 WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 1000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 10000 THEN 0 WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 10000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100000 THEN 0 WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100000 THEN 1 ELSE 0 END"
"SELECT ""自定义 SQL 查询"".""product_level1"" AS ""product_level1"",
  ""自定义 SQL 查询"".""product_level2"" AS ""product_level2"",
  ""自定义 SQL 查询"".""product_level3"" AS ""product_level3"",
  SUM(""自定义 SQL 查询"".""total"") AS ""sum_total_ok""
FROM (SELECT date,
      SUBSTR(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) AS date_range_1,
      SUBSTR(CAST(end_date AS VARCHAR), 1, 10) AS date_range_2,
      stat_period,
        CASE WHEN CAST(stat_period AS VARCHAR) = 'day' THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,
      area,
      vid,
      project,
      company_id AS cid,
      company_name AS company,
      customer_level AS level,
      vid_internal_industry_en AS industry,
      vid_use_case_cn,
      csdc_owner,
      os,
      ver,
      ver_type,
      product_level1,
      product_level2,
      product_level3,
      total,
      audio,
      video,
      video_sd,
      video_hd,
      video_hdp,
        host_audio + host_video AS host,
      host_audio,
      host_video,
      host_sd,
      host_hd,
      host_hdp,
        audience_audio + audience_video AS audience,
        audience_audio_low_latency + audience_video_low_latency AS audience_low_latency,
      audience_audio,
      audience_audio_low_latency,
      audience_video,
      audience_video_low_latency,
      audience_sd,
      audience_sd_low_latency,
      audience_hd,
      audience_hd_low_latency,
      audience_hdp,
      audience_hdp_low_latency,
      total_last1,
      audio_last1,
      video_last1,
      video_sd_last1,
      video_hd_last1,
      video_hdp_last1,
        host_audio_last1 + host_video_last1 AS host_last1,
      host_audio_last1,
      host_video_last1,
        audience_audio_last1 + audience_video_last1 AS audience_last1,
        audience_audio_low_latency_last1 + audience_video_low_latency_last1 AS audience_low_latency_last1,
      audience_audio_last1,
      audience_audio_low_latency_last1,
      audience_video_last1,
      audience_video_low_latency_last1,
      total_last7,
      audio_last7,
      video_last7,
      video_sd_last7,
      video_hd_last7,
      video_hdp_last7,
        host_audio_last7 + host_video_last7 AS host_last7,
      host_audio_last7,
      host_video_last7,
        audience_audio_last7 + audience_video_last7 AS audience_last7,
        audience_audio_low_latency_last7 + audience_video_low_latency_last7 AS audience_low_latency_last7,
      audience_audio_last7,
      audience_audio_low_latency_last7,
      audience_video_last7,
      audience_video_low_latency_last7
    FROM report_datahub.vendor_vid_usage_di_1
    WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-06') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-06') AND CAST(vid AS VARCHAR) = CAST(428342 AS VARCHAR) AND dim = 1) AS ""自定义 SQL 查询""
GROUP BY 1,
  2,
  3"
"SELECT ""自定义 SQL 查询"".""idc"" AS ""idc"",
  ""自定义 SQL 查询"".""srcRegion"" AS ""srcRegion"",
    CASE WHEN SUM(""自定义 SQL 查询"".""p2s_total"") >= 0 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100 THEN '0-100' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 1000 THEN '100-1000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 1000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 10000 THEN '1000-10000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 10000 AND SUM(""自定义 SQL 查询"".""p2s_total"") <= 100000 THEN '10000-100000' WHEN SUM(""自定义 SQL 查询"".""p2s_total"") > 100000 THEN '100000以上' ELSE 'other' END AS ""usr_Calculation_4757419695720181760_nk""
FROM (SELECT date AS ""date"",
      src_domain AS ""srcDomain"",
      src_region AS ""srcRegion"",
      dest_idc AS ""idc"",
      delay_25 AS ""p2s_Delay25"",
      delay_50 AS ""p2s_Delay50"",
      delay_75 AS ""p2s_Delay75"",
      delay_100 AS ""p2s_Delay100"",
      delay_125 AS ""p2s_Delay125"",
      delay_150 AS ""p2s_Delay150"",
      delay_total,
      lost_ratio_5 AS ""p2s_lostRatio"",
      lostratio_total AS ""p2s_total"",
      jitter95_50 AS ""p2s_jitter95_50"",
      jitter95_100 AS ""p2s_jitter95_100"",
      jitter95_200 AS ""p2s_jitter95_200"",
      jitter95_300 AS ""p2s_jitter95_300"",
      jitter95_total,
      product_line,
      product_type
    FROM media.p2s_cover_mainland_ip
    WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-25') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-01')) AS ""自定义 SQL 查询""
WHERE (""自定义 SQL 查询"".""idc"" IN ('aofei-frankfurt1g', 'aofei-hk1ga', 'aofei-japan', 'aofei-singapore1ga', 'aofei-tokyo9', 'changchun1g-cucc', 'changsha-cucc', 'changsha9-ctel', 'eq-newyork10', 'eq-newyork9', 'evc-chicago1g', 'evc-frankfurt1ga', 'evc-frankfurt9', 'evc-japan9a', 'evc-seattle1g', 'evc-singapore1ga', 'evc-singapore1gb', 'fuzhou1g-cmcc', 'guangzhou-cmcc', 'guangzhou0t-drpeng', 'guangzhou1g-cmcc', 'guangzhou6js-bgp', 'guangzhou99-cmcc', 'hangzhou6al-bgp', 'hangzhou9-ctel', 'hangzhou9b-cmcc', 'hefei9-cmcc', 'huainan1g-cmcc', 'huhehaote1g-ctel', 'huzhou9-ctel', 'huzhou9-cucc', 'jinan1g-3line', 'jinan1g-cucc', 'jinan6bdbm-cucc', 'jinan9-cmcc', 'jiujiang9-ctel', 'langfang6uc-cucc', 'nanchang1g-cmcc', 'neijiang1g-ctel', 'ningbo1g-3line', 'qingdao1g-ctel', 'qinhuangdao1g-cucc', 'shanghai6js-bgp', 'shantou1g-ctel', 'shenyang1g-cmcc', 'shenyang9a-cucc', 'suzhou1g-cmcc', 'suzhou6bdbm-ctel', 'taiyuan6bd-ctel', 'taiyuan6bdbm-ctel', 'taiyuan9-cucc', 'tangshan9-cucc', 'tangshan99-cucc', 'tianjin1ga-ctel', 'tianjin3g-3line', 'wujiang-ctel', 'wuxi3c-bgp', 'xiamen6bd-ctel', 'xiamen6bdbm-ctel', 'xinxiang1g-cucc', 'yancheng1g-ctel', 'yantai1g-cucc', 'yiyang1g-cucc', 'yueyang6bd-ctel', 'yueyang6bdbm-ctel', 'zaozhuang9b-cucc', 'zen-amsterdam9b', 'zen-bangalore1ga', 'zen-bangkok', 'zen-chennai1ga', 'zen-dallas1g', 'zen-frankfurt1g', 'zen-frankfurt1gb', 'zen-hk9b', 'zen-losangeles9', 'zen-losangeles9a', 'zen-melbourne9a', 'zen-miami1g', 'zen-moscow2', 'zen-saopaulo2', 'zen-singapore1ga', 'zen-singapore1gb', 'zen-singapore3a', 'zen-washington1ga') OR ( (  ""自定义 SQL 查询"".""idc""  ) is null) OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'baoji1g-ctel' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'beijing-bgp' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'beijing6-bgp' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'beijing8-bgp' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'changsha1g-3line' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'changsha1g-cucc' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'changzhou9a-drpeng' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'chengdu6al-bgp' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'chongqing1g-3line' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'chongqing1ga-ctel' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'dalian1g-cmcc' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'eq-losangeles9' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'foshan1g-ctel' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'foshan9-ctel' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'guizhou1g-ctel' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'hangzhou3g-3line' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'lishui1g-ctel' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'luoyang1g-ctel' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'nanchang6bd-ctel' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'nanchang6uc-ctel' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'qinhuangdao9-cucc' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'retn-amsterdam0t' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'shenzhen9-drpeng' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'singtel-singapore0t' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'taizhou1g-3line' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'taizhou9-cucc' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'tianjin1g-cmcc' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'tianjin1g-cucc' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'tianjin9-ctel' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'tianjin9d-cucc' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'wenzhou1g-cmcc' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'wenzhou9-cmcc' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'xian1g-cmcc' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'xiangyang1g-cmcc' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'xixian9-ctel' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'xuzhou9b-ctel' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'yancheng9-cmcc' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'yancheng9b-ctel' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'yangzhou1g-cmcc' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'yangzhou6uc-3line' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'zen-amsterdam1' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'zen-amsterdam3' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'zen-frankfurt9a' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'zen-hk1gb' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'zen-japan' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'zen-japan9' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'zen-london1ga' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'zen-london3' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'zen-london9a' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'zen-losangeles3' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'zen-mumbai1ga' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'zen-mumbai9' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'zen-singapore9b' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'zen-tokyo1g' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'zhangjiakou1gb-cmcc' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'zhengzhou6bd-cucc' OR CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) >= 'zhenjiang1g-3line' AND CAST(""自定义 SQL 查询"".""idc"" AS VARCHAR) <= 'zhuzhou1g-ctel') AND CAST(""自定义 SQL 查询"".""srcRegion"" AS VARCHAR) >= 'Anhui' AND CAST(""自定义 SQL 查询"".""srcRegion"" AS VARCHAR) <= 'Zhejiang'
GROUP BY 1,
  2"
"SELECT ""自定义 SQL 查询"".""srcisp"" AS ""srcisp""
FROM (SELECT date AS ""date"",
      src_domain AS ""srcDomain"",
      src_country AS ""srcCountry"",
      dest_idc AS ""idc"",
      speaker_ip_isp AS ""srcisp"",
      speaker_vos_ip,
      delay_25 AS ""p2s_Delay25"",
      delay_50 AS ""p2s_Delay50"",
      delay_75 AS ""p2s_Delay75"",
      delay_100 AS ""p2s_Delay100"",
      delay_125 AS ""p2s_Delay125"",
      delay_150 AS ""p2s_Delay150"",
      delay_total,
      lost_ratio_5 AS ""p2s_lostRatio"",
      lostratio_total AS ""p2s_total"",
      jitter95_50 AS ""p2s_jitter95_50"",
      jitter95_100 AS ""p2s_jitter95_100"",
      jitter95_200 AS ""p2s_jitter95_200"",
      jitter95_300 AS ""p2s_jitter95_300"",
      jitter95_total,
      product_line,
      product_type
    FROM media.p2s_cover_oversea_ip
    WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-25') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-01')) AS ""自定义 SQL 查询""
GROUP BY 1
LIMIT 4096"
"select created from system.runtime.queries limit 10 order by created desc"
"SELECT SUM(""自定义 SQL 查询"".""total"") AS ""TEMP(Calculation_5203557528862519300)(2253843611)(0)"",
  SUM(""自定义 SQL 查询"".""total_last7"") AS ""TEMP(Calculation_5203557528862519300)(431428601)(0)"",
  SUM(""自定义 SQL 查询"".""audio_last7"") AS ""TEMP(Calculation_5203557528863973382)(1745737303)(0)"",
  SUM(""自定义 SQL 查询"".""audio"") AS ""TEMP(Calculation_5203557528863973382)(4234702922)(0)"",
  SUM(""自定义 SQL 查询"".""video_last7"") AS ""TEMP(Calculation_5203557528864174088)(3553322618)(0)"",
  SUM(""自定义 SQL 查询"".""video"") AS ""TEMP(Calculation_5203557528864174088)(3647352276)(0)"",
  SUM(""自定义 SQL 查询"".""audience"") AS ""TEMP(Calculation_534802460955955203)(1306364424)(0)"",
  SUM(""自定义 SQL 查询"".""audience_last7"") AS ""TEMP(Calculation_534802460955955203)(2563414513)(0)"",
  SUM(""自定义 SQL 查询"".""audience_audio_last7"") AS ""TEMP(Calculation_534802460956184581)(1783975840)(0)"",
  SUM(""自定义 SQL 查询"".""audience_audio"") AS ""TEMP(Calculation_534802460956184581)(1868547182)(0)"",
  SUM(""自定义 SQL 查询"".""audience_video_last7"") AS ""TEMP(Calculation_534802460956430343)(1897793420)(0)"",
  SUM(""自定义 SQL 查询"".""audience_video"") AS ""TEMP(Calculation_534802460956430343)(2182583436)(0)"",
  SUM(""自定义 SQL 查询"".""audience_audio_low_latency_last7"") AS ""TEMP(audience_audio_last7_rate (复制)_230316907704053763)(29"",
  SUM(""自定义 SQL 查询"".""audience_audio_low_latency"") AS ""TEMP(audience_audio_last7_rate (复制)_230316907704053763)(83"",
  SUM(""自定义 SQL 查询"".""host_audio_last7"") AS ""TEMP(audience_audio_last7_rate (复制)_534802460956631050)(15"",
  SUM(""自定义 SQL 查询"".""host_audio"") AS ""TEMP(audience_audio_last7_rate (复制)_534802460956631050)(36"",
  SUM(""自定义 SQL 查询"".""host_last7"") AS ""TEMP(audience_last7_date (复制)_534802460957310992)(24217528"",
  SUM(""自定义 SQL 查询"".""host"") AS ""TEMP(audience_last7_date (复制)_534802460957310992)(24867219"",
  SUM(""自定义 SQL 查询"".""audience_low_latency"") AS ""TEMP(audience_low_latency_last1_rate (复制)_2303169077032468"",
  SUM(""自定义 SQL 查询"".""audience_low_latency_last7"") AS ""TEMP(audience_low_latency_last1_rate (复制)_2303169077032461"",
  SUM(""自定义 SQL 查询"".""audience_video_low_latency"") AS ""TEMP(audience_low_latency_last7_rate (复制)_2303169077218181"",
  SUM(""自定义 SQL 查询"".""audience_video_low_latency_last7"") AS ""TEMP(audience_low_latency_last7_rate (复制)_2303169077218182"",
  SUM(""自定义 SQL 查询"".""host_video_last7"") AS ""TEMP(audience_video_last7_rate (复制)_534802460956704782)(21"",
  SUM(""自定义 SQL 查询"".""host_video"") AS ""TEMP(audience_video_last7_rate (复制)_534802460956704782)(26""
FROM (SELECT date,
      SUBSTR(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) AS date_range_1,
      SUBSTR(CAST(end_date AS VARCHAR), 1, 10) AS date_range_2,
      stat_period,
        CASE WHEN CAST(stat_period AS VARCHAR) = 'day' THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,
      area,
      vid,
      project,
      company_id AS cid,
      company_name AS company,
      customer_level AS level,
      vid_internal_industry_en AS industry,
      vid_use_case_cn,
      csdc_owner,
      os,
      ver,
      ver_type,
      product_level1,
      product_level2,
      product_level3,
      total,
      audio,
      video,
      video_sd,
      video_hd,
      video_hdp,
        host_audio + host_video AS host,
      host_audio,
      host_video,
      host_sd,
      host_hd,
      host_hdp,
        audience_audio + audience_video AS audience,
        audience_audio_low_latency + audience_video_low_latency AS audience_low_latency,
      audience_audio,
      audience_audio_low_latency,
      audience_video,
      audience_video_low_latency,
      audience_sd,
      audience_sd_low_latency,
      audience_hd,
      audience_hd_low_latency,
      audience_hdp,
      audience_hdp_low_latency,
      total_last1,
      audio_last1,
      video_last1,
      video_sd_last1,
      video_hd_last1,
      video_hdp_last1,
        host_audio_last1 + host_video_last1 AS host_last1,
      host_audio_last1,
      host_video_last1,
        audience_audio_last1 + audience_video_last1 AS audience_last1,
        audience_audio_low_latency_last1 + audience_video_low_latency_last1 AS audience_low_latency_last1,
      audience_audio_last1,
      audience_audio_low_latency_last1,
      audience_video_last1,
      audience_video_low_latency_last1,
      total_last7,
      audio_last7,
      video_last7,
      video_sd_last7,
      video_hd_last7,
      video_hdp_last7,
        host_audio_last7 + host_video_last7 AS host_last7,
      host_audio_last7,
      host_video_last7,
        audience_audio_last7 + audience_video_last7 AS audience_last7,
        audience_audio_low_latency_last7 + audience_video_low_latency_last7 AS audience_low_latency_last7,
      audience_audio_last7,
      audience_audio_low_latency_last7,
      audience_video_last7,
      audience_video_low_latency_last7
    FROM report_datahub.vendor_vid_usage_di_1
    WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-06') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-06') AND CAST(vid AS VARCHAR) = CAST(311291 AS VARCHAR) AND dim = 1) AS ""自定义 SQL 查询""
  CROSS JOIN (SELECT MAX(date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d')) AS ""__measure__0""
    FROM (SELECT date,
          SUBSTR(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) AS date_range_1,
          SUBSTR(CAST(end_date AS VARCHAR), 1, 10) AS date_range_2,
          stat_period,
            CASE WHEN CAST(stat_period AS VARCHAR) = 'day' THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,
          area,
          vid,
          project,
          company_id AS cid,
          company_name AS company,
          customer_level AS level,
          vid_internal_industry_en AS industry,
          vid_use_case_cn,
          csdc_owner,
          os,
          ver,
          ver_type,
          product_level1,
          product_level2,
          product_level3,
          total,
          audio,
          video,
          video_sd,
          video_hd,
          video_hdp,
            host_audio + host_video AS host,
          host_audio,
          host_video,
          host_sd,
          host_hd,
          host_hdp,
            audience_audio + audience_video AS audience,
            audience_audio_low_latency + audience_video_low_latency AS audience_low_latency,
          audience_audio,
          audience_audio_low_latency,
          audience_video,
          audience_video_low_latency,
          audience_sd,
          audience_sd_low_latency,
          audience_hd,
          audience_hd_low_latency,
          audience_hdp,
          audience_hdp_low_latency,
          total_last1,
          audio_last1,
          video_last1,
          video_sd_last1,
          video_hd_last1,
          video_hdp_last1,
            host_audio_last1 + host_video_last1 AS host_last1,
          host_audio_last1,
          host_video_last1,
            audience_audio_last1 + audience_video_last1 AS audience_last1,
            audience_audio_low_latency_last1 + audience_video_low_latency_last1 AS audience_low_latency_last1,
          audience_audio_last1,
          audience_audio_low_latency_last1,
          audience_video_last1,
          audience_video_low_latency_last1,
          total_last7,
          audio_last7,
          video_last7,
          video_sd_last7,
          video_hd_last7,
          video_hdp_last7,
            host_audio_last7 + host_video_last7 AS host_last7,
          host_audio_last7,
          host_video_last7,
            audience_audio_last7 + audience_video_last7 AS audience_last7,
            audience_audio_low_latency_last7 + audience_video_low_latency_last7 AS audience_low_latency_last7,
          audience_audio_last7,
          audience_audio_low_latency_last7,
          audience_video_last7,
          audience_video_low_latency_last7
        FROM report_datahub.vendor_vid_usage_di_1
        WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') >= DATE('2021-11-06') AND date_parse(cast( date as VARCHAR), '%Y%m%d') <= DATE('2021-12-06') AND CAST(vid AS VARCHAR) = CAST(311291 AS VARCHAR) AND dim = 1) AS ""自定义 SQL 查询""
    HAVING COUNT(1) > 0) AS ""t0""
WHERE date_parse(cast( ""自定义 SQL 查询"".""date"" as VARCHAR), '%Y%m%d') = ""t0"".""__measure__0""
HAVING COUNT(1) > 0"
"show tables"
