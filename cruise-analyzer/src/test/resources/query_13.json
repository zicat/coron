[
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700079370244)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700079370244)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700079370244)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700079370244)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700079370244)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700079370244)(943764407)(0)\",\n  \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"sum_totalUsage_ok\",\n  DATE_ADD('SECOND', 0, date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"tdy_date_ok\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211201 AND date <= 20211208 AND dim = 1) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n          tag,\n          area AS Scope,\n          dim,\n          level1,\n          level2,\n          level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n            CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n          total AS totalUsage,\n          audio,\n          video,\n          host_audio,\n          audience_audio,\n          host_sd,\n          host_hd,\n          host_hdp,\n          host_1080p,\n          host_2k,\n          host_4k,\n          audience_sd,\n          audience_hd,\n          audience_hdp,\n          audience_1080p,\n          audience_2k,\n          audience_4k,\n          audience_audio_low_latency,\n          audience_sd_low_latency,\n          audience_hd_low_latency,\n          audience_hdp_low_latency,\n          audience_1080p_low_latency,\n          audience_2k_low_latency,\n          audience_4k_low_latency,\n          audience_audio_ultra_low_latency,\n          audience_sd_ultra_low_latency,\n          audience_hd_ultra_low_latency,\n          audience_hdp_ultra_low_latency,\n          audience_1080p_ultra_low_latency,\n          audience_2k_ultra_low_latency,\n          audience_4k_ultra_low_latency,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n          audience_video_low_latency_last1 AS audience_video_low_latency_last,\n          audience_total_low_latency_last1 AS audience_total_low_latency_last,\n          audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n          audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n          audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n          audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n          audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n          audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n          audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n          audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n          audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n          audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n          audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n          audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n          audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n          audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n          audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n          audience_2k_last1 AS audience_2k_last,\n          audience_4k_last1 AS audience_4k_last,\n          audience_1080p_last1 AS audience_1080p_last,\n          host_1080p_last1 AS host_1080p_last,\n          host_2k_last1 AS host_2k_last,\n          host_4k_last1 AS host_4k_last,\n          total_last7,\n          audio_last7,\n          video_last7,\n          video_sd_last7,\n          video_hd_last7,\n          video_hdp_last7,\n          host_sd_last7,\n          audience_sd_last7,\n          host_hd_last7,\n          audience_hd_last7,\n          host_hdp_last7,\n          audience_hdp_last7,\n          host_audio_last7,\n          audience_audio_last7,\n          host_video_last7,\n          audience_video_last7,\n          audience_audio_low_latency_last7,\n          audience_video_low_latency_last7,\n          audience_total_low_latency_last7,\n          audience_sd_low_latency_last7,\n          audience_hd_low_latency_last7,\n          audience_hdp_low_latency_last7,\n          audience_1080p_low_latency_last7,\n          audience_2k_low_latency_last7,\n          audience_4k_low_latency_last7,\n          audience_audio_ultra_low_latency_last7,\n          audience_video_ultra_low_latency_last7,\n          audience_total_ultra_low_latency_last7,\n          audience_sd_ultra_low_latency_last7,\n          audience_hd_ultra_low_latency_last7,\n          audience_hdp_ultra_low_latency_last7,\n          audience_1080p_ultra_low_latency_last7,\n          audience_2k_ultra_low_latency_last7,\n          audience_4k_ultra_low_latency_last7,\n          audience_2k_last7,\n          audience_4k_last7,\n          audience_1080p_last7,\n          host_1080p_last7,\n          host_2k_last7,\n          host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211201 AND date <= 20211208 AND dim = 1) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND \"自定义 SQL 查询\".\"rank_level1\" = 3 AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 18,\n  20"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k_last\") AS \"TEMP(Calculation_3519281700083154949)(101123376)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700083154949)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700083154949)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_hdp_last\") AS \"TEMP(Calculation_3519281700083154949)(1200517625)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700083154949)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p_last\") AS \"TEMP(Calculation_3519281700083154949)(1314346200)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_hd_last\") AS \"TEMP(Calculation_3519281700083154949)(146570423)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k_last\") AS \"TEMP(Calculation_3519281700083154949)(1717771635)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio_last\") AS \"TEMP(Calculation_3519281700083154949)(2313111073)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_hdp_last\") AS \"TEMP(Calculation_3519281700083154949)(258310559)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700083154949)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_video_last\") AS \"TEMP(Calculation_3519281700083154949)(2820618408)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700083154949)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700083154949)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700083154949)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700083154949)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700083154949)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k_last\") AS \"TEMP(Calculation_3519281700083154949)(3121859593)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p_last\") AS \"TEMP(Calculation_3519281700083154949)(3222422303)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio_last\") AS \"TEMP(Calculation_3519281700083154949)(3227677803)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700083154949)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700083154949)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700083154949)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video_last\") AS \"TEMP(Calculation_3519281700083154949)(3934387163)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k_last\") AS \"TEMP(Calculation_3519281700083154949)(4055292783)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_last\") AS \"TEMP(Calculation_3519281700083154949)(4091190060)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700083154949)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_hd_last\") AS \"TEMP(Calculation_3519281700083154949)(4170367250)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_sd_last\") AS \"TEMP(Calculation_3519281700083154949)(4190307025)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700083154949)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700083154949)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700083154949)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_sd_last\") AS \"TEMP(Calculation_3519281700083154949)(933007102)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700083154949)(943764407)(0)\",\n  AVG(\"自定义 SQL 查询\".\"totalUsage\") AS \"avg_totalUsage_ok\",\n  \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"sum_totalUsage_ok\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211201 AND date <= 20211208 AND dim = 1) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n          tag,\n          area AS Scope,\n          dim,\n          level1,\n          level2,\n          level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n            CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n          total AS totalUsage,\n          audio,\n          video,\n          host_audio,\n          audience_audio,\n          host_sd,\n          host_hd,\n          host_hdp,\n          host_1080p,\n          host_2k,\n          host_4k,\n          audience_sd,\n          audience_hd,\n          audience_hdp,\n          audience_1080p,\n          audience_2k,\n          audience_4k,\n          audience_audio_low_latency,\n          audience_sd_low_latency,\n          audience_hd_low_latency,\n          audience_hdp_low_latency,\n          audience_1080p_low_latency,\n          audience_2k_low_latency,\n          audience_4k_low_latency,\n          audience_audio_ultra_low_latency,\n          audience_sd_ultra_low_latency,\n          audience_hd_ultra_low_latency,\n          audience_hdp_ultra_low_latency,\n          audience_1080p_ultra_low_latency,\n          audience_2k_ultra_low_latency,\n          audience_4k_ultra_low_latency,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n          audience_video_low_latency_last1 AS audience_video_low_latency_last,\n          audience_total_low_latency_last1 AS audience_total_low_latency_last,\n          audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n          audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n          audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n          audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n          audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n          audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n          audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n          audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n          audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n          audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n          audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n          audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n          audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n          audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n          audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n          audience_2k_last1 AS audience_2k_last,\n          audience_4k_last1 AS audience_4k_last,\n          audience_1080p_last1 AS audience_1080p_last,\n          host_1080p_last1 AS host_1080p_last,\n          host_2k_last1 AS host_2k_last,\n          host_4k_last1 AS host_4k_last,\n          total_last7,\n          audio_last7,\n          video_last7,\n          video_sd_last7,\n          video_hd_last7,\n          video_hdp_last7,\n          host_sd_last7,\n          audience_sd_last7,\n          host_hd_last7,\n          audience_hd_last7,\n          host_hdp_last7,\n          audience_hdp_last7,\n          host_audio_last7,\n          audience_audio_last7,\n          host_video_last7,\n          audience_video_last7,\n          audience_audio_low_latency_last7,\n          audience_video_low_latency_last7,\n          audience_total_low_latency_last7,\n          audience_sd_low_latency_last7,\n          audience_hd_low_latency_last7,\n          audience_hdp_low_latency_last7,\n          audience_1080p_low_latency_last7,\n          audience_2k_low_latency_last7,\n          audience_4k_low_latency_last7,\n          audience_audio_ultra_low_latency_last7,\n          audience_video_ultra_low_latency_last7,\n          audience_total_ultra_low_latency_last7,\n          audience_sd_ultra_low_latency_last7,\n          audience_hd_ultra_low_latency_last7,\n          audience_hdp_ultra_low_latency_last7,\n          audience_1080p_ultra_low_latency_last7,\n          audience_2k_ultra_low_latency_last7,\n          audience_4k_ultra_low_latency_last7,\n          audience_2k_last7,\n          audience_4k_last7,\n          audience_1080p_last7,\n          host_1080p_last7,\n          host_2k_last7,\n          host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211201 AND date <= 20211208 AND dim = 1) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND \"自定义 SQL 查询\".\"rank_level1\" = 3 AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 36"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700341563406)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio_last7\") AS \"TEMP(Calculation_3519281700341563406)(1077563395)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700341563406)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700341563406)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd_last7\") AS \"TEMP(Calculation_3519281700341563406)(1456465729)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd_last7\") AS \"TEMP(Calculation_3519281700341563406)(1635749653)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd_last7\") AS \"TEMP(Calculation_3519281700341563406)(1747046964)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k_last7\") AS \"TEMP(Calculation_3519281700341563406)(1747524570)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp_last7\") AS \"TEMP(Calculation_3519281700341563406)(2044136109)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio_last7\") AS \"TEMP(Calculation_3519281700341563406)(2464388580)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_last7\") AS \"TEMP(Calculation_3519281700341563406)(2589233512)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700341563406)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k_last7\") AS \"TEMP(Calculation_3519281700341563406)(280796653)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700341563406)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700341563406)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700341563406)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700341563406)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700341563406)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_4k_last7\") AS \"TEMP(Calculation_3519281700341563406)(3127348545)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700341563406)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"total_last7\") AS \"TEMP(Calculation_3519281700341563406)(346677966)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k_last7\") AS \"TEMP(Calculation_3519281700341563406)(3543669678)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p_last7\") AS \"TEMP(Calculation_3519281700341563406)(3624983014)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700341563406)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700341563406)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd_last7\") AS \"TEMP(Calculation_3519281700341563406)(3905372418)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video_last7\") AS \"TEMP(Calculation_3519281700341563406)(4107040267)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700341563406)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700341563406)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p_last7\") AS \"TEMP(Calculation_3519281700341563406)(632977665)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700341563406)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp_last7\") AS \"TEMP(Calculation_3519281700341563406)(750340200)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700341563406)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700341563406)(943764407)(0)\",\n  \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"audio_video_last\") AS \"sum_audio_video_last_ok\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211201 AND date <= 20211208 AND dim = 1) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n          tag,\n          area AS Scope,\n          dim,\n          level1,\n          level2,\n          level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n            CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n          total AS totalUsage,\n          audio,\n          video,\n          host_audio,\n          audience_audio,\n          host_sd,\n          host_hd,\n          host_hdp,\n          host_1080p,\n          host_2k,\n          host_4k,\n          audience_sd,\n          audience_hd,\n          audience_hdp,\n          audience_1080p,\n          audience_2k,\n          audience_4k,\n          audience_audio_low_latency,\n          audience_sd_low_latency,\n          audience_hd_low_latency,\n          audience_hdp_low_latency,\n          audience_1080p_low_latency,\n          audience_2k_low_latency,\n          audience_4k_low_latency,\n          audience_audio_ultra_low_latency,\n          audience_sd_ultra_low_latency,\n          audience_hd_ultra_low_latency,\n          audience_hdp_ultra_low_latency,\n          audience_1080p_ultra_low_latency,\n          audience_2k_ultra_low_latency,\n          audience_4k_ultra_low_latency,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n          audience_video_low_latency_last1 AS audience_video_low_latency_last,\n          audience_total_low_latency_last1 AS audience_total_low_latency_last,\n          audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n          audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n          audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n          audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n          audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n          audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n          audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n          audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n          audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n          audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n          audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n          audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n          audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n          audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n          audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n          audience_2k_last1 AS audience_2k_last,\n          audience_4k_last1 AS audience_4k_last,\n          audience_1080p_last1 AS audience_1080p_last,\n          host_1080p_last1 AS host_1080p_last,\n          host_2k_last1 AS host_2k_last,\n          host_4k_last1 AS host_4k_last,\n          total_last7,\n          audio_last7,\n          video_last7,\n          video_sd_last7,\n          video_hd_last7,\n          video_hdp_last7,\n          host_sd_last7,\n          audience_sd_last7,\n          host_hd_last7,\n          audience_hd_last7,\n          host_hdp_last7,\n          audience_hdp_last7,\n          host_audio_last7,\n          audience_audio_last7,\n          host_video_last7,\n          audience_video_last7,\n          audience_audio_low_latency_last7,\n          audience_video_low_latency_last7,\n          audience_total_low_latency_last7,\n          audience_sd_low_latency_last7,\n          audience_hd_low_latency_last7,\n          audience_hdp_low_latency_last7,\n          audience_1080p_low_latency_last7,\n          audience_2k_low_latency_last7,\n          audience_4k_low_latency_last7,\n          audience_audio_ultra_low_latency_last7,\n          audience_video_ultra_low_latency_last7,\n          audience_total_ultra_low_latency_last7,\n          audience_sd_ultra_low_latency_last7,\n          audience_hd_ultra_low_latency_last7,\n          audience_hdp_ultra_low_latency_last7,\n          audience_1080p_ultra_low_latency_last7,\n          audience_2k_ultra_low_latency_last7,\n          audience_4k_ultra_low_latency_last7,\n          audience_2k_last7,\n          audience_4k_last7,\n          audience_1080p_last7,\n          host_1080p_last7,\n          host_2k_last7,\n          host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211201 AND date <= 20211208 AND dim = 1) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND \"自定义 SQL 查询\".\"rank_level1\" = 1 AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 35"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700341563406)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio_last7\") AS \"TEMP(Calculation_3519281700341563406)(1077563395)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700341563406)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700341563406)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd_last7\") AS \"TEMP(Calculation_3519281700341563406)(1456465729)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd_last7\") AS \"TEMP(Calculation_3519281700341563406)(1635749653)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd_last7\") AS \"TEMP(Calculation_3519281700341563406)(1747046964)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k_last7\") AS \"TEMP(Calculation_3519281700341563406)(1747524570)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp_last7\") AS \"TEMP(Calculation_3519281700341563406)(2044136109)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio_last7\") AS \"TEMP(Calculation_3519281700341563406)(2464388580)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_last7\") AS \"TEMP(Calculation_3519281700341563406)(2589233512)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700341563406)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k_last7\") AS \"TEMP(Calculation_3519281700341563406)(280796653)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700341563406)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700341563406)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700341563406)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700341563406)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700341563406)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_4k_last7\") AS \"TEMP(Calculation_3519281700341563406)(3127348545)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700341563406)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"total_last7\") AS \"TEMP(Calculation_3519281700341563406)(346677966)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k_last7\") AS \"TEMP(Calculation_3519281700341563406)(3543669678)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p_last7\") AS \"TEMP(Calculation_3519281700341563406)(3624983014)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700341563406)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700341563406)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd_last7\") AS \"TEMP(Calculation_3519281700341563406)(3905372418)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video_last7\") AS \"TEMP(Calculation_3519281700341563406)(4107040267)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700341563406)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700341563406)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p_last7\") AS \"TEMP(Calculation_3519281700341563406)(632977665)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700341563406)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp_last7\") AS \"TEMP(Calculation_3519281700341563406)(750340200)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700341563406)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700341563406)(943764407)(0)\",\n  \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"audio_video_last\") AS \"sum_audio_video_last_ok\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211201 AND date <= 20211208 AND dim = 1) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n          tag,\n          area AS Scope,\n          dim,\n          level1,\n          level2,\n          level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n            CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n          total AS totalUsage,\n          audio,\n          video,\n          host_audio,\n          audience_audio,\n          host_sd,\n          host_hd,\n          host_hdp,\n          host_1080p,\n          host_2k,\n          host_4k,\n          audience_sd,\n          audience_hd,\n          audience_hdp,\n          audience_1080p,\n          audience_2k,\n          audience_4k,\n          audience_audio_low_latency,\n          audience_sd_low_latency,\n          audience_hd_low_latency,\n          audience_hdp_low_latency,\n          audience_1080p_low_latency,\n          audience_2k_low_latency,\n          audience_4k_low_latency,\n          audience_audio_ultra_low_latency,\n          audience_sd_ultra_low_latency,\n          audience_hd_ultra_low_latency,\n          audience_hdp_ultra_low_latency,\n          audience_1080p_ultra_low_latency,\n          audience_2k_ultra_low_latency,\n          audience_4k_ultra_low_latency,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n          audience_video_low_latency_last1 AS audience_video_low_latency_last,\n          audience_total_low_latency_last1 AS audience_total_low_latency_last,\n          audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n          audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n          audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n          audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n          audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n          audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n          audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n          audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n          audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n          audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n          audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n          audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n          audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n          audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n          audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n          audience_2k_last1 AS audience_2k_last,\n          audience_4k_last1 AS audience_4k_last,\n          audience_1080p_last1 AS audience_1080p_last,\n          host_1080p_last1 AS host_1080p_last,\n          host_2k_last1 AS host_2k_last,\n          host_4k_last1 AS host_4k_last,\n          total_last7,\n          audio_last7,\n          video_last7,\n          video_sd_last7,\n          video_hd_last7,\n          video_hdp_last7,\n          host_sd_last7,\n          audience_sd_last7,\n          host_hd_last7,\n          audience_hd_last7,\n          host_hdp_last7,\n          audience_hdp_last7,\n          host_audio_last7,\n          audience_audio_last7,\n          host_video_last7,\n          audience_video_last7,\n          audience_audio_low_latency_last7,\n          audience_video_low_latency_last7,\n          audience_total_low_latency_last7,\n          audience_sd_low_latency_last7,\n          audience_hd_low_latency_last7,\n          audience_hdp_low_latency_last7,\n          audience_1080p_low_latency_last7,\n          audience_2k_low_latency_last7,\n          audience_4k_low_latency_last7,\n          audience_audio_ultra_low_latency_last7,\n          audience_video_ultra_low_latency_last7,\n          audience_total_ultra_low_latency_last7,\n          audience_sd_ultra_low_latency_last7,\n          audience_hd_ultra_low_latency_last7,\n          audience_hdp_ultra_low_latency_last7,\n          audience_1080p_ultra_low_latency_last7,\n          audience_2k_ultra_low_latency_last7,\n          audience_4k_ultra_low_latency_last7,\n          audience_2k_last7,\n          audience_4k_last7,\n          audience_1080p_last7,\n          host_1080p_last7,\n          host_2k_last7,\n          host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211201 AND date <= 20211208 AND dim = 1) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND \"自定义 SQL 查询\".\"rank_level1\" = 3 AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 35"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700341563406)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio_last7\") AS \"TEMP(Calculation_3519281700341563406)(1077563395)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700341563406)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700341563406)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd_last7\") AS \"TEMP(Calculation_3519281700341563406)(1456465729)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd_last7\") AS \"TEMP(Calculation_3519281700341563406)(1635749653)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd_last7\") AS \"TEMP(Calculation_3519281700341563406)(1747046964)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k_last7\") AS \"TEMP(Calculation_3519281700341563406)(1747524570)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp_last7\") AS \"TEMP(Calculation_3519281700341563406)(2044136109)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio_last7\") AS \"TEMP(Calculation_3519281700341563406)(2464388580)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_last7\") AS \"TEMP(Calculation_3519281700341563406)(2589233512)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700341563406)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k_last7\") AS \"TEMP(Calculation_3519281700341563406)(280796653)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700341563406)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700341563406)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700341563406)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700341563406)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700341563406)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_4k_last7\") AS \"TEMP(Calculation_3519281700341563406)(3127348545)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700341563406)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"total_last7\") AS \"TEMP(Calculation_3519281700341563406)(346677966)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k_last7\") AS \"TEMP(Calculation_3519281700341563406)(3543669678)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p_last7\") AS \"TEMP(Calculation_3519281700341563406)(3624983014)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700341563406)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700341563406)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd_last7\") AS \"TEMP(Calculation_3519281700341563406)(3905372418)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video_last7\") AS \"TEMP(Calculation_3519281700341563406)(4107040267)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700341563406)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700341563406)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p_last7\") AS \"TEMP(Calculation_3519281700341563406)(632977665)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700341563406)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp_last7\") AS \"TEMP(Calculation_3519281700341563406)(750340200)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700341563406)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700341563406)(943764407)(0)\",\n  \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"audio_video_last\") AS \"sum_audio_video_last_ok\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211201 AND date <= 20211208 AND dim = 1) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n          tag,\n          area AS Scope,\n          dim,\n          level1,\n          level2,\n          level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n            CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n          total AS totalUsage,\n          audio,\n          video,\n          host_audio,\n          audience_audio,\n          host_sd,\n          host_hd,\n          host_hdp,\n          host_1080p,\n          host_2k,\n          host_4k,\n          audience_sd,\n          audience_hd,\n          audience_hdp,\n          audience_1080p,\n          audience_2k,\n          audience_4k,\n          audience_audio_low_latency,\n          audience_sd_low_latency,\n          audience_hd_low_latency,\n          audience_hdp_low_latency,\n          audience_1080p_low_latency,\n          audience_2k_low_latency,\n          audience_4k_low_latency,\n          audience_audio_ultra_low_latency,\n          audience_sd_ultra_low_latency,\n          audience_hd_ultra_low_latency,\n          audience_hdp_ultra_low_latency,\n          audience_1080p_ultra_low_latency,\n          audience_2k_ultra_low_latency,\n          audience_4k_ultra_low_latency,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n          audience_video_low_latency_last1 AS audience_video_low_latency_last,\n          audience_total_low_latency_last1 AS audience_total_low_latency_last,\n          audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n          audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n          audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n          audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n          audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n          audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n          audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n          audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n          audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n          audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n          audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n          audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n          audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n          audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n          audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n          audience_2k_last1 AS audience_2k_last,\n          audience_4k_last1 AS audience_4k_last,\n          audience_1080p_last1 AS audience_1080p_last,\n          host_1080p_last1 AS host_1080p_last,\n          host_2k_last1 AS host_2k_last,\n          host_4k_last1 AS host_4k_last,\n          total_last7,\n          audio_last7,\n          video_last7,\n          video_sd_last7,\n          video_hd_last7,\n          video_hdp_last7,\n          host_sd_last7,\n          audience_sd_last7,\n          host_hd_last7,\n          audience_hd_last7,\n          host_hdp_last7,\n          audience_hdp_last7,\n          host_audio_last7,\n          audience_audio_last7,\n          host_video_last7,\n          audience_video_last7,\n          audience_audio_low_latency_last7,\n          audience_video_low_latency_last7,\n          audience_total_low_latency_last7,\n          audience_sd_low_latency_last7,\n          audience_hd_low_latency_last7,\n          audience_hdp_low_latency_last7,\n          audience_1080p_low_latency_last7,\n          audience_2k_low_latency_last7,\n          audience_4k_low_latency_last7,\n          audience_audio_ultra_low_latency_last7,\n          audience_video_ultra_low_latency_last7,\n          audience_total_ultra_low_latency_last7,\n          audience_sd_ultra_low_latency_last7,\n          audience_hd_ultra_low_latency_last7,\n          audience_hdp_ultra_low_latency_last7,\n          audience_1080p_ultra_low_latency_last7,\n          audience_2k_ultra_low_latency_last7,\n          audience_4k_ultra_low_latency_last7,\n          audience_2k_last7,\n          audience_4k_last7,\n          audience_1080p_last7,\n          host_1080p_last7,\n          host_2k_last7,\n          host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211201 AND date <= 20211208 AND dim = 1) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND \"自定义 SQL 查询\".\"rank_level1\" = 2 AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 35"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700079370244)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700079370244)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700079370244)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700079370244)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700079370244)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700079370244)(943764407)(0)\",\n  \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"sum_totalUsage_ok\",\n  DATE_ADD('SECOND', 0, date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"tdy_date_ok\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211201 AND date <= 20211208 AND dim = 1) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n          tag,\n          area AS Scope,\n          dim,\n          level1,\n          level2,\n          level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n            CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n          total AS totalUsage,\n          audio,\n          video,\n          host_audio,\n          audience_audio,\n          host_sd,\n          host_hd,\n          host_hdp,\n          host_1080p,\n          host_2k,\n          host_4k,\n          audience_sd,\n          audience_hd,\n          audience_hdp,\n          audience_1080p,\n          audience_2k,\n          audience_4k,\n          audience_audio_low_latency,\n          audience_sd_low_latency,\n          audience_hd_low_latency,\n          audience_hdp_low_latency,\n          audience_1080p_low_latency,\n          audience_2k_low_latency,\n          audience_4k_low_latency,\n          audience_audio_ultra_low_latency,\n          audience_sd_ultra_low_latency,\n          audience_hd_ultra_low_latency,\n          audience_hdp_ultra_low_latency,\n          audience_1080p_ultra_low_latency,\n          audience_2k_ultra_low_latency,\n          audience_4k_ultra_low_latency,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n          audience_video_low_latency_last1 AS audience_video_low_latency_last,\n          audience_total_low_latency_last1 AS audience_total_low_latency_last,\n          audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n          audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n          audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n          audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n          audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n          audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n          audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n          audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n          audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n          audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n          audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n          audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n          audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n          audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n          audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n          audience_2k_last1 AS audience_2k_last,\n          audience_4k_last1 AS audience_4k_last,\n          audience_1080p_last1 AS audience_1080p_last,\n          host_1080p_last1 AS host_1080p_last,\n          host_2k_last1 AS host_2k_last,\n          host_4k_last1 AS host_4k_last,\n          total_last7,\n          audio_last7,\n          video_last7,\n          video_sd_last7,\n          video_hd_last7,\n          video_hdp_last7,\n          host_sd_last7,\n          audience_sd_last7,\n          host_hd_last7,\n          audience_hd_last7,\n          host_hdp_last7,\n          audience_hdp_last7,\n          host_audio_last7,\n          audience_audio_last7,\n          host_video_last7,\n          audience_video_last7,\n          audience_audio_low_latency_last7,\n          audience_video_low_latency_last7,\n          audience_total_low_latency_last7,\n          audience_sd_low_latency_last7,\n          audience_hd_low_latency_last7,\n          audience_hdp_low_latency_last7,\n          audience_1080p_low_latency_last7,\n          audience_2k_low_latency_last7,\n          audience_4k_low_latency_last7,\n          audience_audio_ultra_low_latency_last7,\n          audience_video_ultra_low_latency_last7,\n          audience_total_ultra_low_latency_last7,\n          audience_sd_ultra_low_latency_last7,\n          audience_hd_ultra_low_latency_last7,\n          audience_hdp_ultra_low_latency_last7,\n          audience_1080p_ultra_low_latency_last7,\n          audience_2k_ultra_low_latency_last7,\n          audience_4k_ultra_low_latency_last7,\n          audience_2k_last7,\n          audience_4k_last7,\n          audience_1080p_last7,\n          host_1080p_last7,\n          host_2k_last7,\n          host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211201 AND date <= 20211208 AND dim = 1) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND \"自定义 SQL 查询\".\"rank_level1\" = 4 AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 18,\n  20"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700079370244)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700079370244)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700079370244)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700079370244)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700079370244)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700079370244)(943764407)(0)\",\n  MIN(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(1482809429)(0)\",\n  MAX(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(3765460736)(0)\",\n  MAX(\"自定义 SQL 查询\".\"level2\") AS \"TEMP(attr_level2_nk)(3222240611)(0)\",\n  MIN(\"自定义 SQL 查询\".\"level2\") AS \"TEMP(attr_level2_nk)(3931055347)(0)\",\n  MAX(\"自定义 SQL 查询\".\"stat_date\") AS \"TEMP(attr_stat_date_nk)(2102638629)(0)\",\n  MIN(\"自定义 SQL 查询\".\"stat_date\") AS \"TEMP(attr_stat_date_nk)(2790680713)(0)\",\n  \"自定义 SQL 查询\".\"level3\" AS \"level3\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211201 AND date <= 20211208 AND dim = 1) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n          tag,\n          area AS Scope,\n          dim,\n          level1,\n          level2,\n          level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n            CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n          total AS totalUsage,\n          audio,\n          video,\n          host_audio,\n          audience_audio,\n          host_sd,\n          host_hd,\n          host_hdp,\n          host_1080p,\n          host_2k,\n          host_4k,\n          audience_sd,\n          audience_hd,\n          audience_hdp,\n          audience_1080p,\n          audience_2k,\n          audience_4k,\n          audience_audio_low_latency,\n          audience_sd_low_latency,\n          audience_hd_low_latency,\n          audience_hdp_low_latency,\n          audience_1080p_low_latency,\n          audience_2k_low_latency,\n          audience_4k_low_latency,\n          audience_audio_ultra_low_latency,\n          audience_sd_ultra_low_latency,\n          audience_hd_ultra_low_latency,\n          audience_hdp_ultra_low_latency,\n          audience_1080p_ultra_low_latency,\n          audience_2k_ultra_low_latency,\n          audience_4k_ultra_low_latency,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n          audience_video_low_latency_last1 AS audience_video_low_latency_last,\n          audience_total_low_latency_last1 AS audience_total_low_latency_last,\n          audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n          audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n          audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n          audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n          audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n          audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n          audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n          audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n          audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n          audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n          audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n          audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n          audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n          audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n          audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n          audience_2k_last1 AS audience_2k_last,\n          audience_4k_last1 AS audience_4k_last,\n          audience_1080p_last1 AS audience_1080p_last,\n          host_1080p_last1 AS host_1080p_last,\n          host_2k_last1 AS host_2k_last,\n          host_4k_last1 AS host_4k_last,\n          total_last7,\n          audio_last7,\n          video_last7,\n          video_sd_last7,\n          video_hd_last7,\n          video_hdp_last7,\n          host_sd_last7,\n          audience_sd_last7,\n          host_hd_last7,\n          audience_hd_last7,\n          host_hdp_last7,\n          audience_hdp_last7,\n          host_audio_last7,\n          audience_audio_last7,\n          host_video_last7,\n          audience_video_last7,\n          audience_audio_low_latency_last7,\n          audience_video_low_latency_last7,\n          audience_total_low_latency_last7,\n          audience_sd_low_latency_last7,\n          audience_hd_low_latency_last7,\n          audience_hdp_low_latency_last7,\n          audience_1080p_low_latency_last7,\n          audience_2k_low_latency_last7,\n          audience_4k_low_latency_last7,\n          audience_audio_ultra_low_latency_last7,\n          audience_video_ultra_low_latency_last7,\n          audience_total_ultra_low_latency_last7,\n          audience_sd_ultra_low_latency_last7,\n          audience_hd_ultra_low_latency_last7,\n          audience_hdp_ultra_low_latency_last7,\n          audience_1080p_ultra_low_latency_last7,\n          audience_2k_ultra_low_latency_last7,\n          audience_4k_ultra_low_latency_last7,\n          audience_2k_last7,\n          audience_4k_last7,\n          audience_1080p_last7,\n          host_1080p_last7,\n          host_2k_last7,\n          host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211201 AND date <= 20211208 AND dim = 1) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 24"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700079370244)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700079370244)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700079370244)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700079370244)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700079370244)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700079370244)(943764407)(0)\",\n  MAX(\"自定义 SQL 查询\".\"stat_date\") AS \"TEMP(attr_stat_date_nk)(2102638629)(0)\",\n  MIN(\"自定义 SQL 查询\".\"stat_date\") AS \"TEMP(attr_stat_date_nk)(2790680713)(0)\",\n  \"自定义 SQL 查询\".\"level4\" AS \"level4\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211201 AND date <= 20211208 AND dim = 1) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n          tag,\n          area AS Scope,\n          dim,\n          level1,\n          level2,\n          level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n            CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n          total AS totalUsage,\n          audio,\n          video,\n          host_audio,\n          audience_audio,\n          host_sd,\n          host_hd,\n          host_hdp,\n          host_1080p,\n          host_2k,\n          host_4k,\n          audience_sd,\n          audience_hd,\n          audience_hdp,\n          audience_1080p,\n          audience_2k,\n          audience_4k,\n          audience_audio_low_latency,\n          audience_sd_low_latency,\n          audience_hd_low_latency,\n          audience_hdp_low_latency,\n          audience_1080p_low_latency,\n          audience_2k_low_latency,\n          audience_4k_low_latency,\n          audience_audio_ultra_low_latency,\n          audience_sd_ultra_low_latency,\n          audience_hd_ultra_low_latency,\n          audience_hdp_ultra_low_latency,\n          audience_1080p_ultra_low_latency,\n          audience_2k_ultra_low_latency,\n          audience_4k_ultra_low_latency,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n          audience_video_low_latency_last1 AS audience_video_low_latency_last,\n          audience_total_low_latency_last1 AS audience_total_low_latency_last,\n          audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n          audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n          audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n          audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n          audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n          audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n          audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n          audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n          audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n          audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n          audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n          audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n          audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n          audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n          audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n          audience_2k_last1 AS audience_2k_last,\n          audience_4k_last1 AS audience_4k_last,\n          audience_1080p_last1 AS audience_1080p_last,\n          host_1080p_last1 AS host_1080p_last,\n          host_2k_last1 AS host_2k_last,\n          host_4k_last1 AS host_4k_last,\n          total_last7,\n          audio_last7,\n          video_last7,\n          video_sd_last7,\n          video_hd_last7,\n          video_hdp_last7,\n          host_sd_last7,\n          audience_sd_last7,\n          host_hd_last7,\n          audience_hd_last7,\n          host_hdp_last7,\n          audience_hdp_last7,\n          host_audio_last7,\n          audience_audio_last7,\n          host_video_last7,\n          audience_video_last7,\n          audience_audio_low_latency_last7,\n          audience_video_low_latency_last7,\n          audience_total_low_latency_last7,\n          audience_sd_low_latency_last7,\n          audience_hd_low_latency_last7,\n          audience_hdp_low_latency_last7,\n          audience_1080p_low_latency_last7,\n          audience_2k_low_latency_last7,\n          audience_4k_low_latency_last7,\n          audience_audio_ultra_low_latency_last7,\n          audience_video_ultra_low_latency_last7,\n          audience_total_ultra_low_latency_last7,\n          audience_sd_ultra_low_latency_last7,\n          audience_hd_ultra_low_latency_last7,\n          audience_hdp_ultra_low_latency_last7,\n          audience_1080p_ultra_low_latency_last7,\n          audience_2k_ultra_low_latency_last7,\n          audience_4k_ultra_low_latency_last7,\n          audience_2k_last7,\n          audience_4k_last7,\n          audience_1080p_last7,\n          host_1080p_last7,\n          host_2k_last7,\n          host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211201 AND date <= 20211208 AND dim = 1) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND CAST(\"自定义 SQL 查询\".\"level3\" AS VARCHAR) = 'Framework' AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 20"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700079370244)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700079370244)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700079370244)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700079370244)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700079370244)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700079370244)(943764407)(0)\",\n  MAX(\"自定义 SQL 查询\".\"rank_level1\") AS \"TEMP(attr_rank_level1_qk)(289677037)(0)\",\n  MIN(\"自定义 SQL 查询\".\"rank_level1\") AS \"TEMP(attr_rank_level1_qk)(992764851)(0)\",\n  \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"sum_totalUsage_ok\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211201 AND date <= 20211208 AND dim = 1) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n          tag,\n          area AS Scope,\n          dim,\n          level1,\n          level2,\n          level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n            CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n          total AS totalUsage,\n          audio,\n          video,\n          host_audio,\n          audience_audio,\n          host_sd,\n          host_hd,\n          host_hdp,\n          host_1080p,\n          host_2k,\n          host_4k,\n          audience_sd,\n          audience_hd,\n          audience_hdp,\n          audience_1080p,\n          audience_2k,\n          audience_4k,\n          audience_audio_low_latency,\n          audience_sd_low_latency,\n          audience_hd_low_latency,\n          audience_hdp_low_latency,\n          audience_1080p_low_latency,\n          audience_2k_low_latency,\n          audience_4k_low_latency,\n          audience_audio_ultra_low_latency,\n          audience_sd_ultra_low_latency,\n          audience_hd_ultra_low_latency,\n          audience_hdp_ultra_low_latency,\n          audience_1080p_ultra_low_latency,\n          audience_2k_ultra_low_latency,\n          audience_4k_ultra_low_latency,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n          audience_video_low_latency_last1 AS audience_video_low_latency_last,\n          audience_total_low_latency_last1 AS audience_total_low_latency_last,\n          audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n          audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n          audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n          audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n          audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n          audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n          audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n          audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n          audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n          audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n          audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n          audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n          audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n          audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n          audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n          audience_2k_last1 AS audience_2k_last,\n          audience_4k_last1 AS audience_4k_last,\n          audience_1080p_last1 AS audience_1080p_last,\n          host_1080p_last1 AS host_1080p_last,\n          host_2k_last1 AS host_2k_last,\n          host_4k_last1 AS host_4k_last,\n          total_last7,\n          audio_last7,\n          video_last7,\n          video_sd_last7,\n          video_hd_last7,\n          video_hdp_last7,\n          host_sd_last7,\n          audience_sd_last7,\n          host_hd_last7,\n          audience_hd_last7,\n          host_hdp_last7,\n          audience_hdp_last7,\n          host_audio_last7,\n          audience_audio_last7,\n          host_video_last7,\n          audience_video_last7,\n          audience_audio_low_latency_last7,\n          audience_video_low_latency_last7,\n          audience_total_low_latency_last7,\n          audience_sd_low_latency_last7,\n          audience_hd_low_latency_last7,\n          audience_hdp_low_latency_last7,\n          audience_1080p_low_latency_last7,\n          audience_2k_low_latency_last7,\n          audience_4k_low_latency_last7,\n          audience_audio_ultra_low_latency_last7,\n          audience_video_ultra_low_latency_last7,\n          audience_total_ultra_low_latency_last7,\n          audience_sd_ultra_low_latency_last7,\n          audience_hd_ultra_low_latency_last7,\n          audience_hdp_ultra_low_latency_last7,\n          audience_1080p_ultra_low_latency_last7,\n          audience_2k_ultra_low_latency_last7,\n          audience_4k_ultra_low_latency_last7,\n          audience_2k_last7,\n          audience_4k_last7,\n          audience_1080p_last7,\n          host_1080p_last7,\n          host_2k_last7,\n          host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211201 AND date <= 20211208 AND dim = 1) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 20"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k_last\") AS \"TEMP(Calculation_3519281700083154949)(101123376)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700083154949)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700083154949)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_hdp_last\") AS \"TEMP(Calculation_3519281700083154949)(1200517625)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700083154949)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p_last\") AS \"TEMP(Calculation_3519281700083154949)(1314346200)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_hd_last\") AS \"TEMP(Calculation_3519281700083154949)(146570423)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k_last\") AS \"TEMP(Calculation_3519281700083154949)(1717771635)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio_last\") AS \"TEMP(Calculation_3519281700083154949)(2313111073)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_hdp_last\") AS \"TEMP(Calculation_3519281700083154949)(258310559)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700083154949)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_video_last\") AS \"TEMP(Calculation_3519281700083154949)(2820618408)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700083154949)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700083154949)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700083154949)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700083154949)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700083154949)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k_last\") AS \"TEMP(Calculation_3519281700083154949)(3121859593)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p_last\") AS \"TEMP(Calculation_3519281700083154949)(3222422303)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio_last\") AS \"TEMP(Calculation_3519281700083154949)(3227677803)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700083154949)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700083154949)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700083154949)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video_last\") AS \"TEMP(Calculation_3519281700083154949)(3934387163)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k_last\") AS \"TEMP(Calculation_3519281700083154949)(4055292783)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_last\") AS \"TEMP(Calculation_3519281700083154949)(4091190060)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700083154949)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_hd_last\") AS \"TEMP(Calculation_3519281700083154949)(4170367250)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_sd_last\") AS \"TEMP(Calculation_3519281700083154949)(4190307025)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700083154949)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700083154949)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700083154949)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_sd_last\") AS \"TEMP(Calculation_3519281700083154949)(933007102)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700083154949)(943764407)(0)\",\n  \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"audio_video_last\") AS \"sum_audio_video_last_ok\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211201 AND date <= 20211208 AND dim = 1) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n          tag,\n          area AS Scope,\n          dim,\n          level1,\n          level2,\n          level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n            CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n          total AS totalUsage,\n          audio,\n          video,\n          host_audio,\n          audience_audio,\n          host_sd,\n          host_hd,\n          host_hdp,\n          host_1080p,\n          host_2k,\n          host_4k,\n          audience_sd,\n          audience_hd,\n          audience_hdp,\n          audience_1080p,\n          audience_2k,\n          audience_4k,\n          audience_audio_low_latency,\n          audience_sd_low_latency,\n          audience_hd_low_latency,\n          audience_hdp_low_latency,\n          audience_1080p_low_latency,\n          audience_2k_low_latency,\n          audience_4k_low_latency,\n          audience_audio_ultra_low_latency,\n          audience_sd_ultra_low_latency,\n          audience_hd_ultra_low_latency,\n          audience_hdp_ultra_low_latency,\n          audience_1080p_ultra_low_latency,\n          audience_2k_ultra_low_latency,\n          audience_4k_ultra_low_latency,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n          audience_video_low_latency_last1 AS audience_video_low_latency_last,\n          audience_total_low_latency_last1 AS audience_total_low_latency_last,\n          audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n          audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n          audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n          audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n          audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n          audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n          audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n          audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n          audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n          audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n          audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n          audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n          audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n          audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n          audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n          audience_2k_last1 AS audience_2k_last,\n          audience_4k_last1 AS audience_4k_last,\n          audience_1080p_last1 AS audience_1080p_last,\n          host_1080p_last1 AS host_1080p_last,\n          host_2k_last1 AS host_2k_last,\n          host_4k_last1 AS host_4k_last,\n          total_last7,\n          audio_last7,\n          video_last7,\n          video_sd_last7,\n          video_hd_last7,\n          video_hdp_last7,\n          host_sd_last7,\n          audience_sd_last7,\n          host_hd_last7,\n          audience_hd_last7,\n          host_hdp_last7,\n          audience_hdp_last7,\n          host_audio_last7,\n          audience_audio_last7,\n          host_video_last7,\n          audience_video_last7,\n          audience_audio_low_latency_last7,\n          audience_video_low_latency_last7,\n          audience_total_low_latency_last7,\n          audience_sd_low_latency_last7,\n          audience_hd_low_latency_last7,\n          audience_hdp_low_latency_last7,\n          audience_1080p_low_latency_last7,\n          audience_2k_low_latency_last7,\n          audience_4k_low_latency_last7,\n          audience_audio_ultra_low_latency_last7,\n          audience_video_ultra_low_latency_last7,\n          audience_total_ultra_low_latency_last7,\n          audience_sd_ultra_low_latency_last7,\n          audience_hd_ultra_low_latency_last7,\n          audience_hdp_ultra_low_latency_last7,\n          audience_1080p_ultra_low_latency_last7,\n          audience_2k_ultra_low_latency_last7,\n          audience_4k_ultra_low_latency_last7,\n          audience_2k_last7,\n          audience_4k_last7,\n          audience_1080p_last7,\n          host_1080p_last7,\n          host_2k_last7,\n          host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211201 AND date <= 20211208 AND dim = 1) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND \"自定义 SQL 查询\".\"rank_level1\" = 1 AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 35"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700079370244)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700079370244)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700079370244)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700079370244)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700079370244)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700079370244)(943764407)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_4k_last\") AS \"TEMP(Calculation_3519281700083154949)(101123376)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_hdp_last\") AS \"TEMP(Calculation_3519281700083154949)(1200517625)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p_last\") AS \"TEMP(Calculation_3519281700083154949)(1314346200)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_hd_last\") AS \"TEMP(Calculation_3519281700083154949)(146570423)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k_last\") AS \"TEMP(Calculation_3519281700083154949)(1717771635)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio_last\") AS \"TEMP(Calculation_3519281700083154949)(2313111073)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_hdp_last\") AS \"TEMP(Calculation_3519281700083154949)(258310559)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_video_last\") AS \"TEMP(Calculation_3519281700083154949)(2820618408)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k_last\") AS \"TEMP(Calculation_3519281700083154949)(3121859593)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p_last\") AS \"TEMP(Calculation_3519281700083154949)(3222422303)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio_last\") AS \"TEMP(Calculation_3519281700083154949)(3227677803)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video_last\") AS \"TEMP(Calculation_3519281700083154949)(3934387163)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k_last\") AS \"TEMP(Calculation_3519281700083154949)(4055292783)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_last\") AS \"TEMP(Calculation_3519281700083154949)(4091190060)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_hd_last\") AS \"TEMP(Calculation_3519281700083154949)(4170367250)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_sd_last\") AS \"TEMP(Calculation_3519281700083154949)(4190307025)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_sd_last\") AS \"TEMP(Calculation_3519281700083154949)(933007102)(0)\",\n  AVG(\"自定义 SQL 查询\".\"totalUsage\") AS \"avg_totalUsage_ok\",\n  \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"sum_totalUsage_ok\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211201 AND date <= 20211208 AND dim = 1) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n          tag,\n          area AS Scope,\n          dim,\n          level1,\n          level2,\n          level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n            CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n          total AS totalUsage,\n          audio,\n          video,\n          host_audio,\n          audience_audio,\n          host_sd,\n          host_hd,\n          host_hdp,\n          host_1080p,\n          host_2k,\n          host_4k,\n          audience_sd,\n          audience_hd,\n          audience_hdp,\n          audience_1080p,\n          audience_2k,\n          audience_4k,\n          audience_audio_low_latency,\n          audience_sd_low_latency,\n          audience_hd_low_latency,\n          audience_hdp_low_latency,\n          audience_1080p_low_latency,\n          audience_2k_low_latency,\n          audience_4k_low_latency,\n          audience_audio_ultra_low_latency,\n          audience_sd_ultra_low_latency,\n          audience_hd_ultra_low_latency,\n          audience_hdp_ultra_low_latency,\n          audience_1080p_ultra_low_latency,\n          audience_2k_ultra_low_latency,\n          audience_4k_ultra_low_latency,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n          audience_video_low_latency_last1 AS audience_video_low_latency_last,\n          audience_total_low_latency_last1 AS audience_total_low_latency_last,\n          audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n          audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n          audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n          audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n          audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n          audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n          audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n          audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n          audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n          audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n          audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n          audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n          audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n          audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n          audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n          audience_2k_last1 AS audience_2k_last,\n          audience_4k_last1 AS audience_4k_last,\n          audience_1080p_last1 AS audience_1080p_last,\n          host_1080p_last1 AS host_1080p_last,\n          host_2k_last1 AS host_2k_last,\n          host_4k_last1 AS host_4k_last,\n          total_last7,\n          audio_last7,\n          video_last7,\n          video_sd_last7,\n          video_hd_last7,\n          video_hdp_last7,\n          host_sd_last7,\n          audience_sd_last7,\n          host_hd_last7,\n          audience_hd_last7,\n          host_hdp_last7,\n          audience_hdp_last7,\n          host_audio_last7,\n          audience_audio_last7,\n          host_video_last7,\n          audience_video_last7,\n          audience_audio_low_latency_last7,\n          audience_video_low_latency_last7,\n          audience_total_low_latency_last7,\n          audience_sd_low_latency_last7,\n          audience_hd_low_latency_last7,\n          audience_hdp_low_latency_last7,\n          audience_1080p_low_latency_last7,\n          audience_2k_low_latency_last7,\n          audience_4k_low_latency_last7,\n          audience_audio_ultra_low_latency_last7,\n          audience_video_ultra_low_latency_last7,\n          audience_total_ultra_low_latency_last7,\n          audience_sd_ultra_low_latency_last7,\n          audience_hd_ultra_low_latency_last7,\n          audience_hdp_ultra_low_latency_last7,\n          audience_1080p_ultra_low_latency_last7,\n          audience_2k_ultra_low_latency_last7,\n          audience_4k_ultra_low_latency_last7,\n          audience_2k_last7,\n          audience_4k_last7,\n          audience_1080p_last7,\n          host_1080p_last7,\n          host_2k_last7,\n          host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211201 AND date <= 20211208 AND dim = 1) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND \"自定义 SQL 查询\".\"rank_level1\" = 2 AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 36"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k_last\") AS \"TEMP(Calculation_3519281700083154949)(101123376)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700083154949)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700083154949)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_hdp_last\") AS \"TEMP(Calculation_3519281700083154949)(1200517625)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700083154949)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p_last\") AS \"TEMP(Calculation_3519281700083154949)(1314346200)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_hd_last\") AS \"TEMP(Calculation_3519281700083154949)(146570423)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k_last\") AS \"TEMP(Calculation_3519281700083154949)(1717771635)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio_last\") AS \"TEMP(Calculation_3519281700083154949)(2313111073)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_hdp_last\") AS \"TEMP(Calculation_3519281700083154949)(258310559)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700083154949)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_video_last\") AS \"TEMP(Calculation_3519281700083154949)(2820618408)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700083154949)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700083154949)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700083154949)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700083154949)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700083154949)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k_last\") AS \"TEMP(Calculation_3519281700083154949)(3121859593)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p_last\") AS \"TEMP(Calculation_3519281700083154949)(3222422303)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio_last\") AS \"TEMP(Calculation_3519281700083154949)(3227677803)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700083154949)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700083154949)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700083154949)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video_last\") AS \"TEMP(Calculation_3519281700083154949)(3934387163)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k_last\") AS \"TEMP(Calculation_3519281700083154949)(4055292783)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_last\") AS \"TEMP(Calculation_3519281700083154949)(4091190060)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700083154949)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_hd_last\") AS \"TEMP(Calculation_3519281700083154949)(4170367250)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_sd_last\") AS \"TEMP(Calculation_3519281700083154949)(4190307025)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700083154949)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700083154949)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700083154949)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_sd_last\") AS \"TEMP(Calculation_3519281700083154949)(933007102)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700083154949)(943764407)(0)\",\n  AVG(\"自定义 SQL 查询\".\"totalUsage\") AS \"avg_totalUsage_ok\",\n  \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"sum_totalUsage_ok\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211201 AND date <= 20211208 AND dim = 1) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n          tag,\n          area AS Scope,\n          dim,\n          level1,\n          level2,\n          level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n            CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n          total AS totalUsage,\n          audio,\n          video,\n          host_audio,\n          audience_audio,\n          host_sd,\n          host_hd,\n          host_hdp,\n          host_1080p,\n          host_2k,\n          host_4k,\n          audience_sd,\n          audience_hd,\n          audience_hdp,\n          audience_1080p,\n          audience_2k,\n          audience_4k,\n          audience_audio_low_latency,\n          audience_sd_low_latency,\n          audience_hd_low_latency,\n          audience_hdp_low_latency,\n          audience_1080p_low_latency,\n          audience_2k_low_latency,\n          audience_4k_low_latency,\n          audience_audio_ultra_low_latency,\n          audience_sd_ultra_low_latency,\n          audience_hd_ultra_low_latency,\n          audience_hdp_ultra_low_latency,\n          audience_1080p_ultra_low_latency,\n          audience_2k_ultra_low_latency,\n          audience_4k_ultra_low_latency,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n          audience_video_low_latency_last1 AS audience_video_low_latency_last,\n          audience_total_low_latency_last1 AS audience_total_low_latency_last,\n          audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n          audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n          audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n          audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n          audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n          audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n          audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n          audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n          audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n          audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n          audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n          audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n          audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n          audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n          audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n          audience_2k_last1 AS audience_2k_last,\n          audience_4k_last1 AS audience_4k_last,\n          audience_1080p_last1 AS audience_1080p_last,\n          host_1080p_last1 AS host_1080p_last,\n          host_2k_last1 AS host_2k_last,\n          host_4k_last1 AS host_4k_last,\n          total_last7,\n          audio_last7,\n          video_last7,\n          video_sd_last7,\n          video_hd_last7,\n          video_hdp_last7,\n          host_sd_last7,\n          audience_sd_last7,\n          host_hd_last7,\n          audience_hd_last7,\n          host_hdp_last7,\n          audience_hdp_last7,\n          host_audio_last7,\n          audience_audio_last7,\n          host_video_last7,\n          audience_video_last7,\n          audience_audio_low_latency_last7,\n          audience_video_low_latency_last7,\n          audience_total_low_latency_last7,\n          audience_sd_low_latency_last7,\n          audience_hd_low_latency_last7,\n          audience_hdp_low_latency_last7,\n          audience_1080p_low_latency_last7,\n          audience_2k_low_latency_last7,\n          audience_4k_low_latency_last7,\n          audience_audio_ultra_low_latency_last7,\n          audience_video_ultra_low_latency_last7,\n          audience_total_ultra_low_latency_last7,\n          audience_sd_ultra_low_latency_last7,\n          audience_hd_ultra_low_latency_last7,\n          audience_hdp_ultra_low_latency_last7,\n          audience_1080p_ultra_low_latency_last7,\n          audience_2k_ultra_low_latency_last7,\n          audience_4k_ultra_low_latency_last7,\n          audience_2k_last7,\n          audience_4k_last7,\n          audience_1080p_last7,\n          host_1080p_last7,\n          host_2k_last7,\n          host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211201 AND date <= 20211208 AND dim = 1) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND \"自定义 SQL 查询\".\"rank_level1\" = 4 AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 36"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700079370244)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700079370244)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700079370244)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700079370244)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700079370244)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700079370244)(943764407)(0)\",\n  MIN(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(1482809429)(0)\",\n  MAX(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(3765460736)(0)\",\n  \"自定义 SQL 查询\".\"level2\" AS \"level2\",\n  \"自定义 SQL 查询\".\"stat_date\" AS \"stat_date\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211201 AND date <= 20211208 AND dim = 1) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n          tag,\n          area AS Scope,\n          dim,\n          level1,\n          level2,\n          level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n            CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n          total AS totalUsage,\n          audio,\n          video,\n          host_audio,\n          audience_audio,\n          host_sd,\n          host_hd,\n          host_hdp,\n          host_1080p,\n          host_2k,\n          host_4k,\n          audience_sd,\n          audience_hd,\n          audience_hdp,\n          audience_1080p,\n          audience_2k,\n          audience_4k,\n          audience_audio_low_latency,\n          audience_sd_low_latency,\n          audience_hd_low_latency,\n          audience_hdp_low_latency,\n          audience_1080p_low_latency,\n          audience_2k_low_latency,\n          audience_4k_low_latency,\n          audience_audio_ultra_low_latency,\n          audience_sd_ultra_low_latency,\n          audience_hd_ultra_low_latency,\n          audience_hdp_ultra_low_latency,\n          audience_1080p_ultra_low_latency,\n          audience_2k_ultra_low_latency,\n          audience_4k_ultra_low_latency,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n          audience_video_low_latency_last1 AS audience_video_low_latency_last,\n          audience_total_low_latency_last1 AS audience_total_low_latency_last,\n          audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n          audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n          audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n          audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n          audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n          audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n          audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n          audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n          audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n          audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n          audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n          audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n          audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n          audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n          audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n          audience_2k_last1 AS audience_2k_last,\n          audience_4k_last1 AS audience_4k_last,\n          audience_1080p_last1 AS audience_1080p_last,\n          host_1080p_last1 AS host_1080p_last,\n          host_2k_last1 AS host_2k_last,\n          host_4k_last1 AS host_4k_last,\n          total_last7,\n          audio_last7,\n          video_last7,\n          video_sd_last7,\n          video_hd_last7,\n          video_hdp_last7,\n          host_sd_last7,\n          audience_sd_last7,\n          host_hd_last7,\n          audience_hd_last7,\n          host_hdp_last7,\n          audience_hdp_last7,\n          host_audio_last7,\n          audience_audio_last7,\n          host_video_last7,\n          audience_video_last7,\n          audience_audio_low_latency_last7,\n          audience_video_low_latency_last7,\n          audience_total_low_latency_last7,\n          audience_sd_low_latency_last7,\n          audience_hd_low_latency_last7,\n          audience_hdp_low_latency_last7,\n          audience_1080p_low_latency_last7,\n          audience_2k_low_latency_last7,\n          audience_4k_low_latency_last7,\n          audience_audio_ultra_low_latency_last7,\n          audience_video_ultra_low_latency_last7,\n          audience_total_ultra_low_latency_last7,\n          audience_sd_ultra_low_latency_last7,\n          audience_hd_ultra_low_latency_last7,\n          audience_hdp_ultra_low_latency_last7,\n          audience_1080p_ultra_low_latency_last7,\n          audience_2k_ultra_low_latency_last7,\n          audience_4k_ultra_low_latency_last7,\n          audience_2k_last7,\n          audience_4k_last7,\n          audience_1080p_last7,\n          host_1080p_last7,\n          host_2k_last7,\n          host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211201 AND date <= 20211208 AND dim = 1) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 20,\n  21"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700079370244)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700079370244)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700079370244)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700079370244)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700079370244)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700079370244)(943764407)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_4k_last\") AS \"TEMP(Calculation_3519281700083154949)(101123376)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_hdp_last\") AS \"TEMP(Calculation_3519281700083154949)(1200517625)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p_last\") AS \"TEMP(Calculation_3519281700083154949)(1314346200)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_hd_last\") AS \"TEMP(Calculation_3519281700083154949)(146570423)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k_last\") AS \"TEMP(Calculation_3519281700083154949)(1717771635)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio_last\") AS \"TEMP(Calculation_3519281700083154949)(2313111073)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_hdp_last\") AS \"TEMP(Calculation_3519281700083154949)(258310559)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_video_last\") AS \"TEMP(Calculation_3519281700083154949)(2820618408)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k_last\") AS \"TEMP(Calculation_3519281700083154949)(3121859593)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p_last\") AS \"TEMP(Calculation_3519281700083154949)(3222422303)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio_last\") AS \"TEMP(Calculation_3519281700083154949)(3227677803)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video_last\") AS \"TEMP(Calculation_3519281700083154949)(3934387163)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k_last\") AS \"TEMP(Calculation_3519281700083154949)(4055292783)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_last\") AS \"TEMP(Calculation_3519281700083154949)(4091190060)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_hd_last\") AS \"TEMP(Calculation_3519281700083154949)(4170367250)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_sd_last\") AS \"TEMP(Calculation_3519281700083154949)(4190307025)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_sd_last\") AS \"TEMP(Calculation_3519281700083154949)(933007102)(0)\",\n  MAX(\"自定义 SQL 查询\".\"stat_date\") AS \"TEMP(attr_stat_date_nk)(2102638629)(0)\",\n  MIN(\"自定义 SQL 查询\".\"stat_date\") AS \"TEMP(attr_stat_date_nk)(2790680713)(0)\",\n  \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"sum_totalUsage_ok\",\n  DATE_ADD('SECOND', 0, date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"tdy_date_ok\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211201 AND date <= 20211208 AND dim = 1) AS \"自定义 SQL 查询\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND \"自定义 SQL 查询\".\"rank_level1\" = 4\nGROUP BY 37,\n  39"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700079370244)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700079370244)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700079370244)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700079370244)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700079370244)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700079370244)(943764407)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_4k_last\") AS \"TEMP(Calculation_3519281700083154949)(101123376)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_hdp_last\") AS \"TEMP(Calculation_3519281700083154949)(1200517625)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p_last\") AS \"TEMP(Calculation_3519281700083154949)(1314346200)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_hd_last\") AS \"TEMP(Calculation_3519281700083154949)(146570423)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k_last\") AS \"TEMP(Calculation_3519281700083154949)(1717771635)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio_last\") AS \"TEMP(Calculation_3519281700083154949)(2313111073)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_hdp_last\") AS \"TEMP(Calculation_3519281700083154949)(258310559)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_video_last\") AS \"TEMP(Calculation_3519281700083154949)(2820618408)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k_last\") AS \"TEMP(Calculation_3519281700083154949)(3121859593)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p_last\") AS \"TEMP(Calculation_3519281700083154949)(3222422303)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio_last\") AS \"TEMP(Calculation_3519281700083154949)(3227677803)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video_last\") AS \"TEMP(Calculation_3519281700083154949)(3934387163)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k_last\") AS \"TEMP(Calculation_3519281700083154949)(4055292783)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_last\") AS \"TEMP(Calculation_3519281700083154949)(4091190060)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_hd_last\") AS \"TEMP(Calculation_3519281700083154949)(4170367250)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_sd_last\") AS \"TEMP(Calculation_3519281700083154949)(4190307025)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_sd_last\") AS \"TEMP(Calculation_3519281700083154949)(933007102)(0)\",\n  MAX(\"自定义 SQL 查询\".\"stat_date\") AS \"TEMP(attr_stat_date_nk)(2102638629)(0)\",\n  MIN(\"自定义 SQL 查询\".\"stat_date\") AS \"TEMP(attr_stat_date_nk)(2790680713)(0)\",\n  \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"sum_totalUsage_ok\",\n  DATE_ADD('SECOND', 0, date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"tdy_date_ok\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211201 AND date <= 20211208 AND dim = 1) AS \"自定义 SQL 查询\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND \"自定义 SQL 查询\".\"rank_level1\" = 2\nGROUP BY 37,\n  39"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700079370244)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700079370244)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700079370244)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700079370244)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700079370244)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700079370244)(943764407)(0)\",\n  MIN(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(1482809429)(0)\",\n  MAX(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(3765460736)(0)\",\n  MAX(\"自定义 SQL 查询\".\"level2\") AS \"TEMP(attr_level2_nk)(3222240611)(0)\",\n  MIN(\"自定义 SQL 查询\".\"level2\") AS \"TEMP(attr_level2_nk)(3931055347)(0)\",\n  \"自定义 SQL 查询\".\"level4\" AS \"level4\",\n  \"自定义 SQL 查询\".\"stat_date\" AS \"stat_date\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"sum_totalUsage_ok\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211201 AND date <= 20211208 AND dim = 1) AS \"自定义 SQL 查询\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND CAST(\"自定义 SQL 查询\".\"level3\" AS VARCHAR) = 'Framework'\nGROUP BY 22,\n  23"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700079370244)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700079370244)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700079370244)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700079370244)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700079370244)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700079370244)(943764407)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_4k_last\") AS \"TEMP(Calculation_3519281700083154949)(101123376)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_hdp_last\") AS \"TEMP(Calculation_3519281700083154949)(1200517625)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p_last\") AS \"TEMP(Calculation_3519281700083154949)(1314346200)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_hd_last\") AS \"TEMP(Calculation_3519281700083154949)(146570423)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k_last\") AS \"TEMP(Calculation_3519281700083154949)(1717771635)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio_last\") AS \"TEMP(Calculation_3519281700083154949)(2313111073)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_hdp_last\") AS \"TEMP(Calculation_3519281700083154949)(258310559)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_video_last\") AS \"TEMP(Calculation_3519281700083154949)(2820618408)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k_last\") AS \"TEMP(Calculation_3519281700083154949)(3121859593)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p_last\") AS \"TEMP(Calculation_3519281700083154949)(3222422303)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio_last\") AS \"TEMP(Calculation_3519281700083154949)(3227677803)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video_last\") AS \"TEMP(Calculation_3519281700083154949)(3934387163)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k_last\") AS \"TEMP(Calculation_3519281700083154949)(4055292783)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_last\") AS \"TEMP(Calculation_3519281700083154949)(4091190060)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_hd_last\") AS \"TEMP(Calculation_3519281700083154949)(4170367250)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_sd_last\") AS \"TEMP(Calculation_3519281700083154949)(4190307025)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_sd_last\") AS \"TEMP(Calculation_3519281700083154949)(933007102)(0)\",\n  MAX(\"自定义 SQL 查询\".\"stat_date\") AS \"TEMP(attr_stat_date_nk)(2102638629)(0)\",\n  MIN(\"自定义 SQL 查询\".\"stat_date\") AS \"TEMP(attr_stat_date_nk)(2790680713)(0)\",\n  \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"sum_totalUsage_ok\",\n  DATE_ADD('SECOND', 0, date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"tdy_date_ok\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211201 AND date <= 20211208 AND dim = 1) AS \"自定义 SQL 查询\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND \"自定义 SQL 查询\".\"rank_level1\" = 3\nGROUP BY 37,\n  39"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700341563406)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio_last7\") AS \"TEMP(Calculation_3519281700341563406)(1077563395)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700341563406)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700341563406)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd_last7\") AS \"TEMP(Calculation_3519281700341563406)(1456465729)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd_last7\") AS \"TEMP(Calculation_3519281700341563406)(1635749653)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd_last7\") AS \"TEMP(Calculation_3519281700341563406)(1747046964)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k_last7\") AS \"TEMP(Calculation_3519281700341563406)(1747524570)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp_last7\") AS \"TEMP(Calculation_3519281700341563406)(2044136109)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio_last7\") AS \"TEMP(Calculation_3519281700341563406)(2464388580)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_last7\") AS \"TEMP(Calculation_3519281700341563406)(2589233512)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700341563406)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k_last7\") AS \"TEMP(Calculation_3519281700341563406)(280796653)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700341563406)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700341563406)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700341563406)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700341563406)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700341563406)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_4k_last7\") AS \"TEMP(Calculation_3519281700341563406)(3127348545)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700341563406)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"total_last7\") AS \"TEMP(Calculation_3519281700341563406)(346677966)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k_last7\") AS \"TEMP(Calculation_3519281700341563406)(3543669678)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p_last7\") AS \"TEMP(Calculation_3519281700341563406)(3624983014)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700341563406)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700341563406)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd_last7\") AS \"TEMP(Calculation_3519281700341563406)(3905372418)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video_last7\") AS \"TEMP(Calculation_3519281700341563406)(4107040267)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700341563406)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700341563406)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p_last7\") AS \"TEMP(Calculation_3519281700341563406)(632977665)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700341563406)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp_last7\") AS \"TEMP(Calculation_3519281700341563406)(750340200)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700341563406)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700341563406)(943764407)(0)\",\n  \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"audio_video_last\") AS \"sum_audio_video_last_ok\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211201 AND date <= 20211208 AND dim = 1) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n          tag,\n          area AS Scope,\n          dim,\n          level1,\n          level2,\n          level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n            CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n          total AS totalUsage,\n          audio,\n          video,\n          host_audio,\n          audience_audio,\n          host_sd,\n          host_hd,\n          host_hdp,\n          host_1080p,\n          host_2k,\n          host_4k,\n          audience_sd,\n          audience_hd,\n          audience_hdp,\n          audience_1080p,\n          audience_2k,\n          audience_4k,\n          audience_audio_low_latency,\n          audience_sd_low_latency,\n          audience_hd_low_latency,\n          audience_hdp_low_latency,\n          audience_1080p_low_latency,\n          audience_2k_low_latency,\n          audience_4k_low_latency,\n          audience_audio_ultra_low_latency,\n          audience_sd_ultra_low_latency,\n          audience_hd_ultra_low_latency,\n          audience_hdp_ultra_low_latency,\n          audience_1080p_ultra_low_latency,\n          audience_2k_ultra_low_latency,\n          audience_4k_ultra_low_latency,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n          audience_video_low_latency_last1 AS audience_video_low_latency_last,\n          audience_total_low_latency_last1 AS audience_total_low_latency_last,\n          audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n          audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n          audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n          audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n          audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n          audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n          audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n          audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n          audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n          audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n          audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n          audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n          audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n          audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n          audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n          audience_2k_last1 AS audience_2k_last,\n          audience_4k_last1 AS audience_4k_last,\n          audience_1080p_last1 AS audience_1080p_last,\n          host_1080p_last1 AS host_1080p_last,\n          host_2k_last1 AS host_2k_last,\n          host_4k_last1 AS host_4k_last,\n          total_last7,\n          audio_last7,\n          video_last7,\n          video_sd_last7,\n          video_hd_last7,\n          video_hdp_last7,\n          host_sd_last7,\n          audience_sd_last7,\n          host_hd_last7,\n          audience_hd_last7,\n          host_hdp_last7,\n          audience_hdp_last7,\n          host_audio_last7,\n          audience_audio_last7,\n          host_video_last7,\n          audience_video_last7,\n          audience_audio_low_latency_last7,\n          audience_video_low_latency_last7,\n          audience_total_low_latency_last7,\n          audience_sd_low_latency_last7,\n          audience_hd_low_latency_last7,\n          audience_hdp_low_latency_last7,\n          audience_1080p_low_latency_last7,\n          audience_2k_low_latency_last7,\n          audience_4k_low_latency_last7,\n          audience_audio_ultra_low_latency_last7,\n          audience_video_ultra_low_latency_last7,\n          audience_total_ultra_low_latency_last7,\n          audience_sd_ultra_low_latency_last7,\n          audience_hd_ultra_low_latency_last7,\n          audience_hdp_ultra_low_latency_last7,\n          audience_1080p_ultra_low_latency_last7,\n          audience_2k_ultra_low_latency_last7,\n          audience_4k_ultra_low_latency_last7,\n          audience_2k_last7,\n          audience_4k_last7,\n          audience_1080p_last7,\n          host_1080p_last7,\n          host_2k_last7,\n          host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211201 AND date <= 20211208 AND dim = 1) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND \"自定义 SQL 查询\".\"rank_level1\" = 4 AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 35"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700079370244)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700079370244)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700079370244)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700079370244)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700079370244)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700079370244)(943764407)(0)\",\n  MIN(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(1482809429)(0)\",\n  MAX(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(3765460736)(0)\",\n  MAX(\"自定义 SQL 查询\".\"level2\") AS \"TEMP(attr_level2_nk)(3222240611)(0)\",\n  MIN(\"自定义 SQL 查询\".\"level2\") AS \"TEMP(attr_level2_nk)(3931055347)(0)\",\n  \"自定义 SQL 查询\".\"level3\" AS \"level3\",\n  \"自定义 SQL 查询\".\"stat_date\" AS \"stat_date\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"sum_totalUsage_ok\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211201 AND date <= 20211208 AND dim = 1) AS \"自定义 SQL 查询\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1\nGROUP BY 22,\n  23"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700079370244)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700079370244)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700079370244)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700079370244)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700079370244)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700079370244)(943764407)(0)\",\n  MIN(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(1482809429)(0)\",\n  MAX(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(3765460736)(0)\",\n  \"自定义 SQL 查询\".\"stat_date\" AS \"TEMP(attr_stat_date_nk)(2102638629)(0)\",\n  \"自定义 SQL 查询\".\"stat_date\" AS \"TEMP(attr_stat_date_nk)(2790680713)(0)\",\n  \"自定义 SQL 查询\".\"level2\" AS \"level2\",\n  \"自定义 SQL 查询\".\"stat_date\" AS \"stat_date\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"sum_totalUsage_ok\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211201 AND date <= 20211208 AND dim = 1) AS \"自定义 SQL 查询\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1\nGROUP BY 22,\n  20"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700079370244)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700079370244)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700079370244)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700079370244)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700079370244)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700079370244)(943764407)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_4k_last\") AS \"TEMP(Calculation_3519281700083154949)(101123376)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_hdp_last\") AS \"TEMP(Calculation_3519281700083154949)(1200517625)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p_last\") AS \"TEMP(Calculation_3519281700083154949)(1314346200)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_hd_last\") AS \"TEMP(Calculation_3519281700083154949)(146570423)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k_last\") AS \"TEMP(Calculation_3519281700083154949)(1717771635)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio_last\") AS \"TEMP(Calculation_3519281700083154949)(2313111073)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_hdp_last\") AS \"TEMP(Calculation_3519281700083154949)(258310559)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_video_last\") AS \"TEMP(Calculation_3519281700083154949)(2820618408)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k_last\") AS \"TEMP(Calculation_3519281700083154949)(3121859593)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p_last\") AS \"TEMP(Calculation_3519281700083154949)(3222422303)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio_last\") AS \"TEMP(Calculation_3519281700083154949)(3227677803)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video_last\") AS \"TEMP(Calculation_3519281700083154949)(3934387163)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k_last\") AS \"TEMP(Calculation_3519281700083154949)(4055292783)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_last\") AS \"TEMP(Calculation_3519281700083154949)(4091190060)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_hd_last\") AS \"TEMP(Calculation_3519281700083154949)(4170367250)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_sd_last\") AS \"TEMP(Calculation_3519281700083154949)(4190307025)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_sd_last\") AS \"TEMP(Calculation_3519281700083154949)(933007102)(0)\",\n  MAX(\"自定义 SQL 查询\".\"stat_date\") AS \"TEMP(attr_stat_date_nk)(2102638629)(0)\",\n  MIN(\"自定义 SQL 查询\".\"stat_date\") AS \"TEMP(attr_stat_date_nk)(2790680713)(0)\",\n  \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"sum_totalUsage_ok\",\n  DATE_ADD('SECOND', 0, date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"tdy_date_ok\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211201 AND date <= 20211208 AND dim = 1) AS \"自定义 SQL 查询\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND \"自定义 SQL 查询\".\"rank_level1\" = 1\nGROUP BY 37,\n  39"
	},
	{
		"presto_sql" : "SELECT \"自定义 SQL 查询\".\"level3\" AS \"level3\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"usr_Calculation_3519281700079370244_ok\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211201 AND date <= 20211208 AND dim = 1) AS \"自定义 SQL 查询\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1\nGROUP BY 1"
	},
	{
		"presto_sql" : "SELECT \"自定义 SQL 查询\".\"level4\" AS \"level4\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"usr_Calculation_3519281700079370244_ok\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211201 AND date <= 20211208 AND dim = 1) AS \"自定义 SQL 查询\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND CAST(\"自定义 SQL 查询\".\"level3\" AS VARCHAR) = 'Framework'\nGROUP BY 1"
	},
	{
		"presto_sql" : "SELECT \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"sum_totalUsage_ok\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211201 AND date <= 20211208 AND dim = 1) AS \"自定义 SQL 查询\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND \"自定义 SQL 查询\".\"rank_level1\" = 3\nGROUP BY 1"
	},
	{
		"presto_sql" : "SELECT \"自定义 SQL 查询\".\"level1\" AS \"level1\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211201 AND date <= 20211208 AND dim = 1) AS \"自定义 SQL 查询\"\nGROUP BY 1\nORDER BY \"level1\""
	},
	{
		"presto_sql" : "SELECT \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"sum_totalUsage_ok\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211201 AND date <= 20211208 AND dim = 1) AS \"自定义 SQL 查询\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND \"自定义 SQL 查询\".\"rank_level1\" = 2\nGROUP BY 1"
	},
	{
		"presto_sql" : "SELECT \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"sum_totalUsage_ok\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211201 AND date <= 20211208 AND dim = 1) AS \"自定义 SQL 查询\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND \"自定义 SQL 查询\".\"rank_level1\" = 4\nGROUP BY 1"
	},
	{
		"presto_sql" : "SELECT \"自定义 SQL 查询\".\"level2\" AS \"level2\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211201 AND date <= 20211208 AND dim = 1) AS \"自定义 SQL 查询\"\nGROUP BY 1\nORDER BY \"level2\""
	},
	{
		"presto_sql" : "SELECT \"自定义 SQL 查询\".\"level2\" AS \"level2\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"usr_Calculation_3519281700079370244_ok\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211201 AND date <= 20211208 AND dim = 1) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n          tag,\n          area AS Scope,\n          dim,\n          level1,\n          level2,\n          level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n            CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n          total AS totalUsage,\n          audio,\n          video,\n          host_audio,\n          audience_audio,\n          host_sd,\n          host_hd,\n          host_hdp,\n          host_1080p,\n          host_2k,\n          host_4k,\n          audience_sd,\n          audience_hd,\n          audience_hdp,\n          audience_1080p,\n          audience_2k,\n          audience_4k,\n          audience_audio_low_latency,\n          audience_sd_low_latency,\n          audience_hd_low_latency,\n          audience_hdp_low_latency,\n          audience_1080p_low_latency,\n          audience_2k_low_latency,\n          audience_4k_low_latency,\n          audience_audio_ultra_low_latency,\n          audience_sd_ultra_low_latency,\n          audience_hd_ultra_low_latency,\n          audience_hdp_ultra_low_latency,\n          audience_1080p_ultra_low_latency,\n          audience_2k_ultra_low_latency,\n          audience_4k_ultra_low_latency,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n          audience_video_low_latency_last1 AS audience_video_low_latency_last,\n          audience_total_low_latency_last1 AS audience_total_low_latency_last,\n          audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n          audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n          audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n          audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n          audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n          audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n          audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n          audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n          audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n          audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n          audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n          audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n          audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n          audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n          audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n          audience_2k_last1 AS audience_2k_last,\n          audience_4k_last1 AS audience_4k_last,\n          audience_1080p_last1 AS audience_1080p_last,\n          host_1080p_last1 AS host_1080p_last,\n          host_2k_last1 AS host_2k_last,\n          host_4k_last1 AS host_4k_last,\n          total_last7,\n          audio_last7,\n          video_last7,\n          video_sd_last7,\n          video_hd_last7,\n          video_hdp_last7,\n          host_sd_last7,\n          audience_sd_last7,\n          host_hd_last7,\n          audience_hd_last7,\n          host_hdp_last7,\n          audience_hdp_last7,\n          host_audio_last7,\n          audience_audio_last7,\n          host_video_last7,\n          audience_video_last7,\n          audience_audio_low_latency_last7,\n          audience_video_low_latency_last7,\n          audience_total_low_latency_last7,\n          audience_sd_low_latency_last7,\n          audience_hd_low_latency_last7,\n          audience_hdp_low_latency_last7,\n          audience_1080p_low_latency_last7,\n          audience_2k_low_latency_last7,\n          audience_4k_low_latency_last7,\n          audience_audio_ultra_low_latency_last7,\n          audience_video_ultra_low_latency_last7,\n          audience_total_ultra_low_latency_last7,\n          audience_sd_ultra_low_latency_last7,\n          audience_hd_ultra_low_latency_last7,\n          audience_hdp_ultra_low_latency_last7,\n          audience_1080p_ultra_low_latency_last7,\n          audience_2k_ultra_low_latency_last7,\n          audience_4k_ultra_low_latency_last7,\n          audience_2k_last7,\n          audience_4k_last7,\n          audience_1080p_last7,\n          host_1080p_last7,\n          host_2k_last7,\n          host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211201 AND date <= 20211208 AND dim = 1) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 1"
	},
	{
		"presto_sql" : "SELECT \"自定义 SQL 查询\".\"level4\" AS \"level4\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"usr_Calculation_3519281700079370244_ok\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211201 AND date <= 20211208 AND dim = 1) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n          tag,\n          area AS Scope,\n          dim,\n          level1,\n          level2,\n          level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n            CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n          total AS totalUsage,\n          audio,\n          video,\n          host_audio,\n          audience_audio,\n          host_sd,\n          host_hd,\n          host_hdp,\n          host_1080p,\n          host_2k,\n          host_4k,\n          audience_sd,\n          audience_hd,\n          audience_hdp,\n          audience_1080p,\n          audience_2k,\n          audience_4k,\n          audience_audio_low_latency,\n          audience_sd_low_latency,\n          audience_hd_low_latency,\n          audience_hdp_low_latency,\n          audience_1080p_low_latency,\n          audience_2k_low_latency,\n          audience_4k_low_latency,\n          audience_audio_ultra_low_latency,\n          audience_sd_ultra_low_latency,\n          audience_hd_ultra_low_latency,\n          audience_hdp_ultra_low_latency,\n          audience_1080p_ultra_low_latency,\n          audience_2k_ultra_low_latency,\n          audience_4k_ultra_low_latency,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n          audience_video_low_latency_last1 AS audience_video_low_latency_last,\n          audience_total_low_latency_last1 AS audience_total_low_latency_last,\n          audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n          audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n          audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n          audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n          audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n          audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n          audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n          audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n          audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n          audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n          audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n          audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n          audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n          audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n          audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n          audience_2k_last1 AS audience_2k_last,\n          audience_4k_last1 AS audience_4k_last,\n          audience_1080p_last1 AS audience_1080p_last,\n          host_1080p_last1 AS host_1080p_last,\n          host_2k_last1 AS host_2k_last,\n          host_4k_last1 AS host_4k_last,\n          total_last7,\n          audio_last7,\n          video_last7,\n          video_sd_last7,\n          video_hd_last7,\n          video_hdp_last7,\n          host_sd_last7,\n          audience_sd_last7,\n          host_hd_last7,\n          audience_hd_last7,\n          host_hdp_last7,\n          audience_hdp_last7,\n          host_audio_last7,\n          audience_audio_last7,\n          host_video_last7,\n          audience_video_last7,\n          audience_audio_low_latency_last7,\n          audience_video_low_latency_last7,\n          audience_total_low_latency_last7,\n          audience_sd_low_latency_last7,\n          audience_hd_low_latency_last7,\n          audience_hdp_low_latency_last7,\n          audience_1080p_low_latency_last7,\n          audience_2k_low_latency_last7,\n          audience_4k_low_latency_last7,\n          audience_audio_ultra_low_latency_last7,\n          audience_video_ultra_low_latency_last7,\n          audience_total_ultra_low_latency_last7,\n          audience_sd_ultra_low_latency_last7,\n          audience_hd_ultra_low_latency_last7,\n          audience_hdp_ultra_low_latency_last7,\n          audience_1080p_ultra_low_latency_last7,\n          audience_2k_ultra_low_latency_last7,\n          audience_4k_ultra_low_latency_last7,\n          audience_2k_last7,\n          audience_4k_last7,\n          audience_1080p_last7,\n          host_1080p_last7,\n          host_2k_last7,\n          host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211201 AND date <= 20211208 AND dim = 1) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND CAST(\"自定义 SQL 查询\".\"level3\" AS VARCHAR) = 'Framework' AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 1"
	},
	{
		"presto_sql" : "SELECT \"自定义 SQL 查询\".\"level3\" AS \"level3\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"usr_Calculation_3519281700079370244_ok\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211201 AND date <= 20211208 AND dim = 1) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n          tag,\n          area AS Scope,\n          dim,\n          level1,\n          level2,\n          level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n            CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n          total AS totalUsage,\n          audio,\n          video,\n          host_audio,\n          audience_audio,\n          host_sd,\n          host_hd,\n          host_hdp,\n          host_1080p,\n          host_2k,\n          host_4k,\n          audience_sd,\n          audience_hd,\n          audience_hdp,\n          audience_1080p,\n          audience_2k,\n          audience_4k,\n          audience_audio_low_latency,\n          audience_sd_low_latency,\n          audience_hd_low_latency,\n          audience_hdp_low_latency,\n          audience_1080p_low_latency,\n          audience_2k_low_latency,\n          audience_4k_low_latency,\n          audience_audio_ultra_low_latency,\n          audience_sd_ultra_low_latency,\n          audience_hd_ultra_low_latency,\n          audience_hdp_ultra_low_latency,\n          audience_1080p_ultra_low_latency,\n          audience_2k_ultra_low_latency,\n          audience_4k_ultra_low_latency,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n          audience_video_low_latency_last1 AS audience_video_low_latency_last,\n          audience_total_low_latency_last1 AS audience_total_low_latency_last,\n          audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n          audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n          audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n          audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n          audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n          audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n          audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n          audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n          audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n          audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n          audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n          audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n          audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n          audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n          audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n          audience_2k_last1 AS audience_2k_last,\n          audience_4k_last1 AS audience_4k_last,\n          audience_1080p_last1 AS audience_1080p_last,\n          host_1080p_last1 AS host_1080p_last,\n          host_2k_last1 AS host_2k_last,\n          host_4k_last1 AS host_4k_last,\n          total_last7,\n          audio_last7,\n          video_last7,\n          video_sd_last7,\n          video_hd_last7,\n          video_hdp_last7,\n          host_sd_last7,\n          audience_sd_last7,\n          host_hd_last7,\n          audience_hd_last7,\n          host_hdp_last7,\n          audience_hdp_last7,\n          host_audio_last7,\n          audience_audio_last7,\n          host_video_last7,\n          audience_video_last7,\n          audience_audio_low_latency_last7,\n          audience_video_low_latency_last7,\n          audience_total_low_latency_last7,\n          audience_sd_low_latency_last7,\n          audience_hd_low_latency_last7,\n          audience_hdp_low_latency_last7,\n          audience_1080p_low_latency_last7,\n          audience_2k_low_latency_last7,\n          audience_4k_low_latency_last7,\n          audience_audio_ultra_low_latency_last7,\n          audience_video_ultra_low_latency_last7,\n          audience_total_ultra_low_latency_last7,\n          audience_sd_ultra_low_latency_last7,\n          audience_hd_ultra_low_latency_last7,\n          audience_hdp_ultra_low_latency_last7,\n          audience_1080p_ultra_low_latency_last7,\n          audience_2k_ultra_low_latency_last7,\n          audience_4k_ultra_low_latency_last7,\n          audience_2k_last7,\n          audience_4k_last7,\n          audience_1080p_last7,\n          host_1080p_last7,\n          host_2k_last7,\n          host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211201 AND date <= 20211208 AND dim = 1) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 1"
	},
	{
		"presto_sql" : "SELECT \"自定义 SQL 查询\".\"level3\" AS \"level3\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211201 AND date <= 20211208 AND dim = 1) AS \"自定义 SQL 查询\"\nGROUP BY 1\nORDER BY \"level3\""
	},
	{
		"presto_sql" : "SELECT \"自定义 SQL 查询\".\"product_level4\" AS \"product_level4\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211201 AND date <= 20211208 AND dim = 1) AS \"自定义 SQL 查询\"\nGROUP BY 1\nORDER BY \"product_level4\""
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700079370244)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700079370244)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700079370244)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700079370244)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700079370244)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700079370244)(943764407)(0)\",\n  MIN(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(1482809429)(0)\",\n  MAX(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(3765460736)(0)\",\n  \"自定义 SQL 查询\".\"stat_date\" AS \"TEMP(attr_stat_date_nk)(2102638629)(0)\",\n  \"自定义 SQL 查询\".\"stat_date\" AS \"TEMP(attr_stat_date_nk)(2790680713)(0)\",\n  \"自定义 SQL 查询\".\"level2\" AS \"level2\",\n  \"自定义 SQL 查询\".\"stat_date\" AS \"stat_date\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"sum_totalUsage_ok\"\nFROM (SELECT date,\n        CASE WHEN 11 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_11\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211202 AND date <= 20211208 AND dim = 1) AS \"自定义 SQL 查询\"\nWHERE \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 1\nGROUP BY 22,\n  20"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700079370244)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700079370244)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700079370244)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700079370244)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700079370244)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700079370244)(943764407)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_4k_last\") AS \"TEMP(Calculation_3519281700083154949)(101123376)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_hdp_last\") AS \"TEMP(Calculation_3519281700083154949)(1200517625)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p_last\") AS \"TEMP(Calculation_3519281700083154949)(1314346200)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_hd_last\") AS \"TEMP(Calculation_3519281700083154949)(146570423)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k_last\") AS \"TEMP(Calculation_3519281700083154949)(1717771635)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio_last\") AS \"TEMP(Calculation_3519281700083154949)(2313111073)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_hdp_last\") AS \"TEMP(Calculation_3519281700083154949)(258310559)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_video_last\") AS \"TEMP(Calculation_3519281700083154949)(2820618408)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k_last\") AS \"TEMP(Calculation_3519281700083154949)(3121859593)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p_last\") AS \"TEMP(Calculation_3519281700083154949)(3222422303)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio_last\") AS \"TEMP(Calculation_3519281700083154949)(3227677803)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video_last\") AS \"TEMP(Calculation_3519281700083154949)(3934387163)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k_last\") AS \"TEMP(Calculation_3519281700083154949)(4055292783)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_last\") AS \"TEMP(Calculation_3519281700083154949)(4091190060)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_hd_last\") AS \"TEMP(Calculation_3519281700083154949)(4170367250)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_sd_last\") AS \"TEMP(Calculation_3519281700083154949)(4190307025)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_sd_last\") AS \"TEMP(Calculation_3519281700083154949)(933007102)(0)\",\n  AVG(\"自定义 SQL 查询\".\"totalUsage\") AS \"avg_totalUsage_ok\",\n  \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"sum_totalUsage_ok\"\nFROM (SELECT date,\n        CASE WHEN 11 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_11\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211202 AND date <= 20211208 AND dim = 1) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n            CASE WHEN 11 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n          tag,\n          area AS Scope,\n          dim,\n          level1,\n          level2,\n          level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n            CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n          total AS totalUsage,\n          audio,\n          video,\n          host_audio,\n          audience_audio,\n          host_sd,\n          host_hd,\n          host_hdp,\n          host_1080p,\n          host_2k,\n          host_4k,\n          audience_sd,\n          audience_hd,\n          audience_hdp,\n          audience_1080p,\n          audience_2k,\n          audience_4k,\n          audience_audio_low_latency,\n          audience_sd_low_latency,\n          audience_hd_low_latency,\n          audience_hdp_low_latency,\n          audience_1080p_low_latency,\n          audience_2k_low_latency,\n          audience_4k_low_latency,\n          audience_audio_ultra_low_latency,\n          audience_sd_ultra_low_latency,\n          audience_hd_ultra_low_latency,\n          audience_hdp_ultra_low_latency,\n          audience_1080p_ultra_low_latency,\n          audience_2k_ultra_low_latency,\n          audience_4k_ultra_low_latency,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n          audience_video_low_latency_last1 AS audience_video_low_latency_last,\n          audience_total_low_latency_last1 AS audience_total_low_latency_last,\n          audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n          audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n          audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n          audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n          audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n          audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n          audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n          audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n          audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n          audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n          audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n          audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n          audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n          audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n          audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n          audience_2k_last1 AS audience_2k_last,\n          audience_4k_last1 AS audience_4k_last,\n          audience_1080p_last1 AS audience_1080p_last,\n          host_1080p_last1 AS host_1080p_last,\n          host_2k_last1 AS host_2k_last,\n          host_4k_last1 AS host_4k_last,\n          total_last7,\n          audio_last7,\n          video_last7,\n          video_sd_last7,\n          video_hd_last7,\n          video_hdp_last7,\n          host_sd_last7,\n          audience_sd_last7,\n          host_hd_last7,\n          audience_hd_last7,\n          host_hdp_last7,\n          audience_hdp_last7,\n          host_audio_last7,\n          audience_audio_last7,\n          host_video_last7,\n          audience_video_last7,\n          audience_audio_low_latency_last7,\n          audience_video_low_latency_last7,\n          audience_total_low_latency_last7,\n          audience_sd_low_latency_last7,\n          audience_hd_low_latency_last7,\n          audience_hdp_low_latency_last7,\n          audience_1080p_low_latency_last7,\n          audience_2k_low_latency_last7,\n          audience_4k_low_latency_last7,\n          audience_audio_ultra_low_latency_last7,\n          audience_video_ultra_low_latency_last7,\n          audience_total_ultra_low_latency_last7,\n          audience_sd_ultra_low_latency_last7,\n          audience_hd_ultra_low_latency_last7,\n          audience_hdp_ultra_low_latency_last7,\n          audience_1080p_ultra_low_latency_last7,\n          audience_2k_ultra_low_latency_last7,\n          audience_4k_ultra_low_latency_last7,\n          audience_2k_last7,\n          audience_4k_last7,\n          audience_1080p_last7,\n          host_1080p_last7,\n          host_2k_last7,\n          host_4k_last7\n        FROM levels_usage_dod_di_11\n        WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211202 AND date <= 20211208 AND dim = 1) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 1 AND \"自定义 SQL 查询\".\"rank_level1\" = 2 AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 36"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700079370244)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700079370244)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700079370244)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700079370244)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700079370244)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700079370244)(943764407)(0)\",\n  MAX(\"自定义 SQL 查询\".\"rank_level1\") AS \"TEMP(attr_rank_level1_qk)(289677037)(0)\",\n  MIN(\"自定义 SQL 查询\".\"rank_level1\") AS \"TEMP(attr_rank_level1_qk)(992764851)(0)\",\n  \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"sum_totalUsage_ok\"\nFROM (SELECT date,\n        CASE WHEN 11 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_11\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211202 AND date <= 20211208 AND dim = 1) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n            CASE WHEN 11 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n          tag,\n          area AS Scope,\n          dim,\n          level1,\n          level2,\n          level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n            CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n          total AS totalUsage,\n          audio,\n          video,\n          host_audio,\n          audience_audio,\n          host_sd,\n          host_hd,\n          host_hdp,\n          host_1080p,\n          host_2k,\n          host_4k,\n          audience_sd,\n          audience_hd,\n          audience_hdp,\n          audience_1080p,\n          audience_2k,\n          audience_4k,\n          audience_audio_low_latency,\n          audience_sd_low_latency,\n          audience_hd_low_latency,\n          audience_hdp_low_latency,\n          audience_1080p_low_latency,\n          audience_2k_low_latency,\n          audience_4k_low_latency,\n          audience_audio_ultra_low_latency,\n          audience_sd_ultra_low_latency,\n          audience_hd_ultra_low_latency,\n          audience_hdp_ultra_low_latency,\n          audience_1080p_ultra_low_latency,\n          audience_2k_ultra_low_latency,\n          audience_4k_ultra_low_latency,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n          audience_video_low_latency_last1 AS audience_video_low_latency_last,\n          audience_total_low_latency_last1 AS audience_total_low_latency_last,\n          audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n          audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n          audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n          audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n          audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n          audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n          audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n          audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n          audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n          audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n          audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n          audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n          audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n          audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n          audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n          audience_2k_last1 AS audience_2k_last,\n          audience_4k_last1 AS audience_4k_last,\n          audience_1080p_last1 AS audience_1080p_last,\n          host_1080p_last1 AS host_1080p_last,\n          host_2k_last1 AS host_2k_last,\n          host_4k_last1 AS host_4k_last,\n          total_last7,\n          audio_last7,\n          video_last7,\n          video_sd_last7,\n          video_hd_last7,\n          video_hdp_last7,\n          host_sd_last7,\n          audience_sd_last7,\n          host_hd_last7,\n          audience_hd_last7,\n          host_hdp_last7,\n          audience_hdp_last7,\n          host_audio_last7,\n          audience_audio_last7,\n          host_video_last7,\n          audience_video_last7,\n          audience_audio_low_latency_last7,\n          audience_video_low_latency_last7,\n          audience_total_low_latency_last7,\n          audience_sd_low_latency_last7,\n          audience_hd_low_latency_last7,\n          audience_hdp_low_latency_last7,\n          audience_1080p_low_latency_last7,\n          audience_2k_low_latency_last7,\n          audience_4k_low_latency_last7,\n          audience_audio_ultra_low_latency_last7,\n          audience_video_ultra_low_latency_last7,\n          audience_total_ultra_low_latency_last7,\n          audience_sd_ultra_low_latency_last7,\n          audience_hd_ultra_low_latency_last7,\n          audience_hdp_ultra_low_latency_last7,\n          audience_1080p_ultra_low_latency_last7,\n          audience_2k_ultra_low_latency_last7,\n          audience_4k_ultra_low_latency_last7,\n          audience_2k_last7,\n          audience_4k_last7,\n          audience_1080p_last7,\n          host_1080p_last7,\n          host_2k_last7,\n          host_4k_last7\n        FROM levels_usage_dod_di_11\n        WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211202 AND date <= 20211208 AND dim = 1) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 20"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k_last\") AS \"TEMP(Calculation_3519281700083154949)(101123376)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700083154949)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700083154949)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_hdp_last\") AS \"TEMP(Calculation_3519281700083154949)(1200517625)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700083154949)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p_last\") AS \"TEMP(Calculation_3519281700083154949)(1314346200)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_hd_last\") AS \"TEMP(Calculation_3519281700083154949)(146570423)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k_last\") AS \"TEMP(Calculation_3519281700083154949)(1717771635)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio_last\") AS \"TEMP(Calculation_3519281700083154949)(2313111073)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_hdp_last\") AS \"TEMP(Calculation_3519281700083154949)(258310559)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700083154949)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_video_last\") AS \"TEMP(Calculation_3519281700083154949)(2820618408)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700083154949)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700083154949)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700083154949)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700083154949)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700083154949)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k_last\") AS \"TEMP(Calculation_3519281700083154949)(3121859593)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p_last\") AS \"TEMP(Calculation_3519281700083154949)(3222422303)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio_last\") AS \"TEMP(Calculation_3519281700083154949)(3227677803)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700083154949)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700083154949)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700083154949)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video_last\") AS \"TEMP(Calculation_3519281700083154949)(3934387163)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k_last\") AS \"TEMP(Calculation_3519281700083154949)(4055292783)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_last\") AS \"TEMP(Calculation_3519281700083154949)(4091190060)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700083154949)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_hd_last\") AS \"TEMP(Calculation_3519281700083154949)(4170367250)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_sd_last\") AS \"TEMP(Calculation_3519281700083154949)(4190307025)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700083154949)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700083154949)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700083154949)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_sd_last\") AS \"TEMP(Calculation_3519281700083154949)(933007102)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700083154949)(943764407)(0)\",\n  AVG(\"自定义 SQL 查询\".\"totalUsage\") AS \"avg_totalUsage_ok\",\n  \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"sum_totalUsage_ok\"\nFROM (SELECT date,\n        CASE WHEN 11 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_11\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211202 AND date <= 20211208 AND dim = 1) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n            CASE WHEN 11 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n          tag,\n          area AS Scope,\n          dim,\n          level1,\n          level2,\n          level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n            CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n          total AS totalUsage,\n          audio,\n          video,\n          host_audio,\n          audience_audio,\n          host_sd,\n          host_hd,\n          host_hdp,\n          host_1080p,\n          host_2k,\n          host_4k,\n          audience_sd,\n          audience_hd,\n          audience_hdp,\n          audience_1080p,\n          audience_2k,\n          audience_4k,\n          audience_audio_low_latency,\n          audience_sd_low_latency,\n          audience_hd_low_latency,\n          audience_hdp_low_latency,\n          audience_1080p_low_latency,\n          audience_2k_low_latency,\n          audience_4k_low_latency,\n          audience_audio_ultra_low_latency,\n          audience_sd_ultra_low_latency,\n          audience_hd_ultra_low_latency,\n          audience_hdp_ultra_low_latency,\n          audience_1080p_ultra_low_latency,\n          audience_2k_ultra_low_latency,\n          audience_4k_ultra_low_latency,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n          audience_video_low_latency_last1 AS audience_video_low_latency_last,\n          audience_total_low_latency_last1 AS audience_total_low_latency_last,\n          audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n          audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n          audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n          audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n          audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n          audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n          audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n          audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n          audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n          audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n          audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n          audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n          audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n          audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n          audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n          audience_2k_last1 AS audience_2k_last,\n          audience_4k_last1 AS audience_4k_last,\n          audience_1080p_last1 AS audience_1080p_last,\n          host_1080p_last1 AS host_1080p_last,\n          host_2k_last1 AS host_2k_last,\n          host_4k_last1 AS host_4k_last,\n          total_last7,\n          audio_last7,\n          video_last7,\n          video_sd_last7,\n          video_hd_last7,\n          video_hdp_last7,\n          host_sd_last7,\n          audience_sd_last7,\n          host_hd_last7,\n          audience_hd_last7,\n          host_hdp_last7,\n          audience_hdp_last7,\n          host_audio_last7,\n          audience_audio_last7,\n          host_video_last7,\n          audience_video_last7,\n          audience_audio_low_latency_last7,\n          audience_video_low_latency_last7,\n          audience_total_low_latency_last7,\n          audience_sd_low_latency_last7,\n          audience_hd_low_latency_last7,\n          audience_hdp_low_latency_last7,\n          audience_1080p_low_latency_last7,\n          audience_2k_low_latency_last7,\n          audience_4k_low_latency_last7,\n          audience_audio_ultra_low_latency_last7,\n          audience_video_ultra_low_latency_last7,\n          audience_total_ultra_low_latency_last7,\n          audience_sd_ultra_low_latency_last7,\n          audience_hd_ultra_low_latency_last7,\n          audience_hdp_ultra_low_latency_last7,\n          audience_1080p_ultra_low_latency_last7,\n          audience_2k_ultra_low_latency_last7,\n          audience_4k_ultra_low_latency_last7,\n          audience_2k_last7,\n          audience_4k_last7,\n          audience_1080p_last7,\n          host_1080p_last7,\n          host_2k_last7,\n          host_4k_last7\n        FROM levels_usage_dod_di_11\n        WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211202 AND date <= 20211208 AND dim = 1) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 1 AND \"自定义 SQL 查询\".\"rank_level1\" = 3 AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 36"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700079370244)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700079370244)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700079370244)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700079370244)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700079370244)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700079370244)(943764407)(0)\",\n  MAX(\"自定义 SQL 查询\".\"stat_date\") AS \"TEMP(attr_stat_date_nk)(2102638629)(0)\",\n  MIN(\"自定义 SQL 查询\".\"stat_date\") AS \"TEMP(attr_stat_date_nk)(2790680713)(0)\",\n  \"自定义 SQL 查询\".\"level4\" AS \"level4\"\nFROM (SELECT date,\n        CASE WHEN 11 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_11\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211202 AND date <= 20211208 AND dim = 1) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n            CASE WHEN 11 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n          tag,\n          area AS Scope,\n          dim,\n          level1,\n          level2,\n          level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n            CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n          total AS totalUsage,\n          audio,\n          video,\n          host_audio,\n          audience_audio,\n          host_sd,\n          host_hd,\n          host_hdp,\n          host_1080p,\n          host_2k,\n          host_4k,\n          audience_sd,\n          audience_hd,\n          audience_hdp,\n          audience_1080p,\n          audience_2k,\n          audience_4k,\n          audience_audio_low_latency,\n          audience_sd_low_latency,\n          audience_hd_low_latency,\n          audience_hdp_low_latency,\n          audience_1080p_low_latency,\n          audience_2k_low_latency,\n          audience_4k_low_latency,\n          audience_audio_ultra_low_latency,\n          audience_sd_ultra_low_latency,\n          audience_hd_ultra_low_latency,\n          audience_hdp_ultra_low_latency,\n          audience_1080p_ultra_low_latency,\n          audience_2k_ultra_low_latency,\n          audience_4k_ultra_low_latency,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n          audience_video_low_latency_last1 AS audience_video_low_latency_last,\n          audience_total_low_latency_last1 AS audience_total_low_latency_last,\n          audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n          audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n          audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n          audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n          audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n          audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n          audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n          audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n          audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n          audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n          audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n          audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n          audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n          audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n          audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n          audience_2k_last1 AS audience_2k_last,\n          audience_4k_last1 AS audience_4k_last,\n          audience_1080p_last1 AS audience_1080p_last,\n          host_1080p_last1 AS host_1080p_last,\n          host_2k_last1 AS host_2k_last,\n          host_4k_last1 AS host_4k_last,\n          total_last7,\n          audio_last7,\n          video_last7,\n          video_sd_last7,\n          video_hd_last7,\n          video_hdp_last7,\n          host_sd_last7,\n          audience_sd_last7,\n          host_hd_last7,\n          audience_hd_last7,\n          host_hdp_last7,\n          audience_hdp_last7,\n          host_audio_last7,\n          audience_audio_last7,\n          host_video_last7,\n          audience_video_last7,\n          audience_audio_low_latency_last7,\n          audience_video_low_latency_last7,\n          audience_total_low_latency_last7,\n          audience_sd_low_latency_last7,\n          audience_hd_low_latency_last7,\n          audience_hdp_low_latency_last7,\n          audience_1080p_low_latency_last7,\n          audience_2k_low_latency_last7,\n          audience_4k_low_latency_last7,\n          audience_audio_ultra_low_latency_last7,\n          audience_video_ultra_low_latency_last7,\n          audience_total_ultra_low_latency_last7,\n          audience_sd_ultra_low_latency_last7,\n          audience_hd_ultra_low_latency_last7,\n          audience_hdp_ultra_low_latency_last7,\n          audience_1080p_ultra_low_latency_last7,\n          audience_2k_ultra_low_latency_last7,\n          audience_4k_ultra_low_latency_last7,\n          audience_2k_last7,\n          audience_4k_last7,\n          audience_1080p_last7,\n          host_1080p_last7,\n          host_2k_last7,\n          host_4k_last7\n        FROM levels_usage_dod_di_11\n        WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211202 AND date <= 20211208 AND dim = 1) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 1 AND CAST(\"自定义 SQL 查询\".\"level3\" AS VARCHAR) = 'Framework' AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 20"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700079370244)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700079370244)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700079370244)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700079370244)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700079370244)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700079370244)(943764407)(0)\",\n  MIN(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(1482809429)(0)\",\n  MAX(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(3765460736)(0)\",\n  MAX(\"自定义 SQL 查询\".\"level2\") AS \"TEMP(attr_level2_nk)(3222240611)(0)\",\n  MIN(\"自定义 SQL 查询\".\"level2\") AS \"TEMP(attr_level2_nk)(3931055347)(0)\",\n  \"自定义 SQL 查询\".\"level4\" AS \"level4\",\n  \"自定义 SQL 查询\".\"stat_date\" AS \"stat_date\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"sum_totalUsage_ok\"\nFROM (SELECT date,\n        CASE WHEN 11 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_11\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211202 AND date <= 20211208 AND dim = 1) AS \"自定义 SQL 查询\"\nWHERE \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 1 AND CAST(\"自定义 SQL 查询\".\"level3\" AS VARCHAR) = 'Framework'\nGROUP BY 22,\n  23"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700079370244)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700079370244)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700079370244)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700079370244)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700079370244)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700079370244)(943764407)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_4k_last\") AS \"TEMP(Calculation_3519281700083154949)(101123376)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_hdp_last\") AS \"TEMP(Calculation_3519281700083154949)(1200517625)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p_last\") AS \"TEMP(Calculation_3519281700083154949)(1314346200)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_hd_last\") AS \"TEMP(Calculation_3519281700083154949)(146570423)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k_last\") AS \"TEMP(Calculation_3519281700083154949)(1717771635)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio_last\") AS \"TEMP(Calculation_3519281700083154949)(2313111073)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_hdp_last\") AS \"TEMP(Calculation_3519281700083154949)(258310559)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_video_last\") AS \"TEMP(Calculation_3519281700083154949)(2820618408)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k_last\") AS \"TEMP(Calculation_3519281700083154949)(3121859593)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p_last\") AS \"TEMP(Calculation_3519281700083154949)(3222422303)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio_last\") AS \"TEMP(Calculation_3519281700083154949)(3227677803)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video_last\") AS \"TEMP(Calculation_3519281700083154949)(3934387163)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k_last\") AS \"TEMP(Calculation_3519281700083154949)(4055292783)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_last\") AS \"TEMP(Calculation_3519281700083154949)(4091190060)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_hd_last\") AS \"TEMP(Calculation_3519281700083154949)(4170367250)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_sd_last\") AS \"TEMP(Calculation_3519281700083154949)(4190307025)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_sd_last\") AS \"TEMP(Calculation_3519281700083154949)(933007102)(0)\",\n  MAX(\"自定义 SQL 查询\".\"stat_date\") AS \"TEMP(attr_stat_date_nk)(2102638629)(0)\",\n  MIN(\"自定义 SQL 查询\".\"stat_date\") AS \"TEMP(attr_stat_date_nk)(2790680713)(0)\",\n  \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"sum_totalUsage_ok\",\n  DATE_ADD('SECOND', 0, date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"tdy_date_ok\"\nFROM (SELECT date,\n        CASE WHEN 11 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_11\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211202 AND date <= 20211208 AND dim = 1) AS \"自定义 SQL 查询\"\nWHERE \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 1 AND \"自定义 SQL 查询\".\"rank_level1\" = 3\nGROUP BY 37,\n  39"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700079370244)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700079370244)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700079370244)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700079370244)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700079370244)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700079370244)(943764407)(0)\",\n  MIN(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(1482809429)(0)\",\n  MAX(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(3765460736)(0)\",\n  MAX(\"自定义 SQL 查询\".\"level2\") AS \"TEMP(attr_level2_nk)(3222240611)(0)\",\n  MIN(\"自定义 SQL 查询\".\"level2\") AS \"TEMP(attr_level2_nk)(3931055347)(0)\",\n  \"自定义 SQL 查询\".\"level3\" AS \"level3\",\n  \"自定义 SQL 查询\".\"stat_date\" AS \"stat_date\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"sum_totalUsage_ok\"\nFROM (SELECT date,\n        CASE WHEN 11 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_11\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211202 AND date <= 20211208 AND dim = 1) AS \"自定义 SQL 查询\"\nWHERE \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 1\nGROUP BY 22,\n  23"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k_last\") AS \"TEMP(Calculation_3519281700083154949)(101123376)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700083154949)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700083154949)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_hdp_last\") AS \"TEMP(Calculation_3519281700083154949)(1200517625)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700083154949)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p_last\") AS \"TEMP(Calculation_3519281700083154949)(1314346200)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_hd_last\") AS \"TEMP(Calculation_3519281700083154949)(146570423)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k_last\") AS \"TEMP(Calculation_3519281700083154949)(1717771635)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio_last\") AS \"TEMP(Calculation_3519281700083154949)(2313111073)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_hdp_last\") AS \"TEMP(Calculation_3519281700083154949)(258310559)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700083154949)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_video_last\") AS \"TEMP(Calculation_3519281700083154949)(2820618408)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700083154949)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700083154949)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700083154949)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700083154949)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700083154949)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k_last\") AS \"TEMP(Calculation_3519281700083154949)(3121859593)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p_last\") AS \"TEMP(Calculation_3519281700083154949)(3222422303)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio_last\") AS \"TEMP(Calculation_3519281700083154949)(3227677803)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700083154949)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700083154949)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700083154949)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video_last\") AS \"TEMP(Calculation_3519281700083154949)(3934387163)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k_last\") AS \"TEMP(Calculation_3519281700083154949)(4055292783)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_last\") AS \"TEMP(Calculation_3519281700083154949)(4091190060)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700083154949)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_hd_last\") AS \"TEMP(Calculation_3519281700083154949)(4170367250)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_sd_last\") AS \"TEMP(Calculation_3519281700083154949)(4190307025)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700083154949)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700083154949)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700083154949)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_sd_last\") AS \"TEMP(Calculation_3519281700083154949)(933007102)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700083154949)(943764407)(0)\",\n  \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"audio_video_last\") AS \"sum_audio_video_last_ok\"\nFROM (SELECT date,\n        CASE WHEN 11 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_11\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211202 AND date <= 20211208 AND dim = 1) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n            CASE WHEN 11 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n          tag,\n          area AS Scope,\n          dim,\n          level1,\n          level2,\n          level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n            CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n          total AS totalUsage,\n          audio,\n          video,\n          host_audio,\n          audience_audio,\n          host_sd,\n          host_hd,\n          host_hdp,\n          host_1080p,\n          host_2k,\n          host_4k,\n          audience_sd,\n          audience_hd,\n          audience_hdp,\n          audience_1080p,\n          audience_2k,\n          audience_4k,\n          audience_audio_low_latency,\n          audience_sd_low_latency,\n          audience_hd_low_latency,\n          audience_hdp_low_latency,\n          audience_1080p_low_latency,\n          audience_2k_low_latency,\n          audience_4k_low_latency,\n          audience_audio_ultra_low_latency,\n          audience_sd_ultra_low_latency,\n          audience_hd_ultra_low_latency,\n          audience_hdp_ultra_low_latency,\n          audience_1080p_ultra_low_latency,\n          audience_2k_ultra_low_latency,\n          audience_4k_ultra_low_latency,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n          audience_video_low_latency_last1 AS audience_video_low_latency_last,\n          audience_total_low_latency_last1 AS audience_total_low_latency_last,\n          audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n          audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n          audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n          audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n          audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n          audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n          audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n          audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n          audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n          audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n          audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n          audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n          audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n          audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n          audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n          audience_2k_last1 AS audience_2k_last,\n          audience_4k_last1 AS audience_4k_last,\n          audience_1080p_last1 AS audience_1080p_last,\n          host_1080p_last1 AS host_1080p_last,\n          host_2k_last1 AS host_2k_last,\n          host_4k_last1 AS host_4k_last,\n          total_last7,\n          audio_last7,\n          video_last7,\n          video_sd_last7,\n          video_hd_last7,\n          video_hdp_last7,\n          host_sd_last7,\n          audience_sd_last7,\n          host_hd_last7,\n          audience_hd_last7,\n          host_hdp_last7,\n          audience_hdp_last7,\n          host_audio_last7,\n          audience_audio_last7,\n          host_video_last7,\n          audience_video_last7,\n          audience_audio_low_latency_last7,\n          audience_video_low_latency_last7,\n          audience_total_low_latency_last7,\n          audience_sd_low_latency_last7,\n          audience_hd_low_latency_last7,\n          audience_hdp_low_latency_last7,\n          audience_1080p_low_latency_last7,\n          audience_2k_low_latency_last7,\n          audience_4k_low_latency_last7,\n          audience_audio_ultra_low_latency_last7,\n          audience_video_ultra_low_latency_last7,\n          audience_total_ultra_low_latency_last7,\n          audience_sd_ultra_low_latency_last7,\n          audience_hd_ultra_low_latency_last7,\n          audience_hdp_ultra_low_latency_last7,\n          audience_1080p_ultra_low_latency_last7,\n          audience_2k_ultra_low_latency_last7,\n          audience_4k_ultra_low_latency_last7,\n          audience_2k_last7,\n          audience_4k_last7,\n          audience_1080p_last7,\n          host_1080p_last7,\n          host_2k_last7,\n          host_4k_last7\n        FROM levels_usage_dod_di_11\n        WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211202 AND date <= 20211208 AND dim = 1) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 1 AND \"自定义 SQL 查询\".\"rank_level1\" = 1 AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 35"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k_last\") AS \"TEMP(Calculation_3519281700083154949)(101123376)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700083154949)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700083154949)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_hdp_last\") AS \"TEMP(Calculation_3519281700083154949)(1200517625)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700083154949)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p_last\") AS \"TEMP(Calculation_3519281700083154949)(1314346200)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_hd_last\") AS \"TEMP(Calculation_3519281700083154949)(146570423)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k_last\") AS \"TEMP(Calculation_3519281700083154949)(1717771635)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio_last\") AS \"TEMP(Calculation_3519281700083154949)(2313111073)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_hdp_last\") AS \"TEMP(Calculation_3519281700083154949)(258310559)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700083154949)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_video_last\") AS \"TEMP(Calculation_3519281700083154949)(2820618408)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700083154949)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700083154949)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700083154949)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700083154949)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700083154949)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k_last\") AS \"TEMP(Calculation_3519281700083154949)(3121859593)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p_last\") AS \"TEMP(Calculation_3519281700083154949)(3222422303)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio_last\") AS \"TEMP(Calculation_3519281700083154949)(3227677803)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700083154949)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700083154949)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700083154949)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video_last\") AS \"TEMP(Calculation_3519281700083154949)(3934387163)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k_last\") AS \"TEMP(Calculation_3519281700083154949)(4055292783)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_last\") AS \"TEMP(Calculation_3519281700083154949)(4091190060)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700083154949)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_hd_last\") AS \"TEMP(Calculation_3519281700083154949)(4170367250)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_sd_last\") AS \"TEMP(Calculation_3519281700083154949)(4190307025)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700083154949)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700083154949)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700083154949)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_sd_last\") AS \"TEMP(Calculation_3519281700083154949)(933007102)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700083154949)(943764407)(0)\",\n  AVG(\"自定义 SQL 查询\".\"totalUsage\") AS \"avg_totalUsage_ok\",\n  \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"sum_totalUsage_ok\"\nFROM (SELECT date,\n        CASE WHEN 11 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_11\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211202 AND date <= 20211208 AND dim = 1) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n            CASE WHEN 11 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n          tag,\n          area AS Scope,\n          dim,\n          level1,\n          level2,\n          level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n            CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n          total AS totalUsage,\n          audio,\n          video,\n          host_audio,\n          audience_audio,\n          host_sd,\n          host_hd,\n          host_hdp,\n          host_1080p,\n          host_2k,\n          host_4k,\n          audience_sd,\n          audience_hd,\n          audience_hdp,\n          audience_1080p,\n          audience_2k,\n          audience_4k,\n          audience_audio_low_latency,\n          audience_sd_low_latency,\n          audience_hd_low_latency,\n          audience_hdp_low_latency,\n          audience_1080p_low_latency,\n          audience_2k_low_latency,\n          audience_4k_low_latency,\n          audience_audio_ultra_low_latency,\n          audience_sd_ultra_low_latency,\n          audience_hd_ultra_low_latency,\n          audience_hdp_ultra_low_latency,\n          audience_1080p_ultra_low_latency,\n          audience_2k_ultra_low_latency,\n          audience_4k_ultra_low_latency,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n          audience_video_low_latency_last1 AS audience_video_low_latency_last,\n          audience_total_low_latency_last1 AS audience_total_low_latency_last,\n          audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n          audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n          audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n          audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n          audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n          audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n          audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n          audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n          audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n          audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n          audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n          audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n          audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n          audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n          audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n          audience_2k_last1 AS audience_2k_last,\n          audience_4k_last1 AS audience_4k_last,\n          audience_1080p_last1 AS audience_1080p_last,\n          host_1080p_last1 AS host_1080p_last,\n          host_2k_last1 AS host_2k_last,\n          host_4k_last1 AS host_4k_last,\n          total_last7,\n          audio_last7,\n          video_last7,\n          video_sd_last7,\n          video_hd_last7,\n          video_hdp_last7,\n          host_sd_last7,\n          audience_sd_last7,\n          host_hd_last7,\n          audience_hd_last7,\n          host_hdp_last7,\n          audience_hdp_last7,\n          host_audio_last7,\n          audience_audio_last7,\n          host_video_last7,\n          audience_video_last7,\n          audience_audio_low_latency_last7,\n          audience_video_low_latency_last7,\n          audience_total_low_latency_last7,\n          audience_sd_low_latency_last7,\n          audience_hd_low_latency_last7,\n          audience_hdp_low_latency_last7,\n          audience_1080p_low_latency_last7,\n          audience_2k_low_latency_last7,\n          audience_4k_low_latency_last7,\n          audience_audio_ultra_low_latency_last7,\n          audience_video_ultra_low_latency_last7,\n          audience_total_ultra_low_latency_last7,\n          audience_sd_ultra_low_latency_last7,\n          audience_hd_ultra_low_latency_last7,\n          audience_hdp_ultra_low_latency_last7,\n          audience_1080p_ultra_low_latency_last7,\n          audience_2k_ultra_low_latency_last7,\n          audience_4k_ultra_low_latency_last7,\n          audience_2k_last7,\n          audience_4k_last7,\n          audience_1080p_last7,\n          host_1080p_last7,\n          host_2k_last7,\n          host_4k_last7\n        FROM levels_usage_dod_di_11\n        WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211202 AND date <= 20211208 AND dim = 1) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 1 AND \"自定义 SQL 查询\".\"rank_level1\" = 4 AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 36"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700079370244)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700079370244)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700079370244)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700079370244)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700079370244)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700079370244)(943764407)(0)\",\n  \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"sum_totalUsage_ok\",\n  DATE_ADD('SECOND', 0, date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"tdy_date_ok\"\nFROM (SELECT date,\n        CASE WHEN 11 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_11\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211202 AND date <= 20211208 AND dim = 1) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n            CASE WHEN 11 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n          tag,\n          area AS Scope,\n          dim,\n          level1,\n          level2,\n          level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n            CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n          total AS totalUsage,\n          audio,\n          video,\n          host_audio,\n          audience_audio,\n          host_sd,\n          host_hd,\n          host_hdp,\n          host_1080p,\n          host_2k,\n          host_4k,\n          audience_sd,\n          audience_hd,\n          audience_hdp,\n          audience_1080p,\n          audience_2k,\n          audience_4k,\n          audience_audio_low_latency,\n          audience_sd_low_latency,\n          audience_hd_low_latency,\n          audience_hdp_low_latency,\n          audience_1080p_low_latency,\n          audience_2k_low_latency,\n          audience_4k_low_latency,\n          audience_audio_ultra_low_latency,\n          audience_sd_ultra_low_latency,\n          audience_hd_ultra_low_latency,\n          audience_hdp_ultra_low_latency,\n          audience_1080p_ultra_low_latency,\n          audience_2k_ultra_low_latency,\n          audience_4k_ultra_low_latency,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n          audience_video_low_latency_last1 AS audience_video_low_latency_last,\n          audience_total_low_latency_last1 AS audience_total_low_latency_last,\n          audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n          audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n          audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n          audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n          audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n          audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n          audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n          audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n          audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n          audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n          audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n          audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n          audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n          audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n          audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n          audience_2k_last1 AS audience_2k_last,\n          audience_4k_last1 AS audience_4k_last,\n          audience_1080p_last1 AS audience_1080p_last,\n          host_1080p_last1 AS host_1080p_last,\n          host_2k_last1 AS host_2k_last,\n          host_4k_last1 AS host_4k_last,\n          total_last7,\n          audio_last7,\n          video_last7,\n          video_sd_last7,\n          video_hd_last7,\n          video_hdp_last7,\n          host_sd_last7,\n          audience_sd_last7,\n          host_hd_last7,\n          audience_hd_last7,\n          host_hdp_last7,\n          audience_hdp_last7,\n          host_audio_last7,\n          audience_audio_last7,\n          host_video_last7,\n          audience_video_last7,\n          audience_audio_low_latency_last7,\n          audience_video_low_latency_last7,\n          audience_total_low_latency_last7,\n          audience_sd_low_latency_last7,\n          audience_hd_low_latency_last7,\n          audience_hdp_low_latency_last7,\n          audience_1080p_low_latency_last7,\n          audience_2k_low_latency_last7,\n          audience_4k_low_latency_last7,\n          audience_audio_ultra_low_latency_last7,\n          audience_video_ultra_low_latency_last7,\n          audience_total_ultra_low_latency_last7,\n          audience_sd_ultra_low_latency_last7,\n          audience_hd_ultra_low_latency_last7,\n          audience_hdp_ultra_low_latency_last7,\n          audience_1080p_ultra_low_latency_last7,\n          audience_2k_ultra_low_latency_last7,\n          audience_4k_ultra_low_latency_last7,\n          audience_2k_last7,\n          audience_4k_last7,\n          audience_1080p_last7,\n          host_1080p_last7,\n          host_2k_last7,\n          host_4k_last7\n        FROM levels_usage_dod_di_11\n        WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211202 AND date <= 20211208 AND dim = 1) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 1 AND \"自定义 SQL 查询\".\"rank_level1\" = 3 AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 18,\n  20"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700079370244)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700079370244)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700079370244)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700079370244)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700079370244)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700079370244)(943764407)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_4k_last\") AS \"TEMP(Calculation_3519281700083154949)(101123376)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_hdp_last\") AS \"TEMP(Calculation_3519281700083154949)(1200517625)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p_last\") AS \"TEMP(Calculation_3519281700083154949)(1314346200)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_hd_last\") AS \"TEMP(Calculation_3519281700083154949)(146570423)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k_last\") AS \"TEMP(Calculation_3519281700083154949)(1717771635)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio_last\") AS \"TEMP(Calculation_3519281700083154949)(2313111073)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_hdp_last\") AS \"TEMP(Calculation_3519281700083154949)(258310559)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_video_last\") AS \"TEMP(Calculation_3519281700083154949)(2820618408)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k_last\") AS \"TEMP(Calculation_3519281700083154949)(3121859593)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p_last\") AS \"TEMP(Calculation_3519281700083154949)(3222422303)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio_last\") AS \"TEMP(Calculation_3519281700083154949)(3227677803)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video_last\") AS \"TEMP(Calculation_3519281700083154949)(3934387163)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k_last\") AS \"TEMP(Calculation_3519281700083154949)(4055292783)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_last\") AS \"TEMP(Calculation_3519281700083154949)(4091190060)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_hd_last\") AS \"TEMP(Calculation_3519281700083154949)(4170367250)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_sd_last\") AS \"TEMP(Calculation_3519281700083154949)(4190307025)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_sd_last\") AS \"TEMP(Calculation_3519281700083154949)(933007102)(0)\",\n  MAX(\"自定义 SQL 查询\".\"stat_date\") AS \"TEMP(attr_stat_date_nk)(2102638629)(0)\",\n  MIN(\"自定义 SQL 查询\".\"stat_date\") AS \"TEMP(attr_stat_date_nk)(2790680713)(0)\",\n  \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"sum_totalUsage_ok\",\n  DATE_ADD('SECOND', 0, date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"tdy_date_ok\"\nFROM (SELECT date,\n        CASE WHEN 11 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_11\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211202 AND date <= 20211208 AND dim = 1) AS \"自定义 SQL 查询\"\nWHERE \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 1 AND \"自定义 SQL 查询\".\"rank_level1\" = 4\nGROUP BY 37,\n  39"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700079370244)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700079370244)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700079370244)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700079370244)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700079370244)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700079370244)(943764407)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_4k_last\") AS \"TEMP(Calculation_3519281700083154949)(101123376)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_hdp_last\") AS \"TEMP(Calculation_3519281700083154949)(1200517625)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p_last\") AS \"TEMP(Calculation_3519281700083154949)(1314346200)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_hd_last\") AS \"TEMP(Calculation_3519281700083154949)(146570423)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k_last\") AS \"TEMP(Calculation_3519281700083154949)(1717771635)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio_last\") AS \"TEMP(Calculation_3519281700083154949)(2313111073)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_hdp_last\") AS \"TEMP(Calculation_3519281700083154949)(258310559)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_video_last\") AS \"TEMP(Calculation_3519281700083154949)(2820618408)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k_last\") AS \"TEMP(Calculation_3519281700083154949)(3121859593)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p_last\") AS \"TEMP(Calculation_3519281700083154949)(3222422303)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio_last\") AS \"TEMP(Calculation_3519281700083154949)(3227677803)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video_last\") AS \"TEMP(Calculation_3519281700083154949)(3934387163)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k_last\") AS \"TEMP(Calculation_3519281700083154949)(4055292783)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_last\") AS \"TEMP(Calculation_3519281700083154949)(4091190060)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_hd_last\") AS \"TEMP(Calculation_3519281700083154949)(4170367250)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_sd_last\") AS \"TEMP(Calculation_3519281700083154949)(4190307025)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_sd_last\") AS \"TEMP(Calculation_3519281700083154949)(933007102)(0)\",\n  MAX(\"自定义 SQL 查询\".\"stat_date\") AS \"TEMP(attr_stat_date_nk)(2102638629)(0)\",\n  MIN(\"自定义 SQL 查询\".\"stat_date\") AS \"TEMP(attr_stat_date_nk)(2790680713)(0)\",\n  \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"sum_totalUsage_ok\",\n  DATE_ADD('SECOND', 0, date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"tdy_date_ok\"\nFROM (SELECT date,\n        CASE WHEN 11 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_11\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211202 AND date <= 20211208 AND dim = 1) AS \"自定义 SQL 查询\"\nWHERE \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 1 AND \"自定义 SQL 查询\".\"rank_level1\" = 1\nGROUP BY 37,\n  39"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700079370244)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700079370244)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700079370244)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700079370244)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700079370244)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700079370244)(943764407)(0)\",\n  MIN(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(1482809429)(0)\",\n  MAX(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(3765460736)(0)\",\n  \"自定义 SQL 查询\".\"level2\" AS \"level2\",\n  \"自定义 SQL 查询\".\"stat_date\" AS \"stat_date\"\nFROM (SELECT date,\n        CASE WHEN 11 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_11\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211202 AND date <= 20211208 AND dim = 1) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n            CASE WHEN 11 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n          tag,\n          area AS Scope,\n          dim,\n          level1,\n          level2,\n          level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n            CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n          total AS totalUsage,\n          audio,\n          video,\n          host_audio,\n          audience_audio,\n          host_sd,\n          host_hd,\n          host_hdp,\n          host_1080p,\n          host_2k,\n          host_4k,\n          audience_sd,\n          audience_hd,\n          audience_hdp,\n          audience_1080p,\n          audience_2k,\n          audience_4k,\n          audience_audio_low_latency,\n          audience_sd_low_latency,\n          audience_hd_low_latency,\n          audience_hdp_low_latency,\n          audience_1080p_low_latency,\n          audience_2k_low_latency,\n          audience_4k_low_latency,\n          audience_audio_ultra_low_latency,\n          audience_sd_ultra_low_latency,\n          audience_hd_ultra_low_latency,\n          audience_hdp_ultra_low_latency,\n          audience_1080p_ultra_low_latency,\n          audience_2k_ultra_low_latency,\n          audience_4k_ultra_low_latency,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n          audience_video_low_latency_last1 AS audience_video_low_latency_last,\n          audience_total_low_latency_last1 AS audience_total_low_latency_last,\n          audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n          audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n          audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n          audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n          audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n          audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n          audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n          audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n          audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n          audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n          audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n          audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n          audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n          audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n          audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n          audience_2k_last1 AS audience_2k_last,\n          audience_4k_last1 AS audience_4k_last,\n          audience_1080p_last1 AS audience_1080p_last,\n          host_1080p_last1 AS host_1080p_last,\n          host_2k_last1 AS host_2k_last,\n          host_4k_last1 AS host_4k_last,\n          total_last7,\n          audio_last7,\n          video_last7,\n          video_sd_last7,\n          video_hd_last7,\n          video_hdp_last7,\n          host_sd_last7,\n          audience_sd_last7,\n          host_hd_last7,\n          audience_hd_last7,\n          host_hdp_last7,\n          audience_hdp_last7,\n          host_audio_last7,\n          audience_audio_last7,\n          host_video_last7,\n          audience_video_last7,\n          audience_audio_low_latency_last7,\n          audience_video_low_latency_last7,\n          audience_total_low_latency_last7,\n          audience_sd_low_latency_last7,\n          audience_hd_low_latency_last7,\n          audience_hdp_low_latency_last7,\n          audience_1080p_low_latency_last7,\n          audience_2k_low_latency_last7,\n          audience_4k_low_latency_last7,\n          audience_audio_ultra_low_latency_last7,\n          audience_video_ultra_low_latency_last7,\n          audience_total_ultra_low_latency_last7,\n          audience_sd_ultra_low_latency_last7,\n          audience_hd_ultra_low_latency_last7,\n          audience_hdp_ultra_low_latency_last7,\n          audience_1080p_ultra_low_latency_last7,\n          audience_2k_ultra_low_latency_last7,\n          audience_4k_ultra_low_latency_last7,\n          audience_2k_last7,\n          audience_4k_last7,\n          audience_1080p_last7,\n          host_1080p_last7,\n          host_2k_last7,\n          host_4k_last7\n        FROM levels_usage_dod_di_11\n        WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211202 AND date <= 20211208 AND dim = 1) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 1 AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 20,\n  21"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700079370244)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700079370244)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700079370244)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700079370244)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700079370244)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700079370244)(943764407)(0)\",\n  \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"sum_totalUsage_ok\",\n  DATE_ADD('SECOND', 0, date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"tdy_date_ok\"\nFROM (SELECT date,\n        CASE WHEN 11 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_11\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211202 AND date <= 20211208 AND dim = 1) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n            CASE WHEN 11 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n          tag,\n          area AS Scope,\n          dim,\n          level1,\n          level2,\n          level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n            CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n          total AS totalUsage,\n          audio,\n          video,\n          host_audio,\n          audience_audio,\n          host_sd,\n          host_hd,\n          host_hdp,\n          host_1080p,\n          host_2k,\n          host_4k,\n          audience_sd,\n          audience_hd,\n          audience_hdp,\n          audience_1080p,\n          audience_2k,\n          audience_4k,\n          audience_audio_low_latency,\n          audience_sd_low_latency,\n          audience_hd_low_latency,\n          audience_hdp_low_latency,\n          audience_1080p_low_latency,\n          audience_2k_low_latency,\n          audience_4k_low_latency,\n          audience_audio_ultra_low_latency,\n          audience_sd_ultra_low_latency,\n          audience_hd_ultra_low_latency,\n          audience_hdp_ultra_low_latency,\n          audience_1080p_ultra_low_latency,\n          audience_2k_ultra_low_latency,\n          audience_4k_ultra_low_latency,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n          audience_video_low_latency_last1 AS audience_video_low_latency_last,\n          audience_total_low_latency_last1 AS audience_total_low_latency_last,\n          audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n          audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n          audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n          audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n          audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n          audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n          audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n          audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n          audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n          audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n          audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n          audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n          audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n          audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n          audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n          audience_2k_last1 AS audience_2k_last,\n          audience_4k_last1 AS audience_4k_last,\n          audience_1080p_last1 AS audience_1080p_last,\n          host_1080p_last1 AS host_1080p_last,\n          host_2k_last1 AS host_2k_last,\n          host_4k_last1 AS host_4k_last,\n          total_last7,\n          audio_last7,\n          video_last7,\n          video_sd_last7,\n          video_hd_last7,\n          video_hdp_last7,\n          host_sd_last7,\n          audience_sd_last7,\n          host_hd_last7,\n          audience_hd_last7,\n          host_hdp_last7,\n          audience_hdp_last7,\n          host_audio_last7,\n          audience_audio_last7,\n          host_video_last7,\n          audience_video_last7,\n          audience_audio_low_latency_last7,\n          audience_video_low_latency_last7,\n          audience_total_low_latency_last7,\n          audience_sd_low_latency_last7,\n          audience_hd_low_latency_last7,\n          audience_hdp_low_latency_last7,\n          audience_1080p_low_latency_last7,\n          audience_2k_low_latency_last7,\n          audience_4k_low_latency_last7,\n          audience_audio_ultra_low_latency_last7,\n          audience_video_ultra_low_latency_last7,\n          audience_total_ultra_low_latency_last7,\n          audience_sd_ultra_low_latency_last7,\n          audience_hd_ultra_low_latency_last7,\n          audience_hdp_ultra_low_latency_last7,\n          audience_1080p_ultra_low_latency_last7,\n          audience_2k_ultra_low_latency_last7,\n          audience_4k_ultra_low_latency_last7,\n          audience_2k_last7,\n          audience_4k_last7,\n          audience_1080p_last7,\n          host_1080p_last7,\n          host_2k_last7,\n          host_4k_last7\n        FROM levels_usage_dod_di_11\n        WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211202 AND date <= 20211208 AND dim = 1) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 1 AND \"自定义 SQL 查询\".\"rank_level1\" = 4 AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 18,\n  20"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700079370244)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700079370244)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700079370244)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700079370244)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700079370244)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700079370244)(943764407)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_4k_last\") AS \"TEMP(Calculation_3519281700083154949)(101123376)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_hdp_last\") AS \"TEMP(Calculation_3519281700083154949)(1200517625)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p_last\") AS \"TEMP(Calculation_3519281700083154949)(1314346200)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_hd_last\") AS \"TEMP(Calculation_3519281700083154949)(146570423)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k_last\") AS \"TEMP(Calculation_3519281700083154949)(1717771635)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio_last\") AS \"TEMP(Calculation_3519281700083154949)(2313111073)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_hdp_last\") AS \"TEMP(Calculation_3519281700083154949)(258310559)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_video_last\") AS \"TEMP(Calculation_3519281700083154949)(2820618408)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k_last\") AS \"TEMP(Calculation_3519281700083154949)(3121859593)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p_last\") AS \"TEMP(Calculation_3519281700083154949)(3222422303)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio_last\") AS \"TEMP(Calculation_3519281700083154949)(3227677803)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video_last\") AS \"TEMP(Calculation_3519281700083154949)(3934387163)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k_last\") AS \"TEMP(Calculation_3519281700083154949)(4055292783)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_last\") AS \"TEMP(Calculation_3519281700083154949)(4091190060)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_hd_last\") AS \"TEMP(Calculation_3519281700083154949)(4170367250)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_sd_last\") AS \"TEMP(Calculation_3519281700083154949)(4190307025)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_sd_last\") AS \"TEMP(Calculation_3519281700083154949)(933007102)(0)\",\n  MAX(\"自定义 SQL 查询\".\"stat_date\") AS \"TEMP(attr_stat_date_nk)(2102638629)(0)\",\n  MIN(\"自定义 SQL 查询\".\"stat_date\") AS \"TEMP(attr_stat_date_nk)(2790680713)(0)\",\n  \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"sum_totalUsage_ok\",\n  DATE_ADD('SECOND', 0, date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"tdy_date_ok\"\nFROM (SELECT date,\n        CASE WHEN 11 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_11\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211202 AND date <= 20211208 AND dim = 1) AS \"自定义 SQL 查询\"\nWHERE \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 1 AND \"自定义 SQL 查询\".\"rank_level1\" = 2\nGROUP BY 37,\n  39"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700079370244)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700079370244)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700079370244)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700079370244)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700079370244)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700079370244)(943764407)(0)\",\n  MIN(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(1482809429)(0)\",\n  MAX(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(3765460736)(0)\",\n  MAX(\"自定义 SQL 查询\".\"level2\") AS \"TEMP(attr_level2_nk)(3222240611)(0)\",\n  MIN(\"自定义 SQL 查询\".\"level2\") AS \"TEMP(attr_level2_nk)(3931055347)(0)\",\n  MAX(\"自定义 SQL 查询\".\"stat_date\") AS \"TEMP(attr_stat_date_nk)(2102638629)(0)\",\n  MIN(\"自定义 SQL 查询\".\"stat_date\") AS \"TEMP(attr_stat_date_nk)(2790680713)(0)\",\n  \"自定义 SQL 查询\".\"level3\" AS \"level3\"\nFROM (SELECT date,\n        CASE WHEN 11 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_11\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211202 AND date <= 20211208 AND dim = 1) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n            CASE WHEN 11 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n          tag,\n          area AS Scope,\n          dim,\n          level1,\n          level2,\n          level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n            CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n          total AS totalUsage,\n          audio,\n          video,\n          host_audio,\n          audience_audio,\n          host_sd,\n          host_hd,\n          host_hdp,\n          host_1080p,\n          host_2k,\n          host_4k,\n          audience_sd,\n          audience_hd,\n          audience_hdp,\n          audience_1080p,\n          audience_2k,\n          audience_4k,\n          audience_audio_low_latency,\n          audience_sd_low_latency,\n          audience_hd_low_latency,\n          audience_hdp_low_latency,\n          audience_1080p_low_latency,\n          audience_2k_low_latency,\n          audience_4k_low_latency,\n          audience_audio_ultra_low_latency,\n          audience_sd_ultra_low_latency,\n          audience_hd_ultra_low_latency,\n          audience_hdp_ultra_low_latency,\n          audience_1080p_ultra_low_latency,\n          audience_2k_ultra_low_latency,\n          audience_4k_ultra_low_latency,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n          audience_video_low_latency_last1 AS audience_video_low_latency_last,\n          audience_total_low_latency_last1 AS audience_total_low_latency_last,\n          audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n          audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n          audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n          audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n          audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n          audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n          audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n          audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n          audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n          audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n          audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n          audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n          audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n          audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n          audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n          audience_2k_last1 AS audience_2k_last,\n          audience_4k_last1 AS audience_4k_last,\n          audience_1080p_last1 AS audience_1080p_last,\n          host_1080p_last1 AS host_1080p_last,\n          host_2k_last1 AS host_2k_last,\n          host_4k_last1 AS host_4k_last,\n          total_last7,\n          audio_last7,\n          video_last7,\n          video_sd_last7,\n          video_hd_last7,\n          video_hdp_last7,\n          host_sd_last7,\n          audience_sd_last7,\n          host_hd_last7,\n          audience_hd_last7,\n          host_hdp_last7,\n          audience_hdp_last7,\n          host_audio_last7,\n          audience_audio_last7,\n          host_video_last7,\n          audience_video_last7,\n          audience_audio_low_latency_last7,\n          audience_video_low_latency_last7,\n          audience_total_low_latency_last7,\n          audience_sd_low_latency_last7,\n          audience_hd_low_latency_last7,\n          audience_hdp_low_latency_last7,\n          audience_1080p_low_latency_last7,\n          audience_2k_low_latency_last7,\n          audience_4k_low_latency_last7,\n          audience_audio_ultra_low_latency_last7,\n          audience_video_ultra_low_latency_last7,\n          audience_total_ultra_low_latency_last7,\n          audience_sd_ultra_low_latency_last7,\n          audience_hd_ultra_low_latency_last7,\n          audience_hdp_ultra_low_latency_last7,\n          audience_1080p_ultra_low_latency_last7,\n          audience_2k_ultra_low_latency_last7,\n          audience_4k_ultra_low_latency_last7,\n          audience_2k_last7,\n          audience_4k_last7,\n          audience_1080p_last7,\n          host_1080p_last7,\n          host_2k_last7,\n          host_4k_last7\n        FROM levels_usage_dod_di_11\n        WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211202 AND date <= 20211208 AND dim = 1) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 1 AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 24"
	},
	{
		"presto_sql" : "SELECT \"自定义 SQL 查询\".\"level2\" AS \"level2\"\nFROM (SELECT date,\n        CASE WHEN 11 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_11\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211202 AND date <= 20211208 AND dim = 1) AS \"自定义 SQL 查询\"\nGROUP BY 1\nORDER BY \"level2\""
	},
	{
		"presto_sql" : "SELECT \"自定义 SQL 查询\".\"level3\" AS \"level3\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"usr_Calculation_3519281700079370244_ok\"\nFROM (SELECT date,\n        CASE WHEN 11 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_11\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211202 AND date <= 20211208 AND dim = 1) AS \"自定义 SQL 查询\"\nWHERE \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 1\nGROUP BY 1"
	},
	{
		"presto_sql" : "SELECT \"自定义 SQL 查询\".\"level4\" AS \"level4\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"usr_Calculation_3519281700079370244_ok\"\nFROM (SELECT date,\n        CASE WHEN 11 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_11\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211202 AND date <= 20211208 AND dim = 1) AS \"自定义 SQL 查询\"\nWHERE \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 1 AND CAST(\"自定义 SQL 查询\".\"level3\" AS VARCHAR) = 'Framework'\nGROUP BY 1"
	},
	{
		"presto_sql" : "SELECT \"自定义 SQL 查询\".\"level1\" AS \"level1\"\nFROM (SELECT date,\n        CASE WHEN 11 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_11\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211202 AND date <= 20211208 AND dim = 1) AS \"自定义 SQL 查询\"\nGROUP BY 1\nORDER BY \"level1\""
	},
	{
		"presto_sql" : "SELECT \"自定义 SQL 查询\".\"level3\" AS \"level3\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"usr_Calculation_3519281700079370244_ok\"\nFROM (SELECT date,\n        CASE WHEN 11 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_11\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211202 AND date <= 20211208 AND dim = 1) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n            CASE WHEN 11 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n          tag,\n          area AS Scope,\n          dim,\n          level1,\n          level2,\n          level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n            CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n          total AS totalUsage,\n          audio,\n          video,\n          host_audio,\n          audience_audio,\n          host_sd,\n          host_hd,\n          host_hdp,\n          host_1080p,\n          host_2k,\n          host_4k,\n          audience_sd,\n          audience_hd,\n          audience_hdp,\n          audience_1080p,\n          audience_2k,\n          audience_4k,\n          audience_audio_low_latency,\n          audience_sd_low_latency,\n          audience_hd_low_latency,\n          audience_hdp_low_latency,\n          audience_1080p_low_latency,\n          audience_2k_low_latency,\n          audience_4k_low_latency,\n          audience_audio_ultra_low_latency,\n          audience_sd_ultra_low_latency,\n          audience_hd_ultra_low_latency,\n          audience_hdp_ultra_low_latency,\n          audience_1080p_ultra_low_latency,\n          audience_2k_ultra_low_latency,\n          audience_4k_ultra_low_latency,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n          audience_video_low_latency_last1 AS audience_video_low_latency_last,\n          audience_total_low_latency_last1 AS audience_total_low_latency_last,\n          audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n          audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n          audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n          audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n          audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n          audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n          audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n          audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n          audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n          audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n          audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n          audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n          audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n          audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n          audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n          audience_2k_last1 AS audience_2k_last,\n          audience_4k_last1 AS audience_4k_last,\n          audience_1080p_last1 AS audience_1080p_last,\n          host_1080p_last1 AS host_1080p_last,\n          host_2k_last1 AS host_2k_last,\n          host_4k_last1 AS host_4k_last,\n          total_last7,\n          audio_last7,\n          video_last7,\n          video_sd_last7,\n          video_hd_last7,\n          video_hdp_last7,\n          host_sd_last7,\n          audience_sd_last7,\n          host_hd_last7,\n          audience_hd_last7,\n          host_hdp_last7,\n          audience_hdp_last7,\n          host_audio_last7,\n          audience_audio_last7,\n          host_video_last7,\n          audience_video_last7,\n          audience_audio_low_latency_last7,\n          audience_video_low_latency_last7,\n          audience_total_low_latency_last7,\n          audience_sd_low_latency_last7,\n          audience_hd_low_latency_last7,\n          audience_hdp_low_latency_last7,\n          audience_1080p_low_latency_last7,\n          audience_2k_low_latency_last7,\n          audience_4k_low_latency_last7,\n          audience_audio_ultra_low_latency_last7,\n          audience_video_ultra_low_latency_last7,\n          audience_total_ultra_low_latency_last7,\n          audience_sd_ultra_low_latency_last7,\n          audience_hd_ultra_low_latency_last7,\n          audience_hdp_ultra_low_latency_last7,\n          audience_1080p_ultra_low_latency_last7,\n          audience_2k_ultra_low_latency_last7,\n          audience_4k_ultra_low_latency_last7,\n          audience_2k_last7,\n          audience_4k_last7,\n          audience_1080p_last7,\n          host_1080p_last7,\n          host_2k_last7,\n          host_4k_last7\n        FROM levels_usage_dod_di_11\n        WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211202 AND date <= 20211208 AND dim = 1) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 1 AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 1"
	},
	{
		"presto_sql" : "SELECT \"自定义 SQL 查询\".\"level4\" AS \"level4\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"usr_Calculation_3519281700079370244_ok\"\nFROM (SELECT date,\n        CASE WHEN 11 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_11\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211202 AND date <= 20211208 AND dim = 1) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n            CASE WHEN 11 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n          tag,\n          area AS Scope,\n          dim,\n          level1,\n          level2,\n          level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n            CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n          total AS totalUsage,\n          audio,\n          video,\n          host_audio,\n          audience_audio,\n          host_sd,\n          host_hd,\n          host_hdp,\n          host_1080p,\n          host_2k,\n          host_4k,\n          audience_sd,\n          audience_hd,\n          audience_hdp,\n          audience_1080p,\n          audience_2k,\n          audience_4k,\n          audience_audio_low_latency,\n          audience_sd_low_latency,\n          audience_hd_low_latency,\n          audience_hdp_low_latency,\n          audience_1080p_low_latency,\n          audience_2k_low_latency,\n          audience_4k_low_latency,\n          audience_audio_ultra_low_latency,\n          audience_sd_ultra_low_latency,\n          audience_hd_ultra_low_latency,\n          audience_hdp_ultra_low_latency,\n          audience_1080p_ultra_low_latency,\n          audience_2k_ultra_low_latency,\n          audience_4k_ultra_low_latency,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n          audience_video_low_latency_last1 AS audience_video_low_latency_last,\n          audience_total_low_latency_last1 AS audience_total_low_latency_last,\n          audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n          audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n          audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n          audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n          audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n          audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n          audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n          audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n          audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n          audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n          audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n          audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n          audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n          audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n          audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n          audience_2k_last1 AS audience_2k_last,\n          audience_4k_last1 AS audience_4k_last,\n          audience_1080p_last1 AS audience_1080p_last,\n          host_1080p_last1 AS host_1080p_last,\n          host_2k_last1 AS host_2k_last,\n          host_4k_last1 AS host_4k_last,\n          total_last7,\n          audio_last7,\n          video_last7,\n          video_sd_last7,\n          video_hd_last7,\n          video_hdp_last7,\n          host_sd_last7,\n          audience_sd_last7,\n          host_hd_last7,\n          audience_hd_last7,\n          host_hdp_last7,\n          audience_hdp_last7,\n          host_audio_last7,\n          audience_audio_last7,\n          host_video_last7,\n          audience_video_last7,\n          audience_audio_low_latency_last7,\n          audience_video_low_latency_last7,\n          audience_total_low_latency_last7,\n          audience_sd_low_latency_last7,\n          audience_hd_low_latency_last7,\n          audience_hdp_low_latency_last7,\n          audience_1080p_low_latency_last7,\n          audience_2k_low_latency_last7,\n          audience_4k_low_latency_last7,\n          audience_audio_ultra_low_latency_last7,\n          audience_video_ultra_low_latency_last7,\n          audience_total_ultra_low_latency_last7,\n          audience_sd_ultra_low_latency_last7,\n          audience_hd_ultra_low_latency_last7,\n          audience_hdp_ultra_low_latency_last7,\n          audience_1080p_ultra_low_latency_last7,\n          audience_2k_ultra_low_latency_last7,\n          audience_4k_ultra_low_latency_last7,\n          audience_2k_last7,\n          audience_4k_last7,\n          audience_1080p_last7,\n          host_1080p_last7,\n          host_2k_last7,\n          host_4k_last7\n        FROM levels_usage_dod_di_11\n        WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211202 AND date <= 20211208 AND dim = 1) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 1 AND CAST(\"自定义 SQL 查询\".\"level3\" AS VARCHAR) = 'Framework' AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 1"
	},
	{
		"presto_sql" : "SELECT \"自定义 SQL 查询\".\"level2\" AS \"level2\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"usr_Calculation_3519281700079370244_ok\"\nFROM (SELECT date,\n        CASE WHEN 11 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_11\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211202 AND date <= 20211208 AND dim = 1) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n            CASE WHEN 11 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n          tag,\n          area AS Scope,\n          dim,\n          level1,\n          level2,\n          level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n            CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n          total AS totalUsage,\n          audio,\n          video,\n          host_audio,\n          audience_audio,\n          host_sd,\n          host_hd,\n          host_hdp,\n          host_1080p,\n          host_2k,\n          host_4k,\n          audience_sd,\n          audience_hd,\n          audience_hdp,\n          audience_1080p,\n          audience_2k,\n          audience_4k,\n          audience_audio_low_latency,\n          audience_sd_low_latency,\n          audience_hd_low_latency,\n          audience_hdp_low_latency,\n          audience_1080p_low_latency,\n          audience_2k_low_latency,\n          audience_4k_low_latency,\n          audience_audio_ultra_low_latency,\n          audience_sd_ultra_low_latency,\n          audience_hd_ultra_low_latency,\n          audience_hdp_ultra_low_latency,\n          audience_1080p_ultra_low_latency,\n          audience_2k_ultra_low_latency,\n          audience_4k_ultra_low_latency,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n          audience_video_low_latency_last1 AS audience_video_low_latency_last,\n          audience_total_low_latency_last1 AS audience_total_low_latency_last,\n          audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n          audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n          audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n          audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n          audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n          audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n          audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n          audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n          audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n          audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n          audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n          audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n          audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n          audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n          audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n          audience_2k_last1 AS audience_2k_last,\n          audience_4k_last1 AS audience_4k_last,\n          audience_1080p_last1 AS audience_1080p_last,\n          host_1080p_last1 AS host_1080p_last,\n          host_2k_last1 AS host_2k_last,\n          host_4k_last1 AS host_4k_last,\n          total_last7,\n          audio_last7,\n          video_last7,\n          video_sd_last7,\n          video_hd_last7,\n          video_hdp_last7,\n          host_sd_last7,\n          audience_sd_last7,\n          host_hd_last7,\n          audience_hd_last7,\n          host_hdp_last7,\n          audience_hdp_last7,\n          host_audio_last7,\n          audience_audio_last7,\n          host_video_last7,\n          audience_video_last7,\n          audience_audio_low_latency_last7,\n          audience_video_low_latency_last7,\n          audience_total_low_latency_last7,\n          audience_sd_low_latency_last7,\n          audience_hd_low_latency_last7,\n          audience_hdp_low_latency_last7,\n          audience_1080p_low_latency_last7,\n          audience_2k_low_latency_last7,\n          audience_4k_low_latency_last7,\n          audience_audio_ultra_low_latency_last7,\n          audience_video_ultra_low_latency_last7,\n          audience_total_ultra_low_latency_last7,\n          audience_sd_ultra_low_latency_last7,\n          audience_hd_ultra_low_latency_last7,\n          audience_hdp_ultra_low_latency_last7,\n          audience_1080p_ultra_low_latency_last7,\n          audience_2k_ultra_low_latency_last7,\n          audience_4k_ultra_low_latency_last7,\n          audience_2k_last7,\n          audience_4k_last7,\n          audience_1080p_last7,\n          host_1080p_last7,\n          host_2k_last7,\n          host_4k_last7\n        FROM levels_usage_dod_di_11\n        WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211202 AND date <= 20211208 AND dim = 1) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 1 AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 1"
	},
	{
		"presto_sql" : "SELECT \"自定义 SQL 查询\".\"level3\" AS \"level3\"\nFROM (SELECT date,\n        CASE WHEN 11 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_11\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211202 AND date <= 20211208 AND dim = 1) AS \"自定义 SQL 查询\"\nGROUP BY 1\nORDER BY \"level3\""
	},
	{
		"presto_sql" : "SELECT \"自定义 SQL 查询\".\"product_level4\" AS \"product_level4\"\nFROM (SELECT date,\n        CASE WHEN 11 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_11\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211202 AND date <= 20211208 AND dim = 1) AS \"自定义 SQL 查询\"\nGROUP BY 1\nORDER BY \"product_level4\""
	},
	{
		"presto_sql" : "SELECT \"自定义 SQL 查询\".\"vid_use_case_cn\" AS \"vid_use_case_cn\"\nFROM (SELECT date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n      total AS totalUsage,\n      audio AS audio,\n      video AS video,\n        host_sd + audience_sd AS video_sd,\n        host_hd + audience_hd AS video_hd,\n        host_hdp + audience_hdp AS video_hdp,\n      host_audio AS host_audio,\n      audience_audio AS audience_audio,\n      host_sd AS host_sd,\n      host_hd AS host_hd,\n      host_hdp AS host_hdp,\n      audience_sd AS audience_sd,\n      audience_hd AS audience_hd,\n      audience_hdp AS audience_hdp,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      total_last7 AS total_last7,\n      audio_last7 AS audio_last7,\n      video_last7 AS video_last7,\n      video_sd_last7 AS video_sd_last7,\n      video_hd_last7 AS video_hd_last7,\n      video_hdp_last7 AS video_hdp_last7,\n      host_sd_last7 AS host_sd_last7,\n      audience_sd_last7 AS audience_sd_last7,\n      host_hd_last7 AS host_hd_last7,\n      audience_hd_last7 AS audience_hd_last7,\n      host_hdp_last7 AS host_hdp_last7,\n      audience_hdp_last7 AS audience_hdp_last7,\n      host_audio_last7 AS host_audio_last7,\n      audience_audio_last7 AS audience_audio_last7,\n      host_video_last7 AS host_video_last7,\n      audience_video_last7 AS audience_video_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211026 AND date <= 20211124 AND dim = 1 AND area IS NOT NULL AND CAST(level1 AS VARCHAR) = 'Education' AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\nGROUP BY 1\nORDER BY \"vid_use_case_cn\""
	},
	{
		"presto_sql" : "SELECT \"自定义 SQL 查询\".\"stat_date\" AS \"stat_date\",\n  \"自定义 SQL 查询\".\"vid_sector_en\" AS \"vid_sector_en\"\nFROM (SELECT date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n      total AS totalUsage,\n      audio AS audio,\n      video AS video,\n        host_sd + audience_sd AS video_sd,\n        host_hd + audience_hd AS video_hd,\n        host_hdp + audience_hdp AS video_hdp,\n      host_audio AS host_audio,\n      audience_audio AS audience_audio,\n      host_sd AS host_sd,\n      host_hd AS host_hd,\n      host_hdp AS host_hdp,\n      audience_sd AS audience_sd,\n      audience_hd AS audience_hd,\n      audience_hdp AS audience_hdp,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      total_last7 AS total_last7,\n      audio_last7 AS audio_last7,\n      video_last7 AS video_last7,\n      video_sd_last7 AS video_sd_last7,\n      video_hd_last7 AS video_hd_last7,\n      video_hdp_last7 AS video_hdp_last7,\n      host_sd_last7 AS host_sd_last7,\n      audience_sd_last7 AS audience_sd_last7,\n      host_hd_last7 AS host_hd_last7,\n      audience_hd_last7 AS audience_hd_last7,\n      host_hdp_last7 AS host_hdp_last7,\n      audience_hdp_last7 AS audience_hdp_last7,\n      host_audio_last7 AS host_audio_last7,\n      audience_audio_last7 AS audience_audio_last7,\n      host_video_last7 AS host_video_last7,\n      audience_video_last7 AS audience_video_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211026 AND date <= 20211124 AND dim = 1 AND area IS NOT NULL AND CAST(level1 AS VARCHAR) = 'Education' AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          tag,\n          area AS Scope,\n          dim,\n            CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n            CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n            CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n          total AS totalUsage,\n          audio AS audio,\n          video AS video,\n            host_sd + audience_sd AS video_sd,\n            host_hd + audience_hd AS video_hd,\n            host_hdp + audience_hdp AS video_hdp,\n          host_audio AS host_audio,\n          audience_audio AS audience_audio,\n          host_sd AS host_sd,\n          host_hd AS host_hd,\n          host_hdp AS host_hdp,\n          audience_sd AS audience_sd,\n          audience_hd AS audience_hd,\n          audience_hdp AS audience_hdp,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          total_last7 AS total_last7,\n          audio_last7 AS audio_last7,\n          video_last7 AS video_last7,\n          video_sd_last7 AS video_sd_last7,\n          video_hd_last7 AS video_hd_last7,\n          video_hdp_last7 AS video_hdp_last7,\n          host_sd_last7 AS host_sd_last7,\n          audience_sd_last7 AS audience_sd_last7,\n          host_hd_last7 AS host_hd_last7,\n          audience_hd_last7 AS audience_hd_last7,\n          host_hdp_last7 AS host_hdp_last7,\n          audience_hdp_last7 AS audience_hdp_last7,\n          host_audio_last7 AS host_audio_last7,\n          audience_audio_last7 AS audience_audio_last7,\n          host_video_last7 AS host_video_last7,\n          audience_video_last7 AS audience_video_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211026 AND date <= 20211124 AND dim = 1 AND area IS NOT NULL AND CAST(level1 AS VARCHAR) = 'Education' AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND CAST(\"自定义 SQL 查询\".\"tag\" AS VARCHAR) = 'Industry' AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 1,\n  2"
	},
	{
		"presto_sql" : "SELECT \"自定义 SQL 查询\".\"product_level2\" AS \"product_level2\"\nFROM (SELECT date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n      total AS totalUsage,\n      audio AS audio,\n      video AS video,\n        host_sd + audience_sd AS video_sd,\n        host_hd + audience_hd AS video_hd,\n        host_hdp + audience_hdp AS video_hdp,\n      host_audio AS host_audio,\n      audience_audio AS audience_audio,\n      host_sd AS host_sd,\n      host_hd AS host_hd,\n      host_hdp AS host_hdp,\n      audience_sd AS audience_sd,\n      audience_hd AS audience_hd,\n      audience_hdp AS audience_hdp,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      total_last7 AS total_last7,\n      audio_last7 AS audio_last7,\n      video_last7 AS video_last7,\n      video_sd_last7 AS video_sd_last7,\n      video_hd_last7 AS video_hd_last7,\n      video_hdp_last7 AS video_hdp_last7,\n      host_sd_last7 AS host_sd_last7,\n      audience_sd_last7 AS audience_sd_last7,\n      host_hd_last7 AS host_hd_last7,\n      audience_hd_last7 AS audience_hd_last7,\n      host_hdp_last7 AS host_hdp_last7,\n      audience_hdp_last7 AS audience_hdp_last7,\n      host_audio_last7 AS host_audio_last7,\n      audience_audio_last7 AS audience_audio_last7,\n      host_video_last7 AS host_video_last7,\n      audience_video_last7 AS audience_video_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211026 AND date <= 20211124 AND dim = 1 AND area IS NOT NULL AND CAST(level1 AS VARCHAR) = 'Education' AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\nGROUP BY 1\nLIMIT 32"
	},
	{
		"presto_sql" : "SELECT \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  \"自定义 SQL 查询\".\"stat_date\" AS \"stat_date\"\nFROM (SELECT date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n      total AS totalUsage,\n      audio AS audio,\n      video AS video,\n        host_sd + audience_sd AS video_sd,\n        host_hd + audience_hd AS video_hd,\n        host_hdp + audience_hdp AS video_hdp,\n      host_audio AS host_audio,\n      audience_audio AS audience_audio,\n      host_sd AS host_sd,\n      host_hd AS host_hd,\n      host_hdp AS host_hdp,\n      audience_sd AS audience_sd,\n      audience_hd AS audience_hd,\n      audience_hdp AS audience_hdp,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      total_last7 AS total_last7,\n      audio_last7 AS audio_last7,\n      video_last7 AS video_last7,\n      video_sd_last7 AS video_sd_last7,\n      video_hd_last7 AS video_hd_last7,\n      video_hdp_last7 AS video_hdp_last7,\n      host_sd_last7 AS host_sd_last7,\n      audience_sd_last7 AS audience_sd_last7,\n      host_hd_last7 AS host_hd_last7,\n      audience_hd_last7 AS audience_hd_last7,\n      host_hdp_last7 AS host_hdp_last7,\n      audience_hdp_last7 AS audience_hdp_last7,\n      host_audio_last7 AS host_audio_last7,\n      audience_audio_last7 AS audience_audio_last7,\n      host_video_last7 AS host_video_last7,\n      audience_video_last7 AS audience_video_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211026 AND date <= 20211124 AND dim = 1 AND area IS NOT NULL AND CAST(level1 AS VARCHAR) = 'Education' AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          tag,\n          area AS Scope,\n          dim,\n            CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n            CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n            CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n          total AS totalUsage,\n          audio AS audio,\n          video AS video,\n            host_sd + audience_sd AS video_sd,\n            host_hd + audience_hd AS video_hd,\n            host_hdp + audience_hdp AS video_hdp,\n          host_audio AS host_audio,\n          audience_audio AS audience_audio,\n          host_sd AS host_sd,\n          host_hd AS host_hd,\n          host_hdp AS host_hdp,\n          audience_sd AS audience_sd,\n          audience_hd AS audience_hd,\n          audience_hdp AS audience_hdp,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          total_last7 AS total_last7,\n          audio_last7 AS audio_last7,\n          video_last7 AS video_last7,\n          video_sd_last7 AS video_sd_last7,\n          video_hd_last7 AS video_hd_last7,\n          video_hdp_last7 AS video_hdp_last7,\n          host_sd_last7 AS host_sd_last7,\n          audience_sd_last7 AS audience_sd_last7,\n          host_hd_last7 AS host_hd_last7,\n          audience_hd_last7 AS audience_hd_last7,\n          host_hdp_last7 AS host_hdp_last7,\n          audience_hdp_last7 AS audience_hdp_last7,\n          host_audio_last7 AS host_audio_last7,\n          audience_audio_last7 AS audience_audio_last7,\n          host_video_last7 AS host_video_last7,\n          audience_video_last7 AS audience_video_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211026 AND date <= 20211124 AND dim = 1 AND area IS NOT NULL AND CAST(level1 AS VARCHAR) = 'Education' AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND CAST(\"自定义 SQL 查询\".\"tag\" AS VARCHAR) = 'Industry' AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 1,\n  2"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"audio_last7\") AS \"TEMP(Calculation_96897765680816128)(2589233512)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_96897765680816128)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(audio同比 (复制)_96897765681725441)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video_last7\") AS \"TEMP(audio同比 (复制)_96897765681725441)(4107040267)(0)\",\n  \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"audio_video_last\") AS \"sum_audio_video_last_ok\"\nFROM (SELECT date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n      total AS totalUsage,\n      audio AS audio,\n      video AS video,\n        host_sd + audience_sd AS video_sd,\n        host_hd + audience_hd AS video_hd,\n        host_hdp + audience_hdp AS video_hdp,\n      host_audio AS host_audio,\n      audience_audio AS audience_audio,\n      host_sd AS host_sd,\n      host_hd AS host_hd,\n      host_hdp AS host_hdp,\n      audience_sd AS audience_sd,\n      audience_hd AS audience_hd,\n      audience_hdp AS audience_hdp,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      total_last7 AS total_last7,\n      audio_last7 AS audio_last7,\n      video_last7 AS video_last7,\n      video_sd_last7 AS video_sd_last7,\n      video_hd_last7 AS video_hd_last7,\n      video_hdp_last7 AS video_hdp_last7,\n      host_sd_last7 AS host_sd_last7,\n      audience_sd_last7 AS audience_sd_last7,\n      host_hd_last7 AS host_hd_last7,\n      audience_hd_last7 AS audience_hd_last7,\n      host_hdp_last7 AS host_hdp_last7,\n      audience_hdp_last7 AS audience_hdp_last7,\n      host_audio_last7 AS host_audio_last7,\n      audience_audio_last7 AS audience_audio_last7,\n      host_video_last7 AS host_video_last7,\n      audience_video_last7 AS audience_video_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211026 AND date <= 20211124 AND dim = 1 AND area IS NOT NULL AND CAST(level1 AS VARCHAR) = 'Education' AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          tag,\n          area AS Scope,\n          dim,\n            CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n            CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n            CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n          total AS totalUsage,\n          audio AS audio,\n          video AS video,\n            host_sd + audience_sd AS video_sd,\n            host_hd + audience_hd AS video_hd,\n            host_hdp + audience_hdp AS video_hdp,\n          host_audio AS host_audio,\n          audience_audio AS audience_audio,\n          host_sd AS host_sd,\n          host_hd AS host_hd,\n          host_hdp AS host_hdp,\n          audience_sd AS audience_sd,\n          audience_hd AS audience_hd,\n          audience_hdp AS audience_hdp,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          total_last7 AS total_last7,\n          audio_last7 AS audio_last7,\n          video_last7 AS video_last7,\n          video_sd_last7 AS video_sd_last7,\n          video_hd_last7 AS video_hd_last7,\n          video_hdp_last7 AS video_hdp_last7,\n          host_sd_last7 AS host_sd_last7,\n          audience_sd_last7 AS audience_sd_last7,\n          host_hd_last7 AS host_hd_last7,\n          audience_hd_last7 AS audience_hd_last7,\n          host_hdp_last7 AS host_hdp_last7,\n          audience_hdp_last7 AS audience_hdp_last7,\n          host_audio_last7 AS host_audio_last7,\n          audience_audio_last7 AS audience_audio_last7,\n          host_video_last7 AS host_video_last7,\n          audience_video_last7 AS audience_video_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211026 AND date <= 20211124 AND dim = 1 AND area IS NOT NULL AND CAST(level1 AS VARCHAR) = 'Education' AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND CAST(\"自定义 SQL 查询\".\"tag\" AS VARCHAR) = 'Industry' AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 5"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"total_last7\") AS \"TEMP(video同比 (复制)_96897765683347458)(346677966)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(video同比 (复制)_96897765683347458)(3847882359)(0)\",\n  \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"audio_video_last\") AS \"sum_audio_video_last_ok\"\nFROM (SELECT date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n      total AS totalUsage,\n      audio AS audio,\n      video AS video,\n        host_sd + audience_sd AS video_sd,\n        host_hd + audience_hd AS video_hd,\n        host_hdp + audience_hdp AS video_hdp,\n      host_audio AS host_audio,\n      audience_audio AS audience_audio,\n      host_sd AS host_sd,\n      host_hd AS host_hd,\n      host_hdp AS host_hdp,\n      audience_sd AS audience_sd,\n      audience_hd AS audience_hd,\n      audience_hdp AS audience_hdp,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      total_last7 AS total_last7,\n      audio_last7 AS audio_last7,\n      video_last7 AS video_last7,\n      video_sd_last7 AS video_sd_last7,\n      video_hd_last7 AS video_hd_last7,\n      video_hdp_last7 AS video_hdp_last7,\n      host_sd_last7 AS host_sd_last7,\n      audience_sd_last7 AS audience_sd_last7,\n      host_hd_last7 AS host_hd_last7,\n      audience_hd_last7 AS audience_hd_last7,\n      host_hdp_last7 AS host_hdp_last7,\n      audience_hdp_last7 AS audience_hdp_last7,\n      host_audio_last7 AS host_audio_last7,\n      audience_audio_last7 AS audience_audio_last7,\n      host_video_last7 AS host_video_last7,\n      audience_video_last7 AS audience_video_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211026 AND date <= 20211124 AND dim = 1 AND area IS NOT NULL AND CAST(level1 AS VARCHAR) = 'Education' AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          tag,\n          area AS Scope,\n          dim,\n            CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n            CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n            CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n          total AS totalUsage,\n          audio AS audio,\n          video AS video,\n            host_sd + audience_sd AS video_sd,\n            host_hd + audience_hd AS video_hd,\n            host_hdp + audience_hdp AS video_hdp,\n          host_audio AS host_audio,\n          audience_audio AS audience_audio,\n          host_sd AS host_sd,\n          host_hd AS host_hd,\n          host_hdp AS host_hdp,\n          audience_sd AS audience_sd,\n          audience_hd AS audience_hd,\n          audience_hdp AS audience_hdp,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          total_last7 AS total_last7,\n          audio_last7 AS audio_last7,\n          video_last7 AS video_last7,\n          video_sd_last7 AS video_sd_last7,\n          video_hd_last7 AS video_hd_last7,\n          video_hdp_last7 AS video_hdp_last7,\n          host_sd_last7 AS host_sd_last7,\n          audience_sd_last7 AS audience_sd_last7,\n          host_hd_last7 AS host_hd_last7,\n          audience_hd_last7 AS audience_hd_last7,\n          host_hdp_last7 AS host_hdp_last7,\n          audience_hdp_last7 AS audience_hdp_last7,\n          host_audio_last7 AS host_audio_last7,\n          audience_audio_last7 AS audience_audio_last7,\n          host_video_last7 AS host_video_last7,\n          audience_video_last7 AS audience_video_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211026 AND date <= 20211124 AND dim = 1 AND area IS NOT NULL AND CAST(level1 AS VARCHAR) = 'Education' AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND CAST(\"自定义 SQL 查询\".\"tag\" AS VARCHAR) = 'Industry' AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 3"
	},
	{
		"presto_sql" : "SELECT \"自定义 SQL 查询\".\"product_level3\" AS \"product_level3\"\nFROM (SELECT date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n      total AS totalUsage,\n      audio AS audio,\n      video AS video,\n        host_sd + audience_sd AS video_sd,\n        host_hd + audience_hd AS video_hd,\n        host_hdp + audience_hdp AS video_hdp,\n      host_audio AS host_audio,\n      audience_audio AS audience_audio,\n      host_sd AS host_sd,\n      host_hd AS host_hd,\n      host_hdp AS host_hdp,\n      audience_sd AS audience_sd,\n      audience_hd AS audience_hd,\n      audience_hdp AS audience_hdp,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      total_last7 AS total_last7,\n      audio_last7 AS audio_last7,\n      video_last7 AS video_last7,\n      video_sd_last7 AS video_sd_last7,\n      video_hd_last7 AS video_hd_last7,\n      video_hdp_last7 AS video_hdp_last7,\n      host_sd_last7 AS host_sd_last7,\n      audience_sd_last7 AS audience_sd_last7,\n      host_hd_last7 AS host_hd_last7,\n      audience_hd_last7 AS audience_hd_last7,\n      host_hdp_last7 AS host_hdp_last7,\n      audience_hdp_last7 AS audience_hdp_last7,\n      host_audio_last7 AS host_audio_last7,\n      audience_audio_last7 AS audience_audio_last7,\n      host_video_last7 AS host_video_last7,\n      audience_video_last7 AS audience_video_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211026 AND date <= 20211124 AND dim = 1 AND area IS NOT NULL AND CAST(level1 AS VARCHAR) = 'Education' AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\nGROUP BY 1\nLIMIT 64"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  MIN(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(1482809429)(0)\",\n  MAX(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(3765460736)(0)\",\n  \"自定义 SQL 查询\".\"stat_date\" AS \"TEMP(attr_stat_date_nk)(2102638629)(0)\",\n  \"自定义 SQL 查询\".\"stat_date\" AS \"TEMP(attr_stat_date_nk)(2790680713)(0)\",\n  \"自定义 SQL 查询\".\"stat_date\" AS \"stat_date\"\nFROM (SELECT date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n      total AS totalUsage,\n      audio AS audio,\n      video AS video,\n        host_sd + audience_sd AS video_sd,\n        host_hd + audience_hd AS video_hd,\n        host_hdp + audience_hdp AS video_hdp,\n      host_audio AS host_audio,\n      audience_audio AS audience_audio,\n      host_sd AS host_sd,\n      host_hd AS host_hd,\n      host_hdp AS host_hdp,\n      audience_sd AS audience_sd,\n      audience_hd AS audience_hd,\n      audience_hdp AS audience_hdp,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      total_last7 AS total_last7,\n      audio_last7 AS audio_last7,\n      video_last7 AS video_last7,\n      video_sd_last7 AS video_sd_last7,\n      video_hd_last7 AS video_hd_last7,\n      video_hdp_last7 AS video_hdp_last7,\n      host_sd_last7 AS host_sd_last7,\n      audience_sd_last7 AS audience_sd_last7,\n      host_hd_last7 AS host_hd_last7,\n      audience_hd_last7 AS audience_hd_last7,\n      host_hdp_last7 AS host_hdp_last7,\n      audience_hdp_last7 AS audience_hdp_last7,\n      host_audio_last7 AS host_audio_last7,\n      audience_audio_last7 AS audience_audio_last7,\n      host_video_last7 AS host_video_last7,\n      audience_video_last7 AS audience_video_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211026 AND date <= 20211124 AND dim = 1 AND area IS NOT NULL AND CAST(level1 AS VARCHAR) = 'Education' AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND CAST(\"自定义 SQL 查询\".\"tag\" AS VARCHAR) = 'Industry'\nGROUP BY 14"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3054707207061430272)(2629536046)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_video_last\") AS \"TEMP(Calculation_3054707207061430272)(2820618408)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(日环比 (复制 2)_96897765685432324)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_last\") AS \"TEMP(日环比 (复制 2)_96897765685432324)(4091190060)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(日环比 (复制)_96897765685424131)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video_last\") AS \"TEMP(日环比 (复制)_96897765685424131)(3934387163)(0)\",\n  \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"sum_audio_ok\",\n  SUM(\"自定义 SQL 查询\".\"audio_video_last\") AS \"sum_audio_video_last_ok\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"sum_video_ok\"\nFROM (SELECT date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n      total AS totalUsage,\n      audio AS audio,\n      video AS video,\n        host_sd + audience_sd AS video_sd,\n        host_hd + audience_hd AS video_hd,\n        host_hdp + audience_hdp AS video_hdp,\n      host_audio AS host_audio,\n      audience_audio AS audience_audio,\n      host_sd AS host_sd,\n      host_hd AS host_hd,\n      host_hdp AS host_hdp,\n      audience_sd AS audience_sd,\n      audience_hd AS audience_hd,\n      audience_hdp AS audience_hdp,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      total_last7 AS total_last7,\n      audio_last7 AS audio_last7,\n      video_last7 AS video_last7,\n      video_sd_last7 AS video_sd_last7,\n      video_hd_last7 AS video_hd_last7,\n      video_hdp_last7 AS video_hdp_last7,\n      host_sd_last7 AS host_sd_last7,\n      audience_sd_last7 AS audience_sd_last7,\n      host_hd_last7 AS host_hd_last7,\n      audience_hd_last7 AS audience_hd_last7,\n      host_hdp_last7 AS host_hdp_last7,\n      audience_hdp_last7 AS audience_hdp_last7,\n      host_audio_last7 AS host_audio_last7,\n      audience_audio_last7 AS audience_audio_last7,\n      host_video_last7 AS host_video_last7,\n      audience_video_last7 AS audience_video_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211026 AND date <= 20211124 AND dim = 1 AND area IS NOT NULL AND CAST(level1 AS VARCHAR) = 'Education' AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          tag,\n          area AS Scope,\n          dim,\n            CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n            CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n            CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n          total AS totalUsage,\n          audio AS audio,\n          video AS video,\n            host_sd + audience_sd AS video_sd,\n            host_hd + audience_hd AS video_hd,\n            host_hdp + audience_hdp AS video_hdp,\n          host_audio AS host_audio,\n          audience_audio AS audience_audio,\n          host_sd AS host_sd,\n          host_hd AS host_hd,\n          host_hdp AS host_hdp,\n          audience_sd AS audience_sd,\n          audience_hd AS audience_hd,\n          audience_hdp AS audience_hdp,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          total_last7 AS total_last7,\n          audio_last7 AS audio_last7,\n          video_last7 AS video_last7,\n          video_sd_last7 AS video_sd_last7,\n          video_hd_last7 AS video_hd_last7,\n          video_hdp_last7 AS video_hdp_last7,\n          host_sd_last7 AS host_sd_last7,\n          audience_sd_last7 AS audience_sd_last7,\n          host_hd_last7 AS host_hd_last7,\n          audience_hd_last7 AS audience_hd_last7,\n          host_hdp_last7 AS host_hdp_last7,\n          audience_hdp_last7 AS audience_hdp_last7,\n          host_audio_last7 AS host_audio_last7,\n          audience_audio_last7 AS audience_audio_last7,\n          host_video_last7 AS host_video_last7,\n          audience_video_last7 AS audience_video_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211026 AND date <= 20211124 AND dim = 1 AND area IS NOT NULL AND CAST(level1 AS VARCHAR) = 'Education' AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND CAST(\"自定义 SQL 查询\".\"tag\" AS VARCHAR) = 'Industry' AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 7"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  MIN(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(1482809429)(0)\",\n  MAX(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(3765460736)(0)\",\n  MAX(\"自定义 SQL 查询\".\"stat_date\") AS \"TEMP(attr_stat_date_nk)(2102638629)(0)\",\n  MIN(\"自定义 SQL 查询\".\"stat_date\") AS \"TEMP(attr_stat_date_nk)(2790680713)(0)\",\n  DATE_ADD('SECOND', 0, date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"tdy_date_ok\",\n  \"自定义 SQL 查询\".\"vid_sector_en\" AS \"vid_sector_en\"\nFROM (SELECT date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n      total AS totalUsage,\n      audio AS audio,\n      video AS video,\n        host_sd + audience_sd AS video_sd,\n        host_hd + audience_hd AS video_hd,\n        host_hdp + audience_hdp AS video_hdp,\n      host_audio AS host_audio,\n      audience_audio AS audience_audio,\n      host_sd AS host_sd,\n      host_hd AS host_hd,\n      host_hdp AS host_hdp,\n      audience_sd AS audience_sd,\n      audience_hd AS audience_hd,\n      audience_hdp AS audience_hdp,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      total_last7 AS total_last7,\n      audio_last7 AS audio_last7,\n      video_last7 AS video_last7,\n      video_sd_last7 AS video_sd_last7,\n      video_hd_last7 AS video_hd_last7,\n      video_hdp_last7 AS video_hdp_last7,\n      host_sd_last7 AS host_sd_last7,\n      audience_sd_last7 AS audience_sd_last7,\n      host_hd_last7 AS host_hd_last7,\n      audience_hd_last7 AS audience_hd_last7,\n      host_hdp_last7 AS host_hdp_last7,\n      audience_hdp_last7 AS audience_hdp_last7,\n      host_audio_last7 AS host_audio_last7,\n      audience_audio_last7 AS audience_audio_last7,\n      host_video_last7 AS host_video_last7,\n      audience_video_last7 AS audience_video_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211026 AND date <= 20211124 AND dim = 1 AND area IS NOT NULL AND CAST(level1 AS VARCHAR) = 'Education' AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND CAST(\"自定义 SQL 查询\".\"tag\" AS VARCHAR) = 'Industry'\nGROUP BY 16,\n  17"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  MIN(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(1482809429)(0)\",\n  MAX(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(3765460736)(0)\",\n  MAX(\"自定义 SQL 查询\".\"stat_date\") AS \"TEMP(attr_stat_date_nk)(2102638629)(0)\",\n  MIN(\"自定义 SQL 查询\".\"stat_date\") AS \"TEMP(attr_stat_date_nk)(2790680713)(0)\",\n  DATE_ADD('SECOND', 0, date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"tdy_date_ok\",\n  \"自定义 SQL 查询\".\"vid_use_case_cn\" AS \"vid_use_case_cn\"\nFROM (SELECT date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n      total AS totalUsage,\n      audio AS audio,\n      video AS video,\n        host_sd + audience_sd AS video_sd,\n        host_hd + audience_hd AS video_hd,\n        host_hdp + audience_hdp AS video_hdp,\n      host_audio AS host_audio,\n      audience_audio AS audience_audio,\n      host_sd AS host_sd,\n      host_hd AS host_hd,\n      host_hdp AS host_hdp,\n      audience_sd AS audience_sd,\n      audience_hd AS audience_hd,\n      audience_hdp AS audience_hdp,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      total_last7 AS total_last7,\n      audio_last7 AS audio_last7,\n      video_last7 AS video_last7,\n      video_sd_last7 AS video_sd_last7,\n      video_hd_last7 AS video_hd_last7,\n      video_hdp_last7 AS video_hdp_last7,\n      host_sd_last7 AS host_sd_last7,\n      audience_sd_last7 AS audience_sd_last7,\n      host_hd_last7 AS host_hd_last7,\n      audience_hd_last7 AS audience_hd_last7,\n      host_hdp_last7 AS host_hdp_last7,\n      audience_hdp_last7 AS audience_hdp_last7,\n      host_audio_last7 AS host_audio_last7,\n      audience_audio_last7 AS audience_audio_last7,\n      host_video_last7 AS host_video_last7,\n      audience_video_last7 AS audience_video_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211026 AND date <= 20211124 AND dim = 1 AND area IS NOT NULL AND CAST(level1 AS VARCHAR) = 'Education' AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND CAST(\"自定义 SQL 查询\".\"tag\" AS VARCHAR) = 'Industry'\nGROUP BY 16,\n  17"
	},
	{
		"presto_sql" : "SELECT \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  \"自定义 SQL 查询\".\"stat_date\" AS \"stat_date\"\nFROM (SELECT date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n      total AS totalUsage,\n      audio AS audio,\n      video AS video,\n        host_sd + audience_sd AS video_sd,\n        host_hd + audience_hd AS video_hd,\n        host_hdp + audience_hdp AS video_hdp,\n      host_audio AS host_audio,\n      audience_audio AS audience_audio,\n      host_sd AS host_sd,\n      host_hd AS host_hd,\n      host_hdp AS host_hdp,\n      audience_sd AS audience_sd,\n      audience_hd AS audience_hd,\n      audience_hdp AS audience_hdp,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      total_last7 AS total_last7,\n      audio_last7 AS audio_last7,\n      video_last7 AS video_last7,\n      video_sd_last7 AS video_sd_last7,\n      video_hd_last7 AS video_hd_last7,\n      video_hdp_last7 AS video_hdp_last7,\n      host_sd_last7 AS host_sd_last7,\n      audience_sd_last7 AS audience_sd_last7,\n      host_hd_last7 AS host_hd_last7,\n      audience_hd_last7 AS audience_hd_last7,\n      host_hdp_last7 AS host_hdp_last7,\n      audience_hdp_last7 AS audience_hdp_last7,\n      host_audio_last7 AS host_audio_last7,\n      audience_audio_last7 AS audience_audio_last7,\n      host_video_last7 AS host_video_last7,\n      audience_video_last7 AS audience_video_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211026 AND date <= 20211124 AND dim = 1 AND area IS NOT NULL AND CAST(level1 AS VARCHAR) = 'Education' AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          tag,\n          area AS Scope,\n          dim,\n            CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n            CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n            CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n          total AS totalUsage,\n          audio AS audio,\n          video AS video,\n            host_sd + audience_sd AS video_sd,\n            host_hd + audience_hd AS video_hd,\n            host_hdp + audience_hdp AS video_hdp,\n          host_audio AS host_audio,\n          audience_audio AS audience_audio,\n          host_sd AS host_sd,\n          host_hd AS host_hd,\n          host_hdp AS host_hdp,\n          audience_sd AS audience_sd,\n          audience_hd AS audience_hd,\n          audience_hdp AS audience_hdp,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          total_last7 AS total_last7,\n          audio_last7 AS audio_last7,\n          video_last7 AS video_last7,\n          video_sd_last7 AS video_sd_last7,\n          video_hd_last7 AS video_hd_last7,\n          video_hdp_last7 AS video_hdp_last7,\n          host_sd_last7 AS host_sd_last7,\n          audience_sd_last7 AS audience_sd_last7,\n          host_hd_last7 AS host_hd_last7,\n          audience_hd_last7 AS audience_hd_last7,\n          host_hdp_last7 AS host_hdp_last7,\n          audience_hdp_last7 AS audience_hdp_last7,\n          host_audio_last7 AS host_audio_last7,\n          audience_audio_last7 AS audience_audio_last7,\n          host_video_last7 AS host_video_last7,\n          audience_video_last7 AS audience_video_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211026 AND date <= 20211124 AND dim = 1 AND area IS NOT NULL AND CAST(level1 AS VARCHAR) = 'Education' AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND CAST(\"自定义 SQL 查询\".\"tag\" AS VARCHAR) = 'Industry' AND \"自定义 SQL 查询\".\"vid_use_case_cn\" NOT IN ('MR Education') AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 1,\n  2"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  \"自定义 SQL 查询\".\"product_line\" AS \"product_line\",\n  DATE_ADD('SECOND', 0, date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"tdy_date_ok\"\nFROM (SELECT date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n      total AS totalUsage,\n      audio AS audio,\n      video AS video,\n        host_sd + audience_sd AS video_sd,\n        host_hd + audience_hd AS video_hd,\n        host_hdp + audience_hdp AS video_hdp,\n      host_audio AS host_audio,\n      audience_audio AS audience_audio,\n      host_sd AS host_sd,\n      host_hd AS host_hd,\n      host_hdp AS host_hdp,\n      audience_sd AS audience_sd,\n      audience_hd AS audience_hd,\n      audience_hdp AS audience_hdp,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      total_last7 AS total_last7,\n      audio_last7 AS audio_last7,\n      video_last7 AS video_last7,\n      video_sd_last7 AS video_sd_last7,\n      video_hd_last7 AS video_hd_last7,\n      video_hdp_last7 AS video_hdp_last7,\n      host_sd_last7 AS host_sd_last7,\n      audience_sd_last7 AS audience_sd_last7,\n      host_hd_last7 AS host_hd_last7,\n      audience_hd_last7 AS audience_hd_last7,\n      host_hdp_last7 AS host_hdp_last7,\n      audience_hdp_last7 AS audience_hdp_last7,\n      host_audio_last7 AS host_audio_last7,\n      audience_audio_last7 AS audience_audio_last7,\n      host_video_last7 AS host_video_last7,\n      audience_video_last7 AS audience_video_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211026 AND date <= 20211124 AND dim = 1 AND area IS NOT NULL AND CAST(level1 AS VARCHAR) = 'Education' AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1\nGROUP BY 12,\n  13"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  MIN(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(1482809429)(0)\",\n  MAX(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(3765460736)(0)\",\n  MAX(\"自定义 SQL 查询\".\"stat_date\") AS \"TEMP(attr_stat_date_nk)(2102638629)(0)\",\n  MIN(\"自定义 SQL 查询\".\"stat_date\") AS \"TEMP(attr_stat_date_nk)(2790680713)(0)\",\n  \"自定义 SQL 查询\".\"product_level2\" AS \"product_level2\",\n  DATE_ADD('SECOND', 0, date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"tdy_date_ok\"\nFROM (SELECT date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n      total AS totalUsage,\n      audio AS audio,\n      video AS video,\n        host_sd + audience_sd AS video_sd,\n        host_hd + audience_hd AS video_hd,\n        host_hdp + audience_hdp AS video_hdp,\n      host_audio AS host_audio,\n      audience_audio AS audience_audio,\n      host_sd AS host_sd,\n      host_hd AS host_hd,\n      host_hdp AS host_hdp,\n      audience_sd AS audience_sd,\n      audience_hd AS audience_hd,\n      audience_hdp AS audience_hdp,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      total_last7 AS total_last7,\n      audio_last7 AS audio_last7,\n      video_last7 AS video_last7,\n      video_sd_last7 AS video_sd_last7,\n      video_hd_last7 AS video_hd_last7,\n      video_hdp_last7 AS video_hdp_last7,\n      host_sd_last7 AS host_sd_last7,\n      audience_sd_last7 AS audience_sd_last7,\n      host_hd_last7 AS host_hd_last7,\n      audience_hd_last7 AS audience_hd_last7,\n      host_hdp_last7 AS host_hdp_last7,\n      audience_hdp_last7 AS audience_hdp_last7,\n      host_audio_last7 AS host_audio_last7,\n      audience_audio_last7 AS audience_audio_last7,\n      host_video_last7 AS host_video_last7,\n      audience_video_last7 AS audience_video_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211026 AND date <= 20211124 AND dim = 1 AND area IS NOT NULL AND CAST(level1 AS VARCHAR) = 'Education' AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND CAST(\"自定义 SQL 查询\".\"tag\" AS VARCHAR) = 'Industry'\nGROUP BY 16,\n  17"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  MIN(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(1482809429)(0)\",\n  MAX(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(3765460736)(0)\",\n  MAX(\"自定义 SQL 查询\".\"stat_date\") AS \"TEMP(attr_stat_date_nk)(2102638629)(0)\",\n  MIN(\"自定义 SQL 查询\".\"stat_date\") AS \"TEMP(attr_stat_date_nk)(2790680713)(0)\",\n  \"自定义 SQL 查询\".\"product_level3\" AS \"product_level3\",\n  DATE_ADD('SECOND', 0, date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"tdy_date_ok\"\nFROM (SELECT date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n      total AS totalUsage,\n      audio AS audio,\n      video AS video,\n        host_sd + audience_sd AS video_sd,\n        host_hd + audience_hd AS video_hd,\n        host_hdp + audience_hdp AS video_hdp,\n      host_audio AS host_audio,\n      audience_audio AS audience_audio,\n      host_sd AS host_sd,\n      host_hd AS host_hd,\n      host_hdp AS host_hdp,\n      audience_sd AS audience_sd,\n      audience_hd AS audience_hd,\n      audience_hdp AS audience_hdp,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      total_last7 AS total_last7,\n      audio_last7 AS audio_last7,\n      video_last7 AS video_last7,\n      video_sd_last7 AS video_sd_last7,\n      video_hd_last7 AS video_hd_last7,\n      video_hdp_last7 AS video_hdp_last7,\n      host_sd_last7 AS host_sd_last7,\n      audience_sd_last7 AS audience_sd_last7,\n      host_hd_last7 AS host_hd_last7,\n      audience_hd_last7 AS audience_hd_last7,\n      host_hdp_last7 AS host_hdp_last7,\n      audience_hdp_last7 AS audience_hdp_last7,\n      host_audio_last7 AS host_audio_last7,\n      audience_audio_last7 AS audience_audio_last7,\n      host_video_last7 AS host_video_last7,\n      audience_video_last7 AS audience_video_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211026 AND date <= 20211124 AND dim = 1 AND area IS NOT NULL AND CAST(level1 AS VARCHAR) = 'Education' AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND CAST(\"自定义 SQL 查询\".\"tag\" AS VARCHAR) = 'Industry'\nGROUP BY 16,\n  17"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  MIN(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(1482809429)(0)\",\n  MAX(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(3765460736)(0)\",\n  \"自定义 SQL 查询\".\"product_level3\" AS \"TEMP(attr_product_level3_nk)(1428376059)(0)\",\n  \"自定义 SQL 查询\".\"product_level3\" AS \"TEMP(attr_product_level3_nk)(3667766967)(0)\",\n  \"自定义 SQL 查询\".\"product_level3\" AS \"product_level3\",\n  \"自定义 SQL 查询\".\"stat_date\" AS \"stat_date\"\nFROM (SELECT date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n      total AS totalUsage,\n      audio AS audio,\n      video AS video,\n        host_sd + audience_sd AS video_sd,\n        host_hd + audience_hd AS video_hd,\n        host_hdp + audience_hdp AS video_hdp,\n      host_audio AS host_audio,\n      audience_audio AS audience_audio,\n      host_sd AS host_sd,\n      host_hd AS host_hd,\n      host_hdp AS host_hdp,\n      audience_sd AS audience_sd,\n      audience_hd AS audience_hd,\n      audience_hdp AS audience_hdp,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      total_last7 AS total_last7,\n      audio_last7 AS audio_last7,\n      video_last7 AS video_last7,\n      video_sd_last7 AS video_sd_last7,\n      video_hd_last7 AS video_hd_last7,\n      video_hdp_last7 AS video_hdp_last7,\n      host_sd_last7 AS host_sd_last7,\n      audience_sd_last7 AS audience_sd_last7,\n      host_hd_last7 AS host_hd_last7,\n      audience_hd_last7 AS audience_hd_last7,\n      host_hdp_last7 AS host_hdp_last7,\n      audience_hdp_last7 AS audience_hdp_last7,\n      host_audio_last7 AS host_audio_last7,\n      audience_audio_last7 AS audience_audio_last7,\n      host_video_last7 AS host_video_last7,\n      audience_video_last7 AS audience_video_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211026 AND date <= 20211124 AND dim = 1 AND area IS NOT NULL AND CAST(level1 AS VARCHAR) = 'Education' AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          tag,\n          area AS Scope,\n          dim,\n            CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n            CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n            CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n          total AS totalUsage,\n          audio AS audio,\n          video AS video,\n            host_sd + audience_sd AS video_sd,\n            host_hd + audience_hd AS video_hd,\n            host_hdp + audience_hdp AS video_hdp,\n          host_audio AS host_audio,\n          audience_audio AS audience_audio,\n          host_sd AS host_sd,\n          host_hd AS host_hd,\n          host_hdp AS host_hdp,\n          audience_sd AS audience_sd,\n          audience_hd AS audience_hd,\n          audience_hdp AS audience_hdp,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          total_last7 AS total_last7,\n          audio_last7 AS audio_last7,\n          video_last7 AS video_last7,\n          video_sd_last7 AS video_sd_last7,\n          video_hd_last7 AS video_hd_last7,\n          video_hdp_last7 AS video_hdp_last7,\n          host_sd_last7 AS host_sd_last7,\n          audience_sd_last7 AS audience_sd_last7,\n          host_hd_last7 AS host_hd_last7,\n          audience_hd_last7 AS audience_hd_last7,\n          host_hdp_last7 AS host_hdp_last7,\n          audience_hdp_last7 AS audience_hdp_last7,\n          host_audio_last7 AS host_audio_last7,\n          audience_audio_last7 AS audience_audio_last7,\n          host_video_last7 AS host_video_last7,\n          audience_video_last7 AS audience_video_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211026 AND date <= 20211124 AND dim = 1 AND area IS NOT NULL AND CAST(level1 AS VARCHAR) = 'Education' AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND CAST(\"自定义 SQL 查询\".\"tag\" AS VARCHAR) = 'Industry' AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 14,\n  17"
	},
	{
		"presto_sql" : "SELECT \"t0\".\"TEMP(Calculation_3519281700079370244)(1133678835)(0)\" AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  \"t0\".\"TEMP(Calculation_3519281700079370244)(276907208)(0)\" AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  \"t0\".\"TEMP(Calculation_3519281700079370244)(2929708110)(0)\" AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  \"t0\".\"TEMP(Calculation_3519281700079370244)(2930728935)(0)\" AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  \"t0\".\"TEMP(Calculation_3519281700079370244)(3010533957)(0)\" AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  \"t0\".\"TEMP(Calculation_3519281700079370244)(30306054)(0)\" AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  \"t0\".\"TEMP(Calculation_3519281700079370244)(3087054365)(0)\" AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  \"t0\".\"TEMP(Calculation_3519281700079370244)(3299350010)(0)\" AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  \"t0\".\"sum_totalUsage_ok\" AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  \"t0\".\"TEMP(Calculation_3519281700079370244)(4109514392)(0)\" AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  \"t0\".\"TEMP(Calculation_3519281700079370244)(709512178)(0)\" AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  \"t0\".\"level1\" AS \"level1\",\n  \"t3\".\"__measure__0\" AS \"sum_Calculation_4164281609521332225_ok\",\n  \"t0\".\"sum_totalUsage_ok\" AS \"sum_totalUsage_ok\"\nFROM (SELECT \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n      SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n      SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n      SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n      SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n      SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n      SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n      SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n      SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n      SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n      SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n      SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"sum_totalUsage_ok\"\n    FROM (SELECT date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          tag,\n          area AS Scope,\n          dim,\n            CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n            CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n            CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n          total AS totalUsage,\n          audio AS audio,\n          video AS video,\n            host_sd + audience_sd AS video_sd,\n            host_hd + audience_hd AS video_hd,\n            host_hdp + audience_hdp AS video_hdp,\n          host_audio AS host_audio,\n          audience_audio AS audience_audio,\n          host_sd AS host_sd,\n          host_hd AS host_hd,\n          host_hdp AS host_hdp,\n          audience_sd AS audience_sd,\n          audience_hd AS audience_hd,\n          audience_hdp AS audience_hdp,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          total_last7 AS total_last7,\n          audio_last7 AS audio_last7,\n          video_last7 AS video_last7,\n          video_sd_last7 AS video_sd_last7,\n          video_hd_last7 AS video_hd_last7,\n          video_hdp_last7 AS video_hdp_last7,\n          host_sd_last7 AS host_sd_last7,\n          audience_sd_last7 AS audience_sd_last7,\n          host_hd_last7 AS host_hd_last7,\n          audience_hd_last7 AS audience_hd_last7,\n          host_hdp_last7 AS host_hdp_last7,\n          audience_hdp_last7 AS audience_hdp_last7,\n          host_audio_last7 AS host_audio_last7,\n          audience_audio_last7 AS audience_audio_last7,\n          host_video_last7 AS host_video_last7,\n          audience_video_last7 AS audience_video_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211026 AND date <= 20211124 AND dim = 1 AND area IS NOT NULL AND CAST(level1 AS VARCHAR) = 'Education' AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n    WHERE \"自定义 SQL 查询\".\"dim\" = 1 AND CAST(\"自定义 SQL 查询\".\"tag\" AS VARCHAR) = 'Industry'\n    GROUP BY 1) AS \"t0\"\n  INNER JOIN (SELECT \"t1\".\"level1\" AS \"level1\",\n      SUM(\"t2\".\"__measure__1\") AS \"__measure__0\"\n    FROM (SELECT \"自定义 SQL 查询\".\"date\" AS \"date\",\n          \"自定义 SQL 查询\".\"level1\" AS \"level1\"\n        FROM (SELECT date,\n              start_date AS start_date_7,\n              end_date AS end_date,\n                CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n              tag,\n              area AS Scope,\n              dim,\n                CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n                CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n                CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n              level4,\n              product_level1 AS product_line,\n              product_level2,\n              product_level3,\n              product_level4,\n              vid_internal_industry_en AS cid_industry,\n              vid_use_case_en AS vid_use_case_cn,\n              vid_sector_en,\n              ver_type,\n              ver,\n              os,\n              domain,\n              country,\n              region,\n              dim_grouping_name,\n              total AS totalUsage,\n              audio AS audio,\n              video AS video,\n                host_sd + audience_sd AS video_sd,\n                host_hd + audience_hd AS video_hd,\n                host_hdp + audience_hdp AS video_hdp,\n              host_audio AS host_audio,\n              audience_audio AS audience_audio,\n              host_sd AS host_sd,\n              host_hd AS host_hd,\n              host_hdp AS host_hdp,\n              audience_sd AS audience_sd,\n              audience_hd AS audience_hd,\n              audience_hdp AS audience_hdp,\n              total_last1 AS audio_video_last,\n              audio_last1 AS audio_last,\n              video_last1 AS video_last,\n              video_sd_last1 AS video_sd_last,\n              video_hd_last1 AS video_hd_last,\n              video_hdp_last1 AS video_hdp_last,\n              host_sd_last1 AS host_video_sd_last,\n              audience_sd_last1 AS audience_video_sd_last,\n              host_hd_last1 AS host_video_hd_last,\n              audience_hd_last1 AS audience_video_hd_last,\n              host_hdp_last1 AS host_video_hdp_last,\n              audience_hdp_last1 AS audience_video_hdp_last,\n              host_audio_last1 AS host_audio_last,\n              audience_audio_last1 AS audience_audio_last,\n              host_video_last1 AS host_video_last,\n              audience_video_last1 AS audience_video_last,\n              total_last7 AS total_last7,\n              audio_last7 AS audio_last7,\n              video_last7 AS video_last7,\n              video_sd_last7 AS video_sd_last7,\n              video_hd_last7 AS video_hd_last7,\n              video_hdp_last7 AS video_hdp_last7,\n              host_sd_last7 AS host_sd_last7,\n              audience_sd_last7 AS audience_sd_last7,\n              host_hd_last7 AS host_hd_last7,\n              audience_hd_last7 AS audience_hd_last7,\n              host_hdp_last7 AS host_hdp_last7,\n              audience_hdp_last7 AS audience_hdp_last7,\n              host_audio_last7 AS host_audio_last7,\n              audience_audio_last7 AS audience_audio_last7,\n              host_video_last7 AS host_video_last7,\n              audience_video_last7 AS audience_video_last7\n            FROM levels_usage_dod_di_1\n            WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211026 AND date <= 20211124 AND dim = 1 AND area IS NOT NULL AND CAST(level1 AS VARCHAR) = 'Education' AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n        WHERE \"自定义 SQL 查询\".\"dim\" = 1 AND CAST(\"自定义 SQL 查询\".\"tag\" AS VARCHAR) = 'Industry'\n        GROUP BY 1,\n          2) AS \"t1\"\n      INNER JOIN (SELECT \"自定义 SQL 查询\".\"date\" AS \"date\",\n          SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"__measure__1\"\n        FROM (SELECT date,\n              start_date AS start_date_7,\n              end_date AS end_date,\n                CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n              tag,\n              area AS Scope,\n              dim,\n                CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n                CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n                CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n              level4,\n              product_level1 AS product_line,\n              product_level2,\n              product_level3,\n              product_level4,\n              vid_internal_industry_en AS cid_industry,\n              vid_use_case_en AS vid_use_case_cn,\n              vid_sector_en,\n              ver_type,\n              ver,\n              os,\n              domain,\n              country,\n              region,\n              dim_grouping_name,\n              total AS totalUsage,\n              audio AS audio,\n              video AS video,\n                host_sd + audience_sd AS video_sd,\n                host_hd + audience_hd AS video_hd,\n                host_hdp + audience_hdp AS video_hdp,\n              host_audio AS host_audio,\n              audience_audio AS audience_audio,\n              host_sd AS host_sd,\n              host_hd AS host_hd,\n              host_hdp AS host_hdp,\n              audience_sd AS audience_sd,\n              audience_hd AS audience_hd,\n              audience_hdp AS audience_hdp,\n              total_last1 AS audio_video_last,\n              audio_last1 AS audio_last,\n              video_last1 AS video_last,\n              video_sd_last1 AS video_sd_last,\n              video_hd_last1 AS video_hd_last,\n              video_hdp_last1 AS video_hdp_last,\n              host_sd_last1 AS host_video_sd_last,\n              audience_sd_last1 AS audience_video_sd_last,\n              host_hd_last1 AS host_video_hd_last,\n              audience_hd_last1 AS audience_video_hd_last,\n              host_hdp_last1 AS host_video_hdp_last,\n              audience_hdp_last1 AS audience_video_hdp_last,\n              host_audio_last1 AS host_audio_last,\n              audience_audio_last1 AS audience_audio_last,\n              host_video_last1 AS host_video_last,\n              audience_video_last1 AS audience_video_last,\n              total_last7 AS total_last7,\n              audio_last7 AS audio_last7,\n              video_last7 AS video_last7,\n              video_sd_last7 AS video_sd_last7,\n              video_hd_last7 AS video_hd_last7,\n              video_hdp_last7 AS video_hdp_last7,\n              host_sd_last7 AS host_sd_last7,\n              audience_sd_last7 AS audience_sd_last7,\n              host_hd_last7 AS host_hd_last7,\n              audience_hd_last7 AS audience_hd_last7,\n              host_hdp_last7 AS host_hdp_last7,\n              audience_hdp_last7 AS audience_hdp_last7,\n              host_audio_last7 AS host_audio_last7,\n              audience_audio_last7 AS audience_audio_last7,\n              host_video_last7 AS host_video_last7,\n              audience_video_last7 AS audience_video_last7\n            FROM levels_usage_dod_di_1\n            WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211026 AND date <= 20211124 AND dim = 1 AND area IS NOT NULL AND CAST(level1 AS VARCHAR) = 'Education' AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n        GROUP BY 1) AS \"t2\" ON ((\"t1\".\"date\"  is null and  \"t2\".\"date\"  is null )  or  (\"t1\".\"date\" = \"t2\".\"date\"))\n    GROUP BY 1) AS \"t3\" ON ((\"t0\".\"level1\"  is null and  \"t3\".\"level1\"  is null )  or  (\"t0\".\"level1\" = \"t3\".\"level1\"))"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  MIN(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(1482809429)(0)\",\n  MAX(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(3765460736)(0)\",\n  \"自定义 SQL 查询\".\"product_level2\" AS \"product_level2\",\n  \"自定义 SQL 查询\".\"stat_date\" AS \"stat_date\"\nFROM (SELECT date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n      total AS totalUsage,\n      audio AS audio,\n      video AS video,\n        host_sd + audience_sd AS video_sd,\n        host_hd + audience_hd AS video_hd,\n        host_hdp + audience_hdp AS video_hdp,\n      host_audio AS host_audio,\n      audience_audio AS audience_audio,\n      host_sd AS host_sd,\n      host_hd AS host_hd,\n      host_hdp AS host_hdp,\n      audience_sd AS audience_sd,\n      audience_hd AS audience_hd,\n      audience_hdp AS audience_hdp,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      total_last7 AS total_last7,\n      audio_last7 AS audio_last7,\n      video_last7 AS video_last7,\n      video_sd_last7 AS video_sd_last7,\n      video_hd_last7 AS video_hd_last7,\n      video_hdp_last7 AS video_hdp_last7,\n      host_sd_last7 AS host_sd_last7,\n      audience_sd_last7 AS audience_sd_last7,\n      host_hd_last7 AS host_hd_last7,\n      audience_hd_last7 AS audience_hd_last7,\n      host_hdp_last7 AS host_hdp_last7,\n      audience_hdp_last7 AS audience_hdp_last7,\n      host_audio_last7 AS host_audio_last7,\n      audience_audio_last7 AS audience_audio_last7,\n      host_video_last7 AS host_video_last7,\n      audience_video_last7 AS audience_video_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211026 AND date <= 20211124 AND dim = 1 AND area IS NOT NULL AND CAST(level1 AS VARCHAR) = 'Education' AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          tag,\n          area AS Scope,\n          dim,\n            CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n            CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n            CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n          total AS totalUsage,\n          audio AS audio,\n          video AS video,\n            host_sd + audience_sd AS video_sd,\n            host_hd + audience_hd AS video_hd,\n            host_hdp + audience_hdp AS video_hdp,\n          host_audio AS host_audio,\n          audience_audio AS audience_audio,\n          host_sd AS host_sd,\n          host_hd AS host_hd,\n          host_hdp AS host_hdp,\n          audience_sd AS audience_sd,\n          audience_hd AS audience_hd,\n          audience_hdp AS audience_hdp,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          total_last7 AS total_last7,\n          audio_last7 AS audio_last7,\n          video_last7 AS video_last7,\n          video_sd_last7 AS video_sd_last7,\n          video_hd_last7 AS video_hd_last7,\n          video_hdp_last7 AS video_hdp_last7,\n          host_sd_last7 AS host_sd_last7,\n          audience_sd_last7 AS audience_sd_last7,\n          host_hd_last7 AS host_hd_last7,\n          audience_hd_last7 AS audience_hd_last7,\n          host_hdp_last7 AS host_hdp_last7,\n          audience_hdp_last7 AS audience_hdp_last7,\n          host_audio_last7 AS host_audio_last7,\n          audience_audio_last7 AS audience_audio_last7,\n          host_video_last7 AS host_video_last7,\n          audience_video_last7 AS audience_video_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211026 AND date <= 20211124 AND dim = 1 AND area IS NOT NULL AND CAST(level1 AS VARCHAR) = 'Education' AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND CAST(\"自定义 SQL 查询\".\"tag\" AS VARCHAR) = 'Industry' AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 14,\n  15"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  MIN(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(1482809429)(0)\",\n  MAX(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(3765460736)(0)\",\n  \"自定义 SQL 查询\".\"stat_date\" AS \"TEMP(attr_stat_date_nk)(2102638629)(0)\",\n  \"自定义 SQL 查询\".\"stat_date\" AS \"TEMP(attr_stat_date_nk)(2790680713)(0)\",\n  \"自定义 SQL 查询\".\"stat_date\" AS \"stat_date\",\n  \"自定义 SQL 查询\".\"vid_use_case_cn\" AS \"vid_use_case_cn\"\nFROM (SELECT date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n      total AS totalUsage,\n      audio AS audio,\n      video AS video,\n        host_sd + audience_sd AS video_sd,\n        host_hd + audience_hd AS video_hd,\n        host_hdp + audience_hdp AS video_hdp,\n      host_audio AS host_audio,\n      audience_audio AS audience_audio,\n      host_sd AS host_sd,\n      host_hd AS host_hd,\n      host_hdp AS host_hdp,\n      audience_sd AS audience_sd,\n      audience_hd AS audience_hd,\n      audience_hdp AS audience_hdp,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      total_last7 AS total_last7,\n      audio_last7 AS audio_last7,\n      video_last7 AS video_last7,\n      video_sd_last7 AS video_sd_last7,\n      video_hd_last7 AS video_hd_last7,\n      video_hdp_last7 AS video_hdp_last7,\n      host_sd_last7 AS host_sd_last7,\n      audience_sd_last7 AS audience_sd_last7,\n      host_hd_last7 AS host_hd_last7,\n      audience_hd_last7 AS audience_hd_last7,\n      host_hdp_last7 AS host_hdp_last7,\n      audience_hdp_last7 AS audience_hdp_last7,\n      host_audio_last7 AS host_audio_last7,\n      audience_audio_last7 AS audience_audio_last7,\n      host_video_last7 AS host_video_last7,\n      audience_video_last7 AS audience_video_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211026 AND date <= 20211124 AND dim = 1 AND area IS NOT NULL AND CAST(level1 AS VARCHAR) = 'Education' AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          tag,\n          area AS Scope,\n          dim,\n            CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n            CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n            CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n          total AS totalUsage,\n          audio AS audio,\n          video AS video,\n            host_sd + audience_sd AS video_sd,\n            host_hd + audience_hd AS video_hd,\n            host_hdp + audience_hdp AS video_hdp,\n          host_audio AS host_audio,\n          audience_audio AS audience_audio,\n          host_sd AS host_sd,\n          host_hd AS host_hd,\n          host_hdp AS host_hdp,\n          audience_sd AS audience_sd,\n          audience_hd AS audience_hd,\n          audience_hdp AS audience_hdp,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          total_last7 AS total_last7,\n          audio_last7 AS audio_last7,\n          video_last7 AS video_last7,\n          video_sd_last7 AS video_sd_last7,\n          video_hd_last7 AS video_hd_last7,\n          video_hdp_last7 AS video_hdp_last7,\n          host_sd_last7 AS host_sd_last7,\n          audience_sd_last7 AS audience_sd_last7,\n          host_hd_last7 AS host_hd_last7,\n          audience_hd_last7 AS audience_hd_last7,\n          host_hdp_last7 AS host_hdp_last7,\n          audience_hdp_last7 AS audience_hdp_last7,\n          host_audio_last7 AS host_audio_last7,\n          audience_audio_last7 AS audience_audio_last7,\n          host_video_last7 AS host_video_last7,\n          audience_video_last7 AS audience_video_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211026 AND date <= 20211124 AND dim = 1 AND area IS NOT NULL AND CAST(level1 AS VARCHAR) = 'Education' AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND CAST(\"自定义 SQL 查询\".\"tag\" AS VARCHAR) = 'Industry' AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 14,\n  17"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  \"自定义 SQL 查询\".\"product_line\" AS \"product_line\",\n  \"自定义 SQL 查询\".\"stat_date\" AS \"stat_date\"\nFROM (SELECT date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n      total AS totalUsage,\n      audio AS audio,\n      video AS video,\n        host_sd + audience_sd AS video_sd,\n        host_hd + audience_hd AS video_hd,\n        host_hdp + audience_hdp AS video_hdp,\n      host_audio AS host_audio,\n      audience_audio AS audience_audio,\n      host_sd AS host_sd,\n      host_hd AS host_hd,\n      host_hdp AS host_hdp,\n      audience_sd AS audience_sd,\n      audience_hd AS audience_hd,\n      audience_hdp AS audience_hdp,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      total_last7 AS total_last7,\n      audio_last7 AS audio_last7,\n      video_last7 AS video_last7,\n      video_sd_last7 AS video_sd_last7,\n      video_hd_last7 AS video_hd_last7,\n      video_hdp_last7 AS video_hdp_last7,\n      host_sd_last7 AS host_sd_last7,\n      audience_sd_last7 AS audience_sd_last7,\n      host_hd_last7 AS host_hd_last7,\n      audience_hd_last7 AS audience_hd_last7,\n      host_hdp_last7 AS host_hdp_last7,\n      audience_hdp_last7 AS audience_hdp_last7,\n      host_audio_last7 AS host_audio_last7,\n      audience_audio_last7 AS audience_audio_last7,\n      host_video_last7 AS host_video_last7,\n      audience_video_last7 AS audience_video_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211026 AND date <= 20211124 AND dim = 1 AND area IS NOT NULL AND CAST(level1 AS VARCHAR) = 'Education' AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          tag,\n          area AS Scope,\n          dim,\n            CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n            CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n            CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n          total AS totalUsage,\n          audio AS audio,\n          video AS video,\n            host_sd + audience_sd AS video_sd,\n            host_hd + audience_hd AS video_hd,\n            host_hdp + audience_hdp AS video_hdp,\n          host_audio AS host_audio,\n          audience_audio AS audience_audio,\n          host_sd AS host_sd,\n          host_hd AS host_hd,\n          host_hdp AS host_hdp,\n          audience_sd AS audience_sd,\n          audience_hd AS audience_hd,\n          audience_hdp AS audience_hdp,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          total_last7 AS total_last7,\n          audio_last7 AS audio_last7,\n          video_last7 AS video_last7,\n          video_sd_last7 AS video_sd_last7,\n          video_hd_last7 AS video_hd_last7,\n          video_hdp_last7 AS video_hdp_last7,\n          host_sd_last7 AS host_sd_last7,\n          audience_sd_last7 AS audience_sd_last7,\n          host_hd_last7 AS host_hd_last7,\n          audience_hd_last7 AS audience_hd_last7,\n          host_hdp_last7 AS host_hdp_last7,\n          audience_hdp_last7 AS audience_hdp_last7,\n          host_audio_last7 AS host_audio_last7,\n          audience_audio_last7 AS audience_audio_last7,\n          host_video_last7 AS host_video_last7,\n          audience_video_last7 AS audience_video_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211026 AND date <= 20211124 AND dim = 1 AND area IS NOT NULL AND CAST(level1 AS VARCHAR) = 'Education' AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 12,\n  13"
	},
	{
		"presto_sql" : "SELECT \"t0\".\"TEMP(attr_stat_date_nk)(2102638629)(0)\" AS \"TEMP(attr_stat_date_nk)(2102638629)(0)\",\n  \"t0\".\"TEMP(attr_stat_date_nk)(2790680713)(0)\" AS \"TEMP(attr_stat_date_nk)(2790680713)(0)\",\n  \"t0\".\"level1\" AS \"level1\",\n  \"t3\".\"__measure__0\" AS \"sum_Calculation_96897765691088903_ok\",\n  \"t0\".\"sum_audio_ok\" AS \"sum_audio_ok\",\n  \"t3\".\"__measure__1\" AS \"sum_sd百分比 (复制) (复制)_96897765691801609_ok\",\n  \"t3\".\"__measure__2\" AS \"sum_sd百分比 (复制)_96897765691785224_ok\",\n  \"t0\".\"sum_totalUsage_ok\" AS \"sum_totalUsage_ok\",\n  \"t0\".\"sum_video_ok\" AS \"sum_video_ok\",\n  \"t0\".\"sum_video_hd_ok\" AS \"sum_video_hd_ok\",\n  \"t0\".\"sum_video_hdp_ok\" AS \"sum_video_hdp_ok\",\n  \"t0\".\"sum_video_sd_ok\" AS \"sum_video_sd_ok\",\n  \"t0\".\"tdy_date_ok\" AS \"tdy_date_ok\"\nFROM (SELECT \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n      DATE_ADD('SECOND', 0, date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"tdy_date_ok\",\n      MAX(\"自定义 SQL 查询\".\"stat_date\") AS \"TEMP(attr_stat_date_nk)(2102638629)(0)\",\n      MIN(\"自定义 SQL 查询\".\"stat_date\") AS \"TEMP(attr_stat_date_nk)(2790680713)(0)\",\n      SUM(\"自定义 SQL 查询\".\"audio\") AS \"sum_audio_ok\",\n      SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"sum_totalUsage_ok\",\n      SUM(\"自定义 SQL 查询\".\"video\") AS \"sum_video_ok\",\n      SUM(\"自定义 SQL 查询\".\"video_hd\") AS \"sum_video_hd_ok\",\n      SUM(\"自定义 SQL 查询\".\"video_hdp\") AS \"sum_video_hdp_ok\",\n      SUM(\"自定义 SQL 查询\".\"video_sd\") AS \"sum_video_sd_ok\"\n    FROM (SELECT date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          tag,\n          area AS Scope,\n          dim,\n            CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n            CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n            CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n          total AS totalUsage,\n          audio AS audio,\n          video AS video,\n            host_sd + audience_sd AS video_sd,\n            host_hd + audience_hd AS video_hd,\n            host_hdp + audience_hdp AS video_hdp,\n          host_audio AS host_audio,\n          audience_audio AS audience_audio,\n          host_sd AS host_sd,\n          host_hd AS host_hd,\n          host_hdp AS host_hdp,\n          audience_sd AS audience_sd,\n          audience_hd AS audience_hd,\n          audience_hdp AS audience_hdp,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          total_last7 AS total_last7,\n          audio_last7 AS audio_last7,\n          video_last7 AS video_last7,\n          video_sd_last7 AS video_sd_last7,\n          video_hd_last7 AS video_hd_last7,\n          video_hdp_last7 AS video_hdp_last7,\n          host_sd_last7 AS host_sd_last7,\n          audience_sd_last7 AS audience_sd_last7,\n          host_hd_last7 AS host_hd_last7,\n          audience_hd_last7 AS audience_hd_last7,\n          host_hdp_last7 AS host_hdp_last7,\n          audience_hdp_last7 AS audience_hdp_last7,\n          host_audio_last7 AS host_audio_last7,\n          audience_audio_last7 AS audience_audio_last7,\n          host_video_last7 AS host_video_last7,\n          audience_video_last7 AS audience_video_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211026 AND date <= 20211124 AND dim = 1 AND area IS NOT NULL AND CAST(level1 AS VARCHAR) = 'Education' AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n    WHERE \"自定义 SQL 查询\".\"dim\" = 1 AND CAST(\"自定义 SQL 查询\".\"tag\" AS VARCHAR) = 'Industry'\n    GROUP BY 1,\n      2) AS \"t0\"\n  INNER JOIN (SELECT \"t1\".\"level1\" AS \"level1\",\n      DATE_ADD('SECOND', 0, date_parse(cast( \"t1\".\"date\" as VARCHAR), '%Y%m%d')) AS \"tdy_date_ok\",\n      SUM(\"t2\".\"$temp0_import1\") AS \"__measure__0\",\n      SUM(\"t2\".\"$temp1_import1\") AS \"__measure__1\",\n      SUM(\"t2\".\"$temp2_import1\") AS \"__measure__2\"\n    FROM (SELECT \"自定义 SQL 查询\".\"date\" AS \"date\",\n          \"自定义 SQL 查询\".\"level1\" AS \"level1\"\n        FROM (SELECT date,\n              start_date AS start_date_7,\n              end_date AS end_date,\n                CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n              tag,\n              area AS Scope,\n              dim,\n                CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n                CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n                CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n              level4,\n              product_level1 AS product_line,\n              product_level2,\n              product_level3,\n              product_level4,\n              vid_internal_industry_en AS cid_industry,\n              vid_use_case_en AS vid_use_case_cn,\n              vid_sector_en,\n              ver_type,\n              ver,\n              os,\n              domain,\n              country,\n              region,\n              dim_grouping_name,\n              total AS totalUsage,\n              audio AS audio,\n              video AS video,\n                host_sd + audience_sd AS video_sd,\n                host_hd + audience_hd AS video_hd,\n                host_hdp + audience_hdp AS video_hdp,\n              host_audio AS host_audio,\n              audience_audio AS audience_audio,\n              host_sd AS host_sd,\n              host_hd AS host_hd,\n              host_hdp AS host_hdp,\n              audience_sd AS audience_sd,\n              audience_hd AS audience_hd,\n              audience_hdp AS audience_hdp,\n              total_last1 AS audio_video_last,\n              audio_last1 AS audio_last,\n              video_last1 AS video_last,\n              video_sd_last1 AS video_sd_last,\n              video_hd_last1 AS video_hd_last,\n              video_hdp_last1 AS video_hdp_last,\n              host_sd_last1 AS host_video_sd_last,\n              audience_sd_last1 AS audience_video_sd_last,\n              host_hd_last1 AS host_video_hd_last,\n              audience_hd_last1 AS audience_video_hd_last,\n              host_hdp_last1 AS host_video_hdp_last,\n              audience_hdp_last1 AS audience_video_hdp_last,\n              host_audio_last1 AS host_audio_last,\n              audience_audio_last1 AS audience_audio_last,\n              host_video_last1 AS host_video_last,\n              audience_video_last1 AS audience_video_last,\n              total_last7 AS total_last7,\n              audio_last7 AS audio_last7,\n              video_last7 AS video_last7,\n              video_sd_last7 AS video_sd_last7,\n              video_hd_last7 AS video_hd_last7,\n              video_hdp_last7 AS video_hdp_last7,\n              host_sd_last7 AS host_sd_last7,\n              audience_sd_last7 AS audience_sd_last7,\n              host_hd_last7 AS host_hd_last7,\n              audience_hd_last7 AS audience_hd_last7,\n              host_hdp_last7 AS host_hdp_last7,\n              audience_hdp_last7 AS audience_hdp_last7,\n              host_audio_last7 AS host_audio_last7,\n              audience_audio_last7 AS audience_audio_last7,\n              host_video_last7 AS host_video_last7,\n              audience_video_last7 AS audience_video_last7\n            FROM levels_usage_dod_di_1\n            WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211026 AND date <= 20211124 AND dim = 1 AND area IS NOT NULL AND CAST(level1 AS VARCHAR) = 'Education' AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n        WHERE \"自定义 SQL 查询\".\"dim\" = 1 AND CAST(\"自定义 SQL 查询\".\"tag\" AS VARCHAR) = 'Industry'\n        GROUP BY 1,\n          2) AS \"t1\"\n      INNER JOIN (SELECT \"自定义 SQL 查询\".\"date\" AS \"date\",\n            SUM(\"自定义 SQL 查询\".\"video_sd\") \/ SUM(\"自定义 SQL 查询\".\"video\") AS \"$temp0_import1\",\n            SUM(\"自定义 SQL 查询\".\"video_hdp\") \/ SUM(\"自定义 SQL 查询\".\"video\") AS \"$temp1_import1\",\n            SUM(\"自定义 SQL 查询\".\"video_hd\") \/ SUM(\"自定义 SQL 查询\".\"video\") AS \"$temp2_import1\"\n        FROM (SELECT date,\n              start_date AS start_date_7,\n              end_date AS end_date,\n                CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n              tag,\n              area AS Scope,\n              dim,\n                CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n                CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n                CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n              level4,\n              product_level1 AS product_line,\n              product_level2,\n              product_level3,\n              product_level4,\n              vid_internal_industry_en AS cid_industry,\n              vid_use_case_en AS vid_use_case_cn,\n              vid_sector_en,\n              ver_type,\n              ver,\n              os,\n              domain,\n              country,\n              region,\n              dim_grouping_name,\n              total AS totalUsage,\n              audio AS audio,\n              video AS video,\n                host_sd + audience_sd AS video_sd,\n                host_hd + audience_hd AS video_hd,\n                host_hdp + audience_hdp AS video_hdp,\n              host_audio AS host_audio,\n              audience_audio AS audience_audio,\n              host_sd AS host_sd,\n              host_hd AS host_hd,\n              host_hdp AS host_hdp,\n              audience_sd AS audience_sd,\n              audience_hd AS audience_hd,\n              audience_hdp AS audience_hdp,\n              total_last1 AS audio_video_last,\n              audio_last1 AS audio_last,\n              video_last1 AS video_last,\n              video_sd_last1 AS video_sd_last,\n              video_hd_last1 AS video_hd_last,\n              video_hdp_last1 AS video_hdp_last,\n              host_sd_last1 AS host_video_sd_last,\n              audience_sd_last1 AS audience_video_sd_last,\n              host_hd_last1 AS host_video_hd_last,\n              audience_hd_last1 AS audience_video_hd_last,\n              host_hdp_last1 AS host_video_hdp_last,\n              audience_hdp_last1 AS audience_video_hdp_last,\n              host_audio_last1 AS host_audio_last,\n              audience_audio_last1 AS audience_audio_last,\n              host_video_last1 AS host_video_last,\n              audience_video_last1 AS audience_video_last,\n              total_last7 AS total_last7,\n              audio_last7 AS audio_last7,\n              video_last7 AS video_last7,\n              video_sd_last7 AS video_sd_last7,\n              video_hd_last7 AS video_hd_last7,\n              video_hdp_last7 AS video_hdp_last7,\n              host_sd_last7 AS host_sd_last7,\n              audience_sd_last7 AS audience_sd_last7,\n              host_hd_last7 AS host_hd_last7,\n              audience_hd_last7 AS audience_hd_last7,\n              host_hdp_last7 AS host_hdp_last7,\n              audience_hdp_last7 AS audience_hdp_last7,\n              host_audio_last7 AS host_audio_last7,\n              audience_audio_last7 AS audience_audio_last7,\n              host_video_last7 AS host_video_last7,\n              audience_video_last7 AS audience_video_last7\n            FROM levels_usage_dod_di_1\n            WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211026 AND date <= 20211124 AND dim = 1 AND area IS NOT NULL AND CAST(level1 AS VARCHAR) = 'Education' AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n        GROUP BY 1) AS \"t2\" ON ((\"t1\".\"date\"  is null and  \"t2\".\"date\"  is null )  or  (\"t1\".\"date\" = \"t2\".\"date\"))\n    GROUP BY 1,\n      2) AS \"t3\" ON ((\"t0\".\"level1\"  is null and  \"t3\".\"level1\"  is null )  or  (\"t0\".\"level1\" = \"t3\".\"level1\")) AND ((\"t0\".\"tdy_date_ok\"  is null and  \"t3\".\"tdy_date_ok\"  is null )  or  (\"t0\".\"tdy_date_ok\" = \"t3\".\"tdy_date_ok\"))"
	},
	{
		"presto_sql" : "SELECT \"自定义 SQL 查询\".\"product_level3\" AS \"product_level3\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"usr_Calculation_3519281700079370244_ok\"\nFROM (SELECT date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n      total AS totalUsage,\n      audio AS audio,\n      video AS video,\n        host_sd + audience_sd AS video_sd,\n        host_hd + audience_hd AS video_hd,\n        host_hdp + audience_hdp AS video_hdp,\n      host_audio AS host_audio,\n      audience_audio AS audience_audio,\n      host_sd AS host_sd,\n      host_hd AS host_hd,\n      host_hdp AS host_hdp,\n      audience_sd AS audience_sd,\n      audience_hd AS audience_hd,\n      audience_hdp AS audience_hdp,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      total_last7 AS total_last7,\n      audio_last7 AS audio_last7,\n      video_last7 AS video_last7,\n      video_sd_last7 AS video_sd_last7,\n      video_hd_last7 AS video_hd_last7,\n      video_hdp_last7 AS video_hdp_last7,\n      host_sd_last7 AS host_sd_last7,\n      audience_sd_last7 AS audience_sd_last7,\n      host_hd_last7 AS host_hd_last7,\n      audience_hd_last7 AS audience_hd_last7,\n      host_hdp_last7 AS host_hdp_last7,\n      audience_hdp_last7 AS audience_hdp_last7,\n      host_audio_last7 AS host_audio_last7,\n      audience_audio_last7 AS audience_audio_last7,\n      host_video_last7 AS host_video_last7,\n      audience_video_last7 AS audience_video_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211026 AND date <= 20211124 AND dim = 1 AND area IS NOT NULL AND CAST(level1 AS VARCHAR) = 'Education' AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND CAST(\"自定义 SQL 查询\".\"tag\" AS VARCHAR) = 'Industry'\nGROUP BY 1"
	},
	{
		"presto_sql" : "SELECT \"自定义 SQL 查询\".\"product_level2\" AS \"product_level2\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"usr_Calculation_3519281700079370244_ok\"\nFROM (SELECT date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n      total AS totalUsage,\n      audio AS audio,\n      video AS video,\n        host_sd + audience_sd AS video_sd,\n        host_hd + audience_hd AS video_hd,\n        host_hdp + audience_hdp AS video_hdp,\n      host_audio AS host_audio,\n      audience_audio AS audience_audio,\n      host_sd AS host_sd,\n      host_hd AS host_hd,\n      host_hdp AS host_hdp,\n      audience_sd AS audience_sd,\n      audience_hd AS audience_hd,\n      audience_hdp AS audience_hdp,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      total_last7 AS total_last7,\n      audio_last7 AS audio_last7,\n      video_last7 AS video_last7,\n      video_sd_last7 AS video_sd_last7,\n      video_hd_last7 AS video_hd_last7,\n      video_hdp_last7 AS video_hdp_last7,\n      host_sd_last7 AS host_sd_last7,\n      audience_sd_last7 AS audience_sd_last7,\n      host_hd_last7 AS host_hd_last7,\n      audience_hd_last7 AS audience_hd_last7,\n      host_hdp_last7 AS host_hdp_last7,\n      audience_hdp_last7 AS audience_hdp_last7,\n      host_audio_last7 AS host_audio_last7,\n      audience_audio_last7 AS audience_audio_last7,\n      host_video_last7 AS host_video_last7,\n      audience_video_last7 AS audience_video_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211026 AND date <= 20211124 AND dim = 1 AND area IS NOT NULL AND CAST(level1 AS VARCHAR) = 'Education' AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND CAST(\"自定义 SQL 查询\".\"tag\" AS VARCHAR) = 'Industry'\nGROUP BY 1"
	},
	{
		"presto_sql" : "SELECT \"自定义 SQL 查询\".\"product_line\" AS \"product_line\"\nFROM (SELECT date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n      total AS totalUsage,\n      audio AS audio,\n      video AS video,\n        host_sd + audience_sd AS video_sd,\n        host_hd + audience_hd AS video_hd,\n        host_hdp + audience_hdp AS video_hdp,\n      host_audio AS host_audio,\n      audience_audio AS audience_audio,\n      host_sd AS host_sd,\n      host_hd AS host_hd,\n      host_hdp AS host_hdp,\n      audience_sd AS audience_sd,\n      audience_hd AS audience_hd,\n      audience_hdp AS audience_hdp,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      total_last7 AS total_last7,\n      audio_last7 AS audio_last7,\n      video_last7 AS video_last7,\n      video_sd_last7 AS video_sd_last7,\n      video_hd_last7 AS video_hd_last7,\n      video_hdp_last7 AS video_hdp_last7,\n      host_sd_last7 AS host_sd_last7,\n      audience_sd_last7 AS audience_sd_last7,\n      host_hd_last7 AS host_hd_last7,\n      audience_hd_last7 AS audience_hd_last7,\n      host_hdp_last7 AS host_hdp_last7,\n      audience_hdp_last7 AS audience_hdp_last7,\n      host_audio_last7 AS host_audio_last7,\n      audience_audio_last7 AS audience_audio_last7,\n      host_video_last7 AS host_video_last7,\n      audience_video_last7 AS audience_video_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211026 AND date <= 20211124 AND dim = 1 AND area IS NOT NULL AND CAST(level1 AS VARCHAR) = 'Education' AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\nGROUP BY 1\nORDER BY \"product_line\""
	},
	{
		"presto_sql" : "SELECT \"自定义 SQL 查询\".\"vid_sector_en\" AS \"vid_sector_en\"\nFROM (SELECT date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n      total AS totalUsage,\n      audio AS audio,\n      video AS video,\n        host_sd + audience_sd AS video_sd,\n        host_hd + audience_hd AS video_hd,\n        host_hdp + audience_hdp AS video_hdp,\n      host_audio AS host_audio,\n      audience_audio AS audience_audio,\n      host_sd AS host_sd,\n      host_hd AS host_hd,\n      host_hdp AS host_hdp,\n      audience_sd AS audience_sd,\n      audience_hd AS audience_hd,\n      audience_hdp AS audience_hdp,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      total_last7 AS total_last7,\n      audio_last7 AS audio_last7,\n      video_last7 AS video_last7,\n      video_sd_last7 AS video_sd_last7,\n      video_hd_last7 AS video_hd_last7,\n      video_hdp_last7 AS video_hdp_last7,\n      host_sd_last7 AS host_sd_last7,\n      audience_sd_last7 AS audience_sd_last7,\n      host_hd_last7 AS host_hd_last7,\n      audience_hd_last7 AS audience_hd_last7,\n      host_hdp_last7 AS host_hdp_last7,\n      audience_hdp_last7 AS audience_hdp_last7,\n      host_audio_last7 AS host_audio_last7,\n      audience_audio_last7 AS audience_audio_last7,\n      host_video_last7 AS host_video_last7,\n      audience_video_last7 AS audience_video_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211026 AND date <= 20211124 AND dim = 1 AND area IS NOT NULL AND CAST(level1 AS VARCHAR) = 'Education' AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\nGROUP BY 1\nORDER BY \"vid_sector_en\""
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"usr_Calculation_3519281700079370244_ok\",\n  \"自定义 SQL 查询\".\"vid_use_case_cn\" AS \"vid_use_case_cn\"\nFROM (SELECT date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n      total AS totalUsage,\n      audio AS audio,\n      video AS video,\n        host_sd + audience_sd AS video_sd,\n        host_hd + audience_hd AS video_hd,\n        host_hdp + audience_hdp AS video_hdp,\n      host_audio AS host_audio,\n      audience_audio AS audience_audio,\n      host_sd AS host_sd,\n      host_hd AS host_hd,\n      host_hdp AS host_hdp,\n      audience_sd AS audience_sd,\n      audience_hd AS audience_hd,\n      audience_hdp AS audience_hdp,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      total_last7 AS total_last7,\n      audio_last7 AS audio_last7,\n      video_last7 AS video_last7,\n      video_sd_last7 AS video_sd_last7,\n      video_hd_last7 AS video_hd_last7,\n      video_hdp_last7 AS video_hdp_last7,\n      host_sd_last7 AS host_sd_last7,\n      audience_sd_last7 AS audience_sd_last7,\n      host_hd_last7 AS host_hd_last7,\n      audience_hd_last7 AS audience_hd_last7,\n      host_hdp_last7 AS host_hdp_last7,\n      audience_hdp_last7 AS audience_hdp_last7,\n      host_audio_last7 AS host_audio_last7,\n      audience_audio_last7 AS audience_audio_last7,\n      host_video_last7 AS host_video_last7,\n      audience_video_last7 AS audience_video_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211026 AND date <= 20211124 AND dim = 1 AND area IS NOT NULL AND CAST(level1 AS VARCHAR) = 'Education' AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND CAST(\"自定义 SQL 查询\".\"tag\" AS VARCHAR) = 'Industry'\nGROUP BY 2"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  MIN(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(1482809429)(0)\",\n  MAX(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(3765460736)(0)\",\n  \"自定义 SQL 查询\".\"stat_date\" AS \"TEMP(attr_stat_date_nk)(2102638629)(0)\",\n  \"自定义 SQL 查询\".\"stat_date\" AS \"TEMP(attr_stat_date_nk)(2790680713)(0)\",\n  \"自定义 SQL 查询\".\"stat_date\" AS \"stat_date\",\n  \"自定义 SQL 查询\".\"vid_sector_en\" AS \"vid_sector_en\"\nFROM (SELECT date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n      total AS totalUsage,\n      audio AS audio,\n      video AS video,\n        host_sd + audience_sd AS video_sd,\n        host_hd + audience_hd AS video_hd,\n        host_hdp + audience_hdp AS video_hdp,\n      host_audio AS host_audio,\n      audience_audio AS audience_audio,\n      host_sd AS host_sd,\n      host_hd AS host_hd,\n      host_hdp AS host_hdp,\n      audience_sd AS audience_sd,\n      audience_hd AS audience_hd,\n      audience_hdp AS audience_hdp,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      total_last7 AS total_last7,\n      audio_last7 AS audio_last7,\n      video_last7 AS video_last7,\n      video_sd_last7 AS video_sd_last7,\n      video_hd_last7 AS video_hd_last7,\n      video_hdp_last7 AS video_hdp_last7,\n      host_sd_last7 AS host_sd_last7,\n      audience_sd_last7 AS audience_sd_last7,\n      host_hd_last7 AS host_hd_last7,\n      audience_hd_last7 AS audience_hd_last7,\n      host_hdp_last7 AS host_hdp_last7,\n      audience_hdp_last7 AS audience_hdp_last7,\n      host_audio_last7 AS host_audio_last7,\n      audience_audio_last7 AS audience_audio_last7,\n      host_video_last7 AS host_video_last7,\n      audience_video_last7 AS audience_video_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211026 AND date <= 20211124 AND dim = 1 AND area IS NOT NULL AND CAST(level1 AS VARCHAR) = 'Education' AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          tag,\n          area AS Scope,\n          dim,\n            CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n            CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n            CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n          total AS totalUsage,\n          audio AS audio,\n          video AS video,\n            host_sd + audience_sd AS video_sd,\n            host_hd + audience_hd AS video_hd,\n            host_hdp + audience_hdp AS video_hdp,\n          host_audio AS host_audio,\n          audience_audio AS audience_audio,\n          host_sd AS host_sd,\n          host_hd AS host_hd,\n          host_hdp AS host_hdp,\n          audience_sd AS audience_sd,\n          audience_hd AS audience_hd,\n          audience_hdp AS audience_hdp,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          total_last7 AS total_last7,\n          audio_last7 AS audio_last7,\n          video_last7 AS video_last7,\n          video_sd_last7 AS video_sd_last7,\n          video_hd_last7 AS video_hd_last7,\n          video_hdp_last7 AS video_hdp_last7,\n          host_sd_last7 AS host_sd_last7,\n          audience_sd_last7 AS audience_sd_last7,\n          host_hd_last7 AS host_hd_last7,\n          audience_hd_last7 AS audience_hd_last7,\n          host_hdp_last7 AS host_hdp_last7,\n          audience_hdp_last7 AS audience_hdp_last7,\n          host_audio_last7 AS host_audio_last7,\n          audience_audio_last7 AS audience_audio_last7,\n          host_video_last7 AS host_video_last7,\n          audience_video_last7 AS audience_video_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211026 AND date <= 20211124 AND dim = 1 AND area IS NOT NULL AND CAST(level1 AS VARCHAR) = 'Education' AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND CAST(\"自定义 SQL 查询\".\"tag\" AS VARCHAR) = 'Industry' AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 16,\n  17"
	},
	{
		"presto_sql" : "SELECT \"自定义 SQL 查询\".\"product_level3\" AS \"product_level3\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"usr_Calculation_3519281700079370244_ok\"\nFROM (SELECT date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n      total AS totalUsage,\n      audio AS audio,\n      video AS video,\n        host_sd + audience_sd AS video_sd,\n        host_hd + audience_hd AS video_hd,\n        host_hdp + audience_hdp AS video_hdp,\n      host_audio AS host_audio,\n      audience_audio AS audience_audio,\n      host_sd AS host_sd,\n      host_hd AS host_hd,\n      host_hdp AS host_hdp,\n      audience_sd AS audience_sd,\n      audience_hd AS audience_hd,\n      audience_hdp AS audience_hdp,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      total_last7 AS total_last7,\n      audio_last7 AS audio_last7,\n      video_last7 AS video_last7,\n      video_sd_last7 AS video_sd_last7,\n      video_hd_last7 AS video_hd_last7,\n      video_hdp_last7 AS video_hdp_last7,\n      host_sd_last7 AS host_sd_last7,\n      audience_sd_last7 AS audience_sd_last7,\n      host_hd_last7 AS host_hd_last7,\n      audience_hd_last7 AS audience_hd_last7,\n      host_hdp_last7 AS host_hdp_last7,\n      audience_hdp_last7 AS audience_hdp_last7,\n      host_audio_last7 AS host_audio_last7,\n      audience_audio_last7 AS audience_audio_last7,\n      host_video_last7 AS host_video_last7,\n      audience_video_last7 AS audience_video_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211026 AND date <= 20211124 AND dim = 1 AND area IS NOT NULL AND CAST(level1 AS VARCHAR) = 'Education' AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          tag,\n          area AS Scope,\n          dim,\n            CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n            CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n            CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n          total AS totalUsage,\n          audio AS audio,\n          video AS video,\n            host_sd + audience_sd AS video_sd,\n            host_hd + audience_hd AS video_hd,\n            host_hdp + audience_hdp AS video_hdp,\n          host_audio AS host_audio,\n          audience_audio AS audience_audio,\n          host_sd AS host_sd,\n          host_hd AS host_hd,\n          host_hdp AS host_hdp,\n          audience_sd AS audience_sd,\n          audience_hd AS audience_hd,\n          audience_hdp AS audience_hdp,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          total_last7 AS total_last7,\n          audio_last7 AS audio_last7,\n          video_last7 AS video_last7,\n          video_sd_last7 AS video_sd_last7,\n          video_hd_last7 AS video_hd_last7,\n          video_hdp_last7 AS video_hdp_last7,\n          host_sd_last7 AS host_sd_last7,\n          audience_sd_last7 AS audience_sd_last7,\n          host_hd_last7 AS host_hd_last7,\n          audience_hd_last7 AS audience_hd_last7,\n          host_hdp_last7 AS host_hdp_last7,\n          audience_hdp_last7 AS audience_hdp_last7,\n          host_audio_last7 AS host_audio_last7,\n          audience_audio_last7 AS audience_audio_last7,\n          host_video_last7 AS host_video_last7,\n          audience_video_last7 AS audience_video_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211026 AND date <= 20211124 AND dim = 1 AND area IS NOT NULL AND CAST(level1 AS VARCHAR) = 'Education' AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND CAST(\"自定义 SQL 查询\".\"tag\" AS VARCHAR) = 'Industry' AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 1"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"usr_Calculation_3519281700079370244_ok\",\n  \"自定义 SQL 查询\".\"vid_use_case_cn\" AS \"vid_use_case_cn\"\nFROM (SELECT date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n      total AS totalUsage,\n      audio AS audio,\n      video AS video,\n        host_sd + audience_sd AS video_sd,\n        host_hd + audience_hd AS video_hd,\n        host_hdp + audience_hdp AS video_hdp,\n      host_audio AS host_audio,\n      audience_audio AS audience_audio,\n      host_sd AS host_sd,\n      host_hd AS host_hd,\n      host_hdp AS host_hdp,\n      audience_sd AS audience_sd,\n      audience_hd AS audience_hd,\n      audience_hdp AS audience_hdp,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      total_last7 AS total_last7,\n      audio_last7 AS audio_last7,\n      video_last7 AS video_last7,\n      video_sd_last7 AS video_sd_last7,\n      video_hd_last7 AS video_hd_last7,\n      video_hdp_last7 AS video_hdp_last7,\n      host_sd_last7 AS host_sd_last7,\n      audience_sd_last7 AS audience_sd_last7,\n      host_hd_last7 AS host_hd_last7,\n      audience_hd_last7 AS audience_hd_last7,\n      host_hdp_last7 AS host_hdp_last7,\n      audience_hdp_last7 AS audience_hdp_last7,\n      host_audio_last7 AS host_audio_last7,\n      audience_audio_last7 AS audience_audio_last7,\n      host_video_last7 AS host_video_last7,\n      audience_video_last7 AS audience_video_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211026 AND date <= 20211124 AND dim = 1 AND area IS NOT NULL AND CAST(level1 AS VARCHAR) = 'Education' AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          tag,\n          area AS Scope,\n          dim,\n            CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n            CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n            CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n          total AS totalUsage,\n          audio AS audio,\n          video AS video,\n            host_sd + audience_sd AS video_sd,\n            host_hd + audience_hd AS video_hd,\n            host_hdp + audience_hdp AS video_hdp,\n          host_audio AS host_audio,\n          audience_audio AS audience_audio,\n          host_sd AS host_sd,\n          host_hd AS host_hd,\n          host_hdp AS host_hdp,\n          audience_sd AS audience_sd,\n          audience_hd AS audience_hd,\n          audience_hdp AS audience_hdp,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          total_last7 AS total_last7,\n          audio_last7 AS audio_last7,\n          video_last7 AS video_last7,\n          video_sd_last7 AS video_sd_last7,\n          video_hd_last7 AS video_hd_last7,\n          video_hdp_last7 AS video_hdp_last7,\n          host_sd_last7 AS host_sd_last7,\n          audience_sd_last7 AS audience_sd_last7,\n          host_hd_last7 AS host_hd_last7,\n          audience_hd_last7 AS audience_hd_last7,\n          host_hdp_last7 AS host_hdp_last7,\n          audience_hdp_last7 AS audience_hdp_last7,\n          host_audio_last7 AS host_audio_last7,\n          audience_audio_last7 AS audience_audio_last7,\n          host_video_last7 AS host_video_last7,\n          audience_video_last7 AS audience_video_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211026 AND date <= 20211124 AND dim = 1 AND area IS NOT NULL AND CAST(level1 AS VARCHAR) = 'Education' AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND CAST(\"自定义 SQL 查询\".\"tag\" AS VARCHAR) = 'Industry' AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 2"
	},
	{
		"presto_sql" : "SELECT \"自定义 SQL 查询\".\"product_level2\" AS \"product_level2\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"usr_Calculation_3519281700079370244_ok\"\nFROM (SELECT date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n      total AS totalUsage,\n      audio AS audio,\n      video AS video,\n        host_sd + audience_sd AS video_sd,\n        host_hd + audience_hd AS video_hd,\n        host_hdp + audience_hdp AS video_hdp,\n      host_audio AS host_audio,\n      audience_audio AS audience_audio,\n      host_sd AS host_sd,\n      host_hd AS host_hd,\n      host_hdp AS host_hdp,\n      audience_sd AS audience_sd,\n      audience_hd AS audience_hd,\n      audience_hdp AS audience_hdp,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      total_last7 AS total_last7,\n      audio_last7 AS audio_last7,\n      video_last7 AS video_last7,\n      video_sd_last7 AS video_sd_last7,\n      video_hd_last7 AS video_hd_last7,\n      video_hdp_last7 AS video_hdp_last7,\n      host_sd_last7 AS host_sd_last7,\n      audience_sd_last7 AS audience_sd_last7,\n      host_hd_last7 AS host_hd_last7,\n      audience_hd_last7 AS audience_hd_last7,\n      host_hdp_last7 AS host_hdp_last7,\n      audience_hdp_last7 AS audience_hdp_last7,\n      host_audio_last7 AS host_audio_last7,\n      audience_audio_last7 AS audience_audio_last7,\n      host_video_last7 AS host_video_last7,\n      audience_video_last7 AS audience_video_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211026 AND date <= 20211124 AND dim = 1 AND area IS NOT NULL AND CAST(level1 AS VARCHAR) = 'Education' AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          tag,\n          area AS Scope,\n          dim,\n            CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n            CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n            CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n          total AS totalUsage,\n          audio AS audio,\n          video AS video,\n            host_sd + audience_sd AS video_sd,\n            host_hd + audience_hd AS video_hd,\n            host_hdp + audience_hdp AS video_hdp,\n          host_audio AS host_audio,\n          audience_audio AS audience_audio,\n          host_sd AS host_sd,\n          host_hd AS host_hd,\n          host_hdp AS host_hdp,\n          audience_sd AS audience_sd,\n          audience_hd AS audience_hd,\n          audience_hdp AS audience_hdp,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          total_last7 AS total_last7,\n          audio_last7 AS audio_last7,\n          video_last7 AS video_last7,\n          video_sd_last7 AS video_sd_last7,\n          video_hd_last7 AS video_hd_last7,\n          video_hdp_last7 AS video_hdp_last7,\n          host_sd_last7 AS host_sd_last7,\n          audience_sd_last7 AS audience_sd_last7,\n          host_hd_last7 AS host_hd_last7,\n          audience_hd_last7 AS audience_hd_last7,\n          host_hdp_last7 AS host_hdp_last7,\n          audience_hdp_last7 AS audience_hdp_last7,\n          host_audio_last7 AS host_audio_last7,\n          audience_audio_last7 AS audience_audio_last7,\n          host_video_last7 AS host_video_last7,\n          audience_video_last7 AS audience_video_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211026 AND date <= 20211124 AND dim = 1 AND area IS NOT NULL AND CAST(level1 AS VARCHAR) = 'Education' AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND CAST(\"自定义 SQL 查询\".\"tag\" AS VARCHAR) = 'Industry' AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 1"
	},
	{
		"presto_sql" : "SELECT \"自定义 SQL 查询\".\"product_level3\" AS \"product_level3\"\nFROM (SELECT date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n      total AS totalUsage,\n      audio AS audio,\n      video AS video,\n        host_sd + audience_sd AS video_sd,\n        host_hd + audience_hd AS video_hd,\n        host_hdp + audience_hdp AS video_hdp,\n      host_audio AS host_audio,\n      audience_audio AS audience_audio,\n      host_sd AS host_sd,\n      host_hd AS host_hd,\n      host_hdp AS host_hdp,\n      audience_sd AS audience_sd,\n      audience_hd AS audience_hd,\n      audience_hdp AS audience_hdp,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      total_last7 AS total_last7,\n      audio_last7 AS audio_last7,\n      video_last7 AS video_last7,\n      video_sd_last7 AS video_sd_last7,\n      video_hd_last7 AS video_hd_last7,\n      video_hdp_last7 AS video_hdp_last7,\n      host_sd_last7 AS host_sd_last7,\n      audience_sd_last7 AS audience_sd_last7,\n      host_hd_last7 AS host_hd_last7,\n      audience_hd_last7 AS audience_hd_last7,\n      host_hdp_last7 AS host_hdp_last7,\n      audience_hdp_last7 AS audience_hdp_last7,\n      host_audio_last7 AS host_audio_last7,\n      audience_audio_last7 AS audience_audio_last7,\n      host_video_last7 AS host_video_last7,\n      audience_video_last7 AS audience_video_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211026 AND date <= 20211124 AND dim = 1 AND area IS NOT NULL AND CAST(level1 AS VARCHAR) = 'Education' AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\nGROUP BY 1\nORDER BY \"product_level3\""
	},
	{
		"presto_sql" : "SELECT \"自定义 SQL 查询\".\"product_level2\" AS \"product_level2\"\nFROM (SELECT date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n      total AS totalUsage,\n      audio AS audio,\n      video AS video,\n        host_sd + audience_sd AS video_sd,\n        host_hd + audience_hd AS video_hd,\n        host_hdp + audience_hdp AS video_hdp,\n      host_audio AS host_audio,\n      audience_audio AS audience_audio,\n      host_sd AS host_sd,\n      host_hd AS host_hd,\n      host_hdp AS host_hdp,\n      audience_sd AS audience_sd,\n      audience_hd AS audience_hd,\n      audience_hdp AS audience_hdp,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      total_last7 AS total_last7,\n      audio_last7 AS audio_last7,\n      video_last7 AS video_last7,\n      video_sd_last7 AS video_sd_last7,\n      video_hd_last7 AS video_hd_last7,\n      video_hdp_last7 AS video_hdp_last7,\n      host_sd_last7 AS host_sd_last7,\n      audience_sd_last7 AS audience_sd_last7,\n      host_hd_last7 AS host_hd_last7,\n      audience_hd_last7 AS audience_hd_last7,\n      host_hdp_last7 AS host_hdp_last7,\n      audience_hdp_last7 AS audience_hdp_last7,\n      host_audio_last7 AS host_audio_last7,\n      audience_audio_last7 AS audience_audio_last7,\n      host_video_last7 AS host_video_last7,\n      audience_video_last7 AS audience_video_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211026 AND date <= 20211124 AND dim = 1 AND area IS NOT NULL AND CAST(level1 AS VARCHAR) = 'Education' AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\nGROUP BY 1\nORDER BY \"product_level2\""
	},
	{
		"presto_sql" : "SELECT \"自定义 SQL 查询\".\"cid_industry\" AS \"cid_industry\",\n  \"自定义 SQL 查询\".\"stat_date\" AS \"stat_date\"\nFROM (SELECT date,\n      start_date AS start_date,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name,\n      SUM(total) AS totalUsage,\n      SUM(audio) AS audio,\n      SUM(video) AS video,\n      SUM(host_sd + audience_sd) AS video_sd,\n      SUM(host_hd + audience_hd) AS video_hd,\n      SUM(host_hdp + audience_hdp) AS video_hdp,\n      SUM(host_audio) AS host_audio,\n      SUM(audience_audio) AS audience_audio,\n      SUM(host_sd) AS host_sd,\n      SUM(host_hd) AS host_hd,\n      SUM(host_hdp) AS host_hdp,\n      SUM(host_1080p) AS host_1080p,\n      SUM(host_2k) AS host_2k,\n      SUM(host_4k) AS host_4k,\n      SUM(audience_sd) AS audience_sd,\n      SUM(audience_hd) AS audience_hd,\n      SUM(audience_hdp) AS audience_hdp,\n      SUM(audience_1080p) AS audience_1080p,\n      SUM(audience_2k) AS audience_2k,\n      SUM(audience_4k) AS audience_4k,\n      SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n      SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n      SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n      SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n      SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n      SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n      SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n      SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n      SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n      SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n      SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n      SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n      SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n      SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n      SUM(total_last1) AS audio_video_last,\n      SUM(audio_last1) AS audio_last,\n      SUM(video_last1) AS video_last,\n      SUM(video_sd_last1) AS video_sd_last,\n      SUM(video_hd_last1) AS video_hd_last,\n      SUM(video_hdp_last1) AS video_hdp_last,\n      SUM(host_sd_last1) AS host_video_sd_last,\n      SUM(audience_sd_last1) AS audience_video_sd_last,\n      SUM(host_hd_last1) AS host_video_hd_last,\n      SUM(audience_hd_last1) AS audience_video_hd_last,\n      SUM(host_hdp_last1) AS host_video_hdp_last,\n      SUM(audience_hdp_last1) AS audience_video_hdp_last,\n      SUM(host_audio_last1) AS host_audio_last,\n      SUM(audience_audio_last1) AS audience_audio_last,\n      SUM(host_video_last1) AS host_video_last,\n      SUM(audience_video_last1) AS audience_video_last,\n      SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n      SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n      SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n      SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n      SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n      SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n      SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n      SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n      SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n      SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n      SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n      SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n      SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n      SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n      SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n      SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n      SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n      SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n      SUM(audience_2k_last1) AS audience_2k_last1,\n      SUM(audience_4k_last1) AS audience_4k_last1,\n      SUM(audience_1080p_last1) AS audience_1080p_last1,\n      SUM(host_1080p_last1) AS host_1080p_last1,\n      SUM(host_2k_last1) AS host_2k_last1,\n      SUM(host_4k_last1) AS host_4k_last1,\n      SUM(total_last7) AS total_last7,\n      SUM(audio_last7) AS audio_last7,\n      SUM(video_last7) AS video_last7,\n      SUM(video_sd_last7) AS video_sd_last7,\n      SUM(video_hd_last7) AS video_hd_last7,\n      SUM(video_hdp_last7) AS video_hdp_last7,\n      SUM(host_sd_last7) AS host_sd_last7,\n      SUM(audience_sd_last7) AS audience_sd_last7,\n      SUM(host_hd_last7) AS host_hd_last7,\n      SUM(audience_hd_last7) AS audience_hd_last7,\n      SUM(host_hdp_last7) AS host_hdp_last7,\n      SUM(audience_hdp_last7) AS audience_hdp_last7,\n      SUM(host_audio_last7) AS host_audio_last7,\n      SUM(audience_audio_last7) AS audience_audio_last7,\n      SUM(host_video_last7) AS host_video_last7,\n      SUM(audience_video_last7) AS audience_video_last7,\n      SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n      SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n      SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n      SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n      SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n      SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n      SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n      SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n      SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n      SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n      SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n      SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n      SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n      SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n      SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n      SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n      SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n      SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n      SUM(audience_2k_last7) AS audience_2k_last7,\n      SUM(audience_4k_last7) AS audience_4k_last7,\n      SUM(audience_1080p_last7) AS audience_1080p_last7,\n      SUM(host_1080p_last7) AS host_1080p_last7,\n      SUM(host_2k_last7) AS host_2k_last7,\n      SUM(host_4k_last7) AS host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211001 AND date <= 20211128 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n    GROUP BY date,\n      DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n      2,\n      3,\n      tag,\n      area,\n      dim,\n      8,\n      9,\n      10,\n      level4,\n      product_level1,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en,\n      vid_use_case_en,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name) AS \"自定义 SQL 查询\"\nWHERE \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 3 AND CAST(\"自定义 SQL 查询\".\"level1\" AS VARCHAR) = 'RTSA'\nGROUP BY 1,\n  2"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_96897765691088903)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video_sd\") AS \"TEMP(Calculation_96897765691088903)(3165650715)(0)\",\n  MAX(\"自定义 SQL 查询\".\"stat_date\") AS \"TEMP(attr_stat_date_nk)(2102638629)(0)\",\n  MIN(\"自定义 SQL 查询\".\"stat_date\") AS \"TEMP(attr_stat_date_nk)(2790680713)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video_hdp\") AS \"TEMP(sd百分比 (复制) (复制)_96897765691801609)(15603621\",\n  SUM(\"自定义 SQL 查询\".\"video_hd\") AS \"TEMP(sd百分比 (复制)_96897765691785224)(843876055)(0)\",\n  \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"sum_audio_ok\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"sum_totalUsage_ok\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"sum_video_ok\",\n  SUM(\"自定义 SQL 查询\".\"video_hd\") AS \"sum_video_hd_ok\",\n  SUM(\"自定义 SQL 查询\".\"video_hdp\") AS \"sum_video_hdp_ok\",\n  SUM(\"自定义 SQL 查询\".\"video_sd\") AS \"sum_video_sd_ok\",\n  DATE_ADD('SECOND', 0, date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"tdy_date_ok\"\nFROM (SELECT date,\n      start_date AS start_date,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name,\n      SUM(total) AS totalUsage,\n      SUM(audio) AS audio,\n      SUM(video) AS video,\n      SUM(host_sd + audience_sd) AS video_sd,\n      SUM(host_hd + audience_hd) AS video_hd,\n      SUM(host_hdp + audience_hdp) AS video_hdp,\n      SUM(host_audio) AS host_audio,\n      SUM(audience_audio) AS audience_audio,\n      SUM(host_sd) AS host_sd,\n      SUM(host_hd) AS host_hd,\n      SUM(host_hdp) AS host_hdp,\n      SUM(host_1080p) AS host_1080p,\n      SUM(host_2k) AS host_2k,\n      SUM(host_4k) AS host_4k,\n      SUM(audience_sd) AS audience_sd,\n      SUM(audience_hd) AS audience_hd,\n      SUM(audience_hdp) AS audience_hdp,\n      SUM(audience_1080p) AS audience_1080p,\n      SUM(audience_2k) AS audience_2k,\n      SUM(audience_4k) AS audience_4k,\n      SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n      SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n      SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n      SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n      SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n      SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n      SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n      SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n      SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n      SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n      SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n      SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n      SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n      SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n      SUM(total_last1) AS audio_video_last,\n      SUM(audio_last1) AS audio_last,\n      SUM(video_last1) AS video_last,\n      SUM(video_sd_last1) AS video_sd_last,\n      SUM(video_hd_last1) AS video_hd_last,\n      SUM(video_hdp_last1) AS video_hdp_last,\n      SUM(host_sd_last1) AS host_video_sd_last,\n      SUM(audience_sd_last1) AS audience_video_sd_last,\n      SUM(host_hd_last1) AS host_video_hd_last,\n      SUM(audience_hd_last1) AS audience_video_hd_last,\n      SUM(host_hdp_last1) AS host_video_hdp_last,\n      SUM(audience_hdp_last1) AS audience_video_hdp_last,\n      SUM(host_audio_last1) AS host_audio_last,\n      SUM(audience_audio_last1) AS audience_audio_last,\n      SUM(host_video_last1) AS host_video_last,\n      SUM(audience_video_last1) AS audience_video_last,\n      SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n      SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n      SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n      SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n      SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n      SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n      SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n      SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n      SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n      SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n      SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n      SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n      SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n      SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n      SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n      SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n      SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n      SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n      SUM(audience_2k_last1) AS audience_2k_last1,\n      SUM(audience_4k_last1) AS audience_4k_last1,\n      SUM(audience_1080p_last1) AS audience_1080p_last1,\n      SUM(host_1080p_last1) AS host_1080p_last1,\n      SUM(host_2k_last1) AS host_2k_last1,\n      SUM(host_4k_last1) AS host_4k_last1,\n      SUM(total_last7) AS total_last7,\n      SUM(audio_last7) AS audio_last7,\n      SUM(video_last7) AS video_last7,\n      SUM(video_sd_last7) AS video_sd_last7,\n      SUM(video_hd_last7) AS video_hd_last7,\n      SUM(video_hdp_last7) AS video_hdp_last7,\n      SUM(host_sd_last7) AS host_sd_last7,\n      SUM(audience_sd_last7) AS audience_sd_last7,\n      SUM(host_hd_last7) AS host_hd_last7,\n      SUM(audience_hd_last7) AS audience_hd_last7,\n      SUM(host_hdp_last7) AS host_hdp_last7,\n      SUM(audience_hdp_last7) AS audience_hdp_last7,\n      SUM(host_audio_last7) AS host_audio_last7,\n      SUM(audience_audio_last7) AS audience_audio_last7,\n      SUM(host_video_last7) AS host_video_last7,\n      SUM(audience_video_last7) AS audience_video_last7,\n      SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n      SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n      SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n      SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n      SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n      SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n      SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n      SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n      SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n      SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n      SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n      SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n      SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n      SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n      SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n      SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n      SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n      SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n      SUM(audience_2k_last7) AS audience_2k_last7,\n      SUM(audience_4k_last7) AS audience_4k_last7,\n      SUM(audience_1080p_last7) AS audience_1080p_last7,\n      SUM(host_1080p_last7) AS host_1080p_last7,\n      SUM(host_2k_last7) AS host_2k_last7,\n      SUM(host_4k_last7) AS host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211001 AND date <= 20211128 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n    GROUP BY date,\n      DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n      2,\n      3,\n      tag,\n      area,\n      dim,\n      8,\n      9,\n      10,\n      level4,\n      product_level1,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en,\n      vid_use_case_en,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name) AS \"自定义 SQL 查询\"\nWHERE CAST(\"自定义 SQL 查询\".\"level1\" AS VARCHAR) = 'RTSA' AND \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 3\nGROUP BY 7,\n  14"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700079370244)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700079370244)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700079370244)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700079370244)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700079370244)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700079370244)(943764407)(0)\",\n  MIN(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(1482809429)(0)\",\n  MIN(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(3765460736)(0)\",\n  \"自定义 SQL 查询\".\"stat_date\" AS \"TEMP(attr_stat_date_nk)(2102638629)(0)\",\n  \"自定义 SQL 查询\".\"stat_date\" AS \"TEMP(attr_stat_date_nk)(2790680713)(0)\",\n  \"自定义 SQL 查询\".\"product_level3\" AS \"product_level3\",\n  \"自定义 SQL 查询\".\"stat_date\" AS \"stat_date\"\nFROM (SELECT date,\n      start_date AS start_date,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name,\n      SUM(total) AS totalUsage,\n      SUM(audio) AS audio,\n      SUM(video) AS video,\n      SUM(host_sd + audience_sd) AS video_sd,\n      SUM(host_hd + audience_hd) AS video_hd,\n      SUM(host_hdp + audience_hdp) AS video_hdp,\n      SUM(host_audio) AS host_audio,\n      SUM(audience_audio) AS audience_audio,\n      SUM(host_sd) AS host_sd,\n      SUM(host_hd) AS host_hd,\n      SUM(host_hdp) AS host_hdp,\n      SUM(host_1080p) AS host_1080p,\n      SUM(host_2k) AS host_2k,\n      SUM(host_4k) AS host_4k,\n      SUM(audience_sd) AS audience_sd,\n      SUM(audience_hd) AS audience_hd,\n      SUM(audience_hdp) AS audience_hdp,\n      SUM(audience_1080p) AS audience_1080p,\n      SUM(audience_2k) AS audience_2k,\n      SUM(audience_4k) AS audience_4k,\n      SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n      SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n      SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n      SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n      SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n      SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n      SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n      SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n      SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n      SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n      SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n      SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n      SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n      SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n      SUM(total_last1) AS audio_video_last,\n      SUM(audio_last1) AS audio_last,\n      SUM(video_last1) AS video_last,\n      SUM(video_sd_last1) AS video_sd_last,\n      SUM(video_hd_last1) AS video_hd_last,\n      SUM(video_hdp_last1) AS video_hdp_last,\n      SUM(host_sd_last1) AS host_video_sd_last,\n      SUM(audience_sd_last1) AS audience_video_sd_last,\n      SUM(host_hd_last1) AS host_video_hd_last,\n      SUM(audience_hd_last1) AS audience_video_hd_last,\n      SUM(host_hdp_last1) AS host_video_hdp_last,\n      SUM(audience_hdp_last1) AS audience_video_hdp_last,\n      SUM(host_audio_last1) AS host_audio_last,\n      SUM(audience_audio_last1) AS audience_audio_last,\n      SUM(host_video_last1) AS host_video_last,\n      SUM(audience_video_last1) AS audience_video_last,\n      SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n      SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n      SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n      SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n      SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n      SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n      SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n      SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n      SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n      SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n      SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n      SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n      SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n      SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n      SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n      SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n      SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n      SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n      SUM(audience_2k_last1) AS audience_2k_last1,\n      SUM(audience_4k_last1) AS audience_4k_last1,\n      SUM(audience_1080p_last1) AS audience_1080p_last1,\n      SUM(host_1080p_last1) AS host_1080p_last1,\n      SUM(host_2k_last1) AS host_2k_last1,\n      SUM(host_4k_last1) AS host_4k_last1,\n      SUM(total_last7) AS total_last7,\n      SUM(audio_last7) AS audio_last7,\n      SUM(video_last7) AS video_last7,\n      SUM(video_sd_last7) AS video_sd_last7,\n      SUM(video_hd_last7) AS video_hd_last7,\n      SUM(video_hdp_last7) AS video_hdp_last7,\n      SUM(host_sd_last7) AS host_sd_last7,\n      SUM(audience_sd_last7) AS audience_sd_last7,\n      SUM(host_hd_last7) AS host_hd_last7,\n      SUM(audience_hd_last7) AS audience_hd_last7,\n      SUM(host_hdp_last7) AS host_hdp_last7,\n      SUM(audience_hdp_last7) AS audience_hdp_last7,\n      SUM(host_audio_last7) AS host_audio_last7,\n      SUM(audience_audio_last7) AS audience_audio_last7,\n      SUM(host_video_last7) AS host_video_last7,\n      SUM(audience_video_last7) AS audience_video_last7,\n      SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n      SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n      SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n      SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n      SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n      SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n      SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n      SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n      SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n      SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n      SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n      SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n      SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n      SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n      SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n      SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n      SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n      SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n      SUM(audience_2k_last7) AS audience_2k_last7,\n      SUM(audience_4k_last7) AS audience_4k_last7,\n      SUM(audience_1080p_last7) AS audience_1080p_last7,\n      SUM(host_1080p_last7) AS host_1080p_last7,\n      SUM(host_2k_last7) AS host_2k_last7,\n      SUM(host_4k_last7) AS host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211001 AND date <= 20211128 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n    GROUP BY date,\n      DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n      2,\n      3,\n      tag,\n      area,\n      dim,\n      8,\n      9,\n      10,\n      level4,\n      product_level1,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en,\n      vid_use_case_en,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name) AS \"自定义 SQL 查询\"\nWHERE \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 3 AND CAST(\"自定义 SQL 查询\".\"level1\" AS VARCHAR) = 'RTSA'\nGROUP BY 22,\n  20"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"audio_last7\") AS \"TEMP(Calculation_96897765680816128)(2589233512)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_96897765680816128)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(audio同比 (复制)_96897765681725441)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video_last7\") AS \"TEMP(audio同比 (复制)_96897765681725441)(4107040267)(0)\",\n  SUM(\"自定义 SQL 查询\".\"total_last7\") AS \"TEMP(video同比 (复制)_96897765683347458)(346677966)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(video同比 (复制)_96897765683347458)(3847882359)(0)\",\n  \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"audio_video_last\") AS \"sum_audio_video_last_ok\"\nFROM (SELECT date,\n      start_date AS start_date,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name,\n      SUM(total) AS totalUsage,\n      SUM(audio) AS audio,\n      SUM(video) AS video,\n      SUM(host_sd + audience_sd) AS video_sd,\n      SUM(host_hd + audience_hd) AS video_hd,\n      SUM(host_hdp + audience_hdp) AS video_hdp,\n      SUM(host_audio) AS host_audio,\n      SUM(audience_audio) AS audience_audio,\n      SUM(host_sd) AS host_sd,\n      SUM(host_hd) AS host_hd,\n      SUM(host_hdp) AS host_hdp,\n      SUM(host_1080p) AS host_1080p,\n      SUM(host_2k) AS host_2k,\n      SUM(host_4k) AS host_4k,\n      SUM(audience_sd) AS audience_sd,\n      SUM(audience_hd) AS audience_hd,\n      SUM(audience_hdp) AS audience_hdp,\n      SUM(audience_1080p) AS audience_1080p,\n      SUM(audience_2k) AS audience_2k,\n      SUM(audience_4k) AS audience_4k,\n      SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n      SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n      SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n      SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n      SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n      SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n      SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n      SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n      SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n      SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n      SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n      SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n      SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n      SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n      SUM(total_last1) AS audio_video_last,\n      SUM(audio_last1) AS audio_last,\n      SUM(video_last1) AS video_last,\n      SUM(video_sd_last1) AS video_sd_last,\n      SUM(video_hd_last1) AS video_hd_last,\n      SUM(video_hdp_last1) AS video_hdp_last,\n      SUM(host_sd_last1) AS host_video_sd_last,\n      SUM(audience_sd_last1) AS audience_video_sd_last,\n      SUM(host_hd_last1) AS host_video_hd_last,\n      SUM(audience_hd_last1) AS audience_video_hd_last,\n      SUM(host_hdp_last1) AS host_video_hdp_last,\n      SUM(audience_hdp_last1) AS audience_video_hdp_last,\n      SUM(host_audio_last1) AS host_audio_last,\n      SUM(audience_audio_last1) AS audience_audio_last,\n      SUM(host_video_last1) AS host_video_last,\n      SUM(audience_video_last1) AS audience_video_last,\n      SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n      SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n      SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n      SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n      SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n      SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n      SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n      SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n      SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n      SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n      SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n      SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n      SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n      SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n      SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n      SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n      SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n      SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n      SUM(audience_2k_last1) AS audience_2k_last1,\n      SUM(audience_4k_last1) AS audience_4k_last1,\n      SUM(audience_1080p_last1) AS audience_1080p_last1,\n      SUM(host_1080p_last1) AS host_1080p_last1,\n      SUM(host_2k_last1) AS host_2k_last1,\n      SUM(host_4k_last1) AS host_4k_last1,\n      SUM(total_last7) AS total_last7,\n      SUM(audio_last7) AS audio_last7,\n      SUM(video_last7) AS video_last7,\n      SUM(video_sd_last7) AS video_sd_last7,\n      SUM(video_hd_last7) AS video_hd_last7,\n      SUM(video_hdp_last7) AS video_hdp_last7,\n      SUM(host_sd_last7) AS host_sd_last7,\n      SUM(audience_sd_last7) AS audience_sd_last7,\n      SUM(host_hd_last7) AS host_hd_last7,\n      SUM(audience_hd_last7) AS audience_hd_last7,\n      SUM(host_hdp_last7) AS host_hdp_last7,\n      SUM(audience_hdp_last7) AS audience_hdp_last7,\n      SUM(host_audio_last7) AS host_audio_last7,\n      SUM(audience_audio_last7) AS audience_audio_last7,\n      SUM(host_video_last7) AS host_video_last7,\n      SUM(audience_video_last7) AS audience_video_last7,\n      SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n      SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n      SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n      SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n      SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n      SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n      SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n      SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n      SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n      SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n      SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n      SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n      SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n      SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n      SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n      SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n      SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n      SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n      SUM(audience_2k_last7) AS audience_2k_last7,\n      SUM(audience_4k_last7) AS audience_4k_last7,\n      SUM(audience_1080p_last7) AS audience_1080p_last7,\n      SUM(host_1080p_last7) AS host_1080p_last7,\n      SUM(host_2k_last7) AS host_2k_last7,\n      SUM(host_4k_last7) AS host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211001 AND date <= 20211128 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n    GROUP BY date,\n      DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n      2,\n      3,\n      tag,\n      area,\n      dim,\n      8,\n      9,\n      10,\n      level4,\n      product_level1,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en,\n      vid_use_case_en,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n          start_date AS start_date,\n          end_date AS end_date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          tag,\n          area AS Scope,\n          dim,\n            CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n            CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n            CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          browser,\n          browser_ver,\n          dim_grouping_name,\n          SUM(total) AS totalUsage,\n          SUM(audio) AS audio,\n          SUM(video) AS video,\n          SUM(host_sd + audience_sd) AS video_sd,\n          SUM(host_hd + audience_hd) AS video_hd,\n          SUM(host_hdp + audience_hdp) AS video_hdp,\n          SUM(host_audio) AS host_audio,\n          SUM(audience_audio) AS audience_audio,\n          SUM(host_sd) AS host_sd,\n          SUM(host_hd) AS host_hd,\n          SUM(host_hdp) AS host_hdp,\n          SUM(host_1080p) AS host_1080p,\n          SUM(host_2k) AS host_2k,\n          SUM(host_4k) AS host_4k,\n          SUM(audience_sd) AS audience_sd,\n          SUM(audience_hd) AS audience_hd,\n          SUM(audience_hdp) AS audience_hdp,\n          SUM(audience_1080p) AS audience_1080p,\n          SUM(audience_2k) AS audience_2k,\n          SUM(audience_4k) AS audience_4k,\n          SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n          SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n          SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n          SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n          SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n          SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n          SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n          SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n          SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n          SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n          SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n          SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n          SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n          SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n          SUM(total_last1) AS audio_video_last,\n          SUM(audio_last1) AS audio_last,\n          SUM(video_last1) AS video_last,\n          SUM(video_sd_last1) AS video_sd_last,\n          SUM(video_hd_last1) AS video_hd_last,\n          SUM(video_hdp_last1) AS video_hdp_last,\n          SUM(host_sd_last1) AS host_video_sd_last,\n          SUM(audience_sd_last1) AS audience_video_sd_last,\n          SUM(host_hd_last1) AS host_video_hd_last,\n          SUM(audience_hd_last1) AS audience_video_hd_last,\n          SUM(host_hdp_last1) AS host_video_hdp_last,\n          SUM(audience_hdp_last1) AS audience_video_hdp_last,\n          SUM(host_audio_last1) AS host_audio_last,\n          SUM(audience_audio_last1) AS audience_audio_last,\n          SUM(host_video_last1) AS host_video_last,\n          SUM(audience_video_last1) AS audience_video_last,\n          SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n          SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n          SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n          SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n          SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n          SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n          SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n          SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n          SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n          SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n          SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n          SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n          SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n          SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n          SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n          SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n          SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n          SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n          SUM(audience_2k_last1) AS audience_2k_last1,\n          SUM(audience_4k_last1) AS audience_4k_last1,\n          SUM(audience_1080p_last1) AS audience_1080p_last1,\n          SUM(host_1080p_last1) AS host_1080p_last1,\n          SUM(host_2k_last1) AS host_2k_last1,\n          SUM(host_4k_last1) AS host_4k_last1,\n          SUM(total_last7) AS total_last7,\n          SUM(audio_last7) AS audio_last7,\n          SUM(video_last7) AS video_last7,\n          SUM(video_sd_last7) AS video_sd_last7,\n          SUM(video_hd_last7) AS video_hd_last7,\n          SUM(video_hdp_last7) AS video_hdp_last7,\n          SUM(host_sd_last7) AS host_sd_last7,\n          SUM(audience_sd_last7) AS audience_sd_last7,\n          SUM(host_hd_last7) AS host_hd_last7,\n          SUM(audience_hd_last7) AS audience_hd_last7,\n          SUM(host_hdp_last7) AS host_hdp_last7,\n          SUM(audience_hdp_last7) AS audience_hdp_last7,\n          SUM(host_audio_last7) AS host_audio_last7,\n          SUM(audience_audio_last7) AS audience_audio_last7,\n          SUM(host_video_last7) AS host_video_last7,\n          SUM(audience_video_last7) AS audience_video_last7,\n          SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n          SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n          SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n          SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n          SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n          SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n          SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n          SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n          SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n          SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n          SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n          SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n          SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n          SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n          SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n          SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n          SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n          SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n          SUM(audience_2k_last7) AS audience_2k_last7,\n          SUM(audience_4k_last7) AS audience_4k_last7,\n          SUM(audience_1080p_last7) AS audience_1080p_last7,\n          SUM(host_1080p_last7) AS host_1080p_last7,\n          SUM(host_2k_last7) AS host_2k_last7,\n          SUM(host_4k_last7) AS host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211001 AND date <= 20211128 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n        GROUP BY date,\n          DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n          2,\n          3,\n          tag,\n          area,\n          dim,\n          8,\n          9,\n          10,\n          level4,\n          product_level1,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en,\n          vid_use_case_en,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          browser,\n          browser_ver,\n          dim_grouping_name) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE CAST(\"自定义 SQL 查询\".\"level1\" AS VARCHAR) = 'RTSA' AND \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 3 AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 7"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700079370244)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700079370244)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700079370244)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700079370244)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700079370244)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700079370244)(943764407)(0)\",\n  MIN(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(1482809429)(0)\",\n  MIN(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(3765460736)(0)\",\n  MAX(\"自定义 SQL 查询\".\"stat_date\") AS \"TEMP(attr_stat_date_nk)(2102638629)(0)\",\n  MIN(\"自定义 SQL 查询\".\"stat_date\") AS \"TEMP(attr_stat_date_nk)(2790680713)(0)\",\n  \"自定义 SQL 查询\".\"cid_industry\" AS \"cid_industry\"\nFROM (SELECT date,\n      start_date AS start_date,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name,\n      SUM(total) AS totalUsage,\n      SUM(audio) AS audio,\n      SUM(video) AS video,\n      SUM(host_sd + audience_sd) AS video_sd,\n      SUM(host_hd + audience_hd) AS video_hd,\n      SUM(host_hdp + audience_hdp) AS video_hdp,\n      SUM(host_audio) AS host_audio,\n      SUM(audience_audio) AS audience_audio,\n      SUM(host_sd) AS host_sd,\n      SUM(host_hd) AS host_hd,\n      SUM(host_hdp) AS host_hdp,\n      SUM(host_1080p) AS host_1080p,\n      SUM(host_2k) AS host_2k,\n      SUM(host_4k) AS host_4k,\n      SUM(audience_sd) AS audience_sd,\n      SUM(audience_hd) AS audience_hd,\n      SUM(audience_hdp) AS audience_hdp,\n      SUM(audience_1080p) AS audience_1080p,\n      SUM(audience_2k) AS audience_2k,\n      SUM(audience_4k) AS audience_4k,\n      SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n      SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n      SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n      SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n      SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n      SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n      SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n      SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n      SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n      SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n      SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n      SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n      SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n      SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n      SUM(total_last1) AS audio_video_last,\n      SUM(audio_last1) AS audio_last,\n      SUM(video_last1) AS video_last,\n      SUM(video_sd_last1) AS video_sd_last,\n      SUM(video_hd_last1) AS video_hd_last,\n      SUM(video_hdp_last1) AS video_hdp_last,\n      SUM(host_sd_last1) AS host_video_sd_last,\n      SUM(audience_sd_last1) AS audience_video_sd_last,\n      SUM(host_hd_last1) AS host_video_hd_last,\n      SUM(audience_hd_last1) AS audience_video_hd_last,\n      SUM(host_hdp_last1) AS host_video_hdp_last,\n      SUM(audience_hdp_last1) AS audience_video_hdp_last,\n      SUM(host_audio_last1) AS host_audio_last,\n      SUM(audience_audio_last1) AS audience_audio_last,\n      SUM(host_video_last1) AS host_video_last,\n      SUM(audience_video_last1) AS audience_video_last,\n      SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n      SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n      SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n      SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n      SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n      SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n      SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n      SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n      SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n      SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n      SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n      SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n      SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n      SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n      SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n      SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n      SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n      SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n      SUM(audience_2k_last1) AS audience_2k_last1,\n      SUM(audience_4k_last1) AS audience_4k_last1,\n      SUM(audience_1080p_last1) AS audience_1080p_last1,\n      SUM(host_1080p_last1) AS host_1080p_last1,\n      SUM(host_2k_last1) AS host_2k_last1,\n      SUM(host_4k_last1) AS host_4k_last1,\n      SUM(total_last7) AS total_last7,\n      SUM(audio_last7) AS audio_last7,\n      SUM(video_last7) AS video_last7,\n      SUM(video_sd_last7) AS video_sd_last7,\n      SUM(video_hd_last7) AS video_hd_last7,\n      SUM(video_hdp_last7) AS video_hdp_last7,\n      SUM(host_sd_last7) AS host_sd_last7,\n      SUM(audience_sd_last7) AS audience_sd_last7,\n      SUM(host_hd_last7) AS host_hd_last7,\n      SUM(audience_hd_last7) AS audience_hd_last7,\n      SUM(host_hdp_last7) AS host_hdp_last7,\n      SUM(audience_hdp_last7) AS audience_hdp_last7,\n      SUM(host_audio_last7) AS host_audio_last7,\n      SUM(audience_audio_last7) AS audience_audio_last7,\n      SUM(host_video_last7) AS host_video_last7,\n      SUM(audience_video_last7) AS audience_video_last7,\n      SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n      SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n      SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n      SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n      SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n      SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n      SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n      SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n      SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n      SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n      SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n      SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n      SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n      SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n      SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n      SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n      SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n      SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n      SUM(audience_2k_last7) AS audience_2k_last7,\n      SUM(audience_4k_last7) AS audience_4k_last7,\n      SUM(audience_1080p_last7) AS audience_1080p_last7,\n      SUM(host_1080p_last7) AS host_1080p_last7,\n      SUM(host_2k_last7) AS host_2k_last7,\n      SUM(host_4k_last7) AS host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211001 AND date <= 20211128 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n    GROUP BY date,\n      DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n      2,\n      3,\n      tag,\n      area,\n      dim,\n      8,\n      9,\n      10,\n      level4,\n      product_level1,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en,\n      vid_use_case_en,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n          start_date AS start_date,\n          end_date AS end_date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          tag,\n          area AS Scope,\n          dim,\n            CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n            CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n            CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          browser,\n          browser_ver,\n          dim_grouping_name,\n          SUM(total) AS totalUsage,\n          SUM(audio) AS audio,\n          SUM(video) AS video,\n          SUM(host_sd + audience_sd) AS video_sd,\n          SUM(host_hd + audience_hd) AS video_hd,\n          SUM(host_hdp + audience_hdp) AS video_hdp,\n          SUM(host_audio) AS host_audio,\n          SUM(audience_audio) AS audience_audio,\n          SUM(host_sd) AS host_sd,\n          SUM(host_hd) AS host_hd,\n          SUM(host_hdp) AS host_hdp,\n          SUM(host_1080p) AS host_1080p,\n          SUM(host_2k) AS host_2k,\n          SUM(host_4k) AS host_4k,\n          SUM(audience_sd) AS audience_sd,\n          SUM(audience_hd) AS audience_hd,\n          SUM(audience_hdp) AS audience_hdp,\n          SUM(audience_1080p) AS audience_1080p,\n          SUM(audience_2k) AS audience_2k,\n          SUM(audience_4k) AS audience_4k,\n          SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n          SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n          SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n          SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n          SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n          SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n          SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n          SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n          SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n          SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n          SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n          SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n          SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n          SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n          SUM(total_last1) AS audio_video_last,\n          SUM(audio_last1) AS audio_last,\n          SUM(video_last1) AS video_last,\n          SUM(video_sd_last1) AS video_sd_last,\n          SUM(video_hd_last1) AS video_hd_last,\n          SUM(video_hdp_last1) AS video_hdp_last,\n          SUM(host_sd_last1) AS host_video_sd_last,\n          SUM(audience_sd_last1) AS audience_video_sd_last,\n          SUM(host_hd_last1) AS host_video_hd_last,\n          SUM(audience_hd_last1) AS audience_video_hd_last,\n          SUM(host_hdp_last1) AS host_video_hdp_last,\n          SUM(audience_hdp_last1) AS audience_video_hdp_last,\n          SUM(host_audio_last1) AS host_audio_last,\n          SUM(audience_audio_last1) AS audience_audio_last,\n          SUM(host_video_last1) AS host_video_last,\n          SUM(audience_video_last1) AS audience_video_last,\n          SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n          SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n          SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n          SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n          SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n          SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n          SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n          SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n          SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n          SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n          SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n          SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n          SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n          SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n          SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n          SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n          SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n          SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n          SUM(audience_2k_last1) AS audience_2k_last1,\n          SUM(audience_4k_last1) AS audience_4k_last1,\n          SUM(audience_1080p_last1) AS audience_1080p_last1,\n          SUM(host_1080p_last1) AS host_1080p_last1,\n          SUM(host_2k_last1) AS host_2k_last1,\n          SUM(host_4k_last1) AS host_4k_last1,\n          SUM(total_last7) AS total_last7,\n          SUM(audio_last7) AS audio_last7,\n          SUM(video_last7) AS video_last7,\n          SUM(video_sd_last7) AS video_sd_last7,\n          SUM(video_hd_last7) AS video_hd_last7,\n          SUM(video_hdp_last7) AS video_hdp_last7,\n          SUM(host_sd_last7) AS host_sd_last7,\n          SUM(audience_sd_last7) AS audience_sd_last7,\n          SUM(host_hd_last7) AS host_hd_last7,\n          SUM(audience_hd_last7) AS audience_hd_last7,\n          SUM(host_hdp_last7) AS host_hdp_last7,\n          SUM(audience_hdp_last7) AS audience_hdp_last7,\n          SUM(host_audio_last7) AS host_audio_last7,\n          SUM(audience_audio_last7) AS audience_audio_last7,\n          SUM(host_video_last7) AS host_video_last7,\n          SUM(audience_video_last7) AS audience_video_last7,\n          SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n          SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n          SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n          SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n          SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n          SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n          SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n          SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n          SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n          SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n          SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n          SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n          SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n          SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n          SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n          SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n          SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n          SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n          SUM(audience_2k_last7) AS audience_2k_last7,\n          SUM(audience_4k_last7) AS audience_4k_last7,\n          SUM(audience_1080p_last7) AS audience_1080p_last7,\n          SUM(host_1080p_last7) AS host_1080p_last7,\n          SUM(host_2k_last7) AS host_2k_last7,\n          SUM(host_4k_last7) AS host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211001 AND date <= 20211128 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n        GROUP BY date,\n          DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n          2,\n          3,\n          tag,\n          area,\n          dim,\n          8,\n          9,\n          10,\n          level4,\n          product_level1,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en,\n          vid_use_case_en,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          browser,\n          browser_ver,\n          dim_grouping_name) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 3 AND CAST(\"自定义 SQL 查询\".\"level1\" AS VARCHAR) = 'RTSA' AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 22"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700079370244)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700079370244)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700079370244)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700079370244)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700079370244)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700079370244)(943764407)(0)\",\n  MIN(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(1482809429)(0)\",\n  MIN(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(3765460736)(0)\",\n  \"自定义 SQL 查询\".\"product_level2\" AS \"product_level2\",\n  \"自定义 SQL 查询\".\"stat_date\" AS \"stat_date\"\nFROM (SELECT date,\n      start_date AS start_date,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name,\n      SUM(total) AS totalUsage,\n      SUM(audio) AS audio,\n      SUM(video) AS video,\n      SUM(host_sd + audience_sd) AS video_sd,\n      SUM(host_hd + audience_hd) AS video_hd,\n      SUM(host_hdp + audience_hdp) AS video_hdp,\n      SUM(host_audio) AS host_audio,\n      SUM(audience_audio) AS audience_audio,\n      SUM(host_sd) AS host_sd,\n      SUM(host_hd) AS host_hd,\n      SUM(host_hdp) AS host_hdp,\n      SUM(host_1080p) AS host_1080p,\n      SUM(host_2k) AS host_2k,\n      SUM(host_4k) AS host_4k,\n      SUM(audience_sd) AS audience_sd,\n      SUM(audience_hd) AS audience_hd,\n      SUM(audience_hdp) AS audience_hdp,\n      SUM(audience_1080p) AS audience_1080p,\n      SUM(audience_2k) AS audience_2k,\n      SUM(audience_4k) AS audience_4k,\n      SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n      SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n      SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n      SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n      SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n      SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n      SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n      SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n      SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n      SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n      SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n      SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n      SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n      SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n      SUM(total_last1) AS audio_video_last,\n      SUM(audio_last1) AS audio_last,\n      SUM(video_last1) AS video_last,\n      SUM(video_sd_last1) AS video_sd_last,\n      SUM(video_hd_last1) AS video_hd_last,\n      SUM(video_hdp_last1) AS video_hdp_last,\n      SUM(host_sd_last1) AS host_video_sd_last,\n      SUM(audience_sd_last1) AS audience_video_sd_last,\n      SUM(host_hd_last1) AS host_video_hd_last,\n      SUM(audience_hd_last1) AS audience_video_hd_last,\n      SUM(host_hdp_last1) AS host_video_hdp_last,\n      SUM(audience_hdp_last1) AS audience_video_hdp_last,\n      SUM(host_audio_last1) AS host_audio_last,\n      SUM(audience_audio_last1) AS audience_audio_last,\n      SUM(host_video_last1) AS host_video_last,\n      SUM(audience_video_last1) AS audience_video_last,\n      SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n      SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n      SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n      SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n      SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n      SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n      SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n      SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n      SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n      SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n      SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n      SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n      SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n      SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n      SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n      SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n      SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n      SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n      SUM(audience_2k_last1) AS audience_2k_last1,\n      SUM(audience_4k_last1) AS audience_4k_last1,\n      SUM(audience_1080p_last1) AS audience_1080p_last1,\n      SUM(host_1080p_last1) AS host_1080p_last1,\n      SUM(host_2k_last1) AS host_2k_last1,\n      SUM(host_4k_last1) AS host_4k_last1,\n      SUM(total_last7) AS total_last7,\n      SUM(audio_last7) AS audio_last7,\n      SUM(video_last7) AS video_last7,\n      SUM(video_sd_last7) AS video_sd_last7,\n      SUM(video_hd_last7) AS video_hd_last7,\n      SUM(video_hdp_last7) AS video_hdp_last7,\n      SUM(host_sd_last7) AS host_sd_last7,\n      SUM(audience_sd_last7) AS audience_sd_last7,\n      SUM(host_hd_last7) AS host_hd_last7,\n      SUM(audience_hd_last7) AS audience_hd_last7,\n      SUM(host_hdp_last7) AS host_hdp_last7,\n      SUM(audience_hdp_last7) AS audience_hdp_last7,\n      SUM(host_audio_last7) AS host_audio_last7,\n      SUM(audience_audio_last7) AS audience_audio_last7,\n      SUM(host_video_last7) AS host_video_last7,\n      SUM(audience_video_last7) AS audience_video_last7,\n      SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n      SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n      SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n      SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n      SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n      SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n      SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n      SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n      SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n      SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n      SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n      SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n      SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n      SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n      SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n      SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n      SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n      SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n      SUM(audience_2k_last7) AS audience_2k_last7,\n      SUM(audience_4k_last7) AS audience_4k_last7,\n      SUM(audience_1080p_last7) AS audience_1080p_last7,\n      SUM(host_1080p_last7) AS host_1080p_last7,\n      SUM(host_2k_last7) AS host_2k_last7,\n      SUM(host_4k_last7) AS host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211001 AND date <= 20211128 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n    GROUP BY date,\n      DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n      2,\n      3,\n      tag,\n      area,\n      dim,\n      8,\n      9,\n      10,\n      level4,\n      product_level1,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en,\n      vid_use_case_en,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n          start_date AS start_date,\n          end_date AS end_date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          tag,\n          area AS Scope,\n          dim,\n            CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n            CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n            CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          browser,\n          browser_ver,\n          dim_grouping_name,\n          SUM(total) AS totalUsage,\n          SUM(audio) AS audio,\n          SUM(video) AS video,\n          SUM(host_sd + audience_sd) AS video_sd,\n          SUM(host_hd + audience_hd) AS video_hd,\n          SUM(host_hdp + audience_hdp) AS video_hdp,\n          SUM(host_audio) AS host_audio,\n          SUM(audience_audio) AS audience_audio,\n          SUM(host_sd) AS host_sd,\n          SUM(host_hd) AS host_hd,\n          SUM(host_hdp) AS host_hdp,\n          SUM(host_1080p) AS host_1080p,\n          SUM(host_2k) AS host_2k,\n          SUM(host_4k) AS host_4k,\n          SUM(audience_sd) AS audience_sd,\n          SUM(audience_hd) AS audience_hd,\n          SUM(audience_hdp) AS audience_hdp,\n          SUM(audience_1080p) AS audience_1080p,\n          SUM(audience_2k) AS audience_2k,\n          SUM(audience_4k) AS audience_4k,\n          SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n          SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n          SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n          SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n          SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n          SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n          SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n          SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n          SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n          SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n          SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n          SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n          SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n          SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n          SUM(total_last1) AS audio_video_last,\n          SUM(audio_last1) AS audio_last,\n          SUM(video_last1) AS video_last,\n          SUM(video_sd_last1) AS video_sd_last,\n          SUM(video_hd_last1) AS video_hd_last,\n          SUM(video_hdp_last1) AS video_hdp_last,\n          SUM(host_sd_last1) AS host_video_sd_last,\n          SUM(audience_sd_last1) AS audience_video_sd_last,\n          SUM(host_hd_last1) AS host_video_hd_last,\n          SUM(audience_hd_last1) AS audience_video_hd_last,\n          SUM(host_hdp_last1) AS host_video_hdp_last,\n          SUM(audience_hdp_last1) AS audience_video_hdp_last,\n          SUM(host_audio_last1) AS host_audio_last,\n          SUM(audience_audio_last1) AS audience_audio_last,\n          SUM(host_video_last1) AS host_video_last,\n          SUM(audience_video_last1) AS audience_video_last,\n          SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n          SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n          SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n          SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n          SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n          SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n          SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n          SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n          SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n          SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n          SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n          SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n          SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n          SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n          SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n          SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n          SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n          SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n          SUM(audience_2k_last1) AS audience_2k_last1,\n          SUM(audience_4k_last1) AS audience_4k_last1,\n          SUM(audience_1080p_last1) AS audience_1080p_last1,\n          SUM(host_1080p_last1) AS host_1080p_last1,\n          SUM(host_2k_last1) AS host_2k_last1,\n          SUM(host_4k_last1) AS host_4k_last1,\n          SUM(total_last7) AS total_last7,\n          SUM(audio_last7) AS audio_last7,\n          SUM(video_last7) AS video_last7,\n          SUM(video_sd_last7) AS video_sd_last7,\n          SUM(video_hd_last7) AS video_hd_last7,\n          SUM(video_hdp_last7) AS video_hdp_last7,\n          SUM(host_sd_last7) AS host_sd_last7,\n          SUM(audience_sd_last7) AS audience_sd_last7,\n          SUM(host_hd_last7) AS host_hd_last7,\n          SUM(audience_hd_last7) AS audience_hd_last7,\n          SUM(host_hdp_last7) AS host_hdp_last7,\n          SUM(audience_hdp_last7) AS audience_hdp_last7,\n          SUM(host_audio_last7) AS host_audio_last7,\n          SUM(audience_audio_last7) AS audience_audio_last7,\n          SUM(host_video_last7) AS host_video_last7,\n          SUM(audience_video_last7) AS audience_video_last7,\n          SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n          SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n          SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n          SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n          SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n          SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n          SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n          SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n          SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n          SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n          SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n          SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n          SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n          SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n          SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n          SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n          SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n          SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n          SUM(audience_2k_last7) AS audience_2k_last7,\n          SUM(audience_4k_last7) AS audience_4k_last7,\n          SUM(audience_1080p_last7) AS audience_1080p_last7,\n          SUM(host_1080p_last7) AS host_1080p_last7,\n          SUM(host_2k_last7) AS host_2k_last7,\n          SUM(host_4k_last7) AS host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211001 AND date <= 20211128 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n        GROUP BY date,\n          DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n          2,\n          3,\n          tag,\n          area,\n          dim,\n          8,\n          9,\n          10,\n          level4,\n          product_level1,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en,\n          vid_use_case_en,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          browser,\n          browser_ver,\n          dim_grouping_name) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 3 AND CAST(\"自定义 SQL 查询\".\"level1\" AS VARCHAR) = 'RTSA' AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 20,\n  21"
	},
	{
		"presto_sql" : "SELECT \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  \"自定义 SQL 查询\".\"stat_date\" AS \"stat_date\"\nFROM (SELECT date,\n      start_date AS start_date,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name,\n      SUM(total) AS totalUsage,\n      SUM(audio) AS audio,\n      SUM(video) AS video,\n      SUM(host_sd + audience_sd) AS video_sd,\n      SUM(host_hd + audience_hd) AS video_hd,\n      SUM(host_hdp + audience_hdp) AS video_hdp,\n      SUM(host_audio) AS host_audio,\n      SUM(audience_audio) AS audience_audio,\n      SUM(host_sd) AS host_sd,\n      SUM(host_hd) AS host_hd,\n      SUM(host_hdp) AS host_hdp,\n      SUM(host_1080p) AS host_1080p,\n      SUM(host_2k) AS host_2k,\n      SUM(host_4k) AS host_4k,\n      SUM(audience_sd) AS audience_sd,\n      SUM(audience_hd) AS audience_hd,\n      SUM(audience_hdp) AS audience_hdp,\n      SUM(audience_1080p) AS audience_1080p,\n      SUM(audience_2k) AS audience_2k,\n      SUM(audience_4k) AS audience_4k,\n      SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n      SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n      SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n      SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n      SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n      SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n      SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n      SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n      SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n      SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n      SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n      SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n      SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n      SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n      SUM(total_last1) AS audio_video_last,\n      SUM(audio_last1) AS audio_last,\n      SUM(video_last1) AS video_last,\n      SUM(video_sd_last1) AS video_sd_last,\n      SUM(video_hd_last1) AS video_hd_last,\n      SUM(video_hdp_last1) AS video_hdp_last,\n      SUM(host_sd_last1) AS host_video_sd_last,\n      SUM(audience_sd_last1) AS audience_video_sd_last,\n      SUM(host_hd_last1) AS host_video_hd_last,\n      SUM(audience_hd_last1) AS audience_video_hd_last,\n      SUM(host_hdp_last1) AS host_video_hdp_last,\n      SUM(audience_hdp_last1) AS audience_video_hdp_last,\n      SUM(host_audio_last1) AS host_audio_last,\n      SUM(audience_audio_last1) AS audience_audio_last,\n      SUM(host_video_last1) AS host_video_last,\n      SUM(audience_video_last1) AS audience_video_last,\n      SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n      SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n      SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n      SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n      SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n      SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n      SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n      SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n      SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n      SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n      SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n      SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n      SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n      SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n      SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n      SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n      SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n      SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n      SUM(audience_2k_last1) AS audience_2k_last1,\n      SUM(audience_4k_last1) AS audience_4k_last1,\n      SUM(audience_1080p_last1) AS audience_1080p_last1,\n      SUM(host_1080p_last1) AS host_1080p_last1,\n      SUM(host_2k_last1) AS host_2k_last1,\n      SUM(host_4k_last1) AS host_4k_last1,\n      SUM(total_last7) AS total_last7,\n      SUM(audio_last7) AS audio_last7,\n      SUM(video_last7) AS video_last7,\n      SUM(video_sd_last7) AS video_sd_last7,\n      SUM(video_hd_last7) AS video_hd_last7,\n      SUM(video_hdp_last7) AS video_hdp_last7,\n      SUM(host_sd_last7) AS host_sd_last7,\n      SUM(audience_sd_last7) AS audience_sd_last7,\n      SUM(host_hd_last7) AS host_hd_last7,\n      SUM(audience_hd_last7) AS audience_hd_last7,\n      SUM(host_hdp_last7) AS host_hdp_last7,\n      SUM(audience_hdp_last7) AS audience_hdp_last7,\n      SUM(host_audio_last7) AS host_audio_last7,\n      SUM(audience_audio_last7) AS audience_audio_last7,\n      SUM(host_video_last7) AS host_video_last7,\n      SUM(audience_video_last7) AS audience_video_last7,\n      SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n      SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n      SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n      SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n      SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n      SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n      SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n      SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n      SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n      SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n      SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n      SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n      SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n      SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n      SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n      SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n      SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n      SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n      SUM(audience_2k_last7) AS audience_2k_last7,\n      SUM(audience_4k_last7) AS audience_4k_last7,\n      SUM(audience_1080p_last7) AS audience_1080p_last7,\n      SUM(host_1080p_last7) AS host_1080p_last7,\n      SUM(host_2k_last7) AS host_2k_last7,\n      SUM(host_4k_last7) AS host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211001 AND date <= 20211128 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n    GROUP BY date,\n      DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n      2,\n      3,\n      tag,\n      area,\n      dim,\n      8,\n      9,\n      10,\n      level4,\n      product_level1,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en,\n      vid_use_case_en,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n          start_date AS start_date,\n          end_date AS end_date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          tag,\n          area AS Scope,\n          dim,\n            CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n            CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n            CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          browser,\n          browser_ver,\n          dim_grouping_name,\n          SUM(total) AS totalUsage,\n          SUM(audio) AS audio,\n          SUM(video) AS video,\n          SUM(host_sd + audience_sd) AS video_sd,\n          SUM(host_hd + audience_hd) AS video_hd,\n          SUM(host_hdp + audience_hdp) AS video_hdp,\n          SUM(host_audio) AS host_audio,\n          SUM(audience_audio) AS audience_audio,\n          SUM(host_sd) AS host_sd,\n          SUM(host_hd) AS host_hd,\n          SUM(host_hdp) AS host_hdp,\n          SUM(host_1080p) AS host_1080p,\n          SUM(host_2k) AS host_2k,\n          SUM(host_4k) AS host_4k,\n          SUM(audience_sd) AS audience_sd,\n          SUM(audience_hd) AS audience_hd,\n          SUM(audience_hdp) AS audience_hdp,\n          SUM(audience_1080p) AS audience_1080p,\n          SUM(audience_2k) AS audience_2k,\n          SUM(audience_4k) AS audience_4k,\n          SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n          SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n          SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n          SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n          SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n          SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n          SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n          SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n          SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n          SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n          SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n          SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n          SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n          SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n          SUM(total_last1) AS audio_video_last,\n          SUM(audio_last1) AS audio_last,\n          SUM(video_last1) AS video_last,\n          SUM(video_sd_last1) AS video_sd_last,\n          SUM(video_hd_last1) AS video_hd_last,\n          SUM(video_hdp_last1) AS video_hdp_last,\n          SUM(host_sd_last1) AS host_video_sd_last,\n          SUM(audience_sd_last1) AS audience_video_sd_last,\n          SUM(host_hd_last1) AS host_video_hd_last,\n          SUM(audience_hd_last1) AS audience_video_hd_last,\n          SUM(host_hdp_last1) AS host_video_hdp_last,\n          SUM(audience_hdp_last1) AS audience_video_hdp_last,\n          SUM(host_audio_last1) AS host_audio_last,\n          SUM(audience_audio_last1) AS audience_audio_last,\n          SUM(host_video_last1) AS host_video_last,\n          SUM(audience_video_last1) AS audience_video_last,\n          SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n          SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n          SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n          SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n          SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n          SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n          SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n          SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n          SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n          SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n          SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n          SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n          SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n          SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n          SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n          SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n          SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n          SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n          SUM(audience_2k_last1) AS audience_2k_last1,\n          SUM(audience_4k_last1) AS audience_4k_last1,\n          SUM(audience_1080p_last1) AS audience_1080p_last1,\n          SUM(host_1080p_last1) AS host_1080p_last1,\n          SUM(host_2k_last1) AS host_2k_last1,\n          SUM(host_4k_last1) AS host_4k_last1,\n          SUM(total_last7) AS total_last7,\n          SUM(audio_last7) AS audio_last7,\n          SUM(video_last7) AS video_last7,\n          SUM(video_sd_last7) AS video_sd_last7,\n          SUM(video_hd_last7) AS video_hd_last7,\n          SUM(video_hdp_last7) AS video_hdp_last7,\n          SUM(host_sd_last7) AS host_sd_last7,\n          SUM(audience_sd_last7) AS audience_sd_last7,\n          SUM(host_hd_last7) AS host_hd_last7,\n          SUM(audience_hd_last7) AS audience_hd_last7,\n          SUM(host_hdp_last7) AS host_hdp_last7,\n          SUM(audience_hdp_last7) AS audience_hdp_last7,\n          SUM(host_audio_last7) AS host_audio_last7,\n          SUM(audience_audio_last7) AS audience_audio_last7,\n          SUM(host_video_last7) AS host_video_last7,\n          SUM(audience_video_last7) AS audience_video_last7,\n          SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n          SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n          SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n          SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n          SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n          SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n          SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n          SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n          SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n          SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n          SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n          SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n          SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n          SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n          SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n          SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n          SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n          SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n          SUM(audience_2k_last7) AS audience_2k_last7,\n          SUM(audience_4k_last7) AS audience_4k_last7,\n          SUM(audience_1080p_last7) AS audience_1080p_last7,\n          SUM(host_1080p_last7) AS host_1080p_last7,\n          SUM(host_2k_last7) AS host_2k_last7,\n          SUM(host_4k_last7) AS host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211001 AND date <= 20211128 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n        GROUP BY date,\n          DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n          2,\n          3,\n          tag,\n          area,\n          dim,\n          8,\n          9,\n          10,\n          level4,\n          product_level1,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en,\n          vid_use_case_en,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          browser,\n          browser_ver,\n          dim_grouping_name) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE CAST(\"自定义 SQL 查询\".\"level1\" AS VARCHAR) = 'RTSA' AND \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 3 AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 1,\n  2"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700079370244)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700079370244)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700079370244)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700079370244)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700079370244)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700079370244)(943764407)(0)\",\n  MIN(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(1482809429)(0)\",\n  MIN(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(3765460736)(0)\",\n  \"自定义 SQL 查询\".\"stat_date\" AS \"TEMP(attr_stat_date_nk)(2102638629)(0)\",\n  \"自定义 SQL 查询\".\"stat_date\" AS \"TEMP(attr_stat_date_nk)(2790680713)(0)\",\n  \"自定义 SQL 查询\".\"stat_date\" AS \"stat_date\",\n  \"自定义 SQL 查询\".\"vid_use_case_cn\" AS \"vid_use_case_cn\"\nFROM (SELECT date,\n      start_date AS start_date,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name,\n      SUM(total) AS totalUsage,\n      SUM(audio) AS audio,\n      SUM(video) AS video,\n      SUM(host_sd + audience_sd) AS video_sd,\n      SUM(host_hd + audience_hd) AS video_hd,\n      SUM(host_hdp + audience_hdp) AS video_hdp,\n      SUM(host_audio) AS host_audio,\n      SUM(audience_audio) AS audience_audio,\n      SUM(host_sd) AS host_sd,\n      SUM(host_hd) AS host_hd,\n      SUM(host_hdp) AS host_hdp,\n      SUM(host_1080p) AS host_1080p,\n      SUM(host_2k) AS host_2k,\n      SUM(host_4k) AS host_4k,\n      SUM(audience_sd) AS audience_sd,\n      SUM(audience_hd) AS audience_hd,\n      SUM(audience_hdp) AS audience_hdp,\n      SUM(audience_1080p) AS audience_1080p,\n      SUM(audience_2k) AS audience_2k,\n      SUM(audience_4k) AS audience_4k,\n      SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n      SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n      SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n      SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n      SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n      SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n      SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n      SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n      SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n      SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n      SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n      SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n      SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n      SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n      SUM(total_last1) AS audio_video_last,\n      SUM(audio_last1) AS audio_last,\n      SUM(video_last1) AS video_last,\n      SUM(video_sd_last1) AS video_sd_last,\n      SUM(video_hd_last1) AS video_hd_last,\n      SUM(video_hdp_last1) AS video_hdp_last,\n      SUM(host_sd_last1) AS host_video_sd_last,\n      SUM(audience_sd_last1) AS audience_video_sd_last,\n      SUM(host_hd_last1) AS host_video_hd_last,\n      SUM(audience_hd_last1) AS audience_video_hd_last,\n      SUM(host_hdp_last1) AS host_video_hdp_last,\n      SUM(audience_hdp_last1) AS audience_video_hdp_last,\n      SUM(host_audio_last1) AS host_audio_last,\n      SUM(audience_audio_last1) AS audience_audio_last,\n      SUM(host_video_last1) AS host_video_last,\n      SUM(audience_video_last1) AS audience_video_last,\n      SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n      SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n      SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n      SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n      SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n      SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n      SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n      SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n      SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n      SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n      SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n      SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n      SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n      SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n      SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n      SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n      SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n      SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n      SUM(audience_2k_last1) AS audience_2k_last1,\n      SUM(audience_4k_last1) AS audience_4k_last1,\n      SUM(audience_1080p_last1) AS audience_1080p_last1,\n      SUM(host_1080p_last1) AS host_1080p_last1,\n      SUM(host_2k_last1) AS host_2k_last1,\n      SUM(host_4k_last1) AS host_4k_last1,\n      SUM(total_last7) AS total_last7,\n      SUM(audio_last7) AS audio_last7,\n      SUM(video_last7) AS video_last7,\n      SUM(video_sd_last7) AS video_sd_last7,\n      SUM(video_hd_last7) AS video_hd_last7,\n      SUM(video_hdp_last7) AS video_hdp_last7,\n      SUM(host_sd_last7) AS host_sd_last7,\n      SUM(audience_sd_last7) AS audience_sd_last7,\n      SUM(host_hd_last7) AS host_hd_last7,\n      SUM(audience_hd_last7) AS audience_hd_last7,\n      SUM(host_hdp_last7) AS host_hdp_last7,\n      SUM(audience_hdp_last7) AS audience_hdp_last7,\n      SUM(host_audio_last7) AS host_audio_last7,\n      SUM(audience_audio_last7) AS audience_audio_last7,\n      SUM(host_video_last7) AS host_video_last7,\n      SUM(audience_video_last7) AS audience_video_last7,\n      SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n      SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n      SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n      SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n      SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n      SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n      SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n      SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n      SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n      SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n      SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n      SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n      SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n      SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n      SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n      SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n      SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n      SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n      SUM(audience_2k_last7) AS audience_2k_last7,\n      SUM(audience_4k_last7) AS audience_4k_last7,\n      SUM(audience_1080p_last7) AS audience_1080p_last7,\n      SUM(host_1080p_last7) AS host_1080p_last7,\n      SUM(host_2k_last7) AS host_2k_last7,\n      SUM(host_4k_last7) AS host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211001 AND date <= 20211128 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n    GROUP BY date,\n      DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n      2,\n      3,\n      tag,\n      area,\n      dim,\n      8,\n      9,\n      10,\n      level4,\n      product_level1,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en,\n      vid_use_case_en,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n          start_date AS start_date,\n          end_date AS end_date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          tag,\n          area AS Scope,\n          dim,\n            CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n            CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n            CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          browser,\n          browser_ver,\n          dim_grouping_name,\n          SUM(total) AS totalUsage,\n          SUM(audio) AS audio,\n          SUM(video) AS video,\n          SUM(host_sd + audience_sd) AS video_sd,\n          SUM(host_hd + audience_hd) AS video_hd,\n          SUM(host_hdp + audience_hdp) AS video_hdp,\n          SUM(host_audio) AS host_audio,\n          SUM(audience_audio) AS audience_audio,\n          SUM(host_sd) AS host_sd,\n          SUM(host_hd) AS host_hd,\n          SUM(host_hdp) AS host_hdp,\n          SUM(host_1080p) AS host_1080p,\n          SUM(host_2k) AS host_2k,\n          SUM(host_4k) AS host_4k,\n          SUM(audience_sd) AS audience_sd,\n          SUM(audience_hd) AS audience_hd,\n          SUM(audience_hdp) AS audience_hdp,\n          SUM(audience_1080p) AS audience_1080p,\n          SUM(audience_2k) AS audience_2k,\n          SUM(audience_4k) AS audience_4k,\n          SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n          SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n          SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n          SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n          SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n          SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n          SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n          SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n          SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n          SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n          SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n          SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n          SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n          SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n          SUM(total_last1) AS audio_video_last,\n          SUM(audio_last1) AS audio_last,\n          SUM(video_last1) AS video_last,\n          SUM(video_sd_last1) AS video_sd_last,\n          SUM(video_hd_last1) AS video_hd_last,\n          SUM(video_hdp_last1) AS video_hdp_last,\n          SUM(host_sd_last1) AS host_video_sd_last,\n          SUM(audience_sd_last1) AS audience_video_sd_last,\n          SUM(host_hd_last1) AS host_video_hd_last,\n          SUM(audience_hd_last1) AS audience_video_hd_last,\n          SUM(host_hdp_last1) AS host_video_hdp_last,\n          SUM(audience_hdp_last1) AS audience_video_hdp_last,\n          SUM(host_audio_last1) AS host_audio_last,\n          SUM(audience_audio_last1) AS audience_audio_last,\n          SUM(host_video_last1) AS host_video_last,\n          SUM(audience_video_last1) AS audience_video_last,\n          SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n          SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n          SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n          SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n          SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n          SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n          SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n          SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n          SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n          SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n          SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n          SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n          SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n          SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n          SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n          SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n          SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n          SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n          SUM(audience_2k_last1) AS audience_2k_last1,\n          SUM(audience_4k_last1) AS audience_4k_last1,\n          SUM(audience_1080p_last1) AS audience_1080p_last1,\n          SUM(host_1080p_last1) AS host_1080p_last1,\n          SUM(host_2k_last1) AS host_2k_last1,\n          SUM(host_4k_last1) AS host_4k_last1,\n          SUM(total_last7) AS total_last7,\n          SUM(audio_last7) AS audio_last7,\n          SUM(video_last7) AS video_last7,\n          SUM(video_sd_last7) AS video_sd_last7,\n          SUM(video_hd_last7) AS video_hd_last7,\n          SUM(video_hdp_last7) AS video_hdp_last7,\n          SUM(host_sd_last7) AS host_sd_last7,\n          SUM(audience_sd_last7) AS audience_sd_last7,\n          SUM(host_hd_last7) AS host_hd_last7,\n          SUM(audience_hd_last7) AS audience_hd_last7,\n          SUM(host_hdp_last7) AS host_hdp_last7,\n          SUM(audience_hdp_last7) AS audience_hdp_last7,\n          SUM(host_audio_last7) AS host_audio_last7,\n          SUM(audience_audio_last7) AS audience_audio_last7,\n          SUM(host_video_last7) AS host_video_last7,\n          SUM(audience_video_last7) AS audience_video_last7,\n          SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n          SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n          SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n          SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n          SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n          SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n          SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n          SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n          SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n          SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n          SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n          SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n          SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n          SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n          SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n          SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n          SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n          SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n          SUM(audience_2k_last7) AS audience_2k_last7,\n          SUM(audience_4k_last7) AS audience_4k_last7,\n          SUM(audience_1080p_last7) AS audience_1080p_last7,\n          SUM(host_1080p_last7) AS host_1080p_last7,\n          SUM(host_2k_last7) AS host_2k_last7,\n          SUM(host_4k_last7) AS host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211001 AND date <= 20211128 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n        GROUP BY date,\n          DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n          2,\n          3,\n          tag,\n          area,\n          dim,\n          8,\n          9,\n          10,\n          level4,\n          product_level1,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en,\n          vid_use_case_en,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          browser,\n          browser_ver,\n          dim_grouping_name) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 3 AND CAST(\"自定义 SQL 查询\".\"level1\" AS VARCHAR) = 'RTSA' AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 20,\n  23"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3054707207061430272)(2629536046)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_video_last\") AS \"TEMP(Calculation_3054707207061430272)(2820618408)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(日环比 (复制 2)_96897765685432324)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_last\") AS \"TEMP(日环比 (复制 2)_96897765685432324)(4091190060)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(日环比 (复制)_96897765685424131)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video_last\") AS \"TEMP(日环比 (复制)_96897765685424131)(3934387163)(0)\",\n  \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"sum_audio_ok\",\n  SUM(\"自定义 SQL 查询\".\"audio_video_last\") AS \"sum_audio_video_last_ok\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"sum_video_ok\"\nFROM (SELECT date,\n      start_date AS start_date,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name,\n      SUM(total) AS totalUsage,\n      SUM(audio) AS audio,\n      SUM(video) AS video,\n      SUM(host_sd + audience_sd) AS video_sd,\n      SUM(host_hd + audience_hd) AS video_hd,\n      SUM(host_hdp + audience_hdp) AS video_hdp,\n      SUM(host_audio) AS host_audio,\n      SUM(audience_audio) AS audience_audio,\n      SUM(host_sd) AS host_sd,\n      SUM(host_hd) AS host_hd,\n      SUM(host_hdp) AS host_hdp,\n      SUM(host_1080p) AS host_1080p,\n      SUM(host_2k) AS host_2k,\n      SUM(host_4k) AS host_4k,\n      SUM(audience_sd) AS audience_sd,\n      SUM(audience_hd) AS audience_hd,\n      SUM(audience_hdp) AS audience_hdp,\n      SUM(audience_1080p) AS audience_1080p,\n      SUM(audience_2k) AS audience_2k,\n      SUM(audience_4k) AS audience_4k,\n      SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n      SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n      SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n      SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n      SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n      SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n      SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n      SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n      SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n      SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n      SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n      SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n      SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n      SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n      SUM(total_last1) AS audio_video_last,\n      SUM(audio_last1) AS audio_last,\n      SUM(video_last1) AS video_last,\n      SUM(video_sd_last1) AS video_sd_last,\n      SUM(video_hd_last1) AS video_hd_last,\n      SUM(video_hdp_last1) AS video_hdp_last,\n      SUM(host_sd_last1) AS host_video_sd_last,\n      SUM(audience_sd_last1) AS audience_video_sd_last,\n      SUM(host_hd_last1) AS host_video_hd_last,\n      SUM(audience_hd_last1) AS audience_video_hd_last,\n      SUM(host_hdp_last1) AS host_video_hdp_last,\n      SUM(audience_hdp_last1) AS audience_video_hdp_last,\n      SUM(host_audio_last1) AS host_audio_last,\n      SUM(audience_audio_last1) AS audience_audio_last,\n      SUM(host_video_last1) AS host_video_last,\n      SUM(audience_video_last1) AS audience_video_last,\n      SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n      SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n      SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n      SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n      SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n      SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n      SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n      SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n      SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n      SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n      SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n      SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n      SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n      SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n      SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n      SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n      SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n      SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n      SUM(audience_2k_last1) AS audience_2k_last1,\n      SUM(audience_4k_last1) AS audience_4k_last1,\n      SUM(audience_1080p_last1) AS audience_1080p_last1,\n      SUM(host_1080p_last1) AS host_1080p_last1,\n      SUM(host_2k_last1) AS host_2k_last1,\n      SUM(host_4k_last1) AS host_4k_last1,\n      SUM(total_last7) AS total_last7,\n      SUM(audio_last7) AS audio_last7,\n      SUM(video_last7) AS video_last7,\n      SUM(video_sd_last7) AS video_sd_last7,\n      SUM(video_hd_last7) AS video_hd_last7,\n      SUM(video_hdp_last7) AS video_hdp_last7,\n      SUM(host_sd_last7) AS host_sd_last7,\n      SUM(audience_sd_last7) AS audience_sd_last7,\n      SUM(host_hd_last7) AS host_hd_last7,\n      SUM(audience_hd_last7) AS audience_hd_last7,\n      SUM(host_hdp_last7) AS host_hdp_last7,\n      SUM(audience_hdp_last7) AS audience_hdp_last7,\n      SUM(host_audio_last7) AS host_audio_last7,\n      SUM(audience_audio_last7) AS audience_audio_last7,\n      SUM(host_video_last7) AS host_video_last7,\n      SUM(audience_video_last7) AS audience_video_last7,\n      SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n      SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n      SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n      SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n      SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n      SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n      SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n      SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n      SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n      SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n      SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n      SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n      SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n      SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n      SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n      SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n      SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n      SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n      SUM(audience_2k_last7) AS audience_2k_last7,\n      SUM(audience_4k_last7) AS audience_4k_last7,\n      SUM(audience_1080p_last7) AS audience_1080p_last7,\n      SUM(host_1080p_last7) AS host_1080p_last7,\n      SUM(host_2k_last7) AS host_2k_last7,\n      SUM(host_4k_last7) AS host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211001 AND date <= 20211128 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n    GROUP BY date,\n      DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n      2,\n      3,\n      tag,\n      area,\n      dim,\n      8,\n      9,\n      10,\n      level4,\n      product_level1,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en,\n      vid_use_case_en,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n          start_date AS start_date,\n          end_date AS end_date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          tag,\n          area AS Scope,\n          dim,\n            CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n            CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n            CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          browser,\n          browser_ver,\n          dim_grouping_name,\n          SUM(total) AS totalUsage,\n          SUM(audio) AS audio,\n          SUM(video) AS video,\n          SUM(host_sd + audience_sd) AS video_sd,\n          SUM(host_hd + audience_hd) AS video_hd,\n          SUM(host_hdp + audience_hdp) AS video_hdp,\n          SUM(host_audio) AS host_audio,\n          SUM(audience_audio) AS audience_audio,\n          SUM(host_sd) AS host_sd,\n          SUM(host_hd) AS host_hd,\n          SUM(host_hdp) AS host_hdp,\n          SUM(host_1080p) AS host_1080p,\n          SUM(host_2k) AS host_2k,\n          SUM(host_4k) AS host_4k,\n          SUM(audience_sd) AS audience_sd,\n          SUM(audience_hd) AS audience_hd,\n          SUM(audience_hdp) AS audience_hdp,\n          SUM(audience_1080p) AS audience_1080p,\n          SUM(audience_2k) AS audience_2k,\n          SUM(audience_4k) AS audience_4k,\n          SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n          SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n          SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n          SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n          SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n          SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n          SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n          SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n          SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n          SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n          SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n          SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n          SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n          SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n          SUM(total_last1) AS audio_video_last,\n          SUM(audio_last1) AS audio_last,\n          SUM(video_last1) AS video_last,\n          SUM(video_sd_last1) AS video_sd_last,\n          SUM(video_hd_last1) AS video_hd_last,\n          SUM(video_hdp_last1) AS video_hdp_last,\n          SUM(host_sd_last1) AS host_video_sd_last,\n          SUM(audience_sd_last1) AS audience_video_sd_last,\n          SUM(host_hd_last1) AS host_video_hd_last,\n          SUM(audience_hd_last1) AS audience_video_hd_last,\n          SUM(host_hdp_last1) AS host_video_hdp_last,\n          SUM(audience_hdp_last1) AS audience_video_hdp_last,\n          SUM(host_audio_last1) AS host_audio_last,\n          SUM(audience_audio_last1) AS audience_audio_last,\n          SUM(host_video_last1) AS host_video_last,\n          SUM(audience_video_last1) AS audience_video_last,\n          SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n          SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n          SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n          SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n          SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n          SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n          SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n          SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n          SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n          SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n          SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n          SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n          SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n          SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n          SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n          SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n          SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n          SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n          SUM(audience_2k_last1) AS audience_2k_last1,\n          SUM(audience_4k_last1) AS audience_4k_last1,\n          SUM(audience_1080p_last1) AS audience_1080p_last1,\n          SUM(host_1080p_last1) AS host_1080p_last1,\n          SUM(host_2k_last1) AS host_2k_last1,\n          SUM(host_4k_last1) AS host_4k_last1,\n          SUM(total_last7) AS total_last7,\n          SUM(audio_last7) AS audio_last7,\n          SUM(video_last7) AS video_last7,\n          SUM(video_sd_last7) AS video_sd_last7,\n          SUM(video_hd_last7) AS video_hd_last7,\n          SUM(video_hdp_last7) AS video_hdp_last7,\n          SUM(host_sd_last7) AS host_sd_last7,\n          SUM(audience_sd_last7) AS audience_sd_last7,\n          SUM(host_hd_last7) AS host_hd_last7,\n          SUM(audience_hd_last7) AS audience_hd_last7,\n          SUM(host_hdp_last7) AS host_hdp_last7,\n          SUM(audience_hdp_last7) AS audience_hdp_last7,\n          SUM(host_audio_last7) AS host_audio_last7,\n          SUM(audience_audio_last7) AS audience_audio_last7,\n          SUM(host_video_last7) AS host_video_last7,\n          SUM(audience_video_last7) AS audience_video_last7,\n          SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n          SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n          SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n          SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n          SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n          SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n          SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n          SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n          SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n          SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n          SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n          SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n          SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n          SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n          SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n          SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n          SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n          SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n          SUM(audience_2k_last7) AS audience_2k_last7,\n          SUM(audience_4k_last7) AS audience_4k_last7,\n          SUM(audience_1080p_last7) AS audience_1080p_last7,\n          SUM(host_1080p_last7) AS host_1080p_last7,\n          SUM(host_2k_last7) AS host_2k_last7,\n          SUM(host_4k_last7) AS host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211001 AND date <= 20211128 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n        GROUP BY date,\n          DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n          2,\n          3,\n          tag,\n          area,\n          dim,\n          8,\n          9,\n          10,\n          level4,\n          product_level1,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en,\n          vid_use_case_en,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          browser,\n          browser_ver,\n          dim_grouping_name) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE CAST(\"自定义 SQL 查询\".\"level1\" AS VARCHAR) = 'RTSA' AND \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 3 AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 7"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700079370244)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700079370244)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700079370244)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700079370244)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700079370244)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700079370244)(943764407)(0)\",\n  MIN(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(1482809429)(0)\",\n  MIN(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(3765460736)(0)\",\n  \"自定义 SQL 查询\".\"stat_date\" AS \"TEMP(attr_stat_date_nk)(2102638629)(0)\",\n  \"自定义 SQL 查询\".\"stat_date\" AS \"TEMP(attr_stat_date_nk)(2790680713)(0)\",\n  \"自定义 SQL 查询\".\"product_level2\" AS \"product_level2\",\n  \"自定义 SQL 查询\".\"stat_date\" AS \"stat_date\"\nFROM (SELECT date,\n      start_date AS start_date,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name,\n      SUM(total) AS totalUsage,\n      SUM(audio) AS audio,\n      SUM(video) AS video,\n      SUM(host_sd + audience_sd) AS video_sd,\n      SUM(host_hd + audience_hd) AS video_hd,\n      SUM(host_hdp + audience_hdp) AS video_hdp,\n      SUM(host_audio) AS host_audio,\n      SUM(audience_audio) AS audience_audio,\n      SUM(host_sd) AS host_sd,\n      SUM(host_hd) AS host_hd,\n      SUM(host_hdp) AS host_hdp,\n      SUM(host_1080p) AS host_1080p,\n      SUM(host_2k) AS host_2k,\n      SUM(host_4k) AS host_4k,\n      SUM(audience_sd) AS audience_sd,\n      SUM(audience_hd) AS audience_hd,\n      SUM(audience_hdp) AS audience_hdp,\n      SUM(audience_1080p) AS audience_1080p,\n      SUM(audience_2k) AS audience_2k,\n      SUM(audience_4k) AS audience_4k,\n      SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n      SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n      SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n      SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n      SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n      SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n      SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n      SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n      SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n      SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n      SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n      SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n      SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n      SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n      SUM(total_last1) AS audio_video_last,\n      SUM(audio_last1) AS audio_last,\n      SUM(video_last1) AS video_last,\n      SUM(video_sd_last1) AS video_sd_last,\n      SUM(video_hd_last1) AS video_hd_last,\n      SUM(video_hdp_last1) AS video_hdp_last,\n      SUM(host_sd_last1) AS host_video_sd_last,\n      SUM(audience_sd_last1) AS audience_video_sd_last,\n      SUM(host_hd_last1) AS host_video_hd_last,\n      SUM(audience_hd_last1) AS audience_video_hd_last,\n      SUM(host_hdp_last1) AS host_video_hdp_last,\n      SUM(audience_hdp_last1) AS audience_video_hdp_last,\n      SUM(host_audio_last1) AS host_audio_last,\n      SUM(audience_audio_last1) AS audience_audio_last,\n      SUM(host_video_last1) AS host_video_last,\n      SUM(audience_video_last1) AS audience_video_last,\n      SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n      SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n      SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n      SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n      SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n      SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n      SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n      SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n      SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n      SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n      SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n      SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n      SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n      SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n      SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n      SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n      SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n      SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n      SUM(audience_2k_last1) AS audience_2k_last1,\n      SUM(audience_4k_last1) AS audience_4k_last1,\n      SUM(audience_1080p_last1) AS audience_1080p_last1,\n      SUM(host_1080p_last1) AS host_1080p_last1,\n      SUM(host_2k_last1) AS host_2k_last1,\n      SUM(host_4k_last1) AS host_4k_last1,\n      SUM(total_last7) AS total_last7,\n      SUM(audio_last7) AS audio_last7,\n      SUM(video_last7) AS video_last7,\n      SUM(video_sd_last7) AS video_sd_last7,\n      SUM(video_hd_last7) AS video_hd_last7,\n      SUM(video_hdp_last7) AS video_hdp_last7,\n      SUM(host_sd_last7) AS host_sd_last7,\n      SUM(audience_sd_last7) AS audience_sd_last7,\n      SUM(host_hd_last7) AS host_hd_last7,\n      SUM(audience_hd_last7) AS audience_hd_last7,\n      SUM(host_hdp_last7) AS host_hdp_last7,\n      SUM(audience_hdp_last7) AS audience_hdp_last7,\n      SUM(host_audio_last7) AS host_audio_last7,\n      SUM(audience_audio_last7) AS audience_audio_last7,\n      SUM(host_video_last7) AS host_video_last7,\n      SUM(audience_video_last7) AS audience_video_last7,\n      SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n      SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n      SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n      SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n      SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n      SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n      SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n      SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n      SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n      SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n      SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n      SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n      SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n      SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n      SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n      SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n      SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n      SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n      SUM(audience_2k_last7) AS audience_2k_last7,\n      SUM(audience_4k_last7) AS audience_4k_last7,\n      SUM(audience_1080p_last7) AS audience_1080p_last7,\n      SUM(host_1080p_last7) AS host_1080p_last7,\n      SUM(host_2k_last7) AS host_2k_last7,\n      SUM(host_4k_last7) AS host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211001 AND date <= 20211128 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n    GROUP BY date,\n      DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n      2,\n      3,\n      tag,\n      area,\n      dim,\n      8,\n      9,\n      10,\n      level4,\n      product_level1,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en,\n      vid_use_case_en,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name) AS \"自定义 SQL 查询\"\nWHERE \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 3 AND CAST(\"自定义 SQL 查询\".\"level1\" AS VARCHAR) = 'RTSA'\nGROUP BY 22,\n  20"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700079370244)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700079370244)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700079370244)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700079370244)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700079370244)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700079370244)(943764407)(0)\",\n  MIN(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(1482809429)(0)\",\n  MIN(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(3765460736)(0)\",\n  \"自定义 SQL 查询\".\"stat_date\" AS \"TEMP(attr_stat_date_nk)(2102638629)(0)\",\n  \"自定义 SQL 查询\".\"stat_date\" AS \"TEMP(attr_stat_date_nk)(2790680713)(0)\",\n  \"自定义 SQL 查询\".\"stat_date\" AS \"stat_date\",\n  \"自定义 SQL 查询\".\"vid_sector_en\" AS \"vid_sector_en\"\nFROM (SELECT date,\n      start_date AS start_date,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name,\n      SUM(total) AS totalUsage,\n      SUM(audio) AS audio,\n      SUM(video) AS video,\n      SUM(host_sd + audience_sd) AS video_sd,\n      SUM(host_hd + audience_hd) AS video_hd,\n      SUM(host_hdp + audience_hdp) AS video_hdp,\n      SUM(host_audio) AS host_audio,\n      SUM(audience_audio) AS audience_audio,\n      SUM(host_sd) AS host_sd,\n      SUM(host_hd) AS host_hd,\n      SUM(host_hdp) AS host_hdp,\n      SUM(host_1080p) AS host_1080p,\n      SUM(host_2k) AS host_2k,\n      SUM(host_4k) AS host_4k,\n      SUM(audience_sd) AS audience_sd,\n      SUM(audience_hd) AS audience_hd,\n      SUM(audience_hdp) AS audience_hdp,\n      SUM(audience_1080p) AS audience_1080p,\n      SUM(audience_2k) AS audience_2k,\n      SUM(audience_4k) AS audience_4k,\n      SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n      SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n      SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n      SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n      SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n      SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n      SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n      SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n      SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n      SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n      SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n      SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n      SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n      SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n      SUM(total_last1) AS audio_video_last,\n      SUM(audio_last1) AS audio_last,\n      SUM(video_last1) AS video_last,\n      SUM(video_sd_last1) AS video_sd_last,\n      SUM(video_hd_last1) AS video_hd_last,\n      SUM(video_hdp_last1) AS video_hdp_last,\n      SUM(host_sd_last1) AS host_video_sd_last,\n      SUM(audience_sd_last1) AS audience_video_sd_last,\n      SUM(host_hd_last1) AS host_video_hd_last,\n      SUM(audience_hd_last1) AS audience_video_hd_last,\n      SUM(host_hdp_last1) AS host_video_hdp_last,\n      SUM(audience_hdp_last1) AS audience_video_hdp_last,\n      SUM(host_audio_last1) AS host_audio_last,\n      SUM(audience_audio_last1) AS audience_audio_last,\n      SUM(host_video_last1) AS host_video_last,\n      SUM(audience_video_last1) AS audience_video_last,\n      SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n      SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n      SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n      SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n      SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n      SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n      SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n      SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n      SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n      SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n      SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n      SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n      SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n      SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n      SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n      SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n      SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n      SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n      SUM(audience_2k_last1) AS audience_2k_last1,\n      SUM(audience_4k_last1) AS audience_4k_last1,\n      SUM(audience_1080p_last1) AS audience_1080p_last1,\n      SUM(host_1080p_last1) AS host_1080p_last1,\n      SUM(host_2k_last1) AS host_2k_last1,\n      SUM(host_4k_last1) AS host_4k_last1,\n      SUM(total_last7) AS total_last7,\n      SUM(audio_last7) AS audio_last7,\n      SUM(video_last7) AS video_last7,\n      SUM(video_sd_last7) AS video_sd_last7,\n      SUM(video_hd_last7) AS video_hd_last7,\n      SUM(video_hdp_last7) AS video_hdp_last7,\n      SUM(host_sd_last7) AS host_sd_last7,\n      SUM(audience_sd_last7) AS audience_sd_last7,\n      SUM(host_hd_last7) AS host_hd_last7,\n      SUM(audience_hd_last7) AS audience_hd_last7,\n      SUM(host_hdp_last7) AS host_hdp_last7,\n      SUM(audience_hdp_last7) AS audience_hdp_last7,\n      SUM(host_audio_last7) AS host_audio_last7,\n      SUM(audience_audio_last7) AS audience_audio_last7,\n      SUM(host_video_last7) AS host_video_last7,\n      SUM(audience_video_last7) AS audience_video_last7,\n      SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n      SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n      SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n      SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n      SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n      SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n      SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n      SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n      SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n      SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n      SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n      SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n      SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n      SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n      SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n      SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n      SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n      SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n      SUM(audience_2k_last7) AS audience_2k_last7,\n      SUM(audience_4k_last7) AS audience_4k_last7,\n      SUM(audience_1080p_last7) AS audience_1080p_last7,\n      SUM(host_1080p_last7) AS host_1080p_last7,\n      SUM(host_2k_last7) AS host_2k_last7,\n      SUM(host_4k_last7) AS host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211001 AND date <= 20211128 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n    GROUP BY date,\n      DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n      2,\n      3,\n      tag,\n      area,\n      dim,\n      8,\n      9,\n      10,\n      level4,\n      product_level1,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en,\n      vid_use_case_en,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name) AS \"自定义 SQL 查询\"\nWHERE \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 3 AND CAST(\"自定义 SQL 查询\".\"level1\" AS VARCHAR) = 'RTSA'\nGROUP BY 20,\n  23"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700079370244)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700079370244)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700079370244)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700079370244)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700079370244)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700079370244)(943764407)(0)\",\n  MIN(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(1482809429)(0)\",\n  MIN(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(3765460736)(0)\",\n  \"自定义 SQL 查询\".\"stat_date\" AS \"TEMP(attr_stat_date_nk)(2102638629)(0)\",\n  \"自定义 SQL 查询\".\"stat_date\" AS \"TEMP(attr_stat_date_nk)(2790680713)(0)\",\n  \"自定义 SQL 查询\".\"stat_date\" AS \"stat_date\",\n  \"自定义 SQL 查询\".\"vid_use_case_cn\" AS \"vid_use_case_cn\"\nFROM (SELECT date,\n      start_date AS start_date,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name,\n      SUM(total) AS totalUsage,\n      SUM(audio) AS audio,\n      SUM(video) AS video,\n      SUM(host_sd + audience_sd) AS video_sd,\n      SUM(host_hd + audience_hd) AS video_hd,\n      SUM(host_hdp + audience_hdp) AS video_hdp,\n      SUM(host_audio) AS host_audio,\n      SUM(audience_audio) AS audience_audio,\n      SUM(host_sd) AS host_sd,\n      SUM(host_hd) AS host_hd,\n      SUM(host_hdp) AS host_hdp,\n      SUM(host_1080p) AS host_1080p,\n      SUM(host_2k) AS host_2k,\n      SUM(host_4k) AS host_4k,\n      SUM(audience_sd) AS audience_sd,\n      SUM(audience_hd) AS audience_hd,\n      SUM(audience_hdp) AS audience_hdp,\n      SUM(audience_1080p) AS audience_1080p,\n      SUM(audience_2k) AS audience_2k,\n      SUM(audience_4k) AS audience_4k,\n      SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n      SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n      SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n      SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n      SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n      SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n      SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n      SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n      SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n      SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n      SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n      SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n      SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n      SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n      SUM(total_last1) AS audio_video_last,\n      SUM(audio_last1) AS audio_last,\n      SUM(video_last1) AS video_last,\n      SUM(video_sd_last1) AS video_sd_last,\n      SUM(video_hd_last1) AS video_hd_last,\n      SUM(video_hdp_last1) AS video_hdp_last,\n      SUM(host_sd_last1) AS host_video_sd_last,\n      SUM(audience_sd_last1) AS audience_video_sd_last,\n      SUM(host_hd_last1) AS host_video_hd_last,\n      SUM(audience_hd_last1) AS audience_video_hd_last,\n      SUM(host_hdp_last1) AS host_video_hdp_last,\n      SUM(audience_hdp_last1) AS audience_video_hdp_last,\n      SUM(host_audio_last1) AS host_audio_last,\n      SUM(audience_audio_last1) AS audience_audio_last,\n      SUM(host_video_last1) AS host_video_last,\n      SUM(audience_video_last1) AS audience_video_last,\n      SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n      SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n      SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n      SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n      SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n      SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n      SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n      SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n      SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n      SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n      SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n      SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n      SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n      SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n      SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n      SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n      SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n      SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n      SUM(audience_2k_last1) AS audience_2k_last1,\n      SUM(audience_4k_last1) AS audience_4k_last1,\n      SUM(audience_1080p_last1) AS audience_1080p_last1,\n      SUM(host_1080p_last1) AS host_1080p_last1,\n      SUM(host_2k_last1) AS host_2k_last1,\n      SUM(host_4k_last1) AS host_4k_last1,\n      SUM(total_last7) AS total_last7,\n      SUM(audio_last7) AS audio_last7,\n      SUM(video_last7) AS video_last7,\n      SUM(video_sd_last7) AS video_sd_last7,\n      SUM(video_hd_last7) AS video_hd_last7,\n      SUM(video_hdp_last7) AS video_hdp_last7,\n      SUM(host_sd_last7) AS host_sd_last7,\n      SUM(audience_sd_last7) AS audience_sd_last7,\n      SUM(host_hd_last7) AS host_hd_last7,\n      SUM(audience_hd_last7) AS audience_hd_last7,\n      SUM(host_hdp_last7) AS host_hdp_last7,\n      SUM(audience_hdp_last7) AS audience_hdp_last7,\n      SUM(host_audio_last7) AS host_audio_last7,\n      SUM(audience_audio_last7) AS audience_audio_last7,\n      SUM(host_video_last7) AS host_video_last7,\n      SUM(audience_video_last7) AS audience_video_last7,\n      SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n      SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n      SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n      SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n      SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n      SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n      SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n      SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n      SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n      SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n      SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n      SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n      SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n      SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n      SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n      SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n      SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n      SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n      SUM(audience_2k_last7) AS audience_2k_last7,\n      SUM(audience_4k_last7) AS audience_4k_last7,\n      SUM(audience_1080p_last7) AS audience_1080p_last7,\n      SUM(host_1080p_last7) AS host_1080p_last7,\n      SUM(host_2k_last7) AS host_2k_last7,\n      SUM(host_4k_last7) AS host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211001 AND date <= 20211128 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n    GROUP BY date,\n      DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n      2,\n      3,\n      tag,\n      area,\n      dim,\n      8,\n      9,\n      10,\n      level4,\n      product_level1,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en,\n      vid_use_case_en,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name) AS \"自定义 SQL 查询\"\nWHERE \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 3 AND CAST(\"自定义 SQL 查询\".\"level1\" AS VARCHAR) = 'RTSA'\nGROUP BY 20,\n  23"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700079370244)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700079370244)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700079370244)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700079370244)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700079370244)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700079370244)(943764407)(0)\",\n  MIN(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(1482809429)(0)\",\n  MIN(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(3765460736)(0)\",\n  \"自定义 SQL 查询\".\"product_level3\" AS \"TEMP(attr_product_level3_nk)(1428376059)(0)\",\n  \"自定义 SQL 查询\".\"product_level3\" AS \"TEMP(attr_product_level3_nk)(3667766967)(0)\",\n  \"自定义 SQL 查询\".\"product_level3\" AS \"product_level3\",\n  \"自定义 SQL 查询\".\"stat_date\" AS \"stat_date\"\nFROM (SELECT date,\n      start_date AS start_date,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name,\n      SUM(total) AS totalUsage,\n      SUM(audio) AS audio,\n      SUM(video) AS video,\n      SUM(host_sd + audience_sd) AS video_sd,\n      SUM(host_hd + audience_hd) AS video_hd,\n      SUM(host_hdp + audience_hdp) AS video_hdp,\n      SUM(host_audio) AS host_audio,\n      SUM(audience_audio) AS audience_audio,\n      SUM(host_sd) AS host_sd,\n      SUM(host_hd) AS host_hd,\n      SUM(host_hdp) AS host_hdp,\n      SUM(host_1080p) AS host_1080p,\n      SUM(host_2k) AS host_2k,\n      SUM(host_4k) AS host_4k,\n      SUM(audience_sd) AS audience_sd,\n      SUM(audience_hd) AS audience_hd,\n      SUM(audience_hdp) AS audience_hdp,\n      SUM(audience_1080p) AS audience_1080p,\n      SUM(audience_2k) AS audience_2k,\n      SUM(audience_4k) AS audience_4k,\n      SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n      SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n      SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n      SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n      SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n      SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n      SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n      SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n      SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n      SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n      SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n      SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n      SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n      SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n      SUM(total_last1) AS audio_video_last,\n      SUM(audio_last1) AS audio_last,\n      SUM(video_last1) AS video_last,\n      SUM(video_sd_last1) AS video_sd_last,\n      SUM(video_hd_last1) AS video_hd_last,\n      SUM(video_hdp_last1) AS video_hdp_last,\n      SUM(host_sd_last1) AS host_video_sd_last,\n      SUM(audience_sd_last1) AS audience_video_sd_last,\n      SUM(host_hd_last1) AS host_video_hd_last,\n      SUM(audience_hd_last1) AS audience_video_hd_last,\n      SUM(host_hdp_last1) AS host_video_hdp_last,\n      SUM(audience_hdp_last1) AS audience_video_hdp_last,\n      SUM(host_audio_last1) AS host_audio_last,\n      SUM(audience_audio_last1) AS audience_audio_last,\n      SUM(host_video_last1) AS host_video_last,\n      SUM(audience_video_last1) AS audience_video_last,\n      SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n      SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n      SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n      SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n      SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n      SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n      SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n      SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n      SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n      SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n      SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n      SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n      SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n      SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n      SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n      SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n      SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n      SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n      SUM(audience_2k_last1) AS audience_2k_last1,\n      SUM(audience_4k_last1) AS audience_4k_last1,\n      SUM(audience_1080p_last1) AS audience_1080p_last1,\n      SUM(host_1080p_last1) AS host_1080p_last1,\n      SUM(host_2k_last1) AS host_2k_last1,\n      SUM(host_4k_last1) AS host_4k_last1,\n      SUM(total_last7) AS total_last7,\n      SUM(audio_last7) AS audio_last7,\n      SUM(video_last7) AS video_last7,\n      SUM(video_sd_last7) AS video_sd_last7,\n      SUM(video_hd_last7) AS video_hd_last7,\n      SUM(video_hdp_last7) AS video_hdp_last7,\n      SUM(host_sd_last7) AS host_sd_last7,\n      SUM(audience_sd_last7) AS audience_sd_last7,\n      SUM(host_hd_last7) AS host_hd_last7,\n      SUM(audience_hd_last7) AS audience_hd_last7,\n      SUM(host_hdp_last7) AS host_hdp_last7,\n      SUM(audience_hdp_last7) AS audience_hdp_last7,\n      SUM(host_audio_last7) AS host_audio_last7,\n      SUM(audience_audio_last7) AS audience_audio_last7,\n      SUM(host_video_last7) AS host_video_last7,\n      SUM(audience_video_last7) AS audience_video_last7,\n      SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n      SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n      SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n      SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n      SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n      SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n      SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n      SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n      SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n      SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n      SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n      SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n      SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n      SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n      SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n      SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n      SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n      SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n      SUM(audience_2k_last7) AS audience_2k_last7,\n      SUM(audience_4k_last7) AS audience_4k_last7,\n      SUM(audience_1080p_last7) AS audience_1080p_last7,\n      SUM(host_1080p_last7) AS host_1080p_last7,\n      SUM(host_2k_last7) AS host_2k_last7,\n      SUM(host_4k_last7) AS host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211001 AND date <= 20211128 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n    GROUP BY date,\n      DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n      2,\n      3,\n      tag,\n      area,\n      dim,\n      8,\n      9,\n      10,\n      level4,\n      product_level1,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en,\n      vid_use_case_en,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n          start_date AS start_date,\n          end_date AS end_date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          tag,\n          area AS Scope,\n          dim,\n            CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n            CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n            CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          browser,\n          browser_ver,\n          dim_grouping_name,\n          SUM(total) AS totalUsage,\n          SUM(audio) AS audio,\n          SUM(video) AS video,\n          SUM(host_sd + audience_sd) AS video_sd,\n          SUM(host_hd + audience_hd) AS video_hd,\n          SUM(host_hdp + audience_hdp) AS video_hdp,\n          SUM(host_audio) AS host_audio,\n          SUM(audience_audio) AS audience_audio,\n          SUM(host_sd) AS host_sd,\n          SUM(host_hd) AS host_hd,\n          SUM(host_hdp) AS host_hdp,\n          SUM(host_1080p) AS host_1080p,\n          SUM(host_2k) AS host_2k,\n          SUM(host_4k) AS host_4k,\n          SUM(audience_sd) AS audience_sd,\n          SUM(audience_hd) AS audience_hd,\n          SUM(audience_hdp) AS audience_hdp,\n          SUM(audience_1080p) AS audience_1080p,\n          SUM(audience_2k) AS audience_2k,\n          SUM(audience_4k) AS audience_4k,\n          SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n          SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n          SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n          SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n          SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n          SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n          SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n          SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n          SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n          SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n          SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n          SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n          SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n          SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n          SUM(total_last1) AS audio_video_last,\n          SUM(audio_last1) AS audio_last,\n          SUM(video_last1) AS video_last,\n          SUM(video_sd_last1) AS video_sd_last,\n          SUM(video_hd_last1) AS video_hd_last,\n          SUM(video_hdp_last1) AS video_hdp_last,\n          SUM(host_sd_last1) AS host_video_sd_last,\n          SUM(audience_sd_last1) AS audience_video_sd_last,\n          SUM(host_hd_last1) AS host_video_hd_last,\n          SUM(audience_hd_last1) AS audience_video_hd_last,\n          SUM(host_hdp_last1) AS host_video_hdp_last,\n          SUM(audience_hdp_last1) AS audience_video_hdp_last,\n          SUM(host_audio_last1) AS host_audio_last,\n          SUM(audience_audio_last1) AS audience_audio_last,\n          SUM(host_video_last1) AS host_video_last,\n          SUM(audience_video_last1) AS audience_video_last,\n          SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n          SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n          SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n          SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n          SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n          SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n          SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n          SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n          SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n          SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n          SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n          SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n          SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n          SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n          SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n          SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n          SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n          SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n          SUM(audience_2k_last1) AS audience_2k_last1,\n          SUM(audience_4k_last1) AS audience_4k_last1,\n          SUM(audience_1080p_last1) AS audience_1080p_last1,\n          SUM(host_1080p_last1) AS host_1080p_last1,\n          SUM(host_2k_last1) AS host_2k_last1,\n          SUM(host_4k_last1) AS host_4k_last1,\n          SUM(total_last7) AS total_last7,\n          SUM(audio_last7) AS audio_last7,\n          SUM(video_last7) AS video_last7,\n          SUM(video_sd_last7) AS video_sd_last7,\n          SUM(video_hd_last7) AS video_hd_last7,\n          SUM(video_hdp_last7) AS video_hdp_last7,\n          SUM(host_sd_last7) AS host_sd_last7,\n          SUM(audience_sd_last7) AS audience_sd_last7,\n          SUM(host_hd_last7) AS host_hd_last7,\n          SUM(audience_hd_last7) AS audience_hd_last7,\n          SUM(host_hdp_last7) AS host_hdp_last7,\n          SUM(audience_hdp_last7) AS audience_hdp_last7,\n          SUM(host_audio_last7) AS host_audio_last7,\n          SUM(audience_audio_last7) AS audience_audio_last7,\n          SUM(host_video_last7) AS host_video_last7,\n          SUM(audience_video_last7) AS audience_video_last7,\n          SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n          SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n          SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n          SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n          SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n          SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n          SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n          SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n          SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n          SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n          SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n          SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n          SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n          SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n          SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n          SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n          SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n          SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n          SUM(audience_2k_last7) AS audience_2k_last7,\n          SUM(audience_4k_last7) AS audience_4k_last7,\n          SUM(audience_1080p_last7) AS audience_1080p_last7,\n          SUM(host_1080p_last7) AS host_1080p_last7,\n          SUM(host_2k_last7) AS host_2k_last7,\n          SUM(host_4k_last7) AS host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211001 AND date <= 20211128 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n        GROUP BY date,\n          DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n          2,\n          3,\n          tag,\n          area,\n          dim,\n          8,\n          9,\n          10,\n          level4,\n          product_level1,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en,\n          vid_use_case_en,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          browser,\n          browser_ver,\n          dim_grouping_name) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 3 AND CAST(\"自定义 SQL 查询\".\"level1\" AS VARCHAR) = 'RTSA' AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 20,\n  23"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700079370244)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700079370244)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700079370244)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700079370244)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700079370244)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700079370244)(943764407)(0)\",\n  MIN(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(1482809429)(0)\",\n  MIN(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(3765460736)(0)\",\n  MAX(\"自定义 SQL 查询\".\"stat_date\") AS \"TEMP(attr_stat_date_nk)(2102638629)(0)\",\n  MIN(\"自定义 SQL 查询\".\"stat_date\") AS \"TEMP(attr_stat_date_nk)(2790680713)(0)\",\n  \"自定义 SQL 查询\".\"vid_sector_en\" AS \"vid_sector_en\"\nFROM (SELECT date,\n      start_date AS start_date,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name,\n      SUM(total) AS totalUsage,\n      SUM(audio) AS audio,\n      SUM(video) AS video,\n      SUM(host_sd + audience_sd) AS video_sd,\n      SUM(host_hd + audience_hd) AS video_hd,\n      SUM(host_hdp + audience_hdp) AS video_hdp,\n      SUM(host_audio) AS host_audio,\n      SUM(audience_audio) AS audience_audio,\n      SUM(host_sd) AS host_sd,\n      SUM(host_hd) AS host_hd,\n      SUM(host_hdp) AS host_hdp,\n      SUM(host_1080p) AS host_1080p,\n      SUM(host_2k) AS host_2k,\n      SUM(host_4k) AS host_4k,\n      SUM(audience_sd) AS audience_sd,\n      SUM(audience_hd) AS audience_hd,\n      SUM(audience_hdp) AS audience_hdp,\n      SUM(audience_1080p) AS audience_1080p,\n      SUM(audience_2k) AS audience_2k,\n      SUM(audience_4k) AS audience_4k,\n      SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n      SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n      SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n      SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n      SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n      SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n      SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n      SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n      SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n      SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n      SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n      SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n      SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n      SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n      SUM(total_last1) AS audio_video_last,\n      SUM(audio_last1) AS audio_last,\n      SUM(video_last1) AS video_last,\n      SUM(video_sd_last1) AS video_sd_last,\n      SUM(video_hd_last1) AS video_hd_last,\n      SUM(video_hdp_last1) AS video_hdp_last,\n      SUM(host_sd_last1) AS host_video_sd_last,\n      SUM(audience_sd_last1) AS audience_video_sd_last,\n      SUM(host_hd_last1) AS host_video_hd_last,\n      SUM(audience_hd_last1) AS audience_video_hd_last,\n      SUM(host_hdp_last1) AS host_video_hdp_last,\n      SUM(audience_hdp_last1) AS audience_video_hdp_last,\n      SUM(host_audio_last1) AS host_audio_last,\n      SUM(audience_audio_last1) AS audience_audio_last,\n      SUM(host_video_last1) AS host_video_last,\n      SUM(audience_video_last1) AS audience_video_last,\n      SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n      SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n      SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n      SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n      SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n      SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n      SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n      SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n      SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n      SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n      SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n      SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n      SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n      SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n      SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n      SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n      SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n      SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n      SUM(audience_2k_last1) AS audience_2k_last1,\n      SUM(audience_4k_last1) AS audience_4k_last1,\n      SUM(audience_1080p_last1) AS audience_1080p_last1,\n      SUM(host_1080p_last1) AS host_1080p_last1,\n      SUM(host_2k_last1) AS host_2k_last1,\n      SUM(host_4k_last1) AS host_4k_last1,\n      SUM(total_last7) AS total_last7,\n      SUM(audio_last7) AS audio_last7,\n      SUM(video_last7) AS video_last7,\n      SUM(video_sd_last7) AS video_sd_last7,\n      SUM(video_hd_last7) AS video_hd_last7,\n      SUM(video_hdp_last7) AS video_hdp_last7,\n      SUM(host_sd_last7) AS host_sd_last7,\n      SUM(audience_sd_last7) AS audience_sd_last7,\n      SUM(host_hd_last7) AS host_hd_last7,\n      SUM(audience_hd_last7) AS audience_hd_last7,\n      SUM(host_hdp_last7) AS host_hdp_last7,\n      SUM(audience_hdp_last7) AS audience_hdp_last7,\n      SUM(host_audio_last7) AS host_audio_last7,\n      SUM(audience_audio_last7) AS audience_audio_last7,\n      SUM(host_video_last7) AS host_video_last7,\n      SUM(audience_video_last7) AS audience_video_last7,\n      SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n      SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n      SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n      SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n      SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n      SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n      SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n      SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n      SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n      SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n      SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n      SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n      SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n      SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n      SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n      SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n      SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n      SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n      SUM(audience_2k_last7) AS audience_2k_last7,\n      SUM(audience_4k_last7) AS audience_4k_last7,\n      SUM(audience_1080p_last7) AS audience_1080p_last7,\n      SUM(host_1080p_last7) AS host_1080p_last7,\n      SUM(host_2k_last7) AS host_2k_last7,\n      SUM(host_4k_last7) AS host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211001 AND date <= 20211128 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n    GROUP BY date,\n      DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n      2,\n      3,\n      tag,\n      area,\n      dim,\n      8,\n      9,\n      10,\n      level4,\n      product_level1,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en,\n      vid_use_case_en,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n          start_date AS start_date,\n          end_date AS end_date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          tag,\n          area AS Scope,\n          dim,\n            CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n            CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n            CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          browser,\n          browser_ver,\n          dim_grouping_name,\n          SUM(total) AS totalUsage,\n          SUM(audio) AS audio,\n          SUM(video) AS video,\n          SUM(host_sd + audience_sd) AS video_sd,\n          SUM(host_hd + audience_hd) AS video_hd,\n          SUM(host_hdp + audience_hdp) AS video_hdp,\n          SUM(host_audio) AS host_audio,\n          SUM(audience_audio) AS audience_audio,\n          SUM(host_sd) AS host_sd,\n          SUM(host_hd) AS host_hd,\n          SUM(host_hdp) AS host_hdp,\n          SUM(host_1080p) AS host_1080p,\n          SUM(host_2k) AS host_2k,\n          SUM(host_4k) AS host_4k,\n          SUM(audience_sd) AS audience_sd,\n          SUM(audience_hd) AS audience_hd,\n          SUM(audience_hdp) AS audience_hdp,\n          SUM(audience_1080p) AS audience_1080p,\n          SUM(audience_2k) AS audience_2k,\n          SUM(audience_4k) AS audience_4k,\n          SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n          SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n          SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n          SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n          SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n          SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n          SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n          SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n          SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n          SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n          SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n          SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n          SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n          SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n          SUM(total_last1) AS audio_video_last,\n          SUM(audio_last1) AS audio_last,\n          SUM(video_last1) AS video_last,\n          SUM(video_sd_last1) AS video_sd_last,\n          SUM(video_hd_last1) AS video_hd_last,\n          SUM(video_hdp_last1) AS video_hdp_last,\n          SUM(host_sd_last1) AS host_video_sd_last,\n          SUM(audience_sd_last1) AS audience_video_sd_last,\n          SUM(host_hd_last1) AS host_video_hd_last,\n          SUM(audience_hd_last1) AS audience_video_hd_last,\n          SUM(host_hdp_last1) AS host_video_hdp_last,\n          SUM(audience_hdp_last1) AS audience_video_hdp_last,\n          SUM(host_audio_last1) AS host_audio_last,\n          SUM(audience_audio_last1) AS audience_audio_last,\n          SUM(host_video_last1) AS host_video_last,\n          SUM(audience_video_last1) AS audience_video_last,\n          SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n          SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n          SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n          SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n          SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n          SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n          SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n          SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n          SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n          SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n          SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n          SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n          SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n          SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n          SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n          SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n          SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n          SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n          SUM(audience_2k_last1) AS audience_2k_last1,\n          SUM(audience_4k_last1) AS audience_4k_last1,\n          SUM(audience_1080p_last1) AS audience_1080p_last1,\n          SUM(host_1080p_last1) AS host_1080p_last1,\n          SUM(host_2k_last1) AS host_2k_last1,\n          SUM(host_4k_last1) AS host_4k_last1,\n          SUM(total_last7) AS total_last7,\n          SUM(audio_last7) AS audio_last7,\n          SUM(video_last7) AS video_last7,\n          SUM(video_sd_last7) AS video_sd_last7,\n          SUM(video_hd_last7) AS video_hd_last7,\n          SUM(video_hdp_last7) AS video_hdp_last7,\n          SUM(host_sd_last7) AS host_sd_last7,\n          SUM(audience_sd_last7) AS audience_sd_last7,\n          SUM(host_hd_last7) AS host_hd_last7,\n          SUM(audience_hd_last7) AS audience_hd_last7,\n          SUM(host_hdp_last7) AS host_hdp_last7,\n          SUM(audience_hdp_last7) AS audience_hdp_last7,\n          SUM(host_audio_last7) AS host_audio_last7,\n          SUM(audience_audio_last7) AS audience_audio_last7,\n          SUM(host_video_last7) AS host_video_last7,\n          SUM(audience_video_last7) AS audience_video_last7,\n          SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n          SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n          SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n          SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n          SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n          SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n          SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n          SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n          SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n          SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n          SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n          SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n          SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n          SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n          SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n          SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n          SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n          SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n          SUM(audience_2k_last7) AS audience_2k_last7,\n          SUM(audience_4k_last7) AS audience_4k_last7,\n          SUM(audience_1080p_last7) AS audience_1080p_last7,\n          SUM(host_1080p_last7) AS host_1080p_last7,\n          SUM(host_2k_last7) AS host_2k_last7,\n          SUM(host_4k_last7) AS host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211001 AND date <= 20211128 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n        GROUP BY date,\n          DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n          2,\n          3,\n          tag,\n          area,\n          dim,\n          8,\n          9,\n          10,\n          level4,\n          product_level1,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en,\n          vid_use_case_en,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          browser,\n          browser_ver,\n          dim_grouping_name) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 3 AND CAST(\"自定义 SQL 查询\".\"level1\" AS VARCHAR) = 'RTSA' AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 22"
	},
	{
		"presto_sql" : "SELECT \"t0\".\"TEMP(Calculation_3519281700079370244)(1075454865)(0)\" AS \"TEMP(Calculation_3519281700079370244)(1075454865)(0)\",\n  \"t0\".\"TEMP(Calculation_3519281700079370244)(1133678835)(0)\" AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  \"t0\".\"TEMP(Calculation_3519281700079370244)(1312501967)(0)\" AS \"TEMP(Calculation_3519281700079370244)(1312501967)(0)\",\n  \"t0\".\"TEMP(Calculation_3519281700079370244)(276907208)(0)\" AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  \"t0\".\"TEMP(Calculation_3519281700079370244)(2929708110)(0)\" AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  \"t0\".\"TEMP(Calculation_3519281700079370244)(2930728935)(0)\" AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  \"t0\".\"TEMP(Calculation_3519281700079370244)(3010533957)(0)\" AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  \"t0\".\"TEMP(Calculation_3519281700079370244)(30306054)(0)\" AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  \"t0\".\"TEMP(Calculation_3519281700079370244)(3087054365)(0)\" AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  \"t0\".\"TEMP(Calculation_3519281700079370244)(3299350010)(0)\" AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  \"t0\".\"TEMP(Calculation_3519281700079370244)(3628946582)(0)\" AS \"TEMP(Calculation_3519281700079370244)(3628946582)(0)\",\n  \"t0\".\"sum_totalUsage_ok\" AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  \"t0\".\"TEMP(Calculation_3519281700079370244)(4109514392)(0)\" AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  \"t0\".\"TEMP(Calculation_3519281700079370244)(586790827)(0)\" AS \"TEMP(Calculation_3519281700079370244)(586790827)(0)\",\n  \"t0\".\"TEMP(Calculation_3519281700079370244)(709512178)(0)\" AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  \"t0\".\"TEMP(Calculation_3519281700079370244)(764410224)(0)\" AS \"TEMP(Calculation_3519281700079370244)(764410224)(0)\",\n  \"t0\".\"TEMP(Calculation_3519281700079370244)(943764407)(0)\" AS \"TEMP(Calculation_3519281700079370244)(943764407)(0)\",\n  \"t0\".\"level1\" AS \"level1\",\n  \"t3\".\"__measure__0\" AS \"sum_Calculation_4164281609521332225_ok\",\n  \"t0\".\"sum_totalUsage_ok\" AS \"sum_totalUsage_ok\"\nFROM (SELECT \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n      SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700079370244)(1075454865)(0)\",\n      SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n      SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700079370244)(1312501967)(0)\",\n      SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n      SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n      SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n      SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n      SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n      SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n      SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n      SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700079370244)(3628946582)(0)\",\n      SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n      SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700079370244)(586790827)(0)\",\n      SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n      SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700079370244)(764410224)(0)\",\n      SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700079370244)(943764407)(0)\",\n      SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"sum_totalUsage_ok\"\n    FROM (SELECT date,\n          start_date AS start_date,\n          end_date AS end_date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          tag,\n          area AS Scope,\n          dim,\n            CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n            CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n            CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          browser,\n          browser_ver,\n          dim_grouping_name,\n          SUM(total) AS totalUsage,\n          SUM(audio) AS audio,\n          SUM(video) AS video,\n          SUM(host_sd + audience_sd) AS video_sd,\n          SUM(host_hd + audience_hd) AS video_hd,\n          SUM(host_hdp + audience_hdp) AS video_hdp,\n          SUM(host_audio) AS host_audio,\n          SUM(audience_audio) AS audience_audio,\n          SUM(host_sd) AS host_sd,\n          SUM(host_hd) AS host_hd,\n          SUM(host_hdp) AS host_hdp,\n          SUM(host_1080p) AS host_1080p,\n          SUM(host_2k) AS host_2k,\n          SUM(host_4k) AS host_4k,\n          SUM(audience_sd) AS audience_sd,\n          SUM(audience_hd) AS audience_hd,\n          SUM(audience_hdp) AS audience_hdp,\n          SUM(audience_1080p) AS audience_1080p,\n          SUM(audience_2k) AS audience_2k,\n          SUM(audience_4k) AS audience_4k,\n          SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n          SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n          SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n          SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n          SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n          SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n          SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n          SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n          SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n          SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n          SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n          SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n          SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n          SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n          SUM(total_last1) AS audio_video_last,\n          SUM(audio_last1) AS audio_last,\n          SUM(video_last1) AS video_last,\n          SUM(video_sd_last1) AS video_sd_last,\n          SUM(video_hd_last1) AS video_hd_last,\n          SUM(video_hdp_last1) AS video_hdp_last,\n          SUM(host_sd_last1) AS host_video_sd_last,\n          SUM(audience_sd_last1) AS audience_video_sd_last,\n          SUM(host_hd_last1) AS host_video_hd_last,\n          SUM(audience_hd_last1) AS audience_video_hd_last,\n          SUM(host_hdp_last1) AS host_video_hdp_last,\n          SUM(audience_hdp_last1) AS audience_video_hdp_last,\n          SUM(host_audio_last1) AS host_audio_last,\n          SUM(audience_audio_last1) AS audience_audio_last,\n          SUM(host_video_last1) AS host_video_last,\n          SUM(audience_video_last1) AS audience_video_last,\n          SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n          SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n          SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n          SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n          SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n          SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n          SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n          SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n          SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n          SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n          SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n          SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n          SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n          SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n          SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n          SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n          SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n          SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n          SUM(audience_2k_last1) AS audience_2k_last1,\n          SUM(audience_4k_last1) AS audience_4k_last1,\n          SUM(audience_1080p_last1) AS audience_1080p_last1,\n          SUM(host_1080p_last1) AS host_1080p_last1,\n          SUM(host_2k_last1) AS host_2k_last1,\n          SUM(host_4k_last1) AS host_4k_last1,\n          SUM(total_last7) AS total_last7,\n          SUM(audio_last7) AS audio_last7,\n          SUM(video_last7) AS video_last7,\n          SUM(video_sd_last7) AS video_sd_last7,\n          SUM(video_hd_last7) AS video_hd_last7,\n          SUM(video_hdp_last7) AS video_hdp_last7,\n          SUM(host_sd_last7) AS host_sd_last7,\n          SUM(audience_sd_last7) AS audience_sd_last7,\n          SUM(host_hd_last7) AS host_hd_last7,\n          SUM(audience_hd_last7) AS audience_hd_last7,\n          SUM(host_hdp_last7) AS host_hdp_last7,\n          SUM(audience_hdp_last7) AS audience_hdp_last7,\n          SUM(host_audio_last7) AS host_audio_last7,\n          SUM(audience_audio_last7) AS audience_audio_last7,\n          SUM(host_video_last7) AS host_video_last7,\n          SUM(audience_video_last7) AS audience_video_last7,\n          SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n          SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n          SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n          SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n          SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n          SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n          SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n          SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n          SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n          SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n          SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n          SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n          SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n          SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n          SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n          SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n          SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n          SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n          SUM(audience_2k_last7) AS audience_2k_last7,\n          SUM(audience_4k_last7) AS audience_4k_last7,\n          SUM(audience_1080p_last7) AS audience_1080p_last7,\n          SUM(host_1080p_last7) AS host_1080p_last7,\n          SUM(host_2k_last7) AS host_2k_last7,\n          SUM(host_4k_last7) AS host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211001 AND date <= 20211128 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n        GROUP BY date,\n          DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n          2,\n          3,\n          tag,\n          area,\n          dim,\n          8,\n          9,\n          10,\n          level4,\n          product_level1,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en,\n          vid_use_case_en,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          browser,\n          browser_ver,\n          dim_grouping_name) AS \"自定义 SQL 查询\"\n    WHERE CAST(\"自定义 SQL 查询\".\"level1\" AS VARCHAR) = 'RTSA' AND \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 3\n    GROUP BY 1) AS \"t0\"\n  INNER JOIN (SELECT MIN(\"t1\".\"level1\") AS \"level1\",\n      SUM(\"t2\".\"__measure__1\") AS \"__measure__0\"\n    FROM (SELECT \"自定义 SQL 查询\".\"date\" AS \"date\",\n          \"自定义 SQL 查询\".\"level1\" AS \"level1\"\n        FROM (SELECT date,\n              start_date AS start_date,\n              end_date AS end_date,\n                CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n              tag,\n              area AS Scope,\n              dim,\n                CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n                CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n                CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n              level4,\n              product_level1 AS product_line,\n              product_level2,\n              product_level3,\n              product_level4,\n              vid_internal_industry_en AS cid_industry,\n              vid_use_case_en AS vid_use_case_cn,\n              vid_sector_en,\n              ver_type,\n              ver,\n              os,\n              domain,\n              country,\n              region,\n              browser,\n              browser_ver,\n              dim_grouping_name,\n              SUM(total) AS totalUsage,\n              SUM(audio) AS audio,\n              SUM(video) AS video,\n              SUM(host_sd + audience_sd) AS video_sd,\n              SUM(host_hd + audience_hd) AS video_hd,\n              SUM(host_hdp + audience_hdp) AS video_hdp,\n              SUM(host_audio) AS host_audio,\n              SUM(audience_audio) AS audience_audio,\n              SUM(host_sd) AS host_sd,\n              SUM(host_hd) AS host_hd,\n              SUM(host_hdp) AS host_hdp,\n              SUM(host_1080p) AS host_1080p,\n              SUM(host_2k) AS host_2k,\n              SUM(host_4k) AS host_4k,\n              SUM(audience_sd) AS audience_sd,\n              SUM(audience_hd) AS audience_hd,\n              SUM(audience_hdp) AS audience_hdp,\n              SUM(audience_1080p) AS audience_1080p,\n              SUM(audience_2k) AS audience_2k,\n              SUM(audience_4k) AS audience_4k,\n              SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n              SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n              SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n              SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n              SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n              SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n              SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n              SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n              SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n              SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n              SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n              SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n              SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n              SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n              SUM(total_last1) AS audio_video_last,\n              SUM(audio_last1) AS audio_last,\n              SUM(video_last1) AS video_last,\n              SUM(video_sd_last1) AS video_sd_last,\n              SUM(video_hd_last1) AS video_hd_last,\n              SUM(video_hdp_last1) AS video_hdp_last,\n              SUM(host_sd_last1) AS host_video_sd_last,\n              SUM(audience_sd_last1) AS audience_video_sd_last,\n              SUM(host_hd_last1) AS host_video_hd_last,\n              SUM(audience_hd_last1) AS audience_video_hd_last,\n              SUM(host_hdp_last1) AS host_video_hdp_last,\n              SUM(audience_hdp_last1) AS audience_video_hdp_last,\n              SUM(host_audio_last1) AS host_audio_last,\n              SUM(audience_audio_last1) AS audience_audio_last,\n              SUM(host_video_last1) AS host_video_last,\n              SUM(audience_video_last1) AS audience_video_last,\n              SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n              SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n              SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n              SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n              SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n              SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n              SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n              SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n              SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n              SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n              SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n              SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n              SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n              SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n              SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n              SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n              SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n              SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n              SUM(audience_2k_last1) AS audience_2k_last1,\n              SUM(audience_4k_last1) AS audience_4k_last1,\n              SUM(audience_1080p_last1) AS audience_1080p_last1,\n              SUM(host_1080p_last1) AS host_1080p_last1,\n              SUM(host_2k_last1) AS host_2k_last1,\n              SUM(host_4k_last1) AS host_4k_last1,\n              SUM(total_last7) AS total_last7,\n              SUM(audio_last7) AS audio_last7,\n              SUM(video_last7) AS video_last7,\n              SUM(video_sd_last7) AS video_sd_last7,\n              SUM(video_hd_last7) AS video_hd_last7,\n              SUM(video_hdp_last7) AS video_hdp_last7,\n              SUM(host_sd_last7) AS host_sd_last7,\n              SUM(audience_sd_last7) AS audience_sd_last7,\n              SUM(host_hd_last7) AS host_hd_last7,\n              SUM(audience_hd_last7) AS audience_hd_last7,\n              SUM(host_hdp_last7) AS host_hdp_last7,\n              SUM(audience_hdp_last7) AS audience_hdp_last7,\n              SUM(host_audio_last7) AS host_audio_last7,\n              SUM(audience_audio_last7) AS audience_audio_last7,\n              SUM(host_video_last7) AS host_video_last7,\n              SUM(audience_video_last7) AS audience_video_last7,\n              SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n              SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n              SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n              SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n              SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n              SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n              SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n              SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n              SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n              SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n              SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n              SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n              SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n              SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n              SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n              SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n              SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n              SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n              SUM(audience_2k_last7) AS audience_2k_last7,\n              SUM(audience_4k_last7) AS audience_4k_last7,\n              SUM(audience_1080p_last7) AS audience_1080p_last7,\n              SUM(host_1080p_last7) AS host_1080p_last7,\n              SUM(host_2k_last7) AS host_2k_last7,\n              SUM(host_4k_last7) AS host_4k_last7\n            FROM levels_usage_dod_di_1\n            WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211001 AND date <= 20211128 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n            GROUP BY date,\n              DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n                CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n              2,\n              3,\n              tag,\n              area,\n              dim,\n              8,\n              9,\n              10,\n              level4,\n              product_level1,\n              product_level2,\n              product_level3,\n              product_level4,\n              vid_internal_industry_en,\n              vid_use_case_en,\n              vid_sector_en,\n              ver_type,\n              ver,\n              os,\n              domain,\n              country,\n              region,\n              browser,\n              browser_ver,\n              dim_grouping_name) AS \"自定义 SQL 查询\"\n        WHERE CAST(\"自定义 SQL 查询\".\"level1\" AS VARCHAR) = 'RTSA' AND \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 3\n        GROUP BY 1,\n          2) AS \"t1\"\n      INNER JOIN (SELECT \"自定义 SQL 查询\".\"date\" AS \"date\",\n          SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"__measure__1\"\n        FROM (SELECT date,\n              start_date AS start_date,\n              end_date AS end_date,\n                CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n              tag,\n              area AS Scope,\n              dim,\n                CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n                CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n                CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n              level4,\n              product_level1 AS product_line,\n              product_level2,\n              product_level3,\n              product_level4,\n              vid_internal_industry_en AS cid_industry,\n              vid_use_case_en AS vid_use_case_cn,\n              vid_sector_en,\n              ver_type,\n              ver,\n              os,\n              domain,\n              country,\n              region,\n              browser,\n              browser_ver,\n              dim_grouping_name,\n              SUM(total) AS totalUsage,\n              SUM(audio) AS audio,\n              SUM(video) AS video,\n              SUM(host_sd + audience_sd) AS video_sd,\n              SUM(host_hd + audience_hd) AS video_hd,\n              SUM(host_hdp + audience_hdp) AS video_hdp,\n              SUM(host_audio) AS host_audio,\n              SUM(audience_audio) AS audience_audio,\n              SUM(host_sd) AS host_sd,\n              SUM(host_hd) AS host_hd,\n              SUM(host_hdp) AS host_hdp,\n              SUM(host_1080p) AS host_1080p,\n              SUM(host_2k) AS host_2k,\n              SUM(host_4k) AS host_4k,\n              SUM(audience_sd) AS audience_sd,\n              SUM(audience_hd) AS audience_hd,\n              SUM(audience_hdp) AS audience_hdp,\n              SUM(audience_1080p) AS audience_1080p,\n              SUM(audience_2k) AS audience_2k,\n              SUM(audience_4k) AS audience_4k,\n              SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n              SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n              SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n              SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n              SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n              SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n              SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n              SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n              SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n              SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n              SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n              SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n              SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n              SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n              SUM(total_last1) AS audio_video_last,\n              SUM(audio_last1) AS audio_last,\n              SUM(video_last1) AS video_last,\n              SUM(video_sd_last1) AS video_sd_last,\n              SUM(video_hd_last1) AS video_hd_last,\n              SUM(video_hdp_last1) AS video_hdp_last,\n              SUM(host_sd_last1) AS host_video_sd_last,\n              SUM(audience_sd_last1) AS audience_video_sd_last,\n              SUM(host_hd_last1) AS host_video_hd_last,\n              SUM(audience_hd_last1) AS audience_video_hd_last,\n              SUM(host_hdp_last1) AS host_video_hdp_last,\n              SUM(audience_hdp_last1) AS audience_video_hdp_last,\n              SUM(host_audio_last1) AS host_audio_last,\n              SUM(audience_audio_last1) AS audience_audio_last,\n              SUM(host_video_last1) AS host_video_last,\n              SUM(audience_video_last1) AS audience_video_last,\n              SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n              SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n              SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n              SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n              SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n              SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n              SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n              SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n              SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n              SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n              SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n              SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n              SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n              SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n              SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n              SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n              SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n              SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n              SUM(audience_2k_last1) AS audience_2k_last1,\n              SUM(audience_4k_last1) AS audience_4k_last1,\n              SUM(audience_1080p_last1) AS audience_1080p_last1,\n              SUM(host_1080p_last1) AS host_1080p_last1,\n              SUM(host_2k_last1) AS host_2k_last1,\n              SUM(host_4k_last1) AS host_4k_last1,\n              SUM(total_last7) AS total_last7,\n              SUM(audio_last7) AS audio_last7,\n              SUM(video_last7) AS video_last7,\n              SUM(video_sd_last7) AS video_sd_last7,\n              SUM(video_hd_last7) AS video_hd_last7,\n              SUM(video_hdp_last7) AS video_hdp_last7,\n              SUM(host_sd_last7) AS host_sd_last7,\n              SUM(audience_sd_last7) AS audience_sd_last7,\n              SUM(host_hd_last7) AS host_hd_last7,\n              SUM(audience_hd_last7) AS audience_hd_last7,\n              SUM(host_hdp_last7) AS host_hdp_last7,\n              SUM(audience_hdp_last7) AS audience_hdp_last7,\n              SUM(host_audio_last7) AS host_audio_last7,\n              SUM(audience_audio_last7) AS audience_audio_last7,\n              SUM(host_video_last7) AS host_video_last7,\n              SUM(audience_video_last7) AS audience_video_last7,\n              SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n              SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n              SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n              SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n              SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n              SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n              SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n              SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n              SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n              SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n              SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n              SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n              SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n              SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n              SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n              SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n              SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n              SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n              SUM(audience_2k_last7) AS audience_2k_last7,\n              SUM(audience_4k_last7) AS audience_4k_last7,\n              SUM(audience_1080p_last7) AS audience_1080p_last7,\n              SUM(host_1080p_last7) AS host_1080p_last7,\n              SUM(host_2k_last7) AS host_2k_last7,\n              SUM(host_4k_last7) AS host_4k_last7\n            FROM levels_usage_dod_di_1\n            WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211001 AND date <= 20211128 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n            GROUP BY date,\n              DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n                CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n              2,\n              3,\n              tag,\n              area,\n              dim,\n              8,\n              9,\n              10,\n              level4,\n              product_level1,\n              product_level2,\n              product_level3,\n              product_level4,\n              vid_internal_industry_en,\n              vid_use_case_en,\n              vid_sector_en,\n              ver_type,\n              ver,\n              os,\n              domain,\n              country,\n              region,\n              browser,\n              browser_ver,\n              dim_grouping_name) AS \"自定义 SQL 查询\"\n        GROUP BY 1) AS \"t2\" ON ((\"t1\".\"date\"  is null and  \"t2\".\"date\"  is null )  or  (\"t1\".\"date\" = \"t2\".\"date\"))\n    HAVING COUNT(1) > 0) AS \"t3\" ON \"t0\".\"level1\" = \"t3\".\"level1\""
	},
	{
		"presto_sql" : "SELECT \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"sum_totalUsage_ok\"\nFROM (SELECT date,\n      start_date AS start_date,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name,\n      SUM(total) AS totalUsage,\n      SUM(audio) AS audio,\n      SUM(video) AS video,\n      SUM(host_sd + audience_sd) AS video_sd,\n      SUM(host_hd + audience_hd) AS video_hd,\n      SUM(host_hdp + audience_hdp) AS video_hdp,\n      SUM(host_audio) AS host_audio,\n      SUM(audience_audio) AS audience_audio,\n      SUM(host_sd) AS host_sd,\n      SUM(host_hd) AS host_hd,\n      SUM(host_hdp) AS host_hdp,\n      SUM(host_1080p) AS host_1080p,\n      SUM(host_2k) AS host_2k,\n      SUM(host_4k) AS host_4k,\n      SUM(audience_sd) AS audience_sd,\n      SUM(audience_hd) AS audience_hd,\n      SUM(audience_hdp) AS audience_hdp,\n      SUM(audience_1080p) AS audience_1080p,\n      SUM(audience_2k) AS audience_2k,\n      SUM(audience_4k) AS audience_4k,\n      SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n      SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n      SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n      SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n      SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n      SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n      SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n      SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n      SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n      SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n      SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n      SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n      SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n      SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n      SUM(total_last1) AS audio_video_last,\n      SUM(audio_last1) AS audio_last,\n      SUM(video_last1) AS video_last,\n      SUM(video_sd_last1) AS video_sd_last,\n      SUM(video_hd_last1) AS video_hd_last,\n      SUM(video_hdp_last1) AS video_hdp_last,\n      SUM(host_sd_last1) AS host_video_sd_last,\n      SUM(audience_sd_last1) AS audience_video_sd_last,\n      SUM(host_hd_last1) AS host_video_hd_last,\n      SUM(audience_hd_last1) AS audience_video_hd_last,\n      SUM(host_hdp_last1) AS host_video_hdp_last,\n      SUM(audience_hdp_last1) AS audience_video_hdp_last,\n      SUM(host_audio_last1) AS host_audio_last,\n      SUM(audience_audio_last1) AS audience_audio_last,\n      SUM(host_video_last1) AS host_video_last,\n      SUM(audience_video_last1) AS audience_video_last,\n      SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n      SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n      SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n      SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n      SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n      SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n      SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n      SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n      SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n      SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n      SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n      SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n      SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n      SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n      SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n      SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n      SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n      SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n      SUM(audience_2k_last1) AS audience_2k_last1,\n      SUM(audience_4k_last1) AS audience_4k_last1,\n      SUM(audience_1080p_last1) AS audience_1080p_last1,\n      SUM(host_1080p_last1) AS host_1080p_last1,\n      SUM(host_2k_last1) AS host_2k_last1,\n      SUM(host_4k_last1) AS host_4k_last1,\n      SUM(total_last7) AS total_last7,\n      SUM(audio_last7) AS audio_last7,\n      SUM(video_last7) AS video_last7,\n      SUM(video_sd_last7) AS video_sd_last7,\n      SUM(video_hd_last7) AS video_hd_last7,\n      SUM(video_hdp_last7) AS video_hdp_last7,\n      SUM(host_sd_last7) AS host_sd_last7,\n      SUM(audience_sd_last7) AS audience_sd_last7,\n      SUM(host_hd_last7) AS host_hd_last7,\n      SUM(audience_hd_last7) AS audience_hd_last7,\n      SUM(host_hdp_last7) AS host_hdp_last7,\n      SUM(audience_hdp_last7) AS audience_hdp_last7,\n      SUM(host_audio_last7) AS host_audio_last7,\n      SUM(audience_audio_last7) AS audience_audio_last7,\n      SUM(host_video_last7) AS host_video_last7,\n      SUM(audience_video_last7) AS audience_video_last7,\n      SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n      SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n      SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n      SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n      SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n      SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n      SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n      SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n      SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n      SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n      SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n      SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n      SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n      SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n      SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n      SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n      SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n      SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n      SUM(audience_2k_last7) AS audience_2k_last7,\n      SUM(audience_4k_last7) AS audience_4k_last7,\n      SUM(audience_1080p_last7) AS audience_1080p_last7,\n      SUM(host_1080p_last7) AS host_1080p_last7,\n      SUM(host_2k_last7) AS host_2k_last7,\n      SUM(host_4k_last7) AS host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211001 AND date <= 20211128 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n    GROUP BY date,\n      DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n      2,\n      3,\n      tag,\n      area,\n      dim,\n      8,\n      9,\n      10,\n      level4,\n      product_level1,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en,\n      vid_use_case_en,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n          start_date AS start_date,\n          end_date AS end_date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          tag,\n          area AS Scope,\n          dim,\n            CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n            CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n            CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          browser,\n          browser_ver,\n          dim_grouping_name,\n          SUM(total) AS totalUsage,\n          SUM(audio) AS audio,\n          SUM(video) AS video,\n          SUM(host_sd + audience_sd) AS video_sd,\n          SUM(host_hd + audience_hd) AS video_hd,\n          SUM(host_hdp + audience_hdp) AS video_hdp,\n          SUM(host_audio) AS host_audio,\n          SUM(audience_audio) AS audience_audio,\n          SUM(host_sd) AS host_sd,\n          SUM(host_hd) AS host_hd,\n          SUM(host_hdp) AS host_hdp,\n          SUM(host_1080p) AS host_1080p,\n          SUM(host_2k) AS host_2k,\n          SUM(host_4k) AS host_4k,\n          SUM(audience_sd) AS audience_sd,\n          SUM(audience_hd) AS audience_hd,\n          SUM(audience_hdp) AS audience_hdp,\n          SUM(audience_1080p) AS audience_1080p,\n          SUM(audience_2k) AS audience_2k,\n          SUM(audience_4k) AS audience_4k,\n          SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n          SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n          SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n          SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n          SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n          SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n          SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n          SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n          SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n          SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n          SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n          SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n          SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n          SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n          SUM(total_last1) AS audio_video_last,\n          SUM(audio_last1) AS audio_last,\n          SUM(video_last1) AS video_last,\n          SUM(video_sd_last1) AS video_sd_last,\n          SUM(video_hd_last1) AS video_hd_last,\n          SUM(video_hdp_last1) AS video_hdp_last,\n          SUM(host_sd_last1) AS host_video_sd_last,\n          SUM(audience_sd_last1) AS audience_video_sd_last,\n          SUM(host_hd_last1) AS host_video_hd_last,\n          SUM(audience_hd_last1) AS audience_video_hd_last,\n          SUM(host_hdp_last1) AS host_video_hdp_last,\n          SUM(audience_hdp_last1) AS audience_video_hdp_last,\n          SUM(host_audio_last1) AS host_audio_last,\n          SUM(audience_audio_last1) AS audience_audio_last,\n          SUM(host_video_last1) AS host_video_last,\n          SUM(audience_video_last1) AS audience_video_last,\n          SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n          SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n          SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n          SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n          SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n          SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n          SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n          SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n          SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n          SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n          SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n          SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n          SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n          SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n          SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n          SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n          SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n          SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n          SUM(audience_2k_last1) AS audience_2k_last1,\n          SUM(audience_4k_last1) AS audience_4k_last1,\n          SUM(audience_1080p_last1) AS audience_1080p_last1,\n          SUM(host_1080p_last1) AS host_1080p_last1,\n          SUM(host_2k_last1) AS host_2k_last1,\n          SUM(host_4k_last1) AS host_4k_last1,\n          SUM(total_last7) AS total_last7,\n          SUM(audio_last7) AS audio_last7,\n          SUM(video_last7) AS video_last7,\n          SUM(video_sd_last7) AS video_sd_last7,\n          SUM(video_hd_last7) AS video_hd_last7,\n          SUM(video_hdp_last7) AS video_hdp_last7,\n          SUM(host_sd_last7) AS host_sd_last7,\n          SUM(audience_sd_last7) AS audience_sd_last7,\n          SUM(host_hd_last7) AS host_hd_last7,\n          SUM(audience_hd_last7) AS audience_hd_last7,\n          SUM(host_hdp_last7) AS host_hdp_last7,\n          SUM(audience_hdp_last7) AS audience_hdp_last7,\n          SUM(host_audio_last7) AS host_audio_last7,\n          SUM(audience_audio_last7) AS audience_audio_last7,\n          SUM(host_video_last7) AS host_video_last7,\n          SUM(audience_video_last7) AS audience_video_last7,\n          SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n          SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n          SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n          SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n          SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n          SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n          SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n          SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n          SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n          SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n          SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n          SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n          SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n          SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n          SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n          SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n          SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n          SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n          SUM(audience_2k_last7) AS audience_2k_last7,\n          SUM(audience_4k_last7) AS audience_4k_last7,\n          SUM(audience_1080p_last7) AS audience_1080p_last7,\n          SUM(host_1080p_last7) AS host_1080p_last7,\n          SUM(host_2k_last7) AS host_2k_last7,\n          SUM(host_4k_last7) AS host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211001 AND date <= 20211128 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n        GROUP BY date,\n          DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n          2,\n          3,\n          tag,\n          area,\n          dim,\n          8,\n          9,\n          10,\n          level4,\n          product_level1,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en,\n          vid_use_case_en,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          browser,\n          browser_ver,\n          dim_grouping_name) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE CAST(\"自定义 SQL 查询\".\"level1\" AS VARCHAR) = 'RTSA' AND \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 3 AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 1"
	},
	{
		"presto_sql" : "SELECT MIN(1) AS \"empty\"\nFROM (SELECT date,\n      start_date AS start_date_7,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      vid,\n      project,\n      company_id,\n      company_name,\n      dim_grouping_name,\n      rownum,\n      total,\n      total_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211001 AND date <= 20211128 AND dim IN (101, 102, 103)) AS \"自定义 SQL 查询\"\nHAVING COUNT(1) > 0"
	},
	{
		"presto_sql" : "SELECT MAX(\"自定义 SQL 查询\".\"level2\") AS \"TEMP(attr_level2_nk)(3222240611)(0)\",\n  MIN(\"自定义 SQL 查询\".\"level2\") AS \"TEMP(attr_level2_nk)(3931055347)(0)\"\nFROM (SELECT date,\n      start_date AS start_date_7,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      vid,\n      project,\n      company_id,\n      company_name,\n      dim_grouping_name,\n      rownum,\n      total,\n      total_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211001 AND date <= 20211128 AND dim IN (101, 102, 103)) AS \"自定义 SQL 查询\"\nHAVING COUNT(1) > 0"
	},
	{
		"presto_sql" : "SELECT \"自定义 SQL 查询\".\"product_level3\" AS \"product_level3\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"usr_Calculation_3519281700079370244_ok\"\nFROM (SELECT date,\n      start_date AS start_date,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name,\n      SUM(total) AS totalUsage,\n      SUM(audio) AS audio,\n      SUM(video) AS video,\n      SUM(host_sd + audience_sd) AS video_sd,\n      SUM(host_hd + audience_hd) AS video_hd,\n      SUM(host_hdp + audience_hdp) AS video_hdp,\n      SUM(host_audio) AS host_audio,\n      SUM(audience_audio) AS audience_audio,\n      SUM(host_sd) AS host_sd,\n      SUM(host_hd) AS host_hd,\n      SUM(host_hdp) AS host_hdp,\n      SUM(host_1080p) AS host_1080p,\n      SUM(host_2k) AS host_2k,\n      SUM(host_4k) AS host_4k,\n      SUM(audience_sd) AS audience_sd,\n      SUM(audience_hd) AS audience_hd,\n      SUM(audience_hdp) AS audience_hdp,\n      SUM(audience_1080p) AS audience_1080p,\n      SUM(audience_2k) AS audience_2k,\n      SUM(audience_4k) AS audience_4k,\n      SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n      SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n      SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n      SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n      SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n      SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n      SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n      SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n      SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n      SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n      SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n      SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n      SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n      SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n      SUM(total_last1) AS audio_video_last,\n      SUM(audio_last1) AS audio_last,\n      SUM(video_last1) AS video_last,\n      SUM(video_sd_last1) AS video_sd_last,\n      SUM(video_hd_last1) AS video_hd_last,\n      SUM(video_hdp_last1) AS video_hdp_last,\n      SUM(host_sd_last1) AS host_video_sd_last,\n      SUM(audience_sd_last1) AS audience_video_sd_last,\n      SUM(host_hd_last1) AS host_video_hd_last,\n      SUM(audience_hd_last1) AS audience_video_hd_last,\n      SUM(host_hdp_last1) AS host_video_hdp_last,\n      SUM(audience_hdp_last1) AS audience_video_hdp_last,\n      SUM(host_audio_last1) AS host_audio_last,\n      SUM(audience_audio_last1) AS audience_audio_last,\n      SUM(host_video_last1) AS host_video_last,\n      SUM(audience_video_last1) AS audience_video_last,\n      SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n      SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n      SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n      SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n      SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n      SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n      SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n      SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n      SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n      SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n      SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n      SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n      SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n      SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n      SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n      SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n      SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n      SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n      SUM(audience_2k_last1) AS audience_2k_last1,\n      SUM(audience_4k_last1) AS audience_4k_last1,\n      SUM(audience_1080p_last1) AS audience_1080p_last1,\n      SUM(host_1080p_last1) AS host_1080p_last1,\n      SUM(host_2k_last1) AS host_2k_last1,\n      SUM(host_4k_last1) AS host_4k_last1,\n      SUM(total_last7) AS total_last7,\n      SUM(audio_last7) AS audio_last7,\n      SUM(video_last7) AS video_last7,\n      SUM(video_sd_last7) AS video_sd_last7,\n      SUM(video_hd_last7) AS video_hd_last7,\n      SUM(video_hdp_last7) AS video_hdp_last7,\n      SUM(host_sd_last7) AS host_sd_last7,\n      SUM(audience_sd_last7) AS audience_sd_last7,\n      SUM(host_hd_last7) AS host_hd_last7,\n      SUM(audience_hd_last7) AS audience_hd_last7,\n      SUM(host_hdp_last7) AS host_hdp_last7,\n      SUM(audience_hdp_last7) AS audience_hdp_last7,\n      SUM(host_audio_last7) AS host_audio_last7,\n      SUM(audience_audio_last7) AS audience_audio_last7,\n      SUM(host_video_last7) AS host_video_last7,\n      SUM(audience_video_last7) AS audience_video_last7,\n      SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n      SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n      SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n      SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n      SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n      SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n      SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n      SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n      SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n      SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n      SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n      SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n      SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n      SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n      SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n      SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n      SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n      SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n      SUM(audience_2k_last7) AS audience_2k_last7,\n      SUM(audience_4k_last7) AS audience_4k_last7,\n      SUM(audience_1080p_last7) AS audience_1080p_last7,\n      SUM(host_1080p_last7) AS host_1080p_last7,\n      SUM(host_2k_last7) AS host_2k_last7,\n      SUM(host_4k_last7) AS host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211001 AND date <= 20211128 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n    GROUP BY date,\n      DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n      2,\n      3,\n      tag,\n      area,\n      dim,\n      8,\n      9,\n      10,\n      level4,\n      product_level1,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en,\n      vid_use_case_en,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name) AS \"自定义 SQL 查询\"\nWHERE \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 3 AND CAST(\"自定义 SQL 查询\".\"level1\" AS VARCHAR) = 'RTSA'\nGROUP BY 1"
	},
	{
		"presto_sql" : "SELECT \"自定义 SQL 查询\".\"product_level2\" AS \"product_level2\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"usr_Calculation_3519281700079370244_ok\"\nFROM (SELECT date,\n      start_date AS start_date,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name,\n      SUM(total) AS totalUsage,\n      SUM(audio) AS audio,\n      SUM(video) AS video,\n      SUM(host_sd + audience_sd) AS video_sd,\n      SUM(host_hd + audience_hd) AS video_hd,\n      SUM(host_hdp + audience_hdp) AS video_hdp,\n      SUM(host_audio) AS host_audio,\n      SUM(audience_audio) AS audience_audio,\n      SUM(host_sd) AS host_sd,\n      SUM(host_hd) AS host_hd,\n      SUM(host_hdp) AS host_hdp,\n      SUM(host_1080p) AS host_1080p,\n      SUM(host_2k) AS host_2k,\n      SUM(host_4k) AS host_4k,\n      SUM(audience_sd) AS audience_sd,\n      SUM(audience_hd) AS audience_hd,\n      SUM(audience_hdp) AS audience_hdp,\n      SUM(audience_1080p) AS audience_1080p,\n      SUM(audience_2k) AS audience_2k,\n      SUM(audience_4k) AS audience_4k,\n      SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n      SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n      SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n      SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n      SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n      SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n      SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n      SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n      SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n      SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n      SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n      SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n      SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n      SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n      SUM(total_last1) AS audio_video_last,\n      SUM(audio_last1) AS audio_last,\n      SUM(video_last1) AS video_last,\n      SUM(video_sd_last1) AS video_sd_last,\n      SUM(video_hd_last1) AS video_hd_last,\n      SUM(video_hdp_last1) AS video_hdp_last,\n      SUM(host_sd_last1) AS host_video_sd_last,\n      SUM(audience_sd_last1) AS audience_video_sd_last,\n      SUM(host_hd_last1) AS host_video_hd_last,\n      SUM(audience_hd_last1) AS audience_video_hd_last,\n      SUM(host_hdp_last1) AS host_video_hdp_last,\n      SUM(audience_hdp_last1) AS audience_video_hdp_last,\n      SUM(host_audio_last1) AS host_audio_last,\n      SUM(audience_audio_last1) AS audience_audio_last,\n      SUM(host_video_last1) AS host_video_last,\n      SUM(audience_video_last1) AS audience_video_last,\n      SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n      SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n      SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n      SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n      SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n      SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n      SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n      SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n      SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n      SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n      SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n      SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n      SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n      SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n      SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n      SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n      SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n      SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n      SUM(audience_2k_last1) AS audience_2k_last1,\n      SUM(audience_4k_last1) AS audience_4k_last1,\n      SUM(audience_1080p_last1) AS audience_1080p_last1,\n      SUM(host_1080p_last1) AS host_1080p_last1,\n      SUM(host_2k_last1) AS host_2k_last1,\n      SUM(host_4k_last1) AS host_4k_last1,\n      SUM(total_last7) AS total_last7,\n      SUM(audio_last7) AS audio_last7,\n      SUM(video_last7) AS video_last7,\n      SUM(video_sd_last7) AS video_sd_last7,\n      SUM(video_hd_last7) AS video_hd_last7,\n      SUM(video_hdp_last7) AS video_hdp_last7,\n      SUM(host_sd_last7) AS host_sd_last7,\n      SUM(audience_sd_last7) AS audience_sd_last7,\n      SUM(host_hd_last7) AS host_hd_last7,\n      SUM(audience_hd_last7) AS audience_hd_last7,\n      SUM(host_hdp_last7) AS host_hdp_last7,\n      SUM(audience_hdp_last7) AS audience_hdp_last7,\n      SUM(host_audio_last7) AS host_audio_last7,\n      SUM(audience_audio_last7) AS audience_audio_last7,\n      SUM(host_video_last7) AS host_video_last7,\n      SUM(audience_video_last7) AS audience_video_last7,\n      SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n      SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n      SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n      SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n      SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n      SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n      SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n      SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n      SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n      SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n      SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n      SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n      SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n      SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n      SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n      SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n      SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n      SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n      SUM(audience_2k_last7) AS audience_2k_last7,\n      SUM(audience_4k_last7) AS audience_4k_last7,\n      SUM(audience_1080p_last7) AS audience_1080p_last7,\n      SUM(host_1080p_last7) AS host_1080p_last7,\n      SUM(host_2k_last7) AS host_2k_last7,\n      SUM(host_4k_last7) AS host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211001 AND date <= 20211128 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n    GROUP BY date,\n      DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n      2,\n      3,\n      tag,\n      area,\n      dim,\n      8,\n      9,\n      10,\n      level4,\n      product_level1,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en,\n      vid_use_case_en,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name) AS \"自定义 SQL 查询\"\nWHERE \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 3 AND CAST(\"自定义 SQL 查询\".\"level1\" AS VARCHAR) = 'RTSA'\nGROUP BY 1"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"usr_Calculation_3519281700079370244_ok\",\n  \"自定义 SQL 查询\".\"vid_sector_en\" AS \"vid_sector_en\"\nFROM (SELECT date,\n      start_date AS start_date,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name,\n      SUM(total) AS totalUsage,\n      SUM(audio) AS audio,\n      SUM(video) AS video,\n      SUM(host_sd + audience_sd) AS video_sd,\n      SUM(host_hd + audience_hd) AS video_hd,\n      SUM(host_hdp + audience_hdp) AS video_hdp,\n      SUM(host_audio) AS host_audio,\n      SUM(audience_audio) AS audience_audio,\n      SUM(host_sd) AS host_sd,\n      SUM(host_hd) AS host_hd,\n      SUM(host_hdp) AS host_hdp,\n      SUM(host_1080p) AS host_1080p,\n      SUM(host_2k) AS host_2k,\n      SUM(host_4k) AS host_4k,\n      SUM(audience_sd) AS audience_sd,\n      SUM(audience_hd) AS audience_hd,\n      SUM(audience_hdp) AS audience_hdp,\n      SUM(audience_1080p) AS audience_1080p,\n      SUM(audience_2k) AS audience_2k,\n      SUM(audience_4k) AS audience_4k,\n      SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n      SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n      SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n      SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n      SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n      SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n      SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n      SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n      SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n      SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n      SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n      SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n      SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n      SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n      SUM(total_last1) AS audio_video_last,\n      SUM(audio_last1) AS audio_last,\n      SUM(video_last1) AS video_last,\n      SUM(video_sd_last1) AS video_sd_last,\n      SUM(video_hd_last1) AS video_hd_last,\n      SUM(video_hdp_last1) AS video_hdp_last,\n      SUM(host_sd_last1) AS host_video_sd_last,\n      SUM(audience_sd_last1) AS audience_video_sd_last,\n      SUM(host_hd_last1) AS host_video_hd_last,\n      SUM(audience_hd_last1) AS audience_video_hd_last,\n      SUM(host_hdp_last1) AS host_video_hdp_last,\n      SUM(audience_hdp_last1) AS audience_video_hdp_last,\n      SUM(host_audio_last1) AS host_audio_last,\n      SUM(audience_audio_last1) AS audience_audio_last,\n      SUM(host_video_last1) AS host_video_last,\n      SUM(audience_video_last1) AS audience_video_last,\n      SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n      SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n      SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n      SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n      SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n      SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n      SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n      SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n      SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n      SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n      SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n      SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n      SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n      SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n      SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n      SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n      SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n      SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n      SUM(audience_2k_last1) AS audience_2k_last1,\n      SUM(audience_4k_last1) AS audience_4k_last1,\n      SUM(audience_1080p_last1) AS audience_1080p_last1,\n      SUM(host_1080p_last1) AS host_1080p_last1,\n      SUM(host_2k_last1) AS host_2k_last1,\n      SUM(host_4k_last1) AS host_4k_last1,\n      SUM(total_last7) AS total_last7,\n      SUM(audio_last7) AS audio_last7,\n      SUM(video_last7) AS video_last7,\n      SUM(video_sd_last7) AS video_sd_last7,\n      SUM(video_hd_last7) AS video_hd_last7,\n      SUM(video_hdp_last7) AS video_hdp_last7,\n      SUM(host_sd_last7) AS host_sd_last7,\n      SUM(audience_sd_last7) AS audience_sd_last7,\n      SUM(host_hd_last7) AS host_hd_last7,\n      SUM(audience_hd_last7) AS audience_hd_last7,\n      SUM(host_hdp_last7) AS host_hdp_last7,\n      SUM(audience_hdp_last7) AS audience_hdp_last7,\n      SUM(host_audio_last7) AS host_audio_last7,\n      SUM(audience_audio_last7) AS audience_audio_last7,\n      SUM(host_video_last7) AS host_video_last7,\n      SUM(audience_video_last7) AS audience_video_last7,\n      SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n      SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n      SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n      SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n      SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n      SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n      SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n      SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n      SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n      SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n      SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n      SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n      SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n      SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n      SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n      SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n      SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n      SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n      SUM(audience_2k_last7) AS audience_2k_last7,\n      SUM(audience_4k_last7) AS audience_4k_last7,\n      SUM(audience_1080p_last7) AS audience_1080p_last7,\n      SUM(host_1080p_last7) AS host_1080p_last7,\n      SUM(host_2k_last7) AS host_2k_last7,\n      SUM(host_4k_last7) AS host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211001 AND date <= 20211128 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n    GROUP BY date,\n      DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n      2,\n      3,\n      tag,\n      area,\n      dim,\n      8,\n      9,\n      10,\n      level4,\n      product_level1,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en,\n      vid_use_case_en,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name) AS \"自定义 SQL 查询\"\nWHERE \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 3 AND CAST(\"自定义 SQL 查询\".\"level1\" AS VARCHAR) = 'RTSA'\nGROUP BY 2"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"usr_Calculation_3519281700079370244_ok\",\n  \"自定义 SQL 查询\".\"vid_use_case_cn\" AS \"vid_use_case_cn\"\nFROM (SELECT date,\n      start_date AS start_date,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name,\n      SUM(total) AS totalUsage,\n      SUM(audio) AS audio,\n      SUM(video) AS video,\n      SUM(host_sd + audience_sd) AS video_sd,\n      SUM(host_hd + audience_hd) AS video_hd,\n      SUM(host_hdp + audience_hdp) AS video_hdp,\n      SUM(host_audio) AS host_audio,\n      SUM(audience_audio) AS audience_audio,\n      SUM(host_sd) AS host_sd,\n      SUM(host_hd) AS host_hd,\n      SUM(host_hdp) AS host_hdp,\n      SUM(host_1080p) AS host_1080p,\n      SUM(host_2k) AS host_2k,\n      SUM(host_4k) AS host_4k,\n      SUM(audience_sd) AS audience_sd,\n      SUM(audience_hd) AS audience_hd,\n      SUM(audience_hdp) AS audience_hdp,\n      SUM(audience_1080p) AS audience_1080p,\n      SUM(audience_2k) AS audience_2k,\n      SUM(audience_4k) AS audience_4k,\n      SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n      SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n      SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n      SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n      SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n      SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n      SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n      SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n      SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n      SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n      SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n      SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n      SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n      SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n      SUM(total_last1) AS audio_video_last,\n      SUM(audio_last1) AS audio_last,\n      SUM(video_last1) AS video_last,\n      SUM(video_sd_last1) AS video_sd_last,\n      SUM(video_hd_last1) AS video_hd_last,\n      SUM(video_hdp_last1) AS video_hdp_last,\n      SUM(host_sd_last1) AS host_video_sd_last,\n      SUM(audience_sd_last1) AS audience_video_sd_last,\n      SUM(host_hd_last1) AS host_video_hd_last,\n      SUM(audience_hd_last1) AS audience_video_hd_last,\n      SUM(host_hdp_last1) AS host_video_hdp_last,\n      SUM(audience_hdp_last1) AS audience_video_hdp_last,\n      SUM(host_audio_last1) AS host_audio_last,\n      SUM(audience_audio_last1) AS audience_audio_last,\n      SUM(host_video_last1) AS host_video_last,\n      SUM(audience_video_last1) AS audience_video_last,\n      SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n      SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n      SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n      SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n      SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n      SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n      SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n      SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n      SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n      SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n      SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n      SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n      SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n      SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n      SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n      SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n      SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n      SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n      SUM(audience_2k_last1) AS audience_2k_last1,\n      SUM(audience_4k_last1) AS audience_4k_last1,\n      SUM(audience_1080p_last1) AS audience_1080p_last1,\n      SUM(host_1080p_last1) AS host_1080p_last1,\n      SUM(host_2k_last1) AS host_2k_last1,\n      SUM(host_4k_last1) AS host_4k_last1,\n      SUM(total_last7) AS total_last7,\n      SUM(audio_last7) AS audio_last7,\n      SUM(video_last7) AS video_last7,\n      SUM(video_sd_last7) AS video_sd_last7,\n      SUM(video_hd_last7) AS video_hd_last7,\n      SUM(video_hdp_last7) AS video_hdp_last7,\n      SUM(host_sd_last7) AS host_sd_last7,\n      SUM(audience_sd_last7) AS audience_sd_last7,\n      SUM(host_hd_last7) AS host_hd_last7,\n      SUM(audience_hd_last7) AS audience_hd_last7,\n      SUM(host_hdp_last7) AS host_hdp_last7,\n      SUM(audience_hdp_last7) AS audience_hdp_last7,\n      SUM(host_audio_last7) AS host_audio_last7,\n      SUM(audience_audio_last7) AS audience_audio_last7,\n      SUM(host_video_last7) AS host_video_last7,\n      SUM(audience_video_last7) AS audience_video_last7,\n      SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n      SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n      SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n      SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n      SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n      SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n      SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n      SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n      SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n      SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n      SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n      SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n      SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n      SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n      SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n      SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n      SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n      SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n      SUM(audience_2k_last7) AS audience_2k_last7,\n      SUM(audience_4k_last7) AS audience_4k_last7,\n      SUM(audience_1080p_last7) AS audience_1080p_last7,\n      SUM(host_1080p_last7) AS host_1080p_last7,\n      SUM(host_2k_last7) AS host_2k_last7,\n      SUM(host_4k_last7) AS host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211001 AND date <= 20211128 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n    GROUP BY date,\n      DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n      2,\n      3,\n      tag,\n      area,\n      dim,\n      8,\n      9,\n      10,\n      level4,\n      product_level1,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en,\n      vid_use_case_en,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name) AS \"自定义 SQL 查询\"\nWHERE \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 3 AND CAST(\"自定义 SQL 查询\".\"level1\" AS VARCHAR) = 'RTSA'\nGROUP BY 2"
	},
	{
		"presto_sql" : "SELECT \"自定义 SQL 查询\".\"level3\" AS \"level3\"\nFROM (SELECT date,\n      start_date AS start_date,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name,\n      SUM(total) AS totalUsage,\n      SUM(audio) AS audio,\n      SUM(video) AS video,\n      SUM(host_sd + audience_sd) AS video_sd,\n      SUM(host_hd + audience_hd) AS video_hd,\n      SUM(host_hdp + audience_hdp) AS video_hdp,\n      SUM(host_audio) AS host_audio,\n      SUM(audience_audio) AS audience_audio,\n      SUM(host_sd) AS host_sd,\n      SUM(host_hd) AS host_hd,\n      SUM(host_hdp) AS host_hdp,\n      SUM(host_1080p) AS host_1080p,\n      SUM(host_2k) AS host_2k,\n      SUM(host_4k) AS host_4k,\n      SUM(audience_sd) AS audience_sd,\n      SUM(audience_hd) AS audience_hd,\n      SUM(audience_hdp) AS audience_hdp,\n      SUM(audience_1080p) AS audience_1080p,\n      SUM(audience_2k) AS audience_2k,\n      SUM(audience_4k) AS audience_4k,\n      SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n      SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n      SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n      SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n      SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n      SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n      SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n      SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n      SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n      SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n      SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n      SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n      SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n      SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n      SUM(total_last1) AS audio_video_last,\n      SUM(audio_last1) AS audio_last,\n      SUM(video_last1) AS video_last,\n      SUM(video_sd_last1) AS video_sd_last,\n      SUM(video_hd_last1) AS video_hd_last,\n      SUM(video_hdp_last1) AS video_hdp_last,\n      SUM(host_sd_last1) AS host_video_sd_last,\n      SUM(audience_sd_last1) AS audience_video_sd_last,\n      SUM(host_hd_last1) AS host_video_hd_last,\n      SUM(audience_hd_last1) AS audience_video_hd_last,\n      SUM(host_hdp_last1) AS host_video_hdp_last,\n      SUM(audience_hdp_last1) AS audience_video_hdp_last,\n      SUM(host_audio_last1) AS host_audio_last,\n      SUM(audience_audio_last1) AS audience_audio_last,\n      SUM(host_video_last1) AS host_video_last,\n      SUM(audience_video_last1) AS audience_video_last,\n      SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n      SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n      SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n      SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n      SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n      SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n      SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n      SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n      SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n      SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n      SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n      SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n      SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n      SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n      SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n      SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n      SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n      SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n      SUM(audience_2k_last1) AS audience_2k_last1,\n      SUM(audience_4k_last1) AS audience_4k_last1,\n      SUM(audience_1080p_last1) AS audience_1080p_last1,\n      SUM(host_1080p_last1) AS host_1080p_last1,\n      SUM(host_2k_last1) AS host_2k_last1,\n      SUM(host_4k_last1) AS host_4k_last1,\n      SUM(total_last7) AS total_last7,\n      SUM(audio_last7) AS audio_last7,\n      SUM(video_last7) AS video_last7,\n      SUM(video_sd_last7) AS video_sd_last7,\n      SUM(video_hd_last7) AS video_hd_last7,\n      SUM(video_hdp_last7) AS video_hdp_last7,\n      SUM(host_sd_last7) AS host_sd_last7,\n      SUM(audience_sd_last7) AS audience_sd_last7,\n      SUM(host_hd_last7) AS host_hd_last7,\n      SUM(audience_hd_last7) AS audience_hd_last7,\n      SUM(host_hdp_last7) AS host_hdp_last7,\n      SUM(audience_hdp_last7) AS audience_hdp_last7,\n      SUM(host_audio_last7) AS host_audio_last7,\n      SUM(audience_audio_last7) AS audience_audio_last7,\n      SUM(host_video_last7) AS host_video_last7,\n      SUM(audience_video_last7) AS audience_video_last7,\n      SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n      SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n      SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n      SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n      SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n      SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n      SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n      SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n      SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n      SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n      SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n      SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n      SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n      SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n      SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n      SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n      SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n      SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n      SUM(audience_2k_last7) AS audience_2k_last7,\n      SUM(audience_4k_last7) AS audience_4k_last7,\n      SUM(audience_1080p_last7) AS audience_1080p_last7,\n      SUM(host_1080p_last7) AS host_1080p_last7,\n      SUM(host_2k_last7) AS host_2k_last7,\n      SUM(host_4k_last7) AS host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211001 AND date <= 20211128 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n    GROUP BY date,\n      DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n      2,\n      3,\n      tag,\n      area,\n      dim,\n      8,\n      9,\n      10,\n      level4,\n      product_level1,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en,\n      vid_use_case_en,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name) AS \"自定义 SQL 查询\"\nWHERE \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 3 AND CAST(\"自定义 SQL 查询\".\"level1\" AS VARCHAR) = 'RTSA'\nGROUP BY 1"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700079370244)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700079370244)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700079370244)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700079370244)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700079370244)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700079370244)(943764407)(0)\",\n  MIN(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(1482809429)(0)\",\n  MIN(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(3765460736)(0)\",\n  \"自定义 SQL 查询\".\"stat_date\" AS \"TEMP(attr_stat_date_nk)(2102638629)(0)\",\n  \"自定义 SQL 查询\".\"stat_date\" AS \"TEMP(attr_stat_date_nk)(2790680713)(0)\",\n  \"自定义 SQL 查询\".\"cid_industry\" AS \"cid_industry\",\n  \"自定义 SQL 查询\".\"stat_date\" AS \"stat_date\"\nFROM (SELECT date,\n      start_date AS start_date,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name,\n      SUM(total) AS totalUsage,\n      SUM(audio) AS audio,\n      SUM(video) AS video,\n      SUM(host_sd + audience_sd) AS video_sd,\n      SUM(host_hd + audience_hd) AS video_hd,\n      SUM(host_hdp + audience_hdp) AS video_hdp,\n      SUM(host_audio) AS host_audio,\n      SUM(audience_audio) AS audience_audio,\n      SUM(host_sd) AS host_sd,\n      SUM(host_hd) AS host_hd,\n      SUM(host_hdp) AS host_hdp,\n      SUM(host_1080p) AS host_1080p,\n      SUM(host_2k) AS host_2k,\n      SUM(host_4k) AS host_4k,\n      SUM(audience_sd) AS audience_sd,\n      SUM(audience_hd) AS audience_hd,\n      SUM(audience_hdp) AS audience_hdp,\n      SUM(audience_1080p) AS audience_1080p,\n      SUM(audience_2k) AS audience_2k,\n      SUM(audience_4k) AS audience_4k,\n      SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n      SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n      SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n      SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n      SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n      SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n      SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n      SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n      SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n      SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n      SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n      SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n      SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n      SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n      SUM(total_last1) AS audio_video_last,\n      SUM(audio_last1) AS audio_last,\n      SUM(video_last1) AS video_last,\n      SUM(video_sd_last1) AS video_sd_last,\n      SUM(video_hd_last1) AS video_hd_last,\n      SUM(video_hdp_last1) AS video_hdp_last,\n      SUM(host_sd_last1) AS host_video_sd_last,\n      SUM(audience_sd_last1) AS audience_video_sd_last,\n      SUM(host_hd_last1) AS host_video_hd_last,\n      SUM(audience_hd_last1) AS audience_video_hd_last,\n      SUM(host_hdp_last1) AS host_video_hdp_last,\n      SUM(audience_hdp_last1) AS audience_video_hdp_last,\n      SUM(host_audio_last1) AS host_audio_last,\n      SUM(audience_audio_last1) AS audience_audio_last,\n      SUM(host_video_last1) AS host_video_last,\n      SUM(audience_video_last1) AS audience_video_last,\n      SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n      SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n      SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n      SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n      SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n      SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n      SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n      SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n      SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n      SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n      SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n      SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n      SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n      SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n      SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n      SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n      SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n      SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n      SUM(audience_2k_last1) AS audience_2k_last1,\n      SUM(audience_4k_last1) AS audience_4k_last1,\n      SUM(audience_1080p_last1) AS audience_1080p_last1,\n      SUM(host_1080p_last1) AS host_1080p_last1,\n      SUM(host_2k_last1) AS host_2k_last1,\n      SUM(host_4k_last1) AS host_4k_last1,\n      SUM(total_last7) AS total_last7,\n      SUM(audio_last7) AS audio_last7,\n      SUM(video_last7) AS video_last7,\n      SUM(video_sd_last7) AS video_sd_last7,\n      SUM(video_hd_last7) AS video_hd_last7,\n      SUM(video_hdp_last7) AS video_hdp_last7,\n      SUM(host_sd_last7) AS host_sd_last7,\n      SUM(audience_sd_last7) AS audience_sd_last7,\n      SUM(host_hd_last7) AS host_hd_last7,\n      SUM(audience_hd_last7) AS audience_hd_last7,\n      SUM(host_hdp_last7) AS host_hdp_last7,\n      SUM(audience_hdp_last7) AS audience_hdp_last7,\n      SUM(host_audio_last7) AS host_audio_last7,\n      SUM(audience_audio_last7) AS audience_audio_last7,\n      SUM(host_video_last7) AS host_video_last7,\n      SUM(audience_video_last7) AS audience_video_last7,\n      SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n      SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n      SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n      SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n      SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n      SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n      SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n      SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n      SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n      SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n      SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n      SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n      SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n      SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n      SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n      SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n      SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n      SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n      SUM(audience_2k_last7) AS audience_2k_last7,\n      SUM(audience_4k_last7) AS audience_4k_last7,\n      SUM(audience_1080p_last7) AS audience_1080p_last7,\n      SUM(host_1080p_last7) AS host_1080p_last7,\n      SUM(host_2k_last7) AS host_2k_last7,\n      SUM(host_4k_last7) AS host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211001 AND date <= 20211128 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n    GROUP BY date,\n      DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n      2,\n      3,\n      tag,\n      area,\n      dim,\n      8,\n      9,\n      10,\n      level4,\n      product_level1,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en,\n      vid_use_case_en,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name) AS \"自定义 SQL 查询\"\nWHERE \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 3 AND CAST(\"自定义 SQL 查询\".\"level1\" AS VARCHAR) = 'RTSA'\nGROUP BY 22,\n  23"
	},
	{
		"presto_sql" : "SELECT \"自定义 SQL 查询\".\"product_level2\" AS \"product_level2\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"usr_Calculation_3519281700079370244_ok\"\nFROM (SELECT date,\n      start_date AS start_date,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name,\n      SUM(total) AS totalUsage,\n      SUM(audio) AS audio,\n      SUM(video) AS video,\n      SUM(host_sd + audience_sd) AS video_sd,\n      SUM(host_hd + audience_hd) AS video_hd,\n      SUM(host_hdp + audience_hdp) AS video_hdp,\n      SUM(host_audio) AS host_audio,\n      SUM(audience_audio) AS audience_audio,\n      SUM(host_sd) AS host_sd,\n      SUM(host_hd) AS host_hd,\n      SUM(host_hdp) AS host_hdp,\n      SUM(host_1080p) AS host_1080p,\n      SUM(host_2k) AS host_2k,\n      SUM(host_4k) AS host_4k,\n      SUM(audience_sd) AS audience_sd,\n      SUM(audience_hd) AS audience_hd,\n      SUM(audience_hdp) AS audience_hdp,\n      SUM(audience_1080p) AS audience_1080p,\n      SUM(audience_2k) AS audience_2k,\n      SUM(audience_4k) AS audience_4k,\n      SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n      SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n      SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n      SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n      SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n      SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n      SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n      SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n      SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n      SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n      SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n      SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n      SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n      SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n      SUM(total_last1) AS audio_video_last,\n      SUM(audio_last1) AS audio_last,\n      SUM(video_last1) AS video_last,\n      SUM(video_sd_last1) AS video_sd_last,\n      SUM(video_hd_last1) AS video_hd_last,\n      SUM(video_hdp_last1) AS video_hdp_last,\n      SUM(host_sd_last1) AS host_video_sd_last,\n      SUM(audience_sd_last1) AS audience_video_sd_last,\n      SUM(host_hd_last1) AS host_video_hd_last,\n      SUM(audience_hd_last1) AS audience_video_hd_last,\n      SUM(host_hdp_last1) AS host_video_hdp_last,\n      SUM(audience_hdp_last1) AS audience_video_hdp_last,\n      SUM(host_audio_last1) AS host_audio_last,\n      SUM(audience_audio_last1) AS audience_audio_last,\n      SUM(host_video_last1) AS host_video_last,\n      SUM(audience_video_last1) AS audience_video_last,\n      SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n      SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n      SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n      SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n      SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n      SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n      SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n      SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n      SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n      SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n      SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n      SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n      SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n      SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n      SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n      SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n      SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n      SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n      SUM(audience_2k_last1) AS audience_2k_last1,\n      SUM(audience_4k_last1) AS audience_4k_last1,\n      SUM(audience_1080p_last1) AS audience_1080p_last1,\n      SUM(host_1080p_last1) AS host_1080p_last1,\n      SUM(host_2k_last1) AS host_2k_last1,\n      SUM(host_4k_last1) AS host_4k_last1,\n      SUM(total_last7) AS total_last7,\n      SUM(audio_last7) AS audio_last7,\n      SUM(video_last7) AS video_last7,\n      SUM(video_sd_last7) AS video_sd_last7,\n      SUM(video_hd_last7) AS video_hd_last7,\n      SUM(video_hdp_last7) AS video_hdp_last7,\n      SUM(host_sd_last7) AS host_sd_last7,\n      SUM(audience_sd_last7) AS audience_sd_last7,\n      SUM(host_hd_last7) AS host_hd_last7,\n      SUM(audience_hd_last7) AS audience_hd_last7,\n      SUM(host_hdp_last7) AS host_hdp_last7,\n      SUM(audience_hdp_last7) AS audience_hdp_last7,\n      SUM(host_audio_last7) AS host_audio_last7,\n      SUM(audience_audio_last7) AS audience_audio_last7,\n      SUM(host_video_last7) AS host_video_last7,\n      SUM(audience_video_last7) AS audience_video_last7,\n      SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n      SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n      SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n      SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n      SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n      SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n      SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n      SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n      SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n      SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n      SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n      SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n      SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n      SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n      SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n      SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n      SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n      SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n      SUM(audience_2k_last7) AS audience_2k_last7,\n      SUM(audience_4k_last7) AS audience_4k_last7,\n      SUM(audience_1080p_last7) AS audience_1080p_last7,\n      SUM(host_1080p_last7) AS host_1080p_last7,\n      SUM(host_2k_last7) AS host_2k_last7,\n      SUM(host_4k_last7) AS host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211001 AND date <= 20211128 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n    GROUP BY date,\n      DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n      2,\n      3,\n      tag,\n      area,\n      dim,\n      8,\n      9,\n      10,\n      level4,\n      product_level1,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en,\n      vid_use_case_en,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n          start_date AS start_date,\n          end_date AS end_date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          tag,\n          area AS Scope,\n          dim,\n            CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n            CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n            CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          browser,\n          browser_ver,\n          dim_grouping_name,\n          SUM(total) AS totalUsage,\n          SUM(audio) AS audio,\n          SUM(video) AS video,\n          SUM(host_sd + audience_sd) AS video_sd,\n          SUM(host_hd + audience_hd) AS video_hd,\n          SUM(host_hdp + audience_hdp) AS video_hdp,\n          SUM(host_audio) AS host_audio,\n          SUM(audience_audio) AS audience_audio,\n          SUM(host_sd) AS host_sd,\n          SUM(host_hd) AS host_hd,\n          SUM(host_hdp) AS host_hdp,\n          SUM(host_1080p) AS host_1080p,\n          SUM(host_2k) AS host_2k,\n          SUM(host_4k) AS host_4k,\n          SUM(audience_sd) AS audience_sd,\n          SUM(audience_hd) AS audience_hd,\n          SUM(audience_hdp) AS audience_hdp,\n          SUM(audience_1080p) AS audience_1080p,\n          SUM(audience_2k) AS audience_2k,\n          SUM(audience_4k) AS audience_4k,\n          SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n          SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n          SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n          SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n          SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n          SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n          SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n          SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n          SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n          SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n          SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n          SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n          SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n          SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n          SUM(total_last1) AS audio_video_last,\n          SUM(audio_last1) AS audio_last,\n          SUM(video_last1) AS video_last,\n          SUM(video_sd_last1) AS video_sd_last,\n          SUM(video_hd_last1) AS video_hd_last,\n          SUM(video_hdp_last1) AS video_hdp_last,\n          SUM(host_sd_last1) AS host_video_sd_last,\n          SUM(audience_sd_last1) AS audience_video_sd_last,\n          SUM(host_hd_last1) AS host_video_hd_last,\n          SUM(audience_hd_last1) AS audience_video_hd_last,\n          SUM(host_hdp_last1) AS host_video_hdp_last,\n          SUM(audience_hdp_last1) AS audience_video_hdp_last,\n          SUM(host_audio_last1) AS host_audio_last,\n          SUM(audience_audio_last1) AS audience_audio_last,\n          SUM(host_video_last1) AS host_video_last,\n          SUM(audience_video_last1) AS audience_video_last,\n          SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n          SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n          SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n          SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n          SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n          SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n          SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n          SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n          SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n          SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n          SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n          SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n          SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n          SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n          SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n          SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n          SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n          SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n          SUM(audience_2k_last1) AS audience_2k_last1,\n          SUM(audience_4k_last1) AS audience_4k_last1,\n          SUM(audience_1080p_last1) AS audience_1080p_last1,\n          SUM(host_1080p_last1) AS host_1080p_last1,\n          SUM(host_2k_last1) AS host_2k_last1,\n          SUM(host_4k_last1) AS host_4k_last1,\n          SUM(total_last7) AS total_last7,\n          SUM(audio_last7) AS audio_last7,\n          SUM(video_last7) AS video_last7,\n          SUM(video_sd_last7) AS video_sd_last7,\n          SUM(video_hd_last7) AS video_hd_last7,\n          SUM(video_hdp_last7) AS video_hdp_last7,\n          SUM(host_sd_last7) AS host_sd_last7,\n          SUM(audience_sd_last7) AS audience_sd_last7,\n          SUM(host_hd_last7) AS host_hd_last7,\n          SUM(audience_hd_last7) AS audience_hd_last7,\n          SUM(host_hdp_last7) AS host_hdp_last7,\n          SUM(audience_hdp_last7) AS audience_hdp_last7,\n          SUM(host_audio_last7) AS host_audio_last7,\n          SUM(audience_audio_last7) AS audience_audio_last7,\n          SUM(host_video_last7) AS host_video_last7,\n          SUM(audience_video_last7) AS audience_video_last7,\n          SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n          SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n          SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n          SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n          SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n          SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n          SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n          SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n          SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n          SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n          SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n          SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n          SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n          SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n          SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n          SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n          SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n          SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n          SUM(audience_2k_last7) AS audience_2k_last7,\n          SUM(audience_4k_last7) AS audience_4k_last7,\n          SUM(audience_1080p_last7) AS audience_1080p_last7,\n          SUM(host_1080p_last7) AS host_1080p_last7,\n          SUM(host_2k_last7) AS host_2k_last7,\n          SUM(host_4k_last7) AS host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211001 AND date <= 20211128 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n        GROUP BY date,\n          DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n          2,\n          3,\n          tag,\n          area,\n          dim,\n          8,\n          9,\n          10,\n          level4,\n          product_level1,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en,\n          vid_use_case_en,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          browser,\n          browser_ver,\n          dim_grouping_name) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 3 AND CAST(\"自定义 SQL 查询\".\"level1\" AS VARCHAR) = 'RTSA' AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 1"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"usr_Calculation_3519281700079370244_ok\",\n  \"自定义 SQL 查询\".\"vid_use_case_cn\" AS \"vid_use_case_cn\"\nFROM (SELECT date,\n      start_date AS start_date,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name,\n      SUM(total) AS totalUsage,\n      SUM(audio) AS audio,\n      SUM(video) AS video,\n      SUM(host_sd + audience_sd) AS video_sd,\n      SUM(host_hd + audience_hd) AS video_hd,\n      SUM(host_hdp + audience_hdp) AS video_hdp,\n      SUM(host_audio) AS host_audio,\n      SUM(audience_audio) AS audience_audio,\n      SUM(host_sd) AS host_sd,\n      SUM(host_hd) AS host_hd,\n      SUM(host_hdp) AS host_hdp,\n      SUM(host_1080p) AS host_1080p,\n      SUM(host_2k) AS host_2k,\n      SUM(host_4k) AS host_4k,\n      SUM(audience_sd) AS audience_sd,\n      SUM(audience_hd) AS audience_hd,\n      SUM(audience_hdp) AS audience_hdp,\n      SUM(audience_1080p) AS audience_1080p,\n      SUM(audience_2k) AS audience_2k,\n      SUM(audience_4k) AS audience_4k,\n      SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n      SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n      SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n      SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n      SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n      SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n      SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n      SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n      SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n      SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n      SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n      SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n      SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n      SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n      SUM(total_last1) AS audio_video_last,\n      SUM(audio_last1) AS audio_last,\n      SUM(video_last1) AS video_last,\n      SUM(video_sd_last1) AS video_sd_last,\n      SUM(video_hd_last1) AS video_hd_last,\n      SUM(video_hdp_last1) AS video_hdp_last,\n      SUM(host_sd_last1) AS host_video_sd_last,\n      SUM(audience_sd_last1) AS audience_video_sd_last,\n      SUM(host_hd_last1) AS host_video_hd_last,\n      SUM(audience_hd_last1) AS audience_video_hd_last,\n      SUM(host_hdp_last1) AS host_video_hdp_last,\n      SUM(audience_hdp_last1) AS audience_video_hdp_last,\n      SUM(host_audio_last1) AS host_audio_last,\n      SUM(audience_audio_last1) AS audience_audio_last,\n      SUM(host_video_last1) AS host_video_last,\n      SUM(audience_video_last1) AS audience_video_last,\n      SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n      SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n      SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n      SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n      SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n      SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n      SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n      SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n      SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n      SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n      SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n      SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n      SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n      SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n      SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n      SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n      SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n      SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n      SUM(audience_2k_last1) AS audience_2k_last1,\n      SUM(audience_4k_last1) AS audience_4k_last1,\n      SUM(audience_1080p_last1) AS audience_1080p_last1,\n      SUM(host_1080p_last1) AS host_1080p_last1,\n      SUM(host_2k_last1) AS host_2k_last1,\n      SUM(host_4k_last1) AS host_4k_last1,\n      SUM(total_last7) AS total_last7,\n      SUM(audio_last7) AS audio_last7,\n      SUM(video_last7) AS video_last7,\n      SUM(video_sd_last7) AS video_sd_last7,\n      SUM(video_hd_last7) AS video_hd_last7,\n      SUM(video_hdp_last7) AS video_hdp_last7,\n      SUM(host_sd_last7) AS host_sd_last7,\n      SUM(audience_sd_last7) AS audience_sd_last7,\n      SUM(host_hd_last7) AS host_hd_last7,\n      SUM(audience_hd_last7) AS audience_hd_last7,\n      SUM(host_hdp_last7) AS host_hdp_last7,\n      SUM(audience_hdp_last7) AS audience_hdp_last7,\n      SUM(host_audio_last7) AS host_audio_last7,\n      SUM(audience_audio_last7) AS audience_audio_last7,\n      SUM(host_video_last7) AS host_video_last7,\n      SUM(audience_video_last7) AS audience_video_last7,\n      SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n      SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n      SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n      SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n      SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n      SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n      SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n      SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n      SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n      SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n      SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n      SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n      SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n      SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n      SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n      SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n      SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n      SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n      SUM(audience_2k_last7) AS audience_2k_last7,\n      SUM(audience_4k_last7) AS audience_4k_last7,\n      SUM(audience_1080p_last7) AS audience_1080p_last7,\n      SUM(host_1080p_last7) AS host_1080p_last7,\n      SUM(host_2k_last7) AS host_2k_last7,\n      SUM(host_4k_last7) AS host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211001 AND date <= 20211128 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n    GROUP BY date,\n      DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n      2,\n      3,\n      tag,\n      area,\n      dim,\n      8,\n      9,\n      10,\n      level4,\n      product_level1,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en,\n      vid_use_case_en,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n          start_date AS start_date,\n          end_date AS end_date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          tag,\n          area AS Scope,\n          dim,\n            CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n            CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n            CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          browser,\n          browser_ver,\n          dim_grouping_name,\n          SUM(total) AS totalUsage,\n          SUM(audio) AS audio,\n          SUM(video) AS video,\n          SUM(host_sd + audience_sd) AS video_sd,\n          SUM(host_hd + audience_hd) AS video_hd,\n          SUM(host_hdp + audience_hdp) AS video_hdp,\n          SUM(host_audio) AS host_audio,\n          SUM(audience_audio) AS audience_audio,\n          SUM(host_sd) AS host_sd,\n          SUM(host_hd) AS host_hd,\n          SUM(host_hdp) AS host_hdp,\n          SUM(host_1080p) AS host_1080p,\n          SUM(host_2k) AS host_2k,\n          SUM(host_4k) AS host_4k,\n          SUM(audience_sd) AS audience_sd,\n          SUM(audience_hd) AS audience_hd,\n          SUM(audience_hdp) AS audience_hdp,\n          SUM(audience_1080p) AS audience_1080p,\n          SUM(audience_2k) AS audience_2k,\n          SUM(audience_4k) AS audience_4k,\n          SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n          SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n          SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n          SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n          SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n          SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n          SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n          SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n          SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n          SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n          SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n          SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n          SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n          SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n          SUM(total_last1) AS audio_video_last,\n          SUM(audio_last1) AS audio_last,\n          SUM(video_last1) AS video_last,\n          SUM(video_sd_last1) AS video_sd_last,\n          SUM(video_hd_last1) AS video_hd_last,\n          SUM(video_hdp_last1) AS video_hdp_last,\n          SUM(host_sd_last1) AS host_video_sd_last,\n          SUM(audience_sd_last1) AS audience_video_sd_last,\n          SUM(host_hd_last1) AS host_video_hd_last,\n          SUM(audience_hd_last1) AS audience_video_hd_last,\n          SUM(host_hdp_last1) AS host_video_hdp_last,\n          SUM(audience_hdp_last1) AS audience_video_hdp_last,\n          SUM(host_audio_last1) AS host_audio_last,\n          SUM(audience_audio_last1) AS audience_audio_last,\n          SUM(host_video_last1) AS host_video_last,\n          SUM(audience_video_last1) AS audience_video_last,\n          SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n          SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n          SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n          SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n          SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n          SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n          SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n          SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n          SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n          SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n          SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n          SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n          SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n          SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n          SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n          SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n          SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n          SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n          SUM(audience_2k_last1) AS audience_2k_last1,\n          SUM(audience_4k_last1) AS audience_4k_last1,\n          SUM(audience_1080p_last1) AS audience_1080p_last1,\n          SUM(host_1080p_last1) AS host_1080p_last1,\n          SUM(host_2k_last1) AS host_2k_last1,\n          SUM(host_4k_last1) AS host_4k_last1,\n          SUM(total_last7) AS total_last7,\n          SUM(audio_last7) AS audio_last7,\n          SUM(video_last7) AS video_last7,\n          SUM(video_sd_last7) AS video_sd_last7,\n          SUM(video_hd_last7) AS video_hd_last7,\n          SUM(video_hdp_last7) AS video_hdp_last7,\n          SUM(host_sd_last7) AS host_sd_last7,\n          SUM(audience_sd_last7) AS audience_sd_last7,\n          SUM(host_hd_last7) AS host_hd_last7,\n          SUM(audience_hd_last7) AS audience_hd_last7,\n          SUM(host_hdp_last7) AS host_hdp_last7,\n          SUM(audience_hdp_last7) AS audience_hdp_last7,\n          SUM(host_audio_last7) AS host_audio_last7,\n          SUM(audience_audio_last7) AS audience_audio_last7,\n          SUM(host_video_last7) AS host_video_last7,\n          SUM(audience_video_last7) AS audience_video_last7,\n          SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n          SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n          SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n          SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n          SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n          SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n          SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n          SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n          SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n          SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n          SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n          SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n          SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n          SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n          SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n          SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n          SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n          SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n          SUM(audience_2k_last7) AS audience_2k_last7,\n          SUM(audience_4k_last7) AS audience_4k_last7,\n          SUM(audience_1080p_last7) AS audience_1080p_last7,\n          SUM(host_1080p_last7) AS host_1080p_last7,\n          SUM(host_2k_last7) AS host_2k_last7,\n          SUM(host_4k_last7) AS host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211001 AND date <= 20211128 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n        GROUP BY date,\n          DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n          2,\n          3,\n          tag,\n          area,\n          dim,\n          8,\n          9,\n          10,\n          level4,\n          product_level1,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en,\n          vid_use_case_en,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          browser,\n          browser_ver,\n          dim_grouping_name) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 3 AND CAST(\"自定义 SQL 查询\".\"level1\" AS VARCHAR) = 'RTSA' AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 2"
	},
	{
		"presto_sql" : "SELECT \"自定义 SQL 查询\".\"cid_industry\" AS \"cid_industry\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"usr_Calculation_3519281700079370244_ok\"\nFROM (SELECT date,\n      start_date AS start_date,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name,\n      SUM(total) AS totalUsage,\n      SUM(audio) AS audio,\n      SUM(video) AS video,\n      SUM(host_sd + audience_sd) AS video_sd,\n      SUM(host_hd + audience_hd) AS video_hd,\n      SUM(host_hdp + audience_hdp) AS video_hdp,\n      SUM(host_audio) AS host_audio,\n      SUM(audience_audio) AS audience_audio,\n      SUM(host_sd) AS host_sd,\n      SUM(host_hd) AS host_hd,\n      SUM(host_hdp) AS host_hdp,\n      SUM(host_1080p) AS host_1080p,\n      SUM(host_2k) AS host_2k,\n      SUM(host_4k) AS host_4k,\n      SUM(audience_sd) AS audience_sd,\n      SUM(audience_hd) AS audience_hd,\n      SUM(audience_hdp) AS audience_hdp,\n      SUM(audience_1080p) AS audience_1080p,\n      SUM(audience_2k) AS audience_2k,\n      SUM(audience_4k) AS audience_4k,\n      SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n      SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n      SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n      SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n      SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n      SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n      SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n      SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n      SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n      SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n      SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n      SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n      SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n      SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n      SUM(total_last1) AS audio_video_last,\n      SUM(audio_last1) AS audio_last,\n      SUM(video_last1) AS video_last,\n      SUM(video_sd_last1) AS video_sd_last,\n      SUM(video_hd_last1) AS video_hd_last,\n      SUM(video_hdp_last1) AS video_hdp_last,\n      SUM(host_sd_last1) AS host_video_sd_last,\n      SUM(audience_sd_last1) AS audience_video_sd_last,\n      SUM(host_hd_last1) AS host_video_hd_last,\n      SUM(audience_hd_last1) AS audience_video_hd_last,\n      SUM(host_hdp_last1) AS host_video_hdp_last,\n      SUM(audience_hdp_last1) AS audience_video_hdp_last,\n      SUM(host_audio_last1) AS host_audio_last,\n      SUM(audience_audio_last1) AS audience_audio_last,\n      SUM(host_video_last1) AS host_video_last,\n      SUM(audience_video_last1) AS audience_video_last,\n      SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n      SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n      SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n      SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n      SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n      SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n      SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n      SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n      SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n      SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n      SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n      SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n      SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n      SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n      SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n      SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n      SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n      SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n      SUM(audience_2k_last1) AS audience_2k_last1,\n      SUM(audience_4k_last1) AS audience_4k_last1,\n      SUM(audience_1080p_last1) AS audience_1080p_last1,\n      SUM(host_1080p_last1) AS host_1080p_last1,\n      SUM(host_2k_last1) AS host_2k_last1,\n      SUM(host_4k_last1) AS host_4k_last1,\n      SUM(total_last7) AS total_last7,\n      SUM(audio_last7) AS audio_last7,\n      SUM(video_last7) AS video_last7,\n      SUM(video_sd_last7) AS video_sd_last7,\n      SUM(video_hd_last7) AS video_hd_last7,\n      SUM(video_hdp_last7) AS video_hdp_last7,\n      SUM(host_sd_last7) AS host_sd_last7,\n      SUM(audience_sd_last7) AS audience_sd_last7,\n      SUM(host_hd_last7) AS host_hd_last7,\n      SUM(audience_hd_last7) AS audience_hd_last7,\n      SUM(host_hdp_last7) AS host_hdp_last7,\n      SUM(audience_hdp_last7) AS audience_hdp_last7,\n      SUM(host_audio_last7) AS host_audio_last7,\n      SUM(audience_audio_last7) AS audience_audio_last7,\n      SUM(host_video_last7) AS host_video_last7,\n      SUM(audience_video_last7) AS audience_video_last7,\n      SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n      SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n      SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n      SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n      SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n      SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n      SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n      SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n      SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n      SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n      SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n      SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n      SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n      SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n      SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n      SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n      SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n      SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n      SUM(audience_2k_last7) AS audience_2k_last7,\n      SUM(audience_4k_last7) AS audience_4k_last7,\n      SUM(audience_1080p_last7) AS audience_1080p_last7,\n      SUM(host_1080p_last7) AS host_1080p_last7,\n      SUM(host_2k_last7) AS host_2k_last7,\n      SUM(host_4k_last7) AS host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211001 AND date <= 20211128 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n    GROUP BY date,\n      DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n      2,\n      3,\n      tag,\n      area,\n      dim,\n      8,\n      9,\n      10,\n      level4,\n      product_level1,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en,\n      vid_use_case_en,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n          start_date AS start_date,\n          end_date AS end_date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          tag,\n          area AS Scope,\n          dim,\n            CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n            CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n            CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          browser,\n          browser_ver,\n          dim_grouping_name,\n          SUM(total) AS totalUsage,\n          SUM(audio) AS audio,\n          SUM(video) AS video,\n          SUM(host_sd + audience_sd) AS video_sd,\n          SUM(host_hd + audience_hd) AS video_hd,\n          SUM(host_hdp + audience_hdp) AS video_hdp,\n          SUM(host_audio) AS host_audio,\n          SUM(audience_audio) AS audience_audio,\n          SUM(host_sd) AS host_sd,\n          SUM(host_hd) AS host_hd,\n          SUM(host_hdp) AS host_hdp,\n          SUM(host_1080p) AS host_1080p,\n          SUM(host_2k) AS host_2k,\n          SUM(host_4k) AS host_4k,\n          SUM(audience_sd) AS audience_sd,\n          SUM(audience_hd) AS audience_hd,\n          SUM(audience_hdp) AS audience_hdp,\n          SUM(audience_1080p) AS audience_1080p,\n          SUM(audience_2k) AS audience_2k,\n          SUM(audience_4k) AS audience_4k,\n          SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n          SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n          SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n          SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n          SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n          SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n          SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n          SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n          SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n          SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n          SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n          SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n          SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n          SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n          SUM(total_last1) AS audio_video_last,\n          SUM(audio_last1) AS audio_last,\n          SUM(video_last1) AS video_last,\n          SUM(video_sd_last1) AS video_sd_last,\n          SUM(video_hd_last1) AS video_hd_last,\n          SUM(video_hdp_last1) AS video_hdp_last,\n          SUM(host_sd_last1) AS host_video_sd_last,\n          SUM(audience_sd_last1) AS audience_video_sd_last,\n          SUM(host_hd_last1) AS host_video_hd_last,\n          SUM(audience_hd_last1) AS audience_video_hd_last,\n          SUM(host_hdp_last1) AS host_video_hdp_last,\n          SUM(audience_hdp_last1) AS audience_video_hdp_last,\n          SUM(host_audio_last1) AS host_audio_last,\n          SUM(audience_audio_last1) AS audience_audio_last,\n          SUM(host_video_last1) AS host_video_last,\n          SUM(audience_video_last1) AS audience_video_last,\n          SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n          SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n          SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n          SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n          SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n          SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n          SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n          SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n          SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n          SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n          SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n          SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n          SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n          SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n          SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n          SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n          SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n          SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n          SUM(audience_2k_last1) AS audience_2k_last1,\n          SUM(audience_4k_last1) AS audience_4k_last1,\n          SUM(audience_1080p_last1) AS audience_1080p_last1,\n          SUM(host_1080p_last1) AS host_1080p_last1,\n          SUM(host_2k_last1) AS host_2k_last1,\n          SUM(host_4k_last1) AS host_4k_last1,\n          SUM(total_last7) AS total_last7,\n          SUM(audio_last7) AS audio_last7,\n          SUM(video_last7) AS video_last7,\n          SUM(video_sd_last7) AS video_sd_last7,\n          SUM(video_hd_last7) AS video_hd_last7,\n          SUM(video_hdp_last7) AS video_hdp_last7,\n          SUM(host_sd_last7) AS host_sd_last7,\n          SUM(audience_sd_last7) AS audience_sd_last7,\n          SUM(host_hd_last7) AS host_hd_last7,\n          SUM(audience_hd_last7) AS audience_hd_last7,\n          SUM(host_hdp_last7) AS host_hdp_last7,\n          SUM(audience_hdp_last7) AS audience_hdp_last7,\n          SUM(host_audio_last7) AS host_audio_last7,\n          SUM(audience_audio_last7) AS audience_audio_last7,\n          SUM(host_video_last7) AS host_video_last7,\n          SUM(audience_video_last7) AS audience_video_last7,\n          SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n          SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n          SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n          SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n          SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n          SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n          SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n          SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n          SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n          SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n          SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n          SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n          SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n          SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n          SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n          SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n          SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n          SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n          SUM(audience_2k_last7) AS audience_2k_last7,\n          SUM(audience_4k_last7) AS audience_4k_last7,\n          SUM(audience_1080p_last7) AS audience_1080p_last7,\n          SUM(host_1080p_last7) AS host_1080p_last7,\n          SUM(host_2k_last7) AS host_2k_last7,\n          SUM(host_4k_last7) AS host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211001 AND date <= 20211128 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n        GROUP BY date,\n          DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n          2,\n          3,\n          tag,\n          area,\n          dim,\n          8,\n          9,\n          10,\n          level4,\n          product_level1,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en,\n          vid_use_case_en,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          browser,\n          browser_ver,\n          dim_grouping_name) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 3 AND CAST(\"自定义 SQL 查询\".\"level1\" AS VARCHAR) = 'RTSA' AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 1"
	},
	{
		"presto_sql" : "SELECT \"自定义 SQL 查询\".\"product_level3\" AS \"product_level3\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"usr_Calculation_3519281700079370244_ok\"\nFROM (SELECT date,\n      start_date AS start_date,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name,\n      SUM(total) AS totalUsage,\n      SUM(audio) AS audio,\n      SUM(video) AS video,\n      SUM(host_sd + audience_sd) AS video_sd,\n      SUM(host_hd + audience_hd) AS video_hd,\n      SUM(host_hdp + audience_hdp) AS video_hdp,\n      SUM(host_audio) AS host_audio,\n      SUM(audience_audio) AS audience_audio,\n      SUM(host_sd) AS host_sd,\n      SUM(host_hd) AS host_hd,\n      SUM(host_hdp) AS host_hdp,\n      SUM(host_1080p) AS host_1080p,\n      SUM(host_2k) AS host_2k,\n      SUM(host_4k) AS host_4k,\n      SUM(audience_sd) AS audience_sd,\n      SUM(audience_hd) AS audience_hd,\n      SUM(audience_hdp) AS audience_hdp,\n      SUM(audience_1080p) AS audience_1080p,\n      SUM(audience_2k) AS audience_2k,\n      SUM(audience_4k) AS audience_4k,\n      SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n      SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n      SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n      SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n      SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n      SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n      SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n      SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n      SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n      SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n      SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n      SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n      SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n      SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n      SUM(total_last1) AS audio_video_last,\n      SUM(audio_last1) AS audio_last,\n      SUM(video_last1) AS video_last,\n      SUM(video_sd_last1) AS video_sd_last,\n      SUM(video_hd_last1) AS video_hd_last,\n      SUM(video_hdp_last1) AS video_hdp_last,\n      SUM(host_sd_last1) AS host_video_sd_last,\n      SUM(audience_sd_last1) AS audience_video_sd_last,\n      SUM(host_hd_last1) AS host_video_hd_last,\n      SUM(audience_hd_last1) AS audience_video_hd_last,\n      SUM(host_hdp_last1) AS host_video_hdp_last,\n      SUM(audience_hdp_last1) AS audience_video_hdp_last,\n      SUM(host_audio_last1) AS host_audio_last,\n      SUM(audience_audio_last1) AS audience_audio_last,\n      SUM(host_video_last1) AS host_video_last,\n      SUM(audience_video_last1) AS audience_video_last,\n      SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n      SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n      SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n      SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n      SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n      SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n      SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n      SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n      SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n      SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n      SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n      SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n      SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n      SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n      SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n      SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n      SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n      SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n      SUM(audience_2k_last1) AS audience_2k_last1,\n      SUM(audience_4k_last1) AS audience_4k_last1,\n      SUM(audience_1080p_last1) AS audience_1080p_last1,\n      SUM(host_1080p_last1) AS host_1080p_last1,\n      SUM(host_2k_last1) AS host_2k_last1,\n      SUM(host_4k_last1) AS host_4k_last1,\n      SUM(total_last7) AS total_last7,\n      SUM(audio_last7) AS audio_last7,\n      SUM(video_last7) AS video_last7,\n      SUM(video_sd_last7) AS video_sd_last7,\n      SUM(video_hd_last7) AS video_hd_last7,\n      SUM(video_hdp_last7) AS video_hdp_last7,\n      SUM(host_sd_last7) AS host_sd_last7,\n      SUM(audience_sd_last7) AS audience_sd_last7,\n      SUM(host_hd_last7) AS host_hd_last7,\n      SUM(audience_hd_last7) AS audience_hd_last7,\n      SUM(host_hdp_last7) AS host_hdp_last7,\n      SUM(audience_hdp_last7) AS audience_hdp_last7,\n      SUM(host_audio_last7) AS host_audio_last7,\n      SUM(audience_audio_last7) AS audience_audio_last7,\n      SUM(host_video_last7) AS host_video_last7,\n      SUM(audience_video_last7) AS audience_video_last7,\n      SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n      SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n      SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n      SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n      SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n      SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n      SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n      SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n      SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n      SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n      SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n      SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n      SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n      SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n      SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n      SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n      SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n      SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n      SUM(audience_2k_last7) AS audience_2k_last7,\n      SUM(audience_4k_last7) AS audience_4k_last7,\n      SUM(audience_1080p_last7) AS audience_1080p_last7,\n      SUM(host_1080p_last7) AS host_1080p_last7,\n      SUM(host_2k_last7) AS host_2k_last7,\n      SUM(host_4k_last7) AS host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211001 AND date <= 20211128 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n    GROUP BY date,\n      DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n      2,\n      3,\n      tag,\n      area,\n      dim,\n      8,\n      9,\n      10,\n      level4,\n      product_level1,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en,\n      vid_use_case_en,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n          start_date AS start_date,\n          end_date AS end_date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          tag,\n          area AS Scope,\n          dim,\n            CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n            CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n            CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          browser,\n          browser_ver,\n          dim_grouping_name,\n          SUM(total) AS totalUsage,\n          SUM(audio) AS audio,\n          SUM(video) AS video,\n          SUM(host_sd + audience_sd) AS video_sd,\n          SUM(host_hd + audience_hd) AS video_hd,\n          SUM(host_hdp + audience_hdp) AS video_hdp,\n          SUM(host_audio) AS host_audio,\n          SUM(audience_audio) AS audience_audio,\n          SUM(host_sd) AS host_sd,\n          SUM(host_hd) AS host_hd,\n          SUM(host_hdp) AS host_hdp,\n          SUM(host_1080p) AS host_1080p,\n          SUM(host_2k) AS host_2k,\n          SUM(host_4k) AS host_4k,\n          SUM(audience_sd) AS audience_sd,\n          SUM(audience_hd) AS audience_hd,\n          SUM(audience_hdp) AS audience_hdp,\n          SUM(audience_1080p) AS audience_1080p,\n          SUM(audience_2k) AS audience_2k,\n          SUM(audience_4k) AS audience_4k,\n          SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n          SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n          SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n          SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n          SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n          SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n          SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n          SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n          SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n          SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n          SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n          SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n          SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n          SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n          SUM(total_last1) AS audio_video_last,\n          SUM(audio_last1) AS audio_last,\n          SUM(video_last1) AS video_last,\n          SUM(video_sd_last1) AS video_sd_last,\n          SUM(video_hd_last1) AS video_hd_last,\n          SUM(video_hdp_last1) AS video_hdp_last,\n          SUM(host_sd_last1) AS host_video_sd_last,\n          SUM(audience_sd_last1) AS audience_video_sd_last,\n          SUM(host_hd_last1) AS host_video_hd_last,\n          SUM(audience_hd_last1) AS audience_video_hd_last,\n          SUM(host_hdp_last1) AS host_video_hdp_last,\n          SUM(audience_hdp_last1) AS audience_video_hdp_last,\n          SUM(host_audio_last1) AS host_audio_last,\n          SUM(audience_audio_last1) AS audience_audio_last,\n          SUM(host_video_last1) AS host_video_last,\n          SUM(audience_video_last1) AS audience_video_last,\n          SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n          SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n          SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n          SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n          SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n          SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n          SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n          SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n          SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n          SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n          SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n          SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n          SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n          SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n          SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n          SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n          SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n          SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n          SUM(audience_2k_last1) AS audience_2k_last1,\n          SUM(audience_4k_last1) AS audience_4k_last1,\n          SUM(audience_1080p_last1) AS audience_1080p_last1,\n          SUM(host_1080p_last1) AS host_1080p_last1,\n          SUM(host_2k_last1) AS host_2k_last1,\n          SUM(host_4k_last1) AS host_4k_last1,\n          SUM(total_last7) AS total_last7,\n          SUM(audio_last7) AS audio_last7,\n          SUM(video_last7) AS video_last7,\n          SUM(video_sd_last7) AS video_sd_last7,\n          SUM(video_hd_last7) AS video_hd_last7,\n          SUM(video_hdp_last7) AS video_hdp_last7,\n          SUM(host_sd_last7) AS host_sd_last7,\n          SUM(audience_sd_last7) AS audience_sd_last7,\n          SUM(host_hd_last7) AS host_hd_last7,\n          SUM(audience_hd_last7) AS audience_hd_last7,\n          SUM(host_hdp_last7) AS host_hdp_last7,\n          SUM(audience_hdp_last7) AS audience_hdp_last7,\n          SUM(host_audio_last7) AS host_audio_last7,\n          SUM(audience_audio_last7) AS audience_audio_last7,\n          SUM(host_video_last7) AS host_video_last7,\n          SUM(audience_video_last7) AS audience_video_last7,\n          SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n          SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n          SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n          SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n          SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n          SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n          SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n          SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n          SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n          SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n          SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n          SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n          SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n          SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n          SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n          SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n          SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n          SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n          SUM(audience_2k_last7) AS audience_2k_last7,\n          SUM(audience_4k_last7) AS audience_4k_last7,\n          SUM(audience_1080p_last7) AS audience_1080p_last7,\n          SUM(host_1080p_last7) AS host_1080p_last7,\n          SUM(host_2k_last7) AS host_2k_last7,\n          SUM(host_4k_last7) AS host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211001 AND date <= 20211128 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n        GROUP BY date,\n          DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n          2,\n          3,\n          tag,\n          area,\n          dim,\n          8,\n          9,\n          10,\n          level4,\n          product_level1,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en,\n          vid_use_case_en,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          browser,\n          browser_ver,\n          dim_grouping_name) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 3 AND CAST(\"自定义 SQL 查询\".\"level1\" AS VARCHAR) = 'RTSA' AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 1"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"usr_Calculation_3519281700079370244_ok\",\n  \"自定义 SQL 查询\".\"vid_sector_en\" AS \"vid_sector_en\"\nFROM (SELECT date,\n      start_date AS start_date,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name,\n      SUM(total) AS totalUsage,\n      SUM(audio) AS audio,\n      SUM(video) AS video,\n      SUM(host_sd + audience_sd) AS video_sd,\n      SUM(host_hd + audience_hd) AS video_hd,\n      SUM(host_hdp + audience_hdp) AS video_hdp,\n      SUM(host_audio) AS host_audio,\n      SUM(audience_audio) AS audience_audio,\n      SUM(host_sd) AS host_sd,\n      SUM(host_hd) AS host_hd,\n      SUM(host_hdp) AS host_hdp,\n      SUM(host_1080p) AS host_1080p,\n      SUM(host_2k) AS host_2k,\n      SUM(host_4k) AS host_4k,\n      SUM(audience_sd) AS audience_sd,\n      SUM(audience_hd) AS audience_hd,\n      SUM(audience_hdp) AS audience_hdp,\n      SUM(audience_1080p) AS audience_1080p,\n      SUM(audience_2k) AS audience_2k,\n      SUM(audience_4k) AS audience_4k,\n      SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n      SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n      SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n      SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n      SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n      SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n      SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n      SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n      SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n      SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n      SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n      SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n      SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n      SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n      SUM(total_last1) AS audio_video_last,\n      SUM(audio_last1) AS audio_last,\n      SUM(video_last1) AS video_last,\n      SUM(video_sd_last1) AS video_sd_last,\n      SUM(video_hd_last1) AS video_hd_last,\n      SUM(video_hdp_last1) AS video_hdp_last,\n      SUM(host_sd_last1) AS host_video_sd_last,\n      SUM(audience_sd_last1) AS audience_video_sd_last,\n      SUM(host_hd_last1) AS host_video_hd_last,\n      SUM(audience_hd_last1) AS audience_video_hd_last,\n      SUM(host_hdp_last1) AS host_video_hdp_last,\n      SUM(audience_hdp_last1) AS audience_video_hdp_last,\n      SUM(host_audio_last1) AS host_audio_last,\n      SUM(audience_audio_last1) AS audience_audio_last,\n      SUM(host_video_last1) AS host_video_last,\n      SUM(audience_video_last1) AS audience_video_last,\n      SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n      SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n      SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n      SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n      SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n      SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n      SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n      SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n      SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n      SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n      SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n      SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n      SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n      SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n      SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n      SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n      SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n      SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n      SUM(audience_2k_last1) AS audience_2k_last1,\n      SUM(audience_4k_last1) AS audience_4k_last1,\n      SUM(audience_1080p_last1) AS audience_1080p_last1,\n      SUM(host_1080p_last1) AS host_1080p_last1,\n      SUM(host_2k_last1) AS host_2k_last1,\n      SUM(host_4k_last1) AS host_4k_last1,\n      SUM(total_last7) AS total_last7,\n      SUM(audio_last7) AS audio_last7,\n      SUM(video_last7) AS video_last7,\n      SUM(video_sd_last7) AS video_sd_last7,\n      SUM(video_hd_last7) AS video_hd_last7,\n      SUM(video_hdp_last7) AS video_hdp_last7,\n      SUM(host_sd_last7) AS host_sd_last7,\n      SUM(audience_sd_last7) AS audience_sd_last7,\n      SUM(host_hd_last7) AS host_hd_last7,\n      SUM(audience_hd_last7) AS audience_hd_last7,\n      SUM(host_hdp_last7) AS host_hdp_last7,\n      SUM(audience_hdp_last7) AS audience_hdp_last7,\n      SUM(host_audio_last7) AS host_audio_last7,\n      SUM(audience_audio_last7) AS audience_audio_last7,\n      SUM(host_video_last7) AS host_video_last7,\n      SUM(audience_video_last7) AS audience_video_last7,\n      SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n      SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n      SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n      SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n      SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n      SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n      SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n      SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n      SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n      SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n      SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n      SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n      SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n      SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n      SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n      SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n      SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n      SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n      SUM(audience_2k_last7) AS audience_2k_last7,\n      SUM(audience_4k_last7) AS audience_4k_last7,\n      SUM(audience_1080p_last7) AS audience_1080p_last7,\n      SUM(host_1080p_last7) AS host_1080p_last7,\n      SUM(host_2k_last7) AS host_2k_last7,\n      SUM(host_4k_last7) AS host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211001 AND date <= 20211128 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n    GROUP BY date,\n      DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n      2,\n      3,\n      tag,\n      area,\n      dim,\n      8,\n      9,\n      10,\n      level4,\n      product_level1,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en,\n      vid_use_case_en,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n          start_date AS start_date,\n          end_date AS end_date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          tag,\n          area AS Scope,\n          dim,\n            CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n            CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n            CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          browser,\n          browser_ver,\n          dim_grouping_name,\n          SUM(total) AS totalUsage,\n          SUM(audio) AS audio,\n          SUM(video) AS video,\n          SUM(host_sd + audience_sd) AS video_sd,\n          SUM(host_hd + audience_hd) AS video_hd,\n          SUM(host_hdp + audience_hdp) AS video_hdp,\n          SUM(host_audio) AS host_audio,\n          SUM(audience_audio) AS audience_audio,\n          SUM(host_sd) AS host_sd,\n          SUM(host_hd) AS host_hd,\n          SUM(host_hdp) AS host_hdp,\n          SUM(host_1080p) AS host_1080p,\n          SUM(host_2k) AS host_2k,\n          SUM(host_4k) AS host_4k,\n          SUM(audience_sd) AS audience_sd,\n          SUM(audience_hd) AS audience_hd,\n          SUM(audience_hdp) AS audience_hdp,\n          SUM(audience_1080p) AS audience_1080p,\n          SUM(audience_2k) AS audience_2k,\n          SUM(audience_4k) AS audience_4k,\n          SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n          SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n          SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n          SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n          SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n          SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n          SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n          SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n          SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n          SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n          SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n          SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n          SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n          SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n          SUM(total_last1) AS audio_video_last,\n          SUM(audio_last1) AS audio_last,\n          SUM(video_last1) AS video_last,\n          SUM(video_sd_last1) AS video_sd_last,\n          SUM(video_hd_last1) AS video_hd_last,\n          SUM(video_hdp_last1) AS video_hdp_last,\n          SUM(host_sd_last1) AS host_video_sd_last,\n          SUM(audience_sd_last1) AS audience_video_sd_last,\n          SUM(host_hd_last1) AS host_video_hd_last,\n          SUM(audience_hd_last1) AS audience_video_hd_last,\n          SUM(host_hdp_last1) AS host_video_hdp_last,\n          SUM(audience_hdp_last1) AS audience_video_hdp_last,\n          SUM(host_audio_last1) AS host_audio_last,\n          SUM(audience_audio_last1) AS audience_audio_last,\n          SUM(host_video_last1) AS host_video_last,\n          SUM(audience_video_last1) AS audience_video_last,\n          SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n          SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n          SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n          SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n          SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n          SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n          SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n          SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n          SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n          SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n          SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n          SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n          SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n          SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n          SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n          SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n          SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n          SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n          SUM(audience_2k_last1) AS audience_2k_last1,\n          SUM(audience_4k_last1) AS audience_4k_last1,\n          SUM(audience_1080p_last1) AS audience_1080p_last1,\n          SUM(host_1080p_last1) AS host_1080p_last1,\n          SUM(host_2k_last1) AS host_2k_last1,\n          SUM(host_4k_last1) AS host_4k_last1,\n          SUM(total_last7) AS total_last7,\n          SUM(audio_last7) AS audio_last7,\n          SUM(video_last7) AS video_last7,\n          SUM(video_sd_last7) AS video_sd_last7,\n          SUM(video_hd_last7) AS video_hd_last7,\n          SUM(video_hdp_last7) AS video_hdp_last7,\n          SUM(host_sd_last7) AS host_sd_last7,\n          SUM(audience_sd_last7) AS audience_sd_last7,\n          SUM(host_hd_last7) AS host_hd_last7,\n          SUM(audience_hd_last7) AS audience_hd_last7,\n          SUM(host_hdp_last7) AS host_hdp_last7,\n          SUM(audience_hdp_last7) AS audience_hdp_last7,\n          SUM(host_audio_last7) AS host_audio_last7,\n          SUM(audience_audio_last7) AS audience_audio_last7,\n          SUM(host_video_last7) AS host_video_last7,\n          SUM(audience_video_last7) AS audience_video_last7,\n          SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n          SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n          SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n          SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n          SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n          SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n          SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n          SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n          SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n          SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n          SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n          SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n          SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n          SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n          SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n          SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n          SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n          SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n          SUM(audience_2k_last7) AS audience_2k_last7,\n          SUM(audience_4k_last7) AS audience_4k_last7,\n          SUM(audience_1080p_last7) AS audience_1080p_last7,\n          SUM(host_1080p_last7) AS host_1080p_last7,\n          SUM(host_2k_last7) AS host_2k_last7,\n          SUM(host_4k_last7) AS host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211001 AND date <= 20211128 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n        GROUP BY date,\n          DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n          2,\n          3,\n          tag,\n          area,\n          dim,\n          8,\n          9,\n          10,\n          level4,\n          product_level1,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en,\n          vid_use_case_en,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          browser,\n          browser_ver,\n          dim_grouping_name) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 3 AND CAST(\"自定义 SQL 查询\".\"level1\" AS VARCHAR) = 'RTSA' AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 2"
	},
	{
		"presto_sql" : "SELECT \"自定义 SQL 查询\".\"cid_industry\" AS \"cid_industry\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"usr_Calculation_3519281700079370244_ok\"\nFROM (SELECT date,\n      start_date AS start_date,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name,\n      SUM(total) AS totalUsage,\n      SUM(audio) AS audio,\n      SUM(video) AS video,\n      SUM(host_sd + audience_sd) AS video_sd,\n      SUM(host_hd + audience_hd) AS video_hd,\n      SUM(host_hdp + audience_hdp) AS video_hdp,\n      SUM(host_audio) AS host_audio,\n      SUM(audience_audio) AS audience_audio,\n      SUM(host_sd) AS host_sd,\n      SUM(host_hd) AS host_hd,\n      SUM(host_hdp) AS host_hdp,\n      SUM(host_1080p) AS host_1080p,\n      SUM(host_2k) AS host_2k,\n      SUM(host_4k) AS host_4k,\n      SUM(audience_sd) AS audience_sd,\n      SUM(audience_hd) AS audience_hd,\n      SUM(audience_hdp) AS audience_hdp,\n      SUM(audience_1080p) AS audience_1080p,\n      SUM(audience_2k) AS audience_2k,\n      SUM(audience_4k) AS audience_4k,\n      SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n      SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n      SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n      SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n      SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n      SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n      SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n      SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n      SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n      SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n      SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n      SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n      SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n      SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n      SUM(total_last1) AS audio_video_last,\n      SUM(audio_last1) AS audio_last,\n      SUM(video_last1) AS video_last,\n      SUM(video_sd_last1) AS video_sd_last,\n      SUM(video_hd_last1) AS video_hd_last,\n      SUM(video_hdp_last1) AS video_hdp_last,\n      SUM(host_sd_last1) AS host_video_sd_last,\n      SUM(audience_sd_last1) AS audience_video_sd_last,\n      SUM(host_hd_last1) AS host_video_hd_last,\n      SUM(audience_hd_last1) AS audience_video_hd_last,\n      SUM(host_hdp_last1) AS host_video_hdp_last,\n      SUM(audience_hdp_last1) AS audience_video_hdp_last,\n      SUM(host_audio_last1) AS host_audio_last,\n      SUM(audience_audio_last1) AS audience_audio_last,\n      SUM(host_video_last1) AS host_video_last,\n      SUM(audience_video_last1) AS audience_video_last,\n      SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n      SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n      SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n      SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n      SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n      SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n      SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n      SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n      SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n      SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n      SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n      SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n      SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n      SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n      SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n      SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n      SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n      SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n      SUM(audience_2k_last1) AS audience_2k_last1,\n      SUM(audience_4k_last1) AS audience_4k_last1,\n      SUM(audience_1080p_last1) AS audience_1080p_last1,\n      SUM(host_1080p_last1) AS host_1080p_last1,\n      SUM(host_2k_last1) AS host_2k_last1,\n      SUM(host_4k_last1) AS host_4k_last1,\n      SUM(total_last7) AS total_last7,\n      SUM(audio_last7) AS audio_last7,\n      SUM(video_last7) AS video_last7,\n      SUM(video_sd_last7) AS video_sd_last7,\n      SUM(video_hd_last7) AS video_hd_last7,\n      SUM(video_hdp_last7) AS video_hdp_last7,\n      SUM(host_sd_last7) AS host_sd_last7,\n      SUM(audience_sd_last7) AS audience_sd_last7,\n      SUM(host_hd_last7) AS host_hd_last7,\n      SUM(audience_hd_last7) AS audience_hd_last7,\n      SUM(host_hdp_last7) AS host_hdp_last7,\n      SUM(audience_hdp_last7) AS audience_hdp_last7,\n      SUM(host_audio_last7) AS host_audio_last7,\n      SUM(audience_audio_last7) AS audience_audio_last7,\n      SUM(host_video_last7) AS host_video_last7,\n      SUM(audience_video_last7) AS audience_video_last7,\n      SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n      SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n      SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n      SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n      SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n      SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n      SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n      SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n      SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n      SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n      SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n      SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n      SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n      SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n      SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n      SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n      SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n      SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n      SUM(audience_2k_last7) AS audience_2k_last7,\n      SUM(audience_4k_last7) AS audience_4k_last7,\n      SUM(audience_1080p_last7) AS audience_1080p_last7,\n      SUM(host_1080p_last7) AS host_1080p_last7,\n      SUM(host_2k_last7) AS host_2k_last7,\n      SUM(host_4k_last7) AS host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211001 AND date <= 20211128 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n    GROUP BY date,\n      DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n      2,\n      3,\n      tag,\n      area,\n      dim,\n      8,\n      9,\n      10,\n      level4,\n      product_level1,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en,\n      vid_use_case_en,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name) AS \"自定义 SQL 查询\"\nWHERE \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 3 AND CAST(\"自定义 SQL 查询\".\"level1\" AS VARCHAR) = 'RTSA'\nGROUP BY 1"
	},
	{
		"presto_sql" : "SELECT \"自定义 SQL 查询\".\"cid_industry\" AS \"cid_industry\",\n  \"自定义 SQL 查询\".\"stat_date\" AS \"stat_date\"\nFROM (SELECT date,\n      start_date AS start_date,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name,\n      SUM(total) AS totalUsage,\n      SUM(audio) AS audio,\n      SUM(video) AS video,\n      SUM(host_sd + audience_sd) AS video_sd,\n      SUM(host_hd + audience_hd) AS video_hd,\n      SUM(host_hdp + audience_hdp) AS video_hdp,\n      SUM(host_audio) AS host_audio,\n      SUM(audience_audio) AS audience_audio,\n      SUM(host_sd) AS host_sd,\n      SUM(host_hd) AS host_hd,\n      SUM(host_hdp) AS host_hdp,\n      SUM(host_1080p) AS host_1080p,\n      SUM(host_2k) AS host_2k,\n      SUM(host_4k) AS host_4k,\n      SUM(audience_sd) AS audience_sd,\n      SUM(audience_hd) AS audience_hd,\n      SUM(audience_hdp) AS audience_hdp,\n      SUM(audience_1080p) AS audience_1080p,\n      SUM(audience_2k) AS audience_2k,\n      SUM(audience_4k) AS audience_4k,\n      SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n      SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n      SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n      SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n      SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n      SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n      SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n      SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n      SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n      SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n      SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n      SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n      SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n      SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n      SUM(total_last1) AS audio_video_last,\n      SUM(audio_last1) AS audio_last,\n      SUM(video_last1) AS video_last,\n      SUM(video_sd_last1) AS video_sd_last,\n      SUM(video_hd_last1) AS video_hd_last,\n      SUM(video_hdp_last1) AS video_hdp_last,\n      SUM(host_sd_last1) AS host_video_sd_last,\n      SUM(audience_sd_last1) AS audience_video_sd_last,\n      SUM(host_hd_last1) AS host_video_hd_last,\n      SUM(audience_hd_last1) AS audience_video_hd_last,\n      SUM(host_hdp_last1) AS host_video_hdp_last,\n      SUM(audience_hdp_last1) AS audience_video_hdp_last,\n      SUM(host_audio_last1) AS host_audio_last,\n      SUM(audience_audio_last1) AS audience_audio_last,\n      SUM(host_video_last1) AS host_video_last,\n      SUM(audience_video_last1) AS audience_video_last,\n      SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n      SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n      SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n      SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n      SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n      SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n      SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n      SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n      SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n      SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n      SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n      SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n      SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n      SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n      SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n      SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n      SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n      SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n      SUM(audience_2k_last1) AS audience_2k_last1,\n      SUM(audience_4k_last1) AS audience_4k_last1,\n      SUM(audience_1080p_last1) AS audience_1080p_last1,\n      SUM(host_1080p_last1) AS host_1080p_last1,\n      SUM(host_2k_last1) AS host_2k_last1,\n      SUM(host_4k_last1) AS host_4k_last1,\n      SUM(total_last7) AS total_last7,\n      SUM(audio_last7) AS audio_last7,\n      SUM(video_last7) AS video_last7,\n      SUM(video_sd_last7) AS video_sd_last7,\n      SUM(video_hd_last7) AS video_hd_last7,\n      SUM(video_hdp_last7) AS video_hdp_last7,\n      SUM(host_sd_last7) AS host_sd_last7,\n      SUM(audience_sd_last7) AS audience_sd_last7,\n      SUM(host_hd_last7) AS host_hd_last7,\n      SUM(audience_hd_last7) AS audience_hd_last7,\n      SUM(host_hdp_last7) AS host_hdp_last7,\n      SUM(audience_hdp_last7) AS audience_hdp_last7,\n      SUM(host_audio_last7) AS host_audio_last7,\n      SUM(audience_audio_last7) AS audience_audio_last7,\n      SUM(host_video_last7) AS host_video_last7,\n      SUM(audience_video_last7) AS audience_video_last7,\n      SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n      SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n      SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n      SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n      SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n      SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n      SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n      SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n      SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n      SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n      SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n      SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n      SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n      SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n      SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n      SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n      SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n      SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n      SUM(audience_2k_last7) AS audience_2k_last7,\n      SUM(audience_4k_last7) AS audience_4k_last7,\n      SUM(audience_1080p_last7) AS audience_1080p_last7,\n      SUM(host_1080p_last7) AS host_1080p_last7,\n      SUM(host_2k_last7) AS host_2k_last7,\n      SUM(host_4k_last7) AS host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211113 AND date <= 20211212 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n    GROUP BY date,\n      DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n      2,\n      3,\n      tag,\n      area,\n      dim,\n      8,\n      9,\n      10,\n      level4,\n      product_level1,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en,\n      vid_use_case_en,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name) AS \"自定义 SQL 查询\"\nWHERE \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 3 AND CAST(\"自定义 SQL 查询\".\"level1\" AS VARCHAR) = 'RTC'\nGROUP BY 1,\n  2"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700079370244)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700079370244)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700079370244)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700079370244)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700079370244)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700079370244)(943764407)(0)\",\n  MIN(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(1482809429)(0)\",\n  MIN(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(3765460736)(0)\",\n  \"自定义 SQL 查询\".\"stat_date\" AS \"TEMP(attr_stat_date_nk)(2102638629)(0)\",\n  \"自定义 SQL 查询\".\"stat_date\" AS \"TEMP(attr_stat_date_nk)(2790680713)(0)\",\n  \"自定义 SQL 查询\".\"product_level3\" AS \"product_level3\",\n  \"自定义 SQL 查询\".\"stat_date\" AS \"stat_date\"\nFROM (SELECT date,\n      start_date AS start_date,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name,\n      SUM(total) AS totalUsage,\n      SUM(audio) AS audio,\n      SUM(video) AS video,\n      SUM(host_sd + audience_sd) AS video_sd,\n      SUM(host_hd + audience_hd) AS video_hd,\n      SUM(host_hdp + audience_hdp) AS video_hdp,\n      SUM(host_audio) AS host_audio,\n      SUM(audience_audio) AS audience_audio,\n      SUM(host_sd) AS host_sd,\n      SUM(host_hd) AS host_hd,\n      SUM(host_hdp) AS host_hdp,\n      SUM(host_1080p) AS host_1080p,\n      SUM(host_2k) AS host_2k,\n      SUM(host_4k) AS host_4k,\n      SUM(audience_sd) AS audience_sd,\n      SUM(audience_hd) AS audience_hd,\n      SUM(audience_hdp) AS audience_hdp,\n      SUM(audience_1080p) AS audience_1080p,\n      SUM(audience_2k) AS audience_2k,\n      SUM(audience_4k) AS audience_4k,\n      SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n      SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n      SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n      SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n      SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n      SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n      SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n      SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n      SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n      SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n      SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n      SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n      SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n      SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n      SUM(total_last1) AS audio_video_last,\n      SUM(audio_last1) AS audio_last,\n      SUM(video_last1) AS video_last,\n      SUM(video_sd_last1) AS video_sd_last,\n      SUM(video_hd_last1) AS video_hd_last,\n      SUM(video_hdp_last1) AS video_hdp_last,\n      SUM(host_sd_last1) AS host_video_sd_last,\n      SUM(audience_sd_last1) AS audience_video_sd_last,\n      SUM(host_hd_last1) AS host_video_hd_last,\n      SUM(audience_hd_last1) AS audience_video_hd_last,\n      SUM(host_hdp_last1) AS host_video_hdp_last,\n      SUM(audience_hdp_last1) AS audience_video_hdp_last,\n      SUM(host_audio_last1) AS host_audio_last,\n      SUM(audience_audio_last1) AS audience_audio_last,\n      SUM(host_video_last1) AS host_video_last,\n      SUM(audience_video_last1) AS audience_video_last,\n      SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n      SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n      SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n      SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n      SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n      SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n      SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n      SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n      SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n      SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n      SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n      SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n      SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n      SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n      SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n      SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n      SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n      SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n      SUM(audience_2k_last1) AS audience_2k_last1,\n      SUM(audience_4k_last1) AS audience_4k_last1,\n      SUM(audience_1080p_last1) AS audience_1080p_last1,\n      SUM(host_1080p_last1) AS host_1080p_last1,\n      SUM(host_2k_last1) AS host_2k_last1,\n      SUM(host_4k_last1) AS host_4k_last1,\n      SUM(total_last7) AS total_last7,\n      SUM(audio_last7) AS audio_last7,\n      SUM(video_last7) AS video_last7,\n      SUM(video_sd_last7) AS video_sd_last7,\n      SUM(video_hd_last7) AS video_hd_last7,\n      SUM(video_hdp_last7) AS video_hdp_last7,\n      SUM(host_sd_last7) AS host_sd_last7,\n      SUM(audience_sd_last7) AS audience_sd_last7,\n      SUM(host_hd_last7) AS host_hd_last7,\n      SUM(audience_hd_last7) AS audience_hd_last7,\n      SUM(host_hdp_last7) AS host_hdp_last7,\n      SUM(audience_hdp_last7) AS audience_hdp_last7,\n      SUM(host_audio_last7) AS host_audio_last7,\n      SUM(audience_audio_last7) AS audience_audio_last7,\n      SUM(host_video_last7) AS host_video_last7,\n      SUM(audience_video_last7) AS audience_video_last7,\n      SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n      SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n      SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n      SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n      SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n      SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n      SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n      SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n      SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n      SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n      SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n      SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n      SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n      SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n      SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n      SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n      SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n      SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n      SUM(audience_2k_last7) AS audience_2k_last7,\n      SUM(audience_4k_last7) AS audience_4k_last7,\n      SUM(audience_1080p_last7) AS audience_1080p_last7,\n      SUM(host_1080p_last7) AS host_1080p_last7,\n      SUM(host_2k_last7) AS host_2k_last7,\n      SUM(host_4k_last7) AS host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211113 AND date <= 20211212 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n    GROUP BY date,\n      DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n      2,\n      3,\n      tag,\n      area,\n      dim,\n      8,\n      9,\n      10,\n      level4,\n      product_level1,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en,\n      vid_use_case_en,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name) AS \"自定义 SQL 查询\"\nWHERE \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 3 AND CAST(\"自定义 SQL 查询\".\"level1\" AS VARCHAR) = 'RTC'\nGROUP BY 22,\n  20"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700079370244)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700079370244)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700079370244)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700079370244)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700079370244)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700079370244)(943764407)(0)\",\n  MIN(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(1482809429)(0)\",\n  MIN(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(3765460736)(0)\",\n  \"自定义 SQL 查询\".\"stat_date\" AS \"TEMP(attr_stat_date_nk)(2102638629)(0)\",\n  \"自定义 SQL 查询\".\"stat_date\" AS \"TEMP(attr_stat_date_nk)(2790680713)(0)\",\n  \"自定义 SQL 查询\".\"stat_date\" AS \"stat_date\",\n  \"自定义 SQL 查询\".\"vid_sector_en\" AS \"vid_sector_en\"\nFROM (SELECT date,\n      start_date AS start_date,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name,\n      SUM(total) AS totalUsage,\n      SUM(audio) AS audio,\n      SUM(video) AS video,\n      SUM(host_sd + audience_sd) AS video_sd,\n      SUM(host_hd + audience_hd) AS video_hd,\n      SUM(host_hdp + audience_hdp) AS video_hdp,\n      SUM(host_audio) AS host_audio,\n      SUM(audience_audio) AS audience_audio,\n      SUM(host_sd) AS host_sd,\n      SUM(host_hd) AS host_hd,\n      SUM(host_hdp) AS host_hdp,\n      SUM(host_1080p) AS host_1080p,\n      SUM(host_2k) AS host_2k,\n      SUM(host_4k) AS host_4k,\n      SUM(audience_sd) AS audience_sd,\n      SUM(audience_hd) AS audience_hd,\n      SUM(audience_hdp) AS audience_hdp,\n      SUM(audience_1080p) AS audience_1080p,\n      SUM(audience_2k) AS audience_2k,\n      SUM(audience_4k) AS audience_4k,\n      SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n      SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n      SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n      SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n      SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n      SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n      SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n      SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n      SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n      SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n      SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n      SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n      SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n      SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n      SUM(total_last1) AS audio_video_last,\n      SUM(audio_last1) AS audio_last,\n      SUM(video_last1) AS video_last,\n      SUM(video_sd_last1) AS video_sd_last,\n      SUM(video_hd_last1) AS video_hd_last,\n      SUM(video_hdp_last1) AS video_hdp_last,\n      SUM(host_sd_last1) AS host_video_sd_last,\n      SUM(audience_sd_last1) AS audience_video_sd_last,\n      SUM(host_hd_last1) AS host_video_hd_last,\n      SUM(audience_hd_last1) AS audience_video_hd_last,\n      SUM(host_hdp_last1) AS host_video_hdp_last,\n      SUM(audience_hdp_last1) AS audience_video_hdp_last,\n      SUM(host_audio_last1) AS host_audio_last,\n      SUM(audience_audio_last1) AS audience_audio_last,\n      SUM(host_video_last1) AS host_video_last,\n      SUM(audience_video_last1) AS audience_video_last,\n      SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n      SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n      SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n      SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n      SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n      SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n      SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n      SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n      SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n      SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n      SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n      SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n      SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n      SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n      SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n      SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n      SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n      SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n      SUM(audience_2k_last1) AS audience_2k_last1,\n      SUM(audience_4k_last1) AS audience_4k_last1,\n      SUM(audience_1080p_last1) AS audience_1080p_last1,\n      SUM(host_1080p_last1) AS host_1080p_last1,\n      SUM(host_2k_last1) AS host_2k_last1,\n      SUM(host_4k_last1) AS host_4k_last1,\n      SUM(total_last7) AS total_last7,\n      SUM(audio_last7) AS audio_last7,\n      SUM(video_last7) AS video_last7,\n      SUM(video_sd_last7) AS video_sd_last7,\n      SUM(video_hd_last7) AS video_hd_last7,\n      SUM(video_hdp_last7) AS video_hdp_last7,\n      SUM(host_sd_last7) AS host_sd_last7,\n      SUM(audience_sd_last7) AS audience_sd_last7,\n      SUM(host_hd_last7) AS host_hd_last7,\n      SUM(audience_hd_last7) AS audience_hd_last7,\n      SUM(host_hdp_last7) AS host_hdp_last7,\n      SUM(audience_hdp_last7) AS audience_hdp_last7,\n      SUM(host_audio_last7) AS host_audio_last7,\n      SUM(audience_audio_last7) AS audience_audio_last7,\n      SUM(host_video_last7) AS host_video_last7,\n      SUM(audience_video_last7) AS audience_video_last7,\n      SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n      SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n      SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n      SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n      SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n      SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n      SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n      SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n      SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n      SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n      SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n      SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n      SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n      SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n      SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n      SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n      SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n      SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n      SUM(audience_2k_last7) AS audience_2k_last7,\n      SUM(audience_4k_last7) AS audience_4k_last7,\n      SUM(audience_1080p_last7) AS audience_1080p_last7,\n      SUM(host_1080p_last7) AS host_1080p_last7,\n      SUM(host_2k_last7) AS host_2k_last7,\n      SUM(host_4k_last7) AS host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211113 AND date <= 20211212 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n    GROUP BY date,\n      DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n      2,\n      3,\n      tag,\n      area,\n      dim,\n      8,\n      9,\n      10,\n      level4,\n      product_level1,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en,\n      vid_use_case_en,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name) AS \"自定义 SQL 查询\"\nWHERE \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 3 AND CAST(\"自定义 SQL 查询\".\"level1\" AS VARCHAR) = 'RTC'\nGROUP BY 20,\n  23"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700079370244)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700079370244)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700079370244)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700079370244)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700079370244)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700079370244)(943764407)(0)\",\n  MIN(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(1482809429)(0)\",\n  MIN(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(3765460736)(0)\",\n  \"自定义 SQL 查询\".\"stat_date\" AS \"TEMP(attr_stat_date_nk)(2102638629)(0)\",\n  \"自定义 SQL 查询\".\"stat_date\" AS \"TEMP(attr_stat_date_nk)(2790680713)(0)\",\n  \"自定义 SQL 查询\".\"stat_date\" AS \"stat_date\",\n  \"自定义 SQL 查询\".\"vid_use_case_cn\" AS \"vid_use_case_cn\"\nFROM (SELECT date,\n      start_date AS start_date,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name,\n      SUM(total) AS totalUsage,\n      SUM(audio) AS audio,\n      SUM(video) AS video,\n      SUM(host_sd + audience_sd) AS video_sd,\n      SUM(host_hd + audience_hd) AS video_hd,\n      SUM(host_hdp + audience_hdp) AS video_hdp,\n      SUM(host_audio) AS host_audio,\n      SUM(audience_audio) AS audience_audio,\n      SUM(host_sd) AS host_sd,\n      SUM(host_hd) AS host_hd,\n      SUM(host_hdp) AS host_hdp,\n      SUM(host_1080p) AS host_1080p,\n      SUM(host_2k) AS host_2k,\n      SUM(host_4k) AS host_4k,\n      SUM(audience_sd) AS audience_sd,\n      SUM(audience_hd) AS audience_hd,\n      SUM(audience_hdp) AS audience_hdp,\n      SUM(audience_1080p) AS audience_1080p,\n      SUM(audience_2k) AS audience_2k,\n      SUM(audience_4k) AS audience_4k,\n      SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n      SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n      SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n      SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n      SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n      SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n      SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n      SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n      SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n      SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n      SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n      SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n      SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n      SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n      SUM(total_last1) AS audio_video_last,\n      SUM(audio_last1) AS audio_last,\n      SUM(video_last1) AS video_last,\n      SUM(video_sd_last1) AS video_sd_last,\n      SUM(video_hd_last1) AS video_hd_last,\n      SUM(video_hdp_last1) AS video_hdp_last,\n      SUM(host_sd_last1) AS host_video_sd_last,\n      SUM(audience_sd_last1) AS audience_video_sd_last,\n      SUM(host_hd_last1) AS host_video_hd_last,\n      SUM(audience_hd_last1) AS audience_video_hd_last,\n      SUM(host_hdp_last1) AS host_video_hdp_last,\n      SUM(audience_hdp_last1) AS audience_video_hdp_last,\n      SUM(host_audio_last1) AS host_audio_last,\n      SUM(audience_audio_last1) AS audience_audio_last,\n      SUM(host_video_last1) AS host_video_last,\n      SUM(audience_video_last1) AS audience_video_last,\n      SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n      SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n      SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n      SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n      SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n      SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n      SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n      SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n      SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n      SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n      SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n      SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n      SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n      SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n      SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n      SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n      SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n      SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n      SUM(audience_2k_last1) AS audience_2k_last1,\n      SUM(audience_4k_last1) AS audience_4k_last1,\n      SUM(audience_1080p_last1) AS audience_1080p_last1,\n      SUM(host_1080p_last1) AS host_1080p_last1,\n      SUM(host_2k_last1) AS host_2k_last1,\n      SUM(host_4k_last1) AS host_4k_last1,\n      SUM(total_last7) AS total_last7,\n      SUM(audio_last7) AS audio_last7,\n      SUM(video_last7) AS video_last7,\n      SUM(video_sd_last7) AS video_sd_last7,\n      SUM(video_hd_last7) AS video_hd_last7,\n      SUM(video_hdp_last7) AS video_hdp_last7,\n      SUM(host_sd_last7) AS host_sd_last7,\n      SUM(audience_sd_last7) AS audience_sd_last7,\n      SUM(host_hd_last7) AS host_hd_last7,\n      SUM(audience_hd_last7) AS audience_hd_last7,\n      SUM(host_hdp_last7) AS host_hdp_last7,\n      SUM(audience_hdp_last7) AS audience_hdp_last7,\n      SUM(host_audio_last7) AS host_audio_last7,\n      SUM(audience_audio_last7) AS audience_audio_last7,\n      SUM(host_video_last7) AS host_video_last7,\n      SUM(audience_video_last7) AS audience_video_last7,\n      SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n      SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n      SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n      SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n      SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n      SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n      SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n      SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n      SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n      SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n      SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n      SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n      SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n      SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n      SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n      SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n      SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n      SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n      SUM(audience_2k_last7) AS audience_2k_last7,\n      SUM(audience_4k_last7) AS audience_4k_last7,\n      SUM(audience_1080p_last7) AS audience_1080p_last7,\n      SUM(host_1080p_last7) AS host_1080p_last7,\n      SUM(host_2k_last7) AS host_2k_last7,\n      SUM(host_4k_last7) AS host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211113 AND date <= 20211212 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n    GROUP BY date,\n      DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n      2,\n      3,\n      tag,\n      area,\n      dim,\n      8,\n      9,\n      10,\n      level4,\n      product_level1,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en,\n      vid_use_case_en,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name) AS \"自定义 SQL 查询\"\nWHERE \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 3 AND CAST(\"自定义 SQL 查询\".\"level1\" AS VARCHAR) = 'RTC'\nGROUP BY 20,\n  23"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_96897765691088903)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video_sd\") AS \"TEMP(Calculation_96897765691088903)(3165650715)(0)\",\n  MAX(\"自定义 SQL 查询\".\"stat_date\") AS \"TEMP(attr_stat_date_nk)(2102638629)(0)\",\n  MIN(\"自定义 SQL 查询\".\"stat_date\") AS \"TEMP(attr_stat_date_nk)(2790680713)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video_hdp\") AS \"TEMP(sd百分比 (复制) (复制)_96897765691801609)(15603621\",\n  SUM(\"自定义 SQL 查询\".\"video_hd\") AS \"TEMP(sd百分比 (复制)_96897765691785224)(843876055)(0)\",\n  \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"sum_audio_ok\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"sum_totalUsage_ok\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"sum_video_ok\",\n  SUM(\"自定义 SQL 查询\".\"video_hd\") AS \"sum_video_hd_ok\",\n  SUM(\"自定义 SQL 查询\".\"video_hdp\") AS \"sum_video_hdp_ok\",\n  SUM(\"自定义 SQL 查询\".\"video_sd\") AS \"sum_video_sd_ok\",\n  DATE_ADD('SECOND', 0, date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"tdy_date_ok\"\nFROM (SELECT date,\n      start_date AS start_date,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name,\n      SUM(total) AS totalUsage,\n      SUM(audio) AS audio,\n      SUM(video) AS video,\n      SUM(host_sd + audience_sd) AS video_sd,\n      SUM(host_hd + audience_hd) AS video_hd,\n      SUM(host_hdp + audience_hdp) AS video_hdp,\n      SUM(host_audio) AS host_audio,\n      SUM(audience_audio) AS audience_audio,\n      SUM(host_sd) AS host_sd,\n      SUM(host_hd) AS host_hd,\n      SUM(host_hdp) AS host_hdp,\n      SUM(host_1080p) AS host_1080p,\n      SUM(host_2k) AS host_2k,\n      SUM(host_4k) AS host_4k,\n      SUM(audience_sd) AS audience_sd,\n      SUM(audience_hd) AS audience_hd,\n      SUM(audience_hdp) AS audience_hdp,\n      SUM(audience_1080p) AS audience_1080p,\n      SUM(audience_2k) AS audience_2k,\n      SUM(audience_4k) AS audience_4k,\n      SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n      SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n      SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n      SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n      SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n      SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n      SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n      SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n      SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n      SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n      SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n      SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n      SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n      SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n      SUM(total_last1) AS audio_video_last,\n      SUM(audio_last1) AS audio_last,\n      SUM(video_last1) AS video_last,\n      SUM(video_sd_last1) AS video_sd_last,\n      SUM(video_hd_last1) AS video_hd_last,\n      SUM(video_hdp_last1) AS video_hdp_last,\n      SUM(host_sd_last1) AS host_video_sd_last,\n      SUM(audience_sd_last1) AS audience_video_sd_last,\n      SUM(host_hd_last1) AS host_video_hd_last,\n      SUM(audience_hd_last1) AS audience_video_hd_last,\n      SUM(host_hdp_last1) AS host_video_hdp_last,\n      SUM(audience_hdp_last1) AS audience_video_hdp_last,\n      SUM(host_audio_last1) AS host_audio_last,\n      SUM(audience_audio_last1) AS audience_audio_last,\n      SUM(host_video_last1) AS host_video_last,\n      SUM(audience_video_last1) AS audience_video_last,\n      SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n      SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n      SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n      SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n      SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n      SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n      SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n      SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n      SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n      SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n      SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n      SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n      SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n      SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n      SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n      SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n      SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n      SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n      SUM(audience_2k_last1) AS audience_2k_last1,\n      SUM(audience_4k_last1) AS audience_4k_last1,\n      SUM(audience_1080p_last1) AS audience_1080p_last1,\n      SUM(host_1080p_last1) AS host_1080p_last1,\n      SUM(host_2k_last1) AS host_2k_last1,\n      SUM(host_4k_last1) AS host_4k_last1,\n      SUM(total_last7) AS total_last7,\n      SUM(audio_last7) AS audio_last7,\n      SUM(video_last7) AS video_last7,\n      SUM(video_sd_last7) AS video_sd_last7,\n      SUM(video_hd_last7) AS video_hd_last7,\n      SUM(video_hdp_last7) AS video_hdp_last7,\n      SUM(host_sd_last7) AS host_sd_last7,\n      SUM(audience_sd_last7) AS audience_sd_last7,\n      SUM(host_hd_last7) AS host_hd_last7,\n      SUM(audience_hd_last7) AS audience_hd_last7,\n      SUM(host_hdp_last7) AS host_hdp_last7,\n      SUM(audience_hdp_last7) AS audience_hdp_last7,\n      SUM(host_audio_last7) AS host_audio_last7,\n      SUM(audience_audio_last7) AS audience_audio_last7,\n      SUM(host_video_last7) AS host_video_last7,\n      SUM(audience_video_last7) AS audience_video_last7,\n      SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n      SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n      SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n      SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n      SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n      SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n      SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n      SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n      SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n      SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n      SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n      SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n      SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n      SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n      SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n      SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n      SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n      SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n      SUM(audience_2k_last7) AS audience_2k_last7,\n      SUM(audience_4k_last7) AS audience_4k_last7,\n      SUM(audience_1080p_last7) AS audience_1080p_last7,\n      SUM(host_1080p_last7) AS host_1080p_last7,\n      SUM(host_2k_last7) AS host_2k_last7,\n      SUM(host_4k_last7) AS host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211113 AND date <= 20211212 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n    GROUP BY date,\n      DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n      2,\n      3,\n      tag,\n      area,\n      dim,\n      8,\n      9,\n      10,\n      level4,\n      product_level1,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en,\n      vid_use_case_en,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name) AS \"自定义 SQL 查询\"\nWHERE CAST(\"自定义 SQL 查询\".\"level1\" AS VARCHAR) = 'RTC' AND \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 3\nGROUP BY 7,\n  14"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700079370244)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700079370244)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700079370244)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700079370244)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700079370244)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700079370244)(943764407)(0)\",\n  MIN(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(1482809429)(0)\",\n  MIN(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(3765460736)(0)\",\n  \"自定义 SQL 查询\".\"stat_date\" AS \"TEMP(attr_stat_date_nk)(2102638629)(0)\",\n  \"自定义 SQL 查询\".\"stat_date\" AS \"TEMP(attr_stat_date_nk)(2790680713)(0)\",\n  \"自定义 SQL 查询\".\"product_level2\" AS \"product_level2\",\n  \"自定义 SQL 查询\".\"stat_date\" AS \"stat_date\"\nFROM (SELECT date,\n      start_date AS start_date,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name,\n      SUM(total) AS totalUsage,\n      SUM(audio) AS audio,\n      SUM(video) AS video,\n      SUM(host_sd + audience_sd) AS video_sd,\n      SUM(host_hd + audience_hd) AS video_hd,\n      SUM(host_hdp + audience_hdp) AS video_hdp,\n      SUM(host_audio) AS host_audio,\n      SUM(audience_audio) AS audience_audio,\n      SUM(host_sd) AS host_sd,\n      SUM(host_hd) AS host_hd,\n      SUM(host_hdp) AS host_hdp,\n      SUM(host_1080p) AS host_1080p,\n      SUM(host_2k) AS host_2k,\n      SUM(host_4k) AS host_4k,\n      SUM(audience_sd) AS audience_sd,\n      SUM(audience_hd) AS audience_hd,\n      SUM(audience_hdp) AS audience_hdp,\n      SUM(audience_1080p) AS audience_1080p,\n      SUM(audience_2k) AS audience_2k,\n      SUM(audience_4k) AS audience_4k,\n      SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n      SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n      SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n      SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n      SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n      SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n      SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n      SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n      SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n      SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n      SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n      SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n      SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n      SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n      SUM(total_last1) AS audio_video_last,\n      SUM(audio_last1) AS audio_last,\n      SUM(video_last1) AS video_last,\n      SUM(video_sd_last1) AS video_sd_last,\n      SUM(video_hd_last1) AS video_hd_last,\n      SUM(video_hdp_last1) AS video_hdp_last,\n      SUM(host_sd_last1) AS host_video_sd_last,\n      SUM(audience_sd_last1) AS audience_video_sd_last,\n      SUM(host_hd_last1) AS host_video_hd_last,\n      SUM(audience_hd_last1) AS audience_video_hd_last,\n      SUM(host_hdp_last1) AS host_video_hdp_last,\n      SUM(audience_hdp_last1) AS audience_video_hdp_last,\n      SUM(host_audio_last1) AS host_audio_last,\n      SUM(audience_audio_last1) AS audience_audio_last,\n      SUM(host_video_last1) AS host_video_last,\n      SUM(audience_video_last1) AS audience_video_last,\n      SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n      SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n      SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n      SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n      SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n      SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n      SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n      SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n      SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n      SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n      SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n      SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n      SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n      SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n      SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n      SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n      SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n      SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n      SUM(audience_2k_last1) AS audience_2k_last1,\n      SUM(audience_4k_last1) AS audience_4k_last1,\n      SUM(audience_1080p_last1) AS audience_1080p_last1,\n      SUM(host_1080p_last1) AS host_1080p_last1,\n      SUM(host_2k_last1) AS host_2k_last1,\n      SUM(host_4k_last1) AS host_4k_last1,\n      SUM(total_last7) AS total_last7,\n      SUM(audio_last7) AS audio_last7,\n      SUM(video_last7) AS video_last7,\n      SUM(video_sd_last7) AS video_sd_last7,\n      SUM(video_hd_last7) AS video_hd_last7,\n      SUM(video_hdp_last7) AS video_hdp_last7,\n      SUM(host_sd_last7) AS host_sd_last7,\n      SUM(audience_sd_last7) AS audience_sd_last7,\n      SUM(host_hd_last7) AS host_hd_last7,\n      SUM(audience_hd_last7) AS audience_hd_last7,\n      SUM(host_hdp_last7) AS host_hdp_last7,\n      SUM(audience_hdp_last7) AS audience_hdp_last7,\n      SUM(host_audio_last7) AS host_audio_last7,\n      SUM(audience_audio_last7) AS audience_audio_last7,\n      SUM(host_video_last7) AS host_video_last7,\n      SUM(audience_video_last7) AS audience_video_last7,\n      SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n      SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n      SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n      SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n      SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n      SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n      SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n      SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n      SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n      SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n      SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n      SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n      SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n      SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n      SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n      SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n      SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n      SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n      SUM(audience_2k_last7) AS audience_2k_last7,\n      SUM(audience_4k_last7) AS audience_4k_last7,\n      SUM(audience_1080p_last7) AS audience_1080p_last7,\n      SUM(host_1080p_last7) AS host_1080p_last7,\n      SUM(host_2k_last7) AS host_2k_last7,\n      SUM(host_4k_last7) AS host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211113 AND date <= 20211212 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n    GROUP BY date,\n      DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n      2,\n      3,\n      tag,\n      area,\n      dim,\n      8,\n      9,\n      10,\n      level4,\n      product_level1,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en,\n      vid_use_case_en,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name) AS \"自定义 SQL 查询\"\nWHERE \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 3 AND CAST(\"自定义 SQL 查询\".\"level1\" AS VARCHAR) = 'RTC'\nGROUP BY 22,\n  20"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"audio_last7\") AS \"TEMP(Calculation_96897765680816128)(2589233512)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_96897765680816128)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(audio同比 (复制)_96897765681725441)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video_last7\") AS \"TEMP(audio同比 (复制)_96897765681725441)(4107040267)(0)\",\n  SUM(\"自定义 SQL 查询\".\"total_last7\") AS \"TEMP(video同比 (复制)_96897765683347458)(346677966)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(video同比 (复制)_96897765683347458)(3847882359)(0)\",\n  \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"audio_video_last\") AS \"sum_audio_video_last_ok\"\nFROM (SELECT date,\n      start_date AS start_date,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name,\n      SUM(total) AS totalUsage,\n      SUM(audio) AS audio,\n      SUM(video) AS video,\n      SUM(host_sd + audience_sd) AS video_sd,\n      SUM(host_hd + audience_hd) AS video_hd,\n      SUM(host_hdp + audience_hdp) AS video_hdp,\n      SUM(host_audio) AS host_audio,\n      SUM(audience_audio) AS audience_audio,\n      SUM(host_sd) AS host_sd,\n      SUM(host_hd) AS host_hd,\n      SUM(host_hdp) AS host_hdp,\n      SUM(host_1080p) AS host_1080p,\n      SUM(host_2k) AS host_2k,\n      SUM(host_4k) AS host_4k,\n      SUM(audience_sd) AS audience_sd,\n      SUM(audience_hd) AS audience_hd,\n      SUM(audience_hdp) AS audience_hdp,\n      SUM(audience_1080p) AS audience_1080p,\n      SUM(audience_2k) AS audience_2k,\n      SUM(audience_4k) AS audience_4k,\n      SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n      SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n      SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n      SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n      SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n      SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n      SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n      SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n      SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n      SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n      SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n      SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n      SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n      SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n      SUM(total_last1) AS audio_video_last,\n      SUM(audio_last1) AS audio_last,\n      SUM(video_last1) AS video_last,\n      SUM(video_sd_last1) AS video_sd_last,\n      SUM(video_hd_last1) AS video_hd_last,\n      SUM(video_hdp_last1) AS video_hdp_last,\n      SUM(host_sd_last1) AS host_video_sd_last,\n      SUM(audience_sd_last1) AS audience_video_sd_last,\n      SUM(host_hd_last1) AS host_video_hd_last,\n      SUM(audience_hd_last1) AS audience_video_hd_last,\n      SUM(host_hdp_last1) AS host_video_hdp_last,\n      SUM(audience_hdp_last1) AS audience_video_hdp_last,\n      SUM(host_audio_last1) AS host_audio_last,\n      SUM(audience_audio_last1) AS audience_audio_last,\n      SUM(host_video_last1) AS host_video_last,\n      SUM(audience_video_last1) AS audience_video_last,\n      SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n      SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n      SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n      SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n      SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n      SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n      SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n      SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n      SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n      SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n      SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n      SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n      SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n      SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n      SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n      SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n      SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n      SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n      SUM(audience_2k_last1) AS audience_2k_last1,\n      SUM(audience_4k_last1) AS audience_4k_last1,\n      SUM(audience_1080p_last1) AS audience_1080p_last1,\n      SUM(host_1080p_last1) AS host_1080p_last1,\n      SUM(host_2k_last1) AS host_2k_last1,\n      SUM(host_4k_last1) AS host_4k_last1,\n      SUM(total_last7) AS total_last7,\n      SUM(audio_last7) AS audio_last7,\n      SUM(video_last7) AS video_last7,\n      SUM(video_sd_last7) AS video_sd_last7,\n      SUM(video_hd_last7) AS video_hd_last7,\n      SUM(video_hdp_last7) AS video_hdp_last7,\n      SUM(host_sd_last7) AS host_sd_last7,\n      SUM(audience_sd_last7) AS audience_sd_last7,\n      SUM(host_hd_last7) AS host_hd_last7,\n      SUM(audience_hd_last7) AS audience_hd_last7,\n      SUM(host_hdp_last7) AS host_hdp_last7,\n      SUM(audience_hdp_last7) AS audience_hdp_last7,\n      SUM(host_audio_last7) AS host_audio_last7,\n      SUM(audience_audio_last7) AS audience_audio_last7,\n      SUM(host_video_last7) AS host_video_last7,\n      SUM(audience_video_last7) AS audience_video_last7,\n      SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n      SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n      SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n      SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n      SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n      SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n      SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n      SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n      SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n      SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n      SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n      SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n      SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n      SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n      SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n      SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n      SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n      SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n      SUM(audience_2k_last7) AS audience_2k_last7,\n      SUM(audience_4k_last7) AS audience_4k_last7,\n      SUM(audience_1080p_last7) AS audience_1080p_last7,\n      SUM(host_1080p_last7) AS host_1080p_last7,\n      SUM(host_2k_last7) AS host_2k_last7,\n      SUM(host_4k_last7) AS host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211113 AND date <= 20211212 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n    GROUP BY date,\n      DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n      2,\n      3,\n      tag,\n      area,\n      dim,\n      8,\n      9,\n      10,\n      level4,\n      product_level1,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en,\n      vid_use_case_en,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n          start_date AS start_date,\n          end_date AS end_date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          tag,\n          area AS Scope,\n          dim,\n            CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n            CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n            CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          browser,\n          browser_ver,\n          dim_grouping_name,\n          SUM(total) AS totalUsage,\n          SUM(audio) AS audio,\n          SUM(video) AS video,\n          SUM(host_sd + audience_sd) AS video_sd,\n          SUM(host_hd + audience_hd) AS video_hd,\n          SUM(host_hdp + audience_hdp) AS video_hdp,\n          SUM(host_audio) AS host_audio,\n          SUM(audience_audio) AS audience_audio,\n          SUM(host_sd) AS host_sd,\n          SUM(host_hd) AS host_hd,\n          SUM(host_hdp) AS host_hdp,\n          SUM(host_1080p) AS host_1080p,\n          SUM(host_2k) AS host_2k,\n          SUM(host_4k) AS host_4k,\n          SUM(audience_sd) AS audience_sd,\n          SUM(audience_hd) AS audience_hd,\n          SUM(audience_hdp) AS audience_hdp,\n          SUM(audience_1080p) AS audience_1080p,\n          SUM(audience_2k) AS audience_2k,\n          SUM(audience_4k) AS audience_4k,\n          SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n          SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n          SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n          SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n          SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n          SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n          SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n          SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n          SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n          SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n          SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n          SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n          SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n          SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n          SUM(total_last1) AS audio_video_last,\n          SUM(audio_last1) AS audio_last,\n          SUM(video_last1) AS video_last,\n          SUM(video_sd_last1) AS video_sd_last,\n          SUM(video_hd_last1) AS video_hd_last,\n          SUM(video_hdp_last1) AS video_hdp_last,\n          SUM(host_sd_last1) AS host_video_sd_last,\n          SUM(audience_sd_last1) AS audience_video_sd_last,\n          SUM(host_hd_last1) AS host_video_hd_last,\n          SUM(audience_hd_last1) AS audience_video_hd_last,\n          SUM(host_hdp_last1) AS host_video_hdp_last,\n          SUM(audience_hdp_last1) AS audience_video_hdp_last,\n          SUM(host_audio_last1) AS host_audio_last,\n          SUM(audience_audio_last1) AS audience_audio_last,\n          SUM(host_video_last1) AS host_video_last,\n          SUM(audience_video_last1) AS audience_video_last,\n          SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n          SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n          SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n          SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n          SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n          SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n          SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n          SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n          SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n          SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n          SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n          SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n          SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n          SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n          SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n          SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n          SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n          SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n          SUM(audience_2k_last1) AS audience_2k_last1,\n          SUM(audience_4k_last1) AS audience_4k_last1,\n          SUM(audience_1080p_last1) AS audience_1080p_last1,\n          SUM(host_1080p_last1) AS host_1080p_last1,\n          SUM(host_2k_last1) AS host_2k_last1,\n          SUM(host_4k_last1) AS host_4k_last1,\n          SUM(total_last7) AS total_last7,\n          SUM(audio_last7) AS audio_last7,\n          SUM(video_last7) AS video_last7,\n          SUM(video_sd_last7) AS video_sd_last7,\n          SUM(video_hd_last7) AS video_hd_last7,\n          SUM(video_hdp_last7) AS video_hdp_last7,\n          SUM(host_sd_last7) AS host_sd_last7,\n          SUM(audience_sd_last7) AS audience_sd_last7,\n          SUM(host_hd_last7) AS host_hd_last7,\n          SUM(audience_hd_last7) AS audience_hd_last7,\n          SUM(host_hdp_last7) AS host_hdp_last7,\n          SUM(audience_hdp_last7) AS audience_hdp_last7,\n          SUM(host_audio_last7) AS host_audio_last7,\n          SUM(audience_audio_last7) AS audience_audio_last7,\n          SUM(host_video_last7) AS host_video_last7,\n          SUM(audience_video_last7) AS audience_video_last7,\n          SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n          SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n          SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n          SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n          SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n          SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n          SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n          SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n          SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n          SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n          SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n          SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n          SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n          SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n          SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n          SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n          SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n          SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n          SUM(audience_2k_last7) AS audience_2k_last7,\n          SUM(audience_4k_last7) AS audience_4k_last7,\n          SUM(audience_1080p_last7) AS audience_1080p_last7,\n          SUM(host_1080p_last7) AS host_1080p_last7,\n          SUM(host_2k_last7) AS host_2k_last7,\n          SUM(host_4k_last7) AS host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211113 AND date <= 20211212 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n        GROUP BY date,\n          DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n          2,\n          3,\n          tag,\n          area,\n          dim,\n          8,\n          9,\n          10,\n          level4,\n          product_level1,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en,\n          vid_use_case_en,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          browser,\n          browser_ver,\n          dim_grouping_name) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE CAST(\"自定义 SQL 查询\".\"level1\" AS VARCHAR) = 'RTC' AND \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 3 AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 7"
	},
	{
		"presto_sql" : "SELECT \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  \"自定义 SQL 查询\".\"stat_date\" AS \"stat_date\"\nFROM (SELECT date,\n      start_date AS start_date,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name,\n      SUM(total) AS totalUsage,\n      SUM(audio) AS audio,\n      SUM(video) AS video,\n      SUM(host_sd + audience_sd) AS video_sd,\n      SUM(host_hd + audience_hd) AS video_hd,\n      SUM(host_hdp + audience_hdp) AS video_hdp,\n      SUM(host_audio) AS host_audio,\n      SUM(audience_audio) AS audience_audio,\n      SUM(host_sd) AS host_sd,\n      SUM(host_hd) AS host_hd,\n      SUM(host_hdp) AS host_hdp,\n      SUM(host_1080p) AS host_1080p,\n      SUM(host_2k) AS host_2k,\n      SUM(host_4k) AS host_4k,\n      SUM(audience_sd) AS audience_sd,\n      SUM(audience_hd) AS audience_hd,\n      SUM(audience_hdp) AS audience_hdp,\n      SUM(audience_1080p) AS audience_1080p,\n      SUM(audience_2k) AS audience_2k,\n      SUM(audience_4k) AS audience_4k,\n      SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n      SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n      SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n      SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n      SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n      SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n      SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n      SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n      SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n      SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n      SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n      SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n      SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n      SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n      SUM(total_last1) AS audio_video_last,\n      SUM(audio_last1) AS audio_last,\n      SUM(video_last1) AS video_last,\n      SUM(video_sd_last1) AS video_sd_last,\n      SUM(video_hd_last1) AS video_hd_last,\n      SUM(video_hdp_last1) AS video_hdp_last,\n      SUM(host_sd_last1) AS host_video_sd_last,\n      SUM(audience_sd_last1) AS audience_video_sd_last,\n      SUM(host_hd_last1) AS host_video_hd_last,\n      SUM(audience_hd_last1) AS audience_video_hd_last,\n      SUM(host_hdp_last1) AS host_video_hdp_last,\n      SUM(audience_hdp_last1) AS audience_video_hdp_last,\n      SUM(host_audio_last1) AS host_audio_last,\n      SUM(audience_audio_last1) AS audience_audio_last,\n      SUM(host_video_last1) AS host_video_last,\n      SUM(audience_video_last1) AS audience_video_last,\n      SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n      SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n      SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n      SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n      SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n      SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n      SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n      SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n      SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n      SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n      SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n      SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n      SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n      SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n      SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n      SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n      SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n      SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n      SUM(audience_2k_last1) AS audience_2k_last1,\n      SUM(audience_4k_last1) AS audience_4k_last1,\n      SUM(audience_1080p_last1) AS audience_1080p_last1,\n      SUM(host_1080p_last1) AS host_1080p_last1,\n      SUM(host_2k_last1) AS host_2k_last1,\n      SUM(host_4k_last1) AS host_4k_last1,\n      SUM(total_last7) AS total_last7,\n      SUM(audio_last7) AS audio_last7,\n      SUM(video_last7) AS video_last7,\n      SUM(video_sd_last7) AS video_sd_last7,\n      SUM(video_hd_last7) AS video_hd_last7,\n      SUM(video_hdp_last7) AS video_hdp_last7,\n      SUM(host_sd_last7) AS host_sd_last7,\n      SUM(audience_sd_last7) AS audience_sd_last7,\n      SUM(host_hd_last7) AS host_hd_last7,\n      SUM(audience_hd_last7) AS audience_hd_last7,\n      SUM(host_hdp_last7) AS host_hdp_last7,\n      SUM(audience_hdp_last7) AS audience_hdp_last7,\n      SUM(host_audio_last7) AS host_audio_last7,\n      SUM(audience_audio_last7) AS audience_audio_last7,\n      SUM(host_video_last7) AS host_video_last7,\n      SUM(audience_video_last7) AS audience_video_last7,\n      SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n      SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n      SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n      SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n      SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n      SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n      SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n      SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n      SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n      SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n      SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n      SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n      SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n      SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n      SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n      SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n      SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n      SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n      SUM(audience_2k_last7) AS audience_2k_last7,\n      SUM(audience_4k_last7) AS audience_4k_last7,\n      SUM(audience_1080p_last7) AS audience_1080p_last7,\n      SUM(host_1080p_last7) AS host_1080p_last7,\n      SUM(host_2k_last7) AS host_2k_last7,\n      SUM(host_4k_last7) AS host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211113 AND date <= 20211212 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n    GROUP BY date,\n      DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n      2,\n      3,\n      tag,\n      area,\n      dim,\n      8,\n      9,\n      10,\n      level4,\n      product_level1,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en,\n      vid_use_case_en,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n          start_date AS start_date,\n          end_date AS end_date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          tag,\n          area AS Scope,\n          dim,\n            CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n            CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n            CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          browser,\n          browser_ver,\n          dim_grouping_name,\n          SUM(total) AS totalUsage,\n          SUM(audio) AS audio,\n          SUM(video) AS video,\n          SUM(host_sd + audience_sd) AS video_sd,\n          SUM(host_hd + audience_hd) AS video_hd,\n          SUM(host_hdp + audience_hdp) AS video_hdp,\n          SUM(host_audio) AS host_audio,\n          SUM(audience_audio) AS audience_audio,\n          SUM(host_sd) AS host_sd,\n          SUM(host_hd) AS host_hd,\n          SUM(host_hdp) AS host_hdp,\n          SUM(host_1080p) AS host_1080p,\n          SUM(host_2k) AS host_2k,\n          SUM(host_4k) AS host_4k,\n          SUM(audience_sd) AS audience_sd,\n          SUM(audience_hd) AS audience_hd,\n          SUM(audience_hdp) AS audience_hdp,\n          SUM(audience_1080p) AS audience_1080p,\n          SUM(audience_2k) AS audience_2k,\n          SUM(audience_4k) AS audience_4k,\n          SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n          SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n          SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n          SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n          SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n          SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n          SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n          SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n          SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n          SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n          SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n          SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n          SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n          SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n          SUM(total_last1) AS audio_video_last,\n          SUM(audio_last1) AS audio_last,\n          SUM(video_last1) AS video_last,\n          SUM(video_sd_last1) AS video_sd_last,\n          SUM(video_hd_last1) AS video_hd_last,\n          SUM(video_hdp_last1) AS video_hdp_last,\n          SUM(host_sd_last1) AS host_video_sd_last,\n          SUM(audience_sd_last1) AS audience_video_sd_last,\n          SUM(host_hd_last1) AS host_video_hd_last,\n          SUM(audience_hd_last1) AS audience_video_hd_last,\n          SUM(host_hdp_last1) AS host_video_hdp_last,\n          SUM(audience_hdp_last1) AS audience_video_hdp_last,\n          SUM(host_audio_last1) AS host_audio_last,\n          SUM(audience_audio_last1) AS audience_audio_last,\n          SUM(host_video_last1) AS host_video_last,\n          SUM(audience_video_last1) AS audience_video_last,\n          SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n          SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n          SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n          SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n          SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n          SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n          SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n          SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n          SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n          SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n          SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n          SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n          SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n          SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n          SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n          SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n          SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n          SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n          SUM(audience_2k_last1) AS audience_2k_last1,\n          SUM(audience_4k_last1) AS audience_4k_last1,\n          SUM(audience_1080p_last1) AS audience_1080p_last1,\n          SUM(host_1080p_last1) AS host_1080p_last1,\n          SUM(host_2k_last1) AS host_2k_last1,\n          SUM(host_4k_last1) AS host_4k_last1,\n          SUM(total_last7) AS total_last7,\n          SUM(audio_last7) AS audio_last7,\n          SUM(video_last7) AS video_last7,\n          SUM(video_sd_last7) AS video_sd_last7,\n          SUM(video_hd_last7) AS video_hd_last7,\n          SUM(video_hdp_last7) AS video_hdp_last7,\n          SUM(host_sd_last7) AS host_sd_last7,\n          SUM(audience_sd_last7) AS audience_sd_last7,\n          SUM(host_hd_last7) AS host_hd_last7,\n          SUM(audience_hd_last7) AS audience_hd_last7,\n          SUM(host_hdp_last7) AS host_hdp_last7,\n          SUM(audience_hdp_last7) AS audience_hdp_last7,\n          SUM(host_audio_last7) AS host_audio_last7,\n          SUM(audience_audio_last7) AS audience_audio_last7,\n          SUM(host_video_last7) AS host_video_last7,\n          SUM(audience_video_last7) AS audience_video_last7,\n          SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n          SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n          SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n          SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n          SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n          SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n          SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n          SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n          SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n          SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n          SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n          SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n          SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n          SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n          SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n          SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n          SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n          SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n          SUM(audience_2k_last7) AS audience_2k_last7,\n          SUM(audience_4k_last7) AS audience_4k_last7,\n          SUM(audience_1080p_last7) AS audience_1080p_last7,\n          SUM(host_1080p_last7) AS host_1080p_last7,\n          SUM(host_2k_last7) AS host_2k_last7,\n          SUM(host_4k_last7) AS host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211113 AND date <= 20211212 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n        GROUP BY date,\n          DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n          2,\n          3,\n          tag,\n          area,\n          dim,\n          8,\n          9,\n          10,\n          level4,\n          product_level1,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en,\n          vid_use_case_en,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          browser,\n          browser_ver,\n          dim_grouping_name) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE CAST(\"自定义 SQL 查询\".\"level1\" AS VARCHAR) = 'RTC' AND \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 3 AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 1,\n  2"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3054707207061430272)(2629536046)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_video_last\") AS \"TEMP(Calculation_3054707207061430272)(2820618408)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(日环比 (复制 2)_96897765685432324)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_last\") AS \"TEMP(日环比 (复制 2)_96897765685432324)(4091190060)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(日环比 (复制)_96897765685424131)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video_last\") AS \"TEMP(日环比 (复制)_96897765685424131)(3934387163)(0)\",\n  \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"sum_audio_ok\",\n  SUM(\"自定义 SQL 查询\".\"audio_video_last\") AS \"sum_audio_video_last_ok\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"sum_video_ok\"\nFROM (SELECT date,\n      start_date AS start_date,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name,\n      SUM(total) AS totalUsage,\n      SUM(audio) AS audio,\n      SUM(video) AS video,\n      SUM(host_sd + audience_sd) AS video_sd,\n      SUM(host_hd + audience_hd) AS video_hd,\n      SUM(host_hdp + audience_hdp) AS video_hdp,\n      SUM(host_audio) AS host_audio,\n      SUM(audience_audio) AS audience_audio,\n      SUM(host_sd) AS host_sd,\n      SUM(host_hd) AS host_hd,\n      SUM(host_hdp) AS host_hdp,\n      SUM(host_1080p) AS host_1080p,\n      SUM(host_2k) AS host_2k,\n      SUM(host_4k) AS host_4k,\n      SUM(audience_sd) AS audience_sd,\n      SUM(audience_hd) AS audience_hd,\n      SUM(audience_hdp) AS audience_hdp,\n      SUM(audience_1080p) AS audience_1080p,\n      SUM(audience_2k) AS audience_2k,\n      SUM(audience_4k) AS audience_4k,\n      SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n      SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n      SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n      SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n      SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n      SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n      SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n      SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n      SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n      SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n      SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n      SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n      SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n      SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n      SUM(total_last1) AS audio_video_last,\n      SUM(audio_last1) AS audio_last,\n      SUM(video_last1) AS video_last,\n      SUM(video_sd_last1) AS video_sd_last,\n      SUM(video_hd_last1) AS video_hd_last,\n      SUM(video_hdp_last1) AS video_hdp_last,\n      SUM(host_sd_last1) AS host_video_sd_last,\n      SUM(audience_sd_last1) AS audience_video_sd_last,\n      SUM(host_hd_last1) AS host_video_hd_last,\n      SUM(audience_hd_last1) AS audience_video_hd_last,\n      SUM(host_hdp_last1) AS host_video_hdp_last,\n      SUM(audience_hdp_last1) AS audience_video_hdp_last,\n      SUM(host_audio_last1) AS host_audio_last,\n      SUM(audience_audio_last1) AS audience_audio_last,\n      SUM(host_video_last1) AS host_video_last,\n      SUM(audience_video_last1) AS audience_video_last,\n      SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n      SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n      SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n      SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n      SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n      SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n      SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n      SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n      SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n      SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n      SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n      SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n      SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n      SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n      SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n      SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n      SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n      SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n      SUM(audience_2k_last1) AS audience_2k_last1,\n      SUM(audience_4k_last1) AS audience_4k_last1,\n      SUM(audience_1080p_last1) AS audience_1080p_last1,\n      SUM(host_1080p_last1) AS host_1080p_last1,\n      SUM(host_2k_last1) AS host_2k_last1,\n      SUM(host_4k_last1) AS host_4k_last1,\n      SUM(total_last7) AS total_last7,\n      SUM(audio_last7) AS audio_last7,\n      SUM(video_last7) AS video_last7,\n      SUM(video_sd_last7) AS video_sd_last7,\n      SUM(video_hd_last7) AS video_hd_last7,\n      SUM(video_hdp_last7) AS video_hdp_last7,\n      SUM(host_sd_last7) AS host_sd_last7,\n      SUM(audience_sd_last7) AS audience_sd_last7,\n      SUM(host_hd_last7) AS host_hd_last7,\n      SUM(audience_hd_last7) AS audience_hd_last7,\n      SUM(host_hdp_last7) AS host_hdp_last7,\n      SUM(audience_hdp_last7) AS audience_hdp_last7,\n      SUM(host_audio_last7) AS host_audio_last7,\n      SUM(audience_audio_last7) AS audience_audio_last7,\n      SUM(host_video_last7) AS host_video_last7,\n      SUM(audience_video_last7) AS audience_video_last7,\n      SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n      SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n      SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n      SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n      SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n      SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n      SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n      SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n      SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n      SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n      SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n      SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n      SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n      SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n      SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n      SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n      SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n      SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n      SUM(audience_2k_last7) AS audience_2k_last7,\n      SUM(audience_4k_last7) AS audience_4k_last7,\n      SUM(audience_1080p_last7) AS audience_1080p_last7,\n      SUM(host_1080p_last7) AS host_1080p_last7,\n      SUM(host_2k_last7) AS host_2k_last7,\n      SUM(host_4k_last7) AS host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211113 AND date <= 20211212 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n    GROUP BY date,\n      DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n      2,\n      3,\n      tag,\n      area,\n      dim,\n      8,\n      9,\n      10,\n      level4,\n      product_level1,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en,\n      vid_use_case_en,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n          start_date AS start_date,\n          end_date AS end_date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          tag,\n          area AS Scope,\n          dim,\n            CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n            CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n            CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          browser,\n          browser_ver,\n          dim_grouping_name,\n          SUM(total) AS totalUsage,\n          SUM(audio) AS audio,\n          SUM(video) AS video,\n          SUM(host_sd + audience_sd) AS video_sd,\n          SUM(host_hd + audience_hd) AS video_hd,\n          SUM(host_hdp + audience_hdp) AS video_hdp,\n          SUM(host_audio) AS host_audio,\n          SUM(audience_audio) AS audience_audio,\n          SUM(host_sd) AS host_sd,\n          SUM(host_hd) AS host_hd,\n          SUM(host_hdp) AS host_hdp,\n          SUM(host_1080p) AS host_1080p,\n          SUM(host_2k) AS host_2k,\n          SUM(host_4k) AS host_4k,\n          SUM(audience_sd) AS audience_sd,\n          SUM(audience_hd) AS audience_hd,\n          SUM(audience_hdp) AS audience_hdp,\n          SUM(audience_1080p) AS audience_1080p,\n          SUM(audience_2k) AS audience_2k,\n          SUM(audience_4k) AS audience_4k,\n          SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n          SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n          SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n          SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n          SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n          SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n          SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n          SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n          SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n          SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n          SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n          SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n          SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n          SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n          SUM(total_last1) AS audio_video_last,\n          SUM(audio_last1) AS audio_last,\n          SUM(video_last1) AS video_last,\n          SUM(video_sd_last1) AS video_sd_last,\n          SUM(video_hd_last1) AS video_hd_last,\n          SUM(video_hdp_last1) AS video_hdp_last,\n          SUM(host_sd_last1) AS host_video_sd_last,\n          SUM(audience_sd_last1) AS audience_video_sd_last,\n          SUM(host_hd_last1) AS host_video_hd_last,\n          SUM(audience_hd_last1) AS audience_video_hd_last,\n          SUM(host_hdp_last1) AS host_video_hdp_last,\n          SUM(audience_hdp_last1) AS audience_video_hdp_last,\n          SUM(host_audio_last1) AS host_audio_last,\n          SUM(audience_audio_last1) AS audience_audio_last,\n          SUM(host_video_last1) AS host_video_last,\n          SUM(audience_video_last1) AS audience_video_last,\n          SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n          SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n          SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n          SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n          SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n          SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n          SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n          SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n          SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n          SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n          SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n          SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n          SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n          SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n          SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n          SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n          SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n          SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n          SUM(audience_2k_last1) AS audience_2k_last1,\n          SUM(audience_4k_last1) AS audience_4k_last1,\n          SUM(audience_1080p_last1) AS audience_1080p_last1,\n          SUM(host_1080p_last1) AS host_1080p_last1,\n          SUM(host_2k_last1) AS host_2k_last1,\n          SUM(host_4k_last1) AS host_4k_last1,\n          SUM(total_last7) AS total_last7,\n          SUM(audio_last7) AS audio_last7,\n          SUM(video_last7) AS video_last7,\n          SUM(video_sd_last7) AS video_sd_last7,\n          SUM(video_hd_last7) AS video_hd_last7,\n          SUM(video_hdp_last7) AS video_hdp_last7,\n          SUM(host_sd_last7) AS host_sd_last7,\n          SUM(audience_sd_last7) AS audience_sd_last7,\n          SUM(host_hd_last7) AS host_hd_last7,\n          SUM(audience_hd_last7) AS audience_hd_last7,\n          SUM(host_hdp_last7) AS host_hdp_last7,\n          SUM(audience_hdp_last7) AS audience_hdp_last7,\n          SUM(host_audio_last7) AS host_audio_last7,\n          SUM(audience_audio_last7) AS audience_audio_last7,\n          SUM(host_video_last7) AS host_video_last7,\n          SUM(audience_video_last7) AS audience_video_last7,\n          SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n          SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n          SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n          SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n          SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n          SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n          SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n          SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n          SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n          SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n          SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n          SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n          SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n          SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n          SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n          SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n          SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n          SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n          SUM(audience_2k_last7) AS audience_2k_last7,\n          SUM(audience_4k_last7) AS audience_4k_last7,\n          SUM(audience_1080p_last7) AS audience_1080p_last7,\n          SUM(host_1080p_last7) AS host_1080p_last7,\n          SUM(host_2k_last7) AS host_2k_last7,\n          SUM(host_4k_last7) AS host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211113 AND date <= 20211212 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n        GROUP BY date,\n          DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n          2,\n          3,\n          tag,\n          area,\n          dim,\n          8,\n          9,\n          10,\n          level4,\n          product_level1,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en,\n          vid_use_case_en,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          browser,\n          browser_ver,\n          dim_grouping_name) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE CAST(\"自定义 SQL 查询\".\"level1\" AS VARCHAR) = 'RTC' AND \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 3 AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 7"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700079370244)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700079370244)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700079370244)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700079370244)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700079370244)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700079370244)(943764407)(0)\",\n  MIN(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(1482809429)(0)\",\n  MIN(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(3765460736)(0)\",\n  \"自定义 SQL 查询\".\"stat_date\" AS \"TEMP(attr_stat_date_nk)(2102638629)(0)\",\n  \"自定义 SQL 查询\".\"stat_date\" AS \"TEMP(attr_stat_date_nk)(2790680713)(0)\",\n  \"自定义 SQL 查询\".\"stat_date\" AS \"stat_date\",\n  \"自定义 SQL 查询\".\"vid_use_case_cn\" AS \"vid_use_case_cn\"\nFROM (SELECT date,\n      start_date AS start_date,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name,\n      SUM(total) AS totalUsage,\n      SUM(audio) AS audio,\n      SUM(video) AS video,\n      SUM(host_sd + audience_sd) AS video_sd,\n      SUM(host_hd + audience_hd) AS video_hd,\n      SUM(host_hdp + audience_hdp) AS video_hdp,\n      SUM(host_audio) AS host_audio,\n      SUM(audience_audio) AS audience_audio,\n      SUM(host_sd) AS host_sd,\n      SUM(host_hd) AS host_hd,\n      SUM(host_hdp) AS host_hdp,\n      SUM(host_1080p) AS host_1080p,\n      SUM(host_2k) AS host_2k,\n      SUM(host_4k) AS host_4k,\n      SUM(audience_sd) AS audience_sd,\n      SUM(audience_hd) AS audience_hd,\n      SUM(audience_hdp) AS audience_hdp,\n      SUM(audience_1080p) AS audience_1080p,\n      SUM(audience_2k) AS audience_2k,\n      SUM(audience_4k) AS audience_4k,\n      SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n      SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n      SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n      SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n      SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n      SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n      SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n      SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n      SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n      SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n      SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n      SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n      SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n      SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n      SUM(total_last1) AS audio_video_last,\n      SUM(audio_last1) AS audio_last,\n      SUM(video_last1) AS video_last,\n      SUM(video_sd_last1) AS video_sd_last,\n      SUM(video_hd_last1) AS video_hd_last,\n      SUM(video_hdp_last1) AS video_hdp_last,\n      SUM(host_sd_last1) AS host_video_sd_last,\n      SUM(audience_sd_last1) AS audience_video_sd_last,\n      SUM(host_hd_last1) AS host_video_hd_last,\n      SUM(audience_hd_last1) AS audience_video_hd_last,\n      SUM(host_hdp_last1) AS host_video_hdp_last,\n      SUM(audience_hdp_last1) AS audience_video_hdp_last,\n      SUM(host_audio_last1) AS host_audio_last,\n      SUM(audience_audio_last1) AS audience_audio_last,\n      SUM(host_video_last1) AS host_video_last,\n      SUM(audience_video_last1) AS audience_video_last,\n      SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n      SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n      SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n      SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n      SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n      SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n      SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n      SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n      SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n      SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n      SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n      SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n      SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n      SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n      SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n      SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n      SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n      SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n      SUM(audience_2k_last1) AS audience_2k_last1,\n      SUM(audience_4k_last1) AS audience_4k_last1,\n      SUM(audience_1080p_last1) AS audience_1080p_last1,\n      SUM(host_1080p_last1) AS host_1080p_last1,\n      SUM(host_2k_last1) AS host_2k_last1,\n      SUM(host_4k_last1) AS host_4k_last1,\n      SUM(total_last7) AS total_last7,\n      SUM(audio_last7) AS audio_last7,\n      SUM(video_last7) AS video_last7,\n      SUM(video_sd_last7) AS video_sd_last7,\n      SUM(video_hd_last7) AS video_hd_last7,\n      SUM(video_hdp_last7) AS video_hdp_last7,\n      SUM(host_sd_last7) AS host_sd_last7,\n      SUM(audience_sd_last7) AS audience_sd_last7,\n      SUM(host_hd_last7) AS host_hd_last7,\n      SUM(audience_hd_last7) AS audience_hd_last7,\n      SUM(host_hdp_last7) AS host_hdp_last7,\n      SUM(audience_hdp_last7) AS audience_hdp_last7,\n      SUM(host_audio_last7) AS host_audio_last7,\n      SUM(audience_audio_last7) AS audience_audio_last7,\n      SUM(host_video_last7) AS host_video_last7,\n      SUM(audience_video_last7) AS audience_video_last7,\n      SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n      SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n      SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n      SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n      SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n      SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n      SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n      SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n      SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n      SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n      SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n      SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n      SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n      SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n      SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n      SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n      SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n      SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n      SUM(audience_2k_last7) AS audience_2k_last7,\n      SUM(audience_4k_last7) AS audience_4k_last7,\n      SUM(audience_1080p_last7) AS audience_1080p_last7,\n      SUM(host_1080p_last7) AS host_1080p_last7,\n      SUM(host_2k_last7) AS host_2k_last7,\n      SUM(host_4k_last7) AS host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211113 AND date <= 20211212 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n    GROUP BY date,\n      DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n      2,\n      3,\n      tag,\n      area,\n      dim,\n      8,\n      9,\n      10,\n      level4,\n      product_level1,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en,\n      vid_use_case_en,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n          start_date AS start_date,\n          end_date AS end_date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          tag,\n          area AS Scope,\n          dim,\n            CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n            CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n            CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          browser,\n          browser_ver,\n          dim_grouping_name,\n          SUM(total) AS totalUsage,\n          SUM(audio) AS audio,\n          SUM(video) AS video,\n          SUM(host_sd + audience_sd) AS video_sd,\n          SUM(host_hd + audience_hd) AS video_hd,\n          SUM(host_hdp + audience_hdp) AS video_hdp,\n          SUM(host_audio) AS host_audio,\n          SUM(audience_audio) AS audience_audio,\n          SUM(host_sd) AS host_sd,\n          SUM(host_hd) AS host_hd,\n          SUM(host_hdp) AS host_hdp,\n          SUM(host_1080p) AS host_1080p,\n          SUM(host_2k) AS host_2k,\n          SUM(host_4k) AS host_4k,\n          SUM(audience_sd) AS audience_sd,\n          SUM(audience_hd) AS audience_hd,\n          SUM(audience_hdp) AS audience_hdp,\n          SUM(audience_1080p) AS audience_1080p,\n          SUM(audience_2k) AS audience_2k,\n          SUM(audience_4k) AS audience_4k,\n          SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n          SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n          SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n          SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n          SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n          SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n          SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n          SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n          SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n          SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n          SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n          SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n          SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n          SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n          SUM(total_last1) AS audio_video_last,\n          SUM(audio_last1) AS audio_last,\n          SUM(video_last1) AS video_last,\n          SUM(video_sd_last1) AS video_sd_last,\n          SUM(video_hd_last1) AS video_hd_last,\n          SUM(video_hdp_last1) AS video_hdp_last,\n          SUM(host_sd_last1) AS host_video_sd_last,\n          SUM(audience_sd_last1) AS audience_video_sd_last,\n          SUM(host_hd_last1) AS host_video_hd_last,\n          SUM(audience_hd_last1) AS audience_video_hd_last,\n          SUM(host_hdp_last1) AS host_video_hdp_last,\n          SUM(audience_hdp_last1) AS audience_video_hdp_last,\n          SUM(host_audio_last1) AS host_audio_last,\n          SUM(audience_audio_last1) AS audience_audio_last,\n          SUM(host_video_last1) AS host_video_last,\n          SUM(audience_video_last1) AS audience_video_last,\n          SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n          SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n          SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n          SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n          SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n          SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n          SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n          SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n          SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n          SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n          SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n          SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n          SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n          SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n          SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n          SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n          SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n          SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n          SUM(audience_2k_last1) AS audience_2k_last1,\n          SUM(audience_4k_last1) AS audience_4k_last1,\n          SUM(audience_1080p_last1) AS audience_1080p_last1,\n          SUM(host_1080p_last1) AS host_1080p_last1,\n          SUM(host_2k_last1) AS host_2k_last1,\n          SUM(host_4k_last1) AS host_4k_last1,\n          SUM(total_last7) AS total_last7,\n          SUM(audio_last7) AS audio_last7,\n          SUM(video_last7) AS video_last7,\n          SUM(video_sd_last7) AS video_sd_last7,\n          SUM(video_hd_last7) AS video_hd_last7,\n          SUM(video_hdp_last7) AS video_hdp_last7,\n          SUM(host_sd_last7) AS host_sd_last7,\n          SUM(audience_sd_last7) AS audience_sd_last7,\n          SUM(host_hd_last7) AS host_hd_last7,\n          SUM(audience_hd_last7) AS audience_hd_last7,\n          SUM(host_hdp_last7) AS host_hdp_last7,\n          SUM(audience_hdp_last7) AS audience_hdp_last7,\n          SUM(host_audio_last7) AS host_audio_last7,\n          SUM(audience_audio_last7) AS audience_audio_last7,\n          SUM(host_video_last7) AS host_video_last7,\n          SUM(audience_video_last7) AS audience_video_last7,\n          SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n          SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n          SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n          SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n          SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n          SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n          SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n          SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n          SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n          SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n          SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n          SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n          SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n          SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n          SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n          SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n          SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n          SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n          SUM(audience_2k_last7) AS audience_2k_last7,\n          SUM(audience_4k_last7) AS audience_4k_last7,\n          SUM(audience_1080p_last7) AS audience_1080p_last7,\n          SUM(host_1080p_last7) AS host_1080p_last7,\n          SUM(host_2k_last7) AS host_2k_last7,\n          SUM(host_4k_last7) AS host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211113 AND date <= 20211212 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n        GROUP BY date,\n          DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n          2,\n          3,\n          tag,\n          area,\n          dim,\n          8,\n          9,\n          10,\n          level4,\n          product_level1,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en,\n          vid_use_case_en,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          browser,\n          browser_ver,\n          dim_grouping_name) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 3 AND CAST(\"自定义 SQL 查询\".\"level1\" AS VARCHAR) = 'RTC' AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 20,\n  23"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700079370244)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700079370244)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700079370244)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700079370244)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700079370244)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700079370244)(943764407)(0)\",\n  MIN(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(1482809429)(0)\",\n  MIN(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(3765460736)(0)\",\n  \"自定义 SQL 查询\".\"product_level2\" AS \"product_level2\",\n  \"自定义 SQL 查询\".\"stat_date\" AS \"stat_date\"\nFROM (SELECT date,\n      start_date AS start_date,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name,\n      SUM(total) AS totalUsage,\n      SUM(audio) AS audio,\n      SUM(video) AS video,\n      SUM(host_sd + audience_sd) AS video_sd,\n      SUM(host_hd + audience_hd) AS video_hd,\n      SUM(host_hdp + audience_hdp) AS video_hdp,\n      SUM(host_audio) AS host_audio,\n      SUM(audience_audio) AS audience_audio,\n      SUM(host_sd) AS host_sd,\n      SUM(host_hd) AS host_hd,\n      SUM(host_hdp) AS host_hdp,\n      SUM(host_1080p) AS host_1080p,\n      SUM(host_2k) AS host_2k,\n      SUM(host_4k) AS host_4k,\n      SUM(audience_sd) AS audience_sd,\n      SUM(audience_hd) AS audience_hd,\n      SUM(audience_hdp) AS audience_hdp,\n      SUM(audience_1080p) AS audience_1080p,\n      SUM(audience_2k) AS audience_2k,\n      SUM(audience_4k) AS audience_4k,\n      SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n      SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n      SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n      SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n      SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n      SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n      SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n      SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n      SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n      SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n      SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n      SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n      SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n      SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n      SUM(total_last1) AS audio_video_last,\n      SUM(audio_last1) AS audio_last,\n      SUM(video_last1) AS video_last,\n      SUM(video_sd_last1) AS video_sd_last,\n      SUM(video_hd_last1) AS video_hd_last,\n      SUM(video_hdp_last1) AS video_hdp_last,\n      SUM(host_sd_last1) AS host_video_sd_last,\n      SUM(audience_sd_last1) AS audience_video_sd_last,\n      SUM(host_hd_last1) AS host_video_hd_last,\n      SUM(audience_hd_last1) AS audience_video_hd_last,\n      SUM(host_hdp_last1) AS host_video_hdp_last,\n      SUM(audience_hdp_last1) AS audience_video_hdp_last,\n      SUM(host_audio_last1) AS host_audio_last,\n      SUM(audience_audio_last1) AS audience_audio_last,\n      SUM(host_video_last1) AS host_video_last,\n      SUM(audience_video_last1) AS audience_video_last,\n      SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n      SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n      SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n      SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n      SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n      SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n      SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n      SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n      SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n      SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n      SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n      SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n      SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n      SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n      SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n      SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n      SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n      SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n      SUM(audience_2k_last1) AS audience_2k_last1,\n      SUM(audience_4k_last1) AS audience_4k_last1,\n      SUM(audience_1080p_last1) AS audience_1080p_last1,\n      SUM(host_1080p_last1) AS host_1080p_last1,\n      SUM(host_2k_last1) AS host_2k_last1,\n      SUM(host_4k_last1) AS host_4k_last1,\n      SUM(total_last7) AS total_last7,\n      SUM(audio_last7) AS audio_last7,\n      SUM(video_last7) AS video_last7,\n      SUM(video_sd_last7) AS video_sd_last7,\n      SUM(video_hd_last7) AS video_hd_last7,\n      SUM(video_hdp_last7) AS video_hdp_last7,\n      SUM(host_sd_last7) AS host_sd_last7,\n      SUM(audience_sd_last7) AS audience_sd_last7,\n      SUM(host_hd_last7) AS host_hd_last7,\n      SUM(audience_hd_last7) AS audience_hd_last7,\n      SUM(host_hdp_last7) AS host_hdp_last7,\n      SUM(audience_hdp_last7) AS audience_hdp_last7,\n      SUM(host_audio_last7) AS host_audio_last7,\n      SUM(audience_audio_last7) AS audience_audio_last7,\n      SUM(host_video_last7) AS host_video_last7,\n      SUM(audience_video_last7) AS audience_video_last7,\n      SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n      SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n      SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n      SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n      SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n      SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n      SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n      SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n      SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n      SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n      SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n      SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n      SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n      SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n      SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n      SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n      SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n      SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n      SUM(audience_2k_last7) AS audience_2k_last7,\n      SUM(audience_4k_last7) AS audience_4k_last7,\n      SUM(audience_1080p_last7) AS audience_1080p_last7,\n      SUM(host_1080p_last7) AS host_1080p_last7,\n      SUM(host_2k_last7) AS host_2k_last7,\n      SUM(host_4k_last7) AS host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211113 AND date <= 20211212 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n    GROUP BY date,\n      DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n      2,\n      3,\n      tag,\n      area,\n      dim,\n      8,\n      9,\n      10,\n      level4,\n      product_level1,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en,\n      vid_use_case_en,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n          start_date AS start_date,\n          end_date AS end_date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          tag,\n          area AS Scope,\n          dim,\n            CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n            CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n            CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          browser,\n          browser_ver,\n          dim_grouping_name,\n          SUM(total) AS totalUsage,\n          SUM(audio) AS audio,\n          SUM(video) AS video,\n          SUM(host_sd + audience_sd) AS video_sd,\n          SUM(host_hd + audience_hd) AS video_hd,\n          SUM(host_hdp + audience_hdp) AS video_hdp,\n          SUM(host_audio) AS host_audio,\n          SUM(audience_audio) AS audience_audio,\n          SUM(host_sd) AS host_sd,\n          SUM(host_hd) AS host_hd,\n          SUM(host_hdp) AS host_hdp,\n          SUM(host_1080p) AS host_1080p,\n          SUM(host_2k) AS host_2k,\n          SUM(host_4k) AS host_4k,\n          SUM(audience_sd) AS audience_sd,\n          SUM(audience_hd) AS audience_hd,\n          SUM(audience_hdp) AS audience_hdp,\n          SUM(audience_1080p) AS audience_1080p,\n          SUM(audience_2k) AS audience_2k,\n          SUM(audience_4k) AS audience_4k,\n          SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n          SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n          SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n          SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n          SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n          SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n          SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n          SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n          SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n          SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n          SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n          SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n          SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n          SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n          SUM(total_last1) AS audio_video_last,\n          SUM(audio_last1) AS audio_last,\n          SUM(video_last1) AS video_last,\n          SUM(video_sd_last1) AS video_sd_last,\n          SUM(video_hd_last1) AS video_hd_last,\n          SUM(video_hdp_last1) AS video_hdp_last,\n          SUM(host_sd_last1) AS host_video_sd_last,\n          SUM(audience_sd_last1) AS audience_video_sd_last,\n          SUM(host_hd_last1) AS host_video_hd_last,\n          SUM(audience_hd_last1) AS audience_video_hd_last,\n          SUM(host_hdp_last1) AS host_video_hdp_last,\n          SUM(audience_hdp_last1) AS audience_video_hdp_last,\n          SUM(host_audio_last1) AS host_audio_last,\n          SUM(audience_audio_last1) AS audience_audio_last,\n          SUM(host_video_last1) AS host_video_last,\n          SUM(audience_video_last1) AS audience_video_last,\n          SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n          SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n          SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n          SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n          SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n          SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n          SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n          SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n          SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n          SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n          SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n          SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n          SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n          SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n          SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n          SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n          SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n          SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n          SUM(audience_2k_last1) AS audience_2k_last1,\n          SUM(audience_4k_last1) AS audience_4k_last1,\n          SUM(audience_1080p_last1) AS audience_1080p_last1,\n          SUM(host_1080p_last1) AS host_1080p_last1,\n          SUM(host_2k_last1) AS host_2k_last1,\n          SUM(host_4k_last1) AS host_4k_last1,\n          SUM(total_last7) AS total_last7,\n          SUM(audio_last7) AS audio_last7,\n          SUM(video_last7) AS video_last7,\n          SUM(video_sd_last7) AS video_sd_last7,\n          SUM(video_hd_last7) AS video_hd_last7,\n          SUM(video_hdp_last7) AS video_hdp_last7,\n          SUM(host_sd_last7) AS host_sd_last7,\n          SUM(audience_sd_last7) AS audience_sd_last7,\n          SUM(host_hd_last7) AS host_hd_last7,\n          SUM(audience_hd_last7) AS audience_hd_last7,\n          SUM(host_hdp_last7) AS host_hdp_last7,\n          SUM(audience_hdp_last7) AS audience_hdp_last7,\n          SUM(host_audio_last7) AS host_audio_last7,\n          SUM(audience_audio_last7) AS audience_audio_last7,\n          SUM(host_video_last7) AS host_video_last7,\n          SUM(audience_video_last7) AS audience_video_last7,\n          SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n          SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n          SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n          SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n          SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n          SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n          SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n          SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n          SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n          SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n          SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n          SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n          SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n          SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n          SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n          SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n          SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n          SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n          SUM(audience_2k_last7) AS audience_2k_last7,\n          SUM(audience_4k_last7) AS audience_4k_last7,\n          SUM(audience_1080p_last7) AS audience_1080p_last7,\n          SUM(host_1080p_last7) AS host_1080p_last7,\n          SUM(host_2k_last7) AS host_2k_last7,\n          SUM(host_4k_last7) AS host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211113 AND date <= 20211212 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n        GROUP BY date,\n          DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n          2,\n          3,\n          tag,\n          area,\n          dim,\n          8,\n          9,\n          10,\n          level4,\n          product_level1,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en,\n          vid_use_case_en,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          browser,\n          browser_ver,\n          dim_grouping_name) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 3 AND CAST(\"自定义 SQL 查询\".\"level1\" AS VARCHAR) = 'RTC' AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 20,\n  21"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700079370244)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700079370244)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700079370244)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700079370244)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700079370244)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700079370244)(943764407)(0)\",\n  MIN(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(1482809429)(0)\",\n  MIN(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(3765460736)(0)\",\n  MAX(\"自定义 SQL 查询\".\"stat_date\") AS \"TEMP(attr_stat_date_nk)(2102638629)(0)\",\n  MIN(\"自定义 SQL 查询\".\"stat_date\") AS \"TEMP(attr_stat_date_nk)(2790680713)(0)\",\n  \"自定义 SQL 查询\".\"cid_industry\" AS \"cid_industry\"\nFROM (SELECT date,\n      start_date AS start_date,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name,\n      SUM(total) AS totalUsage,\n      SUM(audio) AS audio,\n      SUM(video) AS video,\n      SUM(host_sd + audience_sd) AS video_sd,\n      SUM(host_hd + audience_hd) AS video_hd,\n      SUM(host_hdp + audience_hdp) AS video_hdp,\n      SUM(host_audio) AS host_audio,\n      SUM(audience_audio) AS audience_audio,\n      SUM(host_sd) AS host_sd,\n      SUM(host_hd) AS host_hd,\n      SUM(host_hdp) AS host_hdp,\n      SUM(host_1080p) AS host_1080p,\n      SUM(host_2k) AS host_2k,\n      SUM(host_4k) AS host_4k,\n      SUM(audience_sd) AS audience_sd,\n      SUM(audience_hd) AS audience_hd,\n      SUM(audience_hdp) AS audience_hdp,\n      SUM(audience_1080p) AS audience_1080p,\n      SUM(audience_2k) AS audience_2k,\n      SUM(audience_4k) AS audience_4k,\n      SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n      SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n      SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n      SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n      SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n      SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n      SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n      SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n      SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n      SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n      SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n      SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n      SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n      SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n      SUM(total_last1) AS audio_video_last,\n      SUM(audio_last1) AS audio_last,\n      SUM(video_last1) AS video_last,\n      SUM(video_sd_last1) AS video_sd_last,\n      SUM(video_hd_last1) AS video_hd_last,\n      SUM(video_hdp_last1) AS video_hdp_last,\n      SUM(host_sd_last1) AS host_video_sd_last,\n      SUM(audience_sd_last1) AS audience_video_sd_last,\n      SUM(host_hd_last1) AS host_video_hd_last,\n      SUM(audience_hd_last1) AS audience_video_hd_last,\n      SUM(host_hdp_last1) AS host_video_hdp_last,\n      SUM(audience_hdp_last1) AS audience_video_hdp_last,\n      SUM(host_audio_last1) AS host_audio_last,\n      SUM(audience_audio_last1) AS audience_audio_last,\n      SUM(host_video_last1) AS host_video_last,\n      SUM(audience_video_last1) AS audience_video_last,\n      SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n      SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n      SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n      SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n      SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n      SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n      SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n      SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n      SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n      SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n      SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n      SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n      SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n      SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n      SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n      SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n      SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n      SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n      SUM(audience_2k_last1) AS audience_2k_last1,\n      SUM(audience_4k_last1) AS audience_4k_last1,\n      SUM(audience_1080p_last1) AS audience_1080p_last1,\n      SUM(host_1080p_last1) AS host_1080p_last1,\n      SUM(host_2k_last1) AS host_2k_last1,\n      SUM(host_4k_last1) AS host_4k_last1,\n      SUM(total_last7) AS total_last7,\n      SUM(audio_last7) AS audio_last7,\n      SUM(video_last7) AS video_last7,\n      SUM(video_sd_last7) AS video_sd_last7,\n      SUM(video_hd_last7) AS video_hd_last7,\n      SUM(video_hdp_last7) AS video_hdp_last7,\n      SUM(host_sd_last7) AS host_sd_last7,\n      SUM(audience_sd_last7) AS audience_sd_last7,\n      SUM(host_hd_last7) AS host_hd_last7,\n      SUM(audience_hd_last7) AS audience_hd_last7,\n      SUM(host_hdp_last7) AS host_hdp_last7,\n      SUM(audience_hdp_last7) AS audience_hdp_last7,\n      SUM(host_audio_last7) AS host_audio_last7,\n      SUM(audience_audio_last7) AS audience_audio_last7,\n      SUM(host_video_last7) AS host_video_last7,\n      SUM(audience_video_last7) AS audience_video_last7,\n      SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n      SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n      SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n      SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n      SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n      SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n      SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n      SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n      SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n      SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n      SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n      SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n      SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n      SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n      SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n      SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n      SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n      SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n      SUM(audience_2k_last7) AS audience_2k_last7,\n      SUM(audience_4k_last7) AS audience_4k_last7,\n      SUM(audience_1080p_last7) AS audience_1080p_last7,\n      SUM(host_1080p_last7) AS host_1080p_last7,\n      SUM(host_2k_last7) AS host_2k_last7,\n      SUM(host_4k_last7) AS host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211113 AND date <= 20211212 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n    GROUP BY date,\n      DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n      2,\n      3,\n      tag,\n      area,\n      dim,\n      8,\n      9,\n      10,\n      level4,\n      product_level1,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en,\n      vid_use_case_en,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n          start_date AS start_date,\n          end_date AS end_date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          tag,\n          area AS Scope,\n          dim,\n            CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n            CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n            CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          browser,\n          browser_ver,\n          dim_grouping_name,\n          SUM(total) AS totalUsage,\n          SUM(audio) AS audio,\n          SUM(video) AS video,\n          SUM(host_sd + audience_sd) AS video_sd,\n          SUM(host_hd + audience_hd) AS video_hd,\n          SUM(host_hdp + audience_hdp) AS video_hdp,\n          SUM(host_audio) AS host_audio,\n          SUM(audience_audio) AS audience_audio,\n          SUM(host_sd) AS host_sd,\n          SUM(host_hd) AS host_hd,\n          SUM(host_hdp) AS host_hdp,\n          SUM(host_1080p) AS host_1080p,\n          SUM(host_2k) AS host_2k,\n          SUM(host_4k) AS host_4k,\n          SUM(audience_sd) AS audience_sd,\n          SUM(audience_hd) AS audience_hd,\n          SUM(audience_hdp) AS audience_hdp,\n          SUM(audience_1080p) AS audience_1080p,\n          SUM(audience_2k) AS audience_2k,\n          SUM(audience_4k) AS audience_4k,\n          SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n          SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n          SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n          SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n          SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n          SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n          SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n          SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n          SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n          SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n          SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n          SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n          SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n          SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n          SUM(total_last1) AS audio_video_last,\n          SUM(audio_last1) AS audio_last,\n          SUM(video_last1) AS video_last,\n          SUM(video_sd_last1) AS video_sd_last,\n          SUM(video_hd_last1) AS video_hd_last,\n          SUM(video_hdp_last1) AS video_hdp_last,\n          SUM(host_sd_last1) AS host_video_sd_last,\n          SUM(audience_sd_last1) AS audience_video_sd_last,\n          SUM(host_hd_last1) AS host_video_hd_last,\n          SUM(audience_hd_last1) AS audience_video_hd_last,\n          SUM(host_hdp_last1) AS host_video_hdp_last,\n          SUM(audience_hdp_last1) AS audience_video_hdp_last,\n          SUM(host_audio_last1) AS host_audio_last,\n          SUM(audience_audio_last1) AS audience_audio_last,\n          SUM(host_video_last1) AS host_video_last,\n          SUM(audience_video_last1) AS audience_video_last,\n          SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n          SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n          SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n          SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n          SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n          SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n          SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n          SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n          SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n          SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n          SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n          SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n          SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n          SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n          SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n          SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n          SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n          SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n          SUM(audience_2k_last1) AS audience_2k_last1,\n          SUM(audience_4k_last1) AS audience_4k_last1,\n          SUM(audience_1080p_last1) AS audience_1080p_last1,\n          SUM(host_1080p_last1) AS host_1080p_last1,\n          SUM(host_2k_last1) AS host_2k_last1,\n          SUM(host_4k_last1) AS host_4k_last1,\n          SUM(total_last7) AS total_last7,\n          SUM(audio_last7) AS audio_last7,\n          SUM(video_last7) AS video_last7,\n          SUM(video_sd_last7) AS video_sd_last7,\n          SUM(video_hd_last7) AS video_hd_last7,\n          SUM(video_hdp_last7) AS video_hdp_last7,\n          SUM(host_sd_last7) AS host_sd_last7,\n          SUM(audience_sd_last7) AS audience_sd_last7,\n          SUM(host_hd_last7) AS host_hd_last7,\n          SUM(audience_hd_last7) AS audience_hd_last7,\n          SUM(host_hdp_last7) AS host_hdp_last7,\n          SUM(audience_hdp_last7) AS audience_hdp_last7,\n          SUM(host_audio_last7) AS host_audio_last7,\n          SUM(audience_audio_last7) AS audience_audio_last7,\n          SUM(host_video_last7) AS host_video_last7,\n          SUM(audience_video_last7) AS audience_video_last7,\n          SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n          SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n          SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n          SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n          SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n          SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n          SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n          SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n          SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n          SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n          SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n          SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n          SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n          SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n          SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n          SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n          SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n          SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n          SUM(audience_2k_last7) AS audience_2k_last7,\n          SUM(audience_4k_last7) AS audience_4k_last7,\n          SUM(audience_1080p_last7) AS audience_1080p_last7,\n          SUM(host_1080p_last7) AS host_1080p_last7,\n          SUM(host_2k_last7) AS host_2k_last7,\n          SUM(host_4k_last7) AS host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211113 AND date <= 20211212 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n        GROUP BY date,\n          DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n          2,\n          3,\n          tag,\n          area,\n          dim,\n          8,\n          9,\n          10,\n          level4,\n          product_level1,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en,\n          vid_use_case_en,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          browser,\n          browser_ver,\n          dim_grouping_name) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 3 AND CAST(\"自定义 SQL 查询\".\"level1\" AS VARCHAR) = 'RTC' AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 22"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700079370244)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700079370244)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700079370244)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700079370244)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700079370244)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700079370244)(943764407)(0)\",\n  MIN(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(1482809429)(0)\",\n  MIN(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(3765460736)(0)\",\n  \"自定义 SQL 查询\".\"product_level3\" AS \"TEMP(attr_product_level3_nk)(1428376059)(0)\",\n  \"自定义 SQL 查询\".\"product_level3\" AS \"TEMP(attr_product_level3_nk)(3667766967)(0)\",\n  \"自定义 SQL 查询\".\"product_level3\" AS \"product_level3\",\n  \"自定义 SQL 查询\".\"stat_date\" AS \"stat_date\"\nFROM (SELECT date,\n      start_date AS start_date,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name,\n      SUM(total) AS totalUsage,\n      SUM(audio) AS audio,\n      SUM(video) AS video,\n      SUM(host_sd + audience_sd) AS video_sd,\n      SUM(host_hd + audience_hd) AS video_hd,\n      SUM(host_hdp + audience_hdp) AS video_hdp,\n      SUM(host_audio) AS host_audio,\n      SUM(audience_audio) AS audience_audio,\n      SUM(host_sd) AS host_sd,\n      SUM(host_hd) AS host_hd,\n      SUM(host_hdp) AS host_hdp,\n      SUM(host_1080p) AS host_1080p,\n      SUM(host_2k) AS host_2k,\n      SUM(host_4k) AS host_4k,\n      SUM(audience_sd) AS audience_sd,\n      SUM(audience_hd) AS audience_hd,\n      SUM(audience_hdp) AS audience_hdp,\n      SUM(audience_1080p) AS audience_1080p,\n      SUM(audience_2k) AS audience_2k,\n      SUM(audience_4k) AS audience_4k,\n      SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n      SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n      SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n      SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n      SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n      SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n      SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n      SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n      SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n      SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n      SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n      SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n      SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n      SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n      SUM(total_last1) AS audio_video_last,\n      SUM(audio_last1) AS audio_last,\n      SUM(video_last1) AS video_last,\n      SUM(video_sd_last1) AS video_sd_last,\n      SUM(video_hd_last1) AS video_hd_last,\n      SUM(video_hdp_last1) AS video_hdp_last,\n      SUM(host_sd_last1) AS host_video_sd_last,\n      SUM(audience_sd_last1) AS audience_video_sd_last,\n      SUM(host_hd_last1) AS host_video_hd_last,\n      SUM(audience_hd_last1) AS audience_video_hd_last,\n      SUM(host_hdp_last1) AS host_video_hdp_last,\n      SUM(audience_hdp_last1) AS audience_video_hdp_last,\n      SUM(host_audio_last1) AS host_audio_last,\n      SUM(audience_audio_last1) AS audience_audio_last,\n      SUM(host_video_last1) AS host_video_last,\n      SUM(audience_video_last1) AS audience_video_last,\n      SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n      SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n      SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n      SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n      SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n      SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n      SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n      SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n      SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n      SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n      SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n      SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n      SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n      SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n      SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n      SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n      SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n      SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n      SUM(audience_2k_last1) AS audience_2k_last1,\n      SUM(audience_4k_last1) AS audience_4k_last1,\n      SUM(audience_1080p_last1) AS audience_1080p_last1,\n      SUM(host_1080p_last1) AS host_1080p_last1,\n      SUM(host_2k_last1) AS host_2k_last1,\n      SUM(host_4k_last1) AS host_4k_last1,\n      SUM(total_last7) AS total_last7,\n      SUM(audio_last7) AS audio_last7,\n      SUM(video_last7) AS video_last7,\n      SUM(video_sd_last7) AS video_sd_last7,\n      SUM(video_hd_last7) AS video_hd_last7,\n      SUM(video_hdp_last7) AS video_hdp_last7,\n      SUM(host_sd_last7) AS host_sd_last7,\n      SUM(audience_sd_last7) AS audience_sd_last7,\n      SUM(host_hd_last7) AS host_hd_last7,\n      SUM(audience_hd_last7) AS audience_hd_last7,\n      SUM(host_hdp_last7) AS host_hdp_last7,\n      SUM(audience_hdp_last7) AS audience_hdp_last7,\n      SUM(host_audio_last7) AS host_audio_last7,\n      SUM(audience_audio_last7) AS audience_audio_last7,\n      SUM(host_video_last7) AS host_video_last7,\n      SUM(audience_video_last7) AS audience_video_last7,\n      SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n      SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n      SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n      SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n      SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n      SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n      SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n      SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n      SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n      SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n      SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n      SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n      SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n      SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n      SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n      SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n      SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n      SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n      SUM(audience_2k_last7) AS audience_2k_last7,\n      SUM(audience_4k_last7) AS audience_4k_last7,\n      SUM(audience_1080p_last7) AS audience_1080p_last7,\n      SUM(host_1080p_last7) AS host_1080p_last7,\n      SUM(host_2k_last7) AS host_2k_last7,\n      SUM(host_4k_last7) AS host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211113 AND date <= 20211212 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n    GROUP BY date,\n      DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n      2,\n      3,\n      tag,\n      area,\n      dim,\n      8,\n      9,\n      10,\n      level4,\n      product_level1,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en,\n      vid_use_case_en,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n          start_date AS start_date,\n          end_date AS end_date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          tag,\n          area AS Scope,\n          dim,\n            CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n            CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n            CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          browser,\n          browser_ver,\n          dim_grouping_name,\n          SUM(total) AS totalUsage,\n          SUM(audio) AS audio,\n          SUM(video) AS video,\n          SUM(host_sd + audience_sd) AS video_sd,\n          SUM(host_hd + audience_hd) AS video_hd,\n          SUM(host_hdp + audience_hdp) AS video_hdp,\n          SUM(host_audio) AS host_audio,\n          SUM(audience_audio) AS audience_audio,\n          SUM(host_sd) AS host_sd,\n          SUM(host_hd) AS host_hd,\n          SUM(host_hdp) AS host_hdp,\n          SUM(host_1080p) AS host_1080p,\n          SUM(host_2k) AS host_2k,\n          SUM(host_4k) AS host_4k,\n          SUM(audience_sd) AS audience_sd,\n          SUM(audience_hd) AS audience_hd,\n          SUM(audience_hdp) AS audience_hdp,\n          SUM(audience_1080p) AS audience_1080p,\n          SUM(audience_2k) AS audience_2k,\n          SUM(audience_4k) AS audience_4k,\n          SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n          SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n          SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n          SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n          SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n          SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n          SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n          SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n          SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n          SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n          SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n          SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n          SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n          SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n          SUM(total_last1) AS audio_video_last,\n          SUM(audio_last1) AS audio_last,\n          SUM(video_last1) AS video_last,\n          SUM(video_sd_last1) AS video_sd_last,\n          SUM(video_hd_last1) AS video_hd_last,\n          SUM(video_hdp_last1) AS video_hdp_last,\n          SUM(host_sd_last1) AS host_video_sd_last,\n          SUM(audience_sd_last1) AS audience_video_sd_last,\n          SUM(host_hd_last1) AS host_video_hd_last,\n          SUM(audience_hd_last1) AS audience_video_hd_last,\n          SUM(host_hdp_last1) AS host_video_hdp_last,\n          SUM(audience_hdp_last1) AS audience_video_hdp_last,\n          SUM(host_audio_last1) AS host_audio_last,\n          SUM(audience_audio_last1) AS audience_audio_last,\n          SUM(host_video_last1) AS host_video_last,\n          SUM(audience_video_last1) AS audience_video_last,\n          SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n          SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n          SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n          SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n          SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n          SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n          SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n          SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n          SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n          SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n          SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n          SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n          SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n          SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n          SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n          SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n          SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n          SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n          SUM(audience_2k_last1) AS audience_2k_last1,\n          SUM(audience_4k_last1) AS audience_4k_last1,\n          SUM(audience_1080p_last1) AS audience_1080p_last1,\n          SUM(host_1080p_last1) AS host_1080p_last1,\n          SUM(host_2k_last1) AS host_2k_last1,\n          SUM(host_4k_last1) AS host_4k_last1,\n          SUM(total_last7) AS total_last7,\n          SUM(audio_last7) AS audio_last7,\n          SUM(video_last7) AS video_last7,\n          SUM(video_sd_last7) AS video_sd_last7,\n          SUM(video_hd_last7) AS video_hd_last7,\n          SUM(video_hdp_last7) AS video_hdp_last7,\n          SUM(host_sd_last7) AS host_sd_last7,\n          SUM(audience_sd_last7) AS audience_sd_last7,\n          SUM(host_hd_last7) AS host_hd_last7,\n          SUM(audience_hd_last7) AS audience_hd_last7,\n          SUM(host_hdp_last7) AS host_hdp_last7,\n          SUM(audience_hdp_last7) AS audience_hdp_last7,\n          SUM(host_audio_last7) AS host_audio_last7,\n          SUM(audience_audio_last7) AS audience_audio_last7,\n          SUM(host_video_last7) AS host_video_last7,\n          SUM(audience_video_last7) AS audience_video_last7,\n          SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n          SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n          SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n          SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n          SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n          SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n          SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n          SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n          SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n          SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n          SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n          SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n          SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n          SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n          SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n          SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n          SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n          SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n          SUM(audience_2k_last7) AS audience_2k_last7,\n          SUM(audience_4k_last7) AS audience_4k_last7,\n          SUM(audience_1080p_last7) AS audience_1080p_last7,\n          SUM(host_1080p_last7) AS host_1080p_last7,\n          SUM(host_2k_last7) AS host_2k_last7,\n          SUM(host_4k_last7) AS host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211113 AND date <= 20211212 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n        GROUP BY date,\n          DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n          2,\n          3,\n          tag,\n          area,\n          dim,\n          8,\n          9,\n          10,\n          level4,\n          product_level1,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en,\n          vid_use_case_en,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          browser,\n          browser_ver,\n          dim_grouping_name) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 3 AND CAST(\"自定义 SQL 查询\".\"level1\" AS VARCHAR) = 'RTC' AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 20,\n  23"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700079370244)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700079370244)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700079370244)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700079370244)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700079370244)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700079370244)(943764407)(0)\",\n  MIN(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(1482809429)(0)\",\n  MIN(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(3765460736)(0)\",\n  MAX(\"自定义 SQL 查询\".\"stat_date\") AS \"TEMP(attr_stat_date_nk)(2102638629)(0)\",\n  MIN(\"自定义 SQL 查询\".\"stat_date\") AS \"TEMP(attr_stat_date_nk)(2790680713)(0)\",\n  \"自定义 SQL 查询\".\"vid_sector_en\" AS \"vid_sector_en\"\nFROM (SELECT date,\n      start_date AS start_date,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name,\n      SUM(total) AS totalUsage,\n      SUM(audio) AS audio,\n      SUM(video) AS video,\n      SUM(host_sd + audience_sd) AS video_sd,\n      SUM(host_hd + audience_hd) AS video_hd,\n      SUM(host_hdp + audience_hdp) AS video_hdp,\n      SUM(host_audio) AS host_audio,\n      SUM(audience_audio) AS audience_audio,\n      SUM(host_sd) AS host_sd,\n      SUM(host_hd) AS host_hd,\n      SUM(host_hdp) AS host_hdp,\n      SUM(host_1080p) AS host_1080p,\n      SUM(host_2k) AS host_2k,\n      SUM(host_4k) AS host_4k,\n      SUM(audience_sd) AS audience_sd,\n      SUM(audience_hd) AS audience_hd,\n      SUM(audience_hdp) AS audience_hdp,\n      SUM(audience_1080p) AS audience_1080p,\n      SUM(audience_2k) AS audience_2k,\n      SUM(audience_4k) AS audience_4k,\n      SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n      SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n      SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n      SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n      SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n      SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n      SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n      SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n      SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n      SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n      SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n      SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n      SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n      SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n      SUM(total_last1) AS audio_video_last,\n      SUM(audio_last1) AS audio_last,\n      SUM(video_last1) AS video_last,\n      SUM(video_sd_last1) AS video_sd_last,\n      SUM(video_hd_last1) AS video_hd_last,\n      SUM(video_hdp_last1) AS video_hdp_last,\n      SUM(host_sd_last1) AS host_video_sd_last,\n      SUM(audience_sd_last1) AS audience_video_sd_last,\n      SUM(host_hd_last1) AS host_video_hd_last,\n      SUM(audience_hd_last1) AS audience_video_hd_last,\n      SUM(host_hdp_last1) AS host_video_hdp_last,\n      SUM(audience_hdp_last1) AS audience_video_hdp_last,\n      SUM(host_audio_last1) AS host_audio_last,\n      SUM(audience_audio_last1) AS audience_audio_last,\n      SUM(host_video_last1) AS host_video_last,\n      SUM(audience_video_last1) AS audience_video_last,\n      SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n      SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n      SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n      SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n      SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n      SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n      SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n      SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n      SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n      SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n      SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n      SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n      SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n      SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n      SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n      SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n      SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n      SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n      SUM(audience_2k_last1) AS audience_2k_last1,\n      SUM(audience_4k_last1) AS audience_4k_last1,\n      SUM(audience_1080p_last1) AS audience_1080p_last1,\n      SUM(host_1080p_last1) AS host_1080p_last1,\n      SUM(host_2k_last1) AS host_2k_last1,\n      SUM(host_4k_last1) AS host_4k_last1,\n      SUM(total_last7) AS total_last7,\n      SUM(audio_last7) AS audio_last7,\n      SUM(video_last7) AS video_last7,\n      SUM(video_sd_last7) AS video_sd_last7,\n      SUM(video_hd_last7) AS video_hd_last7,\n      SUM(video_hdp_last7) AS video_hdp_last7,\n      SUM(host_sd_last7) AS host_sd_last7,\n      SUM(audience_sd_last7) AS audience_sd_last7,\n      SUM(host_hd_last7) AS host_hd_last7,\n      SUM(audience_hd_last7) AS audience_hd_last7,\n      SUM(host_hdp_last7) AS host_hdp_last7,\n      SUM(audience_hdp_last7) AS audience_hdp_last7,\n      SUM(host_audio_last7) AS host_audio_last7,\n      SUM(audience_audio_last7) AS audience_audio_last7,\n      SUM(host_video_last7) AS host_video_last7,\n      SUM(audience_video_last7) AS audience_video_last7,\n      SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n      SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n      SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n      SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n      SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n      SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n      SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n      SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n      SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n      SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n      SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n      SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n      SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n      SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n      SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n      SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n      SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n      SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n      SUM(audience_2k_last7) AS audience_2k_last7,\n      SUM(audience_4k_last7) AS audience_4k_last7,\n      SUM(audience_1080p_last7) AS audience_1080p_last7,\n      SUM(host_1080p_last7) AS host_1080p_last7,\n      SUM(host_2k_last7) AS host_2k_last7,\n      SUM(host_4k_last7) AS host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211113 AND date <= 20211212 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n    GROUP BY date,\n      DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n      2,\n      3,\n      tag,\n      area,\n      dim,\n      8,\n      9,\n      10,\n      level4,\n      product_level1,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en,\n      vid_use_case_en,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n          start_date AS start_date,\n          end_date AS end_date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          tag,\n          area AS Scope,\n          dim,\n            CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n            CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n            CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          browser,\n          browser_ver,\n          dim_grouping_name,\n          SUM(total) AS totalUsage,\n          SUM(audio) AS audio,\n          SUM(video) AS video,\n          SUM(host_sd + audience_sd) AS video_sd,\n          SUM(host_hd + audience_hd) AS video_hd,\n          SUM(host_hdp + audience_hdp) AS video_hdp,\n          SUM(host_audio) AS host_audio,\n          SUM(audience_audio) AS audience_audio,\n          SUM(host_sd) AS host_sd,\n          SUM(host_hd) AS host_hd,\n          SUM(host_hdp) AS host_hdp,\n          SUM(host_1080p) AS host_1080p,\n          SUM(host_2k) AS host_2k,\n          SUM(host_4k) AS host_4k,\n          SUM(audience_sd) AS audience_sd,\n          SUM(audience_hd) AS audience_hd,\n          SUM(audience_hdp) AS audience_hdp,\n          SUM(audience_1080p) AS audience_1080p,\n          SUM(audience_2k) AS audience_2k,\n          SUM(audience_4k) AS audience_4k,\n          SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n          SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n          SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n          SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n          SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n          SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n          SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n          SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n          SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n          SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n          SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n          SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n          SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n          SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n          SUM(total_last1) AS audio_video_last,\n          SUM(audio_last1) AS audio_last,\n          SUM(video_last1) AS video_last,\n          SUM(video_sd_last1) AS video_sd_last,\n          SUM(video_hd_last1) AS video_hd_last,\n          SUM(video_hdp_last1) AS video_hdp_last,\n          SUM(host_sd_last1) AS host_video_sd_last,\n          SUM(audience_sd_last1) AS audience_video_sd_last,\n          SUM(host_hd_last1) AS host_video_hd_last,\n          SUM(audience_hd_last1) AS audience_video_hd_last,\n          SUM(host_hdp_last1) AS host_video_hdp_last,\n          SUM(audience_hdp_last1) AS audience_video_hdp_last,\n          SUM(host_audio_last1) AS host_audio_last,\n          SUM(audience_audio_last1) AS audience_audio_last,\n          SUM(host_video_last1) AS host_video_last,\n          SUM(audience_video_last1) AS audience_video_last,\n          SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n          SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n          SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n          SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n          SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n          SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n          SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n          SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n          SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n          SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n          SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n          SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n          SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n          SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n          SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n          SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n          SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n          SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n          SUM(audience_2k_last1) AS audience_2k_last1,\n          SUM(audience_4k_last1) AS audience_4k_last1,\n          SUM(audience_1080p_last1) AS audience_1080p_last1,\n          SUM(host_1080p_last1) AS host_1080p_last1,\n          SUM(host_2k_last1) AS host_2k_last1,\n          SUM(host_4k_last1) AS host_4k_last1,\n          SUM(total_last7) AS total_last7,\n          SUM(audio_last7) AS audio_last7,\n          SUM(video_last7) AS video_last7,\n          SUM(video_sd_last7) AS video_sd_last7,\n          SUM(video_hd_last7) AS video_hd_last7,\n          SUM(video_hdp_last7) AS video_hdp_last7,\n          SUM(host_sd_last7) AS host_sd_last7,\n          SUM(audience_sd_last7) AS audience_sd_last7,\n          SUM(host_hd_last7) AS host_hd_last7,\n          SUM(audience_hd_last7) AS audience_hd_last7,\n          SUM(host_hdp_last7) AS host_hdp_last7,\n          SUM(audience_hdp_last7) AS audience_hdp_last7,\n          SUM(host_audio_last7) AS host_audio_last7,\n          SUM(audience_audio_last7) AS audience_audio_last7,\n          SUM(host_video_last7) AS host_video_last7,\n          SUM(audience_video_last7) AS audience_video_last7,\n          SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n          SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n          SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n          SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n          SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n          SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n          SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n          SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n          SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n          SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n          SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n          SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n          SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n          SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n          SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n          SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n          SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n          SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n          SUM(audience_2k_last7) AS audience_2k_last7,\n          SUM(audience_4k_last7) AS audience_4k_last7,\n          SUM(audience_1080p_last7) AS audience_1080p_last7,\n          SUM(host_1080p_last7) AS host_1080p_last7,\n          SUM(host_2k_last7) AS host_2k_last7,\n          SUM(host_4k_last7) AS host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211113 AND date <= 20211212 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n        GROUP BY date,\n          DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n          2,\n          3,\n          tag,\n          area,\n          dim,\n          8,\n          9,\n          10,\n          level4,\n          product_level1,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en,\n          vid_use_case_en,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          browser,\n          browser_ver,\n          dim_grouping_name) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 3 AND CAST(\"自定义 SQL 查询\".\"level1\" AS VARCHAR) = 'RTC' AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 22"
	},
	{
		"presto_sql" : "SELECT \"t0\".\"TEMP(Calculation_3519281700079370244)(1075454865)(0)\" AS \"TEMP(Calculation_3519281700079370244)(1075454865)(0)\",\n  \"t0\".\"TEMP(Calculation_3519281700079370244)(1133678835)(0)\" AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  \"t0\".\"TEMP(Calculation_3519281700079370244)(1312501967)(0)\" AS \"TEMP(Calculation_3519281700079370244)(1312501967)(0)\",\n  \"t0\".\"TEMP(Calculation_3519281700079370244)(276907208)(0)\" AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  \"t0\".\"TEMP(Calculation_3519281700079370244)(2929708110)(0)\" AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  \"t0\".\"TEMP(Calculation_3519281700079370244)(2930728935)(0)\" AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  \"t0\".\"TEMP(Calculation_3519281700079370244)(3010533957)(0)\" AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  \"t0\".\"TEMP(Calculation_3519281700079370244)(30306054)(0)\" AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  \"t0\".\"TEMP(Calculation_3519281700079370244)(3087054365)(0)\" AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  \"t0\".\"TEMP(Calculation_3519281700079370244)(3299350010)(0)\" AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  \"t0\".\"TEMP(Calculation_3519281700079370244)(3628946582)(0)\" AS \"TEMP(Calculation_3519281700079370244)(3628946582)(0)\",\n  \"t0\".\"sum_totalUsage_ok\" AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  \"t0\".\"TEMP(Calculation_3519281700079370244)(4109514392)(0)\" AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  \"t0\".\"TEMP(Calculation_3519281700079370244)(586790827)(0)\" AS \"TEMP(Calculation_3519281700079370244)(586790827)(0)\",\n  \"t0\".\"TEMP(Calculation_3519281700079370244)(709512178)(0)\" AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  \"t0\".\"TEMP(Calculation_3519281700079370244)(764410224)(0)\" AS \"TEMP(Calculation_3519281700079370244)(764410224)(0)\",\n  \"t0\".\"TEMP(Calculation_3519281700079370244)(943764407)(0)\" AS \"TEMP(Calculation_3519281700079370244)(943764407)(0)\",\n  \"t0\".\"level1\" AS \"level1\",\n  \"t3\".\"__measure__0\" AS \"sum_Calculation_4164281609521332225_ok\",\n  \"t0\".\"sum_totalUsage_ok\" AS \"sum_totalUsage_ok\"\nFROM (SELECT \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n      SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700079370244)(1075454865)(0)\",\n      SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n      SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700079370244)(1312501967)(0)\",\n      SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n      SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n      SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n      SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n      SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n      SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n      SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n      SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700079370244)(3628946582)(0)\",\n      SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n      SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700079370244)(586790827)(0)\",\n      SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n      SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700079370244)(764410224)(0)\",\n      SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700079370244)(943764407)(0)\",\n      SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"sum_totalUsage_ok\"\n    FROM (SELECT date,\n          start_date AS start_date,\n          end_date AS end_date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          tag,\n          area AS Scope,\n          dim,\n            CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n            CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n            CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          browser,\n          browser_ver,\n          dim_grouping_name,\n          SUM(total) AS totalUsage,\n          SUM(audio) AS audio,\n          SUM(video) AS video,\n          SUM(host_sd + audience_sd) AS video_sd,\n          SUM(host_hd + audience_hd) AS video_hd,\n          SUM(host_hdp + audience_hdp) AS video_hdp,\n          SUM(host_audio) AS host_audio,\n          SUM(audience_audio) AS audience_audio,\n          SUM(host_sd) AS host_sd,\n          SUM(host_hd) AS host_hd,\n          SUM(host_hdp) AS host_hdp,\n          SUM(host_1080p) AS host_1080p,\n          SUM(host_2k) AS host_2k,\n          SUM(host_4k) AS host_4k,\n          SUM(audience_sd) AS audience_sd,\n          SUM(audience_hd) AS audience_hd,\n          SUM(audience_hdp) AS audience_hdp,\n          SUM(audience_1080p) AS audience_1080p,\n          SUM(audience_2k) AS audience_2k,\n          SUM(audience_4k) AS audience_4k,\n          SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n          SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n          SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n          SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n          SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n          SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n          SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n          SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n          SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n          SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n          SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n          SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n          SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n          SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n          SUM(total_last1) AS audio_video_last,\n          SUM(audio_last1) AS audio_last,\n          SUM(video_last1) AS video_last,\n          SUM(video_sd_last1) AS video_sd_last,\n          SUM(video_hd_last1) AS video_hd_last,\n          SUM(video_hdp_last1) AS video_hdp_last,\n          SUM(host_sd_last1) AS host_video_sd_last,\n          SUM(audience_sd_last1) AS audience_video_sd_last,\n          SUM(host_hd_last1) AS host_video_hd_last,\n          SUM(audience_hd_last1) AS audience_video_hd_last,\n          SUM(host_hdp_last1) AS host_video_hdp_last,\n          SUM(audience_hdp_last1) AS audience_video_hdp_last,\n          SUM(host_audio_last1) AS host_audio_last,\n          SUM(audience_audio_last1) AS audience_audio_last,\n          SUM(host_video_last1) AS host_video_last,\n          SUM(audience_video_last1) AS audience_video_last,\n          SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n          SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n          SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n          SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n          SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n          SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n          SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n          SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n          SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n          SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n          SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n          SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n          SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n          SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n          SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n          SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n          SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n          SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n          SUM(audience_2k_last1) AS audience_2k_last1,\n          SUM(audience_4k_last1) AS audience_4k_last1,\n          SUM(audience_1080p_last1) AS audience_1080p_last1,\n          SUM(host_1080p_last1) AS host_1080p_last1,\n          SUM(host_2k_last1) AS host_2k_last1,\n          SUM(host_4k_last1) AS host_4k_last1,\n          SUM(total_last7) AS total_last7,\n          SUM(audio_last7) AS audio_last7,\n          SUM(video_last7) AS video_last7,\n          SUM(video_sd_last7) AS video_sd_last7,\n          SUM(video_hd_last7) AS video_hd_last7,\n          SUM(video_hdp_last7) AS video_hdp_last7,\n          SUM(host_sd_last7) AS host_sd_last7,\n          SUM(audience_sd_last7) AS audience_sd_last7,\n          SUM(host_hd_last7) AS host_hd_last7,\n          SUM(audience_hd_last7) AS audience_hd_last7,\n          SUM(host_hdp_last7) AS host_hdp_last7,\n          SUM(audience_hdp_last7) AS audience_hdp_last7,\n          SUM(host_audio_last7) AS host_audio_last7,\n          SUM(audience_audio_last7) AS audience_audio_last7,\n          SUM(host_video_last7) AS host_video_last7,\n          SUM(audience_video_last7) AS audience_video_last7,\n          SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n          SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n          SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n          SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n          SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n          SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n          SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n          SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n          SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n          SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n          SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n          SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n          SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n          SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n          SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n          SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n          SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n          SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n          SUM(audience_2k_last7) AS audience_2k_last7,\n          SUM(audience_4k_last7) AS audience_4k_last7,\n          SUM(audience_1080p_last7) AS audience_1080p_last7,\n          SUM(host_1080p_last7) AS host_1080p_last7,\n          SUM(host_2k_last7) AS host_2k_last7,\n          SUM(host_4k_last7) AS host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211113 AND date <= 20211212 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n        GROUP BY date,\n          DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n          2,\n          3,\n          tag,\n          area,\n          dim,\n          8,\n          9,\n          10,\n          level4,\n          product_level1,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en,\n          vid_use_case_en,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          browser,\n          browser_ver,\n          dim_grouping_name) AS \"自定义 SQL 查询\"\n    WHERE CAST(\"自定义 SQL 查询\".\"level1\" AS VARCHAR) = 'RTC' AND \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 3\n    GROUP BY 1) AS \"t0\"\n  INNER JOIN (SELECT MIN(\"t1\".\"level1\") AS \"level1\",\n      SUM(\"t2\".\"__measure__1\") AS \"__measure__0\"\n    FROM (SELECT \"自定义 SQL 查询\".\"date\" AS \"date\",\n          \"自定义 SQL 查询\".\"level1\" AS \"level1\"\n        FROM (SELECT date,\n              start_date AS start_date,\n              end_date AS end_date,\n                CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n              tag,\n              area AS Scope,\n              dim,\n                CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n                CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n                CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n              level4,\n              product_level1 AS product_line,\n              product_level2,\n              product_level3,\n              product_level4,\n              vid_internal_industry_en AS cid_industry,\n              vid_use_case_en AS vid_use_case_cn,\n              vid_sector_en,\n              ver_type,\n              ver,\n              os,\n              domain,\n              country,\n              region,\n              browser,\n              browser_ver,\n              dim_grouping_name,\n              SUM(total) AS totalUsage,\n              SUM(audio) AS audio,\n              SUM(video) AS video,\n              SUM(host_sd + audience_sd) AS video_sd,\n              SUM(host_hd + audience_hd) AS video_hd,\n              SUM(host_hdp + audience_hdp) AS video_hdp,\n              SUM(host_audio) AS host_audio,\n              SUM(audience_audio) AS audience_audio,\n              SUM(host_sd) AS host_sd,\n              SUM(host_hd) AS host_hd,\n              SUM(host_hdp) AS host_hdp,\n              SUM(host_1080p) AS host_1080p,\n              SUM(host_2k) AS host_2k,\n              SUM(host_4k) AS host_4k,\n              SUM(audience_sd) AS audience_sd,\n              SUM(audience_hd) AS audience_hd,\n              SUM(audience_hdp) AS audience_hdp,\n              SUM(audience_1080p) AS audience_1080p,\n              SUM(audience_2k) AS audience_2k,\n              SUM(audience_4k) AS audience_4k,\n              SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n              SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n              SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n              SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n              SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n              SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n              SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n              SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n              SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n              SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n              SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n              SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n              SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n              SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n              SUM(total_last1) AS audio_video_last,\n              SUM(audio_last1) AS audio_last,\n              SUM(video_last1) AS video_last,\n              SUM(video_sd_last1) AS video_sd_last,\n              SUM(video_hd_last1) AS video_hd_last,\n              SUM(video_hdp_last1) AS video_hdp_last,\n              SUM(host_sd_last1) AS host_video_sd_last,\n              SUM(audience_sd_last1) AS audience_video_sd_last,\n              SUM(host_hd_last1) AS host_video_hd_last,\n              SUM(audience_hd_last1) AS audience_video_hd_last,\n              SUM(host_hdp_last1) AS host_video_hdp_last,\n              SUM(audience_hdp_last1) AS audience_video_hdp_last,\n              SUM(host_audio_last1) AS host_audio_last,\n              SUM(audience_audio_last1) AS audience_audio_last,\n              SUM(host_video_last1) AS host_video_last,\n              SUM(audience_video_last1) AS audience_video_last,\n              SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n              SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n              SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n              SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n              SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n              SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n              SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n              SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n              SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n              SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n              SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n              SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n              SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n              SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n              SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n              SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n              SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n              SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n              SUM(audience_2k_last1) AS audience_2k_last1,\n              SUM(audience_4k_last1) AS audience_4k_last1,\n              SUM(audience_1080p_last1) AS audience_1080p_last1,\n              SUM(host_1080p_last1) AS host_1080p_last1,\n              SUM(host_2k_last1) AS host_2k_last1,\n              SUM(host_4k_last1) AS host_4k_last1,\n              SUM(total_last7) AS total_last7,\n              SUM(audio_last7) AS audio_last7,\n              SUM(video_last7) AS video_last7,\n              SUM(video_sd_last7) AS video_sd_last7,\n              SUM(video_hd_last7) AS video_hd_last7,\n              SUM(video_hdp_last7) AS video_hdp_last7,\n              SUM(host_sd_last7) AS host_sd_last7,\n              SUM(audience_sd_last7) AS audience_sd_last7,\n              SUM(host_hd_last7) AS host_hd_last7,\n              SUM(audience_hd_last7) AS audience_hd_last7,\n              SUM(host_hdp_last7) AS host_hdp_last7,\n              SUM(audience_hdp_last7) AS audience_hdp_last7,\n              SUM(host_audio_last7) AS host_audio_last7,\n              SUM(audience_audio_last7) AS audience_audio_last7,\n              SUM(host_video_last7) AS host_video_last7,\n              SUM(audience_video_last7) AS audience_video_last7,\n              SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n              SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n              SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n              SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n              SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n              SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n              SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n              SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n              SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n              SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n              SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n              SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n              SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n              SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n              SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n              SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n              SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n              SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n              SUM(audience_2k_last7) AS audience_2k_last7,\n              SUM(audience_4k_last7) AS audience_4k_last7,\n              SUM(audience_1080p_last7) AS audience_1080p_last7,\n              SUM(host_1080p_last7) AS host_1080p_last7,\n              SUM(host_2k_last7) AS host_2k_last7,\n              SUM(host_4k_last7) AS host_4k_last7\n            FROM levels_usage_dod_di_1\n            WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211113 AND date <= 20211212 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n            GROUP BY date,\n              DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n                CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n              2,\n              3,\n              tag,\n              area,\n              dim,\n              8,\n              9,\n              10,\n              level4,\n              product_level1,\n              product_level2,\n              product_level3,\n              product_level4,\n              vid_internal_industry_en,\n              vid_use_case_en,\n              vid_sector_en,\n              ver_type,\n              ver,\n              os,\n              domain,\n              country,\n              region,\n              browser,\n              browser_ver,\n              dim_grouping_name) AS \"自定义 SQL 查询\"\n        WHERE CAST(\"自定义 SQL 查询\".\"level1\" AS VARCHAR) = 'RTC' AND \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 3\n        GROUP BY 1,\n          2) AS \"t1\"\n      INNER JOIN (SELECT \"自定义 SQL 查询\".\"date\" AS \"date\",\n          SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"__measure__1\"\n        FROM (SELECT date,\n              start_date AS start_date,\n              end_date AS end_date,\n                CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n              tag,\n              area AS Scope,\n              dim,\n                CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n                CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n                CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n              level4,\n              product_level1 AS product_line,\n              product_level2,\n              product_level3,\n              product_level4,\n              vid_internal_industry_en AS cid_industry,\n              vid_use_case_en AS vid_use_case_cn,\n              vid_sector_en,\n              ver_type,\n              ver,\n              os,\n              domain,\n              country,\n              region,\n              browser,\n              browser_ver,\n              dim_grouping_name,\n              SUM(total) AS totalUsage,\n              SUM(audio) AS audio,\n              SUM(video) AS video,\n              SUM(host_sd + audience_sd) AS video_sd,\n              SUM(host_hd + audience_hd) AS video_hd,\n              SUM(host_hdp + audience_hdp) AS video_hdp,\n              SUM(host_audio) AS host_audio,\n              SUM(audience_audio) AS audience_audio,\n              SUM(host_sd) AS host_sd,\n              SUM(host_hd) AS host_hd,\n              SUM(host_hdp) AS host_hdp,\n              SUM(host_1080p) AS host_1080p,\n              SUM(host_2k) AS host_2k,\n              SUM(host_4k) AS host_4k,\n              SUM(audience_sd) AS audience_sd,\n              SUM(audience_hd) AS audience_hd,\n              SUM(audience_hdp) AS audience_hdp,\n              SUM(audience_1080p) AS audience_1080p,\n              SUM(audience_2k) AS audience_2k,\n              SUM(audience_4k) AS audience_4k,\n              SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n              SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n              SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n              SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n              SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n              SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n              SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n              SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n              SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n              SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n              SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n              SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n              SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n              SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n              SUM(total_last1) AS audio_video_last,\n              SUM(audio_last1) AS audio_last,\n              SUM(video_last1) AS video_last,\n              SUM(video_sd_last1) AS video_sd_last,\n              SUM(video_hd_last1) AS video_hd_last,\n              SUM(video_hdp_last1) AS video_hdp_last,\n              SUM(host_sd_last1) AS host_video_sd_last,\n              SUM(audience_sd_last1) AS audience_video_sd_last,\n              SUM(host_hd_last1) AS host_video_hd_last,\n              SUM(audience_hd_last1) AS audience_video_hd_last,\n              SUM(host_hdp_last1) AS host_video_hdp_last,\n              SUM(audience_hdp_last1) AS audience_video_hdp_last,\n              SUM(host_audio_last1) AS host_audio_last,\n              SUM(audience_audio_last1) AS audience_audio_last,\n              SUM(host_video_last1) AS host_video_last,\n              SUM(audience_video_last1) AS audience_video_last,\n              SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n              SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n              SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n              SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n              SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n              SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n              SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n              SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n              SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n              SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n              SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n              SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n              SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n              SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n              SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n              SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n              SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n              SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n              SUM(audience_2k_last1) AS audience_2k_last1,\n              SUM(audience_4k_last1) AS audience_4k_last1,\n              SUM(audience_1080p_last1) AS audience_1080p_last1,\n              SUM(host_1080p_last1) AS host_1080p_last1,\n              SUM(host_2k_last1) AS host_2k_last1,\n              SUM(host_4k_last1) AS host_4k_last1,\n              SUM(total_last7) AS total_last7,\n              SUM(audio_last7) AS audio_last7,\n              SUM(video_last7) AS video_last7,\n              SUM(video_sd_last7) AS video_sd_last7,\n              SUM(video_hd_last7) AS video_hd_last7,\n              SUM(video_hdp_last7) AS video_hdp_last7,\n              SUM(host_sd_last7) AS host_sd_last7,\n              SUM(audience_sd_last7) AS audience_sd_last7,\n              SUM(host_hd_last7) AS host_hd_last7,\n              SUM(audience_hd_last7) AS audience_hd_last7,\n              SUM(host_hdp_last7) AS host_hdp_last7,\n              SUM(audience_hdp_last7) AS audience_hdp_last7,\n              SUM(host_audio_last7) AS host_audio_last7,\n              SUM(audience_audio_last7) AS audience_audio_last7,\n              SUM(host_video_last7) AS host_video_last7,\n              SUM(audience_video_last7) AS audience_video_last7,\n              SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n              SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n              SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n              SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n              SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n              SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n              SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n              SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n              SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n              SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n              SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n              SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n              SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n              SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n              SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n              SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n              SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n              SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n              SUM(audience_2k_last7) AS audience_2k_last7,\n              SUM(audience_4k_last7) AS audience_4k_last7,\n              SUM(audience_1080p_last7) AS audience_1080p_last7,\n              SUM(host_1080p_last7) AS host_1080p_last7,\n              SUM(host_2k_last7) AS host_2k_last7,\n              SUM(host_4k_last7) AS host_4k_last7\n            FROM levels_usage_dod_di_1\n            WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211113 AND date <= 20211212 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n            GROUP BY date,\n              DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n                CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n              2,\n              3,\n              tag,\n              area,\n              dim,\n              8,\n              9,\n              10,\n              level4,\n              product_level1,\n              product_level2,\n              product_level3,\n              product_level4,\n              vid_internal_industry_en,\n              vid_use_case_en,\n              vid_sector_en,\n              ver_type,\n              ver,\n              os,\n              domain,\n              country,\n              region,\n              browser,\n              browser_ver,\n              dim_grouping_name) AS \"自定义 SQL 查询\"\n        GROUP BY 1) AS \"t2\" ON ((\"t1\".\"date\"  is null and  \"t2\".\"date\"  is null )  or  (\"t1\".\"date\" = \"t2\".\"date\"))\n    HAVING COUNT(1) > 0) AS \"t3\" ON \"t0\".\"level1\" = \"t3\".\"level1\""
	},
	{
		"presto_sql" : "SELECT \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"sum_totalUsage_ok\"\nFROM (SELECT date,\n      start_date AS start_date,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name,\n      SUM(total) AS totalUsage,\n      SUM(audio) AS audio,\n      SUM(video) AS video,\n      SUM(host_sd + audience_sd) AS video_sd,\n      SUM(host_hd + audience_hd) AS video_hd,\n      SUM(host_hdp + audience_hdp) AS video_hdp,\n      SUM(host_audio) AS host_audio,\n      SUM(audience_audio) AS audience_audio,\n      SUM(host_sd) AS host_sd,\n      SUM(host_hd) AS host_hd,\n      SUM(host_hdp) AS host_hdp,\n      SUM(host_1080p) AS host_1080p,\n      SUM(host_2k) AS host_2k,\n      SUM(host_4k) AS host_4k,\n      SUM(audience_sd) AS audience_sd,\n      SUM(audience_hd) AS audience_hd,\n      SUM(audience_hdp) AS audience_hdp,\n      SUM(audience_1080p) AS audience_1080p,\n      SUM(audience_2k) AS audience_2k,\n      SUM(audience_4k) AS audience_4k,\n      SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n      SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n      SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n      SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n      SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n      SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n      SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n      SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n      SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n      SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n      SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n      SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n      SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n      SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n      SUM(total_last1) AS audio_video_last,\n      SUM(audio_last1) AS audio_last,\n      SUM(video_last1) AS video_last,\n      SUM(video_sd_last1) AS video_sd_last,\n      SUM(video_hd_last1) AS video_hd_last,\n      SUM(video_hdp_last1) AS video_hdp_last,\n      SUM(host_sd_last1) AS host_video_sd_last,\n      SUM(audience_sd_last1) AS audience_video_sd_last,\n      SUM(host_hd_last1) AS host_video_hd_last,\n      SUM(audience_hd_last1) AS audience_video_hd_last,\n      SUM(host_hdp_last1) AS host_video_hdp_last,\n      SUM(audience_hdp_last1) AS audience_video_hdp_last,\n      SUM(host_audio_last1) AS host_audio_last,\n      SUM(audience_audio_last1) AS audience_audio_last,\n      SUM(host_video_last1) AS host_video_last,\n      SUM(audience_video_last1) AS audience_video_last,\n      SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n      SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n      SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n      SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n      SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n      SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n      SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n      SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n      SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n      SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n      SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n      SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n      SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n      SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n      SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n      SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n      SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n      SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n      SUM(audience_2k_last1) AS audience_2k_last1,\n      SUM(audience_4k_last1) AS audience_4k_last1,\n      SUM(audience_1080p_last1) AS audience_1080p_last1,\n      SUM(host_1080p_last1) AS host_1080p_last1,\n      SUM(host_2k_last1) AS host_2k_last1,\n      SUM(host_4k_last1) AS host_4k_last1,\n      SUM(total_last7) AS total_last7,\n      SUM(audio_last7) AS audio_last7,\n      SUM(video_last7) AS video_last7,\n      SUM(video_sd_last7) AS video_sd_last7,\n      SUM(video_hd_last7) AS video_hd_last7,\n      SUM(video_hdp_last7) AS video_hdp_last7,\n      SUM(host_sd_last7) AS host_sd_last7,\n      SUM(audience_sd_last7) AS audience_sd_last7,\n      SUM(host_hd_last7) AS host_hd_last7,\n      SUM(audience_hd_last7) AS audience_hd_last7,\n      SUM(host_hdp_last7) AS host_hdp_last7,\n      SUM(audience_hdp_last7) AS audience_hdp_last7,\n      SUM(host_audio_last7) AS host_audio_last7,\n      SUM(audience_audio_last7) AS audience_audio_last7,\n      SUM(host_video_last7) AS host_video_last7,\n      SUM(audience_video_last7) AS audience_video_last7,\n      SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n      SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n      SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n      SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n      SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n      SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n      SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n      SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n      SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n      SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n      SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n      SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n      SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n      SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n      SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n      SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n      SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n      SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n      SUM(audience_2k_last7) AS audience_2k_last7,\n      SUM(audience_4k_last7) AS audience_4k_last7,\n      SUM(audience_1080p_last7) AS audience_1080p_last7,\n      SUM(host_1080p_last7) AS host_1080p_last7,\n      SUM(host_2k_last7) AS host_2k_last7,\n      SUM(host_4k_last7) AS host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211113 AND date <= 20211212 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n    GROUP BY date,\n      DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n      2,\n      3,\n      tag,\n      area,\n      dim,\n      8,\n      9,\n      10,\n      level4,\n      product_level1,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en,\n      vid_use_case_en,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n          start_date AS start_date,\n          end_date AS end_date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          tag,\n          area AS Scope,\n          dim,\n            CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n            CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n            CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          browser,\n          browser_ver,\n          dim_grouping_name,\n          SUM(total) AS totalUsage,\n          SUM(audio) AS audio,\n          SUM(video) AS video,\n          SUM(host_sd + audience_sd) AS video_sd,\n          SUM(host_hd + audience_hd) AS video_hd,\n          SUM(host_hdp + audience_hdp) AS video_hdp,\n          SUM(host_audio) AS host_audio,\n          SUM(audience_audio) AS audience_audio,\n          SUM(host_sd) AS host_sd,\n          SUM(host_hd) AS host_hd,\n          SUM(host_hdp) AS host_hdp,\n          SUM(host_1080p) AS host_1080p,\n          SUM(host_2k) AS host_2k,\n          SUM(host_4k) AS host_4k,\n          SUM(audience_sd) AS audience_sd,\n          SUM(audience_hd) AS audience_hd,\n          SUM(audience_hdp) AS audience_hdp,\n          SUM(audience_1080p) AS audience_1080p,\n          SUM(audience_2k) AS audience_2k,\n          SUM(audience_4k) AS audience_4k,\n          SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n          SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n          SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n          SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n          SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n          SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n          SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n          SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n          SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n          SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n          SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n          SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n          SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n          SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n          SUM(total_last1) AS audio_video_last,\n          SUM(audio_last1) AS audio_last,\n          SUM(video_last1) AS video_last,\n          SUM(video_sd_last1) AS video_sd_last,\n          SUM(video_hd_last1) AS video_hd_last,\n          SUM(video_hdp_last1) AS video_hdp_last,\n          SUM(host_sd_last1) AS host_video_sd_last,\n          SUM(audience_sd_last1) AS audience_video_sd_last,\n          SUM(host_hd_last1) AS host_video_hd_last,\n          SUM(audience_hd_last1) AS audience_video_hd_last,\n          SUM(host_hdp_last1) AS host_video_hdp_last,\n          SUM(audience_hdp_last1) AS audience_video_hdp_last,\n          SUM(host_audio_last1) AS host_audio_last,\n          SUM(audience_audio_last1) AS audience_audio_last,\n          SUM(host_video_last1) AS host_video_last,\n          SUM(audience_video_last1) AS audience_video_last,\n          SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n          SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n          SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n          SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n          SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n          SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n          SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n          SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n          SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n          SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n          SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n          SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n          SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n          SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n          SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n          SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n          SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n          SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n          SUM(audience_2k_last1) AS audience_2k_last1,\n          SUM(audience_4k_last1) AS audience_4k_last1,\n          SUM(audience_1080p_last1) AS audience_1080p_last1,\n          SUM(host_1080p_last1) AS host_1080p_last1,\n          SUM(host_2k_last1) AS host_2k_last1,\n          SUM(host_4k_last1) AS host_4k_last1,\n          SUM(total_last7) AS total_last7,\n          SUM(audio_last7) AS audio_last7,\n          SUM(video_last7) AS video_last7,\n          SUM(video_sd_last7) AS video_sd_last7,\n          SUM(video_hd_last7) AS video_hd_last7,\n          SUM(video_hdp_last7) AS video_hdp_last7,\n          SUM(host_sd_last7) AS host_sd_last7,\n          SUM(audience_sd_last7) AS audience_sd_last7,\n          SUM(host_hd_last7) AS host_hd_last7,\n          SUM(audience_hd_last7) AS audience_hd_last7,\n          SUM(host_hdp_last7) AS host_hdp_last7,\n          SUM(audience_hdp_last7) AS audience_hdp_last7,\n          SUM(host_audio_last7) AS host_audio_last7,\n          SUM(audience_audio_last7) AS audience_audio_last7,\n          SUM(host_video_last7) AS host_video_last7,\n          SUM(audience_video_last7) AS audience_video_last7,\n          SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n          SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n          SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n          SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n          SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n          SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n          SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n          SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n          SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n          SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n          SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n          SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n          SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n          SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n          SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n          SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n          SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n          SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n          SUM(audience_2k_last7) AS audience_2k_last7,\n          SUM(audience_4k_last7) AS audience_4k_last7,\n          SUM(audience_1080p_last7) AS audience_1080p_last7,\n          SUM(host_1080p_last7) AS host_1080p_last7,\n          SUM(host_2k_last7) AS host_2k_last7,\n          SUM(host_4k_last7) AS host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211113 AND date <= 20211212 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n        GROUP BY date,\n          DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n          2,\n          3,\n          tag,\n          area,\n          dim,\n          8,\n          9,\n          10,\n          level4,\n          product_level1,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en,\n          vid_use_case_en,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          browser,\n          browser_ver,\n          dim_grouping_name) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE CAST(\"自定义 SQL 查询\".\"level1\" AS VARCHAR) = 'RTC' AND \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 3 AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 1"
	},
	{
		"presto_sql" : "SELECT MIN(1) AS \"empty\"\nFROM (SELECT date,\n      start_date AS start_date_7,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      vid,\n      project,\n      company_id,\n      company_name,\n      dim_grouping_name,\n      rownum,\n      total,\n      total_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211113 AND date <= 20211212 AND dim IN (101, 102, 103)) AS \"自定义 SQL 查询\"\nHAVING COUNT(1) > 0"
	},
	{
		"presto_sql" : "SELECT MAX(\"自定义 SQL 查询\".\"level2\") AS \"TEMP(attr_level2_nk)(3222240611)(0)\",\n  MIN(\"自定义 SQL 查询\".\"level2\") AS \"TEMP(attr_level2_nk)(3931055347)(0)\"\nFROM (SELECT date,\n      start_date AS start_date_7,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      vid,\n      project,\n      company_id,\n      company_name,\n      dim_grouping_name,\n      rownum,\n      total,\n      total_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211113 AND date <= 20211212 AND dim IN (101, 102, 103)) AS \"自定义 SQL 查询\"\nHAVING COUNT(1) > 0"
	},
	{
		"presto_sql" : "SELECT \"自定义 SQL 查询\".\"product_level2\" AS \"product_level2\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"usr_Calculation_3519281700079370244_ok\"\nFROM (SELECT date,\n      start_date AS start_date,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name,\n      SUM(total) AS totalUsage,\n      SUM(audio) AS audio,\n      SUM(video) AS video,\n      SUM(host_sd + audience_sd) AS video_sd,\n      SUM(host_hd + audience_hd) AS video_hd,\n      SUM(host_hdp + audience_hdp) AS video_hdp,\n      SUM(host_audio) AS host_audio,\n      SUM(audience_audio) AS audience_audio,\n      SUM(host_sd) AS host_sd,\n      SUM(host_hd) AS host_hd,\n      SUM(host_hdp) AS host_hdp,\n      SUM(host_1080p) AS host_1080p,\n      SUM(host_2k) AS host_2k,\n      SUM(host_4k) AS host_4k,\n      SUM(audience_sd) AS audience_sd,\n      SUM(audience_hd) AS audience_hd,\n      SUM(audience_hdp) AS audience_hdp,\n      SUM(audience_1080p) AS audience_1080p,\n      SUM(audience_2k) AS audience_2k,\n      SUM(audience_4k) AS audience_4k,\n      SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n      SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n      SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n      SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n      SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n      SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n      SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n      SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n      SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n      SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n      SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n      SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n      SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n      SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n      SUM(total_last1) AS audio_video_last,\n      SUM(audio_last1) AS audio_last,\n      SUM(video_last1) AS video_last,\n      SUM(video_sd_last1) AS video_sd_last,\n      SUM(video_hd_last1) AS video_hd_last,\n      SUM(video_hdp_last1) AS video_hdp_last,\n      SUM(host_sd_last1) AS host_video_sd_last,\n      SUM(audience_sd_last1) AS audience_video_sd_last,\n      SUM(host_hd_last1) AS host_video_hd_last,\n      SUM(audience_hd_last1) AS audience_video_hd_last,\n      SUM(host_hdp_last1) AS host_video_hdp_last,\n      SUM(audience_hdp_last1) AS audience_video_hdp_last,\n      SUM(host_audio_last1) AS host_audio_last,\n      SUM(audience_audio_last1) AS audience_audio_last,\n      SUM(host_video_last1) AS host_video_last,\n      SUM(audience_video_last1) AS audience_video_last,\n      SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n      SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n      SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n      SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n      SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n      SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n      SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n      SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n      SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n      SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n      SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n      SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n      SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n      SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n      SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n      SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n      SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n      SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n      SUM(audience_2k_last1) AS audience_2k_last1,\n      SUM(audience_4k_last1) AS audience_4k_last1,\n      SUM(audience_1080p_last1) AS audience_1080p_last1,\n      SUM(host_1080p_last1) AS host_1080p_last1,\n      SUM(host_2k_last1) AS host_2k_last1,\n      SUM(host_4k_last1) AS host_4k_last1,\n      SUM(total_last7) AS total_last7,\n      SUM(audio_last7) AS audio_last7,\n      SUM(video_last7) AS video_last7,\n      SUM(video_sd_last7) AS video_sd_last7,\n      SUM(video_hd_last7) AS video_hd_last7,\n      SUM(video_hdp_last7) AS video_hdp_last7,\n      SUM(host_sd_last7) AS host_sd_last7,\n      SUM(audience_sd_last7) AS audience_sd_last7,\n      SUM(host_hd_last7) AS host_hd_last7,\n      SUM(audience_hd_last7) AS audience_hd_last7,\n      SUM(host_hdp_last7) AS host_hdp_last7,\n      SUM(audience_hdp_last7) AS audience_hdp_last7,\n      SUM(host_audio_last7) AS host_audio_last7,\n      SUM(audience_audio_last7) AS audience_audio_last7,\n      SUM(host_video_last7) AS host_video_last7,\n      SUM(audience_video_last7) AS audience_video_last7,\n      SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n      SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n      SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n      SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n      SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n      SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n      SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n      SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n      SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n      SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n      SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n      SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n      SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n      SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n      SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n      SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n      SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n      SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n      SUM(audience_2k_last7) AS audience_2k_last7,\n      SUM(audience_4k_last7) AS audience_4k_last7,\n      SUM(audience_1080p_last7) AS audience_1080p_last7,\n      SUM(host_1080p_last7) AS host_1080p_last7,\n      SUM(host_2k_last7) AS host_2k_last7,\n      SUM(host_4k_last7) AS host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211113 AND date <= 20211212 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n    GROUP BY date,\n      DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n      2,\n      3,\n      tag,\n      area,\n      dim,\n      8,\n      9,\n      10,\n      level4,\n      product_level1,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en,\n      vid_use_case_en,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name) AS \"自定义 SQL 查询\"\nWHERE \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 3 AND CAST(\"自定义 SQL 查询\".\"level1\" AS VARCHAR) = 'RTC'\nGROUP BY 1"
	},
	{
		"presto_sql" : "SELECT \"自定义 SQL 查询\".\"product_level3\" AS \"product_level3\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"usr_Calculation_3519281700079370244_ok\"\nFROM (SELECT date,\n      start_date AS start_date,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name,\n      SUM(total) AS totalUsage,\n      SUM(audio) AS audio,\n      SUM(video) AS video,\n      SUM(host_sd + audience_sd) AS video_sd,\n      SUM(host_hd + audience_hd) AS video_hd,\n      SUM(host_hdp + audience_hdp) AS video_hdp,\n      SUM(host_audio) AS host_audio,\n      SUM(audience_audio) AS audience_audio,\n      SUM(host_sd) AS host_sd,\n      SUM(host_hd) AS host_hd,\n      SUM(host_hdp) AS host_hdp,\n      SUM(host_1080p) AS host_1080p,\n      SUM(host_2k) AS host_2k,\n      SUM(host_4k) AS host_4k,\n      SUM(audience_sd) AS audience_sd,\n      SUM(audience_hd) AS audience_hd,\n      SUM(audience_hdp) AS audience_hdp,\n      SUM(audience_1080p) AS audience_1080p,\n      SUM(audience_2k) AS audience_2k,\n      SUM(audience_4k) AS audience_4k,\n      SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n      SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n      SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n      SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n      SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n      SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n      SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n      SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n      SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n      SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n      SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n      SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n      SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n      SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n      SUM(total_last1) AS audio_video_last,\n      SUM(audio_last1) AS audio_last,\n      SUM(video_last1) AS video_last,\n      SUM(video_sd_last1) AS video_sd_last,\n      SUM(video_hd_last1) AS video_hd_last,\n      SUM(video_hdp_last1) AS video_hdp_last,\n      SUM(host_sd_last1) AS host_video_sd_last,\n      SUM(audience_sd_last1) AS audience_video_sd_last,\n      SUM(host_hd_last1) AS host_video_hd_last,\n      SUM(audience_hd_last1) AS audience_video_hd_last,\n      SUM(host_hdp_last1) AS host_video_hdp_last,\n      SUM(audience_hdp_last1) AS audience_video_hdp_last,\n      SUM(host_audio_last1) AS host_audio_last,\n      SUM(audience_audio_last1) AS audience_audio_last,\n      SUM(host_video_last1) AS host_video_last,\n      SUM(audience_video_last1) AS audience_video_last,\n      SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n      SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n      SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n      SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n      SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n      SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n      SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n      SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n      SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n      SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n      SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n      SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n      SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n      SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n      SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n      SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n      SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n      SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n      SUM(audience_2k_last1) AS audience_2k_last1,\n      SUM(audience_4k_last1) AS audience_4k_last1,\n      SUM(audience_1080p_last1) AS audience_1080p_last1,\n      SUM(host_1080p_last1) AS host_1080p_last1,\n      SUM(host_2k_last1) AS host_2k_last1,\n      SUM(host_4k_last1) AS host_4k_last1,\n      SUM(total_last7) AS total_last7,\n      SUM(audio_last7) AS audio_last7,\n      SUM(video_last7) AS video_last7,\n      SUM(video_sd_last7) AS video_sd_last7,\n      SUM(video_hd_last7) AS video_hd_last7,\n      SUM(video_hdp_last7) AS video_hdp_last7,\n      SUM(host_sd_last7) AS host_sd_last7,\n      SUM(audience_sd_last7) AS audience_sd_last7,\n      SUM(host_hd_last7) AS host_hd_last7,\n      SUM(audience_hd_last7) AS audience_hd_last7,\n      SUM(host_hdp_last7) AS host_hdp_last7,\n      SUM(audience_hdp_last7) AS audience_hdp_last7,\n      SUM(host_audio_last7) AS host_audio_last7,\n      SUM(audience_audio_last7) AS audience_audio_last7,\n      SUM(host_video_last7) AS host_video_last7,\n      SUM(audience_video_last7) AS audience_video_last7,\n      SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n      SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n      SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n      SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n      SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n      SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n      SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n      SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n      SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n      SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n      SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n      SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n      SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n      SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n      SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n      SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n      SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n      SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n      SUM(audience_2k_last7) AS audience_2k_last7,\n      SUM(audience_4k_last7) AS audience_4k_last7,\n      SUM(audience_1080p_last7) AS audience_1080p_last7,\n      SUM(host_1080p_last7) AS host_1080p_last7,\n      SUM(host_2k_last7) AS host_2k_last7,\n      SUM(host_4k_last7) AS host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211113 AND date <= 20211212 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n    GROUP BY date,\n      DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n      2,\n      3,\n      tag,\n      area,\n      dim,\n      8,\n      9,\n      10,\n      level4,\n      product_level1,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en,\n      vid_use_case_en,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name) AS \"自定义 SQL 查询\"\nWHERE \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 3 AND CAST(\"自定义 SQL 查询\".\"level1\" AS VARCHAR) = 'RTC'\nGROUP BY 1"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"usr_Calculation_3519281700079370244_ok\",\n  \"自定义 SQL 查询\".\"vid_sector_en\" AS \"vid_sector_en\"\nFROM (SELECT date,\n      start_date AS start_date,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name,\n      SUM(total) AS totalUsage,\n      SUM(audio) AS audio,\n      SUM(video) AS video,\n      SUM(host_sd + audience_sd) AS video_sd,\n      SUM(host_hd + audience_hd) AS video_hd,\n      SUM(host_hdp + audience_hdp) AS video_hdp,\n      SUM(host_audio) AS host_audio,\n      SUM(audience_audio) AS audience_audio,\n      SUM(host_sd) AS host_sd,\n      SUM(host_hd) AS host_hd,\n      SUM(host_hdp) AS host_hdp,\n      SUM(host_1080p) AS host_1080p,\n      SUM(host_2k) AS host_2k,\n      SUM(host_4k) AS host_4k,\n      SUM(audience_sd) AS audience_sd,\n      SUM(audience_hd) AS audience_hd,\n      SUM(audience_hdp) AS audience_hdp,\n      SUM(audience_1080p) AS audience_1080p,\n      SUM(audience_2k) AS audience_2k,\n      SUM(audience_4k) AS audience_4k,\n      SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n      SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n      SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n      SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n      SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n      SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n      SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n      SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n      SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n      SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n      SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n      SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n      SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n      SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n      SUM(total_last1) AS audio_video_last,\n      SUM(audio_last1) AS audio_last,\n      SUM(video_last1) AS video_last,\n      SUM(video_sd_last1) AS video_sd_last,\n      SUM(video_hd_last1) AS video_hd_last,\n      SUM(video_hdp_last1) AS video_hdp_last,\n      SUM(host_sd_last1) AS host_video_sd_last,\n      SUM(audience_sd_last1) AS audience_video_sd_last,\n      SUM(host_hd_last1) AS host_video_hd_last,\n      SUM(audience_hd_last1) AS audience_video_hd_last,\n      SUM(host_hdp_last1) AS host_video_hdp_last,\n      SUM(audience_hdp_last1) AS audience_video_hdp_last,\n      SUM(host_audio_last1) AS host_audio_last,\n      SUM(audience_audio_last1) AS audience_audio_last,\n      SUM(host_video_last1) AS host_video_last,\n      SUM(audience_video_last1) AS audience_video_last,\n      SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n      SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n      SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n      SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n      SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n      SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n      SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n      SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n      SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n      SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n      SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n      SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n      SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n      SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n      SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n      SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n      SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n      SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n      SUM(audience_2k_last1) AS audience_2k_last1,\n      SUM(audience_4k_last1) AS audience_4k_last1,\n      SUM(audience_1080p_last1) AS audience_1080p_last1,\n      SUM(host_1080p_last1) AS host_1080p_last1,\n      SUM(host_2k_last1) AS host_2k_last1,\n      SUM(host_4k_last1) AS host_4k_last1,\n      SUM(total_last7) AS total_last7,\n      SUM(audio_last7) AS audio_last7,\n      SUM(video_last7) AS video_last7,\n      SUM(video_sd_last7) AS video_sd_last7,\n      SUM(video_hd_last7) AS video_hd_last7,\n      SUM(video_hdp_last7) AS video_hdp_last7,\n      SUM(host_sd_last7) AS host_sd_last7,\n      SUM(audience_sd_last7) AS audience_sd_last7,\n      SUM(host_hd_last7) AS host_hd_last7,\n      SUM(audience_hd_last7) AS audience_hd_last7,\n      SUM(host_hdp_last7) AS host_hdp_last7,\n      SUM(audience_hdp_last7) AS audience_hdp_last7,\n      SUM(host_audio_last7) AS host_audio_last7,\n      SUM(audience_audio_last7) AS audience_audio_last7,\n      SUM(host_video_last7) AS host_video_last7,\n      SUM(audience_video_last7) AS audience_video_last7,\n      SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n      SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n      SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n      SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n      SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n      SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n      SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n      SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n      SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n      SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n      SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n      SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n      SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n      SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n      SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n      SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n      SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n      SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n      SUM(audience_2k_last7) AS audience_2k_last7,\n      SUM(audience_4k_last7) AS audience_4k_last7,\n      SUM(audience_1080p_last7) AS audience_1080p_last7,\n      SUM(host_1080p_last7) AS host_1080p_last7,\n      SUM(host_2k_last7) AS host_2k_last7,\n      SUM(host_4k_last7) AS host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211113 AND date <= 20211212 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n    GROUP BY date,\n      DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n      2,\n      3,\n      tag,\n      area,\n      dim,\n      8,\n      9,\n      10,\n      level4,\n      product_level1,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en,\n      vid_use_case_en,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name) AS \"自定义 SQL 查询\"\nWHERE \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 3 AND CAST(\"自定义 SQL 查询\".\"level1\" AS VARCHAR) = 'RTC'\nGROUP BY 2"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"usr_Calculation_3519281700079370244_ok\",\n  \"自定义 SQL 查询\".\"vid_use_case_cn\" AS \"vid_use_case_cn\"\nFROM (SELECT date,\n      start_date AS start_date,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name,\n      SUM(total) AS totalUsage,\n      SUM(audio) AS audio,\n      SUM(video) AS video,\n      SUM(host_sd + audience_sd) AS video_sd,\n      SUM(host_hd + audience_hd) AS video_hd,\n      SUM(host_hdp + audience_hdp) AS video_hdp,\n      SUM(host_audio) AS host_audio,\n      SUM(audience_audio) AS audience_audio,\n      SUM(host_sd) AS host_sd,\n      SUM(host_hd) AS host_hd,\n      SUM(host_hdp) AS host_hdp,\n      SUM(host_1080p) AS host_1080p,\n      SUM(host_2k) AS host_2k,\n      SUM(host_4k) AS host_4k,\n      SUM(audience_sd) AS audience_sd,\n      SUM(audience_hd) AS audience_hd,\n      SUM(audience_hdp) AS audience_hdp,\n      SUM(audience_1080p) AS audience_1080p,\n      SUM(audience_2k) AS audience_2k,\n      SUM(audience_4k) AS audience_4k,\n      SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n      SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n      SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n      SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n      SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n      SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n      SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n      SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n      SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n      SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n      SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n      SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n      SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n      SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n      SUM(total_last1) AS audio_video_last,\n      SUM(audio_last1) AS audio_last,\n      SUM(video_last1) AS video_last,\n      SUM(video_sd_last1) AS video_sd_last,\n      SUM(video_hd_last1) AS video_hd_last,\n      SUM(video_hdp_last1) AS video_hdp_last,\n      SUM(host_sd_last1) AS host_video_sd_last,\n      SUM(audience_sd_last1) AS audience_video_sd_last,\n      SUM(host_hd_last1) AS host_video_hd_last,\n      SUM(audience_hd_last1) AS audience_video_hd_last,\n      SUM(host_hdp_last1) AS host_video_hdp_last,\n      SUM(audience_hdp_last1) AS audience_video_hdp_last,\n      SUM(host_audio_last1) AS host_audio_last,\n      SUM(audience_audio_last1) AS audience_audio_last,\n      SUM(host_video_last1) AS host_video_last,\n      SUM(audience_video_last1) AS audience_video_last,\n      SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n      SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n      SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n      SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n      SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n      SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n      SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n      SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n      SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n      SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n      SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n      SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n      SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n      SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n      SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n      SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n      SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n      SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n      SUM(audience_2k_last1) AS audience_2k_last1,\n      SUM(audience_4k_last1) AS audience_4k_last1,\n      SUM(audience_1080p_last1) AS audience_1080p_last1,\n      SUM(host_1080p_last1) AS host_1080p_last1,\n      SUM(host_2k_last1) AS host_2k_last1,\n      SUM(host_4k_last1) AS host_4k_last1,\n      SUM(total_last7) AS total_last7,\n      SUM(audio_last7) AS audio_last7,\n      SUM(video_last7) AS video_last7,\n      SUM(video_sd_last7) AS video_sd_last7,\n      SUM(video_hd_last7) AS video_hd_last7,\n      SUM(video_hdp_last7) AS video_hdp_last7,\n      SUM(host_sd_last7) AS host_sd_last7,\n      SUM(audience_sd_last7) AS audience_sd_last7,\n      SUM(host_hd_last7) AS host_hd_last7,\n      SUM(audience_hd_last7) AS audience_hd_last7,\n      SUM(host_hdp_last7) AS host_hdp_last7,\n      SUM(audience_hdp_last7) AS audience_hdp_last7,\n      SUM(host_audio_last7) AS host_audio_last7,\n      SUM(audience_audio_last7) AS audience_audio_last7,\n      SUM(host_video_last7) AS host_video_last7,\n      SUM(audience_video_last7) AS audience_video_last7,\n      SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n      SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n      SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n      SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n      SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n      SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n      SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n      SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n      SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n      SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n      SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n      SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n      SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n      SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n      SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n      SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n      SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n      SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n      SUM(audience_2k_last7) AS audience_2k_last7,\n      SUM(audience_4k_last7) AS audience_4k_last7,\n      SUM(audience_1080p_last7) AS audience_1080p_last7,\n      SUM(host_1080p_last7) AS host_1080p_last7,\n      SUM(host_2k_last7) AS host_2k_last7,\n      SUM(host_4k_last7) AS host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211113 AND date <= 20211212 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n    GROUP BY date,\n      DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n      2,\n      3,\n      tag,\n      area,\n      dim,\n      8,\n      9,\n      10,\n      level4,\n      product_level1,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en,\n      vid_use_case_en,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name) AS \"自定义 SQL 查询\"\nWHERE \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 3 AND CAST(\"自定义 SQL 查询\".\"level1\" AS VARCHAR) = 'RTC'\nGROUP BY 2"
	},
	{
		"presto_sql" : "SELECT \"自定义 SQL 查询\".\"level3\" AS \"level3\"\nFROM (SELECT date,\n      start_date AS start_date,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name,\n      SUM(total) AS totalUsage,\n      SUM(audio) AS audio,\n      SUM(video) AS video,\n      SUM(host_sd + audience_sd) AS video_sd,\n      SUM(host_hd + audience_hd) AS video_hd,\n      SUM(host_hdp + audience_hdp) AS video_hdp,\n      SUM(host_audio) AS host_audio,\n      SUM(audience_audio) AS audience_audio,\n      SUM(host_sd) AS host_sd,\n      SUM(host_hd) AS host_hd,\n      SUM(host_hdp) AS host_hdp,\n      SUM(host_1080p) AS host_1080p,\n      SUM(host_2k) AS host_2k,\n      SUM(host_4k) AS host_4k,\n      SUM(audience_sd) AS audience_sd,\n      SUM(audience_hd) AS audience_hd,\n      SUM(audience_hdp) AS audience_hdp,\n      SUM(audience_1080p) AS audience_1080p,\n      SUM(audience_2k) AS audience_2k,\n      SUM(audience_4k) AS audience_4k,\n      SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n      SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n      SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n      SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n      SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n      SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n      SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n      SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n      SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n      SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n      SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n      SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n      SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n      SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n      SUM(total_last1) AS audio_video_last,\n      SUM(audio_last1) AS audio_last,\n      SUM(video_last1) AS video_last,\n      SUM(video_sd_last1) AS video_sd_last,\n      SUM(video_hd_last1) AS video_hd_last,\n      SUM(video_hdp_last1) AS video_hdp_last,\n      SUM(host_sd_last1) AS host_video_sd_last,\n      SUM(audience_sd_last1) AS audience_video_sd_last,\n      SUM(host_hd_last1) AS host_video_hd_last,\n      SUM(audience_hd_last1) AS audience_video_hd_last,\n      SUM(host_hdp_last1) AS host_video_hdp_last,\n      SUM(audience_hdp_last1) AS audience_video_hdp_last,\n      SUM(host_audio_last1) AS host_audio_last,\n      SUM(audience_audio_last1) AS audience_audio_last,\n      SUM(host_video_last1) AS host_video_last,\n      SUM(audience_video_last1) AS audience_video_last,\n      SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n      SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n      SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n      SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n      SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n      SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n      SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n      SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n      SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n      SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n      SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n      SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n      SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n      SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n      SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n      SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n      SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n      SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n      SUM(audience_2k_last1) AS audience_2k_last1,\n      SUM(audience_4k_last1) AS audience_4k_last1,\n      SUM(audience_1080p_last1) AS audience_1080p_last1,\n      SUM(host_1080p_last1) AS host_1080p_last1,\n      SUM(host_2k_last1) AS host_2k_last1,\n      SUM(host_4k_last1) AS host_4k_last1,\n      SUM(total_last7) AS total_last7,\n      SUM(audio_last7) AS audio_last7,\n      SUM(video_last7) AS video_last7,\n      SUM(video_sd_last7) AS video_sd_last7,\n      SUM(video_hd_last7) AS video_hd_last7,\n      SUM(video_hdp_last7) AS video_hdp_last7,\n      SUM(host_sd_last7) AS host_sd_last7,\n      SUM(audience_sd_last7) AS audience_sd_last7,\n      SUM(host_hd_last7) AS host_hd_last7,\n      SUM(audience_hd_last7) AS audience_hd_last7,\n      SUM(host_hdp_last7) AS host_hdp_last7,\n      SUM(audience_hdp_last7) AS audience_hdp_last7,\n      SUM(host_audio_last7) AS host_audio_last7,\n      SUM(audience_audio_last7) AS audience_audio_last7,\n      SUM(host_video_last7) AS host_video_last7,\n      SUM(audience_video_last7) AS audience_video_last7,\n      SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n      SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n      SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n      SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n      SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n      SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n      SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n      SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n      SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n      SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n      SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n      SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n      SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n      SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n      SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n      SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n      SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n      SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n      SUM(audience_2k_last7) AS audience_2k_last7,\n      SUM(audience_4k_last7) AS audience_4k_last7,\n      SUM(audience_1080p_last7) AS audience_1080p_last7,\n      SUM(host_1080p_last7) AS host_1080p_last7,\n      SUM(host_2k_last7) AS host_2k_last7,\n      SUM(host_4k_last7) AS host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211113 AND date <= 20211212 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n    GROUP BY date,\n      DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n      2,\n      3,\n      tag,\n      area,\n      dim,\n      8,\n      9,\n      10,\n      level4,\n      product_level1,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en,\n      vid_use_case_en,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name) AS \"自定义 SQL 查询\"\nWHERE \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 3 AND CAST(\"自定义 SQL 查询\".\"level1\" AS VARCHAR) = 'RTC'\nGROUP BY 1"
	},
	{
		"presto_sql" : "SELECT \"自定义 SQL 查询\".\"product_level3\" AS \"product_level3\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"usr_Calculation_3519281700079370244_ok\"\nFROM (SELECT date,\n      start_date AS start_date,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name,\n      SUM(total) AS totalUsage,\n      SUM(audio) AS audio,\n      SUM(video) AS video,\n      SUM(host_sd + audience_sd) AS video_sd,\n      SUM(host_hd + audience_hd) AS video_hd,\n      SUM(host_hdp + audience_hdp) AS video_hdp,\n      SUM(host_audio) AS host_audio,\n      SUM(audience_audio) AS audience_audio,\n      SUM(host_sd) AS host_sd,\n      SUM(host_hd) AS host_hd,\n      SUM(host_hdp) AS host_hdp,\n      SUM(host_1080p) AS host_1080p,\n      SUM(host_2k) AS host_2k,\n      SUM(host_4k) AS host_4k,\n      SUM(audience_sd) AS audience_sd,\n      SUM(audience_hd) AS audience_hd,\n      SUM(audience_hdp) AS audience_hdp,\n      SUM(audience_1080p) AS audience_1080p,\n      SUM(audience_2k) AS audience_2k,\n      SUM(audience_4k) AS audience_4k,\n      SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n      SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n      SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n      SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n      SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n      SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n      SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n      SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n      SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n      SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n      SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n      SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n      SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n      SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n      SUM(total_last1) AS audio_video_last,\n      SUM(audio_last1) AS audio_last,\n      SUM(video_last1) AS video_last,\n      SUM(video_sd_last1) AS video_sd_last,\n      SUM(video_hd_last1) AS video_hd_last,\n      SUM(video_hdp_last1) AS video_hdp_last,\n      SUM(host_sd_last1) AS host_video_sd_last,\n      SUM(audience_sd_last1) AS audience_video_sd_last,\n      SUM(host_hd_last1) AS host_video_hd_last,\n      SUM(audience_hd_last1) AS audience_video_hd_last,\n      SUM(host_hdp_last1) AS host_video_hdp_last,\n      SUM(audience_hdp_last1) AS audience_video_hdp_last,\n      SUM(host_audio_last1) AS host_audio_last,\n      SUM(audience_audio_last1) AS audience_audio_last,\n      SUM(host_video_last1) AS host_video_last,\n      SUM(audience_video_last1) AS audience_video_last,\n      SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n      SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n      SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n      SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n      SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n      SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n      SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n      SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n      SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n      SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n      SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n      SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n      SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n      SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n      SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n      SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n      SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n      SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n      SUM(audience_2k_last1) AS audience_2k_last1,\n      SUM(audience_4k_last1) AS audience_4k_last1,\n      SUM(audience_1080p_last1) AS audience_1080p_last1,\n      SUM(host_1080p_last1) AS host_1080p_last1,\n      SUM(host_2k_last1) AS host_2k_last1,\n      SUM(host_4k_last1) AS host_4k_last1,\n      SUM(total_last7) AS total_last7,\n      SUM(audio_last7) AS audio_last7,\n      SUM(video_last7) AS video_last7,\n      SUM(video_sd_last7) AS video_sd_last7,\n      SUM(video_hd_last7) AS video_hd_last7,\n      SUM(video_hdp_last7) AS video_hdp_last7,\n      SUM(host_sd_last7) AS host_sd_last7,\n      SUM(audience_sd_last7) AS audience_sd_last7,\n      SUM(host_hd_last7) AS host_hd_last7,\n      SUM(audience_hd_last7) AS audience_hd_last7,\n      SUM(host_hdp_last7) AS host_hdp_last7,\n      SUM(audience_hdp_last7) AS audience_hdp_last7,\n      SUM(host_audio_last7) AS host_audio_last7,\n      SUM(audience_audio_last7) AS audience_audio_last7,\n      SUM(host_video_last7) AS host_video_last7,\n      SUM(audience_video_last7) AS audience_video_last7,\n      SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n      SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n      SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n      SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n      SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n      SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n      SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n      SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n      SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n      SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n      SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n      SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n      SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n      SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n      SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n      SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n      SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n      SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n      SUM(audience_2k_last7) AS audience_2k_last7,\n      SUM(audience_4k_last7) AS audience_4k_last7,\n      SUM(audience_1080p_last7) AS audience_1080p_last7,\n      SUM(host_1080p_last7) AS host_1080p_last7,\n      SUM(host_2k_last7) AS host_2k_last7,\n      SUM(host_4k_last7) AS host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211113 AND date <= 20211212 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n    GROUP BY date,\n      DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n      2,\n      3,\n      tag,\n      area,\n      dim,\n      8,\n      9,\n      10,\n      level4,\n      product_level1,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en,\n      vid_use_case_en,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n          start_date AS start_date,\n          end_date AS end_date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          tag,\n          area AS Scope,\n          dim,\n            CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n            CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n            CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          browser,\n          browser_ver,\n          dim_grouping_name,\n          SUM(total) AS totalUsage,\n          SUM(audio) AS audio,\n          SUM(video) AS video,\n          SUM(host_sd + audience_sd) AS video_sd,\n          SUM(host_hd + audience_hd) AS video_hd,\n          SUM(host_hdp + audience_hdp) AS video_hdp,\n          SUM(host_audio) AS host_audio,\n          SUM(audience_audio) AS audience_audio,\n          SUM(host_sd) AS host_sd,\n          SUM(host_hd) AS host_hd,\n          SUM(host_hdp) AS host_hdp,\n          SUM(host_1080p) AS host_1080p,\n          SUM(host_2k) AS host_2k,\n          SUM(host_4k) AS host_4k,\n          SUM(audience_sd) AS audience_sd,\n          SUM(audience_hd) AS audience_hd,\n          SUM(audience_hdp) AS audience_hdp,\n          SUM(audience_1080p) AS audience_1080p,\n          SUM(audience_2k) AS audience_2k,\n          SUM(audience_4k) AS audience_4k,\n          SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n          SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n          SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n          SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n          SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n          SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n          SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n          SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n          SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n          SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n          SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n          SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n          SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n          SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n          SUM(total_last1) AS audio_video_last,\n          SUM(audio_last1) AS audio_last,\n          SUM(video_last1) AS video_last,\n          SUM(video_sd_last1) AS video_sd_last,\n          SUM(video_hd_last1) AS video_hd_last,\n          SUM(video_hdp_last1) AS video_hdp_last,\n          SUM(host_sd_last1) AS host_video_sd_last,\n          SUM(audience_sd_last1) AS audience_video_sd_last,\n          SUM(host_hd_last1) AS host_video_hd_last,\n          SUM(audience_hd_last1) AS audience_video_hd_last,\n          SUM(host_hdp_last1) AS host_video_hdp_last,\n          SUM(audience_hdp_last1) AS audience_video_hdp_last,\n          SUM(host_audio_last1) AS host_audio_last,\n          SUM(audience_audio_last1) AS audience_audio_last,\n          SUM(host_video_last1) AS host_video_last,\n          SUM(audience_video_last1) AS audience_video_last,\n          SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n          SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n          SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n          SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n          SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n          SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n          SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n          SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n          SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n          SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n          SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n          SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n          SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n          SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n          SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n          SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n          SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n          SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n          SUM(audience_2k_last1) AS audience_2k_last1,\n          SUM(audience_4k_last1) AS audience_4k_last1,\n          SUM(audience_1080p_last1) AS audience_1080p_last1,\n          SUM(host_1080p_last1) AS host_1080p_last1,\n          SUM(host_2k_last1) AS host_2k_last1,\n          SUM(host_4k_last1) AS host_4k_last1,\n          SUM(total_last7) AS total_last7,\n          SUM(audio_last7) AS audio_last7,\n          SUM(video_last7) AS video_last7,\n          SUM(video_sd_last7) AS video_sd_last7,\n          SUM(video_hd_last7) AS video_hd_last7,\n          SUM(video_hdp_last7) AS video_hdp_last7,\n          SUM(host_sd_last7) AS host_sd_last7,\n          SUM(audience_sd_last7) AS audience_sd_last7,\n          SUM(host_hd_last7) AS host_hd_last7,\n          SUM(audience_hd_last7) AS audience_hd_last7,\n          SUM(host_hdp_last7) AS host_hdp_last7,\n          SUM(audience_hdp_last7) AS audience_hdp_last7,\n          SUM(host_audio_last7) AS host_audio_last7,\n          SUM(audience_audio_last7) AS audience_audio_last7,\n          SUM(host_video_last7) AS host_video_last7,\n          SUM(audience_video_last7) AS audience_video_last7,\n          SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n          SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n          SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n          SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n          SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n          SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n          SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n          SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n          SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n          SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n          SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n          SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n          SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n          SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n          SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n          SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n          SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n          SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n          SUM(audience_2k_last7) AS audience_2k_last7,\n          SUM(audience_4k_last7) AS audience_4k_last7,\n          SUM(audience_1080p_last7) AS audience_1080p_last7,\n          SUM(host_1080p_last7) AS host_1080p_last7,\n          SUM(host_2k_last7) AS host_2k_last7,\n          SUM(host_4k_last7) AS host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211113 AND date <= 20211212 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n        GROUP BY date,\n          DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n          2,\n          3,\n          tag,\n          area,\n          dim,\n          8,\n          9,\n          10,\n          level4,\n          product_level1,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en,\n          vid_use_case_en,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          browser,\n          browser_ver,\n          dim_grouping_name) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 3 AND CAST(\"自定义 SQL 查询\".\"level1\" AS VARCHAR) = 'RTC' AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 1"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700079370244)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700079370244)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700079370244)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700079370244)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700079370244)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700079370244)(943764407)(0)\",\n  MIN(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(1482809429)(0)\",\n  MIN(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(3765460736)(0)\",\n  \"自定义 SQL 查询\".\"stat_date\" AS \"TEMP(attr_stat_date_nk)(2102638629)(0)\",\n  \"自定义 SQL 查询\".\"stat_date\" AS \"TEMP(attr_stat_date_nk)(2790680713)(0)\",\n  \"自定义 SQL 查询\".\"cid_industry\" AS \"cid_industry\",\n  \"自定义 SQL 查询\".\"stat_date\" AS \"stat_date\"\nFROM (SELECT date,\n      start_date AS start_date,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name,\n      SUM(total) AS totalUsage,\n      SUM(audio) AS audio,\n      SUM(video) AS video,\n      SUM(host_sd + audience_sd) AS video_sd,\n      SUM(host_hd + audience_hd) AS video_hd,\n      SUM(host_hdp + audience_hdp) AS video_hdp,\n      SUM(host_audio) AS host_audio,\n      SUM(audience_audio) AS audience_audio,\n      SUM(host_sd) AS host_sd,\n      SUM(host_hd) AS host_hd,\n      SUM(host_hdp) AS host_hdp,\n      SUM(host_1080p) AS host_1080p,\n      SUM(host_2k) AS host_2k,\n      SUM(host_4k) AS host_4k,\n      SUM(audience_sd) AS audience_sd,\n      SUM(audience_hd) AS audience_hd,\n      SUM(audience_hdp) AS audience_hdp,\n      SUM(audience_1080p) AS audience_1080p,\n      SUM(audience_2k) AS audience_2k,\n      SUM(audience_4k) AS audience_4k,\n      SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n      SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n      SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n      SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n      SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n      SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n      SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n      SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n      SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n      SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n      SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n      SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n      SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n      SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n      SUM(total_last1) AS audio_video_last,\n      SUM(audio_last1) AS audio_last,\n      SUM(video_last1) AS video_last,\n      SUM(video_sd_last1) AS video_sd_last,\n      SUM(video_hd_last1) AS video_hd_last,\n      SUM(video_hdp_last1) AS video_hdp_last,\n      SUM(host_sd_last1) AS host_video_sd_last,\n      SUM(audience_sd_last1) AS audience_video_sd_last,\n      SUM(host_hd_last1) AS host_video_hd_last,\n      SUM(audience_hd_last1) AS audience_video_hd_last,\n      SUM(host_hdp_last1) AS host_video_hdp_last,\n      SUM(audience_hdp_last1) AS audience_video_hdp_last,\n      SUM(host_audio_last1) AS host_audio_last,\n      SUM(audience_audio_last1) AS audience_audio_last,\n      SUM(host_video_last1) AS host_video_last,\n      SUM(audience_video_last1) AS audience_video_last,\n      SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n      SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n      SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n      SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n      SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n      SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n      SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n      SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n      SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n      SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n      SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n      SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n      SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n      SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n      SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n      SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n      SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n      SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n      SUM(audience_2k_last1) AS audience_2k_last1,\n      SUM(audience_4k_last1) AS audience_4k_last1,\n      SUM(audience_1080p_last1) AS audience_1080p_last1,\n      SUM(host_1080p_last1) AS host_1080p_last1,\n      SUM(host_2k_last1) AS host_2k_last1,\n      SUM(host_4k_last1) AS host_4k_last1,\n      SUM(total_last7) AS total_last7,\n      SUM(audio_last7) AS audio_last7,\n      SUM(video_last7) AS video_last7,\n      SUM(video_sd_last7) AS video_sd_last7,\n      SUM(video_hd_last7) AS video_hd_last7,\n      SUM(video_hdp_last7) AS video_hdp_last7,\n      SUM(host_sd_last7) AS host_sd_last7,\n      SUM(audience_sd_last7) AS audience_sd_last7,\n      SUM(host_hd_last7) AS host_hd_last7,\n      SUM(audience_hd_last7) AS audience_hd_last7,\n      SUM(host_hdp_last7) AS host_hdp_last7,\n      SUM(audience_hdp_last7) AS audience_hdp_last7,\n      SUM(host_audio_last7) AS host_audio_last7,\n      SUM(audience_audio_last7) AS audience_audio_last7,\n      SUM(host_video_last7) AS host_video_last7,\n      SUM(audience_video_last7) AS audience_video_last7,\n      SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n      SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n      SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n      SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n      SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n      SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n      SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n      SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n      SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n      SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n      SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n      SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n      SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n      SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n      SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n      SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n      SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n      SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n      SUM(audience_2k_last7) AS audience_2k_last7,\n      SUM(audience_4k_last7) AS audience_4k_last7,\n      SUM(audience_1080p_last7) AS audience_1080p_last7,\n      SUM(host_1080p_last7) AS host_1080p_last7,\n      SUM(host_2k_last7) AS host_2k_last7,\n      SUM(host_4k_last7) AS host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211113 AND date <= 20211212 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n    GROUP BY date,\n      DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n      2,\n      3,\n      tag,\n      area,\n      dim,\n      8,\n      9,\n      10,\n      level4,\n      product_level1,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en,\n      vid_use_case_en,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name) AS \"自定义 SQL 查询\"\nWHERE \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 3 AND CAST(\"自定义 SQL 查询\".\"level1\" AS VARCHAR) = 'RTC'\nGROUP BY 22,\n  23"
	},
	{
		"presto_sql" : "SELECT \"自定义 SQL 查询\".\"product_level2\" AS \"product_level2\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"usr_Calculation_3519281700079370244_ok\"\nFROM (SELECT date,\n      start_date AS start_date,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name,\n      SUM(total) AS totalUsage,\n      SUM(audio) AS audio,\n      SUM(video) AS video,\n      SUM(host_sd + audience_sd) AS video_sd,\n      SUM(host_hd + audience_hd) AS video_hd,\n      SUM(host_hdp + audience_hdp) AS video_hdp,\n      SUM(host_audio) AS host_audio,\n      SUM(audience_audio) AS audience_audio,\n      SUM(host_sd) AS host_sd,\n      SUM(host_hd) AS host_hd,\n      SUM(host_hdp) AS host_hdp,\n      SUM(host_1080p) AS host_1080p,\n      SUM(host_2k) AS host_2k,\n      SUM(host_4k) AS host_4k,\n      SUM(audience_sd) AS audience_sd,\n      SUM(audience_hd) AS audience_hd,\n      SUM(audience_hdp) AS audience_hdp,\n      SUM(audience_1080p) AS audience_1080p,\n      SUM(audience_2k) AS audience_2k,\n      SUM(audience_4k) AS audience_4k,\n      SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n      SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n      SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n      SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n      SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n      SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n      SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n      SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n      SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n      SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n      SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n      SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n      SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n      SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n      SUM(total_last1) AS audio_video_last,\n      SUM(audio_last1) AS audio_last,\n      SUM(video_last1) AS video_last,\n      SUM(video_sd_last1) AS video_sd_last,\n      SUM(video_hd_last1) AS video_hd_last,\n      SUM(video_hdp_last1) AS video_hdp_last,\n      SUM(host_sd_last1) AS host_video_sd_last,\n      SUM(audience_sd_last1) AS audience_video_sd_last,\n      SUM(host_hd_last1) AS host_video_hd_last,\n      SUM(audience_hd_last1) AS audience_video_hd_last,\n      SUM(host_hdp_last1) AS host_video_hdp_last,\n      SUM(audience_hdp_last1) AS audience_video_hdp_last,\n      SUM(host_audio_last1) AS host_audio_last,\n      SUM(audience_audio_last1) AS audience_audio_last,\n      SUM(host_video_last1) AS host_video_last,\n      SUM(audience_video_last1) AS audience_video_last,\n      SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n      SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n      SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n      SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n      SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n      SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n      SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n      SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n      SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n      SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n      SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n      SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n      SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n      SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n      SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n      SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n      SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n      SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n      SUM(audience_2k_last1) AS audience_2k_last1,\n      SUM(audience_4k_last1) AS audience_4k_last1,\n      SUM(audience_1080p_last1) AS audience_1080p_last1,\n      SUM(host_1080p_last1) AS host_1080p_last1,\n      SUM(host_2k_last1) AS host_2k_last1,\n      SUM(host_4k_last1) AS host_4k_last1,\n      SUM(total_last7) AS total_last7,\n      SUM(audio_last7) AS audio_last7,\n      SUM(video_last7) AS video_last7,\n      SUM(video_sd_last7) AS video_sd_last7,\n      SUM(video_hd_last7) AS video_hd_last7,\n      SUM(video_hdp_last7) AS video_hdp_last7,\n      SUM(host_sd_last7) AS host_sd_last7,\n      SUM(audience_sd_last7) AS audience_sd_last7,\n      SUM(host_hd_last7) AS host_hd_last7,\n      SUM(audience_hd_last7) AS audience_hd_last7,\n      SUM(host_hdp_last7) AS host_hdp_last7,\n      SUM(audience_hdp_last7) AS audience_hdp_last7,\n      SUM(host_audio_last7) AS host_audio_last7,\n      SUM(audience_audio_last7) AS audience_audio_last7,\n      SUM(host_video_last7) AS host_video_last7,\n      SUM(audience_video_last7) AS audience_video_last7,\n      SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n      SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n      SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n      SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n      SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n      SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n      SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n      SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n      SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n      SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n      SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n      SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n      SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n      SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n      SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n      SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n      SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n      SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n      SUM(audience_2k_last7) AS audience_2k_last7,\n      SUM(audience_4k_last7) AS audience_4k_last7,\n      SUM(audience_1080p_last7) AS audience_1080p_last7,\n      SUM(host_1080p_last7) AS host_1080p_last7,\n      SUM(host_2k_last7) AS host_2k_last7,\n      SUM(host_4k_last7) AS host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211113 AND date <= 20211212 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n    GROUP BY date,\n      DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n      2,\n      3,\n      tag,\n      area,\n      dim,\n      8,\n      9,\n      10,\n      level4,\n      product_level1,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en,\n      vid_use_case_en,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n          start_date AS start_date,\n          end_date AS end_date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          tag,\n          area AS Scope,\n          dim,\n            CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n            CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n            CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          browser,\n          browser_ver,\n          dim_grouping_name,\n          SUM(total) AS totalUsage,\n          SUM(audio) AS audio,\n          SUM(video) AS video,\n          SUM(host_sd + audience_sd) AS video_sd,\n          SUM(host_hd + audience_hd) AS video_hd,\n          SUM(host_hdp + audience_hdp) AS video_hdp,\n          SUM(host_audio) AS host_audio,\n          SUM(audience_audio) AS audience_audio,\n          SUM(host_sd) AS host_sd,\n          SUM(host_hd) AS host_hd,\n          SUM(host_hdp) AS host_hdp,\n          SUM(host_1080p) AS host_1080p,\n          SUM(host_2k) AS host_2k,\n          SUM(host_4k) AS host_4k,\n          SUM(audience_sd) AS audience_sd,\n          SUM(audience_hd) AS audience_hd,\n          SUM(audience_hdp) AS audience_hdp,\n          SUM(audience_1080p) AS audience_1080p,\n          SUM(audience_2k) AS audience_2k,\n          SUM(audience_4k) AS audience_4k,\n          SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n          SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n          SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n          SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n          SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n          SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n          SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n          SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n          SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n          SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n          SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n          SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n          SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n          SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n          SUM(total_last1) AS audio_video_last,\n          SUM(audio_last1) AS audio_last,\n          SUM(video_last1) AS video_last,\n          SUM(video_sd_last1) AS video_sd_last,\n          SUM(video_hd_last1) AS video_hd_last,\n          SUM(video_hdp_last1) AS video_hdp_last,\n          SUM(host_sd_last1) AS host_video_sd_last,\n          SUM(audience_sd_last1) AS audience_video_sd_last,\n          SUM(host_hd_last1) AS host_video_hd_last,\n          SUM(audience_hd_last1) AS audience_video_hd_last,\n          SUM(host_hdp_last1) AS host_video_hdp_last,\n          SUM(audience_hdp_last1) AS audience_video_hdp_last,\n          SUM(host_audio_last1) AS host_audio_last,\n          SUM(audience_audio_last1) AS audience_audio_last,\n          SUM(host_video_last1) AS host_video_last,\n          SUM(audience_video_last1) AS audience_video_last,\n          SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n          SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n          SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n          SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n          SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n          SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n          SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n          SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n          SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n          SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n          SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n          SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n          SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n          SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n          SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n          SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n          SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n          SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n          SUM(audience_2k_last1) AS audience_2k_last1,\n          SUM(audience_4k_last1) AS audience_4k_last1,\n          SUM(audience_1080p_last1) AS audience_1080p_last1,\n          SUM(host_1080p_last1) AS host_1080p_last1,\n          SUM(host_2k_last1) AS host_2k_last1,\n          SUM(host_4k_last1) AS host_4k_last1,\n          SUM(total_last7) AS total_last7,\n          SUM(audio_last7) AS audio_last7,\n          SUM(video_last7) AS video_last7,\n          SUM(video_sd_last7) AS video_sd_last7,\n          SUM(video_hd_last7) AS video_hd_last7,\n          SUM(video_hdp_last7) AS video_hdp_last7,\n          SUM(host_sd_last7) AS host_sd_last7,\n          SUM(audience_sd_last7) AS audience_sd_last7,\n          SUM(host_hd_last7) AS host_hd_last7,\n          SUM(audience_hd_last7) AS audience_hd_last7,\n          SUM(host_hdp_last7) AS host_hdp_last7,\n          SUM(audience_hdp_last7) AS audience_hdp_last7,\n          SUM(host_audio_last7) AS host_audio_last7,\n          SUM(audience_audio_last7) AS audience_audio_last7,\n          SUM(host_video_last7) AS host_video_last7,\n          SUM(audience_video_last7) AS audience_video_last7,\n          SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n          SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n          SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n          SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n          SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n          SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n          SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n          SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n          SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n          SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n          SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n          SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n          SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n          SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n          SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n          SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n          SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n          SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n          SUM(audience_2k_last7) AS audience_2k_last7,\n          SUM(audience_4k_last7) AS audience_4k_last7,\n          SUM(audience_1080p_last7) AS audience_1080p_last7,\n          SUM(host_1080p_last7) AS host_1080p_last7,\n          SUM(host_2k_last7) AS host_2k_last7,\n          SUM(host_4k_last7) AS host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211113 AND date <= 20211212 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n        GROUP BY date,\n          DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n          2,\n          3,\n          tag,\n          area,\n          dim,\n          8,\n          9,\n          10,\n          level4,\n          product_level1,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en,\n          vid_use_case_en,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          browser,\n          browser_ver,\n          dim_grouping_name) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 3 AND CAST(\"自定义 SQL 查询\".\"level1\" AS VARCHAR) = 'RTC' AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 1"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"usr_Calculation_3519281700079370244_ok\",\n  \"自定义 SQL 查询\".\"vid_use_case_cn\" AS \"vid_use_case_cn\"\nFROM (SELECT date,\n      start_date AS start_date,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name,\n      SUM(total) AS totalUsage,\n      SUM(audio) AS audio,\n      SUM(video) AS video,\n      SUM(host_sd + audience_sd) AS video_sd,\n      SUM(host_hd + audience_hd) AS video_hd,\n      SUM(host_hdp + audience_hdp) AS video_hdp,\n      SUM(host_audio) AS host_audio,\n      SUM(audience_audio) AS audience_audio,\n      SUM(host_sd) AS host_sd,\n      SUM(host_hd) AS host_hd,\n      SUM(host_hdp) AS host_hdp,\n      SUM(host_1080p) AS host_1080p,\n      SUM(host_2k) AS host_2k,\n      SUM(host_4k) AS host_4k,\n      SUM(audience_sd) AS audience_sd,\n      SUM(audience_hd) AS audience_hd,\n      SUM(audience_hdp) AS audience_hdp,\n      SUM(audience_1080p) AS audience_1080p,\n      SUM(audience_2k) AS audience_2k,\n      SUM(audience_4k) AS audience_4k,\n      SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n      SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n      SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n      SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n      SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n      SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n      SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n      SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n      SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n      SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n      SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n      SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n      SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n      SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n      SUM(total_last1) AS audio_video_last,\n      SUM(audio_last1) AS audio_last,\n      SUM(video_last1) AS video_last,\n      SUM(video_sd_last1) AS video_sd_last,\n      SUM(video_hd_last1) AS video_hd_last,\n      SUM(video_hdp_last1) AS video_hdp_last,\n      SUM(host_sd_last1) AS host_video_sd_last,\n      SUM(audience_sd_last1) AS audience_video_sd_last,\n      SUM(host_hd_last1) AS host_video_hd_last,\n      SUM(audience_hd_last1) AS audience_video_hd_last,\n      SUM(host_hdp_last1) AS host_video_hdp_last,\n      SUM(audience_hdp_last1) AS audience_video_hdp_last,\n      SUM(host_audio_last1) AS host_audio_last,\n      SUM(audience_audio_last1) AS audience_audio_last,\n      SUM(host_video_last1) AS host_video_last,\n      SUM(audience_video_last1) AS audience_video_last,\n      SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n      SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n      SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n      SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n      SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n      SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n      SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n      SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n      SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n      SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n      SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n      SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n      SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n      SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n      SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n      SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n      SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n      SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n      SUM(audience_2k_last1) AS audience_2k_last1,\n      SUM(audience_4k_last1) AS audience_4k_last1,\n      SUM(audience_1080p_last1) AS audience_1080p_last1,\n      SUM(host_1080p_last1) AS host_1080p_last1,\n      SUM(host_2k_last1) AS host_2k_last1,\n      SUM(host_4k_last1) AS host_4k_last1,\n      SUM(total_last7) AS total_last7,\n      SUM(audio_last7) AS audio_last7,\n      SUM(video_last7) AS video_last7,\n      SUM(video_sd_last7) AS video_sd_last7,\n      SUM(video_hd_last7) AS video_hd_last7,\n      SUM(video_hdp_last7) AS video_hdp_last7,\n      SUM(host_sd_last7) AS host_sd_last7,\n      SUM(audience_sd_last7) AS audience_sd_last7,\n      SUM(host_hd_last7) AS host_hd_last7,\n      SUM(audience_hd_last7) AS audience_hd_last7,\n      SUM(host_hdp_last7) AS host_hdp_last7,\n      SUM(audience_hdp_last7) AS audience_hdp_last7,\n      SUM(host_audio_last7) AS host_audio_last7,\n      SUM(audience_audio_last7) AS audience_audio_last7,\n      SUM(host_video_last7) AS host_video_last7,\n      SUM(audience_video_last7) AS audience_video_last7,\n      SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n      SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n      SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n      SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n      SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n      SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n      SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n      SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n      SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n      SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n      SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n      SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n      SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n      SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n      SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n      SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n      SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n      SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n      SUM(audience_2k_last7) AS audience_2k_last7,\n      SUM(audience_4k_last7) AS audience_4k_last7,\n      SUM(audience_1080p_last7) AS audience_1080p_last7,\n      SUM(host_1080p_last7) AS host_1080p_last7,\n      SUM(host_2k_last7) AS host_2k_last7,\n      SUM(host_4k_last7) AS host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211113 AND date <= 20211212 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n    GROUP BY date,\n      DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n      2,\n      3,\n      tag,\n      area,\n      dim,\n      8,\n      9,\n      10,\n      level4,\n      product_level1,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en,\n      vid_use_case_en,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n          start_date AS start_date,\n          end_date AS end_date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          tag,\n          area AS Scope,\n          dim,\n            CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n            CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n            CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          browser,\n          browser_ver,\n          dim_grouping_name,\n          SUM(total) AS totalUsage,\n          SUM(audio) AS audio,\n          SUM(video) AS video,\n          SUM(host_sd + audience_sd) AS video_sd,\n          SUM(host_hd + audience_hd) AS video_hd,\n          SUM(host_hdp + audience_hdp) AS video_hdp,\n          SUM(host_audio) AS host_audio,\n          SUM(audience_audio) AS audience_audio,\n          SUM(host_sd) AS host_sd,\n          SUM(host_hd) AS host_hd,\n          SUM(host_hdp) AS host_hdp,\n          SUM(host_1080p) AS host_1080p,\n          SUM(host_2k) AS host_2k,\n          SUM(host_4k) AS host_4k,\n          SUM(audience_sd) AS audience_sd,\n          SUM(audience_hd) AS audience_hd,\n          SUM(audience_hdp) AS audience_hdp,\n          SUM(audience_1080p) AS audience_1080p,\n          SUM(audience_2k) AS audience_2k,\n          SUM(audience_4k) AS audience_4k,\n          SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n          SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n          SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n          SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n          SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n          SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n          SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n          SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n          SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n          SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n          SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n          SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n          SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n          SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n          SUM(total_last1) AS audio_video_last,\n          SUM(audio_last1) AS audio_last,\n          SUM(video_last1) AS video_last,\n          SUM(video_sd_last1) AS video_sd_last,\n          SUM(video_hd_last1) AS video_hd_last,\n          SUM(video_hdp_last1) AS video_hdp_last,\n          SUM(host_sd_last1) AS host_video_sd_last,\n          SUM(audience_sd_last1) AS audience_video_sd_last,\n          SUM(host_hd_last1) AS host_video_hd_last,\n          SUM(audience_hd_last1) AS audience_video_hd_last,\n          SUM(host_hdp_last1) AS host_video_hdp_last,\n          SUM(audience_hdp_last1) AS audience_video_hdp_last,\n          SUM(host_audio_last1) AS host_audio_last,\n          SUM(audience_audio_last1) AS audience_audio_last,\n          SUM(host_video_last1) AS host_video_last,\n          SUM(audience_video_last1) AS audience_video_last,\n          SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n          SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n          SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n          SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n          SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n          SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n          SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n          SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n          SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n          SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n          SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n          SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n          SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n          SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n          SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n          SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n          SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n          SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n          SUM(audience_2k_last1) AS audience_2k_last1,\n          SUM(audience_4k_last1) AS audience_4k_last1,\n          SUM(audience_1080p_last1) AS audience_1080p_last1,\n          SUM(host_1080p_last1) AS host_1080p_last1,\n          SUM(host_2k_last1) AS host_2k_last1,\n          SUM(host_4k_last1) AS host_4k_last1,\n          SUM(total_last7) AS total_last7,\n          SUM(audio_last7) AS audio_last7,\n          SUM(video_last7) AS video_last7,\n          SUM(video_sd_last7) AS video_sd_last7,\n          SUM(video_hd_last7) AS video_hd_last7,\n          SUM(video_hdp_last7) AS video_hdp_last7,\n          SUM(host_sd_last7) AS host_sd_last7,\n          SUM(audience_sd_last7) AS audience_sd_last7,\n          SUM(host_hd_last7) AS host_hd_last7,\n          SUM(audience_hd_last7) AS audience_hd_last7,\n          SUM(host_hdp_last7) AS host_hdp_last7,\n          SUM(audience_hdp_last7) AS audience_hdp_last7,\n          SUM(host_audio_last7) AS host_audio_last7,\n          SUM(audience_audio_last7) AS audience_audio_last7,\n          SUM(host_video_last7) AS host_video_last7,\n          SUM(audience_video_last7) AS audience_video_last7,\n          SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n          SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n          SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n          SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n          SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n          SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n          SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n          SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n          SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n          SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n          SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n          SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n          SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n          SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n          SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n          SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n          SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n          SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n          SUM(audience_2k_last7) AS audience_2k_last7,\n          SUM(audience_4k_last7) AS audience_4k_last7,\n          SUM(audience_1080p_last7) AS audience_1080p_last7,\n          SUM(host_1080p_last7) AS host_1080p_last7,\n          SUM(host_2k_last7) AS host_2k_last7,\n          SUM(host_4k_last7) AS host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211113 AND date <= 20211212 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n        GROUP BY date,\n          DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n          2,\n          3,\n          tag,\n          area,\n          dim,\n          8,\n          9,\n          10,\n          level4,\n          product_level1,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en,\n          vid_use_case_en,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          browser,\n          browser_ver,\n          dim_grouping_name) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 3 AND CAST(\"自定义 SQL 查询\".\"level1\" AS VARCHAR) = 'RTC' AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 2"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"usr_Calculation_3519281700079370244_ok\",\n  \"自定义 SQL 查询\".\"vid_sector_en\" AS \"vid_sector_en\"\nFROM (SELECT date,\n      start_date AS start_date,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name,\n      SUM(total) AS totalUsage,\n      SUM(audio) AS audio,\n      SUM(video) AS video,\n      SUM(host_sd + audience_sd) AS video_sd,\n      SUM(host_hd + audience_hd) AS video_hd,\n      SUM(host_hdp + audience_hdp) AS video_hdp,\n      SUM(host_audio) AS host_audio,\n      SUM(audience_audio) AS audience_audio,\n      SUM(host_sd) AS host_sd,\n      SUM(host_hd) AS host_hd,\n      SUM(host_hdp) AS host_hdp,\n      SUM(host_1080p) AS host_1080p,\n      SUM(host_2k) AS host_2k,\n      SUM(host_4k) AS host_4k,\n      SUM(audience_sd) AS audience_sd,\n      SUM(audience_hd) AS audience_hd,\n      SUM(audience_hdp) AS audience_hdp,\n      SUM(audience_1080p) AS audience_1080p,\n      SUM(audience_2k) AS audience_2k,\n      SUM(audience_4k) AS audience_4k,\n      SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n      SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n      SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n      SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n      SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n      SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n      SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n      SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n      SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n      SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n      SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n      SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n      SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n      SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n      SUM(total_last1) AS audio_video_last,\n      SUM(audio_last1) AS audio_last,\n      SUM(video_last1) AS video_last,\n      SUM(video_sd_last1) AS video_sd_last,\n      SUM(video_hd_last1) AS video_hd_last,\n      SUM(video_hdp_last1) AS video_hdp_last,\n      SUM(host_sd_last1) AS host_video_sd_last,\n      SUM(audience_sd_last1) AS audience_video_sd_last,\n      SUM(host_hd_last1) AS host_video_hd_last,\n      SUM(audience_hd_last1) AS audience_video_hd_last,\n      SUM(host_hdp_last1) AS host_video_hdp_last,\n      SUM(audience_hdp_last1) AS audience_video_hdp_last,\n      SUM(host_audio_last1) AS host_audio_last,\n      SUM(audience_audio_last1) AS audience_audio_last,\n      SUM(host_video_last1) AS host_video_last,\n      SUM(audience_video_last1) AS audience_video_last,\n      SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n      SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n      SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n      SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n      SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n      SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n      SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n      SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n      SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n      SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n      SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n      SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n      SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n      SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n      SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n      SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n      SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n      SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n      SUM(audience_2k_last1) AS audience_2k_last1,\n      SUM(audience_4k_last1) AS audience_4k_last1,\n      SUM(audience_1080p_last1) AS audience_1080p_last1,\n      SUM(host_1080p_last1) AS host_1080p_last1,\n      SUM(host_2k_last1) AS host_2k_last1,\n      SUM(host_4k_last1) AS host_4k_last1,\n      SUM(total_last7) AS total_last7,\n      SUM(audio_last7) AS audio_last7,\n      SUM(video_last7) AS video_last7,\n      SUM(video_sd_last7) AS video_sd_last7,\n      SUM(video_hd_last7) AS video_hd_last7,\n      SUM(video_hdp_last7) AS video_hdp_last7,\n      SUM(host_sd_last7) AS host_sd_last7,\n      SUM(audience_sd_last7) AS audience_sd_last7,\n      SUM(host_hd_last7) AS host_hd_last7,\n      SUM(audience_hd_last7) AS audience_hd_last7,\n      SUM(host_hdp_last7) AS host_hdp_last7,\n      SUM(audience_hdp_last7) AS audience_hdp_last7,\n      SUM(host_audio_last7) AS host_audio_last7,\n      SUM(audience_audio_last7) AS audience_audio_last7,\n      SUM(host_video_last7) AS host_video_last7,\n      SUM(audience_video_last7) AS audience_video_last7,\n      SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n      SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n      SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n      SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n      SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n      SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n      SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n      SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n      SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n      SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n      SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n      SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n      SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n      SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n      SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n      SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n      SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n      SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n      SUM(audience_2k_last7) AS audience_2k_last7,\n      SUM(audience_4k_last7) AS audience_4k_last7,\n      SUM(audience_1080p_last7) AS audience_1080p_last7,\n      SUM(host_1080p_last7) AS host_1080p_last7,\n      SUM(host_2k_last7) AS host_2k_last7,\n      SUM(host_4k_last7) AS host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211113 AND date <= 20211212 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n    GROUP BY date,\n      DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n      2,\n      3,\n      tag,\n      area,\n      dim,\n      8,\n      9,\n      10,\n      level4,\n      product_level1,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en,\n      vid_use_case_en,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n          start_date AS start_date,\n          end_date AS end_date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          tag,\n          area AS Scope,\n          dim,\n            CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n            CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n            CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          browser,\n          browser_ver,\n          dim_grouping_name,\n          SUM(total) AS totalUsage,\n          SUM(audio) AS audio,\n          SUM(video) AS video,\n          SUM(host_sd + audience_sd) AS video_sd,\n          SUM(host_hd + audience_hd) AS video_hd,\n          SUM(host_hdp + audience_hdp) AS video_hdp,\n          SUM(host_audio) AS host_audio,\n          SUM(audience_audio) AS audience_audio,\n          SUM(host_sd) AS host_sd,\n          SUM(host_hd) AS host_hd,\n          SUM(host_hdp) AS host_hdp,\n          SUM(host_1080p) AS host_1080p,\n          SUM(host_2k) AS host_2k,\n          SUM(host_4k) AS host_4k,\n          SUM(audience_sd) AS audience_sd,\n          SUM(audience_hd) AS audience_hd,\n          SUM(audience_hdp) AS audience_hdp,\n          SUM(audience_1080p) AS audience_1080p,\n          SUM(audience_2k) AS audience_2k,\n          SUM(audience_4k) AS audience_4k,\n          SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n          SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n          SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n          SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n          SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n          SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n          SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n          SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n          SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n          SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n          SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n          SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n          SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n          SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n          SUM(total_last1) AS audio_video_last,\n          SUM(audio_last1) AS audio_last,\n          SUM(video_last1) AS video_last,\n          SUM(video_sd_last1) AS video_sd_last,\n          SUM(video_hd_last1) AS video_hd_last,\n          SUM(video_hdp_last1) AS video_hdp_last,\n          SUM(host_sd_last1) AS host_video_sd_last,\n          SUM(audience_sd_last1) AS audience_video_sd_last,\n          SUM(host_hd_last1) AS host_video_hd_last,\n          SUM(audience_hd_last1) AS audience_video_hd_last,\n          SUM(host_hdp_last1) AS host_video_hdp_last,\n          SUM(audience_hdp_last1) AS audience_video_hdp_last,\n          SUM(host_audio_last1) AS host_audio_last,\n          SUM(audience_audio_last1) AS audience_audio_last,\n          SUM(host_video_last1) AS host_video_last,\n          SUM(audience_video_last1) AS audience_video_last,\n          SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n          SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n          SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n          SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n          SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n          SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n          SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n          SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n          SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n          SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n          SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n          SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n          SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n          SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n          SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n          SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n          SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n          SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n          SUM(audience_2k_last1) AS audience_2k_last1,\n          SUM(audience_4k_last1) AS audience_4k_last1,\n          SUM(audience_1080p_last1) AS audience_1080p_last1,\n          SUM(host_1080p_last1) AS host_1080p_last1,\n          SUM(host_2k_last1) AS host_2k_last1,\n          SUM(host_4k_last1) AS host_4k_last1,\n          SUM(total_last7) AS total_last7,\n          SUM(audio_last7) AS audio_last7,\n          SUM(video_last7) AS video_last7,\n          SUM(video_sd_last7) AS video_sd_last7,\n          SUM(video_hd_last7) AS video_hd_last7,\n          SUM(video_hdp_last7) AS video_hdp_last7,\n          SUM(host_sd_last7) AS host_sd_last7,\n          SUM(audience_sd_last7) AS audience_sd_last7,\n          SUM(host_hd_last7) AS host_hd_last7,\n          SUM(audience_hd_last7) AS audience_hd_last7,\n          SUM(host_hdp_last7) AS host_hdp_last7,\n          SUM(audience_hdp_last7) AS audience_hdp_last7,\n          SUM(host_audio_last7) AS host_audio_last7,\n          SUM(audience_audio_last7) AS audience_audio_last7,\n          SUM(host_video_last7) AS host_video_last7,\n          SUM(audience_video_last7) AS audience_video_last7,\n          SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n          SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n          SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n          SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n          SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n          SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n          SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n          SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n          SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n          SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n          SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n          SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n          SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n          SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n          SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n          SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n          SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n          SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n          SUM(audience_2k_last7) AS audience_2k_last7,\n          SUM(audience_4k_last7) AS audience_4k_last7,\n          SUM(audience_1080p_last7) AS audience_1080p_last7,\n          SUM(host_1080p_last7) AS host_1080p_last7,\n          SUM(host_2k_last7) AS host_2k_last7,\n          SUM(host_4k_last7) AS host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211113 AND date <= 20211212 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n        GROUP BY date,\n          DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n          2,\n          3,\n          tag,\n          area,\n          dim,\n          8,\n          9,\n          10,\n          level4,\n          product_level1,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en,\n          vid_use_case_en,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          browser,\n          browser_ver,\n          dim_grouping_name) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 3 AND CAST(\"自定义 SQL 查询\".\"level1\" AS VARCHAR) = 'RTC' AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 2"
	},
	{
		"presto_sql" : "SELECT \"自定义 SQL 查询\".\"cid_industry\" AS \"cid_industry\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"usr_Calculation_3519281700079370244_ok\"\nFROM (SELECT date,\n      start_date AS start_date,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name,\n      SUM(total) AS totalUsage,\n      SUM(audio) AS audio,\n      SUM(video) AS video,\n      SUM(host_sd + audience_sd) AS video_sd,\n      SUM(host_hd + audience_hd) AS video_hd,\n      SUM(host_hdp + audience_hdp) AS video_hdp,\n      SUM(host_audio) AS host_audio,\n      SUM(audience_audio) AS audience_audio,\n      SUM(host_sd) AS host_sd,\n      SUM(host_hd) AS host_hd,\n      SUM(host_hdp) AS host_hdp,\n      SUM(host_1080p) AS host_1080p,\n      SUM(host_2k) AS host_2k,\n      SUM(host_4k) AS host_4k,\n      SUM(audience_sd) AS audience_sd,\n      SUM(audience_hd) AS audience_hd,\n      SUM(audience_hdp) AS audience_hdp,\n      SUM(audience_1080p) AS audience_1080p,\n      SUM(audience_2k) AS audience_2k,\n      SUM(audience_4k) AS audience_4k,\n      SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n      SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n      SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n      SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n      SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n      SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n      SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n      SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n      SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n      SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n      SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n      SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n      SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n      SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n      SUM(total_last1) AS audio_video_last,\n      SUM(audio_last1) AS audio_last,\n      SUM(video_last1) AS video_last,\n      SUM(video_sd_last1) AS video_sd_last,\n      SUM(video_hd_last1) AS video_hd_last,\n      SUM(video_hdp_last1) AS video_hdp_last,\n      SUM(host_sd_last1) AS host_video_sd_last,\n      SUM(audience_sd_last1) AS audience_video_sd_last,\n      SUM(host_hd_last1) AS host_video_hd_last,\n      SUM(audience_hd_last1) AS audience_video_hd_last,\n      SUM(host_hdp_last1) AS host_video_hdp_last,\n      SUM(audience_hdp_last1) AS audience_video_hdp_last,\n      SUM(host_audio_last1) AS host_audio_last,\n      SUM(audience_audio_last1) AS audience_audio_last,\n      SUM(host_video_last1) AS host_video_last,\n      SUM(audience_video_last1) AS audience_video_last,\n      SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n      SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n      SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n      SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n      SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n      SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n      SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n      SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n      SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n      SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n      SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n      SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n      SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n      SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n      SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n      SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n      SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n      SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n      SUM(audience_2k_last1) AS audience_2k_last1,\n      SUM(audience_4k_last1) AS audience_4k_last1,\n      SUM(audience_1080p_last1) AS audience_1080p_last1,\n      SUM(host_1080p_last1) AS host_1080p_last1,\n      SUM(host_2k_last1) AS host_2k_last1,\n      SUM(host_4k_last1) AS host_4k_last1,\n      SUM(total_last7) AS total_last7,\n      SUM(audio_last7) AS audio_last7,\n      SUM(video_last7) AS video_last7,\n      SUM(video_sd_last7) AS video_sd_last7,\n      SUM(video_hd_last7) AS video_hd_last7,\n      SUM(video_hdp_last7) AS video_hdp_last7,\n      SUM(host_sd_last7) AS host_sd_last7,\n      SUM(audience_sd_last7) AS audience_sd_last7,\n      SUM(host_hd_last7) AS host_hd_last7,\n      SUM(audience_hd_last7) AS audience_hd_last7,\n      SUM(host_hdp_last7) AS host_hdp_last7,\n      SUM(audience_hdp_last7) AS audience_hdp_last7,\n      SUM(host_audio_last7) AS host_audio_last7,\n      SUM(audience_audio_last7) AS audience_audio_last7,\n      SUM(host_video_last7) AS host_video_last7,\n      SUM(audience_video_last7) AS audience_video_last7,\n      SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n      SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n      SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n      SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n      SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n      SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n      SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n      SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n      SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n      SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n      SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n      SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n      SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n      SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n      SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n      SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n      SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n      SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n      SUM(audience_2k_last7) AS audience_2k_last7,\n      SUM(audience_4k_last7) AS audience_4k_last7,\n      SUM(audience_1080p_last7) AS audience_1080p_last7,\n      SUM(host_1080p_last7) AS host_1080p_last7,\n      SUM(host_2k_last7) AS host_2k_last7,\n      SUM(host_4k_last7) AS host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211113 AND date <= 20211212 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n    GROUP BY date,\n      DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n      2,\n      3,\n      tag,\n      area,\n      dim,\n      8,\n      9,\n      10,\n      level4,\n      product_level1,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en,\n      vid_use_case_en,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n          start_date AS start_date,\n          end_date AS end_date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          tag,\n          area AS Scope,\n          dim,\n            CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n            CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n            CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          browser,\n          browser_ver,\n          dim_grouping_name,\n          SUM(total) AS totalUsage,\n          SUM(audio) AS audio,\n          SUM(video) AS video,\n          SUM(host_sd + audience_sd) AS video_sd,\n          SUM(host_hd + audience_hd) AS video_hd,\n          SUM(host_hdp + audience_hdp) AS video_hdp,\n          SUM(host_audio) AS host_audio,\n          SUM(audience_audio) AS audience_audio,\n          SUM(host_sd) AS host_sd,\n          SUM(host_hd) AS host_hd,\n          SUM(host_hdp) AS host_hdp,\n          SUM(host_1080p) AS host_1080p,\n          SUM(host_2k) AS host_2k,\n          SUM(host_4k) AS host_4k,\n          SUM(audience_sd) AS audience_sd,\n          SUM(audience_hd) AS audience_hd,\n          SUM(audience_hdp) AS audience_hdp,\n          SUM(audience_1080p) AS audience_1080p,\n          SUM(audience_2k) AS audience_2k,\n          SUM(audience_4k) AS audience_4k,\n          SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n          SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n          SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n          SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n          SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n          SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n          SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n          SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n          SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n          SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n          SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n          SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n          SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n          SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n          SUM(total_last1) AS audio_video_last,\n          SUM(audio_last1) AS audio_last,\n          SUM(video_last1) AS video_last,\n          SUM(video_sd_last1) AS video_sd_last,\n          SUM(video_hd_last1) AS video_hd_last,\n          SUM(video_hdp_last1) AS video_hdp_last,\n          SUM(host_sd_last1) AS host_video_sd_last,\n          SUM(audience_sd_last1) AS audience_video_sd_last,\n          SUM(host_hd_last1) AS host_video_hd_last,\n          SUM(audience_hd_last1) AS audience_video_hd_last,\n          SUM(host_hdp_last1) AS host_video_hdp_last,\n          SUM(audience_hdp_last1) AS audience_video_hdp_last,\n          SUM(host_audio_last1) AS host_audio_last,\n          SUM(audience_audio_last1) AS audience_audio_last,\n          SUM(host_video_last1) AS host_video_last,\n          SUM(audience_video_last1) AS audience_video_last,\n          SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n          SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n          SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n          SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n          SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n          SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n          SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n          SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n          SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n          SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n          SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n          SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n          SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n          SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n          SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n          SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n          SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n          SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n          SUM(audience_2k_last1) AS audience_2k_last1,\n          SUM(audience_4k_last1) AS audience_4k_last1,\n          SUM(audience_1080p_last1) AS audience_1080p_last1,\n          SUM(host_1080p_last1) AS host_1080p_last1,\n          SUM(host_2k_last1) AS host_2k_last1,\n          SUM(host_4k_last1) AS host_4k_last1,\n          SUM(total_last7) AS total_last7,\n          SUM(audio_last7) AS audio_last7,\n          SUM(video_last7) AS video_last7,\n          SUM(video_sd_last7) AS video_sd_last7,\n          SUM(video_hd_last7) AS video_hd_last7,\n          SUM(video_hdp_last7) AS video_hdp_last7,\n          SUM(host_sd_last7) AS host_sd_last7,\n          SUM(audience_sd_last7) AS audience_sd_last7,\n          SUM(host_hd_last7) AS host_hd_last7,\n          SUM(audience_hd_last7) AS audience_hd_last7,\n          SUM(host_hdp_last7) AS host_hdp_last7,\n          SUM(audience_hdp_last7) AS audience_hdp_last7,\n          SUM(host_audio_last7) AS host_audio_last7,\n          SUM(audience_audio_last7) AS audience_audio_last7,\n          SUM(host_video_last7) AS host_video_last7,\n          SUM(audience_video_last7) AS audience_video_last7,\n          SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n          SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n          SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n          SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n          SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n          SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n          SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n          SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n          SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n          SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n          SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n          SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n          SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n          SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n          SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n          SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n          SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n          SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n          SUM(audience_2k_last7) AS audience_2k_last7,\n          SUM(audience_4k_last7) AS audience_4k_last7,\n          SUM(audience_1080p_last7) AS audience_1080p_last7,\n          SUM(host_1080p_last7) AS host_1080p_last7,\n          SUM(host_2k_last7) AS host_2k_last7,\n          SUM(host_4k_last7) AS host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211113 AND date <= 20211212 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n        GROUP BY date,\n          DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n          2,\n          3,\n          tag,\n          area,\n          dim,\n          8,\n          9,\n          10,\n          level4,\n          product_level1,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en,\n          vid_use_case_en,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          browser,\n          browser_ver,\n          dim_grouping_name) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 3 AND CAST(\"自定义 SQL 查询\".\"level1\" AS VARCHAR) = 'RTC' AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 1"
	},
	{
		"presto_sql" : "SELECT \"自定义 SQL 查询\".\"cid_industry\" AS \"cid_industry\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"usr_Calculation_3519281700079370244_ok\"\nFROM (SELECT date,\n      start_date AS start_date,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name,\n      SUM(total) AS totalUsage,\n      SUM(audio) AS audio,\n      SUM(video) AS video,\n      SUM(host_sd + audience_sd) AS video_sd,\n      SUM(host_hd + audience_hd) AS video_hd,\n      SUM(host_hdp + audience_hdp) AS video_hdp,\n      SUM(host_audio) AS host_audio,\n      SUM(audience_audio) AS audience_audio,\n      SUM(host_sd) AS host_sd,\n      SUM(host_hd) AS host_hd,\n      SUM(host_hdp) AS host_hdp,\n      SUM(host_1080p) AS host_1080p,\n      SUM(host_2k) AS host_2k,\n      SUM(host_4k) AS host_4k,\n      SUM(audience_sd) AS audience_sd,\n      SUM(audience_hd) AS audience_hd,\n      SUM(audience_hdp) AS audience_hdp,\n      SUM(audience_1080p) AS audience_1080p,\n      SUM(audience_2k) AS audience_2k,\n      SUM(audience_4k) AS audience_4k,\n      SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n      SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n      SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n      SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n      SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n      SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n      SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n      SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n      SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n      SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n      SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n      SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n      SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n      SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n      SUM(total_last1) AS audio_video_last,\n      SUM(audio_last1) AS audio_last,\n      SUM(video_last1) AS video_last,\n      SUM(video_sd_last1) AS video_sd_last,\n      SUM(video_hd_last1) AS video_hd_last,\n      SUM(video_hdp_last1) AS video_hdp_last,\n      SUM(host_sd_last1) AS host_video_sd_last,\n      SUM(audience_sd_last1) AS audience_video_sd_last,\n      SUM(host_hd_last1) AS host_video_hd_last,\n      SUM(audience_hd_last1) AS audience_video_hd_last,\n      SUM(host_hdp_last1) AS host_video_hdp_last,\n      SUM(audience_hdp_last1) AS audience_video_hdp_last,\n      SUM(host_audio_last1) AS host_audio_last,\n      SUM(audience_audio_last1) AS audience_audio_last,\n      SUM(host_video_last1) AS host_video_last,\n      SUM(audience_video_last1) AS audience_video_last,\n      SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n      SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n      SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n      SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n      SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n      SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n      SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n      SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n      SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n      SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n      SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n      SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n      SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n      SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n      SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n      SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n      SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n      SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n      SUM(audience_2k_last1) AS audience_2k_last1,\n      SUM(audience_4k_last1) AS audience_4k_last1,\n      SUM(audience_1080p_last1) AS audience_1080p_last1,\n      SUM(host_1080p_last1) AS host_1080p_last1,\n      SUM(host_2k_last1) AS host_2k_last1,\n      SUM(host_4k_last1) AS host_4k_last1,\n      SUM(total_last7) AS total_last7,\n      SUM(audio_last7) AS audio_last7,\n      SUM(video_last7) AS video_last7,\n      SUM(video_sd_last7) AS video_sd_last7,\n      SUM(video_hd_last7) AS video_hd_last7,\n      SUM(video_hdp_last7) AS video_hdp_last7,\n      SUM(host_sd_last7) AS host_sd_last7,\n      SUM(audience_sd_last7) AS audience_sd_last7,\n      SUM(host_hd_last7) AS host_hd_last7,\n      SUM(audience_hd_last7) AS audience_hd_last7,\n      SUM(host_hdp_last7) AS host_hdp_last7,\n      SUM(audience_hdp_last7) AS audience_hdp_last7,\n      SUM(host_audio_last7) AS host_audio_last7,\n      SUM(audience_audio_last7) AS audience_audio_last7,\n      SUM(host_video_last7) AS host_video_last7,\n      SUM(audience_video_last7) AS audience_video_last7,\n      SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n      SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n      SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n      SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n      SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n      SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n      SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n      SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n      SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n      SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n      SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n      SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n      SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n      SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n      SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n      SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n      SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n      SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n      SUM(audience_2k_last7) AS audience_2k_last7,\n      SUM(audience_4k_last7) AS audience_4k_last7,\n      SUM(audience_1080p_last7) AS audience_1080p_last7,\n      SUM(host_1080p_last7) AS host_1080p_last7,\n      SUM(host_2k_last7) AS host_2k_last7,\n      SUM(host_4k_last7) AS host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211113 AND date <= 20211212 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n    GROUP BY date,\n      DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n      2,\n      3,\n      tag,\n      area,\n      dim,\n      8,\n      9,\n      10,\n      level4,\n      product_level1,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en,\n      vid_use_case_en,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name) AS \"自定义 SQL 查询\"\nWHERE \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 3 AND CAST(\"自定义 SQL 查询\".\"level1\" AS VARCHAR) = 'RTC'\nGROUP BY 1"
	},
	{
		"presto_sql" : "SELECT \"自定义 SQL 查询\".\"cid_industry\" AS \"cid_industry\",\n  \"自定义 SQL 查询\".\"stat_date\" AS \"stat_date\"\nFROM (SELECT date,\n      start_date AS start_date,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name,\n      SUM(total) AS totalUsage,\n      SUM(audio) AS audio,\n      SUM(video) AS video,\n      SUM(host_sd + audience_sd) AS video_sd,\n      SUM(host_hd + audience_hd) AS video_hd,\n      SUM(host_hdp + audience_hdp) AS video_hdp,\n      SUM(host_audio) AS host_audio,\n      SUM(audience_audio) AS audience_audio,\n      SUM(host_sd) AS host_sd,\n      SUM(host_hd) AS host_hd,\n      SUM(host_hdp) AS host_hdp,\n      SUM(host_1080p) AS host_1080p,\n      SUM(host_2k) AS host_2k,\n      SUM(host_4k) AS host_4k,\n      SUM(audience_sd) AS audience_sd,\n      SUM(audience_hd) AS audience_hd,\n      SUM(audience_hdp) AS audience_hdp,\n      SUM(audience_1080p) AS audience_1080p,\n      SUM(audience_2k) AS audience_2k,\n      SUM(audience_4k) AS audience_4k,\n      SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n      SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n      SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n      SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n      SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n      SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n      SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n      SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n      SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n      SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n      SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n      SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n      SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n      SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n      SUM(total_last1) AS audio_video_last,\n      SUM(audio_last1) AS audio_last,\n      SUM(video_last1) AS video_last,\n      SUM(video_sd_last1) AS video_sd_last,\n      SUM(video_hd_last1) AS video_hd_last,\n      SUM(video_hdp_last1) AS video_hdp_last,\n      SUM(host_sd_last1) AS host_video_sd_last,\n      SUM(audience_sd_last1) AS audience_video_sd_last,\n      SUM(host_hd_last1) AS host_video_hd_last,\n      SUM(audience_hd_last1) AS audience_video_hd_last,\n      SUM(host_hdp_last1) AS host_video_hdp_last,\n      SUM(audience_hdp_last1) AS audience_video_hdp_last,\n      SUM(host_audio_last1) AS host_audio_last,\n      SUM(audience_audio_last1) AS audience_audio_last,\n      SUM(host_video_last1) AS host_video_last,\n      SUM(audience_video_last1) AS audience_video_last,\n      SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n      SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n      SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n      SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n      SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n      SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n      SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n      SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n      SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n      SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n      SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n      SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n      SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n      SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n      SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n      SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n      SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n      SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n      SUM(audience_2k_last1) AS audience_2k_last1,\n      SUM(audience_4k_last1) AS audience_4k_last1,\n      SUM(audience_1080p_last1) AS audience_1080p_last1,\n      SUM(host_1080p_last1) AS host_1080p_last1,\n      SUM(host_2k_last1) AS host_2k_last1,\n      SUM(host_4k_last1) AS host_4k_last1,\n      SUM(total_last7) AS total_last7,\n      SUM(audio_last7) AS audio_last7,\n      SUM(video_last7) AS video_last7,\n      SUM(video_sd_last7) AS video_sd_last7,\n      SUM(video_hd_last7) AS video_hd_last7,\n      SUM(video_hdp_last7) AS video_hdp_last7,\n      SUM(host_sd_last7) AS host_sd_last7,\n      SUM(audience_sd_last7) AS audience_sd_last7,\n      SUM(host_hd_last7) AS host_hd_last7,\n      SUM(audience_hd_last7) AS audience_hd_last7,\n      SUM(host_hdp_last7) AS host_hdp_last7,\n      SUM(audience_hdp_last7) AS audience_hdp_last7,\n      SUM(host_audio_last7) AS host_audio_last7,\n      SUM(audience_audio_last7) AS audience_audio_last7,\n      SUM(host_video_last7) AS host_video_last7,\n      SUM(audience_video_last7) AS audience_video_last7,\n      SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n      SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n      SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n      SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n      SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n      SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n      SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n      SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n      SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n      SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n      SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n      SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n      SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n      SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n      SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n      SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n      SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n      SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n      SUM(audience_2k_last7) AS audience_2k_last7,\n      SUM(audience_4k_last7) AS audience_4k_last7,\n      SUM(audience_1080p_last7) AS audience_1080p_last7,\n      SUM(host_1080p_last7) AS host_1080p_last7,\n      SUM(host_2k_last7) AS host_2k_last7,\n      SUM(host_4k_last7) AS host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211128 AND date <= 20211212 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n    GROUP BY date,\n      DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n      2,\n      3,\n      tag,\n      area,\n      dim,\n      8,\n      9,\n      10,\n      level4,\n      product_level1,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en,\n      vid_use_case_en,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name) AS \"自定义 SQL 查询\"\nWHERE \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 3 AND CAST(\"自定义 SQL 查询\".\"level1\" AS VARCHAR) = 'RTSA'\nGROUP BY 1,\n  2"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700079370244)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700079370244)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700079370244)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700079370244)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700079370244)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700079370244)(943764407)(0)\",\n  MIN(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(1482809429)(0)\",\n  MIN(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(3765460736)(0)\",\n  MAX(\"自定义 SQL 查询\".\"stat_date\") AS \"TEMP(attr_stat_date_nk)(2102638629)(0)\",\n  MIN(\"自定义 SQL 查询\".\"stat_date\") AS \"TEMP(attr_stat_date_nk)(2790680713)(0)\",\n  \"自定义 SQL 查询\".\"vid_sector_en\" AS \"vid_sector_en\"\nFROM (SELECT date,\n      start_date AS start_date,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name,\n      SUM(total) AS totalUsage,\n      SUM(audio) AS audio,\n      SUM(video) AS video,\n      SUM(host_sd + audience_sd) AS video_sd,\n      SUM(host_hd + audience_hd) AS video_hd,\n      SUM(host_hdp + audience_hdp) AS video_hdp,\n      SUM(host_audio) AS host_audio,\n      SUM(audience_audio) AS audience_audio,\n      SUM(host_sd) AS host_sd,\n      SUM(host_hd) AS host_hd,\n      SUM(host_hdp) AS host_hdp,\n      SUM(host_1080p) AS host_1080p,\n      SUM(host_2k) AS host_2k,\n      SUM(host_4k) AS host_4k,\n      SUM(audience_sd) AS audience_sd,\n      SUM(audience_hd) AS audience_hd,\n      SUM(audience_hdp) AS audience_hdp,\n      SUM(audience_1080p) AS audience_1080p,\n      SUM(audience_2k) AS audience_2k,\n      SUM(audience_4k) AS audience_4k,\n      SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n      SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n      SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n      SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n      SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n      SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n      SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n      SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n      SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n      SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n      SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n      SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n      SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n      SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n      SUM(total_last1) AS audio_video_last,\n      SUM(audio_last1) AS audio_last,\n      SUM(video_last1) AS video_last,\n      SUM(video_sd_last1) AS video_sd_last,\n      SUM(video_hd_last1) AS video_hd_last,\n      SUM(video_hdp_last1) AS video_hdp_last,\n      SUM(host_sd_last1) AS host_video_sd_last,\n      SUM(audience_sd_last1) AS audience_video_sd_last,\n      SUM(host_hd_last1) AS host_video_hd_last,\n      SUM(audience_hd_last1) AS audience_video_hd_last,\n      SUM(host_hdp_last1) AS host_video_hdp_last,\n      SUM(audience_hdp_last1) AS audience_video_hdp_last,\n      SUM(host_audio_last1) AS host_audio_last,\n      SUM(audience_audio_last1) AS audience_audio_last,\n      SUM(host_video_last1) AS host_video_last,\n      SUM(audience_video_last1) AS audience_video_last,\n      SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n      SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n      SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n      SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n      SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n      SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n      SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n      SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n      SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n      SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n      SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n      SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n      SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n      SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n      SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n      SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n      SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n      SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n      SUM(audience_2k_last1) AS audience_2k_last1,\n      SUM(audience_4k_last1) AS audience_4k_last1,\n      SUM(audience_1080p_last1) AS audience_1080p_last1,\n      SUM(host_1080p_last1) AS host_1080p_last1,\n      SUM(host_2k_last1) AS host_2k_last1,\n      SUM(host_4k_last1) AS host_4k_last1,\n      SUM(total_last7) AS total_last7,\n      SUM(audio_last7) AS audio_last7,\n      SUM(video_last7) AS video_last7,\n      SUM(video_sd_last7) AS video_sd_last7,\n      SUM(video_hd_last7) AS video_hd_last7,\n      SUM(video_hdp_last7) AS video_hdp_last7,\n      SUM(host_sd_last7) AS host_sd_last7,\n      SUM(audience_sd_last7) AS audience_sd_last7,\n      SUM(host_hd_last7) AS host_hd_last7,\n      SUM(audience_hd_last7) AS audience_hd_last7,\n      SUM(host_hdp_last7) AS host_hdp_last7,\n      SUM(audience_hdp_last7) AS audience_hdp_last7,\n      SUM(host_audio_last7) AS host_audio_last7,\n      SUM(audience_audio_last7) AS audience_audio_last7,\n      SUM(host_video_last7) AS host_video_last7,\n      SUM(audience_video_last7) AS audience_video_last7,\n      SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n      SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n      SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n      SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n      SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n      SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n      SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n      SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n      SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n      SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n      SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n      SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n      SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n      SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n      SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n      SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n      SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n      SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n      SUM(audience_2k_last7) AS audience_2k_last7,\n      SUM(audience_4k_last7) AS audience_4k_last7,\n      SUM(audience_1080p_last7) AS audience_1080p_last7,\n      SUM(host_1080p_last7) AS host_1080p_last7,\n      SUM(host_2k_last7) AS host_2k_last7,\n      SUM(host_4k_last7) AS host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211128 AND date <= 20211212 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n    GROUP BY date,\n      DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n      2,\n      3,\n      tag,\n      area,\n      dim,\n      8,\n      9,\n      10,\n      level4,\n      product_level1,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en,\n      vid_use_case_en,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n          start_date AS start_date,\n          end_date AS end_date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          tag,\n          area AS Scope,\n          dim,\n            CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n            CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n            CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          browser,\n          browser_ver,\n          dim_grouping_name,\n          SUM(total) AS totalUsage,\n          SUM(audio) AS audio,\n          SUM(video) AS video,\n          SUM(host_sd + audience_sd) AS video_sd,\n          SUM(host_hd + audience_hd) AS video_hd,\n          SUM(host_hdp + audience_hdp) AS video_hdp,\n          SUM(host_audio) AS host_audio,\n          SUM(audience_audio) AS audience_audio,\n          SUM(host_sd) AS host_sd,\n          SUM(host_hd) AS host_hd,\n          SUM(host_hdp) AS host_hdp,\n          SUM(host_1080p) AS host_1080p,\n          SUM(host_2k) AS host_2k,\n          SUM(host_4k) AS host_4k,\n          SUM(audience_sd) AS audience_sd,\n          SUM(audience_hd) AS audience_hd,\n          SUM(audience_hdp) AS audience_hdp,\n          SUM(audience_1080p) AS audience_1080p,\n          SUM(audience_2k) AS audience_2k,\n          SUM(audience_4k) AS audience_4k,\n          SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n          SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n          SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n          SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n          SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n          SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n          SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n          SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n          SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n          SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n          SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n          SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n          SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n          SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n          SUM(total_last1) AS audio_video_last,\n          SUM(audio_last1) AS audio_last,\n          SUM(video_last1) AS video_last,\n          SUM(video_sd_last1) AS video_sd_last,\n          SUM(video_hd_last1) AS video_hd_last,\n          SUM(video_hdp_last1) AS video_hdp_last,\n          SUM(host_sd_last1) AS host_video_sd_last,\n          SUM(audience_sd_last1) AS audience_video_sd_last,\n          SUM(host_hd_last1) AS host_video_hd_last,\n          SUM(audience_hd_last1) AS audience_video_hd_last,\n          SUM(host_hdp_last1) AS host_video_hdp_last,\n          SUM(audience_hdp_last1) AS audience_video_hdp_last,\n          SUM(host_audio_last1) AS host_audio_last,\n          SUM(audience_audio_last1) AS audience_audio_last,\n          SUM(host_video_last1) AS host_video_last,\n          SUM(audience_video_last1) AS audience_video_last,\n          SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n          SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n          SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n          SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n          SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n          SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n          SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n          SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n          SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n          SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n          SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n          SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n          SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n          SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n          SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n          SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n          SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n          SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n          SUM(audience_2k_last1) AS audience_2k_last1,\n          SUM(audience_4k_last1) AS audience_4k_last1,\n          SUM(audience_1080p_last1) AS audience_1080p_last1,\n          SUM(host_1080p_last1) AS host_1080p_last1,\n          SUM(host_2k_last1) AS host_2k_last1,\n          SUM(host_4k_last1) AS host_4k_last1,\n          SUM(total_last7) AS total_last7,\n          SUM(audio_last7) AS audio_last7,\n          SUM(video_last7) AS video_last7,\n          SUM(video_sd_last7) AS video_sd_last7,\n          SUM(video_hd_last7) AS video_hd_last7,\n          SUM(video_hdp_last7) AS video_hdp_last7,\n          SUM(host_sd_last7) AS host_sd_last7,\n          SUM(audience_sd_last7) AS audience_sd_last7,\n          SUM(host_hd_last7) AS host_hd_last7,\n          SUM(audience_hd_last7) AS audience_hd_last7,\n          SUM(host_hdp_last7) AS host_hdp_last7,\n          SUM(audience_hdp_last7) AS audience_hdp_last7,\n          SUM(host_audio_last7) AS host_audio_last7,\n          SUM(audience_audio_last7) AS audience_audio_last7,\n          SUM(host_video_last7) AS host_video_last7,\n          SUM(audience_video_last7) AS audience_video_last7,\n          SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n          SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n          SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n          SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n          SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n          SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n          SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n          SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n          SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n          SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n          SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n          SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n          SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n          SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n          SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n          SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n          SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n          SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n          SUM(audience_2k_last7) AS audience_2k_last7,\n          SUM(audience_4k_last7) AS audience_4k_last7,\n          SUM(audience_1080p_last7) AS audience_1080p_last7,\n          SUM(host_1080p_last7) AS host_1080p_last7,\n          SUM(host_2k_last7) AS host_2k_last7,\n          SUM(host_4k_last7) AS host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211128 AND date <= 20211212 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n        GROUP BY date,\n          DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n          2,\n          3,\n          tag,\n          area,\n          dim,\n          8,\n          9,\n          10,\n          level4,\n          product_level1,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en,\n          vid_use_case_en,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          browser,\n          browser_ver,\n          dim_grouping_name) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 3 AND CAST(\"自定义 SQL 查询\".\"level1\" AS VARCHAR) = 'RTSA' AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 22"
	},
	{
		"presto_sql" : "SELECT \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  \"自定义 SQL 查询\".\"stat_date\" AS \"stat_date\"\nFROM (SELECT date,\n      start_date AS start_date,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name,\n      SUM(total) AS totalUsage,\n      SUM(audio) AS audio,\n      SUM(video) AS video,\n      SUM(host_sd + audience_sd) AS video_sd,\n      SUM(host_hd + audience_hd) AS video_hd,\n      SUM(host_hdp + audience_hdp) AS video_hdp,\n      SUM(host_audio) AS host_audio,\n      SUM(audience_audio) AS audience_audio,\n      SUM(host_sd) AS host_sd,\n      SUM(host_hd) AS host_hd,\n      SUM(host_hdp) AS host_hdp,\n      SUM(host_1080p) AS host_1080p,\n      SUM(host_2k) AS host_2k,\n      SUM(host_4k) AS host_4k,\n      SUM(audience_sd) AS audience_sd,\n      SUM(audience_hd) AS audience_hd,\n      SUM(audience_hdp) AS audience_hdp,\n      SUM(audience_1080p) AS audience_1080p,\n      SUM(audience_2k) AS audience_2k,\n      SUM(audience_4k) AS audience_4k,\n      SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n      SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n      SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n      SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n      SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n      SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n      SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n      SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n      SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n      SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n      SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n      SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n      SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n      SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n      SUM(total_last1) AS audio_video_last,\n      SUM(audio_last1) AS audio_last,\n      SUM(video_last1) AS video_last,\n      SUM(video_sd_last1) AS video_sd_last,\n      SUM(video_hd_last1) AS video_hd_last,\n      SUM(video_hdp_last1) AS video_hdp_last,\n      SUM(host_sd_last1) AS host_video_sd_last,\n      SUM(audience_sd_last1) AS audience_video_sd_last,\n      SUM(host_hd_last1) AS host_video_hd_last,\n      SUM(audience_hd_last1) AS audience_video_hd_last,\n      SUM(host_hdp_last1) AS host_video_hdp_last,\n      SUM(audience_hdp_last1) AS audience_video_hdp_last,\n      SUM(host_audio_last1) AS host_audio_last,\n      SUM(audience_audio_last1) AS audience_audio_last,\n      SUM(host_video_last1) AS host_video_last,\n      SUM(audience_video_last1) AS audience_video_last,\n      SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n      SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n      SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n      SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n      SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n      SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n      SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n      SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n      SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n      SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n      SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n      SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n      SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n      SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n      SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n      SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n      SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n      SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n      SUM(audience_2k_last1) AS audience_2k_last1,\n      SUM(audience_4k_last1) AS audience_4k_last1,\n      SUM(audience_1080p_last1) AS audience_1080p_last1,\n      SUM(host_1080p_last1) AS host_1080p_last1,\n      SUM(host_2k_last1) AS host_2k_last1,\n      SUM(host_4k_last1) AS host_4k_last1,\n      SUM(total_last7) AS total_last7,\n      SUM(audio_last7) AS audio_last7,\n      SUM(video_last7) AS video_last7,\n      SUM(video_sd_last7) AS video_sd_last7,\n      SUM(video_hd_last7) AS video_hd_last7,\n      SUM(video_hdp_last7) AS video_hdp_last7,\n      SUM(host_sd_last7) AS host_sd_last7,\n      SUM(audience_sd_last7) AS audience_sd_last7,\n      SUM(host_hd_last7) AS host_hd_last7,\n      SUM(audience_hd_last7) AS audience_hd_last7,\n      SUM(host_hdp_last7) AS host_hdp_last7,\n      SUM(audience_hdp_last7) AS audience_hdp_last7,\n      SUM(host_audio_last7) AS host_audio_last7,\n      SUM(audience_audio_last7) AS audience_audio_last7,\n      SUM(host_video_last7) AS host_video_last7,\n      SUM(audience_video_last7) AS audience_video_last7,\n      SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n      SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n      SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n      SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n      SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n      SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n      SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n      SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n      SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n      SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n      SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n      SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n      SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n      SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n      SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n      SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n      SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n      SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n      SUM(audience_2k_last7) AS audience_2k_last7,\n      SUM(audience_4k_last7) AS audience_4k_last7,\n      SUM(audience_1080p_last7) AS audience_1080p_last7,\n      SUM(host_1080p_last7) AS host_1080p_last7,\n      SUM(host_2k_last7) AS host_2k_last7,\n      SUM(host_4k_last7) AS host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211128 AND date <= 20211212 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n    GROUP BY date,\n      DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n      2,\n      3,\n      tag,\n      area,\n      dim,\n      8,\n      9,\n      10,\n      level4,\n      product_level1,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en,\n      vid_use_case_en,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n          start_date AS start_date,\n          end_date AS end_date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          tag,\n          area AS Scope,\n          dim,\n            CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n            CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n            CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          browser,\n          browser_ver,\n          dim_grouping_name,\n          SUM(total) AS totalUsage,\n          SUM(audio) AS audio,\n          SUM(video) AS video,\n          SUM(host_sd + audience_sd) AS video_sd,\n          SUM(host_hd + audience_hd) AS video_hd,\n          SUM(host_hdp + audience_hdp) AS video_hdp,\n          SUM(host_audio) AS host_audio,\n          SUM(audience_audio) AS audience_audio,\n          SUM(host_sd) AS host_sd,\n          SUM(host_hd) AS host_hd,\n          SUM(host_hdp) AS host_hdp,\n          SUM(host_1080p) AS host_1080p,\n          SUM(host_2k) AS host_2k,\n          SUM(host_4k) AS host_4k,\n          SUM(audience_sd) AS audience_sd,\n          SUM(audience_hd) AS audience_hd,\n          SUM(audience_hdp) AS audience_hdp,\n          SUM(audience_1080p) AS audience_1080p,\n          SUM(audience_2k) AS audience_2k,\n          SUM(audience_4k) AS audience_4k,\n          SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n          SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n          SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n          SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n          SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n          SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n          SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n          SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n          SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n          SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n          SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n          SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n          SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n          SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n          SUM(total_last1) AS audio_video_last,\n          SUM(audio_last1) AS audio_last,\n          SUM(video_last1) AS video_last,\n          SUM(video_sd_last1) AS video_sd_last,\n          SUM(video_hd_last1) AS video_hd_last,\n          SUM(video_hdp_last1) AS video_hdp_last,\n          SUM(host_sd_last1) AS host_video_sd_last,\n          SUM(audience_sd_last1) AS audience_video_sd_last,\n          SUM(host_hd_last1) AS host_video_hd_last,\n          SUM(audience_hd_last1) AS audience_video_hd_last,\n          SUM(host_hdp_last1) AS host_video_hdp_last,\n          SUM(audience_hdp_last1) AS audience_video_hdp_last,\n          SUM(host_audio_last1) AS host_audio_last,\n          SUM(audience_audio_last1) AS audience_audio_last,\n          SUM(host_video_last1) AS host_video_last,\n          SUM(audience_video_last1) AS audience_video_last,\n          SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n          SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n          SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n          SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n          SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n          SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n          SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n          SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n          SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n          SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n          SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n          SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n          SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n          SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n          SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n          SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n          SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n          SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n          SUM(audience_2k_last1) AS audience_2k_last1,\n          SUM(audience_4k_last1) AS audience_4k_last1,\n          SUM(audience_1080p_last1) AS audience_1080p_last1,\n          SUM(host_1080p_last1) AS host_1080p_last1,\n          SUM(host_2k_last1) AS host_2k_last1,\n          SUM(host_4k_last1) AS host_4k_last1,\n          SUM(total_last7) AS total_last7,\n          SUM(audio_last7) AS audio_last7,\n          SUM(video_last7) AS video_last7,\n          SUM(video_sd_last7) AS video_sd_last7,\n          SUM(video_hd_last7) AS video_hd_last7,\n          SUM(video_hdp_last7) AS video_hdp_last7,\n          SUM(host_sd_last7) AS host_sd_last7,\n          SUM(audience_sd_last7) AS audience_sd_last7,\n          SUM(host_hd_last7) AS host_hd_last7,\n          SUM(audience_hd_last7) AS audience_hd_last7,\n          SUM(host_hdp_last7) AS host_hdp_last7,\n          SUM(audience_hdp_last7) AS audience_hdp_last7,\n          SUM(host_audio_last7) AS host_audio_last7,\n          SUM(audience_audio_last7) AS audience_audio_last7,\n          SUM(host_video_last7) AS host_video_last7,\n          SUM(audience_video_last7) AS audience_video_last7,\n          SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n          SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n          SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n          SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n          SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n          SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n          SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n          SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n          SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n          SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n          SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n          SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n          SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n          SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n          SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n          SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n          SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n          SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n          SUM(audience_2k_last7) AS audience_2k_last7,\n          SUM(audience_4k_last7) AS audience_4k_last7,\n          SUM(audience_1080p_last7) AS audience_1080p_last7,\n          SUM(host_1080p_last7) AS host_1080p_last7,\n          SUM(host_2k_last7) AS host_2k_last7,\n          SUM(host_4k_last7) AS host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211128 AND date <= 20211212 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n        GROUP BY date,\n          DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n          2,\n          3,\n          tag,\n          area,\n          dim,\n          8,\n          9,\n          10,\n          level4,\n          product_level1,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en,\n          vid_use_case_en,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          browser,\n          browser_ver,\n          dim_grouping_name) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE CAST(\"自定义 SQL 查询\".\"level1\" AS VARCHAR) = 'RTSA' AND \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 3 AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 1,\n  2"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_96897765691088903)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video_sd\") AS \"TEMP(Calculation_96897765691088903)(3165650715)(0)\",\n  MAX(\"自定义 SQL 查询\".\"stat_date\") AS \"TEMP(attr_stat_date_nk)(2102638629)(0)\",\n  MIN(\"自定义 SQL 查询\".\"stat_date\") AS \"TEMP(attr_stat_date_nk)(2790680713)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video_hdp\") AS \"TEMP(sd百分比 (复制) (复制)_96897765691801609)(15603621\",\n  SUM(\"自定义 SQL 查询\".\"video_hd\") AS \"TEMP(sd百分比 (复制)_96897765691785224)(843876055)(0)\",\n  \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"sum_audio_ok\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"sum_totalUsage_ok\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"sum_video_ok\",\n  SUM(\"自定义 SQL 查询\".\"video_hd\") AS \"sum_video_hd_ok\",\n  SUM(\"自定义 SQL 查询\".\"video_hdp\") AS \"sum_video_hdp_ok\",\n  SUM(\"自定义 SQL 查询\".\"video_sd\") AS \"sum_video_sd_ok\",\n  DATE_ADD('SECOND', 0, date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"tdy_date_ok\"\nFROM (SELECT date,\n      start_date AS start_date,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name,\n      SUM(total) AS totalUsage,\n      SUM(audio) AS audio,\n      SUM(video) AS video,\n      SUM(host_sd + audience_sd) AS video_sd,\n      SUM(host_hd + audience_hd) AS video_hd,\n      SUM(host_hdp + audience_hdp) AS video_hdp,\n      SUM(host_audio) AS host_audio,\n      SUM(audience_audio) AS audience_audio,\n      SUM(host_sd) AS host_sd,\n      SUM(host_hd) AS host_hd,\n      SUM(host_hdp) AS host_hdp,\n      SUM(host_1080p) AS host_1080p,\n      SUM(host_2k) AS host_2k,\n      SUM(host_4k) AS host_4k,\n      SUM(audience_sd) AS audience_sd,\n      SUM(audience_hd) AS audience_hd,\n      SUM(audience_hdp) AS audience_hdp,\n      SUM(audience_1080p) AS audience_1080p,\n      SUM(audience_2k) AS audience_2k,\n      SUM(audience_4k) AS audience_4k,\n      SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n      SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n      SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n      SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n      SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n      SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n      SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n      SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n      SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n      SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n      SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n      SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n      SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n      SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n      SUM(total_last1) AS audio_video_last,\n      SUM(audio_last1) AS audio_last,\n      SUM(video_last1) AS video_last,\n      SUM(video_sd_last1) AS video_sd_last,\n      SUM(video_hd_last1) AS video_hd_last,\n      SUM(video_hdp_last1) AS video_hdp_last,\n      SUM(host_sd_last1) AS host_video_sd_last,\n      SUM(audience_sd_last1) AS audience_video_sd_last,\n      SUM(host_hd_last1) AS host_video_hd_last,\n      SUM(audience_hd_last1) AS audience_video_hd_last,\n      SUM(host_hdp_last1) AS host_video_hdp_last,\n      SUM(audience_hdp_last1) AS audience_video_hdp_last,\n      SUM(host_audio_last1) AS host_audio_last,\n      SUM(audience_audio_last1) AS audience_audio_last,\n      SUM(host_video_last1) AS host_video_last,\n      SUM(audience_video_last1) AS audience_video_last,\n      SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n      SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n      SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n      SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n      SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n      SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n      SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n      SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n      SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n      SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n      SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n      SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n      SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n      SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n      SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n      SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n      SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n      SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n      SUM(audience_2k_last1) AS audience_2k_last1,\n      SUM(audience_4k_last1) AS audience_4k_last1,\n      SUM(audience_1080p_last1) AS audience_1080p_last1,\n      SUM(host_1080p_last1) AS host_1080p_last1,\n      SUM(host_2k_last1) AS host_2k_last1,\n      SUM(host_4k_last1) AS host_4k_last1,\n      SUM(total_last7) AS total_last7,\n      SUM(audio_last7) AS audio_last7,\n      SUM(video_last7) AS video_last7,\n      SUM(video_sd_last7) AS video_sd_last7,\n      SUM(video_hd_last7) AS video_hd_last7,\n      SUM(video_hdp_last7) AS video_hdp_last7,\n      SUM(host_sd_last7) AS host_sd_last7,\n      SUM(audience_sd_last7) AS audience_sd_last7,\n      SUM(host_hd_last7) AS host_hd_last7,\n      SUM(audience_hd_last7) AS audience_hd_last7,\n      SUM(host_hdp_last7) AS host_hdp_last7,\n      SUM(audience_hdp_last7) AS audience_hdp_last7,\n      SUM(host_audio_last7) AS host_audio_last7,\n      SUM(audience_audio_last7) AS audience_audio_last7,\n      SUM(host_video_last7) AS host_video_last7,\n      SUM(audience_video_last7) AS audience_video_last7,\n      SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n      SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n      SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n      SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n      SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n      SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n      SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n      SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n      SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n      SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n      SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n      SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n      SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n      SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n      SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n      SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n      SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n      SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n      SUM(audience_2k_last7) AS audience_2k_last7,\n      SUM(audience_4k_last7) AS audience_4k_last7,\n      SUM(audience_1080p_last7) AS audience_1080p_last7,\n      SUM(host_1080p_last7) AS host_1080p_last7,\n      SUM(host_2k_last7) AS host_2k_last7,\n      SUM(host_4k_last7) AS host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211128 AND date <= 20211212 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n    GROUP BY date,\n      DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n      2,\n      3,\n      tag,\n      area,\n      dim,\n      8,\n      9,\n      10,\n      level4,\n      product_level1,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en,\n      vid_use_case_en,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name) AS \"自定义 SQL 查询\"\nWHERE CAST(\"自定义 SQL 查询\".\"level1\" AS VARCHAR) = 'RTSA' AND \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 3\nGROUP BY 7,\n  14"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700079370244)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700079370244)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700079370244)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700079370244)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700079370244)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700079370244)(943764407)(0)\",\n  MIN(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(1482809429)(0)\",\n  MIN(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(3765460736)(0)\",\n  \"自定义 SQL 查询\".\"stat_date\" AS \"TEMP(attr_stat_date_nk)(2102638629)(0)\",\n  \"自定义 SQL 查询\".\"stat_date\" AS \"TEMP(attr_stat_date_nk)(2790680713)(0)\",\n  \"自定义 SQL 查询\".\"product_level2\" AS \"product_level2\",\n  \"自定义 SQL 查询\".\"stat_date\" AS \"stat_date\"\nFROM (SELECT date,\n      start_date AS start_date,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name,\n      SUM(total) AS totalUsage,\n      SUM(audio) AS audio,\n      SUM(video) AS video,\n      SUM(host_sd + audience_sd) AS video_sd,\n      SUM(host_hd + audience_hd) AS video_hd,\n      SUM(host_hdp + audience_hdp) AS video_hdp,\n      SUM(host_audio) AS host_audio,\n      SUM(audience_audio) AS audience_audio,\n      SUM(host_sd) AS host_sd,\n      SUM(host_hd) AS host_hd,\n      SUM(host_hdp) AS host_hdp,\n      SUM(host_1080p) AS host_1080p,\n      SUM(host_2k) AS host_2k,\n      SUM(host_4k) AS host_4k,\n      SUM(audience_sd) AS audience_sd,\n      SUM(audience_hd) AS audience_hd,\n      SUM(audience_hdp) AS audience_hdp,\n      SUM(audience_1080p) AS audience_1080p,\n      SUM(audience_2k) AS audience_2k,\n      SUM(audience_4k) AS audience_4k,\n      SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n      SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n      SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n      SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n      SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n      SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n      SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n      SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n      SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n      SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n      SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n      SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n      SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n      SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n      SUM(total_last1) AS audio_video_last,\n      SUM(audio_last1) AS audio_last,\n      SUM(video_last1) AS video_last,\n      SUM(video_sd_last1) AS video_sd_last,\n      SUM(video_hd_last1) AS video_hd_last,\n      SUM(video_hdp_last1) AS video_hdp_last,\n      SUM(host_sd_last1) AS host_video_sd_last,\n      SUM(audience_sd_last1) AS audience_video_sd_last,\n      SUM(host_hd_last1) AS host_video_hd_last,\n      SUM(audience_hd_last1) AS audience_video_hd_last,\n      SUM(host_hdp_last1) AS host_video_hdp_last,\n      SUM(audience_hdp_last1) AS audience_video_hdp_last,\n      SUM(host_audio_last1) AS host_audio_last,\n      SUM(audience_audio_last1) AS audience_audio_last,\n      SUM(host_video_last1) AS host_video_last,\n      SUM(audience_video_last1) AS audience_video_last,\n      SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n      SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n      SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n      SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n      SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n      SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n      SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n      SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n      SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n      SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n      SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n      SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n      SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n      SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n      SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n      SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n      SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n      SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n      SUM(audience_2k_last1) AS audience_2k_last1,\n      SUM(audience_4k_last1) AS audience_4k_last1,\n      SUM(audience_1080p_last1) AS audience_1080p_last1,\n      SUM(host_1080p_last1) AS host_1080p_last1,\n      SUM(host_2k_last1) AS host_2k_last1,\n      SUM(host_4k_last1) AS host_4k_last1,\n      SUM(total_last7) AS total_last7,\n      SUM(audio_last7) AS audio_last7,\n      SUM(video_last7) AS video_last7,\n      SUM(video_sd_last7) AS video_sd_last7,\n      SUM(video_hd_last7) AS video_hd_last7,\n      SUM(video_hdp_last7) AS video_hdp_last7,\n      SUM(host_sd_last7) AS host_sd_last7,\n      SUM(audience_sd_last7) AS audience_sd_last7,\n      SUM(host_hd_last7) AS host_hd_last7,\n      SUM(audience_hd_last7) AS audience_hd_last7,\n      SUM(host_hdp_last7) AS host_hdp_last7,\n      SUM(audience_hdp_last7) AS audience_hdp_last7,\n      SUM(host_audio_last7) AS host_audio_last7,\n      SUM(audience_audio_last7) AS audience_audio_last7,\n      SUM(host_video_last7) AS host_video_last7,\n      SUM(audience_video_last7) AS audience_video_last7,\n      SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n      SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n      SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n      SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n      SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n      SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n      SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n      SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n      SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n      SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n      SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n      SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n      SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n      SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n      SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n      SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n      SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n      SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n      SUM(audience_2k_last7) AS audience_2k_last7,\n      SUM(audience_4k_last7) AS audience_4k_last7,\n      SUM(audience_1080p_last7) AS audience_1080p_last7,\n      SUM(host_1080p_last7) AS host_1080p_last7,\n      SUM(host_2k_last7) AS host_2k_last7,\n      SUM(host_4k_last7) AS host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211128 AND date <= 20211212 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n    GROUP BY date,\n      DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n      2,\n      3,\n      tag,\n      area,\n      dim,\n      8,\n      9,\n      10,\n      level4,\n      product_level1,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en,\n      vid_use_case_en,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name) AS \"自定义 SQL 查询\"\nWHERE \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 3 AND CAST(\"自定义 SQL 查询\".\"level1\" AS VARCHAR) = 'RTSA'\nGROUP BY 22,\n  20"
	},
	{
		"presto_sql" : "SELECT \"t0\".\"TEMP(Calculation_3519281700079370244)(1075454865)(0)\" AS \"TEMP(Calculation_3519281700079370244)(1075454865)(0)\",\n  \"t0\".\"TEMP(Calculation_3519281700079370244)(1133678835)(0)\" AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  \"t0\".\"TEMP(Calculation_3519281700079370244)(1312501967)(0)\" AS \"TEMP(Calculation_3519281700079370244)(1312501967)(0)\",\n  \"t0\".\"TEMP(Calculation_3519281700079370244)(276907208)(0)\" AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  \"t0\".\"TEMP(Calculation_3519281700079370244)(2929708110)(0)\" AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  \"t0\".\"TEMP(Calculation_3519281700079370244)(2930728935)(0)\" AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  \"t0\".\"TEMP(Calculation_3519281700079370244)(3010533957)(0)\" AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  \"t0\".\"TEMP(Calculation_3519281700079370244)(30306054)(0)\" AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  \"t0\".\"TEMP(Calculation_3519281700079370244)(3087054365)(0)\" AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  \"t0\".\"TEMP(Calculation_3519281700079370244)(3299350010)(0)\" AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  \"t0\".\"TEMP(Calculation_3519281700079370244)(3628946582)(0)\" AS \"TEMP(Calculation_3519281700079370244)(3628946582)(0)\",\n  \"t0\".\"sum_totalUsage_ok\" AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  \"t0\".\"TEMP(Calculation_3519281700079370244)(4109514392)(0)\" AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  \"t0\".\"TEMP(Calculation_3519281700079370244)(586790827)(0)\" AS \"TEMP(Calculation_3519281700079370244)(586790827)(0)\",\n  \"t0\".\"TEMP(Calculation_3519281700079370244)(709512178)(0)\" AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  \"t0\".\"TEMP(Calculation_3519281700079370244)(764410224)(0)\" AS \"TEMP(Calculation_3519281700079370244)(764410224)(0)\",\n  \"t0\".\"TEMP(Calculation_3519281700079370244)(943764407)(0)\" AS \"TEMP(Calculation_3519281700079370244)(943764407)(0)\",\n  \"t0\".\"level1\" AS \"level1\",\n  \"t3\".\"__measure__0\" AS \"sum_Calculation_4164281609521332225_ok\",\n  \"t0\".\"sum_totalUsage_ok\" AS \"sum_totalUsage_ok\"\nFROM (SELECT \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n      SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700079370244)(1075454865)(0)\",\n      SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n      SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700079370244)(1312501967)(0)\",\n      SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n      SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n      SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n      SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n      SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n      SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n      SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n      SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700079370244)(3628946582)(0)\",\n      SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n      SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700079370244)(586790827)(0)\",\n      SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n      SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700079370244)(764410224)(0)\",\n      SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700079370244)(943764407)(0)\",\n      SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"sum_totalUsage_ok\"\n    FROM (SELECT date,\n          start_date AS start_date,\n          end_date AS end_date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          tag,\n          area AS Scope,\n          dim,\n            CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n            CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n            CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          browser,\n          browser_ver,\n          dim_grouping_name,\n          SUM(total) AS totalUsage,\n          SUM(audio) AS audio,\n          SUM(video) AS video,\n          SUM(host_sd + audience_sd) AS video_sd,\n          SUM(host_hd + audience_hd) AS video_hd,\n          SUM(host_hdp + audience_hdp) AS video_hdp,\n          SUM(host_audio) AS host_audio,\n          SUM(audience_audio) AS audience_audio,\n          SUM(host_sd) AS host_sd,\n          SUM(host_hd) AS host_hd,\n          SUM(host_hdp) AS host_hdp,\n          SUM(host_1080p) AS host_1080p,\n          SUM(host_2k) AS host_2k,\n          SUM(host_4k) AS host_4k,\n          SUM(audience_sd) AS audience_sd,\n          SUM(audience_hd) AS audience_hd,\n          SUM(audience_hdp) AS audience_hdp,\n          SUM(audience_1080p) AS audience_1080p,\n          SUM(audience_2k) AS audience_2k,\n          SUM(audience_4k) AS audience_4k,\n          SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n          SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n          SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n          SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n          SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n          SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n          SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n          SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n          SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n          SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n          SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n          SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n          SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n          SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n          SUM(total_last1) AS audio_video_last,\n          SUM(audio_last1) AS audio_last,\n          SUM(video_last1) AS video_last,\n          SUM(video_sd_last1) AS video_sd_last,\n          SUM(video_hd_last1) AS video_hd_last,\n          SUM(video_hdp_last1) AS video_hdp_last,\n          SUM(host_sd_last1) AS host_video_sd_last,\n          SUM(audience_sd_last1) AS audience_video_sd_last,\n          SUM(host_hd_last1) AS host_video_hd_last,\n          SUM(audience_hd_last1) AS audience_video_hd_last,\n          SUM(host_hdp_last1) AS host_video_hdp_last,\n          SUM(audience_hdp_last1) AS audience_video_hdp_last,\n          SUM(host_audio_last1) AS host_audio_last,\n          SUM(audience_audio_last1) AS audience_audio_last,\n          SUM(host_video_last1) AS host_video_last,\n          SUM(audience_video_last1) AS audience_video_last,\n          SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n          SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n          SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n          SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n          SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n          SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n          SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n          SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n          SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n          SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n          SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n          SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n          SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n          SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n          SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n          SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n          SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n          SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n          SUM(audience_2k_last1) AS audience_2k_last1,\n          SUM(audience_4k_last1) AS audience_4k_last1,\n          SUM(audience_1080p_last1) AS audience_1080p_last1,\n          SUM(host_1080p_last1) AS host_1080p_last1,\n          SUM(host_2k_last1) AS host_2k_last1,\n          SUM(host_4k_last1) AS host_4k_last1,\n          SUM(total_last7) AS total_last7,\n          SUM(audio_last7) AS audio_last7,\n          SUM(video_last7) AS video_last7,\n          SUM(video_sd_last7) AS video_sd_last7,\n          SUM(video_hd_last7) AS video_hd_last7,\n          SUM(video_hdp_last7) AS video_hdp_last7,\n          SUM(host_sd_last7) AS host_sd_last7,\n          SUM(audience_sd_last7) AS audience_sd_last7,\n          SUM(host_hd_last7) AS host_hd_last7,\n          SUM(audience_hd_last7) AS audience_hd_last7,\n          SUM(host_hdp_last7) AS host_hdp_last7,\n          SUM(audience_hdp_last7) AS audience_hdp_last7,\n          SUM(host_audio_last7) AS host_audio_last7,\n          SUM(audience_audio_last7) AS audience_audio_last7,\n          SUM(host_video_last7) AS host_video_last7,\n          SUM(audience_video_last7) AS audience_video_last7,\n          SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n          SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n          SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n          SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n          SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n          SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n          SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n          SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n          SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n          SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n          SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n          SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n          SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n          SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n          SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n          SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n          SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n          SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n          SUM(audience_2k_last7) AS audience_2k_last7,\n          SUM(audience_4k_last7) AS audience_4k_last7,\n          SUM(audience_1080p_last7) AS audience_1080p_last7,\n          SUM(host_1080p_last7) AS host_1080p_last7,\n          SUM(host_2k_last7) AS host_2k_last7,\n          SUM(host_4k_last7) AS host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211128 AND date <= 20211212 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n        GROUP BY date,\n          DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n          2,\n          3,\n          tag,\n          area,\n          dim,\n          8,\n          9,\n          10,\n          level4,\n          product_level1,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en,\n          vid_use_case_en,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          browser,\n          browser_ver,\n          dim_grouping_name) AS \"自定义 SQL 查询\"\n    WHERE CAST(\"自定义 SQL 查询\".\"level1\" AS VARCHAR) = 'RTSA' AND \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 3\n    GROUP BY 1) AS \"t0\"\n  INNER JOIN (SELECT MIN(\"t1\".\"level1\") AS \"level1\",\n      SUM(\"t2\".\"__measure__1\") AS \"__measure__0\"\n    FROM (SELECT \"自定义 SQL 查询\".\"date\" AS \"date\",\n          \"自定义 SQL 查询\".\"level1\" AS \"level1\"\n        FROM (SELECT date,\n              start_date AS start_date,\n              end_date AS end_date,\n                CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n              tag,\n              area AS Scope,\n              dim,\n                CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n                CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n                CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n              level4,\n              product_level1 AS product_line,\n              product_level2,\n              product_level3,\n              product_level4,\n              vid_internal_industry_en AS cid_industry,\n              vid_use_case_en AS vid_use_case_cn,\n              vid_sector_en,\n              ver_type,\n              ver,\n              os,\n              domain,\n              country,\n              region,\n              browser,\n              browser_ver,\n              dim_grouping_name,\n              SUM(total) AS totalUsage,\n              SUM(audio) AS audio,\n              SUM(video) AS video,\n              SUM(host_sd + audience_sd) AS video_sd,\n              SUM(host_hd + audience_hd) AS video_hd,\n              SUM(host_hdp + audience_hdp) AS video_hdp,\n              SUM(host_audio) AS host_audio,\n              SUM(audience_audio) AS audience_audio,\n              SUM(host_sd) AS host_sd,\n              SUM(host_hd) AS host_hd,\n              SUM(host_hdp) AS host_hdp,\n              SUM(host_1080p) AS host_1080p,\n              SUM(host_2k) AS host_2k,\n              SUM(host_4k) AS host_4k,\n              SUM(audience_sd) AS audience_sd,\n              SUM(audience_hd) AS audience_hd,\n              SUM(audience_hdp) AS audience_hdp,\n              SUM(audience_1080p) AS audience_1080p,\n              SUM(audience_2k) AS audience_2k,\n              SUM(audience_4k) AS audience_4k,\n              SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n              SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n              SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n              SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n              SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n              SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n              SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n              SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n              SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n              SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n              SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n              SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n              SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n              SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n              SUM(total_last1) AS audio_video_last,\n              SUM(audio_last1) AS audio_last,\n              SUM(video_last1) AS video_last,\n              SUM(video_sd_last1) AS video_sd_last,\n              SUM(video_hd_last1) AS video_hd_last,\n              SUM(video_hdp_last1) AS video_hdp_last,\n              SUM(host_sd_last1) AS host_video_sd_last,\n              SUM(audience_sd_last1) AS audience_video_sd_last,\n              SUM(host_hd_last1) AS host_video_hd_last,\n              SUM(audience_hd_last1) AS audience_video_hd_last,\n              SUM(host_hdp_last1) AS host_video_hdp_last,\n              SUM(audience_hdp_last1) AS audience_video_hdp_last,\n              SUM(host_audio_last1) AS host_audio_last,\n              SUM(audience_audio_last1) AS audience_audio_last,\n              SUM(host_video_last1) AS host_video_last,\n              SUM(audience_video_last1) AS audience_video_last,\n              SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n              SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n              SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n              SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n              SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n              SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n              SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n              SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n              SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n              SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n              SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n              SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n              SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n              SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n              SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n              SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n              SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n              SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n              SUM(audience_2k_last1) AS audience_2k_last1,\n              SUM(audience_4k_last1) AS audience_4k_last1,\n              SUM(audience_1080p_last1) AS audience_1080p_last1,\n              SUM(host_1080p_last1) AS host_1080p_last1,\n              SUM(host_2k_last1) AS host_2k_last1,\n              SUM(host_4k_last1) AS host_4k_last1,\n              SUM(total_last7) AS total_last7,\n              SUM(audio_last7) AS audio_last7,\n              SUM(video_last7) AS video_last7,\n              SUM(video_sd_last7) AS video_sd_last7,\n              SUM(video_hd_last7) AS video_hd_last7,\n              SUM(video_hdp_last7) AS video_hdp_last7,\n              SUM(host_sd_last7) AS host_sd_last7,\n              SUM(audience_sd_last7) AS audience_sd_last7,\n              SUM(host_hd_last7) AS host_hd_last7,\n              SUM(audience_hd_last7) AS audience_hd_last7,\n              SUM(host_hdp_last7) AS host_hdp_last7,\n              SUM(audience_hdp_last7) AS audience_hdp_last7,\n              SUM(host_audio_last7) AS host_audio_last7,\n              SUM(audience_audio_last7) AS audience_audio_last7,\n              SUM(host_video_last7) AS host_video_last7,\n              SUM(audience_video_last7) AS audience_video_last7,\n              SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n              SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n              SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n              SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n              SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n              SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n              SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n              SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n              SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n              SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n              SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n              SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n              SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n              SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n              SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n              SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n              SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n              SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n              SUM(audience_2k_last7) AS audience_2k_last7,\n              SUM(audience_4k_last7) AS audience_4k_last7,\n              SUM(audience_1080p_last7) AS audience_1080p_last7,\n              SUM(host_1080p_last7) AS host_1080p_last7,\n              SUM(host_2k_last7) AS host_2k_last7,\n              SUM(host_4k_last7) AS host_4k_last7\n            FROM levels_usage_dod_di_1\n            WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211128 AND date <= 20211212 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n            GROUP BY date,\n              DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n                CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n              2,\n              3,\n              tag,\n              area,\n              dim,\n              8,\n              9,\n              10,\n              level4,\n              product_level1,\n              product_level2,\n              product_level3,\n              product_level4,\n              vid_internal_industry_en,\n              vid_use_case_en,\n              vid_sector_en,\n              ver_type,\n              ver,\n              os,\n              domain,\n              country,\n              region,\n              browser,\n              browser_ver,\n              dim_grouping_name) AS \"自定义 SQL 查询\"\n        WHERE CAST(\"自定义 SQL 查询\".\"level1\" AS VARCHAR) = 'RTSA' AND \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 3\n        GROUP BY 1,\n          2) AS \"t1\"\n      INNER JOIN (SELECT \"自定义 SQL 查询\".\"date\" AS \"date\",\n          SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"__measure__1\"\n        FROM (SELECT date,\n              start_date AS start_date,\n              end_date AS end_date,\n                CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n              tag,\n              area AS Scope,\n              dim,\n                CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n                CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n                CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n              level4,\n              product_level1 AS product_line,\n              product_level2,\n              product_level3,\n              product_level4,\n              vid_internal_industry_en AS cid_industry,\n              vid_use_case_en AS vid_use_case_cn,\n              vid_sector_en,\n              ver_type,\n              ver,\n              os,\n              domain,\n              country,\n              region,\n              browser,\n              browser_ver,\n              dim_grouping_name,\n              SUM(total) AS totalUsage,\n              SUM(audio) AS audio,\n              SUM(video) AS video,\n              SUM(host_sd + audience_sd) AS video_sd,\n              SUM(host_hd + audience_hd) AS video_hd,\n              SUM(host_hdp + audience_hdp) AS video_hdp,\n              SUM(host_audio) AS host_audio,\n              SUM(audience_audio) AS audience_audio,\n              SUM(host_sd) AS host_sd,\n              SUM(host_hd) AS host_hd,\n              SUM(host_hdp) AS host_hdp,\n              SUM(host_1080p) AS host_1080p,\n              SUM(host_2k) AS host_2k,\n              SUM(host_4k) AS host_4k,\n              SUM(audience_sd) AS audience_sd,\n              SUM(audience_hd) AS audience_hd,\n              SUM(audience_hdp) AS audience_hdp,\n              SUM(audience_1080p) AS audience_1080p,\n              SUM(audience_2k) AS audience_2k,\n              SUM(audience_4k) AS audience_4k,\n              SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n              SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n              SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n              SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n              SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n              SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n              SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n              SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n              SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n              SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n              SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n              SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n              SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n              SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n              SUM(total_last1) AS audio_video_last,\n              SUM(audio_last1) AS audio_last,\n              SUM(video_last1) AS video_last,\n              SUM(video_sd_last1) AS video_sd_last,\n              SUM(video_hd_last1) AS video_hd_last,\n              SUM(video_hdp_last1) AS video_hdp_last,\n              SUM(host_sd_last1) AS host_video_sd_last,\n              SUM(audience_sd_last1) AS audience_video_sd_last,\n              SUM(host_hd_last1) AS host_video_hd_last,\n              SUM(audience_hd_last1) AS audience_video_hd_last,\n              SUM(host_hdp_last1) AS host_video_hdp_last,\n              SUM(audience_hdp_last1) AS audience_video_hdp_last,\n              SUM(host_audio_last1) AS host_audio_last,\n              SUM(audience_audio_last1) AS audience_audio_last,\n              SUM(host_video_last1) AS host_video_last,\n              SUM(audience_video_last1) AS audience_video_last,\n              SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n              SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n              SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n              SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n              SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n              SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n              SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n              SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n              SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n              SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n              SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n              SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n              SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n              SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n              SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n              SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n              SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n              SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n              SUM(audience_2k_last1) AS audience_2k_last1,\n              SUM(audience_4k_last1) AS audience_4k_last1,\n              SUM(audience_1080p_last1) AS audience_1080p_last1,\n              SUM(host_1080p_last1) AS host_1080p_last1,\n              SUM(host_2k_last1) AS host_2k_last1,\n              SUM(host_4k_last1) AS host_4k_last1,\n              SUM(total_last7) AS total_last7,\n              SUM(audio_last7) AS audio_last7,\n              SUM(video_last7) AS video_last7,\n              SUM(video_sd_last7) AS video_sd_last7,\n              SUM(video_hd_last7) AS video_hd_last7,\n              SUM(video_hdp_last7) AS video_hdp_last7,\n              SUM(host_sd_last7) AS host_sd_last7,\n              SUM(audience_sd_last7) AS audience_sd_last7,\n              SUM(host_hd_last7) AS host_hd_last7,\n              SUM(audience_hd_last7) AS audience_hd_last7,\n              SUM(host_hdp_last7) AS host_hdp_last7,\n              SUM(audience_hdp_last7) AS audience_hdp_last7,\n              SUM(host_audio_last7) AS host_audio_last7,\n              SUM(audience_audio_last7) AS audience_audio_last7,\n              SUM(host_video_last7) AS host_video_last7,\n              SUM(audience_video_last7) AS audience_video_last7,\n              SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n              SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n              SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n              SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n              SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n              SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n              SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n              SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n              SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n              SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n              SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n              SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n              SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n              SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n              SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n              SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n              SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n              SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n              SUM(audience_2k_last7) AS audience_2k_last7,\n              SUM(audience_4k_last7) AS audience_4k_last7,\n              SUM(audience_1080p_last7) AS audience_1080p_last7,\n              SUM(host_1080p_last7) AS host_1080p_last7,\n              SUM(host_2k_last7) AS host_2k_last7,\n              SUM(host_4k_last7) AS host_4k_last7\n            FROM levels_usage_dod_di_1\n            WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211128 AND date <= 20211212 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n            GROUP BY date,\n              DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n                CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n              2,\n              3,\n              tag,\n              area,\n              dim,\n              8,\n              9,\n              10,\n              level4,\n              product_level1,\n              product_level2,\n              product_level3,\n              product_level4,\n              vid_internal_industry_en,\n              vid_use_case_en,\n              vid_sector_en,\n              ver_type,\n              ver,\n              os,\n              domain,\n              country,\n              region,\n              browser,\n              browser_ver,\n              dim_grouping_name) AS \"自定义 SQL 查询\"\n        GROUP BY 1) AS \"t2\" ON ((\"t1\".\"date\"  is null and  \"t2\".\"date\"  is null )  or  (\"t1\".\"date\" = \"t2\".\"date\"))\n    HAVING COUNT(1) > 0) AS \"t3\" ON \"t0\".\"level1\" = \"t3\".\"level1\""
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700079370244)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700079370244)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700079370244)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700079370244)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700079370244)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700079370244)(943764407)(0)\",\n  MIN(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(1482809429)(0)\",\n  MIN(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(3765460736)(0)\",\n  \"自定义 SQL 查询\".\"stat_date\" AS \"TEMP(attr_stat_date_nk)(2102638629)(0)\",\n  \"自定义 SQL 查询\".\"stat_date\" AS \"TEMP(attr_stat_date_nk)(2790680713)(0)\",\n  \"自定义 SQL 查询\".\"stat_date\" AS \"stat_date\",\n  \"自定义 SQL 查询\".\"vid_sector_en\" AS \"vid_sector_en\"\nFROM (SELECT date,\n      start_date AS start_date,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name,\n      SUM(total) AS totalUsage,\n      SUM(audio) AS audio,\n      SUM(video) AS video,\n      SUM(host_sd + audience_sd) AS video_sd,\n      SUM(host_hd + audience_hd) AS video_hd,\n      SUM(host_hdp + audience_hdp) AS video_hdp,\n      SUM(host_audio) AS host_audio,\n      SUM(audience_audio) AS audience_audio,\n      SUM(host_sd) AS host_sd,\n      SUM(host_hd) AS host_hd,\n      SUM(host_hdp) AS host_hdp,\n      SUM(host_1080p) AS host_1080p,\n      SUM(host_2k) AS host_2k,\n      SUM(host_4k) AS host_4k,\n      SUM(audience_sd) AS audience_sd,\n      SUM(audience_hd) AS audience_hd,\n      SUM(audience_hdp) AS audience_hdp,\n      SUM(audience_1080p) AS audience_1080p,\n      SUM(audience_2k) AS audience_2k,\n      SUM(audience_4k) AS audience_4k,\n      SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n      SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n      SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n      SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n      SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n      SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n      SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n      SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n      SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n      SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n      SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n      SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n      SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n      SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n      SUM(total_last1) AS audio_video_last,\n      SUM(audio_last1) AS audio_last,\n      SUM(video_last1) AS video_last,\n      SUM(video_sd_last1) AS video_sd_last,\n      SUM(video_hd_last1) AS video_hd_last,\n      SUM(video_hdp_last1) AS video_hdp_last,\n      SUM(host_sd_last1) AS host_video_sd_last,\n      SUM(audience_sd_last1) AS audience_video_sd_last,\n      SUM(host_hd_last1) AS host_video_hd_last,\n      SUM(audience_hd_last1) AS audience_video_hd_last,\n      SUM(host_hdp_last1) AS host_video_hdp_last,\n      SUM(audience_hdp_last1) AS audience_video_hdp_last,\n      SUM(host_audio_last1) AS host_audio_last,\n      SUM(audience_audio_last1) AS audience_audio_last,\n      SUM(host_video_last1) AS host_video_last,\n      SUM(audience_video_last1) AS audience_video_last,\n      SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n      SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n      SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n      SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n      SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n      SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n      SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n      SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n      SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n      SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n      SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n      SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n      SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n      SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n      SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n      SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n      SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n      SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n      SUM(audience_2k_last1) AS audience_2k_last1,\n      SUM(audience_4k_last1) AS audience_4k_last1,\n      SUM(audience_1080p_last1) AS audience_1080p_last1,\n      SUM(host_1080p_last1) AS host_1080p_last1,\n      SUM(host_2k_last1) AS host_2k_last1,\n      SUM(host_4k_last1) AS host_4k_last1,\n      SUM(total_last7) AS total_last7,\n      SUM(audio_last7) AS audio_last7,\n      SUM(video_last7) AS video_last7,\n      SUM(video_sd_last7) AS video_sd_last7,\n      SUM(video_hd_last7) AS video_hd_last7,\n      SUM(video_hdp_last7) AS video_hdp_last7,\n      SUM(host_sd_last7) AS host_sd_last7,\n      SUM(audience_sd_last7) AS audience_sd_last7,\n      SUM(host_hd_last7) AS host_hd_last7,\n      SUM(audience_hd_last7) AS audience_hd_last7,\n      SUM(host_hdp_last7) AS host_hdp_last7,\n      SUM(audience_hdp_last7) AS audience_hdp_last7,\n      SUM(host_audio_last7) AS host_audio_last7,\n      SUM(audience_audio_last7) AS audience_audio_last7,\n      SUM(host_video_last7) AS host_video_last7,\n      SUM(audience_video_last7) AS audience_video_last7,\n      SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n      SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n      SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n      SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n      SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n      SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n      SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n      SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n      SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n      SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n      SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n      SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n      SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n      SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n      SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n      SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n      SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n      SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n      SUM(audience_2k_last7) AS audience_2k_last7,\n      SUM(audience_4k_last7) AS audience_4k_last7,\n      SUM(audience_1080p_last7) AS audience_1080p_last7,\n      SUM(host_1080p_last7) AS host_1080p_last7,\n      SUM(host_2k_last7) AS host_2k_last7,\n      SUM(host_4k_last7) AS host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211128 AND date <= 20211212 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n    GROUP BY date,\n      DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n      2,\n      3,\n      tag,\n      area,\n      dim,\n      8,\n      9,\n      10,\n      level4,\n      product_level1,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en,\n      vid_use_case_en,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name) AS \"自定义 SQL 查询\"\nWHERE \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 3 AND CAST(\"自定义 SQL 查询\".\"level1\" AS VARCHAR) = 'RTSA'\nGROUP BY 20,\n  23"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700079370244)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700079370244)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700079370244)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700079370244)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700079370244)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700079370244)(943764407)(0)\",\n  MIN(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(1482809429)(0)\",\n  MIN(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(3765460736)(0)\",\n  \"自定义 SQL 查询\".\"stat_date\" AS \"TEMP(attr_stat_date_nk)(2102638629)(0)\",\n  \"自定义 SQL 查询\".\"stat_date\" AS \"TEMP(attr_stat_date_nk)(2790680713)(0)\",\n  \"自定义 SQL 查询\".\"product_level3\" AS \"product_level3\",\n  \"自定义 SQL 查询\".\"stat_date\" AS \"stat_date\"\nFROM (SELECT date,\n      start_date AS start_date,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name,\n      SUM(total) AS totalUsage,\n      SUM(audio) AS audio,\n      SUM(video) AS video,\n      SUM(host_sd + audience_sd) AS video_sd,\n      SUM(host_hd + audience_hd) AS video_hd,\n      SUM(host_hdp + audience_hdp) AS video_hdp,\n      SUM(host_audio) AS host_audio,\n      SUM(audience_audio) AS audience_audio,\n      SUM(host_sd) AS host_sd,\n      SUM(host_hd) AS host_hd,\n      SUM(host_hdp) AS host_hdp,\n      SUM(host_1080p) AS host_1080p,\n      SUM(host_2k) AS host_2k,\n      SUM(host_4k) AS host_4k,\n      SUM(audience_sd) AS audience_sd,\n      SUM(audience_hd) AS audience_hd,\n      SUM(audience_hdp) AS audience_hdp,\n      SUM(audience_1080p) AS audience_1080p,\n      SUM(audience_2k) AS audience_2k,\n      SUM(audience_4k) AS audience_4k,\n      SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n      SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n      SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n      SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n      SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n      SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n      SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n      SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n      SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n      SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n      SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n      SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n      SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n      SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n      SUM(total_last1) AS audio_video_last,\n      SUM(audio_last1) AS audio_last,\n      SUM(video_last1) AS video_last,\n      SUM(video_sd_last1) AS video_sd_last,\n      SUM(video_hd_last1) AS video_hd_last,\n      SUM(video_hdp_last1) AS video_hdp_last,\n      SUM(host_sd_last1) AS host_video_sd_last,\n      SUM(audience_sd_last1) AS audience_video_sd_last,\n      SUM(host_hd_last1) AS host_video_hd_last,\n      SUM(audience_hd_last1) AS audience_video_hd_last,\n      SUM(host_hdp_last1) AS host_video_hdp_last,\n      SUM(audience_hdp_last1) AS audience_video_hdp_last,\n      SUM(host_audio_last1) AS host_audio_last,\n      SUM(audience_audio_last1) AS audience_audio_last,\n      SUM(host_video_last1) AS host_video_last,\n      SUM(audience_video_last1) AS audience_video_last,\n      SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n      SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n      SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n      SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n      SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n      SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n      SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n      SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n      SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n      SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n      SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n      SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n      SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n      SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n      SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n      SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n      SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n      SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n      SUM(audience_2k_last1) AS audience_2k_last1,\n      SUM(audience_4k_last1) AS audience_4k_last1,\n      SUM(audience_1080p_last1) AS audience_1080p_last1,\n      SUM(host_1080p_last1) AS host_1080p_last1,\n      SUM(host_2k_last1) AS host_2k_last1,\n      SUM(host_4k_last1) AS host_4k_last1,\n      SUM(total_last7) AS total_last7,\n      SUM(audio_last7) AS audio_last7,\n      SUM(video_last7) AS video_last7,\n      SUM(video_sd_last7) AS video_sd_last7,\n      SUM(video_hd_last7) AS video_hd_last7,\n      SUM(video_hdp_last7) AS video_hdp_last7,\n      SUM(host_sd_last7) AS host_sd_last7,\n      SUM(audience_sd_last7) AS audience_sd_last7,\n      SUM(host_hd_last7) AS host_hd_last7,\n      SUM(audience_hd_last7) AS audience_hd_last7,\n      SUM(host_hdp_last7) AS host_hdp_last7,\n      SUM(audience_hdp_last7) AS audience_hdp_last7,\n      SUM(host_audio_last7) AS host_audio_last7,\n      SUM(audience_audio_last7) AS audience_audio_last7,\n      SUM(host_video_last7) AS host_video_last7,\n      SUM(audience_video_last7) AS audience_video_last7,\n      SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n      SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n      SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n      SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n      SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n      SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n      SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n      SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n      SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n      SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n      SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n      SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n      SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n      SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n      SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n      SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n      SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n      SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n      SUM(audience_2k_last7) AS audience_2k_last7,\n      SUM(audience_4k_last7) AS audience_4k_last7,\n      SUM(audience_1080p_last7) AS audience_1080p_last7,\n      SUM(host_1080p_last7) AS host_1080p_last7,\n      SUM(host_2k_last7) AS host_2k_last7,\n      SUM(host_4k_last7) AS host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211128 AND date <= 20211212 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n    GROUP BY date,\n      DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n      2,\n      3,\n      tag,\n      area,\n      dim,\n      8,\n      9,\n      10,\n      level4,\n      product_level1,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en,\n      vid_use_case_en,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name) AS \"自定义 SQL 查询\"\nWHERE \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 3 AND CAST(\"自定义 SQL 查询\".\"level1\" AS VARCHAR) = 'RTSA'\nGROUP BY 22,\n  20"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700079370244)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700079370244)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700079370244)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700079370244)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700079370244)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700079370244)(943764407)(0)\",\n  MIN(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(1482809429)(0)\",\n  MIN(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(3765460736)(0)\",\n  \"自定义 SQL 查询\".\"stat_date\" AS \"TEMP(attr_stat_date_nk)(2102638629)(0)\",\n  \"自定义 SQL 查询\".\"stat_date\" AS \"TEMP(attr_stat_date_nk)(2790680713)(0)\",\n  \"自定义 SQL 查询\".\"stat_date\" AS \"stat_date\",\n  \"自定义 SQL 查询\".\"vid_use_case_cn\" AS \"vid_use_case_cn\"\nFROM (SELECT date,\n      start_date AS start_date,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name,\n      SUM(total) AS totalUsage,\n      SUM(audio) AS audio,\n      SUM(video) AS video,\n      SUM(host_sd + audience_sd) AS video_sd,\n      SUM(host_hd + audience_hd) AS video_hd,\n      SUM(host_hdp + audience_hdp) AS video_hdp,\n      SUM(host_audio) AS host_audio,\n      SUM(audience_audio) AS audience_audio,\n      SUM(host_sd) AS host_sd,\n      SUM(host_hd) AS host_hd,\n      SUM(host_hdp) AS host_hdp,\n      SUM(host_1080p) AS host_1080p,\n      SUM(host_2k) AS host_2k,\n      SUM(host_4k) AS host_4k,\n      SUM(audience_sd) AS audience_sd,\n      SUM(audience_hd) AS audience_hd,\n      SUM(audience_hdp) AS audience_hdp,\n      SUM(audience_1080p) AS audience_1080p,\n      SUM(audience_2k) AS audience_2k,\n      SUM(audience_4k) AS audience_4k,\n      SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n      SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n      SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n      SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n      SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n      SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n      SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n      SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n      SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n      SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n      SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n      SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n      SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n      SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n      SUM(total_last1) AS audio_video_last,\n      SUM(audio_last1) AS audio_last,\n      SUM(video_last1) AS video_last,\n      SUM(video_sd_last1) AS video_sd_last,\n      SUM(video_hd_last1) AS video_hd_last,\n      SUM(video_hdp_last1) AS video_hdp_last,\n      SUM(host_sd_last1) AS host_video_sd_last,\n      SUM(audience_sd_last1) AS audience_video_sd_last,\n      SUM(host_hd_last1) AS host_video_hd_last,\n      SUM(audience_hd_last1) AS audience_video_hd_last,\n      SUM(host_hdp_last1) AS host_video_hdp_last,\n      SUM(audience_hdp_last1) AS audience_video_hdp_last,\n      SUM(host_audio_last1) AS host_audio_last,\n      SUM(audience_audio_last1) AS audience_audio_last,\n      SUM(host_video_last1) AS host_video_last,\n      SUM(audience_video_last1) AS audience_video_last,\n      SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n      SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n      SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n      SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n      SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n      SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n      SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n      SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n      SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n      SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n      SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n      SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n      SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n      SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n      SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n      SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n      SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n      SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n      SUM(audience_2k_last1) AS audience_2k_last1,\n      SUM(audience_4k_last1) AS audience_4k_last1,\n      SUM(audience_1080p_last1) AS audience_1080p_last1,\n      SUM(host_1080p_last1) AS host_1080p_last1,\n      SUM(host_2k_last1) AS host_2k_last1,\n      SUM(host_4k_last1) AS host_4k_last1,\n      SUM(total_last7) AS total_last7,\n      SUM(audio_last7) AS audio_last7,\n      SUM(video_last7) AS video_last7,\n      SUM(video_sd_last7) AS video_sd_last7,\n      SUM(video_hd_last7) AS video_hd_last7,\n      SUM(video_hdp_last7) AS video_hdp_last7,\n      SUM(host_sd_last7) AS host_sd_last7,\n      SUM(audience_sd_last7) AS audience_sd_last7,\n      SUM(host_hd_last7) AS host_hd_last7,\n      SUM(audience_hd_last7) AS audience_hd_last7,\n      SUM(host_hdp_last7) AS host_hdp_last7,\n      SUM(audience_hdp_last7) AS audience_hdp_last7,\n      SUM(host_audio_last7) AS host_audio_last7,\n      SUM(audience_audio_last7) AS audience_audio_last7,\n      SUM(host_video_last7) AS host_video_last7,\n      SUM(audience_video_last7) AS audience_video_last7,\n      SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n      SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n      SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n      SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n      SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n      SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n      SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n      SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n      SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n      SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n      SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n      SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n      SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n      SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n      SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n      SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n      SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n      SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n      SUM(audience_2k_last7) AS audience_2k_last7,\n      SUM(audience_4k_last7) AS audience_4k_last7,\n      SUM(audience_1080p_last7) AS audience_1080p_last7,\n      SUM(host_1080p_last7) AS host_1080p_last7,\n      SUM(host_2k_last7) AS host_2k_last7,\n      SUM(host_4k_last7) AS host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211128 AND date <= 20211212 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n    GROUP BY date,\n      DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n      2,\n      3,\n      tag,\n      area,\n      dim,\n      8,\n      9,\n      10,\n      level4,\n      product_level1,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en,\n      vid_use_case_en,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name) AS \"自定义 SQL 查询\"\nWHERE \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 3 AND CAST(\"自定义 SQL 查询\".\"level1\" AS VARCHAR) = 'RTSA'\nGROUP BY 20,\n  23"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"audio_last7\") AS \"TEMP(Calculation_96897765680816128)(2589233512)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_96897765680816128)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(audio同比 (复制)_96897765681725441)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video_last7\") AS \"TEMP(audio同比 (复制)_96897765681725441)(4107040267)(0)\",\n  SUM(\"自定义 SQL 查询\".\"total_last7\") AS \"TEMP(video同比 (复制)_96897765683347458)(346677966)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(video同比 (复制)_96897765683347458)(3847882359)(0)\",\n  \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"audio_video_last\") AS \"sum_audio_video_last_ok\"\nFROM (SELECT date,\n      start_date AS start_date,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name,\n      SUM(total) AS totalUsage,\n      SUM(audio) AS audio,\n      SUM(video) AS video,\n      SUM(host_sd + audience_sd) AS video_sd,\n      SUM(host_hd + audience_hd) AS video_hd,\n      SUM(host_hdp + audience_hdp) AS video_hdp,\n      SUM(host_audio) AS host_audio,\n      SUM(audience_audio) AS audience_audio,\n      SUM(host_sd) AS host_sd,\n      SUM(host_hd) AS host_hd,\n      SUM(host_hdp) AS host_hdp,\n      SUM(host_1080p) AS host_1080p,\n      SUM(host_2k) AS host_2k,\n      SUM(host_4k) AS host_4k,\n      SUM(audience_sd) AS audience_sd,\n      SUM(audience_hd) AS audience_hd,\n      SUM(audience_hdp) AS audience_hdp,\n      SUM(audience_1080p) AS audience_1080p,\n      SUM(audience_2k) AS audience_2k,\n      SUM(audience_4k) AS audience_4k,\n      SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n      SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n      SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n      SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n      SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n      SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n      SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n      SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n      SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n      SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n      SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n      SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n      SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n      SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n      SUM(total_last1) AS audio_video_last,\n      SUM(audio_last1) AS audio_last,\n      SUM(video_last1) AS video_last,\n      SUM(video_sd_last1) AS video_sd_last,\n      SUM(video_hd_last1) AS video_hd_last,\n      SUM(video_hdp_last1) AS video_hdp_last,\n      SUM(host_sd_last1) AS host_video_sd_last,\n      SUM(audience_sd_last1) AS audience_video_sd_last,\n      SUM(host_hd_last1) AS host_video_hd_last,\n      SUM(audience_hd_last1) AS audience_video_hd_last,\n      SUM(host_hdp_last1) AS host_video_hdp_last,\n      SUM(audience_hdp_last1) AS audience_video_hdp_last,\n      SUM(host_audio_last1) AS host_audio_last,\n      SUM(audience_audio_last1) AS audience_audio_last,\n      SUM(host_video_last1) AS host_video_last,\n      SUM(audience_video_last1) AS audience_video_last,\n      SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n      SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n      SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n      SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n      SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n      SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n      SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n      SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n      SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n      SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n      SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n      SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n      SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n      SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n      SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n      SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n      SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n      SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n      SUM(audience_2k_last1) AS audience_2k_last1,\n      SUM(audience_4k_last1) AS audience_4k_last1,\n      SUM(audience_1080p_last1) AS audience_1080p_last1,\n      SUM(host_1080p_last1) AS host_1080p_last1,\n      SUM(host_2k_last1) AS host_2k_last1,\n      SUM(host_4k_last1) AS host_4k_last1,\n      SUM(total_last7) AS total_last7,\n      SUM(audio_last7) AS audio_last7,\n      SUM(video_last7) AS video_last7,\n      SUM(video_sd_last7) AS video_sd_last7,\n      SUM(video_hd_last7) AS video_hd_last7,\n      SUM(video_hdp_last7) AS video_hdp_last7,\n      SUM(host_sd_last7) AS host_sd_last7,\n      SUM(audience_sd_last7) AS audience_sd_last7,\n      SUM(host_hd_last7) AS host_hd_last7,\n      SUM(audience_hd_last7) AS audience_hd_last7,\n      SUM(host_hdp_last7) AS host_hdp_last7,\n      SUM(audience_hdp_last7) AS audience_hdp_last7,\n      SUM(host_audio_last7) AS host_audio_last7,\n      SUM(audience_audio_last7) AS audience_audio_last7,\n      SUM(host_video_last7) AS host_video_last7,\n      SUM(audience_video_last7) AS audience_video_last7,\n      SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n      SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n      SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n      SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n      SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n      SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n      SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n      SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n      SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n      SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n      SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n      SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n      SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n      SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n      SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n      SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n      SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n      SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n      SUM(audience_2k_last7) AS audience_2k_last7,\n      SUM(audience_4k_last7) AS audience_4k_last7,\n      SUM(audience_1080p_last7) AS audience_1080p_last7,\n      SUM(host_1080p_last7) AS host_1080p_last7,\n      SUM(host_2k_last7) AS host_2k_last7,\n      SUM(host_4k_last7) AS host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211128 AND date <= 20211212 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n    GROUP BY date,\n      DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n      2,\n      3,\n      tag,\n      area,\n      dim,\n      8,\n      9,\n      10,\n      level4,\n      product_level1,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en,\n      vid_use_case_en,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n          start_date AS start_date,\n          end_date AS end_date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          tag,\n          area AS Scope,\n          dim,\n            CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n            CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n            CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          browser,\n          browser_ver,\n          dim_grouping_name,\n          SUM(total) AS totalUsage,\n          SUM(audio) AS audio,\n          SUM(video) AS video,\n          SUM(host_sd + audience_sd) AS video_sd,\n          SUM(host_hd + audience_hd) AS video_hd,\n          SUM(host_hdp + audience_hdp) AS video_hdp,\n          SUM(host_audio) AS host_audio,\n          SUM(audience_audio) AS audience_audio,\n          SUM(host_sd) AS host_sd,\n          SUM(host_hd) AS host_hd,\n          SUM(host_hdp) AS host_hdp,\n          SUM(host_1080p) AS host_1080p,\n          SUM(host_2k) AS host_2k,\n          SUM(host_4k) AS host_4k,\n          SUM(audience_sd) AS audience_sd,\n          SUM(audience_hd) AS audience_hd,\n          SUM(audience_hdp) AS audience_hdp,\n          SUM(audience_1080p) AS audience_1080p,\n          SUM(audience_2k) AS audience_2k,\n          SUM(audience_4k) AS audience_4k,\n          SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n          SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n          SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n          SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n          SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n          SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n          SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n          SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n          SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n          SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n          SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n          SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n          SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n          SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n          SUM(total_last1) AS audio_video_last,\n          SUM(audio_last1) AS audio_last,\n          SUM(video_last1) AS video_last,\n          SUM(video_sd_last1) AS video_sd_last,\n          SUM(video_hd_last1) AS video_hd_last,\n          SUM(video_hdp_last1) AS video_hdp_last,\n          SUM(host_sd_last1) AS host_video_sd_last,\n          SUM(audience_sd_last1) AS audience_video_sd_last,\n          SUM(host_hd_last1) AS host_video_hd_last,\n          SUM(audience_hd_last1) AS audience_video_hd_last,\n          SUM(host_hdp_last1) AS host_video_hdp_last,\n          SUM(audience_hdp_last1) AS audience_video_hdp_last,\n          SUM(host_audio_last1) AS host_audio_last,\n          SUM(audience_audio_last1) AS audience_audio_last,\n          SUM(host_video_last1) AS host_video_last,\n          SUM(audience_video_last1) AS audience_video_last,\n          SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n          SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n          SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n          SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n          SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n          SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n          SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n          SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n          SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n          SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n          SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n          SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n          SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n          SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n          SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n          SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n          SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n          SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n          SUM(audience_2k_last1) AS audience_2k_last1,\n          SUM(audience_4k_last1) AS audience_4k_last1,\n          SUM(audience_1080p_last1) AS audience_1080p_last1,\n          SUM(host_1080p_last1) AS host_1080p_last1,\n          SUM(host_2k_last1) AS host_2k_last1,\n          SUM(host_4k_last1) AS host_4k_last1,\n          SUM(total_last7) AS total_last7,\n          SUM(audio_last7) AS audio_last7,\n          SUM(video_last7) AS video_last7,\n          SUM(video_sd_last7) AS video_sd_last7,\n          SUM(video_hd_last7) AS video_hd_last7,\n          SUM(video_hdp_last7) AS video_hdp_last7,\n          SUM(host_sd_last7) AS host_sd_last7,\n          SUM(audience_sd_last7) AS audience_sd_last7,\n          SUM(host_hd_last7) AS host_hd_last7,\n          SUM(audience_hd_last7) AS audience_hd_last7,\n          SUM(host_hdp_last7) AS host_hdp_last7,\n          SUM(audience_hdp_last7) AS audience_hdp_last7,\n          SUM(host_audio_last7) AS host_audio_last7,\n          SUM(audience_audio_last7) AS audience_audio_last7,\n          SUM(host_video_last7) AS host_video_last7,\n          SUM(audience_video_last7) AS audience_video_last7,\n          SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n          SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n          SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n          SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n          SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n          SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n          SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n          SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n          SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n          SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n          SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n          SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n          SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n          SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n          SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n          SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n          SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n          SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n          SUM(audience_2k_last7) AS audience_2k_last7,\n          SUM(audience_4k_last7) AS audience_4k_last7,\n          SUM(audience_1080p_last7) AS audience_1080p_last7,\n          SUM(host_1080p_last7) AS host_1080p_last7,\n          SUM(host_2k_last7) AS host_2k_last7,\n          SUM(host_4k_last7) AS host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211128 AND date <= 20211212 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n        GROUP BY date,\n          DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n          2,\n          3,\n          tag,\n          area,\n          dim,\n          8,\n          9,\n          10,\n          level4,\n          product_level1,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en,\n          vid_use_case_en,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          browser,\n          browser_ver,\n          dim_grouping_name) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE CAST(\"自定义 SQL 查询\".\"level1\" AS VARCHAR) = 'RTSA' AND \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 3 AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 7"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700079370244)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700079370244)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700079370244)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700079370244)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700079370244)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700079370244)(943764407)(0)\",\n  MIN(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(1482809429)(0)\",\n  MIN(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(3765460736)(0)\",\n  MAX(\"自定义 SQL 查询\".\"stat_date\") AS \"TEMP(attr_stat_date_nk)(2102638629)(0)\",\n  MIN(\"自定义 SQL 查询\".\"stat_date\") AS \"TEMP(attr_stat_date_nk)(2790680713)(0)\",\n  \"自定义 SQL 查询\".\"cid_industry\" AS \"cid_industry\"\nFROM (SELECT date,\n      start_date AS start_date,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name,\n      SUM(total) AS totalUsage,\n      SUM(audio) AS audio,\n      SUM(video) AS video,\n      SUM(host_sd + audience_sd) AS video_sd,\n      SUM(host_hd + audience_hd) AS video_hd,\n      SUM(host_hdp + audience_hdp) AS video_hdp,\n      SUM(host_audio) AS host_audio,\n      SUM(audience_audio) AS audience_audio,\n      SUM(host_sd) AS host_sd,\n      SUM(host_hd) AS host_hd,\n      SUM(host_hdp) AS host_hdp,\n      SUM(host_1080p) AS host_1080p,\n      SUM(host_2k) AS host_2k,\n      SUM(host_4k) AS host_4k,\n      SUM(audience_sd) AS audience_sd,\n      SUM(audience_hd) AS audience_hd,\n      SUM(audience_hdp) AS audience_hdp,\n      SUM(audience_1080p) AS audience_1080p,\n      SUM(audience_2k) AS audience_2k,\n      SUM(audience_4k) AS audience_4k,\n      SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n      SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n      SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n      SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n      SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n      SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n      SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n      SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n      SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n      SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n      SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n      SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n      SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n      SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n      SUM(total_last1) AS audio_video_last,\n      SUM(audio_last1) AS audio_last,\n      SUM(video_last1) AS video_last,\n      SUM(video_sd_last1) AS video_sd_last,\n      SUM(video_hd_last1) AS video_hd_last,\n      SUM(video_hdp_last1) AS video_hdp_last,\n      SUM(host_sd_last1) AS host_video_sd_last,\n      SUM(audience_sd_last1) AS audience_video_sd_last,\n      SUM(host_hd_last1) AS host_video_hd_last,\n      SUM(audience_hd_last1) AS audience_video_hd_last,\n      SUM(host_hdp_last1) AS host_video_hdp_last,\n      SUM(audience_hdp_last1) AS audience_video_hdp_last,\n      SUM(host_audio_last1) AS host_audio_last,\n      SUM(audience_audio_last1) AS audience_audio_last,\n      SUM(host_video_last1) AS host_video_last,\n      SUM(audience_video_last1) AS audience_video_last,\n      SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n      SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n      SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n      SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n      SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n      SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n      SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n      SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n      SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n      SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n      SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n      SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n      SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n      SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n      SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n      SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n      SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n      SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n      SUM(audience_2k_last1) AS audience_2k_last1,\n      SUM(audience_4k_last1) AS audience_4k_last1,\n      SUM(audience_1080p_last1) AS audience_1080p_last1,\n      SUM(host_1080p_last1) AS host_1080p_last1,\n      SUM(host_2k_last1) AS host_2k_last1,\n      SUM(host_4k_last1) AS host_4k_last1,\n      SUM(total_last7) AS total_last7,\n      SUM(audio_last7) AS audio_last7,\n      SUM(video_last7) AS video_last7,\n      SUM(video_sd_last7) AS video_sd_last7,\n      SUM(video_hd_last7) AS video_hd_last7,\n      SUM(video_hdp_last7) AS video_hdp_last7,\n      SUM(host_sd_last7) AS host_sd_last7,\n      SUM(audience_sd_last7) AS audience_sd_last7,\n      SUM(host_hd_last7) AS host_hd_last7,\n      SUM(audience_hd_last7) AS audience_hd_last7,\n      SUM(host_hdp_last7) AS host_hdp_last7,\n      SUM(audience_hdp_last7) AS audience_hdp_last7,\n      SUM(host_audio_last7) AS host_audio_last7,\n      SUM(audience_audio_last7) AS audience_audio_last7,\n      SUM(host_video_last7) AS host_video_last7,\n      SUM(audience_video_last7) AS audience_video_last7,\n      SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n      SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n      SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n      SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n      SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n      SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n      SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n      SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n      SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n      SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n      SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n      SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n      SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n      SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n      SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n      SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n      SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n      SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n      SUM(audience_2k_last7) AS audience_2k_last7,\n      SUM(audience_4k_last7) AS audience_4k_last7,\n      SUM(audience_1080p_last7) AS audience_1080p_last7,\n      SUM(host_1080p_last7) AS host_1080p_last7,\n      SUM(host_2k_last7) AS host_2k_last7,\n      SUM(host_4k_last7) AS host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211128 AND date <= 20211212 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n    GROUP BY date,\n      DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n      2,\n      3,\n      tag,\n      area,\n      dim,\n      8,\n      9,\n      10,\n      level4,\n      product_level1,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en,\n      vid_use_case_en,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n          start_date AS start_date,\n          end_date AS end_date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          tag,\n          area AS Scope,\n          dim,\n            CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n            CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n            CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          browser,\n          browser_ver,\n          dim_grouping_name,\n          SUM(total) AS totalUsage,\n          SUM(audio) AS audio,\n          SUM(video) AS video,\n          SUM(host_sd + audience_sd) AS video_sd,\n          SUM(host_hd + audience_hd) AS video_hd,\n          SUM(host_hdp + audience_hdp) AS video_hdp,\n          SUM(host_audio) AS host_audio,\n          SUM(audience_audio) AS audience_audio,\n          SUM(host_sd) AS host_sd,\n          SUM(host_hd) AS host_hd,\n          SUM(host_hdp) AS host_hdp,\n          SUM(host_1080p) AS host_1080p,\n          SUM(host_2k) AS host_2k,\n          SUM(host_4k) AS host_4k,\n          SUM(audience_sd) AS audience_sd,\n          SUM(audience_hd) AS audience_hd,\n          SUM(audience_hdp) AS audience_hdp,\n          SUM(audience_1080p) AS audience_1080p,\n          SUM(audience_2k) AS audience_2k,\n          SUM(audience_4k) AS audience_4k,\n          SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n          SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n          SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n          SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n          SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n          SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n          SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n          SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n          SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n          SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n          SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n          SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n          SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n          SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n          SUM(total_last1) AS audio_video_last,\n          SUM(audio_last1) AS audio_last,\n          SUM(video_last1) AS video_last,\n          SUM(video_sd_last1) AS video_sd_last,\n          SUM(video_hd_last1) AS video_hd_last,\n          SUM(video_hdp_last1) AS video_hdp_last,\n          SUM(host_sd_last1) AS host_video_sd_last,\n          SUM(audience_sd_last1) AS audience_video_sd_last,\n          SUM(host_hd_last1) AS host_video_hd_last,\n          SUM(audience_hd_last1) AS audience_video_hd_last,\n          SUM(host_hdp_last1) AS host_video_hdp_last,\n          SUM(audience_hdp_last1) AS audience_video_hdp_last,\n          SUM(host_audio_last1) AS host_audio_last,\n          SUM(audience_audio_last1) AS audience_audio_last,\n          SUM(host_video_last1) AS host_video_last,\n          SUM(audience_video_last1) AS audience_video_last,\n          SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n          SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n          SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n          SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n          SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n          SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n          SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n          SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n          SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n          SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n          SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n          SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n          SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n          SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n          SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n          SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n          SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n          SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n          SUM(audience_2k_last1) AS audience_2k_last1,\n          SUM(audience_4k_last1) AS audience_4k_last1,\n          SUM(audience_1080p_last1) AS audience_1080p_last1,\n          SUM(host_1080p_last1) AS host_1080p_last1,\n          SUM(host_2k_last1) AS host_2k_last1,\n          SUM(host_4k_last1) AS host_4k_last1,\n          SUM(total_last7) AS total_last7,\n          SUM(audio_last7) AS audio_last7,\n          SUM(video_last7) AS video_last7,\n          SUM(video_sd_last7) AS video_sd_last7,\n          SUM(video_hd_last7) AS video_hd_last7,\n          SUM(video_hdp_last7) AS video_hdp_last7,\n          SUM(host_sd_last7) AS host_sd_last7,\n          SUM(audience_sd_last7) AS audience_sd_last7,\n          SUM(host_hd_last7) AS host_hd_last7,\n          SUM(audience_hd_last7) AS audience_hd_last7,\n          SUM(host_hdp_last7) AS host_hdp_last7,\n          SUM(audience_hdp_last7) AS audience_hdp_last7,\n          SUM(host_audio_last7) AS host_audio_last7,\n          SUM(audience_audio_last7) AS audience_audio_last7,\n          SUM(host_video_last7) AS host_video_last7,\n          SUM(audience_video_last7) AS audience_video_last7,\n          SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n          SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n          SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n          SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n          SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n          SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n          SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n          SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n          SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n          SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n          SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n          SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n          SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n          SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n          SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n          SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n          SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n          SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n          SUM(audience_2k_last7) AS audience_2k_last7,\n          SUM(audience_4k_last7) AS audience_4k_last7,\n          SUM(audience_1080p_last7) AS audience_1080p_last7,\n          SUM(host_1080p_last7) AS host_1080p_last7,\n          SUM(host_2k_last7) AS host_2k_last7,\n          SUM(host_4k_last7) AS host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211128 AND date <= 20211212 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n        GROUP BY date,\n          DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n          2,\n          3,\n          tag,\n          area,\n          dim,\n          8,\n          9,\n          10,\n          level4,\n          product_level1,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en,\n          vid_use_case_en,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          browser,\n          browser_ver,\n          dim_grouping_name) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 3 AND CAST(\"自定义 SQL 查询\".\"level1\" AS VARCHAR) = 'RTSA' AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 22"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700079370244)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700079370244)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700079370244)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700079370244)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700079370244)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700079370244)(943764407)(0)\",\n  MIN(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(1482809429)(0)\",\n  MIN(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(3765460736)(0)\",\n  \"自定义 SQL 查询\".\"product_level2\" AS \"product_level2\",\n  \"自定义 SQL 查询\".\"stat_date\" AS \"stat_date\"\nFROM (SELECT date,\n      start_date AS start_date,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name,\n      SUM(total) AS totalUsage,\n      SUM(audio) AS audio,\n      SUM(video) AS video,\n      SUM(host_sd + audience_sd) AS video_sd,\n      SUM(host_hd + audience_hd) AS video_hd,\n      SUM(host_hdp + audience_hdp) AS video_hdp,\n      SUM(host_audio) AS host_audio,\n      SUM(audience_audio) AS audience_audio,\n      SUM(host_sd) AS host_sd,\n      SUM(host_hd) AS host_hd,\n      SUM(host_hdp) AS host_hdp,\n      SUM(host_1080p) AS host_1080p,\n      SUM(host_2k) AS host_2k,\n      SUM(host_4k) AS host_4k,\n      SUM(audience_sd) AS audience_sd,\n      SUM(audience_hd) AS audience_hd,\n      SUM(audience_hdp) AS audience_hdp,\n      SUM(audience_1080p) AS audience_1080p,\n      SUM(audience_2k) AS audience_2k,\n      SUM(audience_4k) AS audience_4k,\n      SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n      SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n      SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n      SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n      SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n      SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n      SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n      SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n      SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n      SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n      SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n      SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n      SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n      SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n      SUM(total_last1) AS audio_video_last,\n      SUM(audio_last1) AS audio_last,\n      SUM(video_last1) AS video_last,\n      SUM(video_sd_last1) AS video_sd_last,\n      SUM(video_hd_last1) AS video_hd_last,\n      SUM(video_hdp_last1) AS video_hdp_last,\n      SUM(host_sd_last1) AS host_video_sd_last,\n      SUM(audience_sd_last1) AS audience_video_sd_last,\n      SUM(host_hd_last1) AS host_video_hd_last,\n      SUM(audience_hd_last1) AS audience_video_hd_last,\n      SUM(host_hdp_last1) AS host_video_hdp_last,\n      SUM(audience_hdp_last1) AS audience_video_hdp_last,\n      SUM(host_audio_last1) AS host_audio_last,\n      SUM(audience_audio_last1) AS audience_audio_last,\n      SUM(host_video_last1) AS host_video_last,\n      SUM(audience_video_last1) AS audience_video_last,\n      SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n      SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n      SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n      SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n      SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n      SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n      SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n      SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n      SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n      SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n      SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n      SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n      SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n      SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n      SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n      SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n      SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n      SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n      SUM(audience_2k_last1) AS audience_2k_last1,\n      SUM(audience_4k_last1) AS audience_4k_last1,\n      SUM(audience_1080p_last1) AS audience_1080p_last1,\n      SUM(host_1080p_last1) AS host_1080p_last1,\n      SUM(host_2k_last1) AS host_2k_last1,\n      SUM(host_4k_last1) AS host_4k_last1,\n      SUM(total_last7) AS total_last7,\n      SUM(audio_last7) AS audio_last7,\n      SUM(video_last7) AS video_last7,\n      SUM(video_sd_last7) AS video_sd_last7,\n      SUM(video_hd_last7) AS video_hd_last7,\n      SUM(video_hdp_last7) AS video_hdp_last7,\n      SUM(host_sd_last7) AS host_sd_last7,\n      SUM(audience_sd_last7) AS audience_sd_last7,\n      SUM(host_hd_last7) AS host_hd_last7,\n      SUM(audience_hd_last7) AS audience_hd_last7,\n      SUM(host_hdp_last7) AS host_hdp_last7,\n      SUM(audience_hdp_last7) AS audience_hdp_last7,\n      SUM(host_audio_last7) AS host_audio_last7,\n      SUM(audience_audio_last7) AS audience_audio_last7,\n      SUM(host_video_last7) AS host_video_last7,\n      SUM(audience_video_last7) AS audience_video_last7,\n      SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n      SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n      SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n      SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n      SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n      SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n      SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n      SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n      SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n      SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n      SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n      SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n      SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n      SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n      SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n      SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n      SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n      SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n      SUM(audience_2k_last7) AS audience_2k_last7,\n      SUM(audience_4k_last7) AS audience_4k_last7,\n      SUM(audience_1080p_last7) AS audience_1080p_last7,\n      SUM(host_1080p_last7) AS host_1080p_last7,\n      SUM(host_2k_last7) AS host_2k_last7,\n      SUM(host_4k_last7) AS host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211128 AND date <= 20211212 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n    GROUP BY date,\n      DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n      2,\n      3,\n      tag,\n      area,\n      dim,\n      8,\n      9,\n      10,\n      level4,\n      product_level1,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en,\n      vid_use_case_en,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n          start_date AS start_date,\n          end_date AS end_date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          tag,\n          area AS Scope,\n          dim,\n            CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n            CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n            CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          browser,\n          browser_ver,\n          dim_grouping_name,\n          SUM(total) AS totalUsage,\n          SUM(audio) AS audio,\n          SUM(video) AS video,\n          SUM(host_sd + audience_sd) AS video_sd,\n          SUM(host_hd + audience_hd) AS video_hd,\n          SUM(host_hdp + audience_hdp) AS video_hdp,\n          SUM(host_audio) AS host_audio,\n          SUM(audience_audio) AS audience_audio,\n          SUM(host_sd) AS host_sd,\n          SUM(host_hd) AS host_hd,\n          SUM(host_hdp) AS host_hdp,\n          SUM(host_1080p) AS host_1080p,\n          SUM(host_2k) AS host_2k,\n          SUM(host_4k) AS host_4k,\n          SUM(audience_sd) AS audience_sd,\n          SUM(audience_hd) AS audience_hd,\n          SUM(audience_hdp) AS audience_hdp,\n          SUM(audience_1080p) AS audience_1080p,\n          SUM(audience_2k) AS audience_2k,\n          SUM(audience_4k) AS audience_4k,\n          SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n          SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n          SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n          SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n          SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n          SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n          SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n          SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n          SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n          SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n          SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n          SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n          SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n          SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n          SUM(total_last1) AS audio_video_last,\n          SUM(audio_last1) AS audio_last,\n          SUM(video_last1) AS video_last,\n          SUM(video_sd_last1) AS video_sd_last,\n          SUM(video_hd_last1) AS video_hd_last,\n          SUM(video_hdp_last1) AS video_hdp_last,\n          SUM(host_sd_last1) AS host_video_sd_last,\n          SUM(audience_sd_last1) AS audience_video_sd_last,\n          SUM(host_hd_last1) AS host_video_hd_last,\n          SUM(audience_hd_last1) AS audience_video_hd_last,\n          SUM(host_hdp_last1) AS host_video_hdp_last,\n          SUM(audience_hdp_last1) AS audience_video_hdp_last,\n          SUM(host_audio_last1) AS host_audio_last,\n          SUM(audience_audio_last1) AS audience_audio_last,\n          SUM(host_video_last1) AS host_video_last,\n          SUM(audience_video_last1) AS audience_video_last,\n          SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n          SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n          SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n          SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n          SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n          SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n          SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n          SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n          SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n          SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n          SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n          SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n          SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n          SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n          SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n          SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n          SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n          SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n          SUM(audience_2k_last1) AS audience_2k_last1,\n          SUM(audience_4k_last1) AS audience_4k_last1,\n          SUM(audience_1080p_last1) AS audience_1080p_last1,\n          SUM(host_1080p_last1) AS host_1080p_last1,\n          SUM(host_2k_last1) AS host_2k_last1,\n          SUM(host_4k_last1) AS host_4k_last1,\n          SUM(total_last7) AS total_last7,\n          SUM(audio_last7) AS audio_last7,\n          SUM(video_last7) AS video_last7,\n          SUM(video_sd_last7) AS video_sd_last7,\n          SUM(video_hd_last7) AS video_hd_last7,\n          SUM(video_hdp_last7) AS video_hdp_last7,\n          SUM(host_sd_last7) AS host_sd_last7,\n          SUM(audience_sd_last7) AS audience_sd_last7,\n          SUM(host_hd_last7) AS host_hd_last7,\n          SUM(audience_hd_last7) AS audience_hd_last7,\n          SUM(host_hdp_last7) AS host_hdp_last7,\n          SUM(audience_hdp_last7) AS audience_hdp_last7,\n          SUM(host_audio_last7) AS host_audio_last7,\n          SUM(audience_audio_last7) AS audience_audio_last7,\n          SUM(host_video_last7) AS host_video_last7,\n          SUM(audience_video_last7) AS audience_video_last7,\n          SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n          SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n          SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n          SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n          SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n          SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n          SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n          SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n          SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n          SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n          SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n          SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n          SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n          SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n          SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n          SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n          SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n          SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n          SUM(audience_2k_last7) AS audience_2k_last7,\n          SUM(audience_4k_last7) AS audience_4k_last7,\n          SUM(audience_1080p_last7) AS audience_1080p_last7,\n          SUM(host_1080p_last7) AS host_1080p_last7,\n          SUM(host_2k_last7) AS host_2k_last7,\n          SUM(host_4k_last7) AS host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211128 AND date <= 20211212 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n        GROUP BY date,\n          DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n          2,\n          3,\n          tag,\n          area,\n          dim,\n          8,\n          9,\n          10,\n          level4,\n          product_level1,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en,\n          vid_use_case_en,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          browser,\n          browser_ver,\n          dim_grouping_name) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 3 AND CAST(\"自定义 SQL 查询\".\"level1\" AS VARCHAR) = 'RTSA' AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 20,\n  21"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700079370244)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700079370244)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700079370244)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700079370244)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700079370244)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700079370244)(943764407)(0)\",\n  MIN(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(1482809429)(0)\",\n  MIN(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(3765460736)(0)\",\n  \"自定义 SQL 查询\".\"stat_date\" AS \"TEMP(attr_stat_date_nk)(2102638629)(0)\",\n  \"自定义 SQL 查询\".\"stat_date\" AS \"TEMP(attr_stat_date_nk)(2790680713)(0)\",\n  \"自定义 SQL 查询\".\"stat_date\" AS \"stat_date\",\n  \"自定义 SQL 查询\".\"vid_use_case_cn\" AS \"vid_use_case_cn\"\nFROM (SELECT date,\n      start_date AS start_date,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name,\n      SUM(total) AS totalUsage,\n      SUM(audio) AS audio,\n      SUM(video) AS video,\n      SUM(host_sd + audience_sd) AS video_sd,\n      SUM(host_hd + audience_hd) AS video_hd,\n      SUM(host_hdp + audience_hdp) AS video_hdp,\n      SUM(host_audio) AS host_audio,\n      SUM(audience_audio) AS audience_audio,\n      SUM(host_sd) AS host_sd,\n      SUM(host_hd) AS host_hd,\n      SUM(host_hdp) AS host_hdp,\n      SUM(host_1080p) AS host_1080p,\n      SUM(host_2k) AS host_2k,\n      SUM(host_4k) AS host_4k,\n      SUM(audience_sd) AS audience_sd,\n      SUM(audience_hd) AS audience_hd,\n      SUM(audience_hdp) AS audience_hdp,\n      SUM(audience_1080p) AS audience_1080p,\n      SUM(audience_2k) AS audience_2k,\n      SUM(audience_4k) AS audience_4k,\n      SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n      SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n      SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n      SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n      SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n      SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n      SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n      SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n      SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n      SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n      SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n      SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n      SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n      SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n      SUM(total_last1) AS audio_video_last,\n      SUM(audio_last1) AS audio_last,\n      SUM(video_last1) AS video_last,\n      SUM(video_sd_last1) AS video_sd_last,\n      SUM(video_hd_last1) AS video_hd_last,\n      SUM(video_hdp_last1) AS video_hdp_last,\n      SUM(host_sd_last1) AS host_video_sd_last,\n      SUM(audience_sd_last1) AS audience_video_sd_last,\n      SUM(host_hd_last1) AS host_video_hd_last,\n      SUM(audience_hd_last1) AS audience_video_hd_last,\n      SUM(host_hdp_last1) AS host_video_hdp_last,\n      SUM(audience_hdp_last1) AS audience_video_hdp_last,\n      SUM(host_audio_last1) AS host_audio_last,\n      SUM(audience_audio_last1) AS audience_audio_last,\n      SUM(host_video_last1) AS host_video_last,\n      SUM(audience_video_last1) AS audience_video_last,\n      SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n      SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n      SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n      SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n      SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n      SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n      SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n      SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n      SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n      SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n      SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n      SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n      SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n      SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n      SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n      SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n      SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n      SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n      SUM(audience_2k_last1) AS audience_2k_last1,\n      SUM(audience_4k_last1) AS audience_4k_last1,\n      SUM(audience_1080p_last1) AS audience_1080p_last1,\n      SUM(host_1080p_last1) AS host_1080p_last1,\n      SUM(host_2k_last1) AS host_2k_last1,\n      SUM(host_4k_last1) AS host_4k_last1,\n      SUM(total_last7) AS total_last7,\n      SUM(audio_last7) AS audio_last7,\n      SUM(video_last7) AS video_last7,\n      SUM(video_sd_last7) AS video_sd_last7,\n      SUM(video_hd_last7) AS video_hd_last7,\n      SUM(video_hdp_last7) AS video_hdp_last7,\n      SUM(host_sd_last7) AS host_sd_last7,\n      SUM(audience_sd_last7) AS audience_sd_last7,\n      SUM(host_hd_last7) AS host_hd_last7,\n      SUM(audience_hd_last7) AS audience_hd_last7,\n      SUM(host_hdp_last7) AS host_hdp_last7,\n      SUM(audience_hdp_last7) AS audience_hdp_last7,\n      SUM(host_audio_last7) AS host_audio_last7,\n      SUM(audience_audio_last7) AS audience_audio_last7,\n      SUM(host_video_last7) AS host_video_last7,\n      SUM(audience_video_last7) AS audience_video_last7,\n      SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n      SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n      SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n      SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n      SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n      SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n      SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n      SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n      SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n      SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n      SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n      SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n      SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n      SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n      SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n      SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n      SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n      SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n      SUM(audience_2k_last7) AS audience_2k_last7,\n      SUM(audience_4k_last7) AS audience_4k_last7,\n      SUM(audience_1080p_last7) AS audience_1080p_last7,\n      SUM(host_1080p_last7) AS host_1080p_last7,\n      SUM(host_2k_last7) AS host_2k_last7,\n      SUM(host_4k_last7) AS host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211128 AND date <= 20211212 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n    GROUP BY date,\n      DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n      2,\n      3,\n      tag,\n      area,\n      dim,\n      8,\n      9,\n      10,\n      level4,\n      product_level1,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en,\n      vid_use_case_en,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n          start_date AS start_date,\n          end_date AS end_date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          tag,\n          area AS Scope,\n          dim,\n            CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n            CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n            CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          browser,\n          browser_ver,\n          dim_grouping_name,\n          SUM(total) AS totalUsage,\n          SUM(audio) AS audio,\n          SUM(video) AS video,\n          SUM(host_sd + audience_sd) AS video_sd,\n          SUM(host_hd + audience_hd) AS video_hd,\n          SUM(host_hdp + audience_hdp) AS video_hdp,\n          SUM(host_audio) AS host_audio,\n          SUM(audience_audio) AS audience_audio,\n          SUM(host_sd) AS host_sd,\n          SUM(host_hd) AS host_hd,\n          SUM(host_hdp) AS host_hdp,\n          SUM(host_1080p) AS host_1080p,\n          SUM(host_2k) AS host_2k,\n          SUM(host_4k) AS host_4k,\n          SUM(audience_sd) AS audience_sd,\n          SUM(audience_hd) AS audience_hd,\n          SUM(audience_hdp) AS audience_hdp,\n          SUM(audience_1080p) AS audience_1080p,\n          SUM(audience_2k) AS audience_2k,\n          SUM(audience_4k) AS audience_4k,\n          SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n          SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n          SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n          SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n          SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n          SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n          SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n          SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n          SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n          SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n          SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n          SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n          SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n          SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n          SUM(total_last1) AS audio_video_last,\n          SUM(audio_last1) AS audio_last,\n          SUM(video_last1) AS video_last,\n          SUM(video_sd_last1) AS video_sd_last,\n          SUM(video_hd_last1) AS video_hd_last,\n          SUM(video_hdp_last1) AS video_hdp_last,\n          SUM(host_sd_last1) AS host_video_sd_last,\n          SUM(audience_sd_last1) AS audience_video_sd_last,\n          SUM(host_hd_last1) AS host_video_hd_last,\n          SUM(audience_hd_last1) AS audience_video_hd_last,\n          SUM(host_hdp_last1) AS host_video_hdp_last,\n          SUM(audience_hdp_last1) AS audience_video_hdp_last,\n          SUM(host_audio_last1) AS host_audio_last,\n          SUM(audience_audio_last1) AS audience_audio_last,\n          SUM(host_video_last1) AS host_video_last,\n          SUM(audience_video_last1) AS audience_video_last,\n          SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n          SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n          SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n          SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n          SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n          SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n          SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n          SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n          SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n          SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n          SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n          SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n          SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n          SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n          SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n          SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n          SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n          SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n          SUM(audience_2k_last1) AS audience_2k_last1,\n          SUM(audience_4k_last1) AS audience_4k_last1,\n          SUM(audience_1080p_last1) AS audience_1080p_last1,\n          SUM(host_1080p_last1) AS host_1080p_last1,\n          SUM(host_2k_last1) AS host_2k_last1,\n          SUM(host_4k_last1) AS host_4k_last1,\n          SUM(total_last7) AS total_last7,\n          SUM(audio_last7) AS audio_last7,\n          SUM(video_last7) AS video_last7,\n          SUM(video_sd_last7) AS video_sd_last7,\n          SUM(video_hd_last7) AS video_hd_last7,\n          SUM(video_hdp_last7) AS video_hdp_last7,\n          SUM(host_sd_last7) AS host_sd_last7,\n          SUM(audience_sd_last7) AS audience_sd_last7,\n          SUM(host_hd_last7) AS host_hd_last7,\n          SUM(audience_hd_last7) AS audience_hd_last7,\n          SUM(host_hdp_last7) AS host_hdp_last7,\n          SUM(audience_hdp_last7) AS audience_hdp_last7,\n          SUM(host_audio_last7) AS host_audio_last7,\n          SUM(audience_audio_last7) AS audience_audio_last7,\n          SUM(host_video_last7) AS host_video_last7,\n          SUM(audience_video_last7) AS audience_video_last7,\n          SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n          SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n          SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n          SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n          SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n          SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n          SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n          SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n          SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n          SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n          SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n          SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n          SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n          SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n          SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n          SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n          SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n          SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n          SUM(audience_2k_last7) AS audience_2k_last7,\n          SUM(audience_4k_last7) AS audience_4k_last7,\n          SUM(audience_1080p_last7) AS audience_1080p_last7,\n          SUM(host_1080p_last7) AS host_1080p_last7,\n          SUM(host_2k_last7) AS host_2k_last7,\n          SUM(host_4k_last7) AS host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211128 AND date <= 20211212 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n        GROUP BY date,\n          DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n          2,\n          3,\n          tag,\n          area,\n          dim,\n          8,\n          9,\n          10,\n          level4,\n          product_level1,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en,\n          vid_use_case_en,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          browser,\n          browser_ver,\n          dim_grouping_name) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 3 AND CAST(\"自定义 SQL 查询\".\"level1\" AS VARCHAR) = 'RTSA' AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 20,\n  23"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3054707207061430272)(2629536046)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_video_last\") AS \"TEMP(Calculation_3054707207061430272)(2820618408)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(日环比 (复制 2)_96897765685432324)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_last\") AS \"TEMP(日环比 (复制 2)_96897765685432324)(4091190060)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(日环比 (复制)_96897765685424131)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video_last\") AS \"TEMP(日环比 (复制)_96897765685424131)(3934387163)(0)\",\n  \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"sum_audio_ok\",\n  SUM(\"自定义 SQL 查询\".\"audio_video_last\") AS \"sum_audio_video_last_ok\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"sum_video_ok\"\nFROM (SELECT date,\n      start_date AS start_date,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name,\n      SUM(total) AS totalUsage,\n      SUM(audio) AS audio,\n      SUM(video) AS video,\n      SUM(host_sd + audience_sd) AS video_sd,\n      SUM(host_hd + audience_hd) AS video_hd,\n      SUM(host_hdp + audience_hdp) AS video_hdp,\n      SUM(host_audio) AS host_audio,\n      SUM(audience_audio) AS audience_audio,\n      SUM(host_sd) AS host_sd,\n      SUM(host_hd) AS host_hd,\n      SUM(host_hdp) AS host_hdp,\n      SUM(host_1080p) AS host_1080p,\n      SUM(host_2k) AS host_2k,\n      SUM(host_4k) AS host_4k,\n      SUM(audience_sd) AS audience_sd,\n      SUM(audience_hd) AS audience_hd,\n      SUM(audience_hdp) AS audience_hdp,\n      SUM(audience_1080p) AS audience_1080p,\n      SUM(audience_2k) AS audience_2k,\n      SUM(audience_4k) AS audience_4k,\n      SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n      SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n      SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n      SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n      SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n      SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n      SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n      SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n      SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n      SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n      SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n      SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n      SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n      SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n      SUM(total_last1) AS audio_video_last,\n      SUM(audio_last1) AS audio_last,\n      SUM(video_last1) AS video_last,\n      SUM(video_sd_last1) AS video_sd_last,\n      SUM(video_hd_last1) AS video_hd_last,\n      SUM(video_hdp_last1) AS video_hdp_last,\n      SUM(host_sd_last1) AS host_video_sd_last,\n      SUM(audience_sd_last1) AS audience_video_sd_last,\n      SUM(host_hd_last1) AS host_video_hd_last,\n      SUM(audience_hd_last1) AS audience_video_hd_last,\n      SUM(host_hdp_last1) AS host_video_hdp_last,\n      SUM(audience_hdp_last1) AS audience_video_hdp_last,\n      SUM(host_audio_last1) AS host_audio_last,\n      SUM(audience_audio_last1) AS audience_audio_last,\n      SUM(host_video_last1) AS host_video_last,\n      SUM(audience_video_last1) AS audience_video_last,\n      SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n      SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n      SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n      SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n      SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n      SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n      SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n      SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n      SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n      SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n      SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n      SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n      SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n      SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n      SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n      SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n      SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n      SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n      SUM(audience_2k_last1) AS audience_2k_last1,\n      SUM(audience_4k_last1) AS audience_4k_last1,\n      SUM(audience_1080p_last1) AS audience_1080p_last1,\n      SUM(host_1080p_last1) AS host_1080p_last1,\n      SUM(host_2k_last1) AS host_2k_last1,\n      SUM(host_4k_last1) AS host_4k_last1,\n      SUM(total_last7) AS total_last7,\n      SUM(audio_last7) AS audio_last7,\n      SUM(video_last7) AS video_last7,\n      SUM(video_sd_last7) AS video_sd_last7,\n      SUM(video_hd_last7) AS video_hd_last7,\n      SUM(video_hdp_last7) AS video_hdp_last7,\n      SUM(host_sd_last7) AS host_sd_last7,\n      SUM(audience_sd_last7) AS audience_sd_last7,\n      SUM(host_hd_last7) AS host_hd_last7,\n      SUM(audience_hd_last7) AS audience_hd_last7,\n      SUM(host_hdp_last7) AS host_hdp_last7,\n      SUM(audience_hdp_last7) AS audience_hdp_last7,\n      SUM(host_audio_last7) AS host_audio_last7,\n      SUM(audience_audio_last7) AS audience_audio_last7,\n      SUM(host_video_last7) AS host_video_last7,\n      SUM(audience_video_last7) AS audience_video_last7,\n      SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n      SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n      SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n      SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n      SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n      SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n      SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n      SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n      SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n      SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n      SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n      SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n      SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n      SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n      SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n      SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n      SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n      SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n      SUM(audience_2k_last7) AS audience_2k_last7,\n      SUM(audience_4k_last7) AS audience_4k_last7,\n      SUM(audience_1080p_last7) AS audience_1080p_last7,\n      SUM(host_1080p_last7) AS host_1080p_last7,\n      SUM(host_2k_last7) AS host_2k_last7,\n      SUM(host_4k_last7) AS host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211128 AND date <= 20211212 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n    GROUP BY date,\n      DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n      2,\n      3,\n      tag,\n      area,\n      dim,\n      8,\n      9,\n      10,\n      level4,\n      product_level1,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en,\n      vid_use_case_en,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n          start_date AS start_date,\n          end_date AS end_date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          tag,\n          area AS Scope,\n          dim,\n            CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n            CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n            CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          browser,\n          browser_ver,\n          dim_grouping_name,\n          SUM(total) AS totalUsage,\n          SUM(audio) AS audio,\n          SUM(video) AS video,\n          SUM(host_sd + audience_sd) AS video_sd,\n          SUM(host_hd + audience_hd) AS video_hd,\n          SUM(host_hdp + audience_hdp) AS video_hdp,\n          SUM(host_audio) AS host_audio,\n          SUM(audience_audio) AS audience_audio,\n          SUM(host_sd) AS host_sd,\n          SUM(host_hd) AS host_hd,\n          SUM(host_hdp) AS host_hdp,\n          SUM(host_1080p) AS host_1080p,\n          SUM(host_2k) AS host_2k,\n          SUM(host_4k) AS host_4k,\n          SUM(audience_sd) AS audience_sd,\n          SUM(audience_hd) AS audience_hd,\n          SUM(audience_hdp) AS audience_hdp,\n          SUM(audience_1080p) AS audience_1080p,\n          SUM(audience_2k) AS audience_2k,\n          SUM(audience_4k) AS audience_4k,\n          SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n          SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n          SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n          SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n          SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n          SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n          SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n          SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n          SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n          SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n          SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n          SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n          SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n          SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n          SUM(total_last1) AS audio_video_last,\n          SUM(audio_last1) AS audio_last,\n          SUM(video_last1) AS video_last,\n          SUM(video_sd_last1) AS video_sd_last,\n          SUM(video_hd_last1) AS video_hd_last,\n          SUM(video_hdp_last1) AS video_hdp_last,\n          SUM(host_sd_last1) AS host_video_sd_last,\n          SUM(audience_sd_last1) AS audience_video_sd_last,\n          SUM(host_hd_last1) AS host_video_hd_last,\n          SUM(audience_hd_last1) AS audience_video_hd_last,\n          SUM(host_hdp_last1) AS host_video_hdp_last,\n          SUM(audience_hdp_last1) AS audience_video_hdp_last,\n          SUM(host_audio_last1) AS host_audio_last,\n          SUM(audience_audio_last1) AS audience_audio_last,\n          SUM(host_video_last1) AS host_video_last,\n          SUM(audience_video_last1) AS audience_video_last,\n          SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n          SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n          SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n          SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n          SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n          SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n          SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n          SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n          SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n          SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n          SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n          SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n          SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n          SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n          SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n          SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n          SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n          SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n          SUM(audience_2k_last1) AS audience_2k_last1,\n          SUM(audience_4k_last1) AS audience_4k_last1,\n          SUM(audience_1080p_last1) AS audience_1080p_last1,\n          SUM(host_1080p_last1) AS host_1080p_last1,\n          SUM(host_2k_last1) AS host_2k_last1,\n          SUM(host_4k_last1) AS host_4k_last1,\n          SUM(total_last7) AS total_last7,\n          SUM(audio_last7) AS audio_last7,\n          SUM(video_last7) AS video_last7,\n          SUM(video_sd_last7) AS video_sd_last7,\n          SUM(video_hd_last7) AS video_hd_last7,\n          SUM(video_hdp_last7) AS video_hdp_last7,\n          SUM(host_sd_last7) AS host_sd_last7,\n          SUM(audience_sd_last7) AS audience_sd_last7,\n          SUM(host_hd_last7) AS host_hd_last7,\n          SUM(audience_hd_last7) AS audience_hd_last7,\n          SUM(host_hdp_last7) AS host_hdp_last7,\n          SUM(audience_hdp_last7) AS audience_hdp_last7,\n          SUM(host_audio_last7) AS host_audio_last7,\n          SUM(audience_audio_last7) AS audience_audio_last7,\n          SUM(host_video_last7) AS host_video_last7,\n          SUM(audience_video_last7) AS audience_video_last7,\n          SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n          SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n          SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n          SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n          SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n          SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n          SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n          SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n          SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n          SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n          SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n          SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n          SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n          SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n          SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n          SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n          SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n          SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n          SUM(audience_2k_last7) AS audience_2k_last7,\n          SUM(audience_4k_last7) AS audience_4k_last7,\n          SUM(audience_1080p_last7) AS audience_1080p_last7,\n          SUM(host_1080p_last7) AS host_1080p_last7,\n          SUM(host_2k_last7) AS host_2k_last7,\n          SUM(host_4k_last7) AS host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211128 AND date <= 20211212 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n        GROUP BY date,\n          DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n          2,\n          3,\n          tag,\n          area,\n          dim,\n          8,\n          9,\n          10,\n          level4,\n          product_level1,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en,\n          vid_use_case_en,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          browser,\n          browser_ver,\n          dim_grouping_name) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE CAST(\"自定义 SQL 查询\".\"level1\" AS VARCHAR) = 'RTSA' AND \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 3 AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 7"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700079370244)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700079370244)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700079370244)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700079370244)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700079370244)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700079370244)(943764407)(0)\",\n  MIN(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(1482809429)(0)\",\n  MIN(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(3765460736)(0)\",\n  \"自定义 SQL 查询\".\"product_level3\" AS \"TEMP(attr_product_level3_nk)(1428376059)(0)\",\n  \"自定义 SQL 查询\".\"product_level3\" AS \"TEMP(attr_product_level3_nk)(3667766967)(0)\",\n  \"自定义 SQL 查询\".\"product_level3\" AS \"product_level3\",\n  \"自定义 SQL 查询\".\"stat_date\" AS \"stat_date\"\nFROM (SELECT date,\n      start_date AS start_date,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name,\n      SUM(total) AS totalUsage,\n      SUM(audio) AS audio,\n      SUM(video) AS video,\n      SUM(host_sd + audience_sd) AS video_sd,\n      SUM(host_hd + audience_hd) AS video_hd,\n      SUM(host_hdp + audience_hdp) AS video_hdp,\n      SUM(host_audio) AS host_audio,\n      SUM(audience_audio) AS audience_audio,\n      SUM(host_sd) AS host_sd,\n      SUM(host_hd) AS host_hd,\n      SUM(host_hdp) AS host_hdp,\n      SUM(host_1080p) AS host_1080p,\n      SUM(host_2k) AS host_2k,\n      SUM(host_4k) AS host_4k,\n      SUM(audience_sd) AS audience_sd,\n      SUM(audience_hd) AS audience_hd,\n      SUM(audience_hdp) AS audience_hdp,\n      SUM(audience_1080p) AS audience_1080p,\n      SUM(audience_2k) AS audience_2k,\n      SUM(audience_4k) AS audience_4k,\n      SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n      SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n      SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n      SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n      SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n      SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n      SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n      SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n      SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n      SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n      SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n      SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n      SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n      SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n      SUM(total_last1) AS audio_video_last,\n      SUM(audio_last1) AS audio_last,\n      SUM(video_last1) AS video_last,\n      SUM(video_sd_last1) AS video_sd_last,\n      SUM(video_hd_last1) AS video_hd_last,\n      SUM(video_hdp_last1) AS video_hdp_last,\n      SUM(host_sd_last1) AS host_video_sd_last,\n      SUM(audience_sd_last1) AS audience_video_sd_last,\n      SUM(host_hd_last1) AS host_video_hd_last,\n      SUM(audience_hd_last1) AS audience_video_hd_last,\n      SUM(host_hdp_last1) AS host_video_hdp_last,\n      SUM(audience_hdp_last1) AS audience_video_hdp_last,\n      SUM(host_audio_last1) AS host_audio_last,\n      SUM(audience_audio_last1) AS audience_audio_last,\n      SUM(host_video_last1) AS host_video_last,\n      SUM(audience_video_last1) AS audience_video_last,\n      SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n      SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n      SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n      SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n      SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n      SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n      SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n      SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n      SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n      SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n      SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n      SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n      SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n      SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n      SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n      SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n      SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n      SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n      SUM(audience_2k_last1) AS audience_2k_last1,\n      SUM(audience_4k_last1) AS audience_4k_last1,\n      SUM(audience_1080p_last1) AS audience_1080p_last1,\n      SUM(host_1080p_last1) AS host_1080p_last1,\n      SUM(host_2k_last1) AS host_2k_last1,\n      SUM(host_4k_last1) AS host_4k_last1,\n      SUM(total_last7) AS total_last7,\n      SUM(audio_last7) AS audio_last7,\n      SUM(video_last7) AS video_last7,\n      SUM(video_sd_last7) AS video_sd_last7,\n      SUM(video_hd_last7) AS video_hd_last7,\n      SUM(video_hdp_last7) AS video_hdp_last7,\n      SUM(host_sd_last7) AS host_sd_last7,\n      SUM(audience_sd_last7) AS audience_sd_last7,\n      SUM(host_hd_last7) AS host_hd_last7,\n      SUM(audience_hd_last7) AS audience_hd_last7,\n      SUM(host_hdp_last7) AS host_hdp_last7,\n      SUM(audience_hdp_last7) AS audience_hdp_last7,\n      SUM(host_audio_last7) AS host_audio_last7,\n      SUM(audience_audio_last7) AS audience_audio_last7,\n      SUM(host_video_last7) AS host_video_last7,\n      SUM(audience_video_last7) AS audience_video_last7,\n      SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n      SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n      SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n      SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n      SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n      SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n      SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n      SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n      SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n      SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n      SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n      SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n      SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n      SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n      SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n      SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n      SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n      SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n      SUM(audience_2k_last7) AS audience_2k_last7,\n      SUM(audience_4k_last7) AS audience_4k_last7,\n      SUM(audience_1080p_last7) AS audience_1080p_last7,\n      SUM(host_1080p_last7) AS host_1080p_last7,\n      SUM(host_2k_last7) AS host_2k_last7,\n      SUM(host_4k_last7) AS host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211128 AND date <= 20211212 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n    GROUP BY date,\n      DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n      2,\n      3,\n      tag,\n      area,\n      dim,\n      8,\n      9,\n      10,\n      level4,\n      product_level1,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en,\n      vid_use_case_en,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n          start_date AS start_date,\n          end_date AS end_date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          tag,\n          area AS Scope,\n          dim,\n            CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n            CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n            CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          browser,\n          browser_ver,\n          dim_grouping_name,\n          SUM(total) AS totalUsage,\n          SUM(audio) AS audio,\n          SUM(video) AS video,\n          SUM(host_sd + audience_sd) AS video_sd,\n          SUM(host_hd + audience_hd) AS video_hd,\n          SUM(host_hdp + audience_hdp) AS video_hdp,\n          SUM(host_audio) AS host_audio,\n          SUM(audience_audio) AS audience_audio,\n          SUM(host_sd) AS host_sd,\n          SUM(host_hd) AS host_hd,\n          SUM(host_hdp) AS host_hdp,\n          SUM(host_1080p) AS host_1080p,\n          SUM(host_2k) AS host_2k,\n          SUM(host_4k) AS host_4k,\n          SUM(audience_sd) AS audience_sd,\n          SUM(audience_hd) AS audience_hd,\n          SUM(audience_hdp) AS audience_hdp,\n          SUM(audience_1080p) AS audience_1080p,\n          SUM(audience_2k) AS audience_2k,\n          SUM(audience_4k) AS audience_4k,\n          SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n          SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n          SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n          SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n          SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n          SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n          SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n          SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n          SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n          SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n          SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n          SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n          SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n          SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n          SUM(total_last1) AS audio_video_last,\n          SUM(audio_last1) AS audio_last,\n          SUM(video_last1) AS video_last,\n          SUM(video_sd_last1) AS video_sd_last,\n          SUM(video_hd_last1) AS video_hd_last,\n          SUM(video_hdp_last1) AS video_hdp_last,\n          SUM(host_sd_last1) AS host_video_sd_last,\n          SUM(audience_sd_last1) AS audience_video_sd_last,\n          SUM(host_hd_last1) AS host_video_hd_last,\n          SUM(audience_hd_last1) AS audience_video_hd_last,\n          SUM(host_hdp_last1) AS host_video_hdp_last,\n          SUM(audience_hdp_last1) AS audience_video_hdp_last,\n          SUM(host_audio_last1) AS host_audio_last,\n          SUM(audience_audio_last1) AS audience_audio_last,\n          SUM(host_video_last1) AS host_video_last,\n          SUM(audience_video_last1) AS audience_video_last,\n          SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n          SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n          SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n          SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n          SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n          SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n          SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n          SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n          SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n          SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n          SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n          SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n          SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n          SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n          SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n          SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n          SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n          SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n          SUM(audience_2k_last1) AS audience_2k_last1,\n          SUM(audience_4k_last1) AS audience_4k_last1,\n          SUM(audience_1080p_last1) AS audience_1080p_last1,\n          SUM(host_1080p_last1) AS host_1080p_last1,\n          SUM(host_2k_last1) AS host_2k_last1,\n          SUM(host_4k_last1) AS host_4k_last1,\n          SUM(total_last7) AS total_last7,\n          SUM(audio_last7) AS audio_last7,\n          SUM(video_last7) AS video_last7,\n          SUM(video_sd_last7) AS video_sd_last7,\n          SUM(video_hd_last7) AS video_hd_last7,\n          SUM(video_hdp_last7) AS video_hdp_last7,\n          SUM(host_sd_last7) AS host_sd_last7,\n          SUM(audience_sd_last7) AS audience_sd_last7,\n          SUM(host_hd_last7) AS host_hd_last7,\n          SUM(audience_hd_last7) AS audience_hd_last7,\n          SUM(host_hdp_last7) AS host_hdp_last7,\n          SUM(audience_hdp_last7) AS audience_hdp_last7,\n          SUM(host_audio_last7) AS host_audio_last7,\n          SUM(audience_audio_last7) AS audience_audio_last7,\n          SUM(host_video_last7) AS host_video_last7,\n          SUM(audience_video_last7) AS audience_video_last7,\n          SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n          SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n          SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n          SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n          SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n          SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n          SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n          SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n          SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n          SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n          SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n          SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n          SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n          SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n          SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n          SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n          SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n          SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n          SUM(audience_2k_last7) AS audience_2k_last7,\n          SUM(audience_4k_last7) AS audience_4k_last7,\n          SUM(audience_1080p_last7) AS audience_1080p_last7,\n          SUM(host_1080p_last7) AS host_1080p_last7,\n          SUM(host_2k_last7) AS host_2k_last7,\n          SUM(host_4k_last7) AS host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211128 AND date <= 20211212 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n        GROUP BY date,\n          DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n          2,\n          3,\n          tag,\n          area,\n          dim,\n          8,\n          9,\n          10,\n          level4,\n          product_level1,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en,\n          vid_use_case_en,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          browser,\n          browser_ver,\n          dim_grouping_name) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 3 AND CAST(\"自定义 SQL 查询\".\"level1\" AS VARCHAR) = 'RTSA' AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 20,\n  23"
	},
	{
		"presto_sql" : "SELECT \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"sum_totalUsage_ok\"\nFROM (SELECT date,\n      start_date AS start_date,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name,\n      SUM(total) AS totalUsage,\n      SUM(audio) AS audio,\n      SUM(video) AS video,\n      SUM(host_sd + audience_sd) AS video_sd,\n      SUM(host_hd + audience_hd) AS video_hd,\n      SUM(host_hdp + audience_hdp) AS video_hdp,\n      SUM(host_audio) AS host_audio,\n      SUM(audience_audio) AS audience_audio,\n      SUM(host_sd) AS host_sd,\n      SUM(host_hd) AS host_hd,\n      SUM(host_hdp) AS host_hdp,\n      SUM(host_1080p) AS host_1080p,\n      SUM(host_2k) AS host_2k,\n      SUM(host_4k) AS host_4k,\n      SUM(audience_sd) AS audience_sd,\n      SUM(audience_hd) AS audience_hd,\n      SUM(audience_hdp) AS audience_hdp,\n      SUM(audience_1080p) AS audience_1080p,\n      SUM(audience_2k) AS audience_2k,\n      SUM(audience_4k) AS audience_4k,\n      SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n      SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n      SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n      SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n      SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n      SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n      SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n      SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n      SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n      SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n      SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n      SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n      SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n      SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n      SUM(total_last1) AS audio_video_last,\n      SUM(audio_last1) AS audio_last,\n      SUM(video_last1) AS video_last,\n      SUM(video_sd_last1) AS video_sd_last,\n      SUM(video_hd_last1) AS video_hd_last,\n      SUM(video_hdp_last1) AS video_hdp_last,\n      SUM(host_sd_last1) AS host_video_sd_last,\n      SUM(audience_sd_last1) AS audience_video_sd_last,\n      SUM(host_hd_last1) AS host_video_hd_last,\n      SUM(audience_hd_last1) AS audience_video_hd_last,\n      SUM(host_hdp_last1) AS host_video_hdp_last,\n      SUM(audience_hdp_last1) AS audience_video_hdp_last,\n      SUM(host_audio_last1) AS host_audio_last,\n      SUM(audience_audio_last1) AS audience_audio_last,\n      SUM(host_video_last1) AS host_video_last,\n      SUM(audience_video_last1) AS audience_video_last,\n      SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n      SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n      SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n      SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n      SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n      SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n      SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n      SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n      SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n      SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n      SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n      SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n      SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n      SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n      SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n      SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n      SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n      SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n      SUM(audience_2k_last1) AS audience_2k_last1,\n      SUM(audience_4k_last1) AS audience_4k_last1,\n      SUM(audience_1080p_last1) AS audience_1080p_last1,\n      SUM(host_1080p_last1) AS host_1080p_last1,\n      SUM(host_2k_last1) AS host_2k_last1,\n      SUM(host_4k_last1) AS host_4k_last1,\n      SUM(total_last7) AS total_last7,\n      SUM(audio_last7) AS audio_last7,\n      SUM(video_last7) AS video_last7,\n      SUM(video_sd_last7) AS video_sd_last7,\n      SUM(video_hd_last7) AS video_hd_last7,\n      SUM(video_hdp_last7) AS video_hdp_last7,\n      SUM(host_sd_last7) AS host_sd_last7,\n      SUM(audience_sd_last7) AS audience_sd_last7,\n      SUM(host_hd_last7) AS host_hd_last7,\n      SUM(audience_hd_last7) AS audience_hd_last7,\n      SUM(host_hdp_last7) AS host_hdp_last7,\n      SUM(audience_hdp_last7) AS audience_hdp_last7,\n      SUM(host_audio_last7) AS host_audio_last7,\n      SUM(audience_audio_last7) AS audience_audio_last7,\n      SUM(host_video_last7) AS host_video_last7,\n      SUM(audience_video_last7) AS audience_video_last7,\n      SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n      SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n      SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n      SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n      SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n      SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n      SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n      SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n      SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n      SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n      SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n      SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n      SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n      SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n      SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n      SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n      SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n      SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n      SUM(audience_2k_last7) AS audience_2k_last7,\n      SUM(audience_4k_last7) AS audience_4k_last7,\n      SUM(audience_1080p_last7) AS audience_1080p_last7,\n      SUM(host_1080p_last7) AS host_1080p_last7,\n      SUM(host_2k_last7) AS host_2k_last7,\n      SUM(host_4k_last7) AS host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211128 AND date <= 20211212 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n    GROUP BY date,\n      DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n      2,\n      3,\n      tag,\n      area,\n      dim,\n      8,\n      9,\n      10,\n      level4,\n      product_level1,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en,\n      vid_use_case_en,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n          start_date AS start_date,\n          end_date AS end_date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          tag,\n          area AS Scope,\n          dim,\n            CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n            CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n            CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          browser,\n          browser_ver,\n          dim_grouping_name,\n          SUM(total) AS totalUsage,\n          SUM(audio) AS audio,\n          SUM(video) AS video,\n          SUM(host_sd + audience_sd) AS video_sd,\n          SUM(host_hd + audience_hd) AS video_hd,\n          SUM(host_hdp + audience_hdp) AS video_hdp,\n          SUM(host_audio) AS host_audio,\n          SUM(audience_audio) AS audience_audio,\n          SUM(host_sd) AS host_sd,\n          SUM(host_hd) AS host_hd,\n          SUM(host_hdp) AS host_hdp,\n          SUM(host_1080p) AS host_1080p,\n          SUM(host_2k) AS host_2k,\n          SUM(host_4k) AS host_4k,\n          SUM(audience_sd) AS audience_sd,\n          SUM(audience_hd) AS audience_hd,\n          SUM(audience_hdp) AS audience_hdp,\n          SUM(audience_1080p) AS audience_1080p,\n          SUM(audience_2k) AS audience_2k,\n          SUM(audience_4k) AS audience_4k,\n          SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n          SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n          SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n          SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n          SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n          SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n          SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n          SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n          SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n          SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n          SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n          SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n          SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n          SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n          SUM(total_last1) AS audio_video_last,\n          SUM(audio_last1) AS audio_last,\n          SUM(video_last1) AS video_last,\n          SUM(video_sd_last1) AS video_sd_last,\n          SUM(video_hd_last1) AS video_hd_last,\n          SUM(video_hdp_last1) AS video_hdp_last,\n          SUM(host_sd_last1) AS host_video_sd_last,\n          SUM(audience_sd_last1) AS audience_video_sd_last,\n          SUM(host_hd_last1) AS host_video_hd_last,\n          SUM(audience_hd_last1) AS audience_video_hd_last,\n          SUM(host_hdp_last1) AS host_video_hdp_last,\n          SUM(audience_hdp_last1) AS audience_video_hdp_last,\n          SUM(host_audio_last1) AS host_audio_last,\n          SUM(audience_audio_last1) AS audience_audio_last,\n          SUM(host_video_last1) AS host_video_last,\n          SUM(audience_video_last1) AS audience_video_last,\n          SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n          SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n          SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n          SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n          SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n          SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n          SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n          SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n          SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n          SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n          SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n          SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n          SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n          SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n          SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n          SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n          SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n          SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n          SUM(audience_2k_last1) AS audience_2k_last1,\n          SUM(audience_4k_last1) AS audience_4k_last1,\n          SUM(audience_1080p_last1) AS audience_1080p_last1,\n          SUM(host_1080p_last1) AS host_1080p_last1,\n          SUM(host_2k_last1) AS host_2k_last1,\n          SUM(host_4k_last1) AS host_4k_last1,\n          SUM(total_last7) AS total_last7,\n          SUM(audio_last7) AS audio_last7,\n          SUM(video_last7) AS video_last7,\n          SUM(video_sd_last7) AS video_sd_last7,\n          SUM(video_hd_last7) AS video_hd_last7,\n          SUM(video_hdp_last7) AS video_hdp_last7,\n          SUM(host_sd_last7) AS host_sd_last7,\n          SUM(audience_sd_last7) AS audience_sd_last7,\n          SUM(host_hd_last7) AS host_hd_last7,\n          SUM(audience_hd_last7) AS audience_hd_last7,\n          SUM(host_hdp_last7) AS host_hdp_last7,\n          SUM(audience_hdp_last7) AS audience_hdp_last7,\n          SUM(host_audio_last7) AS host_audio_last7,\n          SUM(audience_audio_last7) AS audience_audio_last7,\n          SUM(host_video_last7) AS host_video_last7,\n          SUM(audience_video_last7) AS audience_video_last7,\n          SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n          SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n          SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n          SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n          SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n          SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n          SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n          SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n          SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n          SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n          SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n          SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n          SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n          SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n          SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n          SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n          SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n          SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n          SUM(audience_2k_last7) AS audience_2k_last7,\n          SUM(audience_4k_last7) AS audience_4k_last7,\n          SUM(audience_1080p_last7) AS audience_1080p_last7,\n          SUM(host_1080p_last7) AS host_1080p_last7,\n          SUM(host_2k_last7) AS host_2k_last7,\n          SUM(host_4k_last7) AS host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211128 AND date <= 20211212 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n        GROUP BY date,\n          DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n          2,\n          3,\n          tag,\n          area,\n          dim,\n          8,\n          9,\n          10,\n          level4,\n          product_level1,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en,\n          vid_use_case_en,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          browser,\n          browser_ver,\n          dim_grouping_name) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE CAST(\"自定义 SQL 查询\".\"level1\" AS VARCHAR) = 'RTSA' AND \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 3 AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 1"
	},
	{
		"presto_sql" : "SELECT MIN(1) AS \"empty\"\nFROM (SELECT date,\n      start_date AS start_date_7,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      vid,\n      project,\n      company_id,\n      company_name,\n      dim_grouping_name,\n      rownum,\n      total,\n      total_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211128 AND date <= 20211212 AND dim IN (101, 102, 103)) AS \"自定义 SQL 查询\"\nHAVING COUNT(1) > 0"
	},
	{
		"presto_sql" : "SELECT MAX(\"自定义 SQL 查询\".\"level2\") AS \"TEMP(attr_level2_nk)(3222240611)(0)\",\n  MIN(\"自定义 SQL 查询\".\"level2\") AS \"TEMP(attr_level2_nk)(3931055347)(0)\"\nFROM (SELECT date,\n      start_date AS start_date_7,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      vid,\n      project,\n      company_id,\n      company_name,\n      dim_grouping_name,\n      rownum,\n      total,\n      total_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211128 AND date <= 20211212 AND dim IN (101, 102, 103)) AS \"自定义 SQL 查询\"\nHAVING COUNT(1) > 0"
	},
	{
		"presto_sql" : "SELECT \"自定义 SQL 查询\".\"product_level2\" AS \"product_level2\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"usr_Calculation_3519281700079370244_ok\"\nFROM (SELECT date,\n      start_date AS start_date,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name,\n      SUM(total) AS totalUsage,\n      SUM(audio) AS audio,\n      SUM(video) AS video,\n      SUM(host_sd + audience_sd) AS video_sd,\n      SUM(host_hd + audience_hd) AS video_hd,\n      SUM(host_hdp + audience_hdp) AS video_hdp,\n      SUM(host_audio) AS host_audio,\n      SUM(audience_audio) AS audience_audio,\n      SUM(host_sd) AS host_sd,\n      SUM(host_hd) AS host_hd,\n      SUM(host_hdp) AS host_hdp,\n      SUM(host_1080p) AS host_1080p,\n      SUM(host_2k) AS host_2k,\n      SUM(host_4k) AS host_4k,\n      SUM(audience_sd) AS audience_sd,\n      SUM(audience_hd) AS audience_hd,\n      SUM(audience_hdp) AS audience_hdp,\n      SUM(audience_1080p) AS audience_1080p,\n      SUM(audience_2k) AS audience_2k,\n      SUM(audience_4k) AS audience_4k,\n      SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n      SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n      SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n      SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n      SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n      SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n      SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n      SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n      SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n      SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n      SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n      SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n      SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n      SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n      SUM(total_last1) AS audio_video_last,\n      SUM(audio_last1) AS audio_last,\n      SUM(video_last1) AS video_last,\n      SUM(video_sd_last1) AS video_sd_last,\n      SUM(video_hd_last1) AS video_hd_last,\n      SUM(video_hdp_last1) AS video_hdp_last,\n      SUM(host_sd_last1) AS host_video_sd_last,\n      SUM(audience_sd_last1) AS audience_video_sd_last,\n      SUM(host_hd_last1) AS host_video_hd_last,\n      SUM(audience_hd_last1) AS audience_video_hd_last,\n      SUM(host_hdp_last1) AS host_video_hdp_last,\n      SUM(audience_hdp_last1) AS audience_video_hdp_last,\n      SUM(host_audio_last1) AS host_audio_last,\n      SUM(audience_audio_last1) AS audience_audio_last,\n      SUM(host_video_last1) AS host_video_last,\n      SUM(audience_video_last1) AS audience_video_last,\n      SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n      SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n      SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n      SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n      SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n      SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n      SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n      SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n      SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n      SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n      SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n      SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n      SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n      SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n      SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n      SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n      SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n      SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n      SUM(audience_2k_last1) AS audience_2k_last1,\n      SUM(audience_4k_last1) AS audience_4k_last1,\n      SUM(audience_1080p_last1) AS audience_1080p_last1,\n      SUM(host_1080p_last1) AS host_1080p_last1,\n      SUM(host_2k_last1) AS host_2k_last1,\n      SUM(host_4k_last1) AS host_4k_last1,\n      SUM(total_last7) AS total_last7,\n      SUM(audio_last7) AS audio_last7,\n      SUM(video_last7) AS video_last7,\n      SUM(video_sd_last7) AS video_sd_last7,\n      SUM(video_hd_last7) AS video_hd_last7,\n      SUM(video_hdp_last7) AS video_hdp_last7,\n      SUM(host_sd_last7) AS host_sd_last7,\n      SUM(audience_sd_last7) AS audience_sd_last7,\n      SUM(host_hd_last7) AS host_hd_last7,\n      SUM(audience_hd_last7) AS audience_hd_last7,\n      SUM(host_hdp_last7) AS host_hdp_last7,\n      SUM(audience_hdp_last7) AS audience_hdp_last7,\n      SUM(host_audio_last7) AS host_audio_last7,\n      SUM(audience_audio_last7) AS audience_audio_last7,\n      SUM(host_video_last7) AS host_video_last7,\n      SUM(audience_video_last7) AS audience_video_last7,\n      SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n      SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n      SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n      SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n      SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n      SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n      SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n      SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n      SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n      SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n      SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n      SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n      SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n      SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n      SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n      SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n      SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n      SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n      SUM(audience_2k_last7) AS audience_2k_last7,\n      SUM(audience_4k_last7) AS audience_4k_last7,\n      SUM(audience_1080p_last7) AS audience_1080p_last7,\n      SUM(host_1080p_last7) AS host_1080p_last7,\n      SUM(host_2k_last7) AS host_2k_last7,\n      SUM(host_4k_last7) AS host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211128 AND date <= 20211212 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n    GROUP BY date,\n      DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n      2,\n      3,\n      tag,\n      area,\n      dim,\n      8,\n      9,\n      10,\n      level4,\n      product_level1,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en,\n      vid_use_case_en,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name) AS \"自定义 SQL 查询\"\nWHERE \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 3 AND CAST(\"自定义 SQL 查询\".\"level1\" AS VARCHAR) = 'RTSA'\nGROUP BY 1"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"usr_Calculation_3519281700079370244_ok\",\n  \"自定义 SQL 查询\".\"vid_use_case_cn\" AS \"vid_use_case_cn\"\nFROM (SELECT date,\n      start_date AS start_date,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name,\n      SUM(total) AS totalUsage,\n      SUM(audio) AS audio,\n      SUM(video) AS video,\n      SUM(host_sd + audience_sd) AS video_sd,\n      SUM(host_hd + audience_hd) AS video_hd,\n      SUM(host_hdp + audience_hdp) AS video_hdp,\n      SUM(host_audio) AS host_audio,\n      SUM(audience_audio) AS audience_audio,\n      SUM(host_sd) AS host_sd,\n      SUM(host_hd) AS host_hd,\n      SUM(host_hdp) AS host_hdp,\n      SUM(host_1080p) AS host_1080p,\n      SUM(host_2k) AS host_2k,\n      SUM(host_4k) AS host_4k,\n      SUM(audience_sd) AS audience_sd,\n      SUM(audience_hd) AS audience_hd,\n      SUM(audience_hdp) AS audience_hdp,\n      SUM(audience_1080p) AS audience_1080p,\n      SUM(audience_2k) AS audience_2k,\n      SUM(audience_4k) AS audience_4k,\n      SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n      SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n      SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n      SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n      SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n      SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n      SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n      SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n      SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n      SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n      SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n      SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n      SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n      SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n      SUM(total_last1) AS audio_video_last,\n      SUM(audio_last1) AS audio_last,\n      SUM(video_last1) AS video_last,\n      SUM(video_sd_last1) AS video_sd_last,\n      SUM(video_hd_last1) AS video_hd_last,\n      SUM(video_hdp_last1) AS video_hdp_last,\n      SUM(host_sd_last1) AS host_video_sd_last,\n      SUM(audience_sd_last1) AS audience_video_sd_last,\n      SUM(host_hd_last1) AS host_video_hd_last,\n      SUM(audience_hd_last1) AS audience_video_hd_last,\n      SUM(host_hdp_last1) AS host_video_hdp_last,\n      SUM(audience_hdp_last1) AS audience_video_hdp_last,\n      SUM(host_audio_last1) AS host_audio_last,\n      SUM(audience_audio_last1) AS audience_audio_last,\n      SUM(host_video_last1) AS host_video_last,\n      SUM(audience_video_last1) AS audience_video_last,\n      SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n      SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n      SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n      SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n      SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n      SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n      SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n      SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n      SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n      SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n      SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n      SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n      SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n      SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n      SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n      SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n      SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n      SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n      SUM(audience_2k_last1) AS audience_2k_last1,\n      SUM(audience_4k_last1) AS audience_4k_last1,\n      SUM(audience_1080p_last1) AS audience_1080p_last1,\n      SUM(host_1080p_last1) AS host_1080p_last1,\n      SUM(host_2k_last1) AS host_2k_last1,\n      SUM(host_4k_last1) AS host_4k_last1,\n      SUM(total_last7) AS total_last7,\n      SUM(audio_last7) AS audio_last7,\n      SUM(video_last7) AS video_last7,\n      SUM(video_sd_last7) AS video_sd_last7,\n      SUM(video_hd_last7) AS video_hd_last7,\n      SUM(video_hdp_last7) AS video_hdp_last7,\n      SUM(host_sd_last7) AS host_sd_last7,\n      SUM(audience_sd_last7) AS audience_sd_last7,\n      SUM(host_hd_last7) AS host_hd_last7,\n      SUM(audience_hd_last7) AS audience_hd_last7,\n      SUM(host_hdp_last7) AS host_hdp_last7,\n      SUM(audience_hdp_last7) AS audience_hdp_last7,\n      SUM(host_audio_last7) AS host_audio_last7,\n      SUM(audience_audio_last7) AS audience_audio_last7,\n      SUM(host_video_last7) AS host_video_last7,\n      SUM(audience_video_last7) AS audience_video_last7,\n      SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n      SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n      SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n      SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n      SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n      SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n      SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n      SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n      SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n      SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n      SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n      SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n      SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n      SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n      SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n      SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n      SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n      SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n      SUM(audience_2k_last7) AS audience_2k_last7,\n      SUM(audience_4k_last7) AS audience_4k_last7,\n      SUM(audience_1080p_last7) AS audience_1080p_last7,\n      SUM(host_1080p_last7) AS host_1080p_last7,\n      SUM(host_2k_last7) AS host_2k_last7,\n      SUM(host_4k_last7) AS host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211128 AND date <= 20211212 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n    GROUP BY date,\n      DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n      2,\n      3,\n      tag,\n      area,\n      dim,\n      8,\n      9,\n      10,\n      level4,\n      product_level1,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en,\n      vid_use_case_en,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name) AS \"自定义 SQL 查询\"\nWHERE \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 3 AND CAST(\"自定义 SQL 查询\".\"level1\" AS VARCHAR) = 'RTSA'\nGROUP BY 2"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"usr_Calculation_3519281700079370244_ok\",\n  \"自定义 SQL 查询\".\"vid_sector_en\" AS \"vid_sector_en\"\nFROM (SELECT date,\n      start_date AS start_date,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name,\n      SUM(total) AS totalUsage,\n      SUM(audio) AS audio,\n      SUM(video) AS video,\n      SUM(host_sd + audience_sd) AS video_sd,\n      SUM(host_hd + audience_hd) AS video_hd,\n      SUM(host_hdp + audience_hdp) AS video_hdp,\n      SUM(host_audio) AS host_audio,\n      SUM(audience_audio) AS audience_audio,\n      SUM(host_sd) AS host_sd,\n      SUM(host_hd) AS host_hd,\n      SUM(host_hdp) AS host_hdp,\n      SUM(host_1080p) AS host_1080p,\n      SUM(host_2k) AS host_2k,\n      SUM(host_4k) AS host_4k,\n      SUM(audience_sd) AS audience_sd,\n      SUM(audience_hd) AS audience_hd,\n      SUM(audience_hdp) AS audience_hdp,\n      SUM(audience_1080p) AS audience_1080p,\n      SUM(audience_2k) AS audience_2k,\n      SUM(audience_4k) AS audience_4k,\n      SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n      SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n      SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n      SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n      SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n      SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n      SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n      SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n      SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n      SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n      SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n      SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n      SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n      SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n      SUM(total_last1) AS audio_video_last,\n      SUM(audio_last1) AS audio_last,\n      SUM(video_last1) AS video_last,\n      SUM(video_sd_last1) AS video_sd_last,\n      SUM(video_hd_last1) AS video_hd_last,\n      SUM(video_hdp_last1) AS video_hdp_last,\n      SUM(host_sd_last1) AS host_video_sd_last,\n      SUM(audience_sd_last1) AS audience_video_sd_last,\n      SUM(host_hd_last1) AS host_video_hd_last,\n      SUM(audience_hd_last1) AS audience_video_hd_last,\n      SUM(host_hdp_last1) AS host_video_hdp_last,\n      SUM(audience_hdp_last1) AS audience_video_hdp_last,\n      SUM(host_audio_last1) AS host_audio_last,\n      SUM(audience_audio_last1) AS audience_audio_last,\n      SUM(host_video_last1) AS host_video_last,\n      SUM(audience_video_last1) AS audience_video_last,\n      SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n      SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n      SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n      SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n      SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n      SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n      SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n      SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n      SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n      SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n      SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n      SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n      SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n      SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n      SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n      SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n      SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n      SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n      SUM(audience_2k_last1) AS audience_2k_last1,\n      SUM(audience_4k_last1) AS audience_4k_last1,\n      SUM(audience_1080p_last1) AS audience_1080p_last1,\n      SUM(host_1080p_last1) AS host_1080p_last1,\n      SUM(host_2k_last1) AS host_2k_last1,\n      SUM(host_4k_last1) AS host_4k_last1,\n      SUM(total_last7) AS total_last7,\n      SUM(audio_last7) AS audio_last7,\n      SUM(video_last7) AS video_last7,\n      SUM(video_sd_last7) AS video_sd_last7,\n      SUM(video_hd_last7) AS video_hd_last7,\n      SUM(video_hdp_last7) AS video_hdp_last7,\n      SUM(host_sd_last7) AS host_sd_last7,\n      SUM(audience_sd_last7) AS audience_sd_last7,\n      SUM(host_hd_last7) AS host_hd_last7,\n      SUM(audience_hd_last7) AS audience_hd_last7,\n      SUM(host_hdp_last7) AS host_hdp_last7,\n      SUM(audience_hdp_last7) AS audience_hdp_last7,\n      SUM(host_audio_last7) AS host_audio_last7,\n      SUM(audience_audio_last7) AS audience_audio_last7,\n      SUM(host_video_last7) AS host_video_last7,\n      SUM(audience_video_last7) AS audience_video_last7,\n      SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n      SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n      SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n      SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n      SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n      SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n      SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n      SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n      SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n      SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n      SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n      SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n      SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n      SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n      SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n      SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n      SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n      SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n      SUM(audience_2k_last7) AS audience_2k_last7,\n      SUM(audience_4k_last7) AS audience_4k_last7,\n      SUM(audience_1080p_last7) AS audience_1080p_last7,\n      SUM(host_1080p_last7) AS host_1080p_last7,\n      SUM(host_2k_last7) AS host_2k_last7,\n      SUM(host_4k_last7) AS host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211128 AND date <= 20211212 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n    GROUP BY date,\n      DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n      2,\n      3,\n      tag,\n      area,\n      dim,\n      8,\n      9,\n      10,\n      level4,\n      product_level1,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en,\n      vid_use_case_en,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name) AS \"自定义 SQL 查询\"\nWHERE \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 3 AND CAST(\"自定义 SQL 查询\".\"level1\" AS VARCHAR) = 'RTSA'\nGROUP BY 2"
	},
	{
		"presto_sql" : "SELECT \"自定义 SQL 查询\".\"product_level3\" AS \"product_level3\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"usr_Calculation_3519281700079370244_ok\"\nFROM (SELECT date,\n      start_date AS start_date,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name,\n      SUM(total) AS totalUsage,\n      SUM(audio) AS audio,\n      SUM(video) AS video,\n      SUM(host_sd + audience_sd) AS video_sd,\n      SUM(host_hd + audience_hd) AS video_hd,\n      SUM(host_hdp + audience_hdp) AS video_hdp,\n      SUM(host_audio) AS host_audio,\n      SUM(audience_audio) AS audience_audio,\n      SUM(host_sd) AS host_sd,\n      SUM(host_hd) AS host_hd,\n      SUM(host_hdp) AS host_hdp,\n      SUM(host_1080p) AS host_1080p,\n      SUM(host_2k) AS host_2k,\n      SUM(host_4k) AS host_4k,\n      SUM(audience_sd) AS audience_sd,\n      SUM(audience_hd) AS audience_hd,\n      SUM(audience_hdp) AS audience_hdp,\n      SUM(audience_1080p) AS audience_1080p,\n      SUM(audience_2k) AS audience_2k,\n      SUM(audience_4k) AS audience_4k,\n      SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n      SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n      SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n      SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n      SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n      SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n      SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n      SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n      SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n      SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n      SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n      SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n      SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n      SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n      SUM(total_last1) AS audio_video_last,\n      SUM(audio_last1) AS audio_last,\n      SUM(video_last1) AS video_last,\n      SUM(video_sd_last1) AS video_sd_last,\n      SUM(video_hd_last1) AS video_hd_last,\n      SUM(video_hdp_last1) AS video_hdp_last,\n      SUM(host_sd_last1) AS host_video_sd_last,\n      SUM(audience_sd_last1) AS audience_video_sd_last,\n      SUM(host_hd_last1) AS host_video_hd_last,\n      SUM(audience_hd_last1) AS audience_video_hd_last,\n      SUM(host_hdp_last1) AS host_video_hdp_last,\n      SUM(audience_hdp_last1) AS audience_video_hdp_last,\n      SUM(host_audio_last1) AS host_audio_last,\n      SUM(audience_audio_last1) AS audience_audio_last,\n      SUM(host_video_last1) AS host_video_last,\n      SUM(audience_video_last1) AS audience_video_last,\n      SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n      SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n      SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n      SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n      SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n      SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n      SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n      SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n      SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n      SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n      SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n      SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n      SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n      SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n      SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n      SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n      SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n      SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n      SUM(audience_2k_last1) AS audience_2k_last1,\n      SUM(audience_4k_last1) AS audience_4k_last1,\n      SUM(audience_1080p_last1) AS audience_1080p_last1,\n      SUM(host_1080p_last1) AS host_1080p_last1,\n      SUM(host_2k_last1) AS host_2k_last1,\n      SUM(host_4k_last1) AS host_4k_last1,\n      SUM(total_last7) AS total_last7,\n      SUM(audio_last7) AS audio_last7,\n      SUM(video_last7) AS video_last7,\n      SUM(video_sd_last7) AS video_sd_last7,\n      SUM(video_hd_last7) AS video_hd_last7,\n      SUM(video_hdp_last7) AS video_hdp_last7,\n      SUM(host_sd_last7) AS host_sd_last7,\n      SUM(audience_sd_last7) AS audience_sd_last7,\n      SUM(host_hd_last7) AS host_hd_last7,\n      SUM(audience_hd_last7) AS audience_hd_last7,\n      SUM(host_hdp_last7) AS host_hdp_last7,\n      SUM(audience_hdp_last7) AS audience_hdp_last7,\n      SUM(host_audio_last7) AS host_audio_last7,\n      SUM(audience_audio_last7) AS audience_audio_last7,\n      SUM(host_video_last7) AS host_video_last7,\n      SUM(audience_video_last7) AS audience_video_last7,\n      SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n      SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n      SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n      SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n      SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n      SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n      SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n      SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n      SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n      SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n      SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n      SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n      SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n      SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n      SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n      SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n      SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n      SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n      SUM(audience_2k_last7) AS audience_2k_last7,\n      SUM(audience_4k_last7) AS audience_4k_last7,\n      SUM(audience_1080p_last7) AS audience_1080p_last7,\n      SUM(host_1080p_last7) AS host_1080p_last7,\n      SUM(host_2k_last7) AS host_2k_last7,\n      SUM(host_4k_last7) AS host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211128 AND date <= 20211212 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n    GROUP BY date,\n      DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n      2,\n      3,\n      tag,\n      area,\n      dim,\n      8,\n      9,\n      10,\n      level4,\n      product_level1,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en,\n      vid_use_case_en,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name) AS \"自定义 SQL 查询\"\nWHERE \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 3 AND CAST(\"自定义 SQL 查询\".\"level1\" AS VARCHAR) = 'RTSA'\nGROUP BY 1"
	},
	{
		"presto_sql" : "SELECT \"自定义 SQL 查询\".\"level3\" AS \"level3\"\nFROM (SELECT date,\n      start_date AS start_date,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name,\n      SUM(total) AS totalUsage,\n      SUM(audio) AS audio,\n      SUM(video) AS video,\n      SUM(host_sd + audience_sd) AS video_sd,\n      SUM(host_hd + audience_hd) AS video_hd,\n      SUM(host_hdp + audience_hdp) AS video_hdp,\n      SUM(host_audio) AS host_audio,\n      SUM(audience_audio) AS audience_audio,\n      SUM(host_sd) AS host_sd,\n      SUM(host_hd) AS host_hd,\n      SUM(host_hdp) AS host_hdp,\n      SUM(host_1080p) AS host_1080p,\n      SUM(host_2k) AS host_2k,\n      SUM(host_4k) AS host_4k,\n      SUM(audience_sd) AS audience_sd,\n      SUM(audience_hd) AS audience_hd,\n      SUM(audience_hdp) AS audience_hdp,\n      SUM(audience_1080p) AS audience_1080p,\n      SUM(audience_2k) AS audience_2k,\n      SUM(audience_4k) AS audience_4k,\n      SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n      SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n      SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n      SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n      SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n      SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n      SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n      SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n      SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n      SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n      SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n      SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n      SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n      SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n      SUM(total_last1) AS audio_video_last,\n      SUM(audio_last1) AS audio_last,\n      SUM(video_last1) AS video_last,\n      SUM(video_sd_last1) AS video_sd_last,\n      SUM(video_hd_last1) AS video_hd_last,\n      SUM(video_hdp_last1) AS video_hdp_last,\n      SUM(host_sd_last1) AS host_video_sd_last,\n      SUM(audience_sd_last1) AS audience_video_sd_last,\n      SUM(host_hd_last1) AS host_video_hd_last,\n      SUM(audience_hd_last1) AS audience_video_hd_last,\n      SUM(host_hdp_last1) AS host_video_hdp_last,\n      SUM(audience_hdp_last1) AS audience_video_hdp_last,\n      SUM(host_audio_last1) AS host_audio_last,\n      SUM(audience_audio_last1) AS audience_audio_last,\n      SUM(host_video_last1) AS host_video_last,\n      SUM(audience_video_last1) AS audience_video_last,\n      SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n      SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n      SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n      SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n      SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n      SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n      SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n      SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n      SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n      SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n      SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n      SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n      SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n      SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n      SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n      SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n      SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n      SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n      SUM(audience_2k_last1) AS audience_2k_last1,\n      SUM(audience_4k_last1) AS audience_4k_last1,\n      SUM(audience_1080p_last1) AS audience_1080p_last1,\n      SUM(host_1080p_last1) AS host_1080p_last1,\n      SUM(host_2k_last1) AS host_2k_last1,\n      SUM(host_4k_last1) AS host_4k_last1,\n      SUM(total_last7) AS total_last7,\n      SUM(audio_last7) AS audio_last7,\n      SUM(video_last7) AS video_last7,\n      SUM(video_sd_last7) AS video_sd_last7,\n      SUM(video_hd_last7) AS video_hd_last7,\n      SUM(video_hdp_last7) AS video_hdp_last7,\n      SUM(host_sd_last7) AS host_sd_last7,\n      SUM(audience_sd_last7) AS audience_sd_last7,\n      SUM(host_hd_last7) AS host_hd_last7,\n      SUM(audience_hd_last7) AS audience_hd_last7,\n      SUM(host_hdp_last7) AS host_hdp_last7,\n      SUM(audience_hdp_last7) AS audience_hdp_last7,\n      SUM(host_audio_last7) AS host_audio_last7,\n      SUM(audience_audio_last7) AS audience_audio_last7,\n      SUM(host_video_last7) AS host_video_last7,\n      SUM(audience_video_last7) AS audience_video_last7,\n      SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n      SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n      SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n      SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n      SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n      SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n      SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n      SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n      SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n      SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n      SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n      SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n      SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n      SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n      SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n      SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n      SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n      SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n      SUM(audience_2k_last7) AS audience_2k_last7,\n      SUM(audience_4k_last7) AS audience_4k_last7,\n      SUM(audience_1080p_last7) AS audience_1080p_last7,\n      SUM(host_1080p_last7) AS host_1080p_last7,\n      SUM(host_2k_last7) AS host_2k_last7,\n      SUM(host_4k_last7) AS host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211128 AND date <= 20211212 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n    GROUP BY date,\n      DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n      2,\n      3,\n      tag,\n      area,\n      dim,\n      8,\n      9,\n      10,\n      level4,\n      product_level1,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en,\n      vid_use_case_en,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name) AS \"自定义 SQL 查询\"\nWHERE \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 3 AND CAST(\"自定义 SQL 查询\".\"level1\" AS VARCHAR) = 'RTSA'\nGROUP BY 1"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700079370244)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700079370244)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700079370244)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700079370244)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700079370244)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700079370244)(943764407)(0)\",\n  MIN(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(1482809429)(0)\",\n  MIN(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(3765460736)(0)\",\n  \"自定义 SQL 查询\".\"stat_date\" AS \"TEMP(attr_stat_date_nk)(2102638629)(0)\",\n  \"自定义 SQL 查询\".\"stat_date\" AS \"TEMP(attr_stat_date_nk)(2790680713)(0)\",\n  \"自定义 SQL 查询\".\"cid_industry\" AS \"cid_industry\",\n  \"自定义 SQL 查询\".\"stat_date\" AS \"stat_date\"\nFROM (SELECT date,\n      start_date AS start_date,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name,\n      SUM(total) AS totalUsage,\n      SUM(audio) AS audio,\n      SUM(video) AS video,\n      SUM(host_sd + audience_sd) AS video_sd,\n      SUM(host_hd + audience_hd) AS video_hd,\n      SUM(host_hdp + audience_hdp) AS video_hdp,\n      SUM(host_audio) AS host_audio,\n      SUM(audience_audio) AS audience_audio,\n      SUM(host_sd) AS host_sd,\n      SUM(host_hd) AS host_hd,\n      SUM(host_hdp) AS host_hdp,\n      SUM(host_1080p) AS host_1080p,\n      SUM(host_2k) AS host_2k,\n      SUM(host_4k) AS host_4k,\n      SUM(audience_sd) AS audience_sd,\n      SUM(audience_hd) AS audience_hd,\n      SUM(audience_hdp) AS audience_hdp,\n      SUM(audience_1080p) AS audience_1080p,\n      SUM(audience_2k) AS audience_2k,\n      SUM(audience_4k) AS audience_4k,\n      SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n      SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n      SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n      SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n      SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n      SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n      SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n      SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n      SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n      SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n      SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n      SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n      SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n      SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n      SUM(total_last1) AS audio_video_last,\n      SUM(audio_last1) AS audio_last,\n      SUM(video_last1) AS video_last,\n      SUM(video_sd_last1) AS video_sd_last,\n      SUM(video_hd_last1) AS video_hd_last,\n      SUM(video_hdp_last1) AS video_hdp_last,\n      SUM(host_sd_last1) AS host_video_sd_last,\n      SUM(audience_sd_last1) AS audience_video_sd_last,\n      SUM(host_hd_last1) AS host_video_hd_last,\n      SUM(audience_hd_last1) AS audience_video_hd_last,\n      SUM(host_hdp_last1) AS host_video_hdp_last,\n      SUM(audience_hdp_last1) AS audience_video_hdp_last,\n      SUM(host_audio_last1) AS host_audio_last,\n      SUM(audience_audio_last1) AS audience_audio_last,\n      SUM(host_video_last1) AS host_video_last,\n      SUM(audience_video_last1) AS audience_video_last,\n      SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n      SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n      SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n      SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n      SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n      SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n      SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n      SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n      SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n      SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n      SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n      SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n      SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n      SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n      SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n      SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n      SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n      SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n      SUM(audience_2k_last1) AS audience_2k_last1,\n      SUM(audience_4k_last1) AS audience_4k_last1,\n      SUM(audience_1080p_last1) AS audience_1080p_last1,\n      SUM(host_1080p_last1) AS host_1080p_last1,\n      SUM(host_2k_last1) AS host_2k_last1,\n      SUM(host_4k_last1) AS host_4k_last1,\n      SUM(total_last7) AS total_last7,\n      SUM(audio_last7) AS audio_last7,\n      SUM(video_last7) AS video_last7,\n      SUM(video_sd_last7) AS video_sd_last7,\n      SUM(video_hd_last7) AS video_hd_last7,\n      SUM(video_hdp_last7) AS video_hdp_last7,\n      SUM(host_sd_last7) AS host_sd_last7,\n      SUM(audience_sd_last7) AS audience_sd_last7,\n      SUM(host_hd_last7) AS host_hd_last7,\n      SUM(audience_hd_last7) AS audience_hd_last7,\n      SUM(host_hdp_last7) AS host_hdp_last7,\n      SUM(audience_hdp_last7) AS audience_hdp_last7,\n      SUM(host_audio_last7) AS host_audio_last7,\n      SUM(audience_audio_last7) AS audience_audio_last7,\n      SUM(host_video_last7) AS host_video_last7,\n      SUM(audience_video_last7) AS audience_video_last7,\n      SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n      SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n      SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n      SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n      SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n      SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n      SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n      SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n      SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n      SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n      SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n      SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n      SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n      SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n      SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n      SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n      SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n      SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n      SUM(audience_2k_last7) AS audience_2k_last7,\n      SUM(audience_4k_last7) AS audience_4k_last7,\n      SUM(audience_1080p_last7) AS audience_1080p_last7,\n      SUM(host_1080p_last7) AS host_1080p_last7,\n      SUM(host_2k_last7) AS host_2k_last7,\n      SUM(host_4k_last7) AS host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211128 AND date <= 20211212 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n    GROUP BY date,\n      DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n      2,\n      3,\n      tag,\n      area,\n      dim,\n      8,\n      9,\n      10,\n      level4,\n      product_level1,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en,\n      vid_use_case_en,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name) AS \"自定义 SQL 查询\"\nWHERE \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 3 AND CAST(\"自定义 SQL 查询\".\"level1\" AS VARCHAR) = 'RTSA'\nGROUP BY 22,\n  23"
	},
	{
		"presto_sql" : "SELECT \"自定义 SQL 查询\".\"cid_industry\" AS \"cid_industry\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"usr_Calculation_3519281700079370244_ok\"\nFROM (SELECT date,\n      start_date AS start_date,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name,\n      SUM(total) AS totalUsage,\n      SUM(audio) AS audio,\n      SUM(video) AS video,\n      SUM(host_sd + audience_sd) AS video_sd,\n      SUM(host_hd + audience_hd) AS video_hd,\n      SUM(host_hdp + audience_hdp) AS video_hdp,\n      SUM(host_audio) AS host_audio,\n      SUM(audience_audio) AS audience_audio,\n      SUM(host_sd) AS host_sd,\n      SUM(host_hd) AS host_hd,\n      SUM(host_hdp) AS host_hdp,\n      SUM(host_1080p) AS host_1080p,\n      SUM(host_2k) AS host_2k,\n      SUM(host_4k) AS host_4k,\n      SUM(audience_sd) AS audience_sd,\n      SUM(audience_hd) AS audience_hd,\n      SUM(audience_hdp) AS audience_hdp,\n      SUM(audience_1080p) AS audience_1080p,\n      SUM(audience_2k) AS audience_2k,\n      SUM(audience_4k) AS audience_4k,\n      SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n      SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n      SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n      SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n      SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n      SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n      SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n      SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n      SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n      SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n      SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n      SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n      SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n      SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n      SUM(total_last1) AS audio_video_last,\n      SUM(audio_last1) AS audio_last,\n      SUM(video_last1) AS video_last,\n      SUM(video_sd_last1) AS video_sd_last,\n      SUM(video_hd_last1) AS video_hd_last,\n      SUM(video_hdp_last1) AS video_hdp_last,\n      SUM(host_sd_last1) AS host_video_sd_last,\n      SUM(audience_sd_last1) AS audience_video_sd_last,\n      SUM(host_hd_last1) AS host_video_hd_last,\n      SUM(audience_hd_last1) AS audience_video_hd_last,\n      SUM(host_hdp_last1) AS host_video_hdp_last,\n      SUM(audience_hdp_last1) AS audience_video_hdp_last,\n      SUM(host_audio_last1) AS host_audio_last,\n      SUM(audience_audio_last1) AS audience_audio_last,\n      SUM(host_video_last1) AS host_video_last,\n      SUM(audience_video_last1) AS audience_video_last,\n      SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n      SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n      SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n      SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n      SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n      SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n      SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n      SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n      SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n      SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n      SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n      SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n      SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n      SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n      SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n      SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n      SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n      SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n      SUM(audience_2k_last1) AS audience_2k_last1,\n      SUM(audience_4k_last1) AS audience_4k_last1,\n      SUM(audience_1080p_last1) AS audience_1080p_last1,\n      SUM(host_1080p_last1) AS host_1080p_last1,\n      SUM(host_2k_last1) AS host_2k_last1,\n      SUM(host_4k_last1) AS host_4k_last1,\n      SUM(total_last7) AS total_last7,\n      SUM(audio_last7) AS audio_last7,\n      SUM(video_last7) AS video_last7,\n      SUM(video_sd_last7) AS video_sd_last7,\n      SUM(video_hd_last7) AS video_hd_last7,\n      SUM(video_hdp_last7) AS video_hdp_last7,\n      SUM(host_sd_last7) AS host_sd_last7,\n      SUM(audience_sd_last7) AS audience_sd_last7,\n      SUM(host_hd_last7) AS host_hd_last7,\n      SUM(audience_hd_last7) AS audience_hd_last7,\n      SUM(host_hdp_last7) AS host_hdp_last7,\n      SUM(audience_hdp_last7) AS audience_hdp_last7,\n      SUM(host_audio_last7) AS host_audio_last7,\n      SUM(audience_audio_last7) AS audience_audio_last7,\n      SUM(host_video_last7) AS host_video_last7,\n      SUM(audience_video_last7) AS audience_video_last7,\n      SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n      SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n      SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n      SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n      SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n      SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n      SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n      SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n      SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n      SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n      SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n      SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n      SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n      SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n      SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n      SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n      SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n      SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n      SUM(audience_2k_last7) AS audience_2k_last7,\n      SUM(audience_4k_last7) AS audience_4k_last7,\n      SUM(audience_1080p_last7) AS audience_1080p_last7,\n      SUM(host_1080p_last7) AS host_1080p_last7,\n      SUM(host_2k_last7) AS host_2k_last7,\n      SUM(host_4k_last7) AS host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211128 AND date <= 20211212 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n    GROUP BY date,\n      DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n      2,\n      3,\n      tag,\n      area,\n      dim,\n      8,\n      9,\n      10,\n      level4,\n      product_level1,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en,\n      vid_use_case_en,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n          start_date AS start_date,\n          end_date AS end_date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          tag,\n          area AS Scope,\n          dim,\n            CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n            CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n            CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          browser,\n          browser_ver,\n          dim_grouping_name,\n          SUM(total) AS totalUsage,\n          SUM(audio) AS audio,\n          SUM(video) AS video,\n          SUM(host_sd + audience_sd) AS video_sd,\n          SUM(host_hd + audience_hd) AS video_hd,\n          SUM(host_hdp + audience_hdp) AS video_hdp,\n          SUM(host_audio) AS host_audio,\n          SUM(audience_audio) AS audience_audio,\n          SUM(host_sd) AS host_sd,\n          SUM(host_hd) AS host_hd,\n          SUM(host_hdp) AS host_hdp,\n          SUM(host_1080p) AS host_1080p,\n          SUM(host_2k) AS host_2k,\n          SUM(host_4k) AS host_4k,\n          SUM(audience_sd) AS audience_sd,\n          SUM(audience_hd) AS audience_hd,\n          SUM(audience_hdp) AS audience_hdp,\n          SUM(audience_1080p) AS audience_1080p,\n          SUM(audience_2k) AS audience_2k,\n          SUM(audience_4k) AS audience_4k,\n          SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n          SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n          SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n          SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n          SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n          SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n          SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n          SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n          SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n          SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n          SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n          SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n          SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n          SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n          SUM(total_last1) AS audio_video_last,\n          SUM(audio_last1) AS audio_last,\n          SUM(video_last1) AS video_last,\n          SUM(video_sd_last1) AS video_sd_last,\n          SUM(video_hd_last1) AS video_hd_last,\n          SUM(video_hdp_last1) AS video_hdp_last,\n          SUM(host_sd_last1) AS host_video_sd_last,\n          SUM(audience_sd_last1) AS audience_video_sd_last,\n          SUM(host_hd_last1) AS host_video_hd_last,\n          SUM(audience_hd_last1) AS audience_video_hd_last,\n          SUM(host_hdp_last1) AS host_video_hdp_last,\n          SUM(audience_hdp_last1) AS audience_video_hdp_last,\n          SUM(host_audio_last1) AS host_audio_last,\n          SUM(audience_audio_last1) AS audience_audio_last,\n          SUM(host_video_last1) AS host_video_last,\n          SUM(audience_video_last1) AS audience_video_last,\n          SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n          SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n          SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n          SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n          SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n          SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n          SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n          SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n          SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n          SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n          SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n          SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n          SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n          SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n          SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n          SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n          SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n          SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n          SUM(audience_2k_last1) AS audience_2k_last1,\n          SUM(audience_4k_last1) AS audience_4k_last1,\n          SUM(audience_1080p_last1) AS audience_1080p_last1,\n          SUM(host_1080p_last1) AS host_1080p_last1,\n          SUM(host_2k_last1) AS host_2k_last1,\n          SUM(host_4k_last1) AS host_4k_last1,\n          SUM(total_last7) AS total_last7,\n          SUM(audio_last7) AS audio_last7,\n          SUM(video_last7) AS video_last7,\n          SUM(video_sd_last7) AS video_sd_last7,\n          SUM(video_hd_last7) AS video_hd_last7,\n          SUM(video_hdp_last7) AS video_hdp_last7,\n          SUM(host_sd_last7) AS host_sd_last7,\n          SUM(audience_sd_last7) AS audience_sd_last7,\n          SUM(host_hd_last7) AS host_hd_last7,\n          SUM(audience_hd_last7) AS audience_hd_last7,\n          SUM(host_hdp_last7) AS host_hdp_last7,\n          SUM(audience_hdp_last7) AS audience_hdp_last7,\n          SUM(host_audio_last7) AS host_audio_last7,\n          SUM(audience_audio_last7) AS audience_audio_last7,\n          SUM(host_video_last7) AS host_video_last7,\n          SUM(audience_video_last7) AS audience_video_last7,\n          SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n          SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n          SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n          SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n          SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n          SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n          SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n          SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n          SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n          SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n          SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n          SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n          SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n          SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n          SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n          SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n          SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n          SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n          SUM(audience_2k_last7) AS audience_2k_last7,\n          SUM(audience_4k_last7) AS audience_4k_last7,\n          SUM(audience_1080p_last7) AS audience_1080p_last7,\n          SUM(host_1080p_last7) AS host_1080p_last7,\n          SUM(host_2k_last7) AS host_2k_last7,\n          SUM(host_4k_last7) AS host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211128 AND date <= 20211212 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n        GROUP BY date,\n          DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n          2,\n          3,\n          tag,\n          area,\n          dim,\n          8,\n          9,\n          10,\n          level4,\n          product_level1,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en,\n          vid_use_case_en,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          browser,\n          browser_ver,\n          dim_grouping_name) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 3 AND CAST(\"自定义 SQL 查询\".\"level1\" AS VARCHAR) = 'RTSA' AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 1"
	},
	{
		"presto_sql" : "SELECT \"自定义 SQL 查询\".\"product_level3\" AS \"product_level3\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"usr_Calculation_3519281700079370244_ok\"\nFROM (SELECT date,\n      start_date AS start_date,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name,\n      SUM(total) AS totalUsage,\n      SUM(audio) AS audio,\n      SUM(video) AS video,\n      SUM(host_sd + audience_sd) AS video_sd,\n      SUM(host_hd + audience_hd) AS video_hd,\n      SUM(host_hdp + audience_hdp) AS video_hdp,\n      SUM(host_audio) AS host_audio,\n      SUM(audience_audio) AS audience_audio,\n      SUM(host_sd) AS host_sd,\n      SUM(host_hd) AS host_hd,\n      SUM(host_hdp) AS host_hdp,\n      SUM(host_1080p) AS host_1080p,\n      SUM(host_2k) AS host_2k,\n      SUM(host_4k) AS host_4k,\n      SUM(audience_sd) AS audience_sd,\n      SUM(audience_hd) AS audience_hd,\n      SUM(audience_hdp) AS audience_hdp,\n      SUM(audience_1080p) AS audience_1080p,\n      SUM(audience_2k) AS audience_2k,\n      SUM(audience_4k) AS audience_4k,\n      SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n      SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n      SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n      SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n      SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n      SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n      SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n      SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n      SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n      SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n      SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n      SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n      SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n      SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n      SUM(total_last1) AS audio_video_last,\n      SUM(audio_last1) AS audio_last,\n      SUM(video_last1) AS video_last,\n      SUM(video_sd_last1) AS video_sd_last,\n      SUM(video_hd_last1) AS video_hd_last,\n      SUM(video_hdp_last1) AS video_hdp_last,\n      SUM(host_sd_last1) AS host_video_sd_last,\n      SUM(audience_sd_last1) AS audience_video_sd_last,\n      SUM(host_hd_last1) AS host_video_hd_last,\n      SUM(audience_hd_last1) AS audience_video_hd_last,\n      SUM(host_hdp_last1) AS host_video_hdp_last,\n      SUM(audience_hdp_last1) AS audience_video_hdp_last,\n      SUM(host_audio_last1) AS host_audio_last,\n      SUM(audience_audio_last1) AS audience_audio_last,\n      SUM(host_video_last1) AS host_video_last,\n      SUM(audience_video_last1) AS audience_video_last,\n      SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n      SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n      SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n      SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n      SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n      SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n      SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n      SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n      SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n      SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n      SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n      SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n      SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n      SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n      SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n      SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n      SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n      SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n      SUM(audience_2k_last1) AS audience_2k_last1,\n      SUM(audience_4k_last1) AS audience_4k_last1,\n      SUM(audience_1080p_last1) AS audience_1080p_last1,\n      SUM(host_1080p_last1) AS host_1080p_last1,\n      SUM(host_2k_last1) AS host_2k_last1,\n      SUM(host_4k_last1) AS host_4k_last1,\n      SUM(total_last7) AS total_last7,\n      SUM(audio_last7) AS audio_last7,\n      SUM(video_last7) AS video_last7,\n      SUM(video_sd_last7) AS video_sd_last7,\n      SUM(video_hd_last7) AS video_hd_last7,\n      SUM(video_hdp_last7) AS video_hdp_last7,\n      SUM(host_sd_last7) AS host_sd_last7,\n      SUM(audience_sd_last7) AS audience_sd_last7,\n      SUM(host_hd_last7) AS host_hd_last7,\n      SUM(audience_hd_last7) AS audience_hd_last7,\n      SUM(host_hdp_last7) AS host_hdp_last7,\n      SUM(audience_hdp_last7) AS audience_hdp_last7,\n      SUM(host_audio_last7) AS host_audio_last7,\n      SUM(audience_audio_last7) AS audience_audio_last7,\n      SUM(host_video_last7) AS host_video_last7,\n      SUM(audience_video_last7) AS audience_video_last7,\n      SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n      SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n      SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n      SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n      SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n      SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n      SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n      SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n      SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n      SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n      SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n      SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n      SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n      SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n      SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n      SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n      SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n      SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n      SUM(audience_2k_last7) AS audience_2k_last7,\n      SUM(audience_4k_last7) AS audience_4k_last7,\n      SUM(audience_1080p_last7) AS audience_1080p_last7,\n      SUM(host_1080p_last7) AS host_1080p_last7,\n      SUM(host_2k_last7) AS host_2k_last7,\n      SUM(host_4k_last7) AS host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211128 AND date <= 20211212 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n    GROUP BY date,\n      DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n      2,\n      3,\n      tag,\n      area,\n      dim,\n      8,\n      9,\n      10,\n      level4,\n      product_level1,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en,\n      vid_use_case_en,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n          start_date AS start_date,\n          end_date AS end_date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          tag,\n          area AS Scope,\n          dim,\n            CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n            CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n            CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          browser,\n          browser_ver,\n          dim_grouping_name,\n          SUM(total) AS totalUsage,\n          SUM(audio) AS audio,\n          SUM(video) AS video,\n          SUM(host_sd + audience_sd) AS video_sd,\n          SUM(host_hd + audience_hd) AS video_hd,\n          SUM(host_hdp + audience_hdp) AS video_hdp,\n          SUM(host_audio) AS host_audio,\n          SUM(audience_audio) AS audience_audio,\n          SUM(host_sd) AS host_sd,\n          SUM(host_hd) AS host_hd,\n          SUM(host_hdp) AS host_hdp,\n          SUM(host_1080p) AS host_1080p,\n          SUM(host_2k) AS host_2k,\n          SUM(host_4k) AS host_4k,\n          SUM(audience_sd) AS audience_sd,\n          SUM(audience_hd) AS audience_hd,\n          SUM(audience_hdp) AS audience_hdp,\n          SUM(audience_1080p) AS audience_1080p,\n          SUM(audience_2k) AS audience_2k,\n          SUM(audience_4k) AS audience_4k,\n          SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n          SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n          SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n          SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n          SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n          SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n          SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n          SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n          SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n          SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n          SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n          SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n          SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n          SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n          SUM(total_last1) AS audio_video_last,\n          SUM(audio_last1) AS audio_last,\n          SUM(video_last1) AS video_last,\n          SUM(video_sd_last1) AS video_sd_last,\n          SUM(video_hd_last1) AS video_hd_last,\n          SUM(video_hdp_last1) AS video_hdp_last,\n          SUM(host_sd_last1) AS host_video_sd_last,\n          SUM(audience_sd_last1) AS audience_video_sd_last,\n          SUM(host_hd_last1) AS host_video_hd_last,\n          SUM(audience_hd_last1) AS audience_video_hd_last,\n          SUM(host_hdp_last1) AS host_video_hdp_last,\n          SUM(audience_hdp_last1) AS audience_video_hdp_last,\n          SUM(host_audio_last1) AS host_audio_last,\n          SUM(audience_audio_last1) AS audience_audio_last,\n          SUM(host_video_last1) AS host_video_last,\n          SUM(audience_video_last1) AS audience_video_last,\n          SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n          SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n          SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n          SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n          SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n          SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n          SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n          SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n          SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n          SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n          SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n          SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n          SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n          SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n          SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n          SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n          SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n          SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n          SUM(audience_2k_last1) AS audience_2k_last1,\n          SUM(audience_4k_last1) AS audience_4k_last1,\n          SUM(audience_1080p_last1) AS audience_1080p_last1,\n          SUM(host_1080p_last1) AS host_1080p_last1,\n          SUM(host_2k_last1) AS host_2k_last1,\n          SUM(host_4k_last1) AS host_4k_last1,\n          SUM(total_last7) AS total_last7,\n          SUM(audio_last7) AS audio_last7,\n          SUM(video_last7) AS video_last7,\n          SUM(video_sd_last7) AS video_sd_last7,\n          SUM(video_hd_last7) AS video_hd_last7,\n          SUM(video_hdp_last7) AS video_hdp_last7,\n          SUM(host_sd_last7) AS host_sd_last7,\n          SUM(audience_sd_last7) AS audience_sd_last7,\n          SUM(host_hd_last7) AS host_hd_last7,\n          SUM(audience_hd_last7) AS audience_hd_last7,\n          SUM(host_hdp_last7) AS host_hdp_last7,\n          SUM(audience_hdp_last7) AS audience_hdp_last7,\n          SUM(host_audio_last7) AS host_audio_last7,\n          SUM(audience_audio_last7) AS audience_audio_last7,\n          SUM(host_video_last7) AS host_video_last7,\n          SUM(audience_video_last7) AS audience_video_last7,\n          SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n          SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n          SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n          SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n          SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n          SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n          SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n          SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n          SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n          SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n          SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n          SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n          SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n          SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n          SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n          SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n          SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n          SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n          SUM(audience_2k_last7) AS audience_2k_last7,\n          SUM(audience_4k_last7) AS audience_4k_last7,\n          SUM(audience_1080p_last7) AS audience_1080p_last7,\n          SUM(host_1080p_last7) AS host_1080p_last7,\n          SUM(host_2k_last7) AS host_2k_last7,\n          SUM(host_4k_last7) AS host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211128 AND date <= 20211212 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n        GROUP BY date,\n          DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n          2,\n          3,\n          tag,\n          area,\n          dim,\n          8,\n          9,\n          10,\n          level4,\n          product_level1,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en,\n          vid_use_case_en,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          browser,\n          browser_ver,\n          dim_grouping_name) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 3 AND CAST(\"自定义 SQL 查询\".\"level1\" AS VARCHAR) = 'RTSA' AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 1"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"usr_Calculation_3519281700079370244_ok\",\n  \"自定义 SQL 查询\".\"vid_sector_en\" AS \"vid_sector_en\"\nFROM (SELECT date,\n      start_date AS start_date,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name,\n      SUM(total) AS totalUsage,\n      SUM(audio) AS audio,\n      SUM(video) AS video,\n      SUM(host_sd + audience_sd) AS video_sd,\n      SUM(host_hd + audience_hd) AS video_hd,\n      SUM(host_hdp + audience_hdp) AS video_hdp,\n      SUM(host_audio) AS host_audio,\n      SUM(audience_audio) AS audience_audio,\n      SUM(host_sd) AS host_sd,\n      SUM(host_hd) AS host_hd,\n      SUM(host_hdp) AS host_hdp,\n      SUM(host_1080p) AS host_1080p,\n      SUM(host_2k) AS host_2k,\n      SUM(host_4k) AS host_4k,\n      SUM(audience_sd) AS audience_sd,\n      SUM(audience_hd) AS audience_hd,\n      SUM(audience_hdp) AS audience_hdp,\n      SUM(audience_1080p) AS audience_1080p,\n      SUM(audience_2k) AS audience_2k,\n      SUM(audience_4k) AS audience_4k,\n      SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n      SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n      SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n      SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n      SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n      SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n      SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n      SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n      SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n      SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n      SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n      SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n      SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n      SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n      SUM(total_last1) AS audio_video_last,\n      SUM(audio_last1) AS audio_last,\n      SUM(video_last1) AS video_last,\n      SUM(video_sd_last1) AS video_sd_last,\n      SUM(video_hd_last1) AS video_hd_last,\n      SUM(video_hdp_last1) AS video_hdp_last,\n      SUM(host_sd_last1) AS host_video_sd_last,\n      SUM(audience_sd_last1) AS audience_video_sd_last,\n      SUM(host_hd_last1) AS host_video_hd_last,\n      SUM(audience_hd_last1) AS audience_video_hd_last,\n      SUM(host_hdp_last1) AS host_video_hdp_last,\n      SUM(audience_hdp_last1) AS audience_video_hdp_last,\n      SUM(host_audio_last1) AS host_audio_last,\n      SUM(audience_audio_last1) AS audience_audio_last,\n      SUM(host_video_last1) AS host_video_last,\n      SUM(audience_video_last1) AS audience_video_last,\n      SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n      SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n      SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n      SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n      SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n      SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n      SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n      SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n      SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n      SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n      SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n      SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n      SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n      SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n      SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n      SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n      SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n      SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n      SUM(audience_2k_last1) AS audience_2k_last1,\n      SUM(audience_4k_last1) AS audience_4k_last1,\n      SUM(audience_1080p_last1) AS audience_1080p_last1,\n      SUM(host_1080p_last1) AS host_1080p_last1,\n      SUM(host_2k_last1) AS host_2k_last1,\n      SUM(host_4k_last1) AS host_4k_last1,\n      SUM(total_last7) AS total_last7,\n      SUM(audio_last7) AS audio_last7,\n      SUM(video_last7) AS video_last7,\n      SUM(video_sd_last7) AS video_sd_last7,\n      SUM(video_hd_last7) AS video_hd_last7,\n      SUM(video_hdp_last7) AS video_hdp_last7,\n      SUM(host_sd_last7) AS host_sd_last7,\n      SUM(audience_sd_last7) AS audience_sd_last7,\n      SUM(host_hd_last7) AS host_hd_last7,\n      SUM(audience_hd_last7) AS audience_hd_last7,\n      SUM(host_hdp_last7) AS host_hdp_last7,\n      SUM(audience_hdp_last7) AS audience_hdp_last7,\n      SUM(host_audio_last7) AS host_audio_last7,\n      SUM(audience_audio_last7) AS audience_audio_last7,\n      SUM(host_video_last7) AS host_video_last7,\n      SUM(audience_video_last7) AS audience_video_last7,\n      SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n      SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n      SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n      SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n      SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n      SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n      SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n      SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n      SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n      SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n      SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n      SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n      SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n      SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n      SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n      SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n      SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n      SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n      SUM(audience_2k_last7) AS audience_2k_last7,\n      SUM(audience_4k_last7) AS audience_4k_last7,\n      SUM(audience_1080p_last7) AS audience_1080p_last7,\n      SUM(host_1080p_last7) AS host_1080p_last7,\n      SUM(host_2k_last7) AS host_2k_last7,\n      SUM(host_4k_last7) AS host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211128 AND date <= 20211212 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n    GROUP BY date,\n      DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n      2,\n      3,\n      tag,\n      area,\n      dim,\n      8,\n      9,\n      10,\n      level4,\n      product_level1,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en,\n      vid_use_case_en,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n          start_date AS start_date,\n          end_date AS end_date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          tag,\n          area AS Scope,\n          dim,\n            CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n            CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n            CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          browser,\n          browser_ver,\n          dim_grouping_name,\n          SUM(total) AS totalUsage,\n          SUM(audio) AS audio,\n          SUM(video) AS video,\n          SUM(host_sd + audience_sd) AS video_sd,\n          SUM(host_hd + audience_hd) AS video_hd,\n          SUM(host_hdp + audience_hdp) AS video_hdp,\n          SUM(host_audio) AS host_audio,\n          SUM(audience_audio) AS audience_audio,\n          SUM(host_sd) AS host_sd,\n          SUM(host_hd) AS host_hd,\n          SUM(host_hdp) AS host_hdp,\n          SUM(host_1080p) AS host_1080p,\n          SUM(host_2k) AS host_2k,\n          SUM(host_4k) AS host_4k,\n          SUM(audience_sd) AS audience_sd,\n          SUM(audience_hd) AS audience_hd,\n          SUM(audience_hdp) AS audience_hdp,\n          SUM(audience_1080p) AS audience_1080p,\n          SUM(audience_2k) AS audience_2k,\n          SUM(audience_4k) AS audience_4k,\n          SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n          SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n          SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n          SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n          SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n          SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n          SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n          SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n          SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n          SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n          SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n          SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n          SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n          SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n          SUM(total_last1) AS audio_video_last,\n          SUM(audio_last1) AS audio_last,\n          SUM(video_last1) AS video_last,\n          SUM(video_sd_last1) AS video_sd_last,\n          SUM(video_hd_last1) AS video_hd_last,\n          SUM(video_hdp_last1) AS video_hdp_last,\n          SUM(host_sd_last1) AS host_video_sd_last,\n          SUM(audience_sd_last1) AS audience_video_sd_last,\n          SUM(host_hd_last1) AS host_video_hd_last,\n          SUM(audience_hd_last1) AS audience_video_hd_last,\n          SUM(host_hdp_last1) AS host_video_hdp_last,\n          SUM(audience_hdp_last1) AS audience_video_hdp_last,\n          SUM(host_audio_last1) AS host_audio_last,\n          SUM(audience_audio_last1) AS audience_audio_last,\n          SUM(host_video_last1) AS host_video_last,\n          SUM(audience_video_last1) AS audience_video_last,\n          SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n          SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n          SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n          SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n          SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n          SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n          SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n          SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n          SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n          SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n          SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n          SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n          SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n          SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n          SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n          SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n          SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n          SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n          SUM(audience_2k_last1) AS audience_2k_last1,\n          SUM(audience_4k_last1) AS audience_4k_last1,\n          SUM(audience_1080p_last1) AS audience_1080p_last1,\n          SUM(host_1080p_last1) AS host_1080p_last1,\n          SUM(host_2k_last1) AS host_2k_last1,\n          SUM(host_4k_last1) AS host_4k_last1,\n          SUM(total_last7) AS total_last7,\n          SUM(audio_last7) AS audio_last7,\n          SUM(video_last7) AS video_last7,\n          SUM(video_sd_last7) AS video_sd_last7,\n          SUM(video_hd_last7) AS video_hd_last7,\n          SUM(video_hdp_last7) AS video_hdp_last7,\n          SUM(host_sd_last7) AS host_sd_last7,\n          SUM(audience_sd_last7) AS audience_sd_last7,\n          SUM(host_hd_last7) AS host_hd_last7,\n          SUM(audience_hd_last7) AS audience_hd_last7,\n          SUM(host_hdp_last7) AS host_hdp_last7,\n          SUM(audience_hdp_last7) AS audience_hdp_last7,\n          SUM(host_audio_last7) AS host_audio_last7,\n          SUM(audience_audio_last7) AS audience_audio_last7,\n          SUM(host_video_last7) AS host_video_last7,\n          SUM(audience_video_last7) AS audience_video_last7,\n          SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n          SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n          SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n          SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n          SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n          SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n          SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n          SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n          SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n          SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n          SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n          SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n          SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n          SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n          SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n          SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n          SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n          SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n          SUM(audience_2k_last7) AS audience_2k_last7,\n          SUM(audience_4k_last7) AS audience_4k_last7,\n          SUM(audience_1080p_last7) AS audience_1080p_last7,\n          SUM(host_1080p_last7) AS host_1080p_last7,\n          SUM(host_2k_last7) AS host_2k_last7,\n          SUM(host_4k_last7) AS host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211128 AND date <= 20211212 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n        GROUP BY date,\n          DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n          2,\n          3,\n          tag,\n          area,\n          dim,\n          8,\n          9,\n          10,\n          level4,\n          product_level1,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en,\n          vid_use_case_en,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          browser,\n          browser_ver,\n          dim_grouping_name) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 3 AND CAST(\"自定义 SQL 查询\".\"level1\" AS VARCHAR) = 'RTSA' AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 2"
	},
	{
		"presto_sql" : "SELECT \"自定义 SQL 查询\".\"product_level2\" AS \"product_level2\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"usr_Calculation_3519281700079370244_ok\"\nFROM (SELECT date,\n      start_date AS start_date,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name,\n      SUM(total) AS totalUsage,\n      SUM(audio) AS audio,\n      SUM(video) AS video,\n      SUM(host_sd + audience_sd) AS video_sd,\n      SUM(host_hd + audience_hd) AS video_hd,\n      SUM(host_hdp + audience_hdp) AS video_hdp,\n      SUM(host_audio) AS host_audio,\n      SUM(audience_audio) AS audience_audio,\n      SUM(host_sd) AS host_sd,\n      SUM(host_hd) AS host_hd,\n      SUM(host_hdp) AS host_hdp,\n      SUM(host_1080p) AS host_1080p,\n      SUM(host_2k) AS host_2k,\n      SUM(host_4k) AS host_4k,\n      SUM(audience_sd) AS audience_sd,\n      SUM(audience_hd) AS audience_hd,\n      SUM(audience_hdp) AS audience_hdp,\n      SUM(audience_1080p) AS audience_1080p,\n      SUM(audience_2k) AS audience_2k,\n      SUM(audience_4k) AS audience_4k,\n      SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n      SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n      SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n      SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n      SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n      SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n      SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n      SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n      SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n      SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n      SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n      SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n      SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n      SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n      SUM(total_last1) AS audio_video_last,\n      SUM(audio_last1) AS audio_last,\n      SUM(video_last1) AS video_last,\n      SUM(video_sd_last1) AS video_sd_last,\n      SUM(video_hd_last1) AS video_hd_last,\n      SUM(video_hdp_last1) AS video_hdp_last,\n      SUM(host_sd_last1) AS host_video_sd_last,\n      SUM(audience_sd_last1) AS audience_video_sd_last,\n      SUM(host_hd_last1) AS host_video_hd_last,\n      SUM(audience_hd_last1) AS audience_video_hd_last,\n      SUM(host_hdp_last1) AS host_video_hdp_last,\n      SUM(audience_hdp_last1) AS audience_video_hdp_last,\n      SUM(host_audio_last1) AS host_audio_last,\n      SUM(audience_audio_last1) AS audience_audio_last,\n      SUM(host_video_last1) AS host_video_last,\n      SUM(audience_video_last1) AS audience_video_last,\n      SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n      SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n      SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n      SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n      SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n      SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n      SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n      SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n      SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n      SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n      SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n      SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n      SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n      SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n      SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n      SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n      SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n      SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n      SUM(audience_2k_last1) AS audience_2k_last1,\n      SUM(audience_4k_last1) AS audience_4k_last1,\n      SUM(audience_1080p_last1) AS audience_1080p_last1,\n      SUM(host_1080p_last1) AS host_1080p_last1,\n      SUM(host_2k_last1) AS host_2k_last1,\n      SUM(host_4k_last1) AS host_4k_last1,\n      SUM(total_last7) AS total_last7,\n      SUM(audio_last7) AS audio_last7,\n      SUM(video_last7) AS video_last7,\n      SUM(video_sd_last7) AS video_sd_last7,\n      SUM(video_hd_last7) AS video_hd_last7,\n      SUM(video_hdp_last7) AS video_hdp_last7,\n      SUM(host_sd_last7) AS host_sd_last7,\n      SUM(audience_sd_last7) AS audience_sd_last7,\n      SUM(host_hd_last7) AS host_hd_last7,\n      SUM(audience_hd_last7) AS audience_hd_last7,\n      SUM(host_hdp_last7) AS host_hdp_last7,\n      SUM(audience_hdp_last7) AS audience_hdp_last7,\n      SUM(host_audio_last7) AS host_audio_last7,\n      SUM(audience_audio_last7) AS audience_audio_last7,\n      SUM(host_video_last7) AS host_video_last7,\n      SUM(audience_video_last7) AS audience_video_last7,\n      SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n      SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n      SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n      SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n      SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n      SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n      SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n      SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n      SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n      SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n      SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n      SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n      SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n      SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n      SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n      SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n      SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n      SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n      SUM(audience_2k_last7) AS audience_2k_last7,\n      SUM(audience_4k_last7) AS audience_4k_last7,\n      SUM(audience_1080p_last7) AS audience_1080p_last7,\n      SUM(host_1080p_last7) AS host_1080p_last7,\n      SUM(host_2k_last7) AS host_2k_last7,\n      SUM(host_4k_last7) AS host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211128 AND date <= 20211212 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n    GROUP BY date,\n      DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n      2,\n      3,\n      tag,\n      area,\n      dim,\n      8,\n      9,\n      10,\n      level4,\n      product_level1,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en,\n      vid_use_case_en,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n          start_date AS start_date,\n          end_date AS end_date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          tag,\n          area AS Scope,\n          dim,\n            CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n            CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n            CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          browser,\n          browser_ver,\n          dim_grouping_name,\n          SUM(total) AS totalUsage,\n          SUM(audio) AS audio,\n          SUM(video) AS video,\n          SUM(host_sd + audience_sd) AS video_sd,\n          SUM(host_hd + audience_hd) AS video_hd,\n          SUM(host_hdp + audience_hdp) AS video_hdp,\n          SUM(host_audio) AS host_audio,\n          SUM(audience_audio) AS audience_audio,\n          SUM(host_sd) AS host_sd,\n          SUM(host_hd) AS host_hd,\n          SUM(host_hdp) AS host_hdp,\n          SUM(host_1080p) AS host_1080p,\n          SUM(host_2k) AS host_2k,\n          SUM(host_4k) AS host_4k,\n          SUM(audience_sd) AS audience_sd,\n          SUM(audience_hd) AS audience_hd,\n          SUM(audience_hdp) AS audience_hdp,\n          SUM(audience_1080p) AS audience_1080p,\n          SUM(audience_2k) AS audience_2k,\n          SUM(audience_4k) AS audience_4k,\n          SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n          SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n          SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n          SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n          SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n          SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n          SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n          SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n          SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n          SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n          SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n          SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n          SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n          SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n          SUM(total_last1) AS audio_video_last,\n          SUM(audio_last1) AS audio_last,\n          SUM(video_last1) AS video_last,\n          SUM(video_sd_last1) AS video_sd_last,\n          SUM(video_hd_last1) AS video_hd_last,\n          SUM(video_hdp_last1) AS video_hdp_last,\n          SUM(host_sd_last1) AS host_video_sd_last,\n          SUM(audience_sd_last1) AS audience_video_sd_last,\n          SUM(host_hd_last1) AS host_video_hd_last,\n          SUM(audience_hd_last1) AS audience_video_hd_last,\n          SUM(host_hdp_last1) AS host_video_hdp_last,\n          SUM(audience_hdp_last1) AS audience_video_hdp_last,\n          SUM(host_audio_last1) AS host_audio_last,\n          SUM(audience_audio_last1) AS audience_audio_last,\n          SUM(host_video_last1) AS host_video_last,\n          SUM(audience_video_last1) AS audience_video_last,\n          SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n          SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n          SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n          SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n          SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n          SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n          SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n          SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n          SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n          SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n          SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n          SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n          SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n          SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n          SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n          SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n          SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n          SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n          SUM(audience_2k_last1) AS audience_2k_last1,\n          SUM(audience_4k_last1) AS audience_4k_last1,\n          SUM(audience_1080p_last1) AS audience_1080p_last1,\n          SUM(host_1080p_last1) AS host_1080p_last1,\n          SUM(host_2k_last1) AS host_2k_last1,\n          SUM(host_4k_last1) AS host_4k_last1,\n          SUM(total_last7) AS total_last7,\n          SUM(audio_last7) AS audio_last7,\n          SUM(video_last7) AS video_last7,\n          SUM(video_sd_last7) AS video_sd_last7,\n          SUM(video_hd_last7) AS video_hd_last7,\n          SUM(video_hdp_last7) AS video_hdp_last7,\n          SUM(host_sd_last7) AS host_sd_last7,\n          SUM(audience_sd_last7) AS audience_sd_last7,\n          SUM(host_hd_last7) AS host_hd_last7,\n          SUM(audience_hd_last7) AS audience_hd_last7,\n          SUM(host_hdp_last7) AS host_hdp_last7,\n          SUM(audience_hdp_last7) AS audience_hdp_last7,\n          SUM(host_audio_last7) AS host_audio_last7,\n          SUM(audience_audio_last7) AS audience_audio_last7,\n          SUM(host_video_last7) AS host_video_last7,\n          SUM(audience_video_last7) AS audience_video_last7,\n          SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n          SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n          SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n          SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n          SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n          SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n          SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n          SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n          SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n          SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n          SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n          SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n          SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n          SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n          SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n          SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n          SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n          SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n          SUM(audience_2k_last7) AS audience_2k_last7,\n          SUM(audience_4k_last7) AS audience_4k_last7,\n          SUM(audience_1080p_last7) AS audience_1080p_last7,\n          SUM(host_1080p_last7) AS host_1080p_last7,\n          SUM(host_2k_last7) AS host_2k_last7,\n          SUM(host_4k_last7) AS host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211128 AND date <= 20211212 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n        GROUP BY date,\n          DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n          2,\n          3,\n          tag,\n          area,\n          dim,\n          8,\n          9,\n          10,\n          level4,\n          product_level1,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en,\n          vid_use_case_en,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          browser,\n          browser_ver,\n          dim_grouping_name) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 3 AND CAST(\"自定义 SQL 查询\".\"level1\" AS VARCHAR) = 'RTSA' AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 1"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"usr_Calculation_3519281700079370244_ok\",\n  \"自定义 SQL 查询\".\"vid_use_case_cn\" AS \"vid_use_case_cn\"\nFROM (SELECT date,\n      start_date AS start_date,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name,\n      SUM(total) AS totalUsage,\n      SUM(audio) AS audio,\n      SUM(video) AS video,\n      SUM(host_sd + audience_sd) AS video_sd,\n      SUM(host_hd + audience_hd) AS video_hd,\n      SUM(host_hdp + audience_hdp) AS video_hdp,\n      SUM(host_audio) AS host_audio,\n      SUM(audience_audio) AS audience_audio,\n      SUM(host_sd) AS host_sd,\n      SUM(host_hd) AS host_hd,\n      SUM(host_hdp) AS host_hdp,\n      SUM(host_1080p) AS host_1080p,\n      SUM(host_2k) AS host_2k,\n      SUM(host_4k) AS host_4k,\n      SUM(audience_sd) AS audience_sd,\n      SUM(audience_hd) AS audience_hd,\n      SUM(audience_hdp) AS audience_hdp,\n      SUM(audience_1080p) AS audience_1080p,\n      SUM(audience_2k) AS audience_2k,\n      SUM(audience_4k) AS audience_4k,\n      SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n      SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n      SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n      SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n      SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n      SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n      SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n      SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n      SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n      SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n      SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n      SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n      SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n      SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n      SUM(total_last1) AS audio_video_last,\n      SUM(audio_last1) AS audio_last,\n      SUM(video_last1) AS video_last,\n      SUM(video_sd_last1) AS video_sd_last,\n      SUM(video_hd_last1) AS video_hd_last,\n      SUM(video_hdp_last1) AS video_hdp_last,\n      SUM(host_sd_last1) AS host_video_sd_last,\n      SUM(audience_sd_last1) AS audience_video_sd_last,\n      SUM(host_hd_last1) AS host_video_hd_last,\n      SUM(audience_hd_last1) AS audience_video_hd_last,\n      SUM(host_hdp_last1) AS host_video_hdp_last,\n      SUM(audience_hdp_last1) AS audience_video_hdp_last,\n      SUM(host_audio_last1) AS host_audio_last,\n      SUM(audience_audio_last1) AS audience_audio_last,\n      SUM(host_video_last1) AS host_video_last,\n      SUM(audience_video_last1) AS audience_video_last,\n      SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n      SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n      SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n      SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n      SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n      SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n      SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n      SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n      SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n      SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n      SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n      SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n      SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n      SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n      SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n      SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n      SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n      SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n      SUM(audience_2k_last1) AS audience_2k_last1,\n      SUM(audience_4k_last1) AS audience_4k_last1,\n      SUM(audience_1080p_last1) AS audience_1080p_last1,\n      SUM(host_1080p_last1) AS host_1080p_last1,\n      SUM(host_2k_last1) AS host_2k_last1,\n      SUM(host_4k_last1) AS host_4k_last1,\n      SUM(total_last7) AS total_last7,\n      SUM(audio_last7) AS audio_last7,\n      SUM(video_last7) AS video_last7,\n      SUM(video_sd_last7) AS video_sd_last7,\n      SUM(video_hd_last7) AS video_hd_last7,\n      SUM(video_hdp_last7) AS video_hdp_last7,\n      SUM(host_sd_last7) AS host_sd_last7,\n      SUM(audience_sd_last7) AS audience_sd_last7,\n      SUM(host_hd_last7) AS host_hd_last7,\n      SUM(audience_hd_last7) AS audience_hd_last7,\n      SUM(host_hdp_last7) AS host_hdp_last7,\n      SUM(audience_hdp_last7) AS audience_hdp_last7,\n      SUM(host_audio_last7) AS host_audio_last7,\n      SUM(audience_audio_last7) AS audience_audio_last7,\n      SUM(host_video_last7) AS host_video_last7,\n      SUM(audience_video_last7) AS audience_video_last7,\n      SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n      SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n      SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n      SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n      SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n      SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n      SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n      SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n      SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n      SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n      SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n      SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n      SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n      SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n      SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n      SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n      SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n      SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n      SUM(audience_2k_last7) AS audience_2k_last7,\n      SUM(audience_4k_last7) AS audience_4k_last7,\n      SUM(audience_1080p_last7) AS audience_1080p_last7,\n      SUM(host_1080p_last7) AS host_1080p_last7,\n      SUM(host_2k_last7) AS host_2k_last7,\n      SUM(host_4k_last7) AS host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211128 AND date <= 20211212 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n    GROUP BY date,\n      DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n      2,\n      3,\n      tag,\n      area,\n      dim,\n      8,\n      9,\n      10,\n      level4,\n      product_level1,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en,\n      vid_use_case_en,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n          start_date AS start_date,\n          end_date AS end_date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          tag,\n          area AS Scope,\n          dim,\n            CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n            CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n            CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          browser,\n          browser_ver,\n          dim_grouping_name,\n          SUM(total) AS totalUsage,\n          SUM(audio) AS audio,\n          SUM(video) AS video,\n          SUM(host_sd + audience_sd) AS video_sd,\n          SUM(host_hd + audience_hd) AS video_hd,\n          SUM(host_hdp + audience_hdp) AS video_hdp,\n          SUM(host_audio) AS host_audio,\n          SUM(audience_audio) AS audience_audio,\n          SUM(host_sd) AS host_sd,\n          SUM(host_hd) AS host_hd,\n          SUM(host_hdp) AS host_hdp,\n          SUM(host_1080p) AS host_1080p,\n          SUM(host_2k) AS host_2k,\n          SUM(host_4k) AS host_4k,\n          SUM(audience_sd) AS audience_sd,\n          SUM(audience_hd) AS audience_hd,\n          SUM(audience_hdp) AS audience_hdp,\n          SUM(audience_1080p) AS audience_1080p,\n          SUM(audience_2k) AS audience_2k,\n          SUM(audience_4k) AS audience_4k,\n          SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n          SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n          SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n          SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n          SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n          SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n          SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n          SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n          SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n          SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n          SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n          SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n          SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n          SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n          SUM(total_last1) AS audio_video_last,\n          SUM(audio_last1) AS audio_last,\n          SUM(video_last1) AS video_last,\n          SUM(video_sd_last1) AS video_sd_last,\n          SUM(video_hd_last1) AS video_hd_last,\n          SUM(video_hdp_last1) AS video_hdp_last,\n          SUM(host_sd_last1) AS host_video_sd_last,\n          SUM(audience_sd_last1) AS audience_video_sd_last,\n          SUM(host_hd_last1) AS host_video_hd_last,\n          SUM(audience_hd_last1) AS audience_video_hd_last,\n          SUM(host_hdp_last1) AS host_video_hdp_last,\n          SUM(audience_hdp_last1) AS audience_video_hdp_last,\n          SUM(host_audio_last1) AS host_audio_last,\n          SUM(audience_audio_last1) AS audience_audio_last,\n          SUM(host_video_last1) AS host_video_last,\n          SUM(audience_video_last1) AS audience_video_last,\n          SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n          SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n          SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n          SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n          SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n          SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n          SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n          SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n          SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n          SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n          SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n          SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n          SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n          SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n          SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n          SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n          SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n          SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n          SUM(audience_2k_last1) AS audience_2k_last1,\n          SUM(audience_4k_last1) AS audience_4k_last1,\n          SUM(audience_1080p_last1) AS audience_1080p_last1,\n          SUM(host_1080p_last1) AS host_1080p_last1,\n          SUM(host_2k_last1) AS host_2k_last1,\n          SUM(host_4k_last1) AS host_4k_last1,\n          SUM(total_last7) AS total_last7,\n          SUM(audio_last7) AS audio_last7,\n          SUM(video_last7) AS video_last7,\n          SUM(video_sd_last7) AS video_sd_last7,\n          SUM(video_hd_last7) AS video_hd_last7,\n          SUM(video_hdp_last7) AS video_hdp_last7,\n          SUM(host_sd_last7) AS host_sd_last7,\n          SUM(audience_sd_last7) AS audience_sd_last7,\n          SUM(host_hd_last7) AS host_hd_last7,\n          SUM(audience_hd_last7) AS audience_hd_last7,\n          SUM(host_hdp_last7) AS host_hdp_last7,\n          SUM(audience_hdp_last7) AS audience_hdp_last7,\n          SUM(host_audio_last7) AS host_audio_last7,\n          SUM(audience_audio_last7) AS audience_audio_last7,\n          SUM(host_video_last7) AS host_video_last7,\n          SUM(audience_video_last7) AS audience_video_last7,\n          SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n          SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n          SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n          SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n          SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n          SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n          SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n          SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n          SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n          SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n          SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n          SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n          SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n          SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n          SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n          SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n          SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n          SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n          SUM(audience_2k_last7) AS audience_2k_last7,\n          SUM(audience_4k_last7) AS audience_4k_last7,\n          SUM(audience_1080p_last7) AS audience_1080p_last7,\n          SUM(host_1080p_last7) AS host_1080p_last7,\n          SUM(host_2k_last7) AS host_2k_last7,\n          SUM(host_4k_last7) AS host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211128 AND date <= 20211212 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n        GROUP BY date,\n          DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n          2,\n          3,\n          tag,\n          area,\n          dim,\n          8,\n          9,\n          10,\n          level4,\n          product_level1,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en,\n          vid_use_case_en,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          browser,\n          browser_ver,\n          dim_grouping_name) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 3 AND CAST(\"自定义 SQL 查询\".\"level1\" AS VARCHAR) = 'RTSA' AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 2"
	},
	{
		"presto_sql" : "SELECT \"自定义 SQL 查询\".\"cid_industry\" AS \"cid_industry\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"usr_Calculation_3519281700079370244_ok\"\nFROM (SELECT date,\n      start_date AS start_date,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name,\n      SUM(total) AS totalUsage,\n      SUM(audio) AS audio,\n      SUM(video) AS video,\n      SUM(host_sd + audience_sd) AS video_sd,\n      SUM(host_hd + audience_hd) AS video_hd,\n      SUM(host_hdp + audience_hdp) AS video_hdp,\n      SUM(host_audio) AS host_audio,\n      SUM(audience_audio) AS audience_audio,\n      SUM(host_sd) AS host_sd,\n      SUM(host_hd) AS host_hd,\n      SUM(host_hdp) AS host_hdp,\n      SUM(host_1080p) AS host_1080p,\n      SUM(host_2k) AS host_2k,\n      SUM(host_4k) AS host_4k,\n      SUM(audience_sd) AS audience_sd,\n      SUM(audience_hd) AS audience_hd,\n      SUM(audience_hdp) AS audience_hdp,\n      SUM(audience_1080p) AS audience_1080p,\n      SUM(audience_2k) AS audience_2k,\n      SUM(audience_4k) AS audience_4k,\n      SUM(audience_audio_low_latency) AS audience_audio_low_latency,\n      SUM(audience_sd_low_latency) AS audience_sd_low_latency,\n      SUM(audience_hd_low_latency) AS audience_hd_low_latency,\n      SUM(audience_hdp_low_latency) AS audience_hdp_low_latency,\n      SUM(audience_1080p_low_latency) AS audience_1080p_low_latency,\n      SUM(audience_2k_low_latency) AS audience_2k_low_latency,\n      SUM(audience_4k_low_latency) AS audience_4k_low_latency,\n      SUM(audience_audio_ultra_low_latency) AS audience_audio_ultra_low_latency,\n      SUM(audience_sd_ultra_low_latency) AS audience_sd_ultra_low_latency,\n      SUM(audience_hd_ultra_low_latency) AS audience_hd_ultra_low_latency,\n      SUM(audience_hdp_ultra_low_latency) AS audience_hdp_ultra_low_latency,\n      SUM(audience_1080p_ultra_low_latency) AS audience_1080p_ultra_low_latency,\n      SUM(audience_2k_ultra_low_latency) AS audience_2k_ultra_low_latency,\n      SUM(audience_4k_ultra_low_latency) AS audience_4k_ultra_low_latency,\n      SUM(total_last1) AS audio_video_last,\n      SUM(audio_last1) AS audio_last,\n      SUM(video_last1) AS video_last,\n      SUM(video_sd_last1) AS video_sd_last,\n      SUM(video_hd_last1) AS video_hd_last,\n      SUM(video_hdp_last1) AS video_hdp_last,\n      SUM(host_sd_last1) AS host_video_sd_last,\n      SUM(audience_sd_last1) AS audience_video_sd_last,\n      SUM(host_hd_last1) AS host_video_hd_last,\n      SUM(audience_hd_last1) AS audience_video_hd_last,\n      SUM(host_hdp_last1) AS host_video_hdp_last,\n      SUM(audience_hdp_last1) AS audience_video_hdp_last,\n      SUM(host_audio_last1) AS host_audio_last,\n      SUM(audience_audio_last1) AS audience_audio_last,\n      SUM(host_video_last1) AS host_video_last,\n      SUM(audience_video_last1) AS audience_video_last,\n      SUM(audience_audio_low_latency_last1) AS audience_audio_low_latency_last,\n      SUM(audience_video_low_latency_last1) AS audience_video_low_latency_last,\n      SUM(audience_total_low_latency_last1) AS audience_total_low_latency_last,\n      SUM(audience_sd_low_latency_last1) AS audience_sd_low_latency_last,\n      SUM(audience_hd_low_latency_last1) AS audience_hd_low_latency_last,\n      SUM(audience_hdp_low_latency_last1) AS audience_hdp_low_latency_last,\n      SUM(audience_1080p_low_latency_last1) AS audience_1080p_low_latency_last,\n      SUM(audience_2k_low_latency_last1) AS audience_2k_low_latency_last,\n      SUM(audience_4k_low_latency_last1) AS audience_4k_low_latency_last,\n      SUM(audience_audio_ultra_low_latency_last1) AS audience_audio_ultra_low_latency_last,\n      SUM(audience_video_ultra_low_latency_last1) AS audience_video_ultra_low_latency_last,\n      SUM(audience_total_ultra_low_latency_last1) AS audience_total_ultra_low_latency_last,\n      SUM(audience_sd_ultra_low_latency_last1) AS audience_sd_ultra_low_latency_last,\n      SUM(audience_hd_ultra_low_latency_last1) AS audience_hd_ultra_low_latency_last,\n      SUM(audience_hdp_ultra_low_latency_last1) AS audience_hdp_ultra_low_latency_last,\n      SUM(audience_1080p_ultra_low_latency_last1) AS audience_1080p_ultra_low_latency_last,\n      SUM(audience_2k_ultra_low_latency_last1) AS audience_2k_ultra_low_latency_last,\n      SUM(audience_4k_ultra_low_latency_last1) AS audience_4k_ultra_low_latency_last,\n      SUM(audience_2k_last1) AS audience_2k_last1,\n      SUM(audience_4k_last1) AS audience_4k_last1,\n      SUM(audience_1080p_last1) AS audience_1080p_last1,\n      SUM(host_1080p_last1) AS host_1080p_last1,\n      SUM(host_2k_last1) AS host_2k_last1,\n      SUM(host_4k_last1) AS host_4k_last1,\n      SUM(total_last7) AS total_last7,\n      SUM(audio_last7) AS audio_last7,\n      SUM(video_last7) AS video_last7,\n      SUM(video_sd_last7) AS video_sd_last7,\n      SUM(video_hd_last7) AS video_hd_last7,\n      SUM(video_hdp_last7) AS video_hdp_last7,\n      SUM(host_sd_last7) AS host_sd_last7,\n      SUM(audience_sd_last7) AS audience_sd_last7,\n      SUM(host_hd_last7) AS host_hd_last7,\n      SUM(audience_hd_last7) AS audience_hd_last7,\n      SUM(host_hdp_last7) AS host_hdp_last7,\n      SUM(audience_hdp_last7) AS audience_hdp_last7,\n      SUM(host_audio_last7) AS host_audio_last7,\n      SUM(audience_audio_last7) AS audience_audio_last7,\n      SUM(host_video_last7) AS host_video_last7,\n      SUM(audience_video_last7) AS audience_video_last7,\n      SUM(audience_audio_low_latency_last7) AS audience_audio_low_latency_last7,\n      SUM(audience_video_low_latency_last7) AS audience_video_low_latency_last7,\n      SUM(audience_total_low_latency_last7) AS audience_total_low_latency_last7,\n      SUM(audience_sd_low_latency_last7) AS audience_sd_low_latency_last7,\n      SUM(audience_hd_low_latency_last7) AS audience_hd_low_latency_last7,\n      SUM(audience_hdp_low_latency_last7) AS audience_hdp_low_latency_last7,\n      SUM(audience_1080p_low_latency_last7) AS audience_1080p_low_latency_last7,\n      SUM(audience_2k_low_latency_last7) AS audience_2k_low_latency_last7,\n      SUM(audience_4k_low_latency_last7) AS audience_4k_low_latency_last7,\n      SUM(audience_audio_ultra_low_latency_last7) AS audience_audio_ultra_low_latency_last7,\n      SUM(audience_video_ultra_low_latency_last7) AS audience_video_ultra_low_latency_last7,\n      SUM(audience_total_ultra_low_latency_last7) AS audience_total_ultra_low_latency_last7,\n      SUM(audience_sd_ultra_low_latency_last7) AS audience_sd_ultra_low_latency_last7,\n      SUM(audience_hd_ultra_low_latency_last7) AS audience_hd_ultra_low_latency_last7,\n      SUM(audience_hdp_ultra_low_latency_last7) AS audience_hdp_ultra_low_latency_last7,\n      SUM(audience_1080p_ultra_low_latency_last7) AS audience_1080p_ultra_low_latency_last7,\n      SUM(audience_2k_ultra_low_latency_last7) AS audience_2k_ultra_low_latency_last7,\n      SUM(audience_4k_ultra_low_latency_last7) AS audience_4k_ultra_low_latency_last7,\n      SUM(audience_2k_last7) AS audience_2k_last7,\n      SUM(audience_4k_last7) AS audience_4k_last7,\n      SUM(audience_1080p_last7) AS audience_1080p_last7,\n      SUM(host_1080p_last7) AS host_1080p_last7,\n      SUM(host_2k_last7) AS host_2k_last7,\n      SUM(host_4k_last7) AS host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211128 AND date <= 20211212 AND dim IN (1, 2, 3, 5) AND area IS NOT NULL\n    GROUP BY date,\n      DATE_FORMAT(date_parse(cast( date as VARCHAR), '%Y%m%d'), '%Y-%m-%d'),\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END,\n      2,\n      3,\n      tag,\n      area,\n      dim,\n      8,\n      9,\n      10,\n      level4,\n      product_level1,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en,\n      vid_use_case_en,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      browser,\n      browser_ver,\n      dim_grouping_name) AS \"自定义 SQL 查询\"\nWHERE \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 3 AND CAST(\"自定义 SQL 查询\".\"level1\" AS VARCHAR) = 'RTSA'\nGROUP BY 1"
	},
	{
		"presto_sql" : "SELECT \"自定义 SQL 查询\".\"area\" AS \"area\"\nFROM (SELECT date,\n      tag,\n      dim_grouping_name,\n      area,\n        SUM(audio) + SUM(video) AS total,\n      SUM(audio) AS audio,\n      SUM(video) AS video,\n      SUM(video_sd) AS video_sd,\n      SUM(video_hd) AS video_hd,\n      SUM(video_hdp) AS video_hdp,\n        SUM(audience_audio) + SUM(audience_video) AS audience_total,\n      SUM(audience_audio) AS audience_audio,\n      SUM(audience_video) AS audience_video,\n      SUM(audience_sd) AS audience_sd,\n      SUM(audience_hd) AS audience_hd,\n      SUM(audience_hdp) AS audience_hdp,\n      SUM(audience_total_low_latency) AS audience_total_Rtls,\n      SUM(audience_audio_low_latency) AS audience_audio_Rtls,\n      SUM(audience_video_low_latency) AS audience_video_Rtls,\n      SUM(audience_sd_low_latency) AS audience_sd_Rtls,\n      SUM(audience_hd_low_latency) AS audience_hd_Rtls,\n      SUM(audience_hdp_low_latency) AS audience_hdp_Rtls,\n      SUM(total_last1) AS total_last1,\n      SUM(audio_last1) AS audio_last1,\n      SUM(video_last1) AS video_last1,\n        SUM(audience_audio_last1) + SUM(audience_video_last1) AS audience_total_last1,\n      SUM(audience_audio_last1) AS audience_audio_last1,\n      SUM(audience_video_last1) AS audience_video_last1,\n      SUM(audience_total_low_latency_last1) AS audience_total_Rtls_last1,\n      SUM(audience_audio_low_latency_last1) AS audience_audio_Rtls_last1,\n      SUM(audience_video_low_latency_last1) AS audience_video_Rtls_last1,\n      SUM(total_last7) AS total_last7,\n      SUM(audio_last7) AS audio_last7,\n      SUM(video_last7) AS video_last7,\n        SUM(audience_audio_last7) + SUM(audience_video_last7) AS audience_total_last7,\n      SUM(audience_audio_last7) AS audience_audio_last7,\n      SUM(audience_video_last7) AS audience_video_last7,\n      SUM(audience_total_low_latency_last7) AS audience_total_Rtls_last7,\n      SUM(audience_audio_low_latency_last7) AS audience_audio_Rtls_last7,\n      SUM(audience_video_low_latency_last7) AS audience_video_Rtls_last7\n    FROM report_datahub.levels_usage_dod_di_1\n    WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') BETWEEN DATE('2021-11-13') AND DATE('2021-12-13') AND CAST(tag AS VARCHAR) = 'SpecialGroup' AND dim = 1 AND CAST(level1 AS VARCHAR) = 'RTLSVID' AND area IS NOT NULL\n    GROUP BY 1,\n      2,\n      3,\n      4) AS \"自定义 SQL 查询\"\nWHERE \"自定义 SQL 查询\".\"area\" IN ('China', 'Not China')\nGROUP BY 1\nORDER BY \"area\""
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700079370244)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700079370244)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700079370244)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700079370244)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700079370244)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700079370244)(943764407)(0)\",\n  MIN(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(1482809429)(0)\",\n  MAX(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(3765460736)(0)\",\n  MAX(\"自定义 SQL 查询\".\"level2\") AS \"TEMP(attr_level2_nk)(3222240611)(0)\",\n  MIN(\"自定义 SQL 查询\".\"level2\") AS \"TEMP(attr_level2_nk)(3931055347)(0)\",\n  \"自定义 SQL 查询\".\"level3\" AS \"level3\",\n  \"自定义 SQL 查询\".\"stat_date\" AS \"stat_date\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"sum_totalUsage_ok\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211113 AND date <= 20211211 AND dim = 1) AS \"自定义 SQL 查询\"\nWHERE \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 1\nGROUP BY 22,\n  23"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700079370244)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700079370244)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700079370244)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700079370244)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700079370244)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700079370244)(943764407)(0)\",\n  MIN(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(1482809429)(0)\",\n  MAX(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(3765460736)(0)\",\n  \"自定义 SQL 查询\".\"stat_date\" AS \"TEMP(attr_stat_date_nk)(2102638629)(0)\",\n  \"自定义 SQL 查询\".\"stat_date\" AS \"TEMP(attr_stat_date_nk)(2790680713)(0)\",\n  \"自定义 SQL 查询\".\"level2\" AS \"level2\",\n  \"自定义 SQL 查询\".\"stat_date\" AS \"stat_date\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"sum_totalUsage_ok\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211113 AND date <= 20211211 AND dim = 1) AS \"自定义 SQL 查询\"\nWHERE \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 1\nGROUP BY 22,\n  20"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700079370244)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700079370244)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700079370244)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700079370244)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700079370244)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700079370244)(943764407)(0)\",\n  MIN(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(1482809429)(0)\",\n  MAX(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(3765460736)(0)\",\n  MAX(\"自定义 SQL 查询\".\"level2\") AS \"TEMP(attr_level2_nk)(3222240611)(0)\",\n  MIN(\"自定义 SQL 查询\".\"level2\") AS \"TEMP(attr_level2_nk)(3931055347)(0)\",\n  \"自定义 SQL 查询\".\"level4\" AS \"level4\",\n  \"自定义 SQL 查询\".\"stat_date\" AS \"stat_date\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"sum_totalUsage_ok\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211113 AND date <= 20211211 AND dim = 1) AS \"自定义 SQL 查询\"\nWHERE \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 1 AND CAST(\"自定义 SQL 查询\".\"level3\" AS VARCHAR) = 'Framework'\nGROUP BY 22,\n  23"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700079370244)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700079370244)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700079370244)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700079370244)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700079370244)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700079370244)(943764407)(0)\",\n  \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"sum_totalUsage_ok\",\n  DATE_ADD('SECOND', 0, date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"tdy_date_ok\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211113 AND date <= 20211211 AND dim = 1) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n          tag,\n          area AS Scope,\n          dim,\n          level1,\n          level2,\n          level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n            CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n          total AS totalUsage,\n          audio,\n          video,\n          host_audio,\n          audience_audio,\n          host_sd,\n          host_hd,\n          host_hdp,\n          host_1080p,\n          host_2k,\n          host_4k,\n          audience_sd,\n          audience_hd,\n          audience_hdp,\n          audience_1080p,\n          audience_2k,\n          audience_4k,\n          audience_audio_low_latency,\n          audience_sd_low_latency,\n          audience_hd_low_latency,\n          audience_hdp_low_latency,\n          audience_1080p_low_latency,\n          audience_2k_low_latency,\n          audience_4k_low_latency,\n          audience_audio_ultra_low_latency,\n          audience_sd_ultra_low_latency,\n          audience_hd_ultra_low_latency,\n          audience_hdp_ultra_low_latency,\n          audience_1080p_ultra_low_latency,\n          audience_2k_ultra_low_latency,\n          audience_4k_ultra_low_latency,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n          audience_video_low_latency_last1 AS audience_video_low_latency_last,\n          audience_total_low_latency_last1 AS audience_total_low_latency_last,\n          audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n          audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n          audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n          audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n          audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n          audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n          audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n          audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n          audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n          audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n          audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n          audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n          audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n          audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n          audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n          audience_2k_last1 AS audience_2k_last,\n          audience_4k_last1 AS audience_4k_last,\n          audience_1080p_last1 AS audience_1080p_last,\n          host_1080p_last1 AS host_1080p_last,\n          host_2k_last1 AS host_2k_last,\n          host_4k_last1 AS host_4k_last,\n          total_last7,\n          audio_last7,\n          video_last7,\n          video_sd_last7,\n          video_hd_last7,\n          video_hdp_last7,\n          host_sd_last7,\n          audience_sd_last7,\n          host_hd_last7,\n          audience_hd_last7,\n          host_hdp_last7,\n          audience_hdp_last7,\n          host_audio_last7,\n          audience_audio_last7,\n          host_video_last7,\n          audience_video_last7,\n          audience_audio_low_latency_last7,\n          audience_video_low_latency_last7,\n          audience_total_low_latency_last7,\n          audience_sd_low_latency_last7,\n          audience_hd_low_latency_last7,\n          audience_hdp_low_latency_last7,\n          audience_1080p_low_latency_last7,\n          audience_2k_low_latency_last7,\n          audience_4k_low_latency_last7,\n          audience_audio_ultra_low_latency_last7,\n          audience_video_ultra_low_latency_last7,\n          audience_total_ultra_low_latency_last7,\n          audience_sd_ultra_low_latency_last7,\n          audience_hd_ultra_low_latency_last7,\n          audience_hdp_ultra_low_latency_last7,\n          audience_1080p_ultra_low_latency_last7,\n          audience_2k_ultra_low_latency_last7,\n          audience_4k_ultra_low_latency_last7,\n          audience_2k_last7,\n          audience_4k_last7,\n          audience_1080p_last7,\n          host_1080p_last7,\n          host_2k_last7,\n          host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211113 AND date <= 20211211 AND dim = 1) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 1 AND \"自定义 SQL 查询\".\"rank_level1\" = 4 AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 18,\n  20"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700079370244)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700079370244)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700079370244)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700079370244)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700079370244)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700079370244)(943764407)(0)\",\n  MAX(\"自定义 SQL 查询\".\"rank_level1\") AS \"TEMP(attr_rank_level1_qk)(289677037)(0)\",\n  MIN(\"自定义 SQL 查询\".\"rank_level1\") AS \"TEMP(attr_rank_level1_qk)(992764851)(0)\",\n  \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"sum_totalUsage_ok\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211113 AND date <= 20211211 AND dim = 1) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n          tag,\n          area AS Scope,\n          dim,\n          level1,\n          level2,\n          level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n            CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n          total AS totalUsage,\n          audio,\n          video,\n          host_audio,\n          audience_audio,\n          host_sd,\n          host_hd,\n          host_hdp,\n          host_1080p,\n          host_2k,\n          host_4k,\n          audience_sd,\n          audience_hd,\n          audience_hdp,\n          audience_1080p,\n          audience_2k,\n          audience_4k,\n          audience_audio_low_latency,\n          audience_sd_low_latency,\n          audience_hd_low_latency,\n          audience_hdp_low_latency,\n          audience_1080p_low_latency,\n          audience_2k_low_latency,\n          audience_4k_low_latency,\n          audience_audio_ultra_low_latency,\n          audience_sd_ultra_low_latency,\n          audience_hd_ultra_low_latency,\n          audience_hdp_ultra_low_latency,\n          audience_1080p_ultra_low_latency,\n          audience_2k_ultra_low_latency,\n          audience_4k_ultra_low_latency,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n          audience_video_low_latency_last1 AS audience_video_low_latency_last,\n          audience_total_low_latency_last1 AS audience_total_low_latency_last,\n          audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n          audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n          audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n          audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n          audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n          audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n          audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n          audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n          audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n          audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n          audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n          audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n          audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n          audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n          audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n          audience_2k_last1 AS audience_2k_last,\n          audience_4k_last1 AS audience_4k_last,\n          audience_1080p_last1 AS audience_1080p_last,\n          host_1080p_last1 AS host_1080p_last,\n          host_2k_last1 AS host_2k_last,\n          host_4k_last1 AS host_4k_last,\n          total_last7,\n          audio_last7,\n          video_last7,\n          video_sd_last7,\n          video_hd_last7,\n          video_hdp_last7,\n          host_sd_last7,\n          audience_sd_last7,\n          host_hd_last7,\n          audience_hd_last7,\n          host_hdp_last7,\n          audience_hdp_last7,\n          host_audio_last7,\n          audience_audio_last7,\n          host_video_last7,\n          audience_video_last7,\n          audience_audio_low_latency_last7,\n          audience_video_low_latency_last7,\n          audience_total_low_latency_last7,\n          audience_sd_low_latency_last7,\n          audience_hd_low_latency_last7,\n          audience_hdp_low_latency_last7,\n          audience_1080p_low_latency_last7,\n          audience_2k_low_latency_last7,\n          audience_4k_low_latency_last7,\n          audience_audio_ultra_low_latency_last7,\n          audience_video_ultra_low_latency_last7,\n          audience_total_ultra_low_latency_last7,\n          audience_sd_ultra_low_latency_last7,\n          audience_hd_ultra_low_latency_last7,\n          audience_hdp_ultra_low_latency_last7,\n          audience_1080p_ultra_low_latency_last7,\n          audience_2k_ultra_low_latency_last7,\n          audience_4k_ultra_low_latency_last7,\n          audience_2k_last7,\n          audience_4k_last7,\n          audience_1080p_last7,\n          host_1080p_last7,\n          host_2k_last7,\n          host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211113 AND date <= 20211211 AND dim = 1) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 20"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700079370244)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700079370244)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700079370244)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700079370244)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700079370244)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700079370244)(943764407)(0)\",\n  MIN(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(1482809429)(0)\",\n  MAX(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(3765460736)(0)\",\n  MAX(\"自定义 SQL 查询\".\"level2\") AS \"TEMP(attr_level2_nk)(3222240611)(0)\",\n  MIN(\"自定义 SQL 查询\".\"level2\") AS \"TEMP(attr_level2_nk)(3931055347)(0)\",\n  MAX(\"自定义 SQL 查询\".\"stat_date\") AS \"TEMP(attr_stat_date_nk)(2102638629)(0)\",\n  MIN(\"自定义 SQL 查询\".\"stat_date\") AS \"TEMP(attr_stat_date_nk)(2790680713)(0)\",\n  \"自定义 SQL 查询\".\"level3\" AS \"level3\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211113 AND date <= 20211211 AND dim = 1) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n          tag,\n          area AS Scope,\n          dim,\n          level1,\n          level2,\n          level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n            CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n          total AS totalUsage,\n          audio,\n          video,\n          host_audio,\n          audience_audio,\n          host_sd,\n          host_hd,\n          host_hdp,\n          host_1080p,\n          host_2k,\n          host_4k,\n          audience_sd,\n          audience_hd,\n          audience_hdp,\n          audience_1080p,\n          audience_2k,\n          audience_4k,\n          audience_audio_low_latency,\n          audience_sd_low_latency,\n          audience_hd_low_latency,\n          audience_hdp_low_latency,\n          audience_1080p_low_latency,\n          audience_2k_low_latency,\n          audience_4k_low_latency,\n          audience_audio_ultra_low_latency,\n          audience_sd_ultra_low_latency,\n          audience_hd_ultra_low_latency,\n          audience_hdp_ultra_low_latency,\n          audience_1080p_ultra_low_latency,\n          audience_2k_ultra_low_latency,\n          audience_4k_ultra_low_latency,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n          audience_video_low_latency_last1 AS audience_video_low_latency_last,\n          audience_total_low_latency_last1 AS audience_total_low_latency_last,\n          audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n          audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n          audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n          audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n          audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n          audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n          audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n          audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n          audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n          audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n          audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n          audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n          audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n          audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n          audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n          audience_2k_last1 AS audience_2k_last,\n          audience_4k_last1 AS audience_4k_last,\n          audience_1080p_last1 AS audience_1080p_last,\n          host_1080p_last1 AS host_1080p_last,\n          host_2k_last1 AS host_2k_last,\n          host_4k_last1 AS host_4k_last,\n          total_last7,\n          audio_last7,\n          video_last7,\n          video_sd_last7,\n          video_hd_last7,\n          video_hdp_last7,\n          host_sd_last7,\n          audience_sd_last7,\n          host_hd_last7,\n          audience_hd_last7,\n          host_hdp_last7,\n          audience_hdp_last7,\n          host_audio_last7,\n          audience_audio_last7,\n          host_video_last7,\n          audience_video_last7,\n          audience_audio_low_latency_last7,\n          audience_video_low_latency_last7,\n          audience_total_low_latency_last7,\n          audience_sd_low_latency_last7,\n          audience_hd_low_latency_last7,\n          audience_hdp_low_latency_last7,\n          audience_1080p_low_latency_last7,\n          audience_2k_low_latency_last7,\n          audience_4k_low_latency_last7,\n          audience_audio_ultra_low_latency_last7,\n          audience_video_ultra_low_latency_last7,\n          audience_total_ultra_low_latency_last7,\n          audience_sd_ultra_low_latency_last7,\n          audience_hd_ultra_low_latency_last7,\n          audience_hdp_ultra_low_latency_last7,\n          audience_1080p_ultra_low_latency_last7,\n          audience_2k_ultra_low_latency_last7,\n          audience_4k_ultra_low_latency_last7,\n          audience_2k_last7,\n          audience_4k_last7,\n          audience_1080p_last7,\n          host_1080p_last7,\n          host_2k_last7,\n          host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211113 AND date <= 20211211 AND dim = 1) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 1 AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 24"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700079370244)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700079370244)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700079370244)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700079370244)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700079370244)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700079370244)(943764407)(0)\",\n  \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"sum_totalUsage_ok\",\n  DATE_ADD('SECOND', 0, date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"tdy_date_ok\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211113 AND date <= 20211211 AND dim = 1) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n          tag,\n          area AS Scope,\n          dim,\n          level1,\n          level2,\n          level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n            CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n          total AS totalUsage,\n          audio,\n          video,\n          host_audio,\n          audience_audio,\n          host_sd,\n          host_hd,\n          host_hdp,\n          host_1080p,\n          host_2k,\n          host_4k,\n          audience_sd,\n          audience_hd,\n          audience_hdp,\n          audience_1080p,\n          audience_2k,\n          audience_4k,\n          audience_audio_low_latency,\n          audience_sd_low_latency,\n          audience_hd_low_latency,\n          audience_hdp_low_latency,\n          audience_1080p_low_latency,\n          audience_2k_low_latency,\n          audience_4k_low_latency,\n          audience_audio_ultra_low_latency,\n          audience_sd_ultra_low_latency,\n          audience_hd_ultra_low_latency,\n          audience_hdp_ultra_low_latency,\n          audience_1080p_ultra_low_latency,\n          audience_2k_ultra_low_latency,\n          audience_4k_ultra_low_latency,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n          audience_video_low_latency_last1 AS audience_video_low_latency_last,\n          audience_total_low_latency_last1 AS audience_total_low_latency_last,\n          audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n          audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n          audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n          audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n          audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n          audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n          audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n          audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n          audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n          audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n          audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n          audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n          audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n          audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n          audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n          audience_2k_last1 AS audience_2k_last,\n          audience_4k_last1 AS audience_4k_last,\n          audience_1080p_last1 AS audience_1080p_last,\n          host_1080p_last1 AS host_1080p_last,\n          host_2k_last1 AS host_2k_last,\n          host_4k_last1 AS host_4k_last,\n          total_last7,\n          audio_last7,\n          video_last7,\n          video_sd_last7,\n          video_hd_last7,\n          video_hdp_last7,\n          host_sd_last7,\n          audience_sd_last7,\n          host_hd_last7,\n          audience_hd_last7,\n          host_hdp_last7,\n          audience_hdp_last7,\n          host_audio_last7,\n          audience_audio_last7,\n          host_video_last7,\n          audience_video_last7,\n          audience_audio_low_latency_last7,\n          audience_video_low_latency_last7,\n          audience_total_low_latency_last7,\n          audience_sd_low_latency_last7,\n          audience_hd_low_latency_last7,\n          audience_hdp_low_latency_last7,\n          audience_1080p_low_latency_last7,\n          audience_2k_low_latency_last7,\n          audience_4k_low_latency_last7,\n          audience_audio_ultra_low_latency_last7,\n          audience_video_ultra_low_latency_last7,\n          audience_total_ultra_low_latency_last7,\n          audience_sd_ultra_low_latency_last7,\n          audience_hd_ultra_low_latency_last7,\n          audience_hdp_ultra_low_latency_last7,\n          audience_1080p_ultra_low_latency_last7,\n          audience_2k_ultra_low_latency_last7,\n          audience_4k_ultra_low_latency_last7,\n          audience_2k_last7,\n          audience_4k_last7,\n          audience_1080p_last7,\n          host_1080p_last7,\n          host_2k_last7,\n          host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211113 AND date <= 20211211 AND dim = 1) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 1 AND \"自定义 SQL 查询\".\"rank_level1\" = 3 AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 18,\n  20"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700079370244)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700079370244)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700079370244)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700079370244)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700079370244)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700079370244)(943764407)(0)\",\n  MAX(\"自定义 SQL 查询\".\"stat_date\") AS \"TEMP(attr_stat_date_nk)(2102638629)(0)\",\n  MIN(\"自定义 SQL 查询\".\"stat_date\") AS \"TEMP(attr_stat_date_nk)(2790680713)(0)\",\n  \"自定义 SQL 查询\".\"level4\" AS \"level4\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211113 AND date <= 20211211 AND dim = 1) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n          tag,\n          area AS Scope,\n          dim,\n          level1,\n          level2,\n          level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n            CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n          total AS totalUsage,\n          audio,\n          video,\n          host_audio,\n          audience_audio,\n          host_sd,\n          host_hd,\n          host_hdp,\n          host_1080p,\n          host_2k,\n          host_4k,\n          audience_sd,\n          audience_hd,\n          audience_hdp,\n          audience_1080p,\n          audience_2k,\n          audience_4k,\n          audience_audio_low_latency,\n          audience_sd_low_latency,\n          audience_hd_low_latency,\n          audience_hdp_low_latency,\n          audience_1080p_low_latency,\n          audience_2k_low_latency,\n          audience_4k_low_latency,\n          audience_audio_ultra_low_latency,\n          audience_sd_ultra_low_latency,\n          audience_hd_ultra_low_latency,\n          audience_hdp_ultra_low_latency,\n          audience_1080p_ultra_low_latency,\n          audience_2k_ultra_low_latency,\n          audience_4k_ultra_low_latency,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n          audience_video_low_latency_last1 AS audience_video_low_latency_last,\n          audience_total_low_latency_last1 AS audience_total_low_latency_last,\n          audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n          audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n          audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n          audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n          audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n          audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n          audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n          audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n          audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n          audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n          audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n          audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n          audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n          audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n          audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n          audience_2k_last1 AS audience_2k_last,\n          audience_4k_last1 AS audience_4k_last,\n          audience_1080p_last1 AS audience_1080p_last,\n          host_1080p_last1 AS host_1080p_last,\n          host_2k_last1 AS host_2k_last,\n          host_4k_last1 AS host_4k_last,\n          total_last7,\n          audio_last7,\n          video_last7,\n          video_sd_last7,\n          video_hd_last7,\n          video_hdp_last7,\n          host_sd_last7,\n          audience_sd_last7,\n          host_hd_last7,\n          audience_hd_last7,\n          host_hdp_last7,\n          audience_hdp_last7,\n          host_audio_last7,\n          audience_audio_last7,\n          host_video_last7,\n          audience_video_last7,\n          audience_audio_low_latency_last7,\n          audience_video_low_latency_last7,\n          audience_total_low_latency_last7,\n          audience_sd_low_latency_last7,\n          audience_hd_low_latency_last7,\n          audience_hdp_low_latency_last7,\n          audience_1080p_low_latency_last7,\n          audience_2k_low_latency_last7,\n          audience_4k_low_latency_last7,\n          audience_audio_ultra_low_latency_last7,\n          audience_video_ultra_low_latency_last7,\n          audience_total_ultra_low_latency_last7,\n          audience_sd_ultra_low_latency_last7,\n          audience_hd_ultra_low_latency_last7,\n          audience_hdp_ultra_low_latency_last7,\n          audience_1080p_ultra_low_latency_last7,\n          audience_2k_ultra_low_latency_last7,\n          audience_4k_ultra_low_latency_last7,\n          audience_2k_last7,\n          audience_4k_last7,\n          audience_1080p_last7,\n          host_1080p_last7,\n          host_2k_last7,\n          host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211113 AND date <= 20211211 AND dim = 1) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 1 AND CAST(\"自定义 SQL 查询\".\"level3\" AS VARCHAR) = 'Framework' AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 20"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700079370244)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700079370244)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700079370244)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700079370244)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700079370244)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700079370244)(943764407)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_4k_last\") AS \"TEMP(Calculation_3519281700083154949)(101123376)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_hdp_last\") AS \"TEMP(Calculation_3519281700083154949)(1200517625)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p_last\") AS \"TEMP(Calculation_3519281700083154949)(1314346200)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_hd_last\") AS \"TEMP(Calculation_3519281700083154949)(146570423)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k_last\") AS \"TEMP(Calculation_3519281700083154949)(1717771635)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio_last\") AS \"TEMP(Calculation_3519281700083154949)(2313111073)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_hdp_last\") AS \"TEMP(Calculation_3519281700083154949)(258310559)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_video_last\") AS \"TEMP(Calculation_3519281700083154949)(2820618408)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k_last\") AS \"TEMP(Calculation_3519281700083154949)(3121859593)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p_last\") AS \"TEMP(Calculation_3519281700083154949)(3222422303)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio_last\") AS \"TEMP(Calculation_3519281700083154949)(3227677803)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video_last\") AS \"TEMP(Calculation_3519281700083154949)(3934387163)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k_last\") AS \"TEMP(Calculation_3519281700083154949)(4055292783)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_last\") AS \"TEMP(Calculation_3519281700083154949)(4091190060)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_hd_last\") AS \"TEMP(Calculation_3519281700083154949)(4170367250)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_sd_last\") AS \"TEMP(Calculation_3519281700083154949)(4190307025)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_sd_last\") AS \"TEMP(Calculation_3519281700083154949)(933007102)(0)\",\n  MAX(\"自定义 SQL 查询\".\"stat_date\") AS \"TEMP(attr_stat_date_nk)(2102638629)(0)\",\n  MIN(\"自定义 SQL 查询\".\"stat_date\") AS \"TEMP(attr_stat_date_nk)(2790680713)(0)\",\n  \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"sum_totalUsage_ok\",\n  DATE_ADD('SECOND', 0, date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"tdy_date_ok\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211113 AND date <= 20211211 AND dim = 1) AS \"自定义 SQL 查询\"\nWHERE \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 1 AND \"自定义 SQL 查询\".\"rank_level1\" = 4\nGROUP BY 37,\n  39"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700079370244)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700079370244)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700079370244)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700079370244)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700079370244)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700079370244)(943764407)(0)\",\n  MIN(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(1482809429)(0)\",\n  MAX(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(3765460736)(0)\",\n  \"自定义 SQL 查询\".\"level2\" AS \"level2\",\n  \"自定义 SQL 查询\".\"stat_date\" AS \"stat_date\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211113 AND date <= 20211211 AND dim = 1) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n          tag,\n          area AS Scope,\n          dim,\n          level1,\n          level2,\n          level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n            CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n          total AS totalUsage,\n          audio,\n          video,\n          host_audio,\n          audience_audio,\n          host_sd,\n          host_hd,\n          host_hdp,\n          host_1080p,\n          host_2k,\n          host_4k,\n          audience_sd,\n          audience_hd,\n          audience_hdp,\n          audience_1080p,\n          audience_2k,\n          audience_4k,\n          audience_audio_low_latency,\n          audience_sd_low_latency,\n          audience_hd_low_latency,\n          audience_hdp_low_latency,\n          audience_1080p_low_latency,\n          audience_2k_low_latency,\n          audience_4k_low_latency,\n          audience_audio_ultra_low_latency,\n          audience_sd_ultra_low_latency,\n          audience_hd_ultra_low_latency,\n          audience_hdp_ultra_low_latency,\n          audience_1080p_ultra_low_latency,\n          audience_2k_ultra_low_latency,\n          audience_4k_ultra_low_latency,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n          audience_video_low_latency_last1 AS audience_video_low_latency_last,\n          audience_total_low_latency_last1 AS audience_total_low_latency_last,\n          audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n          audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n          audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n          audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n          audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n          audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n          audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n          audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n          audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n          audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n          audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n          audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n          audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n          audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n          audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n          audience_2k_last1 AS audience_2k_last,\n          audience_4k_last1 AS audience_4k_last,\n          audience_1080p_last1 AS audience_1080p_last,\n          host_1080p_last1 AS host_1080p_last,\n          host_2k_last1 AS host_2k_last,\n          host_4k_last1 AS host_4k_last,\n          total_last7,\n          audio_last7,\n          video_last7,\n          video_sd_last7,\n          video_hd_last7,\n          video_hdp_last7,\n          host_sd_last7,\n          audience_sd_last7,\n          host_hd_last7,\n          audience_hd_last7,\n          host_hdp_last7,\n          audience_hdp_last7,\n          host_audio_last7,\n          audience_audio_last7,\n          host_video_last7,\n          audience_video_last7,\n          audience_audio_low_latency_last7,\n          audience_video_low_latency_last7,\n          audience_total_low_latency_last7,\n          audience_sd_low_latency_last7,\n          audience_hd_low_latency_last7,\n          audience_hdp_low_latency_last7,\n          audience_1080p_low_latency_last7,\n          audience_2k_low_latency_last7,\n          audience_4k_low_latency_last7,\n          audience_audio_ultra_low_latency_last7,\n          audience_video_ultra_low_latency_last7,\n          audience_total_ultra_low_latency_last7,\n          audience_sd_ultra_low_latency_last7,\n          audience_hd_ultra_low_latency_last7,\n          audience_hdp_ultra_low_latency_last7,\n          audience_1080p_ultra_low_latency_last7,\n          audience_2k_ultra_low_latency_last7,\n          audience_4k_ultra_low_latency_last7,\n          audience_2k_last7,\n          audience_4k_last7,\n          audience_1080p_last7,\n          host_1080p_last7,\n          host_2k_last7,\n          host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211113 AND date <= 20211211 AND dim = 1) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 1 AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 20,\n  21"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700079370244)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700079370244)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700079370244)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700079370244)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700079370244)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700079370244)(943764407)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_4k_last\") AS \"TEMP(Calculation_3519281700083154949)(101123376)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_hdp_last\") AS \"TEMP(Calculation_3519281700083154949)(1200517625)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p_last\") AS \"TEMP(Calculation_3519281700083154949)(1314346200)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_hd_last\") AS \"TEMP(Calculation_3519281700083154949)(146570423)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k_last\") AS \"TEMP(Calculation_3519281700083154949)(1717771635)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio_last\") AS \"TEMP(Calculation_3519281700083154949)(2313111073)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_hdp_last\") AS \"TEMP(Calculation_3519281700083154949)(258310559)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_video_last\") AS \"TEMP(Calculation_3519281700083154949)(2820618408)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k_last\") AS \"TEMP(Calculation_3519281700083154949)(3121859593)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p_last\") AS \"TEMP(Calculation_3519281700083154949)(3222422303)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio_last\") AS \"TEMP(Calculation_3519281700083154949)(3227677803)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video_last\") AS \"TEMP(Calculation_3519281700083154949)(3934387163)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k_last\") AS \"TEMP(Calculation_3519281700083154949)(4055292783)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_last\") AS \"TEMP(Calculation_3519281700083154949)(4091190060)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_hd_last\") AS \"TEMP(Calculation_3519281700083154949)(4170367250)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_sd_last\") AS \"TEMP(Calculation_3519281700083154949)(4190307025)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_sd_last\") AS \"TEMP(Calculation_3519281700083154949)(933007102)(0)\",\n  MAX(\"自定义 SQL 查询\".\"stat_date\") AS \"TEMP(attr_stat_date_nk)(2102638629)(0)\",\n  MIN(\"自定义 SQL 查询\".\"stat_date\") AS \"TEMP(attr_stat_date_nk)(2790680713)(0)\",\n  \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"sum_totalUsage_ok\",\n  DATE_ADD('SECOND', 0, date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"tdy_date_ok\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211113 AND date <= 20211211 AND dim = 1) AS \"自定义 SQL 查询\"\nWHERE \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 1 AND \"自定义 SQL 查询\".\"rank_level1\" = 3\nGROUP BY 37,\n  39"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700079370244)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700079370244)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700079370244)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700079370244)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700079370244)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700079370244)(943764407)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_4k_last\") AS \"TEMP(Calculation_3519281700083154949)(101123376)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_hdp_last\") AS \"TEMP(Calculation_3519281700083154949)(1200517625)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p_last\") AS \"TEMP(Calculation_3519281700083154949)(1314346200)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_hd_last\") AS \"TEMP(Calculation_3519281700083154949)(146570423)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k_last\") AS \"TEMP(Calculation_3519281700083154949)(1717771635)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio_last\") AS \"TEMP(Calculation_3519281700083154949)(2313111073)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_hdp_last\") AS \"TEMP(Calculation_3519281700083154949)(258310559)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_video_last\") AS \"TEMP(Calculation_3519281700083154949)(2820618408)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k_last\") AS \"TEMP(Calculation_3519281700083154949)(3121859593)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p_last\") AS \"TEMP(Calculation_3519281700083154949)(3222422303)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio_last\") AS \"TEMP(Calculation_3519281700083154949)(3227677803)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video_last\") AS \"TEMP(Calculation_3519281700083154949)(3934387163)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k_last\") AS \"TEMP(Calculation_3519281700083154949)(4055292783)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_last\") AS \"TEMP(Calculation_3519281700083154949)(4091190060)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_hd_last\") AS \"TEMP(Calculation_3519281700083154949)(4170367250)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_sd_last\") AS \"TEMP(Calculation_3519281700083154949)(4190307025)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_sd_last\") AS \"TEMP(Calculation_3519281700083154949)(933007102)(0)\",\n  MAX(\"自定义 SQL 查询\".\"stat_date\") AS \"TEMP(attr_stat_date_nk)(2102638629)(0)\",\n  MIN(\"自定义 SQL 查询\".\"stat_date\") AS \"TEMP(attr_stat_date_nk)(2790680713)(0)\",\n  \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"sum_totalUsage_ok\",\n  DATE_ADD('SECOND', 0, date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"tdy_date_ok\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211113 AND date <= 20211211 AND dim = 1) AS \"自定义 SQL 查询\"\nWHERE \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 1 AND \"自定义 SQL 查询\".\"rank_level1\" = 2\nGROUP BY 37,\n  39"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k_last\") AS \"TEMP(Calculation_3519281700083154949)(101123376)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700083154949)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700083154949)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_hdp_last\") AS \"TEMP(Calculation_3519281700083154949)(1200517625)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700083154949)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p_last\") AS \"TEMP(Calculation_3519281700083154949)(1314346200)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_hd_last\") AS \"TEMP(Calculation_3519281700083154949)(146570423)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k_last\") AS \"TEMP(Calculation_3519281700083154949)(1717771635)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio_last\") AS \"TEMP(Calculation_3519281700083154949)(2313111073)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_hdp_last\") AS \"TEMP(Calculation_3519281700083154949)(258310559)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700083154949)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_video_last\") AS \"TEMP(Calculation_3519281700083154949)(2820618408)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700083154949)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700083154949)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700083154949)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700083154949)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700083154949)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k_last\") AS \"TEMP(Calculation_3519281700083154949)(3121859593)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p_last\") AS \"TEMP(Calculation_3519281700083154949)(3222422303)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio_last\") AS \"TEMP(Calculation_3519281700083154949)(3227677803)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700083154949)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700083154949)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700083154949)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video_last\") AS \"TEMP(Calculation_3519281700083154949)(3934387163)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k_last\") AS \"TEMP(Calculation_3519281700083154949)(4055292783)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_last\") AS \"TEMP(Calculation_3519281700083154949)(4091190060)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700083154949)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_hd_last\") AS \"TEMP(Calculation_3519281700083154949)(4170367250)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_sd_last\") AS \"TEMP(Calculation_3519281700083154949)(4190307025)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700083154949)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700083154949)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700083154949)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_sd_last\") AS \"TEMP(Calculation_3519281700083154949)(933007102)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700083154949)(943764407)(0)\",\n  AVG(\"自定义 SQL 查询\".\"totalUsage\") AS \"avg_totalUsage_ok\",\n  \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"sum_totalUsage_ok\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211113 AND date <= 20211211 AND dim = 1) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n          tag,\n          area AS Scope,\n          dim,\n          level1,\n          level2,\n          level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n            CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n          total AS totalUsage,\n          audio,\n          video,\n          host_audio,\n          audience_audio,\n          host_sd,\n          host_hd,\n          host_hdp,\n          host_1080p,\n          host_2k,\n          host_4k,\n          audience_sd,\n          audience_hd,\n          audience_hdp,\n          audience_1080p,\n          audience_2k,\n          audience_4k,\n          audience_audio_low_latency,\n          audience_sd_low_latency,\n          audience_hd_low_latency,\n          audience_hdp_low_latency,\n          audience_1080p_low_latency,\n          audience_2k_low_latency,\n          audience_4k_low_latency,\n          audience_audio_ultra_low_latency,\n          audience_sd_ultra_low_latency,\n          audience_hd_ultra_low_latency,\n          audience_hdp_ultra_low_latency,\n          audience_1080p_ultra_low_latency,\n          audience_2k_ultra_low_latency,\n          audience_4k_ultra_low_latency,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n          audience_video_low_latency_last1 AS audience_video_low_latency_last,\n          audience_total_low_latency_last1 AS audience_total_low_latency_last,\n          audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n          audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n          audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n          audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n          audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n          audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n          audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n          audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n          audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n          audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n          audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n          audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n          audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n          audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n          audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n          audience_2k_last1 AS audience_2k_last,\n          audience_4k_last1 AS audience_4k_last,\n          audience_1080p_last1 AS audience_1080p_last,\n          host_1080p_last1 AS host_1080p_last,\n          host_2k_last1 AS host_2k_last,\n          host_4k_last1 AS host_4k_last,\n          total_last7,\n          audio_last7,\n          video_last7,\n          video_sd_last7,\n          video_hd_last7,\n          video_hdp_last7,\n          host_sd_last7,\n          audience_sd_last7,\n          host_hd_last7,\n          audience_hd_last7,\n          host_hdp_last7,\n          audience_hdp_last7,\n          host_audio_last7,\n          audience_audio_last7,\n          host_video_last7,\n          audience_video_last7,\n          audience_audio_low_latency_last7,\n          audience_video_low_latency_last7,\n          audience_total_low_latency_last7,\n          audience_sd_low_latency_last7,\n          audience_hd_low_latency_last7,\n          audience_hdp_low_latency_last7,\n          audience_1080p_low_latency_last7,\n          audience_2k_low_latency_last7,\n          audience_4k_low_latency_last7,\n          audience_audio_ultra_low_latency_last7,\n          audience_video_ultra_low_latency_last7,\n          audience_total_ultra_low_latency_last7,\n          audience_sd_ultra_low_latency_last7,\n          audience_hd_ultra_low_latency_last7,\n          audience_hdp_ultra_low_latency_last7,\n          audience_1080p_ultra_low_latency_last7,\n          audience_2k_ultra_low_latency_last7,\n          audience_4k_ultra_low_latency_last7,\n          audience_2k_last7,\n          audience_4k_last7,\n          audience_1080p_last7,\n          host_1080p_last7,\n          host_2k_last7,\n          host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211113 AND date <= 20211211 AND dim = 1) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 1 AND \"自定义 SQL 查询\".\"rank_level1\" = 3 AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 36"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700341563406)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio_last7\") AS \"TEMP(Calculation_3519281700341563406)(1077563395)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700341563406)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700341563406)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd_last7\") AS \"TEMP(Calculation_3519281700341563406)(1456465729)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd_last7\") AS \"TEMP(Calculation_3519281700341563406)(1635749653)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd_last7\") AS \"TEMP(Calculation_3519281700341563406)(1747046964)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k_last7\") AS \"TEMP(Calculation_3519281700341563406)(1747524570)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp_last7\") AS \"TEMP(Calculation_3519281700341563406)(2044136109)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio_last7\") AS \"TEMP(Calculation_3519281700341563406)(2464388580)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_last7\") AS \"TEMP(Calculation_3519281700341563406)(2589233512)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700341563406)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k_last7\") AS \"TEMP(Calculation_3519281700341563406)(280796653)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700341563406)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700341563406)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700341563406)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700341563406)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700341563406)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_4k_last7\") AS \"TEMP(Calculation_3519281700341563406)(3127348545)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700341563406)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"total_last7\") AS \"TEMP(Calculation_3519281700341563406)(346677966)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k_last7\") AS \"TEMP(Calculation_3519281700341563406)(3543669678)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p_last7\") AS \"TEMP(Calculation_3519281700341563406)(3624983014)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700341563406)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700341563406)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd_last7\") AS \"TEMP(Calculation_3519281700341563406)(3905372418)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video_last7\") AS \"TEMP(Calculation_3519281700341563406)(4107040267)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700341563406)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700341563406)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p_last7\") AS \"TEMP(Calculation_3519281700341563406)(632977665)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700341563406)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp_last7\") AS \"TEMP(Calculation_3519281700341563406)(750340200)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700341563406)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700341563406)(943764407)(0)\",\n  \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"audio_video_last\") AS \"sum_audio_video_last_ok\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211113 AND date <= 20211211 AND dim = 1) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n          tag,\n          area AS Scope,\n          dim,\n          level1,\n          level2,\n          level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n            CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n          total AS totalUsage,\n          audio,\n          video,\n          host_audio,\n          audience_audio,\n          host_sd,\n          host_hd,\n          host_hdp,\n          host_1080p,\n          host_2k,\n          host_4k,\n          audience_sd,\n          audience_hd,\n          audience_hdp,\n          audience_1080p,\n          audience_2k,\n          audience_4k,\n          audience_audio_low_latency,\n          audience_sd_low_latency,\n          audience_hd_low_latency,\n          audience_hdp_low_latency,\n          audience_1080p_low_latency,\n          audience_2k_low_latency,\n          audience_4k_low_latency,\n          audience_audio_ultra_low_latency,\n          audience_sd_ultra_low_latency,\n          audience_hd_ultra_low_latency,\n          audience_hdp_ultra_low_latency,\n          audience_1080p_ultra_low_latency,\n          audience_2k_ultra_low_latency,\n          audience_4k_ultra_low_latency,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n          audience_video_low_latency_last1 AS audience_video_low_latency_last,\n          audience_total_low_latency_last1 AS audience_total_low_latency_last,\n          audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n          audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n          audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n          audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n          audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n          audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n          audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n          audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n          audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n          audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n          audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n          audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n          audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n          audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n          audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n          audience_2k_last1 AS audience_2k_last,\n          audience_4k_last1 AS audience_4k_last,\n          audience_1080p_last1 AS audience_1080p_last,\n          host_1080p_last1 AS host_1080p_last,\n          host_2k_last1 AS host_2k_last,\n          host_4k_last1 AS host_4k_last,\n          total_last7,\n          audio_last7,\n          video_last7,\n          video_sd_last7,\n          video_hd_last7,\n          video_hdp_last7,\n          host_sd_last7,\n          audience_sd_last7,\n          host_hd_last7,\n          audience_hd_last7,\n          host_hdp_last7,\n          audience_hdp_last7,\n          host_audio_last7,\n          audience_audio_last7,\n          host_video_last7,\n          audience_video_last7,\n          audience_audio_low_latency_last7,\n          audience_video_low_latency_last7,\n          audience_total_low_latency_last7,\n          audience_sd_low_latency_last7,\n          audience_hd_low_latency_last7,\n          audience_hdp_low_latency_last7,\n          audience_1080p_low_latency_last7,\n          audience_2k_low_latency_last7,\n          audience_4k_low_latency_last7,\n          audience_audio_ultra_low_latency_last7,\n          audience_video_ultra_low_latency_last7,\n          audience_total_ultra_low_latency_last7,\n          audience_sd_ultra_low_latency_last7,\n          audience_hd_ultra_low_latency_last7,\n          audience_hdp_ultra_low_latency_last7,\n          audience_1080p_ultra_low_latency_last7,\n          audience_2k_ultra_low_latency_last7,\n          audience_4k_ultra_low_latency_last7,\n          audience_2k_last7,\n          audience_4k_last7,\n          audience_1080p_last7,\n          host_1080p_last7,\n          host_2k_last7,\n          host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211113 AND date <= 20211211 AND dim = 1) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 1 AND \"自定义 SQL 查询\".\"rank_level1\" = 4 AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 35"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700079370244)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700079370244)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700079370244)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700079370244)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700079370244)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700079370244)(943764407)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_4k_last\") AS \"TEMP(Calculation_3519281700083154949)(101123376)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_hdp_last\") AS \"TEMP(Calculation_3519281700083154949)(1200517625)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p_last\") AS \"TEMP(Calculation_3519281700083154949)(1314346200)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_hd_last\") AS \"TEMP(Calculation_3519281700083154949)(146570423)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k_last\") AS \"TEMP(Calculation_3519281700083154949)(1717771635)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio_last\") AS \"TEMP(Calculation_3519281700083154949)(2313111073)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_hdp_last\") AS \"TEMP(Calculation_3519281700083154949)(258310559)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_video_last\") AS \"TEMP(Calculation_3519281700083154949)(2820618408)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k_last\") AS \"TEMP(Calculation_3519281700083154949)(3121859593)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p_last\") AS \"TEMP(Calculation_3519281700083154949)(3222422303)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio_last\") AS \"TEMP(Calculation_3519281700083154949)(3227677803)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video_last\") AS \"TEMP(Calculation_3519281700083154949)(3934387163)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k_last\") AS \"TEMP(Calculation_3519281700083154949)(4055292783)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_last\") AS \"TEMP(Calculation_3519281700083154949)(4091190060)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_hd_last\") AS \"TEMP(Calculation_3519281700083154949)(4170367250)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_sd_last\") AS \"TEMP(Calculation_3519281700083154949)(4190307025)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_sd_last\") AS \"TEMP(Calculation_3519281700083154949)(933007102)(0)\",\n  MAX(\"自定义 SQL 查询\".\"stat_date\") AS \"TEMP(attr_stat_date_nk)(2102638629)(0)\",\n  MIN(\"自定义 SQL 查询\".\"stat_date\") AS \"TEMP(attr_stat_date_nk)(2790680713)(0)\",\n  \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"sum_totalUsage_ok\",\n  DATE_ADD('SECOND', 0, date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"tdy_date_ok\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211113 AND date <= 20211211 AND dim = 1) AS \"自定义 SQL 查询\"\nWHERE \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 1 AND \"自定义 SQL 查询\".\"rank_level1\" = 1\nGROUP BY 37,\n  39"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k_last\") AS \"TEMP(Calculation_3519281700083154949)(101123376)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700083154949)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700083154949)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_hdp_last\") AS \"TEMP(Calculation_3519281700083154949)(1200517625)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700083154949)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p_last\") AS \"TEMP(Calculation_3519281700083154949)(1314346200)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_hd_last\") AS \"TEMP(Calculation_3519281700083154949)(146570423)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k_last\") AS \"TEMP(Calculation_3519281700083154949)(1717771635)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio_last\") AS \"TEMP(Calculation_3519281700083154949)(2313111073)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_hdp_last\") AS \"TEMP(Calculation_3519281700083154949)(258310559)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700083154949)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_video_last\") AS \"TEMP(Calculation_3519281700083154949)(2820618408)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700083154949)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700083154949)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700083154949)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700083154949)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700083154949)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k_last\") AS \"TEMP(Calculation_3519281700083154949)(3121859593)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p_last\") AS \"TEMP(Calculation_3519281700083154949)(3222422303)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio_last\") AS \"TEMP(Calculation_3519281700083154949)(3227677803)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700083154949)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700083154949)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700083154949)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video_last\") AS \"TEMP(Calculation_3519281700083154949)(3934387163)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k_last\") AS \"TEMP(Calculation_3519281700083154949)(4055292783)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_last\") AS \"TEMP(Calculation_3519281700083154949)(4091190060)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700083154949)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_hd_last\") AS \"TEMP(Calculation_3519281700083154949)(4170367250)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_sd_last\") AS \"TEMP(Calculation_3519281700083154949)(4190307025)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700083154949)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700083154949)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700083154949)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_sd_last\") AS \"TEMP(Calculation_3519281700083154949)(933007102)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700083154949)(943764407)(0)\",\n  AVG(\"自定义 SQL 查询\".\"totalUsage\") AS \"avg_totalUsage_ok\",\n  \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"sum_totalUsage_ok\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211113 AND date <= 20211211 AND dim = 1) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n          tag,\n          area AS Scope,\n          dim,\n          level1,\n          level2,\n          level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n            CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n          total AS totalUsage,\n          audio,\n          video,\n          host_audio,\n          audience_audio,\n          host_sd,\n          host_hd,\n          host_hdp,\n          host_1080p,\n          host_2k,\n          host_4k,\n          audience_sd,\n          audience_hd,\n          audience_hdp,\n          audience_1080p,\n          audience_2k,\n          audience_4k,\n          audience_audio_low_latency,\n          audience_sd_low_latency,\n          audience_hd_low_latency,\n          audience_hdp_low_latency,\n          audience_1080p_low_latency,\n          audience_2k_low_latency,\n          audience_4k_low_latency,\n          audience_audio_ultra_low_latency,\n          audience_sd_ultra_low_latency,\n          audience_hd_ultra_low_latency,\n          audience_hdp_ultra_low_latency,\n          audience_1080p_ultra_low_latency,\n          audience_2k_ultra_low_latency,\n          audience_4k_ultra_low_latency,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n          audience_video_low_latency_last1 AS audience_video_low_latency_last,\n          audience_total_low_latency_last1 AS audience_total_low_latency_last,\n          audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n          audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n          audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n          audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n          audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n          audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n          audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n          audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n          audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n          audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n          audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n          audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n          audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n          audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n          audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n          audience_2k_last1 AS audience_2k_last,\n          audience_4k_last1 AS audience_4k_last,\n          audience_1080p_last1 AS audience_1080p_last,\n          host_1080p_last1 AS host_1080p_last,\n          host_2k_last1 AS host_2k_last,\n          host_4k_last1 AS host_4k_last,\n          total_last7,\n          audio_last7,\n          video_last7,\n          video_sd_last7,\n          video_hd_last7,\n          video_hdp_last7,\n          host_sd_last7,\n          audience_sd_last7,\n          host_hd_last7,\n          audience_hd_last7,\n          host_hdp_last7,\n          audience_hdp_last7,\n          host_audio_last7,\n          audience_audio_last7,\n          host_video_last7,\n          audience_video_last7,\n          audience_audio_low_latency_last7,\n          audience_video_low_latency_last7,\n          audience_total_low_latency_last7,\n          audience_sd_low_latency_last7,\n          audience_hd_low_latency_last7,\n          audience_hdp_low_latency_last7,\n          audience_1080p_low_latency_last7,\n          audience_2k_low_latency_last7,\n          audience_4k_low_latency_last7,\n          audience_audio_ultra_low_latency_last7,\n          audience_video_ultra_low_latency_last7,\n          audience_total_ultra_low_latency_last7,\n          audience_sd_ultra_low_latency_last7,\n          audience_hd_ultra_low_latency_last7,\n          audience_hdp_ultra_low_latency_last7,\n          audience_1080p_ultra_low_latency_last7,\n          audience_2k_ultra_low_latency_last7,\n          audience_4k_ultra_low_latency_last7,\n          audience_2k_last7,\n          audience_4k_last7,\n          audience_1080p_last7,\n          host_1080p_last7,\n          host_2k_last7,\n          host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211113 AND date <= 20211211 AND dim = 1) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 1 AND \"自定义 SQL 查询\".\"rank_level1\" = 4 AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 36"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700341563406)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio_last7\") AS \"TEMP(Calculation_3519281700341563406)(1077563395)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700341563406)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700341563406)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd_last7\") AS \"TEMP(Calculation_3519281700341563406)(1456465729)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd_last7\") AS \"TEMP(Calculation_3519281700341563406)(1635749653)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd_last7\") AS \"TEMP(Calculation_3519281700341563406)(1747046964)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k_last7\") AS \"TEMP(Calculation_3519281700341563406)(1747524570)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp_last7\") AS \"TEMP(Calculation_3519281700341563406)(2044136109)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio_last7\") AS \"TEMP(Calculation_3519281700341563406)(2464388580)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_last7\") AS \"TEMP(Calculation_3519281700341563406)(2589233512)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700341563406)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k_last7\") AS \"TEMP(Calculation_3519281700341563406)(280796653)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700341563406)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700341563406)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700341563406)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700341563406)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700341563406)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_4k_last7\") AS \"TEMP(Calculation_3519281700341563406)(3127348545)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700341563406)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"total_last7\") AS \"TEMP(Calculation_3519281700341563406)(346677966)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k_last7\") AS \"TEMP(Calculation_3519281700341563406)(3543669678)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p_last7\") AS \"TEMP(Calculation_3519281700341563406)(3624983014)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700341563406)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700341563406)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd_last7\") AS \"TEMP(Calculation_3519281700341563406)(3905372418)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video_last7\") AS \"TEMP(Calculation_3519281700341563406)(4107040267)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700341563406)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700341563406)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p_last7\") AS \"TEMP(Calculation_3519281700341563406)(632977665)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700341563406)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp_last7\") AS \"TEMP(Calculation_3519281700341563406)(750340200)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700341563406)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700341563406)(943764407)(0)\",\n  \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"audio_video_last\") AS \"sum_audio_video_last_ok\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211113 AND date <= 20211211 AND dim = 1) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n          tag,\n          area AS Scope,\n          dim,\n          level1,\n          level2,\n          level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n            CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n          total AS totalUsage,\n          audio,\n          video,\n          host_audio,\n          audience_audio,\n          host_sd,\n          host_hd,\n          host_hdp,\n          host_1080p,\n          host_2k,\n          host_4k,\n          audience_sd,\n          audience_hd,\n          audience_hdp,\n          audience_1080p,\n          audience_2k,\n          audience_4k,\n          audience_audio_low_latency,\n          audience_sd_low_latency,\n          audience_hd_low_latency,\n          audience_hdp_low_latency,\n          audience_1080p_low_latency,\n          audience_2k_low_latency,\n          audience_4k_low_latency,\n          audience_audio_ultra_low_latency,\n          audience_sd_ultra_low_latency,\n          audience_hd_ultra_low_latency,\n          audience_hdp_ultra_low_latency,\n          audience_1080p_ultra_low_latency,\n          audience_2k_ultra_low_latency,\n          audience_4k_ultra_low_latency,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n          audience_video_low_latency_last1 AS audience_video_low_latency_last,\n          audience_total_low_latency_last1 AS audience_total_low_latency_last,\n          audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n          audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n          audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n          audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n          audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n          audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n          audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n          audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n          audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n          audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n          audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n          audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n          audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n          audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n          audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n          audience_2k_last1 AS audience_2k_last,\n          audience_4k_last1 AS audience_4k_last,\n          audience_1080p_last1 AS audience_1080p_last,\n          host_1080p_last1 AS host_1080p_last,\n          host_2k_last1 AS host_2k_last,\n          host_4k_last1 AS host_4k_last,\n          total_last7,\n          audio_last7,\n          video_last7,\n          video_sd_last7,\n          video_hd_last7,\n          video_hdp_last7,\n          host_sd_last7,\n          audience_sd_last7,\n          host_hd_last7,\n          audience_hd_last7,\n          host_hdp_last7,\n          audience_hdp_last7,\n          host_audio_last7,\n          audience_audio_last7,\n          host_video_last7,\n          audience_video_last7,\n          audience_audio_low_latency_last7,\n          audience_video_low_latency_last7,\n          audience_total_low_latency_last7,\n          audience_sd_low_latency_last7,\n          audience_hd_low_latency_last7,\n          audience_hdp_low_latency_last7,\n          audience_1080p_low_latency_last7,\n          audience_2k_low_latency_last7,\n          audience_4k_low_latency_last7,\n          audience_audio_ultra_low_latency_last7,\n          audience_video_ultra_low_latency_last7,\n          audience_total_ultra_low_latency_last7,\n          audience_sd_ultra_low_latency_last7,\n          audience_hd_ultra_low_latency_last7,\n          audience_hdp_ultra_low_latency_last7,\n          audience_1080p_ultra_low_latency_last7,\n          audience_2k_ultra_low_latency_last7,\n          audience_4k_ultra_low_latency_last7,\n          audience_2k_last7,\n          audience_4k_last7,\n          audience_1080p_last7,\n          host_1080p_last7,\n          host_2k_last7,\n          host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211113 AND date <= 20211211 AND dim = 1) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 1 AND \"自定义 SQL 查询\".\"rank_level1\" = 3 AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 35"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700341563406)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio_last7\") AS \"TEMP(Calculation_3519281700341563406)(1077563395)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700341563406)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700341563406)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd_last7\") AS \"TEMP(Calculation_3519281700341563406)(1456465729)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd_last7\") AS \"TEMP(Calculation_3519281700341563406)(1635749653)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd_last7\") AS \"TEMP(Calculation_3519281700341563406)(1747046964)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k_last7\") AS \"TEMP(Calculation_3519281700341563406)(1747524570)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp_last7\") AS \"TEMP(Calculation_3519281700341563406)(2044136109)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio_last7\") AS \"TEMP(Calculation_3519281700341563406)(2464388580)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_last7\") AS \"TEMP(Calculation_3519281700341563406)(2589233512)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700341563406)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k_last7\") AS \"TEMP(Calculation_3519281700341563406)(280796653)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700341563406)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700341563406)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700341563406)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700341563406)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700341563406)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_4k_last7\") AS \"TEMP(Calculation_3519281700341563406)(3127348545)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700341563406)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"total_last7\") AS \"TEMP(Calculation_3519281700341563406)(346677966)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k_last7\") AS \"TEMP(Calculation_3519281700341563406)(3543669678)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p_last7\") AS \"TEMP(Calculation_3519281700341563406)(3624983014)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700341563406)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700341563406)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd_last7\") AS \"TEMP(Calculation_3519281700341563406)(3905372418)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video_last7\") AS \"TEMP(Calculation_3519281700341563406)(4107040267)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700341563406)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700341563406)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p_last7\") AS \"TEMP(Calculation_3519281700341563406)(632977665)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700341563406)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp_last7\") AS \"TEMP(Calculation_3519281700341563406)(750340200)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700341563406)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700341563406)(943764407)(0)\",\n  \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"audio_video_last\") AS \"sum_audio_video_last_ok\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211113 AND date <= 20211211 AND dim = 1) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n          tag,\n          area AS Scope,\n          dim,\n          level1,\n          level2,\n          level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n            CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n          total AS totalUsage,\n          audio,\n          video,\n          host_audio,\n          audience_audio,\n          host_sd,\n          host_hd,\n          host_hdp,\n          host_1080p,\n          host_2k,\n          host_4k,\n          audience_sd,\n          audience_hd,\n          audience_hdp,\n          audience_1080p,\n          audience_2k,\n          audience_4k,\n          audience_audio_low_latency,\n          audience_sd_low_latency,\n          audience_hd_low_latency,\n          audience_hdp_low_latency,\n          audience_1080p_low_latency,\n          audience_2k_low_latency,\n          audience_4k_low_latency,\n          audience_audio_ultra_low_latency,\n          audience_sd_ultra_low_latency,\n          audience_hd_ultra_low_latency,\n          audience_hdp_ultra_low_latency,\n          audience_1080p_ultra_low_latency,\n          audience_2k_ultra_low_latency,\n          audience_4k_ultra_low_latency,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n          audience_video_low_latency_last1 AS audience_video_low_latency_last,\n          audience_total_low_latency_last1 AS audience_total_low_latency_last,\n          audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n          audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n          audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n          audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n          audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n          audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n          audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n          audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n          audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n          audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n          audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n          audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n          audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n          audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n          audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n          audience_2k_last1 AS audience_2k_last,\n          audience_4k_last1 AS audience_4k_last,\n          audience_1080p_last1 AS audience_1080p_last,\n          host_1080p_last1 AS host_1080p_last,\n          host_2k_last1 AS host_2k_last,\n          host_4k_last1 AS host_4k_last,\n          total_last7,\n          audio_last7,\n          video_last7,\n          video_sd_last7,\n          video_hd_last7,\n          video_hdp_last7,\n          host_sd_last7,\n          audience_sd_last7,\n          host_hd_last7,\n          audience_hd_last7,\n          host_hdp_last7,\n          audience_hdp_last7,\n          host_audio_last7,\n          audience_audio_last7,\n          host_video_last7,\n          audience_video_last7,\n          audience_audio_low_latency_last7,\n          audience_video_low_latency_last7,\n          audience_total_low_latency_last7,\n          audience_sd_low_latency_last7,\n          audience_hd_low_latency_last7,\n          audience_hdp_low_latency_last7,\n          audience_1080p_low_latency_last7,\n          audience_2k_low_latency_last7,\n          audience_4k_low_latency_last7,\n          audience_audio_ultra_low_latency_last7,\n          audience_video_ultra_low_latency_last7,\n          audience_total_ultra_low_latency_last7,\n          audience_sd_ultra_low_latency_last7,\n          audience_hd_ultra_low_latency_last7,\n          audience_hdp_ultra_low_latency_last7,\n          audience_1080p_ultra_low_latency_last7,\n          audience_2k_ultra_low_latency_last7,\n          audience_4k_ultra_low_latency_last7,\n          audience_2k_last7,\n          audience_4k_last7,\n          audience_1080p_last7,\n          host_1080p_last7,\n          host_2k_last7,\n          host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211113 AND date <= 20211211 AND dim = 1) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 1 AND \"自定义 SQL 查询\".\"rank_level1\" = 2 AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 35"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700079370244)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700079370244)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700079370244)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700079370244)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700079370244)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700079370244)(943764407)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_4k_last\") AS \"TEMP(Calculation_3519281700083154949)(101123376)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_hdp_last\") AS \"TEMP(Calculation_3519281700083154949)(1200517625)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p_last\") AS \"TEMP(Calculation_3519281700083154949)(1314346200)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_hd_last\") AS \"TEMP(Calculation_3519281700083154949)(146570423)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k_last\") AS \"TEMP(Calculation_3519281700083154949)(1717771635)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio_last\") AS \"TEMP(Calculation_3519281700083154949)(2313111073)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_hdp_last\") AS \"TEMP(Calculation_3519281700083154949)(258310559)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_video_last\") AS \"TEMP(Calculation_3519281700083154949)(2820618408)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k_last\") AS \"TEMP(Calculation_3519281700083154949)(3121859593)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p_last\") AS \"TEMP(Calculation_3519281700083154949)(3222422303)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio_last\") AS \"TEMP(Calculation_3519281700083154949)(3227677803)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video_last\") AS \"TEMP(Calculation_3519281700083154949)(3934387163)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k_last\") AS \"TEMP(Calculation_3519281700083154949)(4055292783)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_last\") AS \"TEMP(Calculation_3519281700083154949)(4091190060)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_hd_last\") AS \"TEMP(Calculation_3519281700083154949)(4170367250)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_sd_last\") AS \"TEMP(Calculation_3519281700083154949)(4190307025)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_sd_last\") AS \"TEMP(Calculation_3519281700083154949)(933007102)(0)\",\n  AVG(\"自定义 SQL 查询\".\"totalUsage\") AS \"avg_totalUsage_ok\",\n  \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"sum_totalUsage_ok\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211113 AND date <= 20211211 AND dim = 1) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n          tag,\n          area AS Scope,\n          dim,\n          level1,\n          level2,\n          level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n            CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n          total AS totalUsage,\n          audio,\n          video,\n          host_audio,\n          audience_audio,\n          host_sd,\n          host_hd,\n          host_hdp,\n          host_1080p,\n          host_2k,\n          host_4k,\n          audience_sd,\n          audience_hd,\n          audience_hdp,\n          audience_1080p,\n          audience_2k,\n          audience_4k,\n          audience_audio_low_latency,\n          audience_sd_low_latency,\n          audience_hd_low_latency,\n          audience_hdp_low_latency,\n          audience_1080p_low_latency,\n          audience_2k_low_latency,\n          audience_4k_low_latency,\n          audience_audio_ultra_low_latency,\n          audience_sd_ultra_low_latency,\n          audience_hd_ultra_low_latency,\n          audience_hdp_ultra_low_latency,\n          audience_1080p_ultra_low_latency,\n          audience_2k_ultra_low_latency,\n          audience_4k_ultra_low_latency,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n          audience_video_low_latency_last1 AS audience_video_low_latency_last,\n          audience_total_low_latency_last1 AS audience_total_low_latency_last,\n          audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n          audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n          audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n          audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n          audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n          audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n          audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n          audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n          audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n          audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n          audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n          audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n          audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n          audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n          audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n          audience_2k_last1 AS audience_2k_last,\n          audience_4k_last1 AS audience_4k_last,\n          audience_1080p_last1 AS audience_1080p_last,\n          host_1080p_last1 AS host_1080p_last,\n          host_2k_last1 AS host_2k_last,\n          host_4k_last1 AS host_4k_last,\n          total_last7,\n          audio_last7,\n          video_last7,\n          video_sd_last7,\n          video_hd_last7,\n          video_hdp_last7,\n          host_sd_last7,\n          audience_sd_last7,\n          host_hd_last7,\n          audience_hd_last7,\n          host_hdp_last7,\n          audience_hdp_last7,\n          host_audio_last7,\n          audience_audio_last7,\n          host_video_last7,\n          audience_video_last7,\n          audience_audio_low_latency_last7,\n          audience_video_low_latency_last7,\n          audience_total_low_latency_last7,\n          audience_sd_low_latency_last7,\n          audience_hd_low_latency_last7,\n          audience_hdp_low_latency_last7,\n          audience_1080p_low_latency_last7,\n          audience_2k_low_latency_last7,\n          audience_4k_low_latency_last7,\n          audience_audio_ultra_low_latency_last7,\n          audience_video_ultra_low_latency_last7,\n          audience_total_ultra_low_latency_last7,\n          audience_sd_ultra_low_latency_last7,\n          audience_hd_ultra_low_latency_last7,\n          audience_hdp_ultra_low_latency_last7,\n          audience_1080p_ultra_low_latency_last7,\n          audience_2k_ultra_low_latency_last7,\n          audience_4k_ultra_low_latency_last7,\n          audience_2k_last7,\n          audience_4k_last7,\n          audience_1080p_last7,\n          host_1080p_last7,\n          host_2k_last7,\n          host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211113 AND date <= 20211211 AND dim = 1) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 1 AND \"自定义 SQL 查询\".\"rank_level1\" = 2 AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 36"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k_last\") AS \"TEMP(Calculation_3519281700083154949)(101123376)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700083154949)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700083154949)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_hdp_last\") AS \"TEMP(Calculation_3519281700083154949)(1200517625)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700083154949)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p_last\") AS \"TEMP(Calculation_3519281700083154949)(1314346200)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_hd_last\") AS \"TEMP(Calculation_3519281700083154949)(146570423)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k_last\") AS \"TEMP(Calculation_3519281700083154949)(1717771635)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio_last\") AS \"TEMP(Calculation_3519281700083154949)(2313111073)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_hdp_last\") AS \"TEMP(Calculation_3519281700083154949)(258310559)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700083154949)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_video_last\") AS \"TEMP(Calculation_3519281700083154949)(2820618408)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700083154949)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700083154949)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700083154949)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700083154949)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700083154949)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k_last\") AS \"TEMP(Calculation_3519281700083154949)(3121859593)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p_last\") AS \"TEMP(Calculation_3519281700083154949)(3222422303)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio_last\") AS \"TEMP(Calculation_3519281700083154949)(3227677803)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700083154949)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700083154949)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700083154949)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video_last\") AS \"TEMP(Calculation_3519281700083154949)(3934387163)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k_last\") AS \"TEMP(Calculation_3519281700083154949)(4055292783)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_last\") AS \"TEMP(Calculation_3519281700083154949)(4091190060)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700083154949)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_hd_last\") AS \"TEMP(Calculation_3519281700083154949)(4170367250)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_sd_last\") AS \"TEMP(Calculation_3519281700083154949)(4190307025)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700083154949)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700083154949)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700083154949)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_sd_last\") AS \"TEMP(Calculation_3519281700083154949)(933007102)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700083154949)(943764407)(0)\",\n  \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"audio_video_last\") AS \"sum_audio_video_last_ok\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211113 AND date <= 20211211 AND dim = 1) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n          tag,\n          area AS Scope,\n          dim,\n          level1,\n          level2,\n          level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n            CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n          total AS totalUsage,\n          audio,\n          video,\n          host_audio,\n          audience_audio,\n          host_sd,\n          host_hd,\n          host_hdp,\n          host_1080p,\n          host_2k,\n          host_4k,\n          audience_sd,\n          audience_hd,\n          audience_hdp,\n          audience_1080p,\n          audience_2k,\n          audience_4k,\n          audience_audio_low_latency,\n          audience_sd_low_latency,\n          audience_hd_low_latency,\n          audience_hdp_low_latency,\n          audience_1080p_low_latency,\n          audience_2k_low_latency,\n          audience_4k_low_latency,\n          audience_audio_ultra_low_latency,\n          audience_sd_ultra_low_latency,\n          audience_hd_ultra_low_latency,\n          audience_hdp_ultra_low_latency,\n          audience_1080p_ultra_low_latency,\n          audience_2k_ultra_low_latency,\n          audience_4k_ultra_low_latency,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n          audience_video_low_latency_last1 AS audience_video_low_latency_last,\n          audience_total_low_latency_last1 AS audience_total_low_latency_last,\n          audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n          audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n          audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n          audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n          audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n          audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n          audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n          audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n          audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n          audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n          audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n          audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n          audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n          audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n          audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n          audience_2k_last1 AS audience_2k_last,\n          audience_4k_last1 AS audience_4k_last,\n          audience_1080p_last1 AS audience_1080p_last,\n          host_1080p_last1 AS host_1080p_last,\n          host_2k_last1 AS host_2k_last,\n          host_4k_last1 AS host_4k_last,\n          total_last7,\n          audio_last7,\n          video_last7,\n          video_sd_last7,\n          video_hd_last7,\n          video_hdp_last7,\n          host_sd_last7,\n          audience_sd_last7,\n          host_hd_last7,\n          audience_hd_last7,\n          host_hdp_last7,\n          audience_hdp_last7,\n          host_audio_last7,\n          audience_audio_last7,\n          host_video_last7,\n          audience_video_last7,\n          audience_audio_low_latency_last7,\n          audience_video_low_latency_last7,\n          audience_total_low_latency_last7,\n          audience_sd_low_latency_last7,\n          audience_hd_low_latency_last7,\n          audience_hdp_low_latency_last7,\n          audience_1080p_low_latency_last7,\n          audience_2k_low_latency_last7,\n          audience_4k_low_latency_last7,\n          audience_audio_ultra_low_latency_last7,\n          audience_video_ultra_low_latency_last7,\n          audience_total_ultra_low_latency_last7,\n          audience_sd_ultra_low_latency_last7,\n          audience_hd_ultra_low_latency_last7,\n          audience_hdp_ultra_low_latency_last7,\n          audience_1080p_ultra_low_latency_last7,\n          audience_2k_ultra_low_latency_last7,\n          audience_4k_ultra_low_latency_last7,\n          audience_2k_last7,\n          audience_4k_last7,\n          audience_1080p_last7,\n          host_1080p_last7,\n          host_2k_last7,\n          host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211113 AND date <= 20211211 AND dim = 1) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 1 AND \"自定义 SQL 查询\".\"rank_level1\" = 1 AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 35"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700341563406)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio_last7\") AS \"TEMP(Calculation_3519281700341563406)(1077563395)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700341563406)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700341563406)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd_last7\") AS \"TEMP(Calculation_3519281700341563406)(1456465729)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd_last7\") AS \"TEMP(Calculation_3519281700341563406)(1635749653)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd_last7\") AS \"TEMP(Calculation_3519281700341563406)(1747046964)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k_last7\") AS \"TEMP(Calculation_3519281700341563406)(1747524570)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp_last7\") AS \"TEMP(Calculation_3519281700341563406)(2044136109)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio_last7\") AS \"TEMP(Calculation_3519281700341563406)(2464388580)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_last7\") AS \"TEMP(Calculation_3519281700341563406)(2589233512)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700341563406)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k_last7\") AS \"TEMP(Calculation_3519281700341563406)(280796653)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700341563406)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700341563406)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700341563406)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700341563406)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700341563406)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_4k_last7\") AS \"TEMP(Calculation_3519281700341563406)(3127348545)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700341563406)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"total_last7\") AS \"TEMP(Calculation_3519281700341563406)(346677966)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k_last7\") AS \"TEMP(Calculation_3519281700341563406)(3543669678)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p_last7\") AS \"TEMP(Calculation_3519281700341563406)(3624983014)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700341563406)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700341563406)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd_last7\") AS \"TEMP(Calculation_3519281700341563406)(3905372418)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video_last7\") AS \"TEMP(Calculation_3519281700341563406)(4107040267)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700341563406)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700341563406)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p_last7\") AS \"TEMP(Calculation_3519281700341563406)(632977665)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700341563406)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp_last7\") AS \"TEMP(Calculation_3519281700341563406)(750340200)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700341563406)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700341563406)(943764407)(0)\",\n  \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"audio_video_last\") AS \"sum_audio_video_last_ok\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211113 AND date <= 20211211 AND dim = 1) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n          tag,\n          area AS Scope,\n          dim,\n          level1,\n          level2,\n          level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n            CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n          total AS totalUsage,\n          audio,\n          video,\n          host_audio,\n          audience_audio,\n          host_sd,\n          host_hd,\n          host_hdp,\n          host_1080p,\n          host_2k,\n          host_4k,\n          audience_sd,\n          audience_hd,\n          audience_hdp,\n          audience_1080p,\n          audience_2k,\n          audience_4k,\n          audience_audio_low_latency,\n          audience_sd_low_latency,\n          audience_hd_low_latency,\n          audience_hdp_low_latency,\n          audience_1080p_low_latency,\n          audience_2k_low_latency,\n          audience_4k_low_latency,\n          audience_audio_ultra_low_latency,\n          audience_sd_ultra_low_latency,\n          audience_hd_ultra_low_latency,\n          audience_hdp_ultra_low_latency,\n          audience_1080p_ultra_low_latency,\n          audience_2k_ultra_low_latency,\n          audience_4k_ultra_low_latency,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n          audience_video_low_latency_last1 AS audience_video_low_latency_last,\n          audience_total_low_latency_last1 AS audience_total_low_latency_last,\n          audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n          audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n          audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n          audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n          audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n          audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n          audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n          audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n          audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n          audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n          audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n          audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n          audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n          audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n          audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n          audience_2k_last1 AS audience_2k_last,\n          audience_4k_last1 AS audience_4k_last,\n          audience_1080p_last1 AS audience_1080p_last,\n          host_1080p_last1 AS host_1080p_last,\n          host_2k_last1 AS host_2k_last,\n          host_4k_last1 AS host_4k_last,\n          total_last7,\n          audio_last7,\n          video_last7,\n          video_sd_last7,\n          video_hd_last7,\n          video_hdp_last7,\n          host_sd_last7,\n          audience_sd_last7,\n          host_hd_last7,\n          audience_hd_last7,\n          host_hdp_last7,\n          audience_hdp_last7,\n          host_audio_last7,\n          audience_audio_last7,\n          host_video_last7,\n          audience_video_last7,\n          audience_audio_low_latency_last7,\n          audience_video_low_latency_last7,\n          audience_total_low_latency_last7,\n          audience_sd_low_latency_last7,\n          audience_hd_low_latency_last7,\n          audience_hdp_low_latency_last7,\n          audience_1080p_low_latency_last7,\n          audience_2k_low_latency_last7,\n          audience_4k_low_latency_last7,\n          audience_audio_ultra_low_latency_last7,\n          audience_video_ultra_low_latency_last7,\n          audience_total_ultra_low_latency_last7,\n          audience_sd_ultra_low_latency_last7,\n          audience_hd_ultra_low_latency_last7,\n          audience_hdp_ultra_low_latency_last7,\n          audience_1080p_ultra_low_latency_last7,\n          audience_2k_ultra_low_latency_last7,\n          audience_4k_ultra_low_latency_last7,\n          audience_2k_last7,\n          audience_4k_last7,\n          audience_1080p_last7,\n          host_1080p_last7,\n          host_2k_last7,\n          host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211113 AND date <= 20211211 AND dim = 1) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 1 AND \"自定义 SQL 查询\".\"rank_level1\" = 1 AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 35"
	},
	{
		"presto_sql" : "SELECT \"自定义 SQL 查询\".\"stat_date\" AS \"stat_date\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices\/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n          tag,\n          area AS Scope,\n          dim,\n            CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,\n          level2,\n          level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n            CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices\/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,\n          total AS totalUsage,\n          audio,\n          video,\n          host_audio,\n          audience_audio,\n          host_sd,\n          host_hd,\n          host_hdp,\n          host_1080p,\n          host_2k,\n          host_4k,\n          audience_sd,\n          audience_hd,\n          audience_hdp,\n          audience_1080p,\n          audience_2k,\n          audience_4k,\n          audience_audio_low_latency,\n          audience_sd_low_latency,\n          audience_hd_low_latency,\n          audience_hdp_low_latency,\n          audience_1080p_low_latency,\n          audience_2k_low_latency,\n          audience_4k_low_latency,\n          audience_audio_ultra_low_latency,\n          audience_sd_ultra_low_latency,\n          audience_hd_ultra_low_latency,\n          audience_hdp_ultra_low_latency,\n          audience_1080p_ultra_low_latency,\n          audience_2k_ultra_low_latency,\n          audience_4k_ultra_low_latency,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n          audience_video_low_latency_last1 AS audience_video_low_latency_last,\n          audience_total_low_latency_last1 AS audience_total_low_latency_last,\n          audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n          audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n          audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n          audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n          audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n          audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n          audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n          audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n          audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n          audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n          audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n          audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n          audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n          audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n          audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n          audience_2k_last1 AS audience_2k_last,\n          audience_4k_last1 AS audience_4k_last,\n          audience_1080p_last1 AS audience_1080p_last,\n          host_1080p_last1 AS host_1080p_last,\n          host_2k_last1 AS host_2k_last,\n          host_4k_last1 AS host_4k_last,\n          total_last7,\n          audio_last7,\n          video_last7,\n          video_sd_last7,\n          video_hd_last7,\n          video_hdp_last7,\n          host_sd_last7,\n          audience_sd_last7,\n          host_hd_last7,\n          audience_hd_last7,\n          host_hdp_last7,\n          audience_hdp_last7,\n          host_audio_last7,\n          audience_audio_last7,\n          host_video_last7,\n          audience_video_last7,\n          audience_audio_low_latency_last7,\n          audience_video_low_latency_last7,\n          audience_total_low_latency_last7,\n          audience_sd_low_latency_last7,\n          audience_hd_low_latency_last7,\n          audience_hdp_low_latency_last7,\n          audience_1080p_low_latency_last7,\n          audience_2k_low_latency_last7,\n          audience_4k_low_latency_last7,\n          audience_audio_ultra_low_latency_last7,\n          audience_video_ultra_low_latency_last7,\n          audience_total_ultra_low_latency_last7,\n          audience_sd_ultra_low_latency_last7,\n          audience_hd_ultra_low_latency_last7,\n          audience_hdp_ultra_low_latency_last7,\n          audience_1080p_ultra_low_latency_last7,\n          audience_2k_ultra_low_latency_last7,\n          audience_4k_ultra_low_latency_last7,\n          audience_2k_last7,\n          audience_4k_last7,\n          audience_1080p_last7,\n          host_1080p_last7,\n          host_2k_last7,\n          host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 1"
	},
	{
		"presto_sql" : "SELECT \"自定义 SQL 查询\".\"level1\" AS \"level1\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211113 AND date <= 20211211 AND dim = 1) AS \"自定义 SQL 查询\"\nGROUP BY 1\nORDER BY \"level1\""
	},
	{
		"presto_sql" : "SELECT \"自定义 SQL 查询\".\"level2\" AS \"level2\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211113 AND date <= 20211211 AND dim = 1) AS \"自定义 SQL 查询\"\nGROUP BY 1\nORDER BY \"level2\""
	},
	{
		"presto_sql" : "SELECT \"自定义 SQL 查询\".\"level3\" AS \"level3\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"usr_Calculation_3519281700079370244_ok\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211113 AND date <= 20211211 AND dim = 1) AS \"自定义 SQL 查询\"\nWHERE \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 1\nGROUP BY 1"
	},
	{
		"presto_sql" : "SELECT \"自定义 SQL 查询\".\"level4\" AS \"level4\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"usr_Calculation_3519281700079370244_ok\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211113 AND date <= 20211211 AND dim = 1) AS \"自定义 SQL 查询\"\nWHERE \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 1 AND CAST(\"自定义 SQL 查询\".\"level3\" AS VARCHAR) = 'Framework'\nGROUP BY 1"
	},
	{
		"presto_sql" : "SELECT \"自定义 SQL 查询\".\"level2\" AS \"level2\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"usr_Calculation_3519281700079370244_ok\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211113 AND date <= 20211211 AND dim = 1) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n          tag,\n          area AS Scope,\n          dim,\n          level1,\n          level2,\n          level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n            CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n          total AS totalUsage,\n          audio,\n          video,\n          host_audio,\n          audience_audio,\n          host_sd,\n          host_hd,\n          host_hdp,\n          host_1080p,\n          host_2k,\n          host_4k,\n          audience_sd,\n          audience_hd,\n          audience_hdp,\n          audience_1080p,\n          audience_2k,\n          audience_4k,\n          audience_audio_low_latency,\n          audience_sd_low_latency,\n          audience_hd_low_latency,\n          audience_hdp_low_latency,\n          audience_1080p_low_latency,\n          audience_2k_low_latency,\n          audience_4k_low_latency,\n          audience_audio_ultra_low_latency,\n          audience_sd_ultra_low_latency,\n          audience_hd_ultra_low_latency,\n          audience_hdp_ultra_low_latency,\n          audience_1080p_ultra_low_latency,\n          audience_2k_ultra_low_latency,\n          audience_4k_ultra_low_latency,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n          audience_video_low_latency_last1 AS audience_video_low_latency_last,\n          audience_total_low_latency_last1 AS audience_total_low_latency_last,\n          audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n          audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n          audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n          audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n          audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n          audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n          audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n          audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n          audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n          audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n          audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n          audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n          audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n          audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n          audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n          audience_2k_last1 AS audience_2k_last,\n          audience_4k_last1 AS audience_4k_last,\n          audience_1080p_last1 AS audience_1080p_last,\n          host_1080p_last1 AS host_1080p_last,\n          host_2k_last1 AS host_2k_last,\n          host_4k_last1 AS host_4k_last,\n          total_last7,\n          audio_last7,\n          video_last7,\n          video_sd_last7,\n          video_hd_last7,\n          video_hdp_last7,\n          host_sd_last7,\n          audience_sd_last7,\n          host_hd_last7,\n          audience_hd_last7,\n          host_hdp_last7,\n          audience_hdp_last7,\n          host_audio_last7,\n          audience_audio_last7,\n          host_video_last7,\n          audience_video_last7,\n          audience_audio_low_latency_last7,\n          audience_video_low_latency_last7,\n          audience_total_low_latency_last7,\n          audience_sd_low_latency_last7,\n          audience_hd_low_latency_last7,\n          audience_hdp_low_latency_last7,\n          audience_1080p_low_latency_last7,\n          audience_2k_low_latency_last7,\n          audience_4k_low_latency_last7,\n          audience_audio_ultra_low_latency_last7,\n          audience_video_ultra_low_latency_last7,\n          audience_total_ultra_low_latency_last7,\n          audience_sd_ultra_low_latency_last7,\n          audience_hd_ultra_low_latency_last7,\n          audience_hdp_ultra_low_latency_last7,\n          audience_1080p_ultra_low_latency_last7,\n          audience_2k_ultra_low_latency_last7,\n          audience_4k_ultra_low_latency_last7,\n          audience_2k_last7,\n          audience_4k_last7,\n          audience_1080p_last7,\n          host_1080p_last7,\n          host_2k_last7,\n          host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211113 AND date <= 20211211 AND dim = 1) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 1 AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 1"
	},
	{
		"presto_sql" : "SELECT \"自定义 SQL 查询\".\"level4\" AS \"level4\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"usr_Calculation_3519281700079370244_ok\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211113 AND date <= 20211211 AND dim = 1) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n          tag,\n          area AS Scope,\n          dim,\n          level1,\n          level2,\n          level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n            CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n          total AS totalUsage,\n          audio,\n          video,\n          host_audio,\n          audience_audio,\n          host_sd,\n          host_hd,\n          host_hdp,\n          host_1080p,\n          host_2k,\n          host_4k,\n          audience_sd,\n          audience_hd,\n          audience_hdp,\n          audience_1080p,\n          audience_2k,\n          audience_4k,\n          audience_audio_low_latency,\n          audience_sd_low_latency,\n          audience_hd_low_latency,\n          audience_hdp_low_latency,\n          audience_1080p_low_latency,\n          audience_2k_low_latency,\n          audience_4k_low_latency,\n          audience_audio_ultra_low_latency,\n          audience_sd_ultra_low_latency,\n          audience_hd_ultra_low_latency,\n          audience_hdp_ultra_low_latency,\n          audience_1080p_ultra_low_latency,\n          audience_2k_ultra_low_latency,\n          audience_4k_ultra_low_latency,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n          audience_video_low_latency_last1 AS audience_video_low_latency_last,\n          audience_total_low_latency_last1 AS audience_total_low_latency_last,\n          audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n          audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n          audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n          audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n          audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n          audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n          audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n          audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n          audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n          audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n          audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n          audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n          audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n          audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n          audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n          audience_2k_last1 AS audience_2k_last,\n          audience_4k_last1 AS audience_4k_last,\n          audience_1080p_last1 AS audience_1080p_last,\n          host_1080p_last1 AS host_1080p_last,\n          host_2k_last1 AS host_2k_last,\n          host_4k_last1 AS host_4k_last,\n          total_last7,\n          audio_last7,\n          video_last7,\n          video_sd_last7,\n          video_hd_last7,\n          video_hdp_last7,\n          host_sd_last7,\n          audience_sd_last7,\n          host_hd_last7,\n          audience_hd_last7,\n          host_hdp_last7,\n          audience_hdp_last7,\n          host_audio_last7,\n          audience_audio_last7,\n          host_video_last7,\n          audience_video_last7,\n          audience_audio_low_latency_last7,\n          audience_video_low_latency_last7,\n          audience_total_low_latency_last7,\n          audience_sd_low_latency_last7,\n          audience_hd_low_latency_last7,\n          audience_hdp_low_latency_last7,\n          audience_1080p_low_latency_last7,\n          audience_2k_low_latency_last7,\n          audience_4k_low_latency_last7,\n          audience_audio_ultra_low_latency_last7,\n          audience_video_ultra_low_latency_last7,\n          audience_total_ultra_low_latency_last7,\n          audience_sd_ultra_low_latency_last7,\n          audience_hd_ultra_low_latency_last7,\n          audience_hdp_ultra_low_latency_last7,\n          audience_1080p_ultra_low_latency_last7,\n          audience_2k_ultra_low_latency_last7,\n          audience_4k_ultra_low_latency_last7,\n          audience_2k_last7,\n          audience_4k_last7,\n          audience_1080p_last7,\n          host_1080p_last7,\n          host_2k_last7,\n          host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211113 AND date <= 20211211 AND dim = 1) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 1 AND CAST(\"自定义 SQL 查询\".\"level3\" AS VARCHAR) = 'Framework' AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 1"
	},
	{
		"presto_sql" : "SELECT \"自定义 SQL 查询\".\"level3\" AS \"level3\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"usr_Calculation_3519281700079370244_ok\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211113 AND date <= 20211211 AND dim = 1) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n          tag,\n          area AS Scope,\n          dim,\n          level1,\n          level2,\n          level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n            CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n          total AS totalUsage,\n          audio,\n          video,\n          host_audio,\n          audience_audio,\n          host_sd,\n          host_hd,\n          host_hdp,\n          host_1080p,\n          host_2k,\n          host_4k,\n          audience_sd,\n          audience_hd,\n          audience_hdp,\n          audience_1080p,\n          audience_2k,\n          audience_4k,\n          audience_audio_low_latency,\n          audience_sd_low_latency,\n          audience_hd_low_latency,\n          audience_hdp_low_latency,\n          audience_1080p_low_latency,\n          audience_2k_low_latency,\n          audience_4k_low_latency,\n          audience_audio_ultra_low_latency,\n          audience_sd_ultra_low_latency,\n          audience_hd_ultra_low_latency,\n          audience_hdp_ultra_low_latency,\n          audience_1080p_ultra_low_latency,\n          audience_2k_ultra_low_latency,\n          audience_4k_ultra_low_latency,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n          audience_video_low_latency_last1 AS audience_video_low_latency_last,\n          audience_total_low_latency_last1 AS audience_total_low_latency_last,\n          audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n          audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n          audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n          audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n          audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n          audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n          audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n          audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n          audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n          audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n          audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n          audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n          audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n          audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n          audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n          audience_2k_last1 AS audience_2k_last,\n          audience_4k_last1 AS audience_4k_last,\n          audience_1080p_last1 AS audience_1080p_last,\n          host_1080p_last1 AS host_1080p_last,\n          host_2k_last1 AS host_2k_last,\n          host_4k_last1 AS host_4k_last,\n          total_last7,\n          audio_last7,\n          video_last7,\n          video_sd_last7,\n          video_hd_last7,\n          video_hdp_last7,\n          host_sd_last7,\n          audience_sd_last7,\n          host_hd_last7,\n          audience_hd_last7,\n          host_hdp_last7,\n          audience_hdp_last7,\n          host_audio_last7,\n          audience_audio_last7,\n          host_video_last7,\n          audience_video_last7,\n          audience_audio_low_latency_last7,\n          audience_video_low_latency_last7,\n          audience_total_low_latency_last7,\n          audience_sd_low_latency_last7,\n          audience_hd_low_latency_last7,\n          audience_hdp_low_latency_last7,\n          audience_1080p_low_latency_last7,\n          audience_2k_low_latency_last7,\n          audience_4k_low_latency_last7,\n          audience_audio_ultra_low_latency_last7,\n          audience_video_ultra_low_latency_last7,\n          audience_total_ultra_low_latency_last7,\n          audience_sd_ultra_low_latency_last7,\n          audience_hd_ultra_low_latency_last7,\n          audience_hdp_ultra_low_latency_last7,\n          audience_1080p_ultra_low_latency_last7,\n          audience_2k_ultra_low_latency_last7,\n          audience_4k_ultra_low_latency_last7,\n          audience_2k_last7,\n          audience_4k_last7,\n          audience_1080p_last7,\n          host_1080p_last7,\n          host_2k_last7,\n          host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211113 AND date <= 20211211 AND dim = 1) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"Scope\" IN ('China', 'Not China') AND \"自定义 SQL 查询\".\"dim\" = 1 AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 1"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700079370244)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700079370244)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700079370244)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700079370244)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700079370244)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700079370244)(943764407)(0)\",\n  MIN(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(1482809429)(0)\",\n  MAX(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(3765460736)(0)\",\n  MAX(\"自定义 SQL 查询\".\"stat_date\") AS \"TEMP(attr_stat_date_nk)(2102638629)(0)\",\n  MIN(\"自定义 SQL 查询\".\"stat_date\") AS \"TEMP(attr_stat_date_nk)(2790680713)(0)\",\n  \"自定义 SQL 查询\".\"level2\" AS \"level2\",\n  DATE_ADD('SECOND', 0, date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"tdy_date_ok\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices\/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1\nGROUP BY 22,\n  23"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700079370244)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700079370244)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700079370244)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700079370244)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700079370244)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700079370244)(943764407)(0)\",\n  \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"sum_totalUsage_ok\",\n  DATE_ADD('SECOND', 0, date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"tdy_date_ok\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices\/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n          tag,\n          area AS Scope,\n          dim,\n            CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,\n          level2,\n          level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n            CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices\/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,\n          total AS totalUsage,\n          audio,\n          video,\n          host_audio,\n          audience_audio,\n          host_sd,\n          host_hd,\n          host_hdp,\n          host_1080p,\n          host_2k,\n          host_4k,\n          audience_sd,\n          audience_hd,\n          audience_hdp,\n          audience_1080p,\n          audience_2k,\n          audience_4k,\n          audience_audio_low_latency,\n          audience_sd_low_latency,\n          audience_hd_low_latency,\n          audience_hdp_low_latency,\n          audience_1080p_low_latency,\n          audience_2k_low_latency,\n          audience_4k_low_latency,\n          audience_audio_ultra_low_latency,\n          audience_sd_ultra_low_latency,\n          audience_hd_ultra_low_latency,\n          audience_hdp_ultra_low_latency,\n          audience_1080p_ultra_low_latency,\n          audience_2k_ultra_low_latency,\n          audience_4k_ultra_low_latency,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n          audience_video_low_latency_last1 AS audience_video_low_latency_last,\n          audience_total_low_latency_last1 AS audience_total_low_latency_last,\n          audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n          audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n          audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n          audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n          audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n          audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n          audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n          audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n          audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n          audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n          audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n          audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n          audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n          audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n          audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n          audience_2k_last1 AS audience_2k_last,\n          audience_4k_last1 AS audience_4k_last,\n          audience_1080p_last1 AS audience_1080p_last,\n          host_1080p_last1 AS host_1080p_last,\n          host_2k_last1 AS host_2k_last,\n          host_4k_last1 AS host_4k_last,\n          total_last7,\n          audio_last7,\n          video_last7,\n          video_sd_last7,\n          video_hd_last7,\n          video_hdp_last7,\n          host_sd_last7,\n          audience_sd_last7,\n          host_hd_last7,\n          audience_hd_last7,\n          host_hdp_last7,\n          audience_hdp_last7,\n          host_audio_last7,\n          audience_audio_last7,\n          host_video_last7,\n          audience_video_last7,\n          audience_audio_low_latency_last7,\n          audience_video_low_latency_last7,\n          audience_total_low_latency_last7,\n          audience_sd_low_latency_last7,\n          audience_hd_low_latency_last7,\n          audience_hdp_low_latency_last7,\n          audience_1080p_low_latency_last7,\n          audience_2k_low_latency_last7,\n          audience_4k_low_latency_last7,\n          audience_audio_ultra_low_latency_last7,\n          audience_video_ultra_low_latency_last7,\n          audience_total_ultra_low_latency_last7,\n          audience_sd_ultra_low_latency_last7,\n          audience_hd_ultra_low_latency_last7,\n          audience_hdp_ultra_low_latency_last7,\n          audience_1080p_ultra_low_latency_last7,\n          audience_2k_ultra_low_latency_last7,\n          audience_4k_ultra_low_latency_last7,\n          audience_2k_last7,\n          audience_4k_last7,\n          audience_1080p_last7,\n          host_1080p_last7,\n          host_2k_last7,\n          host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND \"自定义 SQL 查询\".\"rank_level1\" = 3 AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 18,\n  20"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700079370244)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700079370244)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700079370244)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700079370244)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700079370244)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700079370244)(943764407)(0)\",\n  MIN(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(1482809429)(0)\",\n  MAX(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(3765460736)(0)\",\n  MAX(\"自定义 SQL 查询\".\"stat_date\") AS \"TEMP(attr_stat_date_nk)(2102638629)(0)\",\n  MIN(\"自定义 SQL 查询\".\"stat_date\") AS \"TEMP(attr_stat_date_nk)(2790680713)(0)\",\n  \"自定义 SQL 查询\".\"level3\" AS \"level3\",\n  DATE_ADD('SECOND', 0, date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"tdy_date_ok\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices\/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1\nGROUP BY 22,\n  23"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700079370244)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700079370244)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700079370244)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700079370244)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700079370244)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700079370244)(943764407)(0)\",\n  \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"sum_totalUsage_ok\",\n  DATE_ADD('SECOND', 0, date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"tdy_date_ok\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices\/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n          tag,\n          area AS Scope,\n          dim,\n            CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,\n          level2,\n          level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n            CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices\/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,\n          total AS totalUsage,\n          audio,\n          video,\n          host_audio,\n          audience_audio,\n          host_sd,\n          host_hd,\n          host_hdp,\n          host_1080p,\n          host_2k,\n          host_4k,\n          audience_sd,\n          audience_hd,\n          audience_hdp,\n          audience_1080p,\n          audience_2k,\n          audience_4k,\n          audience_audio_low_latency,\n          audience_sd_low_latency,\n          audience_hd_low_latency,\n          audience_hdp_low_latency,\n          audience_1080p_low_latency,\n          audience_2k_low_latency,\n          audience_4k_low_latency,\n          audience_audio_ultra_low_latency,\n          audience_sd_ultra_low_latency,\n          audience_hd_ultra_low_latency,\n          audience_hdp_ultra_low_latency,\n          audience_1080p_ultra_low_latency,\n          audience_2k_ultra_low_latency,\n          audience_4k_ultra_low_latency,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n          audience_video_low_latency_last1 AS audience_video_low_latency_last,\n          audience_total_low_latency_last1 AS audience_total_low_latency_last,\n          audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n          audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n          audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n          audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n          audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n          audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n          audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n          audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n          audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n          audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n          audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n          audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n          audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n          audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n          audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n          audience_2k_last1 AS audience_2k_last,\n          audience_4k_last1 AS audience_4k_last,\n          audience_1080p_last1 AS audience_1080p_last,\n          host_1080p_last1 AS host_1080p_last,\n          host_2k_last1 AS host_2k_last,\n          host_4k_last1 AS host_4k_last,\n          total_last7,\n          audio_last7,\n          video_last7,\n          video_sd_last7,\n          video_hd_last7,\n          video_hdp_last7,\n          host_sd_last7,\n          audience_sd_last7,\n          host_hd_last7,\n          audience_hd_last7,\n          host_hdp_last7,\n          audience_hdp_last7,\n          host_audio_last7,\n          audience_audio_last7,\n          host_video_last7,\n          audience_video_last7,\n          audience_audio_low_latency_last7,\n          audience_video_low_latency_last7,\n          audience_total_low_latency_last7,\n          audience_sd_low_latency_last7,\n          audience_hd_low_latency_last7,\n          audience_hdp_low_latency_last7,\n          audience_1080p_low_latency_last7,\n          audience_2k_low_latency_last7,\n          audience_4k_low_latency_last7,\n          audience_audio_ultra_low_latency_last7,\n          audience_video_ultra_low_latency_last7,\n          audience_total_ultra_low_latency_last7,\n          audience_sd_ultra_low_latency_last7,\n          audience_hd_ultra_low_latency_last7,\n          audience_hdp_ultra_low_latency_last7,\n          audience_1080p_ultra_low_latency_last7,\n          audience_2k_ultra_low_latency_last7,\n          audience_4k_ultra_low_latency_last7,\n          audience_2k_last7,\n          audience_4k_last7,\n          audience_1080p_last7,\n          host_1080p_last7,\n          host_2k_last7,\n          host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND \"自定义 SQL 查询\".\"rank_level1\" = 6 AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 18,\n  20"
	},
	{
		"presto_sql" : "SELECT \"自定义 SQL 查询\".\"level3\" AS \"level3\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211113 AND date <= 20211211 AND dim = 1) AS \"自定义 SQL 查询\"\nGROUP BY 1\nORDER BY \"level3\""
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700079370244)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700079370244)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700079370244)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700079370244)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700079370244)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700079370244)(943764407)(0)\",\n  \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"sum_totalUsage_ok\",\n  DATE_ADD('SECOND', 0, date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"tdy_date_ok\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices\/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n          tag,\n          area AS Scope,\n          dim,\n            CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,\n          level2,\n          level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n            CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices\/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,\n          total AS totalUsage,\n          audio,\n          video,\n          host_audio,\n          audience_audio,\n          host_sd,\n          host_hd,\n          host_hdp,\n          host_1080p,\n          host_2k,\n          host_4k,\n          audience_sd,\n          audience_hd,\n          audience_hdp,\n          audience_1080p,\n          audience_2k,\n          audience_4k,\n          audience_audio_low_latency,\n          audience_sd_low_latency,\n          audience_hd_low_latency,\n          audience_hdp_low_latency,\n          audience_1080p_low_latency,\n          audience_2k_low_latency,\n          audience_4k_low_latency,\n          audience_audio_ultra_low_latency,\n          audience_sd_ultra_low_latency,\n          audience_hd_ultra_low_latency,\n          audience_hdp_ultra_low_latency,\n          audience_1080p_ultra_low_latency,\n          audience_2k_ultra_low_latency,\n          audience_4k_ultra_low_latency,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n          audience_video_low_latency_last1 AS audience_video_low_latency_last,\n          audience_total_low_latency_last1 AS audience_total_low_latency_last,\n          audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n          audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n          audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n          audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n          audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n          audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n          audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n          audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n          audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n          audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n          audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n          audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n          audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n          audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n          audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n          audience_2k_last1 AS audience_2k_last,\n          audience_4k_last1 AS audience_4k_last,\n          audience_1080p_last1 AS audience_1080p_last,\n          host_1080p_last1 AS host_1080p_last,\n          host_2k_last1 AS host_2k_last,\n          host_4k_last1 AS host_4k_last,\n          total_last7,\n          audio_last7,\n          video_last7,\n          video_sd_last7,\n          video_hd_last7,\n          video_hdp_last7,\n          host_sd_last7,\n          audience_sd_last7,\n          host_hd_last7,\n          audience_hd_last7,\n          host_hdp_last7,\n          audience_hdp_last7,\n          host_audio_last7,\n          audience_audio_last7,\n          host_video_last7,\n          audience_video_last7,\n          audience_audio_low_latency_last7,\n          audience_video_low_latency_last7,\n          audience_total_low_latency_last7,\n          audience_sd_low_latency_last7,\n          audience_hd_low_latency_last7,\n          audience_hdp_low_latency_last7,\n          audience_1080p_low_latency_last7,\n          audience_2k_low_latency_last7,\n          audience_4k_low_latency_last7,\n          audience_audio_ultra_low_latency_last7,\n          audience_video_ultra_low_latency_last7,\n          audience_total_ultra_low_latency_last7,\n          audience_sd_ultra_low_latency_last7,\n          audience_hd_ultra_low_latency_last7,\n          audience_hdp_ultra_low_latency_last7,\n          audience_1080p_ultra_low_latency_last7,\n          audience_2k_ultra_low_latency_last7,\n          audience_4k_ultra_low_latency_last7,\n          audience_2k_last7,\n          audience_4k_last7,\n          audience_1080p_last7,\n          host_1080p_last7,\n          host_2k_last7,\n          host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND \"自定义 SQL 查询\".\"rank_level1\" = 5 AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 18,\n  20"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700079370244)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700079370244)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700079370244)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700079370244)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700079370244)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700079370244)(943764407)(0)\",\n  MAX(\"自定义 SQL 查询\".\"rank_level1\") AS \"TEMP(attr_rank_level1_qk)(289677037)(0)\",\n  MIN(\"自定义 SQL 查询\".\"rank_level1\") AS \"TEMP(attr_rank_level1_qk)(992764851)(0)\",\n  \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  \"自定义 SQL 查询\".\"stat_date\" AS \"stat_date\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"sum_totalUsage_ok\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices\/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n          tag,\n          area AS Scope,\n          dim,\n            CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,\n          level2,\n          level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n            CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices\/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,\n          total AS totalUsage,\n          audio,\n          video,\n          host_audio,\n          audience_audio,\n          host_sd,\n          host_hd,\n          host_hdp,\n          host_1080p,\n          host_2k,\n          host_4k,\n          audience_sd,\n          audience_hd,\n          audience_hdp,\n          audience_1080p,\n          audience_2k,\n          audience_4k,\n          audience_audio_low_latency,\n          audience_sd_low_latency,\n          audience_hd_low_latency,\n          audience_hdp_low_latency,\n          audience_1080p_low_latency,\n          audience_2k_low_latency,\n          audience_4k_low_latency,\n          audience_audio_ultra_low_latency,\n          audience_sd_ultra_low_latency,\n          audience_hd_ultra_low_latency,\n          audience_hdp_ultra_low_latency,\n          audience_1080p_ultra_low_latency,\n          audience_2k_ultra_low_latency,\n          audience_4k_ultra_low_latency,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n          audience_video_low_latency_last1 AS audience_video_low_latency_last,\n          audience_total_low_latency_last1 AS audience_total_low_latency_last,\n          audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n          audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n          audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n          audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n          audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n          audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n          audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n          audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n          audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n          audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n          audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n          audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n          audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n          audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n          audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n          audience_2k_last1 AS audience_2k_last,\n          audience_4k_last1 AS audience_4k_last,\n          audience_1080p_last1 AS audience_1080p_last,\n          host_1080p_last1 AS host_1080p_last,\n          host_2k_last1 AS host_2k_last,\n          host_4k_last1 AS host_4k_last,\n          total_last7,\n          audio_last7,\n          video_last7,\n          video_sd_last7,\n          video_hd_last7,\n          video_hdp_last7,\n          host_sd_last7,\n          audience_sd_last7,\n          host_hd_last7,\n          audience_hd_last7,\n          host_hdp_last7,\n          audience_hdp_last7,\n          host_audio_last7,\n          audience_audio_last7,\n          host_video_last7,\n          audience_video_last7,\n          audience_audio_low_latency_last7,\n          audience_video_low_latency_last7,\n          audience_total_low_latency_last7,\n          audience_sd_low_latency_last7,\n          audience_hd_low_latency_last7,\n          audience_hdp_low_latency_last7,\n          audience_1080p_low_latency_last7,\n          audience_2k_low_latency_last7,\n          audience_4k_low_latency_last7,\n          audience_audio_ultra_low_latency_last7,\n          audience_video_ultra_low_latency_last7,\n          audience_total_ultra_low_latency_last7,\n          audience_sd_ultra_low_latency_last7,\n          audience_hd_ultra_low_latency_last7,\n          audience_hdp_ultra_low_latency_last7,\n          audience_1080p_ultra_low_latency_last7,\n          audience_2k_ultra_low_latency_last7,\n          audience_4k_ultra_low_latency_last7,\n          audience_2k_last7,\n          audience_4k_last7,\n          audience_1080p_last7,\n          host_1080p_last7,\n          host_2k_last7,\n          host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 20,\n  21"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700079370244)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700079370244)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700079370244)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700079370244)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700079370244)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700079370244)(943764407)(0)\",\n  \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"sum_totalUsage_ok\",\n  DATE_ADD('SECOND', 0, date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"tdy_date_ok\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices\/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n          tag,\n          area AS Scope,\n          dim,\n            CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,\n          level2,\n          level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n            CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices\/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,\n          total AS totalUsage,\n          audio,\n          video,\n          host_audio,\n          audience_audio,\n          host_sd,\n          host_hd,\n          host_hdp,\n          host_1080p,\n          host_2k,\n          host_4k,\n          audience_sd,\n          audience_hd,\n          audience_hdp,\n          audience_1080p,\n          audience_2k,\n          audience_4k,\n          audience_audio_low_latency,\n          audience_sd_low_latency,\n          audience_hd_low_latency,\n          audience_hdp_low_latency,\n          audience_1080p_low_latency,\n          audience_2k_low_latency,\n          audience_4k_low_latency,\n          audience_audio_ultra_low_latency,\n          audience_sd_ultra_low_latency,\n          audience_hd_ultra_low_latency,\n          audience_hdp_ultra_low_latency,\n          audience_1080p_ultra_low_latency,\n          audience_2k_ultra_low_latency,\n          audience_4k_ultra_low_latency,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n          audience_video_low_latency_last1 AS audience_video_low_latency_last,\n          audience_total_low_latency_last1 AS audience_total_low_latency_last,\n          audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n          audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n          audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n          audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n          audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n          audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n          audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n          audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n          audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n          audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n          audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n          audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n          audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n          audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n          audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n          audience_2k_last1 AS audience_2k_last,\n          audience_4k_last1 AS audience_4k_last,\n          audience_1080p_last1 AS audience_1080p_last,\n          host_1080p_last1 AS host_1080p_last,\n          host_2k_last1 AS host_2k_last,\n          host_4k_last1 AS host_4k_last,\n          total_last7,\n          audio_last7,\n          video_last7,\n          video_sd_last7,\n          video_hd_last7,\n          video_hdp_last7,\n          host_sd_last7,\n          audience_sd_last7,\n          host_hd_last7,\n          audience_hd_last7,\n          host_hdp_last7,\n          audience_hdp_last7,\n          host_audio_last7,\n          audience_audio_last7,\n          host_video_last7,\n          audience_video_last7,\n          audience_audio_low_latency_last7,\n          audience_video_low_latency_last7,\n          audience_total_low_latency_last7,\n          audience_sd_low_latency_last7,\n          audience_hd_low_latency_last7,\n          audience_hdp_low_latency_last7,\n          audience_1080p_low_latency_last7,\n          audience_2k_low_latency_last7,\n          audience_4k_low_latency_last7,\n          audience_audio_ultra_low_latency_last7,\n          audience_video_ultra_low_latency_last7,\n          audience_total_ultra_low_latency_last7,\n          audience_sd_ultra_low_latency_last7,\n          audience_hd_ultra_low_latency_last7,\n          audience_hdp_ultra_low_latency_last7,\n          audience_1080p_ultra_low_latency_last7,\n          audience_2k_ultra_low_latency_last7,\n          audience_4k_ultra_low_latency_last7,\n          audience_2k_last7,\n          audience_4k_last7,\n          audience_1080p_last7,\n          host_1080p_last7,\n          host_2k_last7,\n          host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND \"自定义 SQL 查询\".\"rank_level1\" = 7 AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 18,\n  20"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700079370244)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700079370244)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700079370244)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700079370244)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700079370244)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700079370244)(943764407)(0)\",\n  \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"sum_totalUsage_ok\",\n  DATE_ADD('SECOND', 0, date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"tdy_date_ok\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices\/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n          tag,\n          area AS Scope,\n          dim,\n            CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,\n          level2,\n          level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n            CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices\/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,\n          total AS totalUsage,\n          audio,\n          video,\n          host_audio,\n          audience_audio,\n          host_sd,\n          host_hd,\n          host_hdp,\n          host_1080p,\n          host_2k,\n          host_4k,\n          audience_sd,\n          audience_hd,\n          audience_hdp,\n          audience_1080p,\n          audience_2k,\n          audience_4k,\n          audience_audio_low_latency,\n          audience_sd_low_latency,\n          audience_hd_low_latency,\n          audience_hdp_low_latency,\n          audience_1080p_low_latency,\n          audience_2k_low_latency,\n          audience_4k_low_latency,\n          audience_audio_ultra_low_latency,\n          audience_sd_ultra_low_latency,\n          audience_hd_ultra_low_latency,\n          audience_hdp_ultra_low_latency,\n          audience_1080p_ultra_low_latency,\n          audience_2k_ultra_low_latency,\n          audience_4k_ultra_low_latency,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n          audience_video_low_latency_last1 AS audience_video_low_latency_last,\n          audience_total_low_latency_last1 AS audience_total_low_latency_last,\n          audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n          audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n          audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n          audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n          audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n          audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n          audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n          audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n          audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n          audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n          audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n          audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n          audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n          audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n          audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n          audience_2k_last1 AS audience_2k_last,\n          audience_4k_last1 AS audience_4k_last,\n          audience_1080p_last1 AS audience_1080p_last,\n          host_1080p_last1 AS host_1080p_last,\n          host_2k_last1 AS host_2k_last,\n          host_4k_last1 AS host_4k_last,\n          total_last7,\n          audio_last7,\n          video_last7,\n          video_sd_last7,\n          video_hd_last7,\n          video_hdp_last7,\n          host_sd_last7,\n          audience_sd_last7,\n          host_hd_last7,\n          audience_hd_last7,\n          host_hdp_last7,\n          audience_hdp_last7,\n          host_audio_last7,\n          audience_audio_last7,\n          host_video_last7,\n          audience_video_last7,\n          audience_audio_low_latency_last7,\n          audience_video_low_latency_last7,\n          audience_total_low_latency_last7,\n          audience_sd_low_latency_last7,\n          audience_hd_low_latency_last7,\n          audience_hdp_low_latency_last7,\n          audience_1080p_low_latency_last7,\n          audience_2k_low_latency_last7,\n          audience_4k_low_latency_last7,\n          audience_audio_ultra_low_latency_last7,\n          audience_video_ultra_low_latency_last7,\n          audience_total_ultra_low_latency_last7,\n          audience_sd_ultra_low_latency_last7,\n          audience_hd_ultra_low_latency_last7,\n          audience_hdp_ultra_low_latency_last7,\n          audience_1080p_ultra_low_latency_last7,\n          audience_2k_ultra_low_latency_last7,\n          audience_4k_ultra_low_latency_last7,\n          audience_2k_last7,\n          audience_4k_last7,\n          audience_1080p_last7,\n          host_1080p_last7,\n          host_2k_last7,\n          host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND \"自定义 SQL 查询\".\"rank_level1\" = 4 AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 18,\n  20"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700079370244)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700079370244)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700079370244)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700079370244)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700079370244)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700079370244)(943764407)(0)\",\n  MIN(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(1482809429)(0)\",\n  MAX(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(3765460736)(0)\",\n  \"自定义 SQL 查询\".\"level2\" AS \"level2\",\n  \"自定义 SQL 查询\".\"stat_date\" AS \"stat_date\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices\/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n          tag,\n          area AS Scope,\n          dim,\n            CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,\n          level2,\n          level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n            CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices\/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,\n          total AS totalUsage,\n          audio,\n          video,\n          host_audio,\n          audience_audio,\n          host_sd,\n          host_hd,\n          host_hdp,\n          host_1080p,\n          host_2k,\n          host_4k,\n          audience_sd,\n          audience_hd,\n          audience_hdp,\n          audience_1080p,\n          audience_2k,\n          audience_4k,\n          audience_audio_low_latency,\n          audience_sd_low_latency,\n          audience_hd_low_latency,\n          audience_hdp_low_latency,\n          audience_1080p_low_latency,\n          audience_2k_low_latency,\n          audience_4k_low_latency,\n          audience_audio_ultra_low_latency,\n          audience_sd_ultra_low_latency,\n          audience_hd_ultra_low_latency,\n          audience_hdp_ultra_low_latency,\n          audience_1080p_ultra_low_latency,\n          audience_2k_ultra_low_latency,\n          audience_4k_ultra_low_latency,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n          audience_video_low_latency_last1 AS audience_video_low_latency_last,\n          audience_total_low_latency_last1 AS audience_total_low_latency_last,\n          audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n          audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n          audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n          audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n          audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n          audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n          audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n          audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n          audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n          audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n          audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n          audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n          audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n          audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n          audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n          audience_2k_last1 AS audience_2k_last,\n          audience_4k_last1 AS audience_4k_last,\n          audience_1080p_last1 AS audience_1080p_last,\n          host_1080p_last1 AS host_1080p_last,\n          host_2k_last1 AS host_2k_last,\n          host_4k_last1 AS host_4k_last,\n          total_last7,\n          audio_last7,\n          video_last7,\n          video_sd_last7,\n          video_hd_last7,\n          video_hdp_last7,\n          host_sd_last7,\n          audience_sd_last7,\n          host_hd_last7,\n          audience_hd_last7,\n          host_hdp_last7,\n          audience_hdp_last7,\n          host_audio_last7,\n          audience_audio_last7,\n          host_video_last7,\n          audience_video_last7,\n          audience_audio_low_latency_last7,\n          audience_video_low_latency_last7,\n          audience_total_low_latency_last7,\n          audience_sd_low_latency_last7,\n          audience_hd_low_latency_last7,\n          audience_hdp_low_latency_last7,\n          audience_1080p_low_latency_last7,\n          audience_2k_low_latency_last7,\n          audience_4k_low_latency_last7,\n          audience_audio_ultra_low_latency_last7,\n          audience_video_ultra_low_latency_last7,\n          audience_total_ultra_low_latency_last7,\n          audience_sd_ultra_low_latency_last7,\n          audience_hd_ultra_low_latency_last7,\n          audience_hdp_ultra_low_latency_last7,\n          audience_1080p_ultra_low_latency_last7,\n          audience_2k_ultra_low_latency_last7,\n          audience_4k_ultra_low_latency_last7,\n          audience_2k_last7,\n          audience_4k_last7,\n          audience_1080p_last7,\n          host_1080p_last7,\n          host_2k_last7,\n          host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 20,\n  21"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700079370244)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700079370244)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700079370244)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700079370244)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700079370244)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700079370244)(943764407)(0)\",\n  \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"sum_totalUsage_ok\",\n  DATE_ADD('SECOND', 0, date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"tdy_date_ok\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices\/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n          tag,\n          area AS Scope,\n          dim,\n            CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,\n          level2,\n          level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n            CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices\/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,\n          total AS totalUsage,\n          audio,\n          video,\n          host_audio,\n          audience_audio,\n          host_sd,\n          host_hd,\n          host_hdp,\n          host_1080p,\n          host_2k,\n          host_4k,\n          audience_sd,\n          audience_hd,\n          audience_hdp,\n          audience_1080p,\n          audience_2k,\n          audience_4k,\n          audience_audio_low_latency,\n          audience_sd_low_latency,\n          audience_hd_low_latency,\n          audience_hdp_low_latency,\n          audience_1080p_low_latency,\n          audience_2k_low_latency,\n          audience_4k_low_latency,\n          audience_audio_ultra_low_latency,\n          audience_sd_ultra_low_latency,\n          audience_hd_ultra_low_latency,\n          audience_hdp_ultra_low_latency,\n          audience_1080p_ultra_low_latency,\n          audience_2k_ultra_low_latency,\n          audience_4k_ultra_low_latency,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n          audience_video_low_latency_last1 AS audience_video_low_latency_last,\n          audience_total_low_latency_last1 AS audience_total_low_latency_last,\n          audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n          audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n          audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n          audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n          audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n          audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n          audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n          audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n          audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n          audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n          audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n          audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n          audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n          audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n          audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n          audience_2k_last1 AS audience_2k_last,\n          audience_4k_last1 AS audience_4k_last,\n          audience_1080p_last1 AS audience_1080p_last,\n          host_1080p_last1 AS host_1080p_last,\n          host_2k_last1 AS host_2k_last,\n          host_4k_last1 AS host_4k_last,\n          total_last7,\n          audio_last7,\n          video_last7,\n          video_sd_last7,\n          video_hd_last7,\n          video_hdp_last7,\n          host_sd_last7,\n          audience_sd_last7,\n          host_hd_last7,\n          audience_hd_last7,\n          host_hdp_last7,\n          audience_hdp_last7,\n          host_audio_last7,\n          audience_audio_last7,\n          host_video_last7,\n          audience_video_last7,\n          audience_audio_low_latency_last7,\n          audience_video_low_latency_last7,\n          audience_total_low_latency_last7,\n          audience_sd_low_latency_last7,\n          audience_hd_low_latency_last7,\n          audience_hdp_low_latency_last7,\n          audience_1080p_low_latency_last7,\n          audience_2k_low_latency_last7,\n          audience_4k_low_latency_last7,\n          audience_audio_ultra_low_latency_last7,\n          audience_video_ultra_low_latency_last7,\n          audience_total_ultra_low_latency_last7,\n          audience_sd_ultra_low_latency_last7,\n          audience_hd_ultra_low_latency_last7,\n          audience_hdp_ultra_low_latency_last7,\n          audience_1080p_ultra_low_latency_last7,\n          audience_2k_ultra_low_latency_last7,\n          audience_4k_ultra_low_latency_last7,\n          audience_2k_last7,\n          audience_4k_last7,\n          audience_1080p_last7,\n          host_1080p_last7,\n          host_2k_last7,\n          host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND \"自定义 SQL 查询\".\"rank_level1\" = 8 AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 18,\n  20"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700079370244)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700079370244)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700079370244)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700079370244)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700079370244)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700079370244)(943764407)(0)\",\n  MIN(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(1482809429)(0)\",\n  MAX(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(3765460736)(0)\",\n  \"自定义 SQL 查询\".\"level3\" AS \"level3\",\n  \"自定义 SQL 查询\".\"stat_date\" AS \"stat_date\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices\/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n          tag,\n          area AS Scope,\n          dim,\n            CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,\n          level2,\n          level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n            CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices\/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,\n          total AS totalUsage,\n          audio,\n          video,\n          host_audio,\n          audience_audio,\n          host_sd,\n          host_hd,\n          host_hdp,\n          host_1080p,\n          host_2k,\n          host_4k,\n          audience_sd,\n          audience_hd,\n          audience_hdp,\n          audience_1080p,\n          audience_2k,\n          audience_4k,\n          audience_audio_low_latency,\n          audience_sd_low_latency,\n          audience_hd_low_latency,\n          audience_hdp_low_latency,\n          audience_1080p_low_latency,\n          audience_2k_low_latency,\n          audience_4k_low_latency,\n          audience_audio_ultra_low_latency,\n          audience_sd_ultra_low_latency,\n          audience_hd_ultra_low_latency,\n          audience_hdp_ultra_low_latency,\n          audience_1080p_ultra_low_latency,\n          audience_2k_ultra_low_latency,\n          audience_4k_ultra_low_latency,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n          audience_video_low_latency_last1 AS audience_video_low_latency_last,\n          audience_total_low_latency_last1 AS audience_total_low_latency_last,\n          audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n          audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n          audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n          audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n          audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n          audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n          audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n          audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n          audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n          audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n          audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n          audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n          audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n          audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n          audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n          audience_2k_last1 AS audience_2k_last,\n          audience_4k_last1 AS audience_4k_last,\n          audience_1080p_last1 AS audience_1080p_last,\n          host_1080p_last1 AS host_1080p_last,\n          host_2k_last1 AS host_2k_last,\n          host_4k_last1 AS host_4k_last,\n          total_last7,\n          audio_last7,\n          video_last7,\n          video_sd_last7,\n          video_hd_last7,\n          video_hdp_last7,\n          host_sd_last7,\n          audience_sd_last7,\n          host_hd_last7,\n          audience_hd_last7,\n          host_hdp_last7,\n          audience_hdp_last7,\n          host_audio_last7,\n          audience_audio_last7,\n          host_video_last7,\n          audience_video_last7,\n          audience_audio_low_latency_last7,\n          audience_video_low_latency_last7,\n          audience_total_low_latency_last7,\n          audience_sd_low_latency_last7,\n          audience_hd_low_latency_last7,\n          audience_hdp_low_latency_last7,\n          audience_1080p_low_latency_last7,\n          audience_2k_low_latency_last7,\n          audience_4k_low_latency_last7,\n          audience_audio_ultra_low_latency_last7,\n          audience_video_ultra_low_latency_last7,\n          audience_total_ultra_low_latency_last7,\n          audience_sd_ultra_low_latency_last7,\n          audience_hd_ultra_low_latency_last7,\n          audience_hdp_ultra_low_latency_last7,\n          audience_1080p_ultra_low_latency_last7,\n          audience_2k_ultra_low_latency_last7,\n          audience_4k_ultra_low_latency_last7,\n          audience_2k_last7,\n          audience_4k_last7,\n          audience_1080p_last7,\n          host_1080p_last7,\n          host_2k_last7,\n          host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 20,\n  21"
	},
	{
		"presto_sql" : "SELECT \"自定义 SQL 查询\".\"product_level4\" AS \"product_level4\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Product' AND date >= 20211113 AND date <= 20211211 AND dim = 1) AS \"自定义 SQL 查询\"\nGROUP BY 1\nORDER BY \"product_level4\""
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k_last\") AS \"TEMP(Calculation_3519281700083154949)(101123376)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700083154949)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700083154949)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_hdp_last\") AS \"TEMP(Calculation_3519281700083154949)(1200517625)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700083154949)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p_last\") AS \"TEMP(Calculation_3519281700083154949)(1314346200)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_hd_last\") AS \"TEMP(Calculation_3519281700083154949)(146570423)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k_last\") AS \"TEMP(Calculation_3519281700083154949)(1717771635)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio_last\") AS \"TEMP(Calculation_3519281700083154949)(2313111073)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_hdp_last\") AS \"TEMP(Calculation_3519281700083154949)(258310559)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700083154949)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_video_last\") AS \"TEMP(Calculation_3519281700083154949)(2820618408)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700083154949)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700083154949)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700083154949)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700083154949)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700083154949)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k_last\") AS \"TEMP(Calculation_3519281700083154949)(3121859593)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p_last\") AS \"TEMP(Calculation_3519281700083154949)(3222422303)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio_last\") AS \"TEMP(Calculation_3519281700083154949)(3227677803)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700083154949)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700083154949)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700083154949)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video_last\") AS \"TEMP(Calculation_3519281700083154949)(3934387163)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k_last\") AS \"TEMP(Calculation_3519281700083154949)(4055292783)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_last\") AS \"TEMP(Calculation_3519281700083154949)(4091190060)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700083154949)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_hd_last\") AS \"TEMP(Calculation_3519281700083154949)(4170367250)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_sd_last\") AS \"TEMP(Calculation_3519281700083154949)(4190307025)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700083154949)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700083154949)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700083154949)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_sd_last\") AS \"TEMP(Calculation_3519281700083154949)(933007102)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700083154949)(943764407)(0)\",\n  \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"audio_video_last\") AS \"sum_audio_video_last_ok\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices\/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n          tag,\n          area AS Scope,\n          dim,\n            CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,\n          level2,\n          level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n            CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices\/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,\n          total AS totalUsage,\n          audio,\n          video,\n          host_audio,\n          audience_audio,\n          host_sd,\n          host_hd,\n          host_hdp,\n          host_1080p,\n          host_2k,\n          host_4k,\n          audience_sd,\n          audience_hd,\n          audience_hdp,\n          audience_1080p,\n          audience_2k,\n          audience_4k,\n          audience_audio_low_latency,\n          audience_sd_low_latency,\n          audience_hd_low_latency,\n          audience_hdp_low_latency,\n          audience_1080p_low_latency,\n          audience_2k_low_latency,\n          audience_4k_low_latency,\n          audience_audio_ultra_low_latency,\n          audience_sd_ultra_low_latency,\n          audience_hd_ultra_low_latency,\n          audience_hdp_ultra_low_latency,\n          audience_1080p_ultra_low_latency,\n          audience_2k_ultra_low_latency,\n          audience_4k_ultra_low_latency,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n          audience_video_low_latency_last1 AS audience_video_low_latency_last,\n          audience_total_low_latency_last1 AS audience_total_low_latency_last,\n          audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n          audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n          audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n          audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n          audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n          audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n          audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n          audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n          audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n          audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n          audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n          audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n          audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n          audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n          audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n          audience_2k_last1 AS audience_2k_last,\n          audience_4k_last1 AS audience_4k_last,\n          audience_1080p_last1 AS audience_1080p_last,\n          host_1080p_last1 AS host_1080p_last,\n          host_2k_last1 AS host_2k_last,\n          host_4k_last1 AS host_4k_last,\n          total_last7,\n          audio_last7,\n          video_last7,\n          video_sd_last7,\n          video_hd_last7,\n          video_hdp_last7,\n          host_sd_last7,\n          audience_sd_last7,\n          host_hd_last7,\n          audience_hd_last7,\n          host_hdp_last7,\n          audience_hdp_last7,\n          host_audio_last7,\n          audience_audio_last7,\n          host_video_last7,\n          audience_video_last7,\n          audience_audio_low_latency_last7,\n          audience_video_low_latency_last7,\n          audience_total_low_latency_last7,\n          audience_sd_low_latency_last7,\n          audience_hd_low_latency_last7,\n          audience_hdp_low_latency_last7,\n          audience_1080p_low_latency_last7,\n          audience_2k_low_latency_last7,\n          audience_4k_low_latency_last7,\n          audience_audio_ultra_low_latency_last7,\n          audience_video_ultra_low_latency_last7,\n          audience_total_ultra_low_latency_last7,\n          audience_sd_ultra_low_latency_last7,\n          audience_hd_ultra_low_latency_last7,\n          audience_hdp_ultra_low_latency_last7,\n          audience_1080p_ultra_low_latency_last7,\n          audience_2k_ultra_low_latency_last7,\n          audience_4k_ultra_low_latency_last7,\n          audience_2k_last7,\n          audience_4k_last7,\n          audience_1080p_last7,\n          host_1080p_last7,\n          host_2k_last7,\n          host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND \"自定义 SQL 查询\".\"rank_level1\" = 1 AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 35"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700079370244)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700079370244)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700079370244)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700079370244)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700079370244)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700079370244)(943764407)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_4k_last\") AS \"TEMP(Calculation_3519281700083154949)(101123376)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_hdp_last\") AS \"TEMP(Calculation_3519281700083154949)(1200517625)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p_last\") AS \"TEMP(Calculation_3519281700083154949)(1314346200)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_hd_last\") AS \"TEMP(Calculation_3519281700083154949)(146570423)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k_last\") AS \"TEMP(Calculation_3519281700083154949)(1717771635)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio_last\") AS \"TEMP(Calculation_3519281700083154949)(2313111073)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_hdp_last\") AS \"TEMP(Calculation_3519281700083154949)(258310559)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_video_last\") AS \"TEMP(Calculation_3519281700083154949)(2820618408)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k_last\") AS \"TEMP(Calculation_3519281700083154949)(3121859593)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p_last\") AS \"TEMP(Calculation_3519281700083154949)(3222422303)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio_last\") AS \"TEMP(Calculation_3519281700083154949)(3227677803)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video_last\") AS \"TEMP(Calculation_3519281700083154949)(3934387163)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k_last\") AS \"TEMP(Calculation_3519281700083154949)(4055292783)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_last\") AS \"TEMP(Calculation_3519281700083154949)(4091190060)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_hd_last\") AS \"TEMP(Calculation_3519281700083154949)(4170367250)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_sd_last\") AS \"TEMP(Calculation_3519281700083154949)(4190307025)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_sd_last\") AS \"TEMP(Calculation_3519281700083154949)(933007102)(0)\",\n  MAX(\"自定义 SQL 查询\".\"stat_date\") AS \"TEMP(attr_stat_date_nk)(2102638629)(0)\",\n  MIN(\"自定义 SQL 查询\".\"stat_date\") AS \"TEMP(attr_stat_date_nk)(2790680713)(0)\",\n  \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"sum_totalUsage_ok\",\n  DATE_ADD('SECOND', 0, date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"tdy_date_ok\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices\/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND \"自定义 SQL 查询\".\"rank_level1\" = 6\nGROUP BY 37,\n  39"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k_last\") AS \"TEMP(Calculation_3519281700083154949)(101123376)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700083154949)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700083154949)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_hdp_last\") AS \"TEMP(Calculation_3519281700083154949)(1200517625)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700083154949)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p_last\") AS \"TEMP(Calculation_3519281700083154949)(1314346200)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_hd_last\") AS \"TEMP(Calculation_3519281700083154949)(146570423)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k_last\") AS \"TEMP(Calculation_3519281700083154949)(1717771635)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio_last\") AS \"TEMP(Calculation_3519281700083154949)(2313111073)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_hdp_last\") AS \"TEMP(Calculation_3519281700083154949)(258310559)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700083154949)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_video_last\") AS \"TEMP(Calculation_3519281700083154949)(2820618408)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700083154949)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700083154949)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700083154949)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700083154949)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700083154949)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k_last\") AS \"TEMP(Calculation_3519281700083154949)(3121859593)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p_last\") AS \"TEMP(Calculation_3519281700083154949)(3222422303)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio_last\") AS \"TEMP(Calculation_3519281700083154949)(3227677803)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700083154949)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700083154949)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700083154949)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video_last\") AS \"TEMP(Calculation_3519281700083154949)(3934387163)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k_last\") AS \"TEMP(Calculation_3519281700083154949)(4055292783)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_last\") AS \"TEMP(Calculation_3519281700083154949)(4091190060)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700083154949)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_hd_last\") AS \"TEMP(Calculation_3519281700083154949)(4170367250)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_sd_last\") AS \"TEMP(Calculation_3519281700083154949)(4190307025)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700083154949)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700083154949)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700083154949)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_sd_last\") AS \"TEMP(Calculation_3519281700083154949)(933007102)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700083154949)(943764407)(0)\",\n  AVG(\"自定义 SQL 查询\".\"totalUsage\") AS \"avg_totalUsage_ok\",\n  \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"sum_totalUsage_ok\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices\/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n          tag,\n          area AS Scope,\n          dim,\n            CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,\n          level2,\n          level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n            CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices\/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,\n          total AS totalUsage,\n          audio,\n          video,\n          host_audio,\n          audience_audio,\n          host_sd,\n          host_hd,\n          host_hdp,\n          host_1080p,\n          host_2k,\n          host_4k,\n          audience_sd,\n          audience_hd,\n          audience_hdp,\n          audience_1080p,\n          audience_2k,\n          audience_4k,\n          audience_audio_low_latency,\n          audience_sd_low_latency,\n          audience_hd_low_latency,\n          audience_hdp_low_latency,\n          audience_1080p_low_latency,\n          audience_2k_low_latency,\n          audience_4k_low_latency,\n          audience_audio_ultra_low_latency,\n          audience_sd_ultra_low_latency,\n          audience_hd_ultra_low_latency,\n          audience_hdp_ultra_low_latency,\n          audience_1080p_ultra_low_latency,\n          audience_2k_ultra_low_latency,\n          audience_4k_ultra_low_latency,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n          audience_video_low_latency_last1 AS audience_video_low_latency_last,\n          audience_total_low_latency_last1 AS audience_total_low_latency_last,\n          audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n          audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n          audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n          audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n          audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n          audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n          audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n          audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n          audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n          audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n          audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n          audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n          audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n          audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n          audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n          audience_2k_last1 AS audience_2k_last,\n          audience_4k_last1 AS audience_4k_last,\n          audience_1080p_last1 AS audience_1080p_last,\n          host_1080p_last1 AS host_1080p_last,\n          host_2k_last1 AS host_2k_last,\n          host_4k_last1 AS host_4k_last,\n          total_last7,\n          audio_last7,\n          video_last7,\n          video_sd_last7,\n          video_hd_last7,\n          video_hdp_last7,\n          host_sd_last7,\n          audience_sd_last7,\n          host_hd_last7,\n          audience_hd_last7,\n          host_hdp_last7,\n          audience_hdp_last7,\n          host_audio_last7,\n          audience_audio_last7,\n          host_video_last7,\n          audience_video_last7,\n          audience_audio_low_latency_last7,\n          audience_video_low_latency_last7,\n          audience_total_low_latency_last7,\n          audience_sd_low_latency_last7,\n          audience_hd_low_latency_last7,\n          audience_hdp_low_latency_last7,\n          audience_1080p_low_latency_last7,\n          audience_2k_low_latency_last7,\n          audience_4k_low_latency_last7,\n          audience_audio_ultra_low_latency_last7,\n          audience_video_ultra_low_latency_last7,\n          audience_total_ultra_low_latency_last7,\n          audience_sd_ultra_low_latency_last7,\n          audience_hd_ultra_low_latency_last7,\n          audience_hdp_ultra_low_latency_last7,\n          audience_1080p_ultra_low_latency_last7,\n          audience_2k_ultra_low_latency_last7,\n          audience_4k_ultra_low_latency_last7,\n          audience_2k_last7,\n          audience_4k_last7,\n          audience_1080p_last7,\n          host_1080p_last7,\n          host_2k_last7,\n          host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND \"自定义 SQL 查询\".\"rank_level1\" = 3 AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 36"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700341563406)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio_last7\") AS \"TEMP(Calculation_3519281700341563406)(1077563395)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700341563406)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700341563406)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd_last7\") AS \"TEMP(Calculation_3519281700341563406)(1456465729)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd_last7\") AS \"TEMP(Calculation_3519281700341563406)(1635749653)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd_last7\") AS \"TEMP(Calculation_3519281700341563406)(1747046964)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k_last7\") AS \"TEMP(Calculation_3519281700341563406)(1747524570)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp_last7\") AS \"TEMP(Calculation_3519281700341563406)(2044136109)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio_last7\") AS \"TEMP(Calculation_3519281700341563406)(2464388580)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_last7\") AS \"TEMP(Calculation_3519281700341563406)(2589233512)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700341563406)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k_last7\") AS \"TEMP(Calculation_3519281700341563406)(280796653)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700341563406)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700341563406)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700341563406)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700341563406)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700341563406)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_4k_last7\") AS \"TEMP(Calculation_3519281700341563406)(3127348545)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700341563406)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"total_last7\") AS \"TEMP(Calculation_3519281700341563406)(346677966)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k_last7\") AS \"TEMP(Calculation_3519281700341563406)(3543669678)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p_last7\") AS \"TEMP(Calculation_3519281700341563406)(3624983014)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700341563406)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700341563406)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd_last7\") AS \"TEMP(Calculation_3519281700341563406)(3905372418)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video_last7\") AS \"TEMP(Calculation_3519281700341563406)(4107040267)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700341563406)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700341563406)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p_last7\") AS \"TEMP(Calculation_3519281700341563406)(632977665)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700341563406)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp_last7\") AS \"TEMP(Calculation_3519281700341563406)(750340200)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700341563406)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700341563406)(943764407)(0)\",\n  \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"audio_video_last\") AS \"sum_audio_video_last_ok\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices\/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n          tag,\n          area AS Scope,\n          dim,\n            CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,\n          level2,\n          level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n            CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices\/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,\n          total AS totalUsage,\n          audio,\n          video,\n          host_audio,\n          audience_audio,\n          host_sd,\n          host_hd,\n          host_hdp,\n          host_1080p,\n          host_2k,\n          host_4k,\n          audience_sd,\n          audience_hd,\n          audience_hdp,\n          audience_1080p,\n          audience_2k,\n          audience_4k,\n          audience_audio_low_latency,\n          audience_sd_low_latency,\n          audience_hd_low_latency,\n          audience_hdp_low_latency,\n          audience_1080p_low_latency,\n          audience_2k_low_latency,\n          audience_4k_low_latency,\n          audience_audio_ultra_low_latency,\n          audience_sd_ultra_low_latency,\n          audience_hd_ultra_low_latency,\n          audience_hdp_ultra_low_latency,\n          audience_1080p_ultra_low_latency,\n          audience_2k_ultra_low_latency,\n          audience_4k_ultra_low_latency,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n          audience_video_low_latency_last1 AS audience_video_low_latency_last,\n          audience_total_low_latency_last1 AS audience_total_low_latency_last,\n          audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n          audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n          audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n          audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n          audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n          audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n          audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n          audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n          audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n          audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n          audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n          audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n          audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n          audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n          audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n          audience_2k_last1 AS audience_2k_last,\n          audience_4k_last1 AS audience_4k_last,\n          audience_1080p_last1 AS audience_1080p_last,\n          host_1080p_last1 AS host_1080p_last,\n          host_2k_last1 AS host_2k_last,\n          host_4k_last1 AS host_4k_last,\n          total_last7,\n          audio_last7,\n          video_last7,\n          video_sd_last7,\n          video_hd_last7,\n          video_hdp_last7,\n          host_sd_last7,\n          audience_sd_last7,\n          host_hd_last7,\n          audience_hd_last7,\n          host_hdp_last7,\n          audience_hdp_last7,\n          host_audio_last7,\n          audience_audio_last7,\n          host_video_last7,\n          audience_video_last7,\n          audience_audio_low_latency_last7,\n          audience_video_low_latency_last7,\n          audience_total_low_latency_last7,\n          audience_sd_low_latency_last7,\n          audience_hd_low_latency_last7,\n          audience_hdp_low_latency_last7,\n          audience_1080p_low_latency_last7,\n          audience_2k_low_latency_last7,\n          audience_4k_low_latency_last7,\n          audience_audio_ultra_low_latency_last7,\n          audience_video_ultra_low_latency_last7,\n          audience_total_ultra_low_latency_last7,\n          audience_sd_ultra_low_latency_last7,\n          audience_hd_ultra_low_latency_last7,\n          audience_hdp_ultra_low_latency_last7,\n          audience_1080p_ultra_low_latency_last7,\n          audience_2k_ultra_low_latency_last7,\n          audience_4k_ultra_low_latency_last7,\n          audience_2k_last7,\n          audience_4k_last7,\n          audience_1080p_last7,\n          host_1080p_last7,\n          host_2k_last7,\n          host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND \"自定义 SQL 查询\".\"rank_level1\" = 5 AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 35"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700079370244)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700079370244)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700079370244)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700079370244)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700079370244)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700079370244)(943764407)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_4k_last\") AS \"TEMP(Calculation_3519281700083154949)(101123376)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_hdp_last\") AS \"TEMP(Calculation_3519281700083154949)(1200517625)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p_last\") AS \"TEMP(Calculation_3519281700083154949)(1314346200)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_hd_last\") AS \"TEMP(Calculation_3519281700083154949)(146570423)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k_last\") AS \"TEMP(Calculation_3519281700083154949)(1717771635)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio_last\") AS \"TEMP(Calculation_3519281700083154949)(2313111073)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_hdp_last\") AS \"TEMP(Calculation_3519281700083154949)(258310559)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_video_last\") AS \"TEMP(Calculation_3519281700083154949)(2820618408)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k_last\") AS \"TEMP(Calculation_3519281700083154949)(3121859593)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p_last\") AS \"TEMP(Calculation_3519281700083154949)(3222422303)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio_last\") AS \"TEMP(Calculation_3519281700083154949)(3227677803)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video_last\") AS \"TEMP(Calculation_3519281700083154949)(3934387163)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k_last\") AS \"TEMP(Calculation_3519281700083154949)(4055292783)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_last\") AS \"TEMP(Calculation_3519281700083154949)(4091190060)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_hd_last\") AS \"TEMP(Calculation_3519281700083154949)(4170367250)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_sd_last\") AS \"TEMP(Calculation_3519281700083154949)(4190307025)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_sd_last\") AS \"TEMP(Calculation_3519281700083154949)(933007102)(0)\",\n  MAX(\"自定义 SQL 查询\".\"stat_date\") AS \"TEMP(attr_stat_date_nk)(2102638629)(0)\",\n  MIN(\"自定义 SQL 查询\".\"stat_date\") AS \"TEMP(attr_stat_date_nk)(2790680713)(0)\",\n  \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"sum_totalUsage_ok\",\n  DATE_ADD('SECOND', 0, date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"tdy_date_ok\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices\/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND \"自定义 SQL 查询\".\"rank_level1\" = 2\nGROUP BY 37,\n  39"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700079370244)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700079370244)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700079370244)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700079370244)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700079370244)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700079370244)(943764407)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_4k_last\") AS \"TEMP(Calculation_3519281700083154949)(101123376)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_hdp_last\") AS \"TEMP(Calculation_3519281700083154949)(1200517625)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p_last\") AS \"TEMP(Calculation_3519281700083154949)(1314346200)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_hd_last\") AS \"TEMP(Calculation_3519281700083154949)(146570423)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k_last\") AS \"TEMP(Calculation_3519281700083154949)(1717771635)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio_last\") AS \"TEMP(Calculation_3519281700083154949)(2313111073)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_hdp_last\") AS \"TEMP(Calculation_3519281700083154949)(258310559)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_video_last\") AS \"TEMP(Calculation_3519281700083154949)(2820618408)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k_last\") AS \"TEMP(Calculation_3519281700083154949)(3121859593)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p_last\") AS \"TEMP(Calculation_3519281700083154949)(3222422303)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio_last\") AS \"TEMP(Calculation_3519281700083154949)(3227677803)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video_last\") AS \"TEMP(Calculation_3519281700083154949)(3934387163)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k_last\") AS \"TEMP(Calculation_3519281700083154949)(4055292783)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_last\") AS \"TEMP(Calculation_3519281700083154949)(4091190060)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_hd_last\") AS \"TEMP(Calculation_3519281700083154949)(4170367250)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_sd_last\") AS \"TEMP(Calculation_3519281700083154949)(4190307025)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_sd_last\") AS \"TEMP(Calculation_3519281700083154949)(933007102)(0)\",\n  AVG(\"自定义 SQL 查询\".\"totalUsage\") AS \"avg_totalUsage_ok\",\n  \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"sum_totalUsage_ok\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices\/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n          tag,\n          area AS Scope,\n          dim,\n            CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,\n          level2,\n          level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n            CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices\/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,\n          total AS totalUsage,\n          audio,\n          video,\n          host_audio,\n          audience_audio,\n          host_sd,\n          host_hd,\n          host_hdp,\n          host_1080p,\n          host_2k,\n          host_4k,\n          audience_sd,\n          audience_hd,\n          audience_hdp,\n          audience_1080p,\n          audience_2k,\n          audience_4k,\n          audience_audio_low_latency,\n          audience_sd_low_latency,\n          audience_hd_low_latency,\n          audience_hdp_low_latency,\n          audience_1080p_low_latency,\n          audience_2k_low_latency,\n          audience_4k_low_latency,\n          audience_audio_ultra_low_latency,\n          audience_sd_ultra_low_latency,\n          audience_hd_ultra_low_latency,\n          audience_hdp_ultra_low_latency,\n          audience_1080p_ultra_low_latency,\n          audience_2k_ultra_low_latency,\n          audience_4k_ultra_low_latency,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n          audience_video_low_latency_last1 AS audience_video_low_latency_last,\n          audience_total_low_latency_last1 AS audience_total_low_latency_last,\n          audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n          audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n          audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n          audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n          audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n          audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n          audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n          audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n          audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n          audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n          audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n          audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n          audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n          audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n          audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n          audience_2k_last1 AS audience_2k_last,\n          audience_4k_last1 AS audience_4k_last,\n          audience_1080p_last1 AS audience_1080p_last,\n          host_1080p_last1 AS host_1080p_last,\n          host_2k_last1 AS host_2k_last,\n          host_4k_last1 AS host_4k_last,\n          total_last7,\n          audio_last7,\n          video_last7,\n          video_sd_last7,\n          video_hd_last7,\n          video_hdp_last7,\n          host_sd_last7,\n          audience_sd_last7,\n          host_hd_last7,\n          audience_hd_last7,\n          host_hdp_last7,\n          audience_hdp_last7,\n          host_audio_last7,\n          audience_audio_last7,\n          host_video_last7,\n          audience_video_last7,\n          audience_audio_low_latency_last7,\n          audience_video_low_latency_last7,\n          audience_total_low_latency_last7,\n          audience_sd_low_latency_last7,\n          audience_hd_low_latency_last7,\n          audience_hdp_low_latency_last7,\n          audience_1080p_low_latency_last7,\n          audience_2k_low_latency_last7,\n          audience_4k_low_latency_last7,\n          audience_audio_ultra_low_latency_last7,\n          audience_video_ultra_low_latency_last7,\n          audience_total_ultra_low_latency_last7,\n          audience_sd_ultra_low_latency_last7,\n          audience_hd_ultra_low_latency_last7,\n          audience_hdp_ultra_low_latency_last7,\n          audience_1080p_ultra_low_latency_last7,\n          audience_2k_ultra_low_latency_last7,\n          audience_4k_ultra_low_latency_last7,\n          audience_2k_last7,\n          audience_4k_last7,\n          audience_1080p_last7,\n          host_1080p_last7,\n          host_2k_last7,\n          host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND \"自定义 SQL 查询\".\"rank_level1\" = 2 AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 36"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700079370244)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700079370244)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700079370244)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700079370244)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700079370244)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700079370244)(943764407)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_4k_last\") AS \"TEMP(Calculation_3519281700083154949)(101123376)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_hdp_last\") AS \"TEMP(Calculation_3519281700083154949)(1200517625)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p_last\") AS \"TEMP(Calculation_3519281700083154949)(1314346200)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_hd_last\") AS \"TEMP(Calculation_3519281700083154949)(146570423)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k_last\") AS \"TEMP(Calculation_3519281700083154949)(1717771635)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio_last\") AS \"TEMP(Calculation_3519281700083154949)(2313111073)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_hdp_last\") AS \"TEMP(Calculation_3519281700083154949)(258310559)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_video_last\") AS \"TEMP(Calculation_3519281700083154949)(2820618408)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k_last\") AS \"TEMP(Calculation_3519281700083154949)(3121859593)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p_last\") AS \"TEMP(Calculation_3519281700083154949)(3222422303)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio_last\") AS \"TEMP(Calculation_3519281700083154949)(3227677803)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video_last\") AS \"TEMP(Calculation_3519281700083154949)(3934387163)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k_last\") AS \"TEMP(Calculation_3519281700083154949)(4055292783)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_last\") AS \"TEMP(Calculation_3519281700083154949)(4091190060)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_hd_last\") AS \"TEMP(Calculation_3519281700083154949)(4170367250)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_sd_last\") AS \"TEMP(Calculation_3519281700083154949)(4190307025)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_sd_last\") AS \"TEMP(Calculation_3519281700083154949)(933007102)(0)\",\n  MAX(\"自定义 SQL 查询\".\"stat_date\") AS \"TEMP(attr_stat_date_nk)(2102638629)(0)\",\n  MIN(\"自定义 SQL 查询\".\"stat_date\") AS \"TEMP(attr_stat_date_nk)(2790680713)(0)\",\n  \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"sum_totalUsage_ok\",\n  DATE_ADD('SECOND', 0, date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"tdy_date_ok\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices\/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND \"自定义 SQL 查询\".\"rank_level1\" = 5\nGROUP BY 37,\n  39"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k_last\") AS \"TEMP(Calculation_3519281700083154949)(101123376)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700083154949)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700083154949)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_hdp_last\") AS \"TEMP(Calculation_3519281700083154949)(1200517625)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700083154949)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p_last\") AS \"TEMP(Calculation_3519281700083154949)(1314346200)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_hd_last\") AS \"TEMP(Calculation_3519281700083154949)(146570423)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k_last\") AS \"TEMP(Calculation_3519281700083154949)(1717771635)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio_last\") AS \"TEMP(Calculation_3519281700083154949)(2313111073)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_hdp_last\") AS \"TEMP(Calculation_3519281700083154949)(258310559)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700083154949)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_video_last\") AS \"TEMP(Calculation_3519281700083154949)(2820618408)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700083154949)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700083154949)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700083154949)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700083154949)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700083154949)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k_last\") AS \"TEMP(Calculation_3519281700083154949)(3121859593)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p_last\") AS \"TEMP(Calculation_3519281700083154949)(3222422303)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio_last\") AS \"TEMP(Calculation_3519281700083154949)(3227677803)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700083154949)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700083154949)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700083154949)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video_last\") AS \"TEMP(Calculation_3519281700083154949)(3934387163)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k_last\") AS \"TEMP(Calculation_3519281700083154949)(4055292783)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_last\") AS \"TEMP(Calculation_3519281700083154949)(4091190060)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700083154949)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_hd_last\") AS \"TEMP(Calculation_3519281700083154949)(4170367250)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_sd_last\") AS \"TEMP(Calculation_3519281700083154949)(4190307025)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700083154949)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700083154949)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700083154949)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_sd_last\") AS \"TEMP(Calculation_3519281700083154949)(933007102)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700083154949)(943764407)(0)\",\n  AVG(\"自定义 SQL 查询\".\"totalUsage\") AS \"avg_totalUsage_ok\",\n  \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"sum_totalUsage_ok\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices\/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n          tag,\n          area AS Scope,\n          dim,\n            CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,\n          level2,\n          level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n            CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices\/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,\n          total AS totalUsage,\n          audio,\n          video,\n          host_audio,\n          audience_audio,\n          host_sd,\n          host_hd,\n          host_hdp,\n          host_1080p,\n          host_2k,\n          host_4k,\n          audience_sd,\n          audience_hd,\n          audience_hdp,\n          audience_1080p,\n          audience_2k,\n          audience_4k,\n          audience_audio_low_latency,\n          audience_sd_low_latency,\n          audience_hd_low_latency,\n          audience_hdp_low_latency,\n          audience_1080p_low_latency,\n          audience_2k_low_latency,\n          audience_4k_low_latency,\n          audience_audio_ultra_low_latency,\n          audience_sd_ultra_low_latency,\n          audience_hd_ultra_low_latency,\n          audience_hdp_ultra_low_latency,\n          audience_1080p_ultra_low_latency,\n          audience_2k_ultra_low_latency,\n          audience_4k_ultra_low_latency,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n          audience_video_low_latency_last1 AS audience_video_low_latency_last,\n          audience_total_low_latency_last1 AS audience_total_low_latency_last,\n          audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n          audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n          audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n          audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n          audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n          audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n          audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n          audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n          audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n          audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n          audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n          audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n          audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n          audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n          audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n          audience_2k_last1 AS audience_2k_last,\n          audience_4k_last1 AS audience_4k_last,\n          audience_1080p_last1 AS audience_1080p_last,\n          host_1080p_last1 AS host_1080p_last,\n          host_2k_last1 AS host_2k_last,\n          host_4k_last1 AS host_4k_last,\n          total_last7,\n          audio_last7,\n          video_last7,\n          video_sd_last7,\n          video_hd_last7,\n          video_hdp_last7,\n          host_sd_last7,\n          audience_sd_last7,\n          host_hd_last7,\n          audience_hd_last7,\n          host_hdp_last7,\n          audience_hdp_last7,\n          host_audio_last7,\n          audience_audio_last7,\n          host_video_last7,\n          audience_video_last7,\n          audience_audio_low_latency_last7,\n          audience_video_low_latency_last7,\n          audience_total_low_latency_last7,\n          audience_sd_low_latency_last7,\n          audience_hd_low_latency_last7,\n          audience_hdp_low_latency_last7,\n          audience_1080p_low_latency_last7,\n          audience_2k_low_latency_last7,\n          audience_4k_low_latency_last7,\n          audience_audio_ultra_low_latency_last7,\n          audience_video_ultra_low_latency_last7,\n          audience_total_ultra_low_latency_last7,\n          audience_sd_ultra_low_latency_last7,\n          audience_hd_ultra_low_latency_last7,\n          audience_hdp_ultra_low_latency_last7,\n          audience_1080p_ultra_low_latency_last7,\n          audience_2k_ultra_low_latency_last7,\n          audience_4k_ultra_low_latency_last7,\n          audience_2k_last7,\n          audience_4k_last7,\n          audience_1080p_last7,\n          host_1080p_last7,\n          host_2k_last7,\n          host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND \"自定义 SQL 查询\".\"rank_level1\" = 7 AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 36"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700341563406)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio_last7\") AS \"TEMP(Calculation_3519281700341563406)(1077563395)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700341563406)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700341563406)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd_last7\") AS \"TEMP(Calculation_3519281700341563406)(1456465729)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd_last7\") AS \"TEMP(Calculation_3519281700341563406)(1635749653)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd_last7\") AS \"TEMP(Calculation_3519281700341563406)(1747046964)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k_last7\") AS \"TEMP(Calculation_3519281700341563406)(1747524570)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp_last7\") AS \"TEMP(Calculation_3519281700341563406)(2044136109)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio_last7\") AS \"TEMP(Calculation_3519281700341563406)(2464388580)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_last7\") AS \"TEMP(Calculation_3519281700341563406)(2589233512)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700341563406)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k_last7\") AS \"TEMP(Calculation_3519281700341563406)(280796653)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700341563406)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700341563406)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700341563406)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700341563406)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700341563406)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_4k_last7\") AS \"TEMP(Calculation_3519281700341563406)(3127348545)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700341563406)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"total_last7\") AS \"TEMP(Calculation_3519281700341563406)(346677966)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k_last7\") AS \"TEMP(Calculation_3519281700341563406)(3543669678)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p_last7\") AS \"TEMP(Calculation_3519281700341563406)(3624983014)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700341563406)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700341563406)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd_last7\") AS \"TEMP(Calculation_3519281700341563406)(3905372418)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video_last7\") AS \"TEMP(Calculation_3519281700341563406)(4107040267)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700341563406)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700341563406)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p_last7\") AS \"TEMP(Calculation_3519281700341563406)(632977665)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700341563406)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp_last7\") AS \"TEMP(Calculation_3519281700341563406)(750340200)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700341563406)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700341563406)(943764407)(0)\",\n  \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"audio_video_last\") AS \"sum_audio_video_last_ok\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices\/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n          tag,\n          area AS Scope,\n          dim,\n            CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,\n          level2,\n          level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n            CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices\/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,\n          total AS totalUsage,\n          audio,\n          video,\n          host_audio,\n          audience_audio,\n          host_sd,\n          host_hd,\n          host_hdp,\n          host_1080p,\n          host_2k,\n          host_4k,\n          audience_sd,\n          audience_hd,\n          audience_hdp,\n          audience_1080p,\n          audience_2k,\n          audience_4k,\n          audience_audio_low_latency,\n          audience_sd_low_latency,\n          audience_hd_low_latency,\n          audience_hdp_low_latency,\n          audience_1080p_low_latency,\n          audience_2k_low_latency,\n          audience_4k_low_latency,\n          audience_audio_ultra_low_latency,\n          audience_sd_ultra_low_latency,\n          audience_hd_ultra_low_latency,\n          audience_hdp_ultra_low_latency,\n          audience_1080p_ultra_low_latency,\n          audience_2k_ultra_low_latency,\n          audience_4k_ultra_low_latency,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n          audience_video_low_latency_last1 AS audience_video_low_latency_last,\n          audience_total_low_latency_last1 AS audience_total_low_latency_last,\n          audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n          audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n          audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n          audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n          audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n          audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n          audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n          audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n          audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n          audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n          audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n          audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n          audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n          audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n          audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n          audience_2k_last1 AS audience_2k_last,\n          audience_4k_last1 AS audience_4k_last,\n          audience_1080p_last1 AS audience_1080p_last,\n          host_1080p_last1 AS host_1080p_last,\n          host_2k_last1 AS host_2k_last,\n          host_4k_last1 AS host_4k_last,\n          total_last7,\n          audio_last7,\n          video_last7,\n          video_sd_last7,\n          video_hd_last7,\n          video_hdp_last7,\n          host_sd_last7,\n          audience_sd_last7,\n          host_hd_last7,\n          audience_hd_last7,\n          host_hdp_last7,\n          audience_hdp_last7,\n          host_audio_last7,\n          audience_audio_last7,\n          host_video_last7,\n          audience_video_last7,\n          audience_audio_low_latency_last7,\n          audience_video_low_latency_last7,\n          audience_total_low_latency_last7,\n          audience_sd_low_latency_last7,\n          audience_hd_low_latency_last7,\n          audience_hdp_low_latency_last7,\n          audience_1080p_low_latency_last7,\n          audience_2k_low_latency_last7,\n          audience_4k_low_latency_last7,\n          audience_audio_ultra_low_latency_last7,\n          audience_video_ultra_low_latency_last7,\n          audience_total_ultra_low_latency_last7,\n          audience_sd_ultra_low_latency_last7,\n          audience_hd_ultra_low_latency_last7,\n          audience_hdp_ultra_low_latency_last7,\n          audience_1080p_ultra_low_latency_last7,\n          audience_2k_ultra_low_latency_last7,\n          audience_4k_ultra_low_latency_last7,\n          audience_2k_last7,\n          audience_4k_last7,\n          audience_1080p_last7,\n          host_1080p_last7,\n          host_2k_last7,\n          host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND \"自定义 SQL 查询\".\"rank_level1\" = 2 AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 35"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700341563406)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio_last7\") AS \"TEMP(Calculation_3519281700341563406)(1077563395)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700341563406)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700341563406)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd_last7\") AS \"TEMP(Calculation_3519281700341563406)(1456465729)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd_last7\") AS \"TEMP(Calculation_3519281700341563406)(1635749653)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd_last7\") AS \"TEMP(Calculation_3519281700341563406)(1747046964)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k_last7\") AS \"TEMP(Calculation_3519281700341563406)(1747524570)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp_last7\") AS \"TEMP(Calculation_3519281700341563406)(2044136109)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio_last7\") AS \"TEMP(Calculation_3519281700341563406)(2464388580)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_last7\") AS \"TEMP(Calculation_3519281700341563406)(2589233512)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700341563406)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k_last7\") AS \"TEMP(Calculation_3519281700341563406)(280796653)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700341563406)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700341563406)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700341563406)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700341563406)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700341563406)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_4k_last7\") AS \"TEMP(Calculation_3519281700341563406)(3127348545)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700341563406)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"total_last7\") AS \"TEMP(Calculation_3519281700341563406)(346677966)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k_last7\") AS \"TEMP(Calculation_3519281700341563406)(3543669678)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p_last7\") AS \"TEMP(Calculation_3519281700341563406)(3624983014)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700341563406)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700341563406)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd_last7\") AS \"TEMP(Calculation_3519281700341563406)(3905372418)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video_last7\") AS \"TEMP(Calculation_3519281700341563406)(4107040267)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700341563406)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700341563406)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p_last7\") AS \"TEMP(Calculation_3519281700341563406)(632977665)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700341563406)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp_last7\") AS \"TEMP(Calculation_3519281700341563406)(750340200)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700341563406)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700341563406)(943764407)(0)\",\n  \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"audio_video_last\") AS \"sum_audio_video_last_ok\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices\/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n          tag,\n          area AS Scope,\n          dim,\n            CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,\n          level2,\n          level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n            CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices\/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,\n          total AS totalUsage,\n          audio,\n          video,\n          host_audio,\n          audience_audio,\n          host_sd,\n          host_hd,\n          host_hdp,\n          host_1080p,\n          host_2k,\n          host_4k,\n          audience_sd,\n          audience_hd,\n          audience_hdp,\n          audience_1080p,\n          audience_2k,\n          audience_4k,\n          audience_audio_low_latency,\n          audience_sd_low_latency,\n          audience_hd_low_latency,\n          audience_hdp_low_latency,\n          audience_1080p_low_latency,\n          audience_2k_low_latency,\n          audience_4k_low_latency,\n          audience_audio_ultra_low_latency,\n          audience_sd_ultra_low_latency,\n          audience_hd_ultra_low_latency,\n          audience_hdp_ultra_low_latency,\n          audience_1080p_ultra_low_latency,\n          audience_2k_ultra_low_latency,\n          audience_4k_ultra_low_latency,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n          audience_video_low_latency_last1 AS audience_video_low_latency_last,\n          audience_total_low_latency_last1 AS audience_total_low_latency_last,\n          audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n          audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n          audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n          audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n          audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n          audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n          audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n          audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n          audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n          audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n          audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n          audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n          audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n          audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n          audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n          audience_2k_last1 AS audience_2k_last,\n          audience_4k_last1 AS audience_4k_last,\n          audience_1080p_last1 AS audience_1080p_last,\n          host_1080p_last1 AS host_1080p_last,\n          host_2k_last1 AS host_2k_last,\n          host_4k_last1 AS host_4k_last,\n          total_last7,\n          audio_last7,\n          video_last7,\n          video_sd_last7,\n          video_hd_last7,\n          video_hdp_last7,\n          host_sd_last7,\n          audience_sd_last7,\n          host_hd_last7,\n          audience_hd_last7,\n          host_hdp_last7,\n          audience_hdp_last7,\n          host_audio_last7,\n          audience_audio_last7,\n          host_video_last7,\n          audience_video_last7,\n          audience_audio_low_latency_last7,\n          audience_video_low_latency_last7,\n          audience_total_low_latency_last7,\n          audience_sd_low_latency_last7,\n          audience_hd_low_latency_last7,\n          audience_hdp_low_latency_last7,\n          audience_1080p_low_latency_last7,\n          audience_2k_low_latency_last7,\n          audience_4k_low_latency_last7,\n          audience_audio_ultra_low_latency_last7,\n          audience_video_ultra_low_latency_last7,\n          audience_total_ultra_low_latency_last7,\n          audience_sd_ultra_low_latency_last7,\n          audience_hd_ultra_low_latency_last7,\n          audience_hdp_ultra_low_latency_last7,\n          audience_1080p_ultra_low_latency_last7,\n          audience_2k_ultra_low_latency_last7,\n          audience_4k_ultra_low_latency_last7,\n          audience_2k_last7,\n          audience_4k_last7,\n          audience_1080p_last7,\n          host_1080p_last7,\n          host_2k_last7,\n          host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND \"自定义 SQL 查询\".\"rank_level1\" = 4 AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 35"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700079370244)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700079370244)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700079370244)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700079370244)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700079370244)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700079370244)(943764407)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_4k_last\") AS \"TEMP(Calculation_3519281700083154949)(101123376)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_hdp_last\") AS \"TEMP(Calculation_3519281700083154949)(1200517625)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p_last\") AS \"TEMP(Calculation_3519281700083154949)(1314346200)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_hd_last\") AS \"TEMP(Calculation_3519281700083154949)(146570423)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k_last\") AS \"TEMP(Calculation_3519281700083154949)(1717771635)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio_last\") AS \"TEMP(Calculation_3519281700083154949)(2313111073)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_hdp_last\") AS \"TEMP(Calculation_3519281700083154949)(258310559)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_video_last\") AS \"TEMP(Calculation_3519281700083154949)(2820618408)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k_last\") AS \"TEMP(Calculation_3519281700083154949)(3121859593)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p_last\") AS \"TEMP(Calculation_3519281700083154949)(3222422303)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio_last\") AS \"TEMP(Calculation_3519281700083154949)(3227677803)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video_last\") AS \"TEMP(Calculation_3519281700083154949)(3934387163)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k_last\") AS \"TEMP(Calculation_3519281700083154949)(4055292783)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_last\") AS \"TEMP(Calculation_3519281700083154949)(4091190060)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_hd_last\") AS \"TEMP(Calculation_3519281700083154949)(4170367250)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_sd_last\") AS \"TEMP(Calculation_3519281700083154949)(4190307025)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_sd_last\") AS \"TEMP(Calculation_3519281700083154949)(933007102)(0)\",\n  MAX(\"自定义 SQL 查询\".\"stat_date\") AS \"TEMP(attr_stat_date_nk)(2102638629)(0)\",\n  MIN(\"自定义 SQL 查询\".\"stat_date\") AS \"TEMP(attr_stat_date_nk)(2790680713)(0)\",\n  \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"sum_totalUsage_ok\",\n  DATE_ADD('SECOND', 0, date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"tdy_date_ok\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices\/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND \"自定义 SQL 查询\".\"rank_level1\" = 7\nGROUP BY 37,\n  39"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k_last\") AS \"TEMP(Calculation_3519281700083154949)(101123376)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700083154949)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700083154949)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_hdp_last\") AS \"TEMP(Calculation_3519281700083154949)(1200517625)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700083154949)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p_last\") AS \"TEMP(Calculation_3519281700083154949)(1314346200)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_hd_last\") AS \"TEMP(Calculation_3519281700083154949)(146570423)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k_last\") AS \"TEMP(Calculation_3519281700083154949)(1717771635)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio_last\") AS \"TEMP(Calculation_3519281700083154949)(2313111073)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_hdp_last\") AS \"TEMP(Calculation_3519281700083154949)(258310559)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700083154949)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_video_last\") AS \"TEMP(Calculation_3519281700083154949)(2820618408)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700083154949)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700083154949)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700083154949)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700083154949)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700083154949)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k_last\") AS \"TEMP(Calculation_3519281700083154949)(3121859593)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p_last\") AS \"TEMP(Calculation_3519281700083154949)(3222422303)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio_last\") AS \"TEMP(Calculation_3519281700083154949)(3227677803)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700083154949)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700083154949)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700083154949)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video_last\") AS \"TEMP(Calculation_3519281700083154949)(3934387163)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k_last\") AS \"TEMP(Calculation_3519281700083154949)(4055292783)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_last\") AS \"TEMP(Calculation_3519281700083154949)(4091190060)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700083154949)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_hd_last\") AS \"TEMP(Calculation_3519281700083154949)(4170367250)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_sd_last\") AS \"TEMP(Calculation_3519281700083154949)(4190307025)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700083154949)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700083154949)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700083154949)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_sd_last\") AS \"TEMP(Calculation_3519281700083154949)(933007102)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700083154949)(943764407)(0)\",\n  AVG(\"自定义 SQL 查询\".\"totalUsage\") AS \"avg_totalUsage_ok\",\n  \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"sum_totalUsage_ok\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices\/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n          tag,\n          area AS Scope,\n          dim,\n            CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,\n          level2,\n          level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n            CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices\/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,\n          total AS totalUsage,\n          audio,\n          video,\n          host_audio,\n          audience_audio,\n          host_sd,\n          host_hd,\n          host_hdp,\n          host_1080p,\n          host_2k,\n          host_4k,\n          audience_sd,\n          audience_hd,\n          audience_hdp,\n          audience_1080p,\n          audience_2k,\n          audience_4k,\n          audience_audio_low_latency,\n          audience_sd_low_latency,\n          audience_hd_low_latency,\n          audience_hdp_low_latency,\n          audience_1080p_low_latency,\n          audience_2k_low_latency,\n          audience_4k_low_latency,\n          audience_audio_ultra_low_latency,\n          audience_sd_ultra_low_latency,\n          audience_hd_ultra_low_latency,\n          audience_hdp_ultra_low_latency,\n          audience_1080p_ultra_low_latency,\n          audience_2k_ultra_low_latency,\n          audience_4k_ultra_low_latency,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n          audience_video_low_latency_last1 AS audience_video_low_latency_last,\n          audience_total_low_latency_last1 AS audience_total_low_latency_last,\n          audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n          audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n          audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n          audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n          audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n          audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n          audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n          audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n          audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n          audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n          audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n          audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n          audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n          audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n          audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n          audience_2k_last1 AS audience_2k_last,\n          audience_4k_last1 AS audience_4k_last,\n          audience_1080p_last1 AS audience_1080p_last,\n          host_1080p_last1 AS host_1080p_last,\n          host_2k_last1 AS host_2k_last,\n          host_4k_last1 AS host_4k_last,\n          total_last7,\n          audio_last7,\n          video_last7,\n          video_sd_last7,\n          video_hd_last7,\n          video_hdp_last7,\n          host_sd_last7,\n          audience_sd_last7,\n          host_hd_last7,\n          audience_hd_last7,\n          host_hdp_last7,\n          audience_hdp_last7,\n          host_audio_last7,\n          audience_audio_last7,\n          host_video_last7,\n          audience_video_last7,\n          audience_audio_low_latency_last7,\n          audience_video_low_latency_last7,\n          audience_total_low_latency_last7,\n          audience_sd_low_latency_last7,\n          audience_hd_low_latency_last7,\n          audience_hdp_low_latency_last7,\n          audience_1080p_low_latency_last7,\n          audience_2k_low_latency_last7,\n          audience_4k_low_latency_last7,\n          audience_audio_ultra_low_latency_last7,\n          audience_video_ultra_low_latency_last7,\n          audience_total_ultra_low_latency_last7,\n          audience_sd_ultra_low_latency_last7,\n          audience_hd_ultra_low_latency_last7,\n          audience_hdp_ultra_low_latency_last7,\n          audience_1080p_ultra_low_latency_last7,\n          audience_2k_ultra_low_latency_last7,\n          audience_4k_ultra_low_latency_last7,\n          audience_2k_last7,\n          audience_4k_last7,\n          audience_1080p_last7,\n          host_1080p_last7,\n          host_2k_last7,\n          host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND \"自定义 SQL 查询\".\"rank_level1\" = 8 AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 36"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k_last\") AS \"TEMP(Calculation_3519281700083154949)(101123376)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700083154949)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700083154949)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_hdp_last\") AS \"TEMP(Calculation_3519281700083154949)(1200517625)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700083154949)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p_last\") AS \"TEMP(Calculation_3519281700083154949)(1314346200)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_hd_last\") AS \"TEMP(Calculation_3519281700083154949)(146570423)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k_last\") AS \"TEMP(Calculation_3519281700083154949)(1717771635)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio_last\") AS \"TEMP(Calculation_3519281700083154949)(2313111073)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_hdp_last\") AS \"TEMP(Calculation_3519281700083154949)(258310559)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700083154949)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_video_last\") AS \"TEMP(Calculation_3519281700083154949)(2820618408)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700083154949)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700083154949)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700083154949)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700083154949)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700083154949)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k_last\") AS \"TEMP(Calculation_3519281700083154949)(3121859593)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p_last\") AS \"TEMP(Calculation_3519281700083154949)(3222422303)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio_last\") AS \"TEMP(Calculation_3519281700083154949)(3227677803)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700083154949)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700083154949)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700083154949)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video_last\") AS \"TEMP(Calculation_3519281700083154949)(3934387163)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k_last\") AS \"TEMP(Calculation_3519281700083154949)(4055292783)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_last\") AS \"TEMP(Calculation_3519281700083154949)(4091190060)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700083154949)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_hd_last\") AS \"TEMP(Calculation_3519281700083154949)(4170367250)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_sd_last\") AS \"TEMP(Calculation_3519281700083154949)(4190307025)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700083154949)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700083154949)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700083154949)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_sd_last\") AS \"TEMP(Calculation_3519281700083154949)(933007102)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700083154949)(943764407)(0)\",\n  AVG(\"自定义 SQL 查询\".\"totalUsage\") AS \"avg_totalUsage_ok\",\n  \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"sum_totalUsage_ok\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices\/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n          tag,\n          area AS Scope,\n          dim,\n            CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,\n          level2,\n          level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n            CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices\/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,\n          total AS totalUsage,\n          audio,\n          video,\n          host_audio,\n          audience_audio,\n          host_sd,\n          host_hd,\n          host_hdp,\n          host_1080p,\n          host_2k,\n          host_4k,\n          audience_sd,\n          audience_hd,\n          audience_hdp,\n          audience_1080p,\n          audience_2k,\n          audience_4k,\n          audience_audio_low_latency,\n          audience_sd_low_latency,\n          audience_hd_low_latency,\n          audience_hdp_low_latency,\n          audience_1080p_low_latency,\n          audience_2k_low_latency,\n          audience_4k_low_latency,\n          audience_audio_ultra_low_latency,\n          audience_sd_ultra_low_latency,\n          audience_hd_ultra_low_latency,\n          audience_hdp_ultra_low_latency,\n          audience_1080p_ultra_low_latency,\n          audience_2k_ultra_low_latency,\n          audience_4k_ultra_low_latency,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n          audience_video_low_latency_last1 AS audience_video_low_latency_last,\n          audience_total_low_latency_last1 AS audience_total_low_latency_last,\n          audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n          audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n          audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n          audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n          audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n          audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n          audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n          audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n          audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n          audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n          audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n          audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n          audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n          audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n          audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n          audience_2k_last1 AS audience_2k_last,\n          audience_4k_last1 AS audience_4k_last,\n          audience_1080p_last1 AS audience_1080p_last,\n          host_1080p_last1 AS host_1080p_last,\n          host_2k_last1 AS host_2k_last,\n          host_4k_last1 AS host_4k_last,\n          total_last7,\n          audio_last7,\n          video_last7,\n          video_sd_last7,\n          video_hd_last7,\n          video_hdp_last7,\n          host_sd_last7,\n          audience_sd_last7,\n          host_hd_last7,\n          audience_hd_last7,\n          host_hdp_last7,\n          audience_hdp_last7,\n          host_audio_last7,\n          audience_audio_last7,\n          host_video_last7,\n          audience_video_last7,\n          audience_audio_low_latency_last7,\n          audience_video_low_latency_last7,\n          audience_total_low_latency_last7,\n          audience_sd_low_latency_last7,\n          audience_hd_low_latency_last7,\n          audience_hdp_low_latency_last7,\n          audience_1080p_low_latency_last7,\n          audience_2k_low_latency_last7,\n          audience_4k_low_latency_last7,\n          audience_audio_ultra_low_latency_last7,\n          audience_video_ultra_low_latency_last7,\n          audience_total_ultra_low_latency_last7,\n          audience_sd_ultra_low_latency_last7,\n          audience_hd_ultra_low_latency_last7,\n          audience_hdp_ultra_low_latency_last7,\n          audience_1080p_ultra_low_latency_last7,\n          audience_2k_ultra_low_latency_last7,\n          audience_4k_ultra_low_latency_last7,\n          audience_2k_last7,\n          audience_4k_last7,\n          audience_1080p_last7,\n          host_1080p_last7,\n          host_2k_last7,\n          host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND \"自定义 SQL 查询\".\"rank_level1\" = 5 AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 36"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700341563406)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio_last7\") AS \"TEMP(Calculation_3519281700341563406)(1077563395)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700341563406)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700341563406)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd_last7\") AS \"TEMP(Calculation_3519281700341563406)(1456465729)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd_last7\") AS \"TEMP(Calculation_3519281700341563406)(1635749653)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd_last7\") AS \"TEMP(Calculation_3519281700341563406)(1747046964)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k_last7\") AS \"TEMP(Calculation_3519281700341563406)(1747524570)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp_last7\") AS \"TEMP(Calculation_3519281700341563406)(2044136109)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio_last7\") AS \"TEMP(Calculation_3519281700341563406)(2464388580)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_last7\") AS \"TEMP(Calculation_3519281700341563406)(2589233512)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700341563406)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k_last7\") AS \"TEMP(Calculation_3519281700341563406)(280796653)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700341563406)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700341563406)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700341563406)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700341563406)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700341563406)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_4k_last7\") AS \"TEMP(Calculation_3519281700341563406)(3127348545)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700341563406)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"total_last7\") AS \"TEMP(Calculation_3519281700341563406)(346677966)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k_last7\") AS \"TEMP(Calculation_3519281700341563406)(3543669678)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p_last7\") AS \"TEMP(Calculation_3519281700341563406)(3624983014)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700341563406)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700341563406)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd_last7\") AS \"TEMP(Calculation_3519281700341563406)(3905372418)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video_last7\") AS \"TEMP(Calculation_3519281700341563406)(4107040267)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700341563406)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700341563406)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p_last7\") AS \"TEMP(Calculation_3519281700341563406)(632977665)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700341563406)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp_last7\") AS \"TEMP(Calculation_3519281700341563406)(750340200)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700341563406)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700341563406)(943764407)(0)\",\n  \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"audio_video_last\") AS \"sum_audio_video_last_ok\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices\/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n          tag,\n          area AS Scope,\n          dim,\n            CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,\n          level2,\n          level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n            CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices\/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,\n          total AS totalUsage,\n          audio,\n          video,\n          host_audio,\n          audience_audio,\n          host_sd,\n          host_hd,\n          host_hdp,\n          host_1080p,\n          host_2k,\n          host_4k,\n          audience_sd,\n          audience_hd,\n          audience_hdp,\n          audience_1080p,\n          audience_2k,\n          audience_4k,\n          audience_audio_low_latency,\n          audience_sd_low_latency,\n          audience_hd_low_latency,\n          audience_hdp_low_latency,\n          audience_1080p_low_latency,\n          audience_2k_low_latency,\n          audience_4k_low_latency,\n          audience_audio_ultra_low_latency,\n          audience_sd_ultra_low_latency,\n          audience_hd_ultra_low_latency,\n          audience_hdp_ultra_low_latency,\n          audience_1080p_ultra_low_latency,\n          audience_2k_ultra_low_latency,\n          audience_4k_ultra_low_latency,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n          audience_video_low_latency_last1 AS audience_video_low_latency_last,\n          audience_total_low_latency_last1 AS audience_total_low_latency_last,\n          audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n          audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n          audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n          audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n          audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n          audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n          audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n          audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n          audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n          audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n          audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n          audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n          audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n          audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n          audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n          audience_2k_last1 AS audience_2k_last,\n          audience_4k_last1 AS audience_4k_last,\n          audience_1080p_last1 AS audience_1080p_last,\n          host_1080p_last1 AS host_1080p_last,\n          host_2k_last1 AS host_2k_last,\n          host_4k_last1 AS host_4k_last,\n          total_last7,\n          audio_last7,\n          video_last7,\n          video_sd_last7,\n          video_hd_last7,\n          video_hdp_last7,\n          host_sd_last7,\n          audience_sd_last7,\n          host_hd_last7,\n          audience_hd_last7,\n          host_hdp_last7,\n          audience_hdp_last7,\n          host_audio_last7,\n          audience_audio_last7,\n          host_video_last7,\n          audience_video_last7,\n          audience_audio_low_latency_last7,\n          audience_video_low_latency_last7,\n          audience_total_low_latency_last7,\n          audience_sd_low_latency_last7,\n          audience_hd_low_latency_last7,\n          audience_hdp_low_latency_last7,\n          audience_1080p_low_latency_last7,\n          audience_2k_low_latency_last7,\n          audience_4k_low_latency_last7,\n          audience_audio_ultra_low_latency_last7,\n          audience_video_ultra_low_latency_last7,\n          audience_total_ultra_low_latency_last7,\n          audience_sd_ultra_low_latency_last7,\n          audience_hd_ultra_low_latency_last7,\n          audience_hdp_ultra_low_latency_last7,\n          audience_1080p_ultra_low_latency_last7,\n          audience_2k_ultra_low_latency_last7,\n          audience_4k_ultra_low_latency_last7,\n          audience_2k_last7,\n          audience_4k_last7,\n          audience_1080p_last7,\n          host_1080p_last7,\n          host_2k_last7,\n          host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND \"自定义 SQL 查询\".\"rank_level1\" = 3 AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 35"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700079370244)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700079370244)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700079370244)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700079370244)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700079370244)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700079370244)(943764407)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_4k_last\") AS \"TEMP(Calculation_3519281700083154949)(101123376)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_hdp_last\") AS \"TEMP(Calculation_3519281700083154949)(1200517625)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p_last\") AS \"TEMP(Calculation_3519281700083154949)(1314346200)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_hd_last\") AS \"TEMP(Calculation_3519281700083154949)(146570423)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k_last\") AS \"TEMP(Calculation_3519281700083154949)(1717771635)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio_last\") AS \"TEMP(Calculation_3519281700083154949)(2313111073)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_hdp_last\") AS \"TEMP(Calculation_3519281700083154949)(258310559)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_video_last\") AS \"TEMP(Calculation_3519281700083154949)(2820618408)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k_last\") AS \"TEMP(Calculation_3519281700083154949)(3121859593)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p_last\") AS \"TEMP(Calculation_3519281700083154949)(3222422303)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio_last\") AS \"TEMP(Calculation_3519281700083154949)(3227677803)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video_last\") AS \"TEMP(Calculation_3519281700083154949)(3934387163)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k_last\") AS \"TEMP(Calculation_3519281700083154949)(4055292783)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_last\") AS \"TEMP(Calculation_3519281700083154949)(4091190060)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_hd_last\") AS \"TEMP(Calculation_3519281700083154949)(4170367250)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_sd_last\") AS \"TEMP(Calculation_3519281700083154949)(4190307025)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_sd_last\") AS \"TEMP(Calculation_3519281700083154949)(933007102)(0)\",\n  MAX(\"自定义 SQL 查询\".\"stat_date\") AS \"TEMP(attr_stat_date_nk)(2102638629)(0)\",\n  MIN(\"自定义 SQL 查询\".\"stat_date\") AS \"TEMP(attr_stat_date_nk)(2790680713)(0)\",\n  \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"sum_totalUsage_ok\",\n  DATE_ADD('SECOND', 0, date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"tdy_date_ok\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices\/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND \"自定义 SQL 查询\".\"rank_level1\" = 8\nGROUP BY 37,\n  39"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700079370244)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700079370244)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700079370244)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700079370244)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700079370244)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700079370244)(943764407)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_4k_last\") AS \"TEMP(Calculation_3519281700083154949)(101123376)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_hdp_last\") AS \"TEMP(Calculation_3519281700083154949)(1200517625)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p_last\") AS \"TEMP(Calculation_3519281700083154949)(1314346200)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_hd_last\") AS \"TEMP(Calculation_3519281700083154949)(146570423)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k_last\") AS \"TEMP(Calculation_3519281700083154949)(1717771635)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio_last\") AS \"TEMP(Calculation_3519281700083154949)(2313111073)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_hdp_last\") AS \"TEMP(Calculation_3519281700083154949)(258310559)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_video_last\") AS \"TEMP(Calculation_3519281700083154949)(2820618408)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k_last\") AS \"TEMP(Calculation_3519281700083154949)(3121859593)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p_last\") AS \"TEMP(Calculation_3519281700083154949)(3222422303)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio_last\") AS \"TEMP(Calculation_3519281700083154949)(3227677803)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video_last\") AS \"TEMP(Calculation_3519281700083154949)(3934387163)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k_last\") AS \"TEMP(Calculation_3519281700083154949)(4055292783)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_last\") AS \"TEMP(Calculation_3519281700083154949)(4091190060)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_hd_last\") AS \"TEMP(Calculation_3519281700083154949)(4170367250)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_sd_last\") AS \"TEMP(Calculation_3519281700083154949)(4190307025)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_sd_last\") AS \"TEMP(Calculation_3519281700083154949)(933007102)(0)\",\n  MAX(\"自定义 SQL 查询\".\"stat_date\") AS \"TEMP(attr_stat_date_nk)(2102638629)(0)\",\n  MIN(\"自定义 SQL 查询\".\"stat_date\") AS \"TEMP(attr_stat_date_nk)(2790680713)(0)\",\n  \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"sum_totalUsage_ok\",\n  DATE_ADD('SECOND', 0, date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"tdy_date_ok\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices\/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND \"自定义 SQL 查询\".\"rank_level1\" = 4\nGROUP BY 37,\n  39"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700079370244)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700079370244)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700079370244)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700079370244)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700079370244)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700079370244)(943764407)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_4k_last\") AS \"TEMP(Calculation_3519281700083154949)(101123376)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_hdp_last\") AS \"TEMP(Calculation_3519281700083154949)(1200517625)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p_last\") AS \"TEMP(Calculation_3519281700083154949)(1314346200)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_hd_last\") AS \"TEMP(Calculation_3519281700083154949)(146570423)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k_last\") AS \"TEMP(Calculation_3519281700083154949)(1717771635)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio_last\") AS \"TEMP(Calculation_3519281700083154949)(2313111073)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_hdp_last\") AS \"TEMP(Calculation_3519281700083154949)(258310559)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_video_last\") AS \"TEMP(Calculation_3519281700083154949)(2820618408)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k_last\") AS \"TEMP(Calculation_3519281700083154949)(3121859593)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p_last\") AS \"TEMP(Calculation_3519281700083154949)(3222422303)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio_last\") AS \"TEMP(Calculation_3519281700083154949)(3227677803)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video_last\") AS \"TEMP(Calculation_3519281700083154949)(3934387163)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k_last\") AS \"TEMP(Calculation_3519281700083154949)(4055292783)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_last\") AS \"TEMP(Calculation_3519281700083154949)(4091190060)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_hd_last\") AS \"TEMP(Calculation_3519281700083154949)(4170367250)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_sd_last\") AS \"TEMP(Calculation_3519281700083154949)(4190307025)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_sd_last\") AS \"TEMP(Calculation_3519281700083154949)(933007102)(0)\",\n  MAX(\"自定义 SQL 查询\".\"stat_date\") AS \"TEMP(attr_stat_date_nk)(2102638629)(0)\",\n  MIN(\"自定义 SQL 查询\".\"stat_date\") AS \"TEMP(attr_stat_date_nk)(2790680713)(0)\",\n  \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"sum_totalUsage_ok\",\n  DATE_ADD('SECOND', 0, date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"tdy_date_ok\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices\/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND \"自定义 SQL 查询\".\"rank_level1\" = 3\nGROUP BY 37,\n  39"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700341563406)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio_last7\") AS \"TEMP(Calculation_3519281700341563406)(1077563395)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700341563406)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700341563406)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd_last7\") AS \"TEMP(Calculation_3519281700341563406)(1456465729)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd_last7\") AS \"TEMP(Calculation_3519281700341563406)(1635749653)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd_last7\") AS \"TEMP(Calculation_3519281700341563406)(1747046964)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k_last7\") AS \"TEMP(Calculation_3519281700341563406)(1747524570)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp_last7\") AS \"TEMP(Calculation_3519281700341563406)(2044136109)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio_last7\") AS \"TEMP(Calculation_3519281700341563406)(2464388580)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_last7\") AS \"TEMP(Calculation_3519281700341563406)(2589233512)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700341563406)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k_last7\") AS \"TEMP(Calculation_3519281700341563406)(280796653)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700341563406)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700341563406)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700341563406)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700341563406)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700341563406)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_4k_last7\") AS \"TEMP(Calculation_3519281700341563406)(3127348545)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700341563406)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"total_last7\") AS \"TEMP(Calculation_3519281700341563406)(346677966)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k_last7\") AS \"TEMP(Calculation_3519281700341563406)(3543669678)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p_last7\") AS \"TEMP(Calculation_3519281700341563406)(3624983014)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700341563406)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700341563406)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd_last7\") AS \"TEMP(Calculation_3519281700341563406)(3905372418)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video_last7\") AS \"TEMP(Calculation_3519281700341563406)(4107040267)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700341563406)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700341563406)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p_last7\") AS \"TEMP(Calculation_3519281700341563406)(632977665)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700341563406)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp_last7\") AS \"TEMP(Calculation_3519281700341563406)(750340200)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700341563406)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700341563406)(943764407)(0)\",\n  \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"audio_video_last\") AS \"sum_audio_video_last_ok\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices\/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n          tag,\n          area AS Scope,\n          dim,\n            CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,\n          level2,\n          level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n            CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices\/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,\n          total AS totalUsage,\n          audio,\n          video,\n          host_audio,\n          audience_audio,\n          host_sd,\n          host_hd,\n          host_hdp,\n          host_1080p,\n          host_2k,\n          host_4k,\n          audience_sd,\n          audience_hd,\n          audience_hdp,\n          audience_1080p,\n          audience_2k,\n          audience_4k,\n          audience_audio_low_latency,\n          audience_sd_low_latency,\n          audience_hd_low_latency,\n          audience_hdp_low_latency,\n          audience_1080p_low_latency,\n          audience_2k_low_latency,\n          audience_4k_low_latency,\n          audience_audio_ultra_low_latency,\n          audience_sd_ultra_low_latency,\n          audience_hd_ultra_low_latency,\n          audience_hdp_ultra_low_latency,\n          audience_1080p_ultra_low_latency,\n          audience_2k_ultra_low_latency,\n          audience_4k_ultra_low_latency,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n          audience_video_low_latency_last1 AS audience_video_low_latency_last,\n          audience_total_low_latency_last1 AS audience_total_low_latency_last,\n          audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n          audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n          audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n          audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n          audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n          audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n          audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n          audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n          audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n          audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n          audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n          audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n          audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n          audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n          audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n          audience_2k_last1 AS audience_2k_last,\n          audience_4k_last1 AS audience_4k_last,\n          audience_1080p_last1 AS audience_1080p_last,\n          host_1080p_last1 AS host_1080p_last,\n          host_2k_last1 AS host_2k_last,\n          host_4k_last1 AS host_4k_last,\n          total_last7,\n          audio_last7,\n          video_last7,\n          video_sd_last7,\n          video_hd_last7,\n          video_hdp_last7,\n          host_sd_last7,\n          audience_sd_last7,\n          host_hd_last7,\n          audience_hd_last7,\n          host_hdp_last7,\n          audience_hdp_last7,\n          host_audio_last7,\n          audience_audio_last7,\n          host_video_last7,\n          audience_video_last7,\n          audience_audio_low_latency_last7,\n          audience_video_low_latency_last7,\n          audience_total_low_latency_last7,\n          audience_sd_low_latency_last7,\n          audience_hd_low_latency_last7,\n          audience_hdp_low_latency_last7,\n          audience_1080p_low_latency_last7,\n          audience_2k_low_latency_last7,\n          audience_4k_low_latency_last7,\n          audience_audio_ultra_low_latency_last7,\n          audience_video_ultra_low_latency_last7,\n          audience_total_ultra_low_latency_last7,\n          audience_sd_ultra_low_latency_last7,\n          audience_hd_ultra_low_latency_last7,\n          audience_hdp_ultra_low_latency_last7,\n          audience_1080p_ultra_low_latency_last7,\n          audience_2k_ultra_low_latency_last7,\n          audience_4k_ultra_low_latency_last7,\n          audience_2k_last7,\n          audience_4k_last7,\n          audience_1080p_last7,\n          host_1080p_last7,\n          host_2k_last7,\n          host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND \"自定义 SQL 查询\".\"rank_level1\" = 8 AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 35"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700341563406)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio_last7\") AS \"TEMP(Calculation_3519281700341563406)(1077563395)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700341563406)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700341563406)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd_last7\") AS \"TEMP(Calculation_3519281700341563406)(1456465729)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd_last7\") AS \"TEMP(Calculation_3519281700341563406)(1635749653)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd_last7\") AS \"TEMP(Calculation_3519281700341563406)(1747046964)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k_last7\") AS \"TEMP(Calculation_3519281700341563406)(1747524570)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp_last7\") AS \"TEMP(Calculation_3519281700341563406)(2044136109)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio_last7\") AS \"TEMP(Calculation_3519281700341563406)(2464388580)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_last7\") AS \"TEMP(Calculation_3519281700341563406)(2589233512)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700341563406)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k_last7\") AS \"TEMP(Calculation_3519281700341563406)(280796653)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700341563406)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700341563406)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700341563406)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700341563406)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700341563406)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_4k_last7\") AS \"TEMP(Calculation_3519281700341563406)(3127348545)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700341563406)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"total_last7\") AS \"TEMP(Calculation_3519281700341563406)(346677966)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k_last7\") AS \"TEMP(Calculation_3519281700341563406)(3543669678)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p_last7\") AS \"TEMP(Calculation_3519281700341563406)(3624983014)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700341563406)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700341563406)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd_last7\") AS \"TEMP(Calculation_3519281700341563406)(3905372418)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video_last7\") AS \"TEMP(Calculation_3519281700341563406)(4107040267)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700341563406)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700341563406)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p_last7\") AS \"TEMP(Calculation_3519281700341563406)(632977665)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700341563406)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp_last7\") AS \"TEMP(Calculation_3519281700341563406)(750340200)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700341563406)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700341563406)(943764407)(0)\",\n  \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"audio_video_last\") AS \"sum_audio_video_last_ok\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices\/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n          tag,\n          area AS Scope,\n          dim,\n            CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,\n          level2,\n          level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n            CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices\/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,\n          total AS totalUsage,\n          audio,\n          video,\n          host_audio,\n          audience_audio,\n          host_sd,\n          host_hd,\n          host_hdp,\n          host_1080p,\n          host_2k,\n          host_4k,\n          audience_sd,\n          audience_hd,\n          audience_hdp,\n          audience_1080p,\n          audience_2k,\n          audience_4k,\n          audience_audio_low_latency,\n          audience_sd_low_latency,\n          audience_hd_low_latency,\n          audience_hdp_low_latency,\n          audience_1080p_low_latency,\n          audience_2k_low_latency,\n          audience_4k_low_latency,\n          audience_audio_ultra_low_latency,\n          audience_sd_ultra_low_latency,\n          audience_hd_ultra_low_latency,\n          audience_hdp_ultra_low_latency,\n          audience_1080p_ultra_low_latency,\n          audience_2k_ultra_low_latency,\n          audience_4k_ultra_low_latency,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n          audience_video_low_latency_last1 AS audience_video_low_latency_last,\n          audience_total_low_latency_last1 AS audience_total_low_latency_last,\n          audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n          audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n          audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n          audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n          audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n          audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n          audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n          audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n          audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n          audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n          audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n          audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n          audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n          audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n          audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n          audience_2k_last1 AS audience_2k_last,\n          audience_4k_last1 AS audience_4k_last,\n          audience_1080p_last1 AS audience_1080p_last,\n          host_1080p_last1 AS host_1080p_last,\n          host_2k_last1 AS host_2k_last,\n          host_4k_last1 AS host_4k_last,\n          total_last7,\n          audio_last7,\n          video_last7,\n          video_sd_last7,\n          video_hd_last7,\n          video_hdp_last7,\n          host_sd_last7,\n          audience_sd_last7,\n          host_hd_last7,\n          audience_hd_last7,\n          host_hdp_last7,\n          audience_hdp_last7,\n          host_audio_last7,\n          audience_audio_last7,\n          host_video_last7,\n          audience_video_last7,\n          audience_audio_low_latency_last7,\n          audience_video_low_latency_last7,\n          audience_total_low_latency_last7,\n          audience_sd_low_latency_last7,\n          audience_hd_low_latency_last7,\n          audience_hdp_low_latency_last7,\n          audience_1080p_low_latency_last7,\n          audience_2k_low_latency_last7,\n          audience_4k_low_latency_last7,\n          audience_audio_ultra_low_latency_last7,\n          audience_video_ultra_low_latency_last7,\n          audience_total_ultra_low_latency_last7,\n          audience_sd_ultra_low_latency_last7,\n          audience_hd_ultra_low_latency_last7,\n          audience_hdp_ultra_low_latency_last7,\n          audience_1080p_ultra_low_latency_last7,\n          audience_2k_ultra_low_latency_last7,\n          audience_4k_ultra_low_latency_last7,\n          audience_2k_last7,\n          audience_4k_last7,\n          audience_1080p_last7,\n          host_1080p_last7,\n          host_2k_last7,\n          host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND \"自定义 SQL 查询\".\"rank_level1\" = 6 AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 35"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700341563406)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio_last7\") AS \"TEMP(Calculation_3519281700341563406)(1077563395)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700341563406)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700341563406)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd_last7\") AS \"TEMP(Calculation_3519281700341563406)(1456465729)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd_last7\") AS \"TEMP(Calculation_3519281700341563406)(1635749653)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd_last7\") AS \"TEMP(Calculation_3519281700341563406)(1747046964)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k_last7\") AS \"TEMP(Calculation_3519281700341563406)(1747524570)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp_last7\") AS \"TEMP(Calculation_3519281700341563406)(2044136109)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio_last7\") AS \"TEMP(Calculation_3519281700341563406)(2464388580)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_last7\") AS \"TEMP(Calculation_3519281700341563406)(2589233512)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700341563406)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k_last7\") AS \"TEMP(Calculation_3519281700341563406)(280796653)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700341563406)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700341563406)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700341563406)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700341563406)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700341563406)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_4k_last7\") AS \"TEMP(Calculation_3519281700341563406)(3127348545)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700341563406)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"total_last7\") AS \"TEMP(Calculation_3519281700341563406)(346677966)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k_last7\") AS \"TEMP(Calculation_3519281700341563406)(3543669678)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p_last7\") AS \"TEMP(Calculation_3519281700341563406)(3624983014)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700341563406)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700341563406)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd_last7\") AS \"TEMP(Calculation_3519281700341563406)(3905372418)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video_last7\") AS \"TEMP(Calculation_3519281700341563406)(4107040267)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700341563406)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700341563406)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p_last7\") AS \"TEMP(Calculation_3519281700341563406)(632977665)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700341563406)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp_last7\") AS \"TEMP(Calculation_3519281700341563406)(750340200)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700341563406)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700341563406)(943764407)(0)\",\n  \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"audio_video_last\") AS \"sum_audio_video_last_ok\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices\/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n          tag,\n          area AS Scope,\n          dim,\n            CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,\n          level2,\n          level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n            CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices\/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,\n          total AS totalUsage,\n          audio,\n          video,\n          host_audio,\n          audience_audio,\n          host_sd,\n          host_hd,\n          host_hdp,\n          host_1080p,\n          host_2k,\n          host_4k,\n          audience_sd,\n          audience_hd,\n          audience_hdp,\n          audience_1080p,\n          audience_2k,\n          audience_4k,\n          audience_audio_low_latency,\n          audience_sd_low_latency,\n          audience_hd_low_latency,\n          audience_hdp_low_latency,\n          audience_1080p_low_latency,\n          audience_2k_low_latency,\n          audience_4k_low_latency,\n          audience_audio_ultra_low_latency,\n          audience_sd_ultra_low_latency,\n          audience_hd_ultra_low_latency,\n          audience_hdp_ultra_low_latency,\n          audience_1080p_ultra_low_latency,\n          audience_2k_ultra_low_latency,\n          audience_4k_ultra_low_latency,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n          audience_video_low_latency_last1 AS audience_video_low_latency_last,\n          audience_total_low_latency_last1 AS audience_total_low_latency_last,\n          audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n          audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n          audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n          audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n          audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n          audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n          audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n          audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n          audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n          audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n          audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n          audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n          audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n          audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n          audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n          audience_2k_last1 AS audience_2k_last,\n          audience_4k_last1 AS audience_4k_last,\n          audience_1080p_last1 AS audience_1080p_last,\n          host_1080p_last1 AS host_1080p_last,\n          host_2k_last1 AS host_2k_last,\n          host_4k_last1 AS host_4k_last,\n          total_last7,\n          audio_last7,\n          video_last7,\n          video_sd_last7,\n          video_hd_last7,\n          video_hdp_last7,\n          host_sd_last7,\n          audience_sd_last7,\n          host_hd_last7,\n          audience_hd_last7,\n          host_hdp_last7,\n          audience_hdp_last7,\n          host_audio_last7,\n          audience_audio_last7,\n          host_video_last7,\n          audience_video_last7,\n          audience_audio_low_latency_last7,\n          audience_video_low_latency_last7,\n          audience_total_low_latency_last7,\n          audience_sd_low_latency_last7,\n          audience_hd_low_latency_last7,\n          audience_hdp_low_latency_last7,\n          audience_1080p_low_latency_last7,\n          audience_2k_low_latency_last7,\n          audience_4k_low_latency_last7,\n          audience_audio_ultra_low_latency_last7,\n          audience_video_ultra_low_latency_last7,\n          audience_total_ultra_low_latency_last7,\n          audience_sd_ultra_low_latency_last7,\n          audience_hd_ultra_low_latency_last7,\n          audience_hdp_ultra_low_latency_last7,\n          audience_1080p_ultra_low_latency_last7,\n          audience_2k_ultra_low_latency_last7,\n          audience_4k_ultra_low_latency_last7,\n          audience_2k_last7,\n          audience_4k_last7,\n          audience_1080p_last7,\n          host_1080p_last7,\n          host_2k_last7,\n          host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND \"自定义 SQL 查询\".\"rank_level1\" = 7 AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 35"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700079370244)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700079370244)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700079370244)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700079370244)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700079370244)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700079370244)(943764407)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_4k_last\") AS \"TEMP(Calculation_3519281700083154949)(101123376)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_hdp_last\") AS \"TEMP(Calculation_3519281700083154949)(1200517625)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p_last\") AS \"TEMP(Calculation_3519281700083154949)(1314346200)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_hd_last\") AS \"TEMP(Calculation_3519281700083154949)(146570423)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k_last\") AS \"TEMP(Calculation_3519281700083154949)(1717771635)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio_last\") AS \"TEMP(Calculation_3519281700083154949)(2313111073)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_hdp_last\") AS \"TEMP(Calculation_3519281700083154949)(258310559)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_video_last\") AS \"TEMP(Calculation_3519281700083154949)(2820618408)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k_last\") AS \"TEMP(Calculation_3519281700083154949)(3121859593)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p_last\") AS \"TEMP(Calculation_3519281700083154949)(3222422303)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio_last\") AS \"TEMP(Calculation_3519281700083154949)(3227677803)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video_last\") AS \"TEMP(Calculation_3519281700083154949)(3934387163)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k_last\") AS \"TEMP(Calculation_3519281700083154949)(4055292783)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_last\") AS \"TEMP(Calculation_3519281700083154949)(4091190060)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_hd_last\") AS \"TEMP(Calculation_3519281700083154949)(4170367250)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_sd_last\") AS \"TEMP(Calculation_3519281700083154949)(4190307025)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_sd_last\") AS \"TEMP(Calculation_3519281700083154949)(933007102)(0)\",\n  MAX(\"自定义 SQL 查询\".\"stat_date\") AS \"TEMP(attr_stat_date_nk)(2102638629)(0)\",\n  MIN(\"自定义 SQL 查询\".\"stat_date\") AS \"TEMP(attr_stat_date_nk)(2790680713)(0)\",\n  \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"sum_totalUsage_ok\",\n  DATE_ADD('SECOND', 0, date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"tdy_date_ok\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices\/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND \"自定义 SQL 查询\".\"rank_level1\" = 1\nGROUP BY 37,\n  39"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k_last\") AS \"TEMP(Calculation_3519281700083154949)(101123376)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700083154949)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700083154949)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_hdp_last\") AS \"TEMP(Calculation_3519281700083154949)(1200517625)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700083154949)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p_last\") AS \"TEMP(Calculation_3519281700083154949)(1314346200)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_hd_last\") AS \"TEMP(Calculation_3519281700083154949)(146570423)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k_last\") AS \"TEMP(Calculation_3519281700083154949)(1717771635)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio_last\") AS \"TEMP(Calculation_3519281700083154949)(2313111073)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_hdp_last\") AS \"TEMP(Calculation_3519281700083154949)(258310559)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700083154949)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_video_last\") AS \"TEMP(Calculation_3519281700083154949)(2820618408)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700083154949)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700083154949)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700083154949)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700083154949)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700083154949)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k_last\") AS \"TEMP(Calculation_3519281700083154949)(3121859593)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p_last\") AS \"TEMP(Calculation_3519281700083154949)(3222422303)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio_last\") AS \"TEMP(Calculation_3519281700083154949)(3227677803)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700083154949)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700083154949)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700083154949)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video_last\") AS \"TEMP(Calculation_3519281700083154949)(3934387163)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k_last\") AS \"TEMP(Calculation_3519281700083154949)(4055292783)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_last\") AS \"TEMP(Calculation_3519281700083154949)(4091190060)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700083154949)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_hd_last\") AS \"TEMP(Calculation_3519281700083154949)(4170367250)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_sd_last\") AS \"TEMP(Calculation_3519281700083154949)(4190307025)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700083154949)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700083154949)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700083154949)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_sd_last\") AS \"TEMP(Calculation_3519281700083154949)(933007102)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700083154949)(943764407)(0)\",\n  AVG(\"自定义 SQL 查询\".\"totalUsage\") AS \"avg_totalUsage_ok\",\n  \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"sum_totalUsage_ok\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices\/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n          tag,\n          area AS Scope,\n          dim,\n            CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,\n          level2,\n          level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n            CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices\/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,\n          total AS totalUsage,\n          audio,\n          video,\n          host_audio,\n          audience_audio,\n          host_sd,\n          host_hd,\n          host_hdp,\n          host_1080p,\n          host_2k,\n          host_4k,\n          audience_sd,\n          audience_hd,\n          audience_hdp,\n          audience_1080p,\n          audience_2k,\n          audience_4k,\n          audience_audio_low_latency,\n          audience_sd_low_latency,\n          audience_hd_low_latency,\n          audience_hdp_low_latency,\n          audience_1080p_low_latency,\n          audience_2k_low_latency,\n          audience_4k_low_latency,\n          audience_audio_ultra_low_latency,\n          audience_sd_ultra_low_latency,\n          audience_hd_ultra_low_latency,\n          audience_hdp_ultra_low_latency,\n          audience_1080p_ultra_low_latency,\n          audience_2k_ultra_low_latency,\n          audience_4k_ultra_low_latency,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n          audience_video_low_latency_last1 AS audience_video_low_latency_last,\n          audience_total_low_latency_last1 AS audience_total_low_latency_last,\n          audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n          audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n          audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n          audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n          audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n          audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n          audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n          audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n          audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n          audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n          audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n          audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n          audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n          audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n          audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n          audience_2k_last1 AS audience_2k_last,\n          audience_4k_last1 AS audience_4k_last,\n          audience_1080p_last1 AS audience_1080p_last,\n          host_1080p_last1 AS host_1080p_last,\n          host_2k_last1 AS host_2k_last,\n          host_4k_last1 AS host_4k_last,\n          total_last7,\n          audio_last7,\n          video_last7,\n          video_sd_last7,\n          video_hd_last7,\n          video_hdp_last7,\n          host_sd_last7,\n          audience_sd_last7,\n          host_hd_last7,\n          audience_hd_last7,\n          host_hdp_last7,\n          audience_hdp_last7,\n          host_audio_last7,\n          audience_audio_last7,\n          host_video_last7,\n          audience_video_last7,\n          audience_audio_low_latency_last7,\n          audience_video_low_latency_last7,\n          audience_total_low_latency_last7,\n          audience_sd_low_latency_last7,\n          audience_hd_low_latency_last7,\n          audience_hdp_low_latency_last7,\n          audience_1080p_low_latency_last7,\n          audience_2k_low_latency_last7,\n          audience_4k_low_latency_last7,\n          audience_audio_ultra_low_latency_last7,\n          audience_video_ultra_low_latency_last7,\n          audience_total_ultra_low_latency_last7,\n          audience_sd_ultra_low_latency_last7,\n          audience_hd_ultra_low_latency_last7,\n          audience_hdp_ultra_low_latency_last7,\n          audience_1080p_ultra_low_latency_last7,\n          audience_2k_ultra_low_latency_last7,\n          audience_4k_ultra_low_latency_last7,\n          audience_2k_last7,\n          audience_4k_last7,\n          audience_1080p_last7,\n          host_1080p_last7,\n          host_2k_last7,\n          host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND \"自定义 SQL 查询\".\"rank_level1\" = 6 AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 36"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700341563406)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio_last7\") AS \"TEMP(Calculation_3519281700341563406)(1077563395)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700341563406)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700341563406)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd_last7\") AS \"TEMP(Calculation_3519281700341563406)(1456465729)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd_last7\") AS \"TEMP(Calculation_3519281700341563406)(1635749653)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd_last7\") AS \"TEMP(Calculation_3519281700341563406)(1747046964)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k_last7\") AS \"TEMP(Calculation_3519281700341563406)(1747524570)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp_last7\") AS \"TEMP(Calculation_3519281700341563406)(2044136109)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio_last7\") AS \"TEMP(Calculation_3519281700341563406)(2464388580)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_last7\") AS \"TEMP(Calculation_3519281700341563406)(2589233512)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700341563406)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k_last7\") AS \"TEMP(Calculation_3519281700341563406)(280796653)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700341563406)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700341563406)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700341563406)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700341563406)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700341563406)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_4k_last7\") AS \"TEMP(Calculation_3519281700341563406)(3127348545)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700341563406)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"total_last7\") AS \"TEMP(Calculation_3519281700341563406)(346677966)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k_last7\") AS \"TEMP(Calculation_3519281700341563406)(3543669678)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p_last7\") AS \"TEMP(Calculation_3519281700341563406)(3624983014)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700341563406)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700341563406)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd_last7\") AS \"TEMP(Calculation_3519281700341563406)(3905372418)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video_last7\") AS \"TEMP(Calculation_3519281700341563406)(4107040267)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700341563406)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700341563406)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p_last7\") AS \"TEMP(Calculation_3519281700341563406)(632977665)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700341563406)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp_last7\") AS \"TEMP(Calculation_3519281700341563406)(750340200)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700341563406)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700341563406)(943764407)(0)\",\n  \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"audio_video_last\") AS \"sum_audio_video_last_ok\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices\/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n          tag,\n          area AS Scope,\n          dim,\n            CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,\n          level2,\n          level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n            CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices\/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,\n          total AS totalUsage,\n          audio,\n          video,\n          host_audio,\n          audience_audio,\n          host_sd,\n          host_hd,\n          host_hdp,\n          host_1080p,\n          host_2k,\n          host_4k,\n          audience_sd,\n          audience_hd,\n          audience_hdp,\n          audience_1080p,\n          audience_2k,\n          audience_4k,\n          audience_audio_low_latency,\n          audience_sd_low_latency,\n          audience_hd_low_latency,\n          audience_hdp_low_latency,\n          audience_1080p_low_latency,\n          audience_2k_low_latency,\n          audience_4k_low_latency,\n          audience_audio_ultra_low_latency,\n          audience_sd_ultra_low_latency,\n          audience_hd_ultra_low_latency,\n          audience_hdp_ultra_low_latency,\n          audience_1080p_ultra_low_latency,\n          audience_2k_ultra_low_latency,\n          audience_4k_ultra_low_latency,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n          audience_video_low_latency_last1 AS audience_video_low_latency_last,\n          audience_total_low_latency_last1 AS audience_total_low_latency_last,\n          audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n          audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n          audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n          audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n          audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n          audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n          audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n          audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n          audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n          audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n          audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n          audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n          audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n          audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n          audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n          audience_2k_last1 AS audience_2k_last,\n          audience_4k_last1 AS audience_4k_last,\n          audience_1080p_last1 AS audience_1080p_last,\n          host_1080p_last1 AS host_1080p_last,\n          host_2k_last1 AS host_2k_last,\n          host_4k_last1 AS host_4k_last,\n          total_last7,\n          audio_last7,\n          video_last7,\n          video_sd_last7,\n          video_hd_last7,\n          video_hdp_last7,\n          host_sd_last7,\n          audience_sd_last7,\n          host_hd_last7,\n          audience_hd_last7,\n          host_hdp_last7,\n          audience_hdp_last7,\n          host_audio_last7,\n          audience_audio_last7,\n          host_video_last7,\n          audience_video_last7,\n          audience_audio_low_latency_last7,\n          audience_video_low_latency_last7,\n          audience_total_low_latency_last7,\n          audience_sd_low_latency_last7,\n          audience_hd_low_latency_last7,\n          audience_hdp_low_latency_last7,\n          audience_1080p_low_latency_last7,\n          audience_2k_low_latency_last7,\n          audience_4k_low_latency_last7,\n          audience_audio_ultra_low_latency_last7,\n          audience_video_ultra_low_latency_last7,\n          audience_total_ultra_low_latency_last7,\n          audience_sd_ultra_low_latency_last7,\n          audience_hd_ultra_low_latency_last7,\n          audience_hdp_ultra_low_latency_last7,\n          audience_1080p_ultra_low_latency_last7,\n          audience_2k_ultra_low_latency_last7,\n          audience_4k_ultra_low_latency_last7,\n          audience_2k_last7,\n          audience_4k_last7,\n          audience_1080p_last7,\n          host_1080p_last7,\n          host_2k_last7,\n          host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND \"自定义 SQL 查询\".\"rank_level1\" = 1 AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 35"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k_last\") AS \"TEMP(Calculation_3519281700083154949)(101123376)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700083154949)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700083154949)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_hdp_last\") AS \"TEMP(Calculation_3519281700083154949)(1200517625)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700083154949)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p_last\") AS \"TEMP(Calculation_3519281700083154949)(1314346200)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_hd_last\") AS \"TEMP(Calculation_3519281700083154949)(146570423)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k_last\") AS \"TEMP(Calculation_3519281700083154949)(1717771635)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio_last\") AS \"TEMP(Calculation_3519281700083154949)(2313111073)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_hdp_last\") AS \"TEMP(Calculation_3519281700083154949)(258310559)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700083154949)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_video_last\") AS \"TEMP(Calculation_3519281700083154949)(2820618408)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700083154949)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700083154949)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700083154949)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700083154949)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700083154949)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k_last\") AS \"TEMP(Calculation_3519281700083154949)(3121859593)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p_last\") AS \"TEMP(Calculation_3519281700083154949)(3222422303)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio_last\") AS \"TEMP(Calculation_3519281700083154949)(3227677803)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700083154949)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700083154949)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700083154949)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video_last\") AS \"TEMP(Calculation_3519281700083154949)(3934387163)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k_last\") AS \"TEMP(Calculation_3519281700083154949)(4055292783)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_last\") AS \"TEMP(Calculation_3519281700083154949)(4091190060)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700083154949)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_hd_last\") AS \"TEMP(Calculation_3519281700083154949)(4170367250)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_sd_last\") AS \"TEMP(Calculation_3519281700083154949)(4190307025)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700083154949)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700083154949)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700083154949)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_sd_last\") AS \"TEMP(Calculation_3519281700083154949)(933007102)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700083154949)(943764407)(0)\",\n  AVG(\"自定义 SQL 查询\".\"totalUsage\") AS \"avg_totalUsage_ok\",\n  \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"sum_totalUsage_ok\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices\/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n          tag,\n          area AS Scope,\n          dim,\n            CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,\n          level2,\n          level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n            CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices\/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,\n          total AS totalUsage,\n          audio,\n          video,\n          host_audio,\n          audience_audio,\n          host_sd,\n          host_hd,\n          host_hdp,\n          host_1080p,\n          host_2k,\n          host_4k,\n          audience_sd,\n          audience_hd,\n          audience_hdp,\n          audience_1080p,\n          audience_2k,\n          audience_4k,\n          audience_audio_low_latency,\n          audience_sd_low_latency,\n          audience_hd_low_latency,\n          audience_hdp_low_latency,\n          audience_1080p_low_latency,\n          audience_2k_low_latency,\n          audience_4k_low_latency,\n          audience_audio_ultra_low_latency,\n          audience_sd_ultra_low_latency,\n          audience_hd_ultra_low_latency,\n          audience_hdp_ultra_low_latency,\n          audience_1080p_ultra_low_latency,\n          audience_2k_ultra_low_latency,\n          audience_4k_ultra_low_latency,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n          audience_video_low_latency_last1 AS audience_video_low_latency_last,\n          audience_total_low_latency_last1 AS audience_total_low_latency_last,\n          audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n          audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n          audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n          audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n          audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n          audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n          audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n          audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n          audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n          audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n          audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n          audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n          audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n          audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n          audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n          audience_2k_last1 AS audience_2k_last,\n          audience_4k_last1 AS audience_4k_last,\n          audience_1080p_last1 AS audience_1080p_last,\n          host_1080p_last1 AS host_1080p_last,\n          host_2k_last1 AS host_2k_last,\n          host_4k_last1 AS host_4k_last,\n          total_last7,\n          audio_last7,\n          video_last7,\n          video_sd_last7,\n          video_hd_last7,\n          video_hdp_last7,\n          host_sd_last7,\n          audience_sd_last7,\n          host_hd_last7,\n          audience_hd_last7,\n          host_hdp_last7,\n          audience_hdp_last7,\n          host_audio_last7,\n          audience_audio_last7,\n          host_video_last7,\n          audience_video_last7,\n          audience_audio_low_latency_last7,\n          audience_video_low_latency_last7,\n          audience_total_low_latency_last7,\n          audience_sd_low_latency_last7,\n          audience_hd_low_latency_last7,\n          audience_hdp_low_latency_last7,\n          audience_1080p_low_latency_last7,\n          audience_2k_low_latency_last7,\n          audience_4k_low_latency_last7,\n          audience_audio_ultra_low_latency_last7,\n          audience_video_ultra_low_latency_last7,\n          audience_total_ultra_low_latency_last7,\n          audience_sd_ultra_low_latency_last7,\n          audience_hd_ultra_low_latency_last7,\n          audience_hdp_ultra_low_latency_last7,\n          audience_1080p_ultra_low_latency_last7,\n          audience_2k_ultra_low_latency_last7,\n          audience_4k_ultra_low_latency_last7,\n          audience_2k_last7,\n          audience_4k_last7,\n          audience_1080p_last7,\n          host_1080p_last7,\n          host_2k_last7,\n          host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND \"自定义 SQL 查询\".\"rank_level1\" = 4 AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 36"
	},
	{
		"presto_sql" : "SELECT \"自定义 SQL 查询\".\"level2\" AS \"level2\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"usr_Calculation_3519281700079370244_ok\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices\/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1\nGROUP BY 1"
	},
	{
		"presto_sql" : "SELECT \"自定义 SQL 查询\".\"level1\" AS \"level1\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices\/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\nGROUP BY 1\nORDER BY \"level1\""
	},
	{
		"presto_sql" : "SELECT \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"sum_totalUsage_ok\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices\/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND \"自定义 SQL 查询\".\"rank_level1\" = 7\nGROUP BY 1"
	},
	{
		"presto_sql" : "SELECT \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"sum_totalUsage_ok\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices\/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND \"自定义 SQL 查询\".\"rank_level1\" = 8\nGROUP BY 1"
	},
	{
		"presto_sql" : "SELECT \"自定义 SQL 查询\".\"level2\" AS \"level2\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"usr_Calculation_3519281700079370244_ok\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices\/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n          tag,\n          area AS Scope,\n          dim,\n            CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,\n          level2,\n          level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n            CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices\/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,\n          total AS totalUsage,\n          audio,\n          video,\n          host_audio,\n          audience_audio,\n          host_sd,\n          host_hd,\n          host_hdp,\n          host_1080p,\n          host_2k,\n          host_4k,\n          audience_sd,\n          audience_hd,\n          audience_hdp,\n          audience_1080p,\n          audience_2k,\n          audience_4k,\n          audience_audio_low_latency,\n          audience_sd_low_latency,\n          audience_hd_low_latency,\n          audience_hdp_low_latency,\n          audience_1080p_low_latency,\n          audience_2k_low_latency,\n          audience_4k_low_latency,\n          audience_audio_ultra_low_latency,\n          audience_sd_ultra_low_latency,\n          audience_hd_ultra_low_latency,\n          audience_hdp_ultra_low_latency,\n          audience_1080p_ultra_low_latency,\n          audience_2k_ultra_low_latency,\n          audience_4k_ultra_low_latency,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n          audience_video_low_latency_last1 AS audience_video_low_latency_last,\n          audience_total_low_latency_last1 AS audience_total_low_latency_last,\n          audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n          audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n          audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n          audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n          audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n          audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n          audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n          audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n          audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n          audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n          audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n          audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n          audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n          audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n          audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n          audience_2k_last1 AS audience_2k_last,\n          audience_4k_last1 AS audience_4k_last,\n          audience_1080p_last1 AS audience_1080p_last,\n          host_1080p_last1 AS host_1080p_last,\n          host_2k_last1 AS host_2k_last,\n          host_4k_last1 AS host_4k_last,\n          total_last7,\n          audio_last7,\n          video_last7,\n          video_sd_last7,\n          video_hd_last7,\n          video_hdp_last7,\n          host_sd_last7,\n          audience_sd_last7,\n          host_hd_last7,\n          audience_hd_last7,\n          host_hdp_last7,\n          audience_hdp_last7,\n          host_audio_last7,\n          audience_audio_last7,\n          host_video_last7,\n          audience_video_last7,\n          audience_audio_low_latency_last7,\n          audience_video_low_latency_last7,\n          audience_total_low_latency_last7,\n          audience_sd_low_latency_last7,\n          audience_hd_low_latency_last7,\n          audience_hdp_low_latency_last7,\n          audience_1080p_low_latency_last7,\n          audience_2k_low_latency_last7,\n          audience_4k_low_latency_last7,\n          audience_audio_ultra_low_latency_last7,\n          audience_video_ultra_low_latency_last7,\n          audience_total_ultra_low_latency_last7,\n          audience_sd_ultra_low_latency_last7,\n          audience_hd_ultra_low_latency_last7,\n          audience_hdp_ultra_low_latency_last7,\n          audience_1080p_ultra_low_latency_last7,\n          audience_2k_ultra_low_latency_last7,\n          audience_4k_ultra_low_latency_last7,\n          audience_2k_last7,\n          audience_4k_last7,\n          audience_1080p_last7,\n          host_1080p_last7,\n          host_2k_last7,\n          host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 1"
	},
	{
		"presto_sql" : "SELECT \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"sum_totalUsage_ok\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices\/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND \"自定义 SQL 查询\".\"rank_level1\" = 2\nGROUP BY 1"
	},
	{
		"presto_sql" : "SELECT \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"sum_totalUsage_ok\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices\/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND \"自定义 SQL 查询\".\"rank_level1\" = 6\nGROUP BY 1"
	},
	{
		"presto_sql" : "SELECT \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"sum_totalUsage_ok\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices\/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND \"自定义 SQL 查询\".\"rank_level1\" = 5\nGROUP BY 1"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700079370244)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700079370244)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700079370244)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700079370244)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700079370244)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700079370244)(943764407)(0)\",\n  \"自定义 SQL 查询\".\"level3\" AS \"level3\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices\/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n          tag,\n          area AS Scope,\n          dim,\n            CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,\n          level2,\n          level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n            CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices\/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,\n          total AS totalUsage,\n          audio,\n          video,\n          host_audio,\n          audience_audio,\n          host_sd,\n          host_hd,\n          host_hdp,\n          host_1080p,\n          host_2k,\n          host_4k,\n          audience_sd,\n          audience_hd,\n          audience_hdp,\n          audience_1080p,\n          audience_2k,\n          audience_4k,\n          audience_audio_low_latency,\n          audience_sd_low_latency,\n          audience_hd_low_latency,\n          audience_hdp_low_latency,\n          audience_1080p_low_latency,\n          audience_2k_low_latency,\n          audience_4k_low_latency,\n          audience_audio_ultra_low_latency,\n          audience_sd_ultra_low_latency,\n          audience_hd_ultra_low_latency,\n          audience_hdp_ultra_low_latency,\n          audience_1080p_ultra_low_latency,\n          audience_2k_ultra_low_latency,\n          audience_4k_ultra_low_latency,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n          audience_video_low_latency_last1 AS audience_video_low_latency_last,\n          audience_total_low_latency_last1 AS audience_total_low_latency_last,\n          audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n          audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n          audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n          audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n          audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n          audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n          audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n          audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n          audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n          audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n          audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n          audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n          audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n          audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n          audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n          audience_2k_last1 AS audience_2k_last,\n          audience_4k_last1 AS audience_4k_last,\n          audience_1080p_last1 AS audience_1080p_last,\n          host_1080p_last1 AS host_1080p_last,\n          host_2k_last1 AS host_2k_last,\n          host_4k_last1 AS host_4k_last,\n          total_last7,\n          audio_last7,\n          video_last7,\n          video_sd_last7,\n          video_hd_last7,\n          video_hdp_last7,\n          host_sd_last7,\n          audience_sd_last7,\n          host_hd_last7,\n          audience_hd_last7,\n          host_hdp_last7,\n          audience_hdp_last7,\n          host_audio_last7,\n          audience_audio_last7,\n          host_video_last7,\n          audience_video_last7,\n          audience_audio_low_latency_last7,\n          audience_video_low_latency_last7,\n          audience_total_low_latency_last7,\n          audience_sd_low_latency_last7,\n          audience_hd_low_latency_last7,\n          audience_hdp_low_latency_last7,\n          audience_1080p_low_latency_last7,\n          audience_2k_low_latency_last7,\n          audience_4k_low_latency_last7,\n          audience_audio_ultra_low_latency_last7,\n          audience_video_ultra_low_latency_last7,\n          audience_total_ultra_low_latency_last7,\n          audience_sd_ultra_low_latency_last7,\n          audience_hd_ultra_low_latency_last7,\n          audience_hdp_ultra_low_latency_last7,\n          audience_1080p_ultra_low_latency_last7,\n          audience_2k_ultra_low_latency_last7,\n          audience_4k_ultra_low_latency_last7,\n          audience_2k_last7,\n          audience_4k_last7,\n          audience_1080p_last7,\n          host_1080p_last7,\n          host_2k_last7,\n          host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 18"
	},
	{
		"presto_sql" : "SELECT \"自定义 SQL 查询\".\"level3\" AS \"level3\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices\/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\nGROUP BY 1\nORDER BY \"level3\""
	},
	{
		"presto_sql" : "SELECT \"自定义 SQL 查询\".\"level2\" AS \"level2\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN level1 IS NULL THEN 'Others' ELSE level1 END AS level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('Social') THEN 1 WHEN level1 IN ('Gaming') THEN 2 WHEN level1 IN ('Education') THEN 3 WHEN level1 IN ('Smart Devices\/IOT') THEN 4 WHEN level1 IN ('E-Commerce') THEN 5 WHEN level1 IN ('Sports and OTT') THEN 6 WHEN level1 IN ('Healthcare') THEN 7 WHEN level1 IN ('Enterprise') THEN 8 WHEN level1 IN ('Media & Entertainment') THEN 9 WHEN level1 IN ('Finance') THEN 10 WHEN level1 IN ('Virtual Events') THEN 11 WHEN level1 IN ('Others') THEN 12 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\nGROUP BY 1\nORDER BY \"level2\""
	},
	{
		"presto_sql" : "SELECT \"自定义 SQL 查询\".\"tag\" AS \"tag\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'VerType' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\nGROUP BY 1\nORDER BY \"tag\""
	},
	{
		"presto_sql" : "SELECT \"自定义 SQL 查询\".\"tag\" AS \"tag\"\nFROM (SELECT date,\n      SUBSTR(CAST(start_date AS VARCHAR), 1, 10) AS start_date_7,\n      SUBSTR(CAST(end_date AS VARCHAR), 1, 10) AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1,\n      product_level2,\n      product_level3,\n      product_level4,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      vid,\n      project,\n      company_id,\n      company_name,\n      dim_grouping_name,\n      rownum,\n      total,\n      total_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'VerType' AND date >= 20211113 AND date <= 20211211 AND dim IN (101, 102, 103) AND area IS NOT NULL AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\nGROUP BY 1\nORDER BY \"tag\""
	},
	{
		"presto_sql" : "SELECT \"自定义 SQL 查询\".\"Scope\" AS \"Scope\",\n  MIN(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"TEMP(attr_date_ok)(2666179902)(0)\",\n  MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"TEMP(attr_date_ok)(3625216351)(0)\",\n  MAX(\"自定义 SQL 查询\".\"stat_date\") AS \"TEMP(attr_stat_date_nk)(2102638629)(0)\",\n  MIN(\"自定义 SQL 查询\".\"stat_date\") AS \"TEMP(attr_stat_date_nk)(2790680713)(0)\",\n  \"自定义 SQL 查询\".\"company_id\" AS \"company_id\",\n  \"自定义 SQL 查询\".\"company_name\" AS \"company_name\",\n  \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  \"自定义 SQL 查询\".\"project\" AS \"project\",\n  \"自定义 SQL 查询\".\"rownum\" AS \"rownum\",\n  SUM(\"自定义 SQL 查询\".\"total\" - \"自定义 SQL 查询\".\"total_last7\") AS \"sum_Calculation_576249714462806016_ok\",\n  SUM(CASE WHEN \"自定义 SQL 查询\".\"total_last7\" > 0 THEN \"自定义 SQL 查询\".\"total\" \/ \"自定义 SQL 查询\".\"total_last7\" - 1 ELSE NULL END) AS \"sum_Calculation_576249714463748097_ok\",\n  SUM(\"自定义 SQL 查询\".\"total\") AS \"sum_total_ok\",\n  SUM(\"自定义 SQL 查询\".\"total_last7\") AS \"sum_total_last7_ok\",\n  \"自定义 SQL 查询\".\"vid\" AS \"vid\"\nFROM (SELECT date,\n      SUBSTR(CAST(start_date AS VARCHAR), 1, 10) AS start_date_7,\n      SUBSTR(CAST(end_date AS VARCHAR), 1, 10) AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1,\n      product_level2,\n      product_level3,\n      product_level4,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      vid,\n      project,\n      company_id,\n      company_name,\n      dim_grouping_name,\n      rownum,\n      total,\n      total_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'VerType' AND date >= 20211113 AND date <= 20211211 AND dim IN (101, 102, 103) AND area IS NOT NULL AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n          SUBSTR(CAST(start_date AS VARCHAR), 1, 10) AS start_date_7,\n          SUBSTR(CAST(end_date AS VARCHAR), 1, 10) AS end_date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          tag,\n          area AS Scope,\n          dim,\n          level1,\n          level2,\n          level3,\n          level4,\n          product_level1,\n          product_level2,\n          product_level3,\n          product_level4,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          vid,\n          project,\n          company_id,\n          company_name,\n          dim_grouping_name,\n          rownum,\n          total,\n          total_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'VerType' AND date >= 20211113 AND date <= 20211211 AND dim IN (101, 102, 103) AND area IS NOT NULL AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 103 AND CAST(\"自定义 SQL 查询\".\"tag\" AS VARCHAR) = 'VerType' AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 1,\n  6,\n  7,\n  8,\n  9,\n  10,\n  15"
	},
	{
		"presto_sql" : "SELECT \"自定义 SQL 查询\".\"Scope\" AS \"Scope\",\n  MIN(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"TEMP(attr_date_ok)(2666179902)(0)\",\n  MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"TEMP(attr_date_ok)(3625216351)(0)\",\n  MAX(\"自定义 SQL 查询\".\"stat_date\") AS \"TEMP(attr_stat_date_nk)(2102638629)(0)\",\n  MIN(\"自定义 SQL 查询\".\"stat_date\") AS \"TEMP(attr_stat_date_nk)(2790680713)(0)\",\n  \"自定义 SQL 查询\".\"company_id\" AS \"company_id\",\n  \"自定义 SQL 查询\".\"company_name\" AS \"company_name\",\n  \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  \"自定义 SQL 查询\".\"project\" AS \"project\",\n  \"自定义 SQL 查询\".\"rownum\" AS \"rownum\",\n  SUM(\"自定义 SQL 查询\".\"total\" - \"自定义 SQL 查询\".\"total_last7\") AS \"sum_Calculation_576249714462806016_ok\",\n  SUM(CASE WHEN \"自定义 SQL 查询\".\"total_last7\" > 0 THEN \"自定义 SQL 查询\".\"total\" \/ \"自定义 SQL 查询\".\"total_last7\" - 1 ELSE NULL END) AS \"sum_Calculation_576249714463748097_ok\",\n  SUM(\"自定义 SQL 查询\".\"rownum\") AS \"sum_rownum_ok\",\n  SUM(\"自定义 SQL 查询\".\"total\") AS \"sum_total_ok\",\n  SUM(\"自定义 SQL 查询\".\"total_last7\") AS \"sum_total_last7_ok\",\n  \"自定义 SQL 查询\".\"vid\" AS \"vid\"\nFROM (SELECT date,\n      SUBSTR(CAST(start_date AS VARCHAR), 1, 10) AS start_date_7,\n      SUBSTR(CAST(end_date AS VARCHAR), 1, 10) AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1,\n      product_level2,\n      product_level3,\n      product_level4,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      vid,\n      project,\n      company_id,\n      company_name,\n      dim_grouping_name,\n      rownum,\n      total,\n      total_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'VerType' AND date >= 20211113 AND date <= 20211211 AND dim IN (101, 102, 103) AND area IS NOT NULL AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n          SUBSTR(CAST(start_date AS VARCHAR), 1, 10) AS start_date_7,\n          SUBSTR(CAST(end_date AS VARCHAR), 1, 10) AS end_date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          tag,\n          area AS Scope,\n          dim,\n          level1,\n          level2,\n          level3,\n          level4,\n          product_level1,\n          product_level2,\n          product_level3,\n          product_level4,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          vid,\n          project,\n          company_id,\n          company_name,\n          dim_grouping_name,\n          rownum,\n          total,\n          total_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'VerType' AND date >= 20211113 AND date <= 20211211 AND dim IN (101, 102, 103) AND area IS NOT NULL AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 101 AND CAST(\"自定义 SQL 查询\".\"tag\" AS VARCHAR) = 'VerType' AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 1,\n  6,\n  7,\n  8,\n  9,\n  10,\n  16"
	},
	{
		"presto_sql" : "SELECT \"自定义 SQL 查询\".\"Scope\" AS \"Scope\",\n  MIN(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"TEMP(attr_date_ok)(2666179902)(0)\",\n  MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"TEMP(attr_date_ok)(3625216351)(0)\",\n  \"自定义 SQL 查询\".\"company_id\" AS \"company_id\",\n  \"自定义 SQL 查询\".\"company_name\" AS \"company_name\",\n  \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  \"自定义 SQL 查询\".\"project\" AS \"project\",\n  \"自定义 SQL 查询\".\"rownum\" AS \"rownum\",\n  \"自定义 SQL 查询\".\"stat_date\" AS \"stat_date\",\n  SUM(\"自定义 SQL 查询\".\"total\" - \"自定义 SQL 查询\".\"total_last7\") AS \"sum_Calculation_576249714462806016_ok\",\n  SUM(CASE WHEN \"自定义 SQL 查询\".\"total_last7\" > 0 THEN \"自定义 SQL 查询\".\"total\" \/ \"自定义 SQL 查询\".\"total_last7\" - 1 ELSE NULL END) AS \"sum_Calculation_576249714463748097_ok\",\n  SUM(\"自定义 SQL 查询\".\"total\") AS \"sum_total_ok\",\n  SUM(\"自定义 SQL 查询\".\"total_last7\") AS \"sum_total_last7_ok\",\n  \"自定义 SQL 查询\".\"vid\" AS \"vid\"\nFROM (SELECT date,\n      SUBSTR(CAST(start_date AS VARCHAR), 1, 10) AS start_date_7,\n      SUBSTR(CAST(end_date AS VARCHAR), 1, 10) AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1,\n      product_level2,\n      product_level3,\n      product_level4,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      vid,\n      project,\n      company_id,\n      company_name,\n      dim_grouping_name,\n      rownum,\n      total,\n      total_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'VerType' AND date >= 20211113 AND date <= 20211211 AND dim IN (101, 102, 103) AND area IS NOT NULL AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n          SUBSTR(CAST(start_date AS VARCHAR), 1, 10) AS start_date_7,\n          SUBSTR(CAST(end_date AS VARCHAR), 1, 10) AS end_date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          tag,\n          area AS Scope,\n          dim,\n          level1,\n          level2,\n          level3,\n          level4,\n          product_level1,\n          product_level2,\n          product_level3,\n          product_level4,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          vid,\n          project,\n          company_id,\n          company_name,\n          dim_grouping_name,\n          rownum,\n          total,\n          total_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'VerType' AND date >= 20211113 AND date <= 20211211 AND dim IN (101, 102, 103) AND area IS NOT NULL AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 102 AND CAST(\"自定义 SQL 查询\".\"tag\" AS VARCHAR) = 'VerType' AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 1,\n  4,\n  5,\n  6,\n  7,\n  8,\n  9,\n  14"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700079370244)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700079370244)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700079370244)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700079370244)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700079370244)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700079370244)(943764407)(0)\",\n  \"自定义 SQL 查询\".\"level1\" AS \"TEMP(attr_level1_nk)(1482809429)(0)\",\n  \"自定义 SQL 查询\".\"level1\" AS \"TEMP(attr_level1_nk)(3765460736)(0)\",\n  MAX(\"自定义 SQL 查询\".\"stat_date\") AS \"TEMP(attr_stat_date_nk)(2102638629)(0)\",\n  MIN(\"自定义 SQL 查询\".\"stat_date\") AS \"TEMP(attr_stat_date_nk)(2790680713)(0)\",\n  \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  DATE_ADD('SECOND', 0, date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"tdy_date_ok\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'VerType' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1\nGROUP BY 18,\n  23"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700079370244)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700079370244)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700079370244)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700079370244)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700079370244)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700079370244)(943764407)(0)\",\n  MAX(\"自定义 SQL 查询\".\"rank_level1\") AS \"TEMP(attr_rank_level1_qk)(289677037)(0)\",\n  MIN(\"自定义 SQL 查询\".\"rank_level1\") AS \"TEMP(attr_rank_level1_qk)(992764851)(0)\",\n  \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  \"自定义 SQL 查询\".\"stat_date\" AS \"stat_date\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"sum_totalUsage_ok\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'VerType' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n          tag,\n          area AS Scope,\n          dim,\n          level1,\n          level2,\n          level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n            CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n          total AS totalUsage,\n          audio,\n          video,\n          host_audio,\n          audience_audio,\n          host_sd,\n          host_hd,\n          host_hdp,\n          host_1080p,\n          host_2k,\n          host_4k,\n          audience_sd,\n          audience_hd,\n          audience_hdp,\n          audience_1080p,\n          audience_2k,\n          audience_4k,\n          audience_audio_low_latency,\n          audience_sd_low_latency,\n          audience_hd_low_latency,\n          audience_hdp_low_latency,\n          audience_1080p_low_latency,\n          audience_2k_low_latency,\n          audience_4k_low_latency,\n          audience_audio_ultra_low_latency,\n          audience_sd_ultra_low_latency,\n          audience_hd_ultra_low_latency,\n          audience_hdp_ultra_low_latency,\n          audience_1080p_ultra_low_latency,\n          audience_2k_ultra_low_latency,\n          audience_4k_ultra_low_latency,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n          audience_video_low_latency_last1 AS audience_video_low_latency_last,\n          audience_total_low_latency_last1 AS audience_total_low_latency_last,\n          audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n          audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n          audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n          audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n          audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n          audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n          audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n          audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n          audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n          audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n          audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n          audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n          audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n          audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n          audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n          audience_2k_last1 AS audience_2k_last,\n          audience_4k_last1 AS audience_4k_last,\n          audience_1080p_last1 AS audience_1080p_last,\n          host_1080p_last1 AS host_1080p_last,\n          host_2k_last1 AS host_2k_last,\n          host_4k_last1 AS host_4k_last,\n          total_last7,\n          audio_last7,\n          video_last7,\n          video_sd_last7,\n          video_hd_last7,\n          video_hdp_last7,\n          host_sd_last7,\n          audience_sd_last7,\n          host_hd_last7,\n          audience_hd_last7,\n          host_hdp_last7,\n          audience_hdp_last7,\n          host_audio_last7,\n          audience_audio_last7,\n          host_video_last7,\n          audience_video_last7,\n          audience_audio_low_latency_last7,\n          audience_video_low_latency_last7,\n          audience_total_low_latency_last7,\n          audience_sd_low_latency_last7,\n          audience_hd_low_latency_last7,\n          audience_hdp_low_latency_last7,\n          audience_1080p_low_latency_last7,\n          audience_2k_low_latency_last7,\n          audience_4k_low_latency_last7,\n          audience_audio_ultra_low_latency_last7,\n          audience_video_ultra_low_latency_last7,\n          audience_total_ultra_low_latency_last7,\n          audience_sd_ultra_low_latency_last7,\n          audience_hd_ultra_low_latency_last7,\n          audience_hdp_ultra_low_latency_last7,\n          audience_1080p_ultra_low_latency_last7,\n          audience_2k_ultra_low_latency_last7,\n          audience_4k_ultra_low_latency_last7,\n          audience_2k_last7,\n          audience_4k_last7,\n          audience_1080p_last7,\n          host_1080p_last7,\n          host_2k_last7,\n          host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'VerType' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 20,\n  21"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700079370244)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700079370244)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700079370244)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700079370244)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700079370244)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700079370244)(943764407)(0)\",\n  \"自定义 SQL 查询\".\"level1\" AS \"TEMP(attr_level1_nk)(1482809429)(0)\",\n  \"自定义 SQL 查询\".\"level1\" AS \"TEMP(attr_level1_nk)(3765460736)(0)\",\n  \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  \"自定义 SQL 查询\".\"stat_date\" AS \"stat_date\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'VerType' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n          tag,\n          area AS Scope,\n          dim,\n          level1,\n          level2,\n          level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n            CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n          total AS totalUsage,\n          audio,\n          video,\n          host_audio,\n          audience_audio,\n          host_sd,\n          host_hd,\n          host_hdp,\n          host_1080p,\n          host_2k,\n          host_4k,\n          audience_sd,\n          audience_hd,\n          audience_hdp,\n          audience_1080p,\n          audience_2k,\n          audience_4k,\n          audience_audio_low_latency,\n          audience_sd_low_latency,\n          audience_hd_low_latency,\n          audience_hdp_low_latency,\n          audience_1080p_low_latency,\n          audience_2k_low_latency,\n          audience_4k_low_latency,\n          audience_audio_ultra_low_latency,\n          audience_sd_ultra_low_latency,\n          audience_hd_ultra_low_latency,\n          audience_hdp_ultra_low_latency,\n          audience_1080p_ultra_low_latency,\n          audience_2k_ultra_low_latency,\n          audience_4k_ultra_low_latency,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n          audience_video_low_latency_last1 AS audience_video_low_latency_last,\n          audience_total_low_latency_last1 AS audience_total_low_latency_last,\n          audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n          audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n          audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n          audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n          audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n          audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n          audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n          audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n          audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n          audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n          audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n          audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n          audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n          audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n          audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n          audience_2k_last1 AS audience_2k_last,\n          audience_4k_last1 AS audience_4k_last,\n          audience_1080p_last1 AS audience_1080p_last,\n          host_1080p_last1 AS host_1080p_last,\n          host_2k_last1 AS host_2k_last,\n          host_4k_last1 AS host_4k_last,\n          total_last7,\n          audio_last7,\n          video_last7,\n          video_sd_last7,\n          video_hd_last7,\n          video_hdp_last7,\n          host_sd_last7,\n          audience_sd_last7,\n          host_hd_last7,\n          audience_hd_last7,\n          host_hdp_last7,\n          audience_hdp_last7,\n          host_audio_last7,\n          audience_audio_last7,\n          host_video_last7,\n          audience_video_last7,\n          audience_audio_low_latency_last7,\n          audience_video_low_latency_last7,\n          audience_total_low_latency_last7,\n          audience_sd_low_latency_last7,\n          audience_hd_low_latency_last7,\n          audience_hdp_low_latency_last7,\n          audience_1080p_low_latency_last7,\n          audience_2k_low_latency_last7,\n          audience_4k_low_latency_last7,\n          audience_audio_ultra_low_latency_last7,\n          audience_video_ultra_low_latency_last7,\n          audience_total_ultra_low_latency_last7,\n          audience_sd_ultra_low_latency_last7,\n          audience_hd_ultra_low_latency_last7,\n          audience_hdp_ultra_low_latency_last7,\n          audience_1080p_ultra_low_latency_last7,\n          audience_2k_ultra_low_latency_last7,\n          audience_4k_ultra_low_latency_last7,\n          audience_2k_last7,\n          audience_4k_last7,\n          audience_1080p_last7,\n          host_1080p_last7,\n          host_2k_last7,\n          host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'VerType' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 18,\n  21"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700079370244)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700079370244)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700079370244)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700079370244)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700079370244)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700079370244)(943764407)(0)\",\n  \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"sum_totalUsage_ok\",\n  DATE_ADD('SECOND', 0, date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"tdy_date_ok\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'VerType' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n          tag,\n          area AS Scope,\n          dim,\n          level1,\n          level2,\n          level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n            CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n          total AS totalUsage,\n          audio,\n          video,\n          host_audio,\n          audience_audio,\n          host_sd,\n          host_hd,\n          host_hdp,\n          host_1080p,\n          host_2k,\n          host_4k,\n          audience_sd,\n          audience_hd,\n          audience_hdp,\n          audience_1080p,\n          audience_2k,\n          audience_4k,\n          audience_audio_low_latency,\n          audience_sd_low_latency,\n          audience_hd_low_latency,\n          audience_hdp_low_latency,\n          audience_1080p_low_latency,\n          audience_2k_low_latency,\n          audience_4k_low_latency,\n          audience_audio_ultra_low_latency,\n          audience_sd_ultra_low_latency,\n          audience_hd_ultra_low_latency,\n          audience_hdp_ultra_low_latency,\n          audience_1080p_ultra_low_latency,\n          audience_2k_ultra_low_latency,\n          audience_4k_ultra_low_latency,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n          audience_video_low_latency_last1 AS audience_video_low_latency_last,\n          audience_total_low_latency_last1 AS audience_total_low_latency_last,\n          audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n          audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n          audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n          audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n          audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n          audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n          audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n          audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n          audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n          audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n          audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n          audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n          audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n          audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n          audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n          audience_2k_last1 AS audience_2k_last,\n          audience_4k_last1 AS audience_4k_last,\n          audience_1080p_last1 AS audience_1080p_last,\n          host_1080p_last1 AS host_1080p_last,\n          host_2k_last1 AS host_2k_last,\n          host_4k_last1 AS host_4k_last,\n          total_last7,\n          audio_last7,\n          video_last7,\n          video_sd_last7,\n          video_hd_last7,\n          video_hdp_last7,\n          host_sd_last7,\n          audience_sd_last7,\n          host_hd_last7,\n          audience_hd_last7,\n          host_hdp_last7,\n          audience_hdp_last7,\n          host_audio_last7,\n          audience_audio_last7,\n          host_video_last7,\n          audience_video_last7,\n          audience_audio_low_latency_last7,\n          audience_video_low_latency_last7,\n          audience_total_low_latency_last7,\n          audience_sd_low_latency_last7,\n          audience_hd_low_latency_last7,\n          audience_hdp_low_latency_last7,\n          audience_1080p_low_latency_last7,\n          audience_2k_low_latency_last7,\n          audience_4k_low_latency_last7,\n          audience_audio_ultra_low_latency_last7,\n          audience_video_ultra_low_latency_last7,\n          audience_total_ultra_low_latency_last7,\n          audience_sd_ultra_low_latency_last7,\n          audience_hd_ultra_low_latency_last7,\n          audience_hdp_ultra_low_latency_last7,\n          audience_1080p_ultra_low_latency_last7,\n          audience_2k_ultra_low_latency_last7,\n          audience_4k_ultra_low_latency_last7,\n          audience_2k_last7,\n          audience_4k_last7,\n          audience_1080p_last7,\n          host_1080p_last7,\n          host_2k_last7,\n          host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'VerType' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND \"自定义 SQL 查询\".\"rank_level1\" = 4 AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 18,\n  20"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3515481736398049302)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video_hd\") AS \"TEMP(Calculation_3515481736398049302)(843876055)(0)\",\n  CONCAT(CONCAT(CONCAT(CONCAT(CONCAT(CAST(YEAR(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS VARCHAR)), '-'), CONCAT(CAST(MONTH(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS VARCHAR))), '-'), CONCAT(CAST(DAY_OF_MONTH(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS VARCHAR))) AS \"TEMP(attr_ture_period (复制)_5872482815214256134_nk)(2678011\",\n  CONCAT(CONCAT(CONCAT(CONCAT(CONCAT(CAST(YEAR(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS VARCHAR)), '-'), CONCAT(CAST(MONTH(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS VARCHAR))), '-'), CONCAT(CAST(DAY_OF_MONTH(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS VARCHAR))) AS \"TEMP(attr_ture_period (复制)_5872482815214256134_nk)(2988244\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp_Rtls\") AS \"TEMP(audience_RTLS_hd_audience_RTLS_video (复制) (复制) (\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_Rtls\") AS \"TEMP(audience_RTLS_hd_audience_RTLS_video (复制) (复制) (1\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd_Rtls\") AS \"TEMP(audience_RTLS_hd_audience_RTLS_video (复制) (复制)_35\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(audience_hd_audience_video (复制) (复制)_351548173639\",\n  SUM(\"自定义 SQL 查询\".\"audience_video\") AS \"TEMP(audience_hd_audience_video (复制) (复制)_351548173631\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(audience_hd_audience_video (复制)_3515481736399089690)(\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd_Rtls\") AS \"TEMP(audience_hd_audience_video (复制)_3515481736399372316)(\",\n  SUM(\"自定义 SQL 查询\".\"video_hdp\") AS \"TEMP(video_hd_video (复制) (复制)_3515481736398229528)(156\",\n  SUM(\"自定义 SQL 查询\".\"video_sd\") AS \"TEMP(video_hd_video (复制)_3515481736398217239)(3165650715)(\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(video_hd_video (复制)_3515481736398913561)(2930728935)(\",\n  \"自定义 SQL 查询\".\"date\" AS \"date\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"sum_audience_audio_ok\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio_Rtls\") AS \"sum_audience_audio_Rtls_ok\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"sum_audience_hd_ok\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd_Rtls\") AS \"sum_audience_hd_Rtls_ok\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"sum_audience_hdp_ok\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp_Rtls\") AS \"sum_audience_hdp_Rtls_ok\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"sum_audience_sd_ok\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd_Rtls\") AS \"sum_audience_sd_Rtls_ok\",\n  SUM(\"自定义 SQL 查询\".\"audience_total\") AS \"sum_audience_total_ok\",\n  SUM(\"自定义 SQL 查询\".\"audience_total_Rtls\") AS \"sum_audience_total_Rtls_ok\",\n  SUM(\"自定义 SQL 查询\".\"audience_video\") AS \"sum_audience_video_ok\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_Rtls\") AS \"sum_audience_video_Rtls_ok\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"sum_audio_ok\",\n  SUM(\"自定义 SQL 查询\".\"total\") AS \"sum_total_ok\",\n  SUM(\"自定义 SQL 查询\".\"video_hd\") AS \"sum_video_hd_ok\",\n  SUM(\"自定义 SQL 查询\".\"video_hdp\") AS \"sum_video_hdp_ok\",\n  SUM(\"自定义 SQL 查询\".\"video_sd\") AS \"sum_video_sd_ok\"\nFROM (SELECT date,\n      tag,\n      dim_grouping_name,\n      area,\n        SUM(audio) + SUM(video) AS total,\n      SUM(audio) AS audio,\n      SUM(video) AS video,\n      SUM(video_sd) AS video_sd,\n      SUM(video_hd) AS video_hd,\n      SUM(video_hdp) AS video_hdp,\n        SUM(audience_audio) + SUM(audience_video) AS audience_total,\n      SUM(audience_audio) AS audience_audio,\n      SUM(audience_video) AS audience_video,\n      SUM(audience_sd) AS audience_sd,\n      SUM(audience_hd) AS audience_hd,\n      SUM(audience_hdp) AS audience_hdp,\n      SUM(audience_total_low_latency) AS audience_total_Rtls,\n      SUM(audience_audio_low_latency) AS audience_audio_Rtls,\n      SUM(audience_video_low_latency) AS audience_video_Rtls,\n      SUM(audience_sd_low_latency) AS audience_sd_Rtls,\n      SUM(audience_hd_low_latency) AS audience_hd_Rtls,\n      SUM(audience_hdp_low_latency) AS audience_hdp_Rtls,\n      SUM(total_last1) AS total_last1,\n      SUM(audio_last1) AS audio_last1,\n      SUM(video_last1) AS video_last1,\n        SUM(audience_audio_last1) + SUM(audience_video_last1) AS audience_total_last1,\n      SUM(audience_audio_last1) AS audience_audio_last1,\n      SUM(audience_video_last1) AS audience_video_last1,\n      SUM(audience_total_low_latency_last1) AS audience_total_Rtls_last1,\n      SUM(audience_audio_low_latency_last1) AS audience_audio_Rtls_last1,\n      SUM(audience_video_low_latency_last1) AS audience_video_Rtls_last1,\n      SUM(total_last7) AS total_last7,\n      SUM(audio_last7) AS audio_last7,\n      SUM(video_last7) AS video_last7,\n        SUM(audience_audio_last7) + SUM(audience_video_last7) AS audience_total_last7,\n      SUM(audience_audio_last7) AS audience_audio_last7,\n      SUM(audience_video_last7) AS audience_video_last7,\n      SUM(audience_total_low_latency_last7) AS audience_total_Rtls_last7,\n      SUM(audience_audio_low_latency_last7) AS audience_audio_Rtls_last7,\n      SUM(audience_video_low_latency_last7) AS audience_video_Rtls_last7\n    FROM report_datahub.levels_usage_dod_di_1\n    WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') BETWEEN DATE('2021-11-13') AND DATE('2021-12-13') AND CAST(tag AS VARCHAR) = 'SpecialGroup' AND dim = 1 AND CAST(level1 AS VARCHAR) = 'RTLSVID' AND area IS NOT NULL\n    GROUP BY 1,\n      2,\n      3,\n      4) AS \"自定义 SQL 查询\"\nWHERE \"自定义 SQL 查询\".\"area\" IN ('China', 'Not China')\nGROUP BY 15"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700079370244)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700079370244)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700079370244)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700079370244)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700079370244)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700079370244)(943764407)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_4k_last\") AS \"TEMP(Calculation_3519281700083154949)(101123376)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_hdp_last\") AS \"TEMP(Calculation_3519281700083154949)(1200517625)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p_last\") AS \"TEMP(Calculation_3519281700083154949)(1314346200)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_hd_last\") AS \"TEMP(Calculation_3519281700083154949)(146570423)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k_last\") AS \"TEMP(Calculation_3519281700083154949)(1717771635)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio_last\") AS \"TEMP(Calculation_3519281700083154949)(2313111073)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_hdp_last\") AS \"TEMP(Calculation_3519281700083154949)(258310559)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_video_last\") AS \"TEMP(Calculation_3519281700083154949)(2820618408)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k_last\") AS \"TEMP(Calculation_3519281700083154949)(3121859593)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p_last\") AS \"TEMP(Calculation_3519281700083154949)(3222422303)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio_last\") AS \"TEMP(Calculation_3519281700083154949)(3227677803)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video_last\") AS \"TEMP(Calculation_3519281700083154949)(3934387163)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k_last\") AS \"TEMP(Calculation_3519281700083154949)(4055292783)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_last\") AS \"TEMP(Calculation_3519281700083154949)(4091190060)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_hd_last\") AS \"TEMP(Calculation_3519281700083154949)(4170367250)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_sd_last\") AS \"TEMP(Calculation_3519281700083154949)(4190307025)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_sd_last\") AS \"TEMP(Calculation_3519281700083154949)(933007102)(0)\",\n  MAX(\"自定义 SQL 查询\".\"stat_date\") AS \"TEMP(attr_stat_date_nk)(2102638629)(0)\",\n  MIN(\"自定义 SQL 查询\".\"stat_date\") AS \"TEMP(attr_stat_date_nk)(2790680713)(0)\",\n  \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"sum_totalUsage_ok\",\n  DATE_ADD('SECOND', 0, date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"tdy_date_ok\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'VerType' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND \"自定义 SQL 查询\".\"rank_level1\" = 2\nGROUP BY 37,\n  39"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700079370244)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700079370244)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700079370244)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700079370244)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700079370244)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700079370244)(943764407)(0)\",\n  \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"sum_totalUsage_ok\",\n  DATE_ADD('SECOND', 0, date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"tdy_date_ok\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'VerType' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n          tag,\n          area AS Scope,\n          dim,\n          level1,\n          level2,\n          level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n            CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n          total AS totalUsage,\n          audio,\n          video,\n          host_audio,\n          audience_audio,\n          host_sd,\n          host_hd,\n          host_hdp,\n          host_1080p,\n          host_2k,\n          host_4k,\n          audience_sd,\n          audience_hd,\n          audience_hdp,\n          audience_1080p,\n          audience_2k,\n          audience_4k,\n          audience_audio_low_latency,\n          audience_sd_low_latency,\n          audience_hd_low_latency,\n          audience_hdp_low_latency,\n          audience_1080p_low_latency,\n          audience_2k_low_latency,\n          audience_4k_low_latency,\n          audience_audio_ultra_low_latency,\n          audience_sd_ultra_low_latency,\n          audience_hd_ultra_low_latency,\n          audience_hdp_ultra_low_latency,\n          audience_1080p_ultra_low_latency,\n          audience_2k_ultra_low_latency,\n          audience_4k_ultra_low_latency,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n          audience_video_low_latency_last1 AS audience_video_low_latency_last,\n          audience_total_low_latency_last1 AS audience_total_low_latency_last,\n          audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n          audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n          audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n          audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n          audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n          audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n          audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n          audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n          audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n          audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n          audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n          audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n          audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n          audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n          audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n          audience_2k_last1 AS audience_2k_last,\n          audience_4k_last1 AS audience_4k_last,\n          audience_1080p_last1 AS audience_1080p_last,\n          host_1080p_last1 AS host_1080p_last,\n          host_2k_last1 AS host_2k_last,\n          host_4k_last1 AS host_4k_last,\n          total_last7,\n          audio_last7,\n          video_last7,\n          video_sd_last7,\n          video_hd_last7,\n          video_hdp_last7,\n          host_sd_last7,\n          audience_sd_last7,\n          host_hd_last7,\n          audience_hd_last7,\n          host_hdp_last7,\n          audience_hdp_last7,\n          host_audio_last7,\n          audience_audio_last7,\n          host_video_last7,\n          audience_video_last7,\n          audience_audio_low_latency_last7,\n          audience_video_low_latency_last7,\n          audience_total_low_latency_last7,\n          audience_sd_low_latency_last7,\n          audience_hd_low_latency_last7,\n          audience_hdp_low_latency_last7,\n          audience_1080p_low_latency_last7,\n          audience_2k_low_latency_last7,\n          audience_4k_low_latency_last7,\n          audience_audio_ultra_low_latency_last7,\n          audience_video_ultra_low_latency_last7,\n          audience_total_ultra_low_latency_last7,\n          audience_sd_ultra_low_latency_last7,\n          audience_hd_ultra_low_latency_last7,\n          audience_hdp_ultra_low_latency_last7,\n          audience_1080p_ultra_low_latency_last7,\n          audience_2k_ultra_low_latency_last7,\n          audience_4k_ultra_low_latency_last7,\n          audience_2k_last7,\n          audience_4k_last7,\n          audience_1080p_last7,\n          host_1080p_last7,\n          host_2k_last7,\n          host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'VerType' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND \"自定义 SQL 查询\".\"rank_level1\" = 8 AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 18,\n  20"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k_last\") AS \"TEMP(Calculation_3519281700083154949)(101123376)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700083154949)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700083154949)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_hdp_last\") AS \"TEMP(Calculation_3519281700083154949)(1200517625)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700083154949)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p_last\") AS \"TEMP(Calculation_3519281700083154949)(1314346200)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_hd_last\") AS \"TEMP(Calculation_3519281700083154949)(146570423)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k_last\") AS \"TEMP(Calculation_3519281700083154949)(1717771635)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio_last\") AS \"TEMP(Calculation_3519281700083154949)(2313111073)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_hdp_last\") AS \"TEMP(Calculation_3519281700083154949)(258310559)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700083154949)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_video_last\") AS \"TEMP(Calculation_3519281700083154949)(2820618408)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700083154949)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700083154949)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700083154949)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700083154949)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700083154949)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k_last\") AS \"TEMP(Calculation_3519281700083154949)(3121859593)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p_last\") AS \"TEMP(Calculation_3519281700083154949)(3222422303)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio_last\") AS \"TEMP(Calculation_3519281700083154949)(3227677803)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700083154949)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700083154949)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700083154949)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video_last\") AS \"TEMP(Calculation_3519281700083154949)(3934387163)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k_last\") AS \"TEMP(Calculation_3519281700083154949)(4055292783)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_last\") AS \"TEMP(Calculation_3519281700083154949)(4091190060)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700083154949)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_hd_last\") AS \"TEMP(Calculation_3519281700083154949)(4170367250)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_sd_last\") AS \"TEMP(Calculation_3519281700083154949)(4190307025)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700083154949)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700083154949)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700083154949)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_sd_last\") AS \"TEMP(Calculation_3519281700083154949)(933007102)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700083154949)(943764407)(0)\",\n  AVG(\"自定义 SQL 查询\".\"totalUsage\") AS \"avg_totalUsage_ok\",\n  \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"sum_totalUsage_ok\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'VerType' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n          tag,\n          area AS Scope,\n          dim,\n          level1,\n          level2,\n          level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n            CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n          total AS totalUsage,\n          audio,\n          video,\n          host_audio,\n          audience_audio,\n          host_sd,\n          host_hd,\n          host_hdp,\n          host_1080p,\n          host_2k,\n          host_4k,\n          audience_sd,\n          audience_hd,\n          audience_hdp,\n          audience_1080p,\n          audience_2k,\n          audience_4k,\n          audience_audio_low_latency,\n          audience_sd_low_latency,\n          audience_hd_low_latency,\n          audience_hdp_low_latency,\n          audience_1080p_low_latency,\n          audience_2k_low_latency,\n          audience_4k_low_latency,\n          audience_audio_ultra_low_latency,\n          audience_sd_ultra_low_latency,\n          audience_hd_ultra_low_latency,\n          audience_hdp_ultra_low_latency,\n          audience_1080p_ultra_low_latency,\n          audience_2k_ultra_low_latency,\n          audience_4k_ultra_low_latency,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n          audience_video_low_latency_last1 AS audience_video_low_latency_last,\n          audience_total_low_latency_last1 AS audience_total_low_latency_last,\n          audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n          audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n          audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n          audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n          audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n          audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n          audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n          audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n          audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n          audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n          audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n          audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n          audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n          audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n          audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n          audience_2k_last1 AS audience_2k_last,\n          audience_4k_last1 AS audience_4k_last,\n          audience_1080p_last1 AS audience_1080p_last,\n          host_1080p_last1 AS host_1080p_last,\n          host_2k_last1 AS host_2k_last,\n          host_4k_last1 AS host_4k_last,\n          total_last7,\n          audio_last7,\n          video_last7,\n          video_sd_last7,\n          video_hd_last7,\n          video_hdp_last7,\n          host_sd_last7,\n          audience_sd_last7,\n          host_hd_last7,\n          audience_hd_last7,\n          host_hdp_last7,\n          audience_hdp_last7,\n          host_audio_last7,\n          audience_audio_last7,\n          host_video_last7,\n          audience_video_last7,\n          audience_audio_low_latency_last7,\n          audience_video_low_latency_last7,\n          audience_total_low_latency_last7,\n          audience_sd_low_latency_last7,\n          audience_hd_low_latency_last7,\n          audience_hdp_low_latency_last7,\n          audience_1080p_low_latency_last7,\n          audience_2k_low_latency_last7,\n          audience_4k_low_latency_last7,\n          audience_audio_ultra_low_latency_last7,\n          audience_video_ultra_low_latency_last7,\n          audience_total_ultra_low_latency_last7,\n          audience_sd_ultra_low_latency_last7,\n          audience_hd_ultra_low_latency_last7,\n          audience_hdp_ultra_low_latency_last7,\n          audience_1080p_ultra_low_latency_last7,\n          audience_2k_ultra_low_latency_last7,\n          audience_4k_ultra_low_latency_last7,\n          audience_2k_last7,\n          audience_4k_last7,\n          audience_1080p_last7,\n          host_1080p_last7,\n          host_2k_last7,\n          host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'VerType' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND \"自定义 SQL 查询\".\"rank_level1\" = 8 AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 36"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700341563406)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio_last7\") AS \"TEMP(Calculation_3519281700341563406)(1077563395)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700341563406)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700341563406)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd_last7\") AS \"TEMP(Calculation_3519281700341563406)(1456465729)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd_last7\") AS \"TEMP(Calculation_3519281700341563406)(1635749653)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd_last7\") AS \"TEMP(Calculation_3519281700341563406)(1747046964)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k_last7\") AS \"TEMP(Calculation_3519281700341563406)(1747524570)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp_last7\") AS \"TEMP(Calculation_3519281700341563406)(2044136109)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio_last7\") AS \"TEMP(Calculation_3519281700341563406)(2464388580)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_last7\") AS \"TEMP(Calculation_3519281700341563406)(2589233512)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700341563406)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k_last7\") AS \"TEMP(Calculation_3519281700341563406)(280796653)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700341563406)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700341563406)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700341563406)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700341563406)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700341563406)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_4k_last7\") AS \"TEMP(Calculation_3519281700341563406)(3127348545)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700341563406)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"total_last7\") AS \"TEMP(Calculation_3519281700341563406)(346677966)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k_last7\") AS \"TEMP(Calculation_3519281700341563406)(3543669678)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p_last7\") AS \"TEMP(Calculation_3519281700341563406)(3624983014)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700341563406)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700341563406)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd_last7\") AS \"TEMP(Calculation_3519281700341563406)(3905372418)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video_last7\") AS \"TEMP(Calculation_3519281700341563406)(4107040267)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700341563406)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700341563406)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p_last7\") AS \"TEMP(Calculation_3519281700341563406)(632977665)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700341563406)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp_last7\") AS \"TEMP(Calculation_3519281700341563406)(750340200)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700341563406)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700341563406)(943764407)(0)\",\n  \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"audio_video_last\") AS \"sum_audio_video_last_ok\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'VerType' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n          tag,\n          area AS Scope,\n          dim,\n          level1,\n          level2,\n          level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n            CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n          total AS totalUsage,\n          audio,\n          video,\n          host_audio,\n          audience_audio,\n          host_sd,\n          host_hd,\n          host_hdp,\n          host_1080p,\n          host_2k,\n          host_4k,\n          audience_sd,\n          audience_hd,\n          audience_hdp,\n          audience_1080p,\n          audience_2k,\n          audience_4k,\n          audience_audio_low_latency,\n          audience_sd_low_latency,\n          audience_hd_low_latency,\n          audience_hdp_low_latency,\n          audience_1080p_low_latency,\n          audience_2k_low_latency,\n          audience_4k_low_latency,\n          audience_audio_ultra_low_latency,\n          audience_sd_ultra_low_latency,\n          audience_hd_ultra_low_latency,\n          audience_hdp_ultra_low_latency,\n          audience_1080p_ultra_low_latency,\n          audience_2k_ultra_low_latency,\n          audience_4k_ultra_low_latency,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n          audience_video_low_latency_last1 AS audience_video_low_latency_last,\n          audience_total_low_latency_last1 AS audience_total_low_latency_last,\n          audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n          audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n          audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n          audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n          audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n          audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n          audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n          audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n          audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n          audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n          audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n          audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n          audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n          audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n          audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n          audience_2k_last1 AS audience_2k_last,\n          audience_4k_last1 AS audience_4k_last,\n          audience_1080p_last1 AS audience_1080p_last,\n          host_1080p_last1 AS host_1080p_last,\n          host_2k_last1 AS host_2k_last,\n          host_4k_last1 AS host_4k_last,\n          total_last7,\n          audio_last7,\n          video_last7,\n          video_sd_last7,\n          video_hd_last7,\n          video_hdp_last7,\n          host_sd_last7,\n          audience_sd_last7,\n          host_hd_last7,\n          audience_hd_last7,\n          host_hdp_last7,\n          audience_hdp_last7,\n          host_audio_last7,\n          audience_audio_last7,\n          host_video_last7,\n          audience_video_last7,\n          audience_audio_low_latency_last7,\n          audience_video_low_latency_last7,\n          audience_total_low_latency_last7,\n          audience_sd_low_latency_last7,\n          audience_hd_low_latency_last7,\n          audience_hdp_low_latency_last7,\n          audience_1080p_low_latency_last7,\n          audience_2k_low_latency_last7,\n          audience_4k_low_latency_last7,\n          audience_audio_ultra_low_latency_last7,\n          audience_video_ultra_low_latency_last7,\n          audience_total_ultra_low_latency_last7,\n          audience_sd_ultra_low_latency_last7,\n          audience_hd_ultra_low_latency_last7,\n          audience_hdp_ultra_low_latency_last7,\n          audience_1080p_ultra_low_latency_last7,\n          audience_2k_ultra_low_latency_last7,\n          audience_4k_ultra_low_latency_last7,\n          audience_2k_last7,\n          audience_4k_last7,\n          audience_1080p_last7,\n          host_1080p_last7,\n          host_2k_last7,\n          host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'VerType' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND \"自定义 SQL 查询\".\"rank_level1\" = 8 AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 35"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"sum_audience_audio_ok\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio_Rtls\") AS \"sum_audience_audio_Rtls_ok\",\n  SUM(\"自定义 SQL 查询\".\"audience_total\") AS \"sum_audience_total_ok\",\n  SUM(\"自定义 SQL 查询\".\"audience_total_Rtls\") AS \"sum_audience_total_Rtls_ok\",\n  SUM(\"自定义 SQL 查询\".\"audience_video\") AS \"sum_audience_video_ok\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_Rtls\") AS \"sum_audience_video_Rtls_ok\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"sum_audio_ok\",\n  SUM(\"自定义 SQL 查询\".\"total\") AS \"sum_total_ok\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"sum_video_ok\",\n  CONCAT(CONCAT(CONCAT(CONCAT(CONCAT(CAST(YEAR(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS VARCHAR)), '-'), CONCAT(CAST(MONTH(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS VARCHAR))), '-'), CONCAT(CAST(DAY_OF_MONTH(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS VARCHAR))) AS \"ture_period (复制)_5872482815214256134\"\nFROM (SELECT date,\n      tag,\n      dim_grouping_name,\n      area,\n        SUM(audio) + SUM(video) AS total,\n      SUM(audio) AS audio,\n      SUM(video) AS video,\n      SUM(video_sd) AS video_sd,\n      SUM(video_hd) AS video_hd,\n      SUM(video_hdp) AS video_hdp,\n        SUM(audience_audio) + SUM(audience_video) AS audience_total,\n      SUM(audience_audio) AS audience_audio,\n      SUM(audience_video) AS audience_video,\n      SUM(audience_sd) AS audience_sd,\n      SUM(audience_hd) AS audience_hd,\n      SUM(audience_hdp) AS audience_hdp,\n      SUM(audience_total_low_latency) AS audience_total_Rtls,\n      SUM(audience_audio_low_latency) AS audience_audio_Rtls,\n      SUM(audience_video_low_latency) AS audience_video_Rtls,\n      SUM(audience_sd_low_latency) AS audience_sd_Rtls,\n      SUM(audience_hd_low_latency) AS audience_hd_Rtls,\n      SUM(audience_hdp_low_latency) AS audience_hdp_Rtls,\n      SUM(total_last1) AS total_last1,\n      SUM(audio_last1) AS audio_last1,\n      SUM(video_last1) AS video_last1,\n        SUM(audience_audio_last1) + SUM(audience_video_last1) AS audience_total_last1,\n      SUM(audience_audio_last1) AS audience_audio_last1,\n      SUM(audience_video_last1) AS audience_video_last1,\n      SUM(audience_total_low_latency_last1) AS audience_total_Rtls_last1,\n      SUM(audience_audio_low_latency_last1) AS audience_audio_Rtls_last1,\n      SUM(audience_video_low_latency_last1) AS audience_video_Rtls_last1,\n      SUM(total_last7) AS total_last7,\n      SUM(audio_last7) AS audio_last7,\n      SUM(video_last7) AS video_last7,\n        SUM(audience_audio_last7) + SUM(audience_video_last7) AS audience_total_last7,\n      SUM(audience_audio_last7) AS audience_audio_last7,\n      SUM(audience_video_last7) AS audience_video_last7,\n      SUM(audience_total_low_latency_last7) AS audience_total_Rtls_last7,\n      SUM(audience_audio_low_latency_last7) AS audience_audio_Rtls_last7,\n      SUM(audience_video_low_latency_last7) AS audience_video_Rtls_last7\n    FROM report_datahub.levels_usage_dod_di_1\n    WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') BETWEEN DATE('2021-11-13') AND DATE('2021-12-13') AND CAST(tag AS VARCHAR) = 'SpecialGroup' AND dim = 1 AND CAST(level1 AS VARCHAR) = 'RTLSVID' AND area IS NOT NULL\n    GROUP BY 1,\n      2,\n      3,\n      4) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n          tag,\n          dim_grouping_name,\n          area,\n            SUM(audio) + SUM(video) AS total,\n          SUM(audio) AS audio,\n          SUM(video) AS video,\n          SUM(video_sd) AS video_sd,\n          SUM(video_hd) AS video_hd,\n          SUM(video_hdp) AS video_hdp,\n            SUM(audience_audio) + SUM(audience_video) AS audience_total,\n          SUM(audience_audio) AS audience_audio,\n          SUM(audience_video) AS audience_video,\n          SUM(audience_sd) AS audience_sd,\n          SUM(audience_hd) AS audience_hd,\n          SUM(audience_hdp) AS audience_hdp,\n          SUM(audience_total_low_latency) AS audience_total_Rtls,\n          SUM(audience_audio_low_latency) AS audience_audio_Rtls,\n          SUM(audience_video_low_latency) AS audience_video_Rtls,\n          SUM(audience_sd_low_latency) AS audience_sd_Rtls,\n          SUM(audience_hd_low_latency) AS audience_hd_Rtls,\n          SUM(audience_hdp_low_latency) AS audience_hdp_Rtls,\n          SUM(total_last1) AS total_last1,\n          SUM(audio_last1) AS audio_last1,\n          SUM(video_last1) AS video_last1,\n            SUM(audience_audio_last1) + SUM(audience_video_last1) AS audience_total_last1,\n          SUM(audience_audio_last1) AS audience_audio_last1,\n          SUM(audience_video_last1) AS audience_video_last1,\n          SUM(audience_total_low_latency_last1) AS audience_total_Rtls_last1,\n          SUM(audience_audio_low_latency_last1) AS audience_audio_Rtls_last1,\n          SUM(audience_video_low_latency_last1) AS audience_video_Rtls_last1,\n          SUM(total_last7) AS total_last7,\n          SUM(audio_last7) AS audio_last7,\n          SUM(video_last7) AS video_last7,\n            SUM(audience_audio_last7) + SUM(audience_video_last7) AS audience_total_last7,\n          SUM(audience_audio_last7) AS audience_audio_last7,\n          SUM(audience_video_last7) AS audience_video_last7,\n          SUM(audience_total_low_latency_last7) AS audience_total_Rtls_last7,\n          SUM(audience_audio_low_latency_last7) AS audience_audio_Rtls_last7,\n          SUM(audience_video_low_latency_last7) AS audience_video_Rtls_last7\n        FROM report_datahub.levels_usage_dod_di_1\n        WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') BETWEEN DATE('2021-11-13') AND DATE('2021-12-13') AND CAST(tag AS VARCHAR) = 'SpecialGroup' AND dim = 1 AND CAST(level1 AS VARCHAR) = 'RTLSVID' AND area IS NOT NULL\n        GROUP BY 1,\n          2,\n          3,\n          4) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"area\" IN ('China', 'Not China') AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 10"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700079370244)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700079370244)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700079370244)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700079370244)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700079370244)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700079370244)(943764407)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_4k_last\") AS \"TEMP(Calculation_3519281700083154949)(101123376)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_hdp_last\") AS \"TEMP(Calculation_3519281700083154949)(1200517625)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p_last\") AS \"TEMP(Calculation_3519281700083154949)(1314346200)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_hd_last\") AS \"TEMP(Calculation_3519281700083154949)(146570423)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k_last\") AS \"TEMP(Calculation_3519281700083154949)(1717771635)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio_last\") AS \"TEMP(Calculation_3519281700083154949)(2313111073)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_hdp_last\") AS \"TEMP(Calculation_3519281700083154949)(258310559)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_video_last\") AS \"TEMP(Calculation_3519281700083154949)(2820618408)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k_last\") AS \"TEMP(Calculation_3519281700083154949)(3121859593)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p_last\") AS \"TEMP(Calculation_3519281700083154949)(3222422303)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio_last\") AS \"TEMP(Calculation_3519281700083154949)(3227677803)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video_last\") AS \"TEMP(Calculation_3519281700083154949)(3934387163)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k_last\") AS \"TEMP(Calculation_3519281700083154949)(4055292783)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_last\") AS \"TEMP(Calculation_3519281700083154949)(4091190060)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_hd_last\") AS \"TEMP(Calculation_3519281700083154949)(4170367250)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_sd_last\") AS \"TEMP(Calculation_3519281700083154949)(4190307025)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_sd_last\") AS \"TEMP(Calculation_3519281700083154949)(933007102)(0)\",\n  MAX(\"自定义 SQL 查询\".\"stat_date\") AS \"TEMP(attr_stat_date_nk)(2102638629)(0)\",\n  MIN(\"自定义 SQL 查询\".\"stat_date\") AS \"TEMP(attr_stat_date_nk)(2790680713)(0)\",\n  \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"sum_totalUsage_ok\",\n  DATE_ADD('SECOND', 0, date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"tdy_date_ok\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'VerType' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND \"自定义 SQL 查询\".\"rank_level1\" = 8\nGROUP BY 37,\n  39"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700079370244)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700079370244)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700079370244)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700079370244)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700079370244)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700079370244)(943764407)(0)\",\n  \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"sum_totalUsage_ok\",\n  DATE_ADD('SECOND', 0, date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"tdy_date_ok\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'VerType' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n          tag,\n          area AS Scope,\n          dim,\n          level1,\n          level2,\n          level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n            CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n          total AS totalUsage,\n          audio,\n          video,\n          host_audio,\n          audience_audio,\n          host_sd,\n          host_hd,\n          host_hdp,\n          host_1080p,\n          host_2k,\n          host_4k,\n          audience_sd,\n          audience_hd,\n          audience_hdp,\n          audience_1080p,\n          audience_2k,\n          audience_4k,\n          audience_audio_low_latency,\n          audience_sd_low_latency,\n          audience_hd_low_latency,\n          audience_hdp_low_latency,\n          audience_1080p_low_latency,\n          audience_2k_low_latency,\n          audience_4k_low_latency,\n          audience_audio_ultra_low_latency,\n          audience_sd_ultra_low_latency,\n          audience_hd_ultra_low_latency,\n          audience_hdp_ultra_low_latency,\n          audience_1080p_ultra_low_latency,\n          audience_2k_ultra_low_latency,\n          audience_4k_ultra_low_latency,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n          audience_video_low_latency_last1 AS audience_video_low_latency_last,\n          audience_total_low_latency_last1 AS audience_total_low_latency_last,\n          audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n          audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n          audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n          audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n          audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n          audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n          audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n          audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n          audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n          audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n          audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n          audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n          audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n          audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n          audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n          audience_2k_last1 AS audience_2k_last,\n          audience_4k_last1 AS audience_4k_last,\n          audience_1080p_last1 AS audience_1080p_last,\n          host_1080p_last1 AS host_1080p_last,\n          host_2k_last1 AS host_2k_last,\n          host_4k_last1 AS host_4k_last,\n          total_last7,\n          audio_last7,\n          video_last7,\n          video_sd_last7,\n          video_hd_last7,\n          video_hdp_last7,\n          host_sd_last7,\n          audience_sd_last7,\n          host_hd_last7,\n          audience_hd_last7,\n          host_hdp_last7,\n          audience_hdp_last7,\n          host_audio_last7,\n          audience_audio_last7,\n          host_video_last7,\n          audience_video_last7,\n          audience_audio_low_latency_last7,\n          audience_video_low_latency_last7,\n          audience_total_low_latency_last7,\n          audience_sd_low_latency_last7,\n          audience_hd_low_latency_last7,\n          audience_hdp_low_latency_last7,\n          audience_1080p_low_latency_last7,\n          audience_2k_low_latency_last7,\n          audience_4k_low_latency_last7,\n          audience_audio_ultra_low_latency_last7,\n          audience_video_ultra_low_latency_last7,\n          audience_total_ultra_low_latency_last7,\n          audience_sd_ultra_low_latency_last7,\n          audience_hd_ultra_low_latency_last7,\n          audience_hdp_ultra_low_latency_last7,\n          audience_1080p_ultra_low_latency_last7,\n          audience_2k_ultra_low_latency_last7,\n          audience_4k_ultra_low_latency_last7,\n          audience_2k_last7,\n          audience_4k_last7,\n          audience_1080p_last7,\n          host_1080p_last7,\n          host_2k_last7,\n          host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'VerType' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND \"自定义 SQL 查询\".\"rank_level1\" = 5 AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 18,\n  20"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700079370244)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700079370244)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700079370244)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700079370244)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700079370244)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700079370244)(943764407)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_4k_last\") AS \"TEMP(Calculation_3519281700083154949)(101123376)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_hdp_last\") AS \"TEMP(Calculation_3519281700083154949)(1200517625)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p_last\") AS \"TEMP(Calculation_3519281700083154949)(1314346200)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_hd_last\") AS \"TEMP(Calculation_3519281700083154949)(146570423)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k_last\") AS \"TEMP(Calculation_3519281700083154949)(1717771635)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio_last\") AS \"TEMP(Calculation_3519281700083154949)(2313111073)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_hdp_last\") AS \"TEMP(Calculation_3519281700083154949)(258310559)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_video_last\") AS \"TEMP(Calculation_3519281700083154949)(2820618408)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k_last\") AS \"TEMP(Calculation_3519281700083154949)(3121859593)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p_last\") AS \"TEMP(Calculation_3519281700083154949)(3222422303)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio_last\") AS \"TEMP(Calculation_3519281700083154949)(3227677803)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video_last\") AS \"TEMP(Calculation_3519281700083154949)(3934387163)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k_last\") AS \"TEMP(Calculation_3519281700083154949)(4055292783)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_last\") AS \"TEMP(Calculation_3519281700083154949)(4091190060)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_hd_last\") AS \"TEMP(Calculation_3519281700083154949)(4170367250)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_sd_last\") AS \"TEMP(Calculation_3519281700083154949)(4190307025)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_sd_last\") AS \"TEMP(Calculation_3519281700083154949)(933007102)(0)\",\n  MAX(\"自定义 SQL 查询\".\"stat_date\") AS \"TEMP(attr_stat_date_nk)(2102638629)(0)\",\n  MIN(\"自定义 SQL 查询\".\"stat_date\") AS \"TEMP(attr_stat_date_nk)(2790680713)(0)\",\n  \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"sum_totalUsage_ok\",\n  DATE_ADD('SECOND', 0, date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"tdy_date_ok\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'VerType' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND \"自定义 SQL 查询\".\"rank_level1\" = 4\nGROUP BY 37,\n  39"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700079370244)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700079370244)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700079370244)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700079370244)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700079370244)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700079370244)(943764407)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_4k_last\") AS \"TEMP(Calculation_3519281700083154949)(101123376)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_hdp_last\") AS \"TEMP(Calculation_3519281700083154949)(1200517625)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p_last\") AS \"TEMP(Calculation_3519281700083154949)(1314346200)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_hd_last\") AS \"TEMP(Calculation_3519281700083154949)(146570423)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k_last\") AS \"TEMP(Calculation_3519281700083154949)(1717771635)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio_last\") AS \"TEMP(Calculation_3519281700083154949)(2313111073)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_hdp_last\") AS \"TEMP(Calculation_3519281700083154949)(258310559)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_video_last\") AS \"TEMP(Calculation_3519281700083154949)(2820618408)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k_last\") AS \"TEMP(Calculation_3519281700083154949)(3121859593)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p_last\") AS \"TEMP(Calculation_3519281700083154949)(3222422303)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio_last\") AS \"TEMP(Calculation_3519281700083154949)(3227677803)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video_last\") AS \"TEMP(Calculation_3519281700083154949)(3934387163)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k_last\") AS \"TEMP(Calculation_3519281700083154949)(4055292783)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_last\") AS \"TEMP(Calculation_3519281700083154949)(4091190060)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_hd_last\") AS \"TEMP(Calculation_3519281700083154949)(4170367250)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_sd_last\") AS \"TEMP(Calculation_3519281700083154949)(4190307025)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_sd_last\") AS \"TEMP(Calculation_3519281700083154949)(933007102)(0)\",\n  MAX(\"自定义 SQL 查询\".\"stat_date\") AS \"TEMP(attr_stat_date_nk)(2102638629)(0)\",\n  MIN(\"自定义 SQL 查询\".\"stat_date\") AS \"TEMP(attr_stat_date_nk)(2790680713)(0)\",\n  \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"sum_totalUsage_ok\",\n  DATE_ADD('SECOND', 0, date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"tdy_date_ok\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'VerType' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND \"自定义 SQL 查询\".\"rank_level1\" = 5\nGROUP BY 37,\n  39"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k_last\") AS \"TEMP(Calculation_3519281700083154949)(101123376)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700083154949)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700083154949)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_hdp_last\") AS \"TEMP(Calculation_3519281700083154949)(1200517625)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700083154949)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p_last\") AS \"TEMP(Calculation_3519281700083154949)(1314346200)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_hd_last\") AS \"TEMP(Calculation_3519281700083154949)(146570423)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k_last\") AS \"TEMP(Calculation_3519281700083154949)(1717771635)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio_last\") AS \"TEMP(Calculation_3519281700083154949)(2313111073)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_hdp_last\") AS \"TEMP(Calculation_3519281700083154949)(258310559)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700083154949)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_video_last\") AS \"TEMP(Calculation_3519281700083154949)(2820618408)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700083154949)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700083154949)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700083154949)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700083154949)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700083154949)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k_last\") AS \"TEMP(Calculation_3519281700083154949)(3121859593)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p_last\") AS \"TEMP(Calculation_3519281700083154949)(3222422303)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio_last\") AS \"TEMP(Calculation_3519281700083154949)(3227677803)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700083154949)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700083154949)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700083154949)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video_last\") AS \"TEMP(Calculation_3519281700083154949)(3934387163)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k_last\") AS \"TEMP(Calculation_3519281700083154949)(4055292783)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_last\") AS \"TEMP(Calculation_3519281700083154949)(4091190060)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700083154949)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_hd_last\") AS \"TEMP(Calculation_3519281700083154949)(4170367250)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_sd_last\") AS \"TEMP(Calculation_3519281700083154949)(4190307025)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700083154949)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700083154949)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700083154949)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_sd_last\") AS \"TEMP(Calculation_3519281700083154949)(933007102)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700083154949)(943764407)(0)\",\n  AVG(\"自定义 SQL 查询\".\"totalUsage\") AS \"avg_totalUsage_ok\",\n  \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"sum_totalUsage_ok\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'VerType' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n          tag,\n          area AS Scope,\n          dim,\n          level1,\n          level2,\n          level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n            CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n          total AS totalUsage,\n          audio,\n          video,\n          host_audio,\n          audience_audio,\n          host_sd,\n          host_hd,\n          host_hdp,\n          host_1080p,\n          host_2k,\n          host_4k,\n          audience_sd,\n          audience_hd,\n          audience_hdp,\n          audience_1080p,\n          audience_2k,\n          audience_4k,\n          audience_audio_low_latency,\n          audience_sd_low_latency,\n          audience_hd_low_latency,\n          audience_hdp_low_latency,\n          audience_1080p_low_latency,\n          audience_2k_low_latency,\n          audience_4k_low_latency,\n          audience_audio_ultra_low_latency,\n          audience_sd_ultra_low_latency,\n          audience_hd_ultra_low_latency,\n          audience_hdp_ultra_low_latency,\n          audience_1080p_ultra_low_latency,\n          audience_2k_ultra_low_latency,\n          audience_4k_ultra_low_latency,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n          audience_video_low_latency_last1 AS audience_video_low_latency_last,\n          audience_total_low_latency_last1 AS audience_total_low_latency_last,\n          audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n          audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n          audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n          audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n          audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n          audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n          audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n          audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n          audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n          audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n          audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n          audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n          audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n          audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n          audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n          audience_2k_last1 AS audience_2k_last,\n          audience_4k_last1 AS audience_4k_last,\n          audience_1080p_last1 AS audience_1080p_last,\n          host_1080p_last1 AS host_1080p_last,\n          host_2k_last1 AS host_2k_last,\n          host_4k_last1 AS host_4k_last,\n          total_last7,\n          audio_last7,\n          video_last7,\n          video_sd_last7,\n          video_hd_last7,\n          video_hdp_last7,\n          host_sd_last7,\n          audience_sd_last7,\n          host_hd_last7,\n          audience_hd_last7,\n          host_hdp_last7,\n          audience_hdp_last7,\n          host_audio_last7,\n          audience_audio_last7,\n          host_video_last7,\n          audience_video_last7,\n          audience_audio_low_latency_last7,\n          audience_video_low_latency_last7,\n          audience_total_low_latency_last7,\n          audience_sd_low_latency_last7,\n          audience_hd_low_latency_last7,\n          audience_hdp_low_latency_last7,\n          audience_1080p_low_latency_last7,\n          audience_2k_low_latency_last7,\n          audience_4k_low_latency_last7,\n          audience_audio_ultra_low_latency_last7,\n          audience_video_ultra_low_latency_last7,\n          audience_total_ultra_low_latency_last7,\n          audience_sd_ultra_low_latency_last7,\n          audience_hd_ultra_low_latency_last7,\n          audience_hdp_ultra_low_latency_last7,\n          audience_1080p_ultra_low_latency_last7,\n          audience_2k_ultra_low_latency_last7,\n          audience_4k_ultra_low_latency_last7,\n          audience_2k_last7,\n          audience_4k_last7,\n          audience_1080p_last7,\n          host_1080p_last7,\n          host_2k_last7,\n          host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'VerType' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND \"自定义 SQL 查询\".\"rank_level1\" = 4 AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 36"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700079370244)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700079370244)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700079370244)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700079370244)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700079370244)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700079370244)(943764407)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_4k_last\") AS \"TEMP(Calculation_3519281700083154949)(101123376)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_hdp_last\") AS \"TEMP(Calculation_3519281700083154949)(1200517625)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p_last\") AS \"TEMP(Calculation_3519281700083154949)(1314346200)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_hd_last\") AS \"TEMP(Calculation_3519281700083154949)(146570423)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k_last\") AS \"TEMP(Calculation_3519281700083154949)(1717771635)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio_last\") AS \"TEMP(Calculation_3519281700083154949)(2313111073)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_hdp_last\") AS \"TEMP(Calculation_3519281700083154949)(258310559)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_video_last\") AS \"TEMP(Calculation_3519281700083154949)(2820618408)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k_last\") AS \"TEMP(Calculation_3519281700083154949)(3121859593)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p_last\") AS \"TEMP(Calculation_3519281700083154949)(3222422303)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio_last\") AS \"TEMP(Calculation_3519281700083154949)(3227677803)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video_last\") AS \"TEMP(Calculation_3519281700083154949)(3934387163)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k_last\") AS \"TEMP(Calculation_3519281700083154949)(4055292783)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_last\") AS \"TEMP(Calculation_3519281700083154949)(4091190060)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_hd_last\") AS \"TEMP(Calculation_3519281700083154949)(4170367250)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_sd_last\") AS \"TEMP(Calculation_3519281700083154949)(4190307025)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_sd_last\") AS \"TEMP(Calculation_3519281700083154949)(933007102)(0)\",\n  MAX(\"自定义 SQL 查询\".\"stat_date\") AS \"TEMP(attr_stat_date_nk)(2102638629)(0)\",\n  MIN(\"自定义 SQL 查询\".\"stat_date\") AS \"TEMP(attr_stat_date_nk)(2790680713)(0)\",\n  \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"sum_totalUsage_ok\",\n  DATE_ADD('SECOND', 0, date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"tdy_date_ok\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'VerType' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND \"自定义 SQL 查询\".\"rank_level1\" = 6\nGROUP BY 37,\n  39"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700341563406)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio_last7\") AS \"TEMP(Calculation_3519281700341563406)(1077563395)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700341563406)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700341563406)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd_last7\") AS \"TEMP(Calculation_3519281700341563406)(1456465729)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd_last7\") AS \"TEMP(Calculation_3519281700341563406)(1635749653)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd_last7\") AS \"TEMP(Calculation_3519281700341563406)(1747046964)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k_last7\") AS \"TEMP(Calculation_3519281700341563406)(1747524570)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp_last7\") AS \"TEMP(Calculation_3519281700341563406)(2044136109)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio_last7\") AS \"TEMP(Calculation_3519281700341563406)(2464388580)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_last7\") AS \"TEMP(Calculation_3519281700341563406)(2589233512)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700341563406)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k_last7\") AS \"TEMP(Calculation_3519281700341563406)(280796653)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700341563406)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700341563406)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700341563406)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700341563406)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700341563406)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_4k_last7\") AS \"TEMP(Calculation_3519281700341563406)(3127348545)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700341563406)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"total_last7\") AS \"TEMP(Calculation_3519281700341563406)(346677966)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k_last7\") AS \"TEMP(Calculation_3519281700341563406)(3543669678)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p_last7\") AS \"TEMP(Calculation_3519281700341563406)(3624983014)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700341563406)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700341563406)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd_last7\") AS \"TEMP(Calculation_3519281700341563406)(3905372418)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video_last7\") AS \"TEMP(Calculation_3519281700341563406)(4107040267)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700341563406)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700341563406)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p_last7\") AS \"TEMP(Calculation_3519281700341563406)(632977665)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700341563406)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp_last7\") AS \"TEMP(Calculation_3519281700341563406)(750340200)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700341563406)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700341563406)(943764407)(0)\",\n  \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"audio_video_last\") AS \"sum_audio_video_last_ok\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'VerType' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n          tag,\n          area AS Scope,\n          dim,\n          level1,\n          level2,\n          level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n            CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n          total AS totalUsage,\n          audio,\n          video,\n          host_audio,\n          audience_audio,\n          host_sd,\n          host_hd,\n          host_hdp,\n          host_1080p,\n          host_2k,\n          host_4k,\n          audience_sd,\n          audience_hd,\n          audience_hdp,\n          audience_1080p,\n          audience_2k,\n          audience_4k,\n          audience_audio_low_latency,\n          audience_sd_low_latency,\n          audience_hd_low_latency,\n          audience_hdp_low_latency,\n          audience_1080p_low_latency,\n          audience_2k_low_latency,\n          audience_4k_low_latency,\n          audience_audio_ultra_low_latency,\n          audience_sd_ultra_low_latency,\n          audience_hd_ultra_low_latency,\n          audience_hdp_ultra_low_latency,\n          audience_1080p_ultra_low_latency,\n          audience_2k_ultra_low_latency,\n          audience_4k_ultra_low_latency,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n          audience_video_low_latency_last1 AS audience_video_low_latency_last,\n          audience_total_low_latency_last1 AS audience_total_low_latency_last,\n          audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n          audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n          audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n          audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n          audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n          audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n          audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n          audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n          audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n          audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n          audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n          audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n          audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n          audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n          audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n          audience_2k_last1 AS audience_2k_last,\n          audience_4k_last1 AS audience_4k_last,\n          audience_1080p_last1 AS audience_1080p_last,\n          host_1080p_last1 AS host_1080p_last,\n          host_2k_last1 AS host_2k_last,\n          host_4k_last1 AS host_4k_last,\n          total_last7,\n          audio_last7,\n          video_last7,\n          video_sd_last7,\n          video_hd_last7,\n          video_hdp_last7,\n          host_sd_last7,\n          audience_sd_last7,\n          host_hd_last7,\n          audience_hd_last7,\n          host_hdp_last7,\n          audience_hdp_last7,\n          host_audio_last7,\n          audience_audio_last7,\n          host_video_last7,\n          audience_video_last7,\n          audience_audio_low_latency_last7,\n          audience_video_low_latency_last7,\n          audience_total_low_latency_last7,\n          audience_sd_low_latency_last7,\n          audience_hd_low_latency_last7,\n          audience_hdp_low_latency_last7,\n          audience_1080p_low_latency_last7,\n          audience_2k_low_latency_last7,\n          audience_4k_low_latency_last7,\n          audience_audio_ultra_low_latency_last7,\n          audience_video_ultra_low_latency_last7,\n          audience_total_ultra_low_latency_last7,\n          audience_sd_ultra_low_latency_last7,\n          audience_hd_ultra_low_latency_last7,\n          audience_hdp_ultra_low_latency_last7,\n          audience_1080p_ultra_low_latency_last7,\n          audience_2k_ultra_low_latency_last7,\n          audience_4k_ultra_low_latency_last7,\n          audience_2k_last7,\n          audience_4k_last7,\n          audience_1080p_last7,\n          host_1080p_last7,\n          host_2k_last7,\n          host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'VerType' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND \"自定义 SQL 查询\".\"rank_level1\" = 4 AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 35"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700079370244)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700079370244)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700079370244)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700079370244)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700079370244)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700079370244)(943764407)(0)\",\n  \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"sum_totalUsage_ok\",\n  DATE_ADD('SECOND', 0, date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"tdy_date_ok\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'VerType' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n          tag,\n          area AS Scope,\n          dim,\n          level1,\n          level2,\n          level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n            CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n          total AS totalUsage,\n          audio,\n          video,\n          host_audio,\n          audience_audio,\n          host_sd,\n          host_hd,\n          host_hdp,\n          host_1080p,\n          host_2k,\n          host_4k,\n          audience_sd,\n          audience_hd,\n          audience_hdp,\n          audience_1080p,\n          audience_2k,\n          audience_4k,\n          audience_audio_low_latency,\n          audience_sd_low_latency,\n          audience_hd_low_latency,\n          audience_hdp_low_latency,\n          audience_1080p_low_latency,\n          audience_2k_low_latency,\n          audience_4k_low_latency,\n          audience_audio_ultra_low_latency,\n          audience_sd_ultra_low_latency,\n          audience_hd_ultra_low_latency,\n          audience_hdp_ultra_low_latency,\n          audience_1080p_ultra_low_latency,\n          audience_2k_ultra_low_latency,\n          audience_4k_ultra_low_latency,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n          audience_video_low_latency_last1 AS audience_video_low_latency_last,\n          audience_total_low_latency_last1 AS audience_total_low_latency_last,\n          audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n          audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n          audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n          audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n          audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n          audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n          audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n          audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n          audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n          audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n          audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n          audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n          audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n          audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n          audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n          audience_2k_last1 AS audience_2k_last,\n          audience_4k_last1 AS audience_4k_last,\n          audience_1080p_last1 AS audience_1080p_last,\n          host_1080p_last1 AS host_1080p_last,\n          host_2k_last1 AS host_2k_last,\n          host_4k_last1 AS host_4k_last,\n          total_last7,\n          audio_last7,\n          video_last7,\n          video_sd_last7,\n          video_hd_last7,\n          video_hdp_last7,\n          host_sd_last7,\n          audience_sd_last7,\n          host_hd_last7,\n          audience_hd_last7,\n          host_hdp_last7,\n          audience_hdp_last7,\n          host_audio_last7,\n          audience_audio_last7,\n          host_video_last7,\n          audience_video_last7,\n          audience_audio_low_latency_last7,\n          audience_video_low_latency_last7,\n          audience_total_low_latency_last7,\n          audience_sd_low_latency_last7,\n          audience_hd_low_latency_last7,\n          audience_hdp_low_latency_last7,\n          audience_1080p_low_latency_last7,\n          audience_2k_low_latency_last7,\n          audience_4k_low_latency_last7,\n          audience_audio_ultra_low_latency_last7,\n          audience_video_ultra_low_latency_last7,\n          audience_total_ultra_low_latency_last7,\n          audience_sd_ultra_low_latency_last7,\n          audience_hd_ultra_low_latency_last7,\n          audience_hdp_ultra_low_latency_last7,\n          audience_1080p_ultra_low_latency_last7,\n          audience_2k_ultra_low_latency_last7,\n          audience_4k_ultra_low_latency_last7,\n          audience_2k_last7,\n          audience_4k_last7,\n          audience_1080p_last7,\n          host_1080p_last7,\n          host_2k_last7,\n          host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'VerType' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND \"自定义 SQL 查询\".\"rank_level1\" = 3 AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 18,\n  20"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700341563406)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio_last7\") AS \"TEMP(Calculation_3519281700341563406)(1077563395)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700341563406)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700341563406)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd_last7\") AS \"TEMP(Calculation_3519281700341563406)(1456465729)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd_last7\") AS \"TEMP(Calculation_3519281700341563406)(1635749653)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd_last7\") AS \"TEMP(Calculation_3519281700341563406)(1747046964)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k_last7\") AS \"TEMP(Calculation_3519281700341563406)(1747524570)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp_last7\") AS \"TEMP(Calculation_3519281700341563406)(2044136109)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio_last7\") AS \"TEMP(Calculation_3519281700341563406)(2464388580)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_last7\") AS \"TEMP(Calculation_3519281700341563406)(2589233512)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700341563406)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k_last7\") AS \"TEMP(Calculation_3519281700341563406)(280796653)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700341563406)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700341563406)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700341563406)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700341563406)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700341563406)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_4k_last7\") AS \"TEMP(Calculation_3519281700341563406)(3127348545)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700341563406)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"total_last7\") AS \"TEMP(Calculation_3519281700341563406)(346677966)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k_last7\") AS \"TEMP(Calculation_3519281700341563406)(3543669678)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p_last7\") AS \"TEMP(Calculation_3519281700341563406)(3624983014)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700341563406)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700341563406)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd_last7\") AS \"TEMP(Calculation_3519281700341563406)(3905372418)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video_last7\") AS \"TEMP(Calculation_3519281700341563406)(4107040267)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700341563406)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700341563406)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p_last7\") AS \"TEMP(Calculation_3519281700341563406)(632977665)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700341563406)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp_last7\") AS \"TEMP(Calculation_3519281700341563406)(750340200)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700341563406)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700341563406)(943764407)(0)\",\n  \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"audio_video_last\") AS \"sum_audio_video_last_ok\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'VerType' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n          tag,\n          area AS Scope,\n          dim,\n          level1,\n          level2,\n          level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n            CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n          total AS totalUsage,\n          audio,\n          video,\n          host_audio,\n          audience_audio,\n          host_sd,\n          host_hd,\n          host_hdp,\n          host_1080p,\n          host_2k,\n          host_4k,\n          audience_sd,\n          audience_hd,\n          audience_hdp,\n          audience_1080p,\n          audience_2k,\n          audience_4k,\n          audience_audio_low_latency,\n          audience_sd_low_latency,\n          audience_hd_low_latency,\n          audience_hdp_low_latency,\n          audience_1080p_low_latency,\n          audience_2k_low_latency,\n          audience_4k_low_latency,\n          audience_audio_ultra_low_latency,\n          audience_sd_ultra_low_latency,\n          audience_hd_ultra_low_latency,\n          audience_hdp_ultra_low_latency,\n          audience_1080p_ultra_low_latency,\n          audience_2k_ultra_low_latency,\n          audience_4k_ultra_low_latency,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n          audience_video_low_latency_last1 AS audience_video_low_latency_last,\n          audience_total_low_latency_last1 AS audience_total_low_latency_last,\n          audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n          audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n          audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n          audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n          audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n          audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n          audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n          audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n          audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n          audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n          audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n          audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n          audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n          audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n          audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n          audience_2k_last1 AS audience_2k_last,\n          audience_4k_last1 AS audience_4k_last,\n          audience_1080p_last1 AS audience_1080p_last,\n          host_1080p_last1 AS host_1080p_last,\n          host_2k_last1 AS host_2k_last,\n          host_4k_last1 AS host_4k_last,\n          total_last7,\n          audio_last7,\n          video_last7,\n          video_sd_last7,\n          video_hd_last7,\n          video_hdp_last7,\n          host_sd_last7,\n          audience_sd_last7,\n          host_hd_last7,\n          audience_hd_last7,\n          host_hdp_last7,\n          audience_hdp_last7,\n          host_audio_last7,\n          audience_audio_last7,\n          host_video_last7,\n          audience_video_last7,\n          audience_audio_low_latency_last7,\n          audience_video_low_latency_last7,\n          audience_total_low_latency_last7,\n          audience_sd_low_latency_last7,\n          audience_hd_low_latency_last7,\n          audience_hdp_low_latency_last7,\n          audience_1080p_low_latency_last7,\n          audience_2k_low_latency_last7,\n          audience_4k_low_latency_last7,\n          audience_audio_ultra_low_latency_last7,\n          audience_video_ultra_low_latency_last7,\n          audience_total_ultra_low_latency_last7,\n          audience_sd_ultra_low_latency_last7,\n          audience_hd_ultra_low_latency_last7,\n          audience_hdp_ultra_low_latency_last7,\n          audience_1080p_ultra_low_latency_last7,\n          audience_2k_ultra_low_latency_last7,\n          audience_4k_ultra_low_latency_last7,\n          audience_2k_last7,\n          audience_4k_last7,\n          audience_1080p_last7,\n          host_1080p_last7,\n          host_2k_last7,\n          host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'VerType' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND \"自定义 SQL 查询\".\"rank_level1\" = 2 AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 35"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700079370244)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700079370244)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700079370244)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700079370244)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700079370244)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700079370244)(943764407)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_4k_last\") AS \"TEMP(Calculation_3519281700083154949)(101123376)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_hdp_last\") AS \"TEMP(Calculation_3519281700083154949)(1200517625)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p_last\") AS \"TEMP(Calculation_3519281700083154949)(1314346200)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_hd_last\") AS \"TEMP(Calculation_3519281700083154949)(146570423)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k_last\") AS \"TEMP(Calculation_3519281700083154949)(1717771635)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio_last\") AS \"TEMP(Calculation_3519281700083154949)(2313111073)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_hdp_last\") AS \"TEMP(Calculation_3519281700083154949)(258310559)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_video_last\") AS \"TEMP(Calculation_3519281700083154949)(2820618408)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k_last\") AS \"TEMP(Calculation_3519281700083154949)(3121859593)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p_last\") AS \"TEMP(Calculation_3519281700083154949)(3222422303)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio_last\") AS \"TEMP(Calculation_3519281700083154949)(3227677803)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video_last\") AS \"TEMP(Calculation_3519281700083154949)(3934387163)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k_last\") AS \"TEMP(Calculation_3519281700083154949)(4055292783)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_last\") AS \"TEMP(Calculation_3519281700083154949)(4091190060)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_hd_last\") AS \"TEMP(Calculation_3519281700083154949)(4170367250)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_sd_last\") AS \"TEMP(Calculation_3519281700083154949)(4190307025)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_sd_last\") AS \"TEMP(Calculation_3519281700083154949)(933007102)(0)\",\n  MAX(\"自定义 SQL 查询\".\"stat_date\") AS \"TEMP(attr_stat_date_nk)(2102638629)(0)\",\n  MIN(\"自定义 SQL 查询\".\"stat_date\") AS \"TEMP(attr_stat_date_nk)(2790680713)(0)\",\n  \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"sum_totalUsage_ok\",\n  DATE_ADD('SECOND', 0, date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"tdy_date_ok\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'VerType' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND \"自定义 SQL 查询\".\"rank_level1\" = 7\nGROUP BY 37,\n  39"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700079370244)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700079370244)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700079370244)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700079370244)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700079370244)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700079370244)(943764407)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_4k_last\") AS \"TEMP(Calculation_3519281700083154949)(101123376)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_hdp_last\") AS \"TEMP(Calculation_3519281700083154949)(1200517625)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p_last\") AS \"TEMP(Calculation_3519281700083154949)(1314346200)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_hd_last\") AS \"TEMP(Calculation_3519281700083154949)(146570423)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k_last\") AS \"TEMP(Calculation_3519281700083154949)(1717771635)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio_last\") AS \"TEMP(Calculation_3519281700083154949)(2313111073)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_hdp_last\") AS \"TEMP(Calculation_3519281700083154949)(258310559)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_video_last\") AS \"TEMP(Calculation_3519281700083154949)(2820618408)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k_last\") AS \"TEMP(Calculation_3519281700083154949)(3121859593)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p_last\") AS \"TEMP(Calculation_3519281700083154949)(3222422303)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio_last\") AS \"TEMP(Calculation_3519281700083154949)(3227677803)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video_last\") AS \"TEMP(Calculation_3519281700083154949)(3934387163)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k_last\") AS \"TEMP(Calculation_3519281700083154949)(4055292783)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_last\") AS \"TEMP(Calculation_3519281700083154949)(4091190060)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_hd_last\") AS \"TEMP(Calculation_3519281700083154949)(4170367250)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_sd_last\") AS \"TEMP(Calculation_3519281700083154949)(4190307025)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_sd_last\") AS \"TEMP(Calculation_3519281700083154949)(933007102)(0)\",\n  MAX(\"自定义 SQL 查询\".\"stat_date\") AS \"TEMP(attr_stat_date_nk)(2102638629)(0)\",\n  MIN(\"自定义 SQL 查询\".\"stat_date\") AS \"TEMP(attr_stat_date_nk)(2790680713)(0)\",\n  \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"sum_totalUsage_ok\",\n  DATE_ADD('SECOND', 0, date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"tdy_date_ok\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'VerType' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND \"自定义 SQL 查询\".\"rank_level1\" = 1\nGROUP BY 37,\n  39"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k_last\") AS \"TEMP(Calculation_3519281700083154949)(101123376)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700083154949)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700083154949)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_hdp_last\") AS \"TEMP(Calculation_3519281700083154949)(1200517625)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700083154949)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p_last\") AS \"TEMP(Calculation_3519281700083154949)(1314346200)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_hd_last\") AS \"TEMP(Calculation_3519281700083154949)(146570423)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k_last\") AS \"TEMP(Calculation_3519281700083154949)(1717771635)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio_last\") AS \"TEMP(Calculation_3519281700083154949)(2313111073)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_hdp_last\") AS \"TEMP(Calculation_3519281700083154949)(258310559)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700083154949)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_video_last\") AS \"TEMP(Calculation_3519281700083154949)(2820618408)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700083154949)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700083154949)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700083154949)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700083154949)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700083154949)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k_last\") AS \"TEMP(Calculation_3519281700083154949)(3121859593)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p_last\") AS \"TEMP(Calculation_3519281700083154949)(3222422303)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio_last\") AS \"TEMP(Calculation_3519281700083154949)(3227677803)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700083154949)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700083154949)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700083154949)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video_last\") AS \"TEMP(Calculation_3519281700083154949)(3934387163)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k_last\") AS \"TEMP(Calculation_3519281700083154949)(4055292783)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_last\") AS \"TEMP(Calculation_3519281700083154949)(4091190060)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700083154949)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_hd_last\") AS \"TEMP(Calculation_3519281700083154949)(4170367250)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_sd_last\") AS \"TEMP(Calculation_3519281700083154949)(4190307025)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700083154949)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700083154949)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700083154949)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_sd_last\") AS \"TEMP(Calculation_3519281700083154949)(933007102)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700083154949)(943764407)(0)\",\n  AVG(\"自定义 SQL 查询\".\"totalUsage\") AS \"avg_totalUsage_ok\",\n  \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"sum_totalUsage_ok\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'VerType' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n          tag,\n          area AS Scope,\n          dim,\n          level1,\n          level2,\n          level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n            CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n          total AS totalUsage,\n          audio,\n          video,\n          host_audio,\n          audience_audio,\n          host_sd,\n          host_hd,\n          host_hdp,\n          host_1080p,\n          host_2k,\n          host_4k,\n          audience_sd,\n          audience_hd,\n          audience_hdp,\n          audience_1080p,\n          audience_2k,\n          audience_4k,\n          audience_audio_low_latency,\n          audience_sd_low_latency,\n          audience_hd_low_latency,\n          audience_hdp_low_latency,\n          audience_1080p_low_latency,\n          audience_2k_low_latency,\n          audience_4k_low_latency,\n          audience_audio_ultra_low_latency,\n          audience_sd_ultra_low_latency,\n          audience_hd_ultra_low_latency,\n          audience_hdp_ultra_low_latency,\n          audience_1080p_ultra_low_latency,\n          audience_2k_ultra_low_latency,\n          audience_4k_ultra_low_latency,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n          audience_video_low_latency_last1 AS audience_video_low_latency_last,\n          audience_total_low_latency_last1 AS audience_total_low_latency_last,\n          audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n          audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n          audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n          audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n          audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n          audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n          audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n          audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n          audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n          audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n          audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n          audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n          audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n          audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n          audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n          audience_2k_last1 AS audience_2k_last,\n          audience_4k_last1 AS audience_4k_last,\n          audience_1080p_last1 AS audience_1080p_last,\n          host_1080p_last1 AS host_1080p_last,\n          host_2k_last1 AS host_2k_last,\n          host_4k_last1 AS host_4k_last,\n          total_last7,\n          audio_last7,\n          video_last7,\n          video_sd_last7,\n          video_hd_last7,\n          video_hdp_last7,\n          host_sd_last7,\n          audience_sd_last7,\n          host_hd_last7,\n          audience_hd_last7,\n          host_hdp_last7,\n          audience_hdp_last7,\n          host_audio_last7,\n          audience_audio_last7,\n          host_video_last7,\n          audience_video_last7,\n          audience_audio_low_latency_last7,\n          audience_video_low_latency_last7,\n          audience_total_low_latency_last7,\n          audience_sd_low_latency_last7,\n          audience_hd_low_latency_last7,\n          audience_hdp_low_latency_last7,\n          audience_1080p_low_latency_last7,\n          audience_2k_low_latency_last7,\n          audience_4k_low_latency_last7,\n          audience_audio_ultra_low_latency_last7,\n          audience_video_ultra_low_latency_last7,\n          audience_total_ultra_low_latency_last7,\n          audience_sd_ultra_low_latency_last7,\n          audience_hd_ultra_low_latency_last7,\n          audience_hdp_ultra_low_latency_last7,\n          audience_1080p_ultra_low_latency_last7,\n          audience_2k_ultra_low_latency_last7,\n          audience_4k_ultra_low_latency_last7,\n          audience_2k_last7,\n          audience_4k_last7,\n          audience_1080p_last7,\n          host_1080p_last7,\n          host_2k_last7,\n          host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'VerType' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND \"自定义 SQL 查询\".\"rank_level1\" = 5 AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 36"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700079370244)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700079370244)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700079370244)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700079370244)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700079370244)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700079370244)(943764407)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_4k_last\") AS \"TEMP(Calculation_3519281700083154949)(101123376)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_hdp_last\") AS \"TEMP(Calculation_3519281700083154949)(1200517625)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p_last\") AS \"TEMP(Calculation_3519281700083154949)(1314346200)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_hd_last\") AS \"TEMP(Calculation_3519281700083154949)(146570423)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k_last\") AS \"TEMP(Calculation_3519281700083154949)(1717771635)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio_last\") AS \"TEMP(Calculation_3519281700083154949)(2313111073)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_hdp_last\") AS \"TEMP(Calculation_3519281700083154949)(258310559)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_video_last\") AS \"TEMP(Calculation_3519281700083154949)(2820618408)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k_last\") AS \"TEMP(Calculation_3519281700083154949)(3121859593)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p_last\") AS \"TEMP(Calculation_3519281700083154949)(3222422303)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio_last\") AS \"TEMP(Calculation_3519281700083154949)(3227677803)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video_last\") AS \"TEMP(Calculation_3519281700083154949)(3934387163)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k_last\") AS \"TEMP(Calculation_3519281700083154949)(4055292783)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_last\") AS \"TEMP(Calculation_3519281700083154949)(4091190060)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_hd_last\") AS \"TEMP(Calculation_3519281700083154949)(4170367250)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_sd_last\") AS \"TEMP(Calculation_3519281700083154949)(4190307025)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_sd_last\") AS \"TEMP(Calculation_3519281700083154949)(933007102)(0)\",\n  AVG(\"自定义 SQL 查询\".\"totalUsage\") AS \"avg_totalUsage_ok\",\n  \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"sum_totalUsage_ok\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'VerType' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n          tag,\n          area AS Scope,\n          dim,\n          level1,\n          level2,\n          level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n            CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n          total AS totalUsage,\n          audio,\n          video,\n          host_audio,\n          audience_audio,\n          host_sd,\n          host_hd,\n          host_hdp,\n          host_1080p,\n          host_2k,\n          host_4k,\n          audience_sd,\n          audience_hd,\n          audience_hdp,\n          audience_1080p,\n          audience_2k,\n          audience_4k,\n          audience_audio_low_latency,\n          audience_sd_low_latency,\n          audience_hd_low_latency,\n          audience_hdp_low_latency,\n          audience_1080p_low_latency,\n          audience_2k_low_latency,\n          audience_4k_low_latency,\n          audience_audio_ultra_low_latency,\n          audience_sd_ultra_low_latency,\n          audience_hd_ultra_low_latency,\n          audience_hdp_ultra_low_latency,\n          audience_1080p_ultra_low_latency,\n          audience_2k_ultra_low_latency,\n          audience_4k_ultra_low_latency,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n          audience_video_low_latency_last1 AS audience_video_low_latency_last,\n          audience_total_low_latency_last1 AS audience_total_low_latency_last,\n          audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n          audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n          audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n          audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n          audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n          audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n          audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n          audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n          audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n          audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n          audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n          audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n          audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n          audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n          audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n          audience_2k_last1 AS audience_2k_last,\n          audience_4k_last1 AS audience_4k_last,\n          audience_1080p_last1 AS audience_1080p_last,\n          host_1080p_last1 AS host_1080p_last,\n          host_2k_last1 AS host_2k_last,\n          host_4k_last1 AS host_4k_last,\n          total_last7,\n          audio_last7,\n          video_last7,\n          video_sd_last7,\n          video_hd_last7,\n          video_hdp_last7,\n          host_sd_last7,\n          audience_sd_last7,\n          host_hd_last7,\n          audience_hd_last7,\n          host_hdp_last7,\n          audience_hdp_last7,\n          host_audio_last7,\n          audience_audio_last7,\n          host_video_last7,\n          audience_video_last7,\n          audience_audio_low_latency_last7,\n          audience_video_low_latency_last7,\n          audience_total_low_latency_last7,\n          audience_sd_low_latency_last7,\n          audience_hd_low_latency_last7,\n          audience_hdp_low_latency_last7,\n          audience_1080p_low_latency_last7,\n          audience_2k_low_latency_last7,\n          audience_4k_low_latency_last7,\n          audience_audio_ultra_low_latency_last7,\n          audience_video_ultra_low_latency_last7,\n          audience_total_ultra_low_latency_last7,\n          audience_sd_ultra_low_latency_last7,\n          audience_hd_ultra_low_latency_last7,\n          audience_hdp_ultra_low_latency_last7,\n          audience_1080p_ultra_low_latency_last7,\n          audience_2k_ultra_low_latency_last7,\n          audience_4k_ultra_low_latency_last7,\n          audience_2k_last7,\n          audience_4k_last7,\n          audience_1080p_last7,\n          host_1080p_last7,\n          host_2k_last7,\n          host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'VerType' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND \"自定义 SQL 查询\".\"rank_level1\" = 2 AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 36"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700341563406)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio_last7\") AS \"TEMP(Calculation_3519281700341563406)(1077563395)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700341563406)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700341563406)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd_last7\") AS \"TEMP(Calculation_3519281700341563406)(1456465729)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd_last7\") AS \"TEMP(Calculation_3519281700341563406)(1635749653)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd_last7\") AS \"TEMP(Calculation_3519281700341563406)(1747046964)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k_last7\") AS \"TEMP(Calculation_3519281700341563406)(1747524570)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp_last7\") AS \"TEMP(Calculation_3519281700341563406)(2044136109)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio_last7\") AS \"TEMP(Calculation_3519281700341563406)(2464388580)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_last7\") AS \"TEMP(Calculation_3519281700341563406)(2589233512)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700341563406)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k_last7\") AS \"TEMP(Calculation_3519281700341563406)(280796653)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700341563406)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700341563406)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700341563406)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700341563406)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700341563406)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_4k_last7\") AS \"TEMP(Calculation_3519281700341563406)(3127348545)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700341563406)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"total_last7\") AS \"TEMP(Calculation_3519281700341563406)(346677966)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k_last7\") AS \"TEMP(Calculation_3519281700341563406)(3543669678)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p_last7\") AS \"TEMP(Calculation_3519281700341563406)(3624983014)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700341563406)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700341563406)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd_last7\") AS \"TEMP(Calculation_3519281700341563406)(3905372418)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video_last7\") AS \"TEMP(Calculation_3519281700341563406)(4107040267)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700341563406)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700341563406)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p_last7\") AS \"TEMP(Calculation_3519281700341563406)(632977665)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700341563406)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp_last7\") AS \"TEMP(Calculation_3519281700341563406)(750340200)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700341563406)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700341563406)(943764407)(0)\",\n  \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"audio_video_last\") AS \"sum_audio_video_last_ok\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'VerType' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n          tag,\n          area AS Scope,\n          dim,\n          level1,\n          level2,\n          level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n            CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n          total AS totalUsage,\n          audio,\n          video,\n          host_audio,\n          audience_audio,\n          host_sd,\n          host_hd,\n          host_hdp,\n          host_1080p,\n          host_2k,\n          host_4k,\n          audience_sd,\n          audience_hd,\n          audience_hdp,\n          audience_1080p,\n          audience_2k,\n          audience_4k,\n          audience_audio_low_latency,\n          audience_sd_low_latency,\n          audience_hd_low_latency,\n          audience_hdp_low_latency,\n          audience_1080p_low_latency,\n          audience_2k_low_latency,\n          audience_4k_low_latency,\n          audience_audio_ultra_low_latency,\n          audience_sd_ultra_low_latency,\n          audience_hd_ultra_low_latency,\n          audience_hdp_ultra_low_latency,\n          audience_1080p_ultra_low_latency,\n          audience_2k_ultra_low_latency,\n          audience_4k_ultra_low_latency,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n          audience_video_low_latency_last1 AS audience_video_low_latency_last,\n          audience_total_low_latency_last1 AS audience_total_low_latency_last,\n          audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n          audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n          audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n          audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n          audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n          audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n          audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n          audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n          audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n          audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n          audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n          audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n          audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n          audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n          audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n          audience_2k_last1 AS audience_2k_last,\n          audience_4k_last1 AS audience_4k_last,\n          audience_1080p_last1 AS audience_1080p_last,\n          host_1080p_last1 AS host_1080p_last,\n          host_2k_last1 AS host_2k_last,\n          host_4k_last1 AS host_4k_last,\n          total_last7,\n          audio_last7,\n          video_last7,\n          video_sd_last7,\n          video_hd_last7,\n          video_hdp_last7,\n          host_sd_last7,\n          audience_sd_last7,\n          host_hd_last7,\n          audience_hd_last7,\n          host_hdp_last7,\n          audience_hdp_last7,\n          host_audio_last7,\n          audience_audio_last7,\n          host_video_last7,\n          audience_video_last7,\n          audience_audio_low_latency_last7,\n          audience_video_low_latency_last7,\n          audience_total_low_latency_last7,\n          audience_sd_low_latency_last7,\n          audience_hd_low_latency_last7,\n          audience_hdp_low_latency_last7,\n          audience_1080p_low_latency_last7,\n          audience_2k_low_latency_last7,\n          audience_4k_low_latency_last7,\n          audience_audio_ultra_low_latency_last7,\n          audience_video_ultra_low_latency_last7,\n          audience_total_ultra_low_latency_last7,\n          audience_sd_ultra_low_latency_last7,\n          audience_hd_ultra_low_latency_last7,\n          audience_hdp_ultra_low_latency_last7,\n          audience_1080p_ultra_low_latency_last7,\n          audience_2k_ultra_low_latency_last7,\n          audience_4k_ultra_low_latency_last7,\n          audience_2k_last7,\n          audience_4k_last7,\n          audience_1080p_last7,\n          host_1080p_last7,\n          host_2k_last7,\n          host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'VerType' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND \"自定义 SQL 查询\".\"rank_level1\" = 5 AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 35"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700079370244)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700079370244)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700079370244)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700079370244)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700079370244)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700079370244)(943764407)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_4k_last\") AS \"TEMP(Calculation_3519281700083154949)(101123376)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_hdp_last\") AS \"TEMP(Calculation_3519281700083154949)(1200517625)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p_last\") AS \"TEMP(Calculation_3519281700083154949)(1314346200)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_hd_last\") AS \"TEMP(Calculation_3519281700083154949)(146570423)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k_last\") AS \"TEMP(Calculation_3519281700083154949)(1717771635)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio_last\") AS \"TEMP(Calculation_3519281700083154949)(2313111073)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_hdp_last\") AS \"TEMP(Calculation_3519281700083154949)(258310559)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_video_last\") AS \"TEMP(Calculation_3519281700083154949)(2820618408)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k_last\") AS \"TEMP(Calculation_3519281700083154949)(3121859593)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p_last\") AS \"TEMP(Calculation_3519281700083154949)(3222422303)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio_last\") AS \"TEMP(Calculation_3519281700083154949)(3227677803)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video_last\") AS \"TEMP(Calculation_3519281700083154949)(3934387163)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k_last\") AS \"TEMP(Calculation_3519281700083154949)(4055292783)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_last\") AS \"TEMP(Calculation_3519281700083154949)(4091190060)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_hd_last\") AS \"TEMP(Calculation_3519281700083154949)(4170367250)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_sd_last\") AS \"TEMP(Calculation_3519281700083154949)(4190307025)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_sd_last\") AS \"TEMP(Calculation_3519281700083154949)(933007102)(0)\",\n  MAX(\"自定义 SQL 查询\".\"stat_date\") AS \"TEMP(attr_stat_date_nk)(2102638629)(0)\",\n  MIN(\"自定义 SQL 查询\".\"stat_date\") AS \"TEMP(attr_stat_date_nk)(2790680713)(0)\",\n  \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"sum_totalUsage_ok\",\n  DATE_ADD('SECOND', 0, date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"tdy_date_ok\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'VerType' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND \"自定义 SQL 查询\".\"rank_level1\" = 3\nGROUP BY 37,\n  39"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700079370244)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700079370244)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700079370244)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700079370244)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700079370244)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700079370244)(943764407)(0)\",\n  \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"sum_totalUsage_ok\",\n  DATE_ADD('SECOND', 0, date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"tdy_date_ok\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'VerType' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n          tag,\n          area AS Scope,\n          dim,\n          level1,\n          level2,\n          level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n            CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n          total AS totalUsage,\n          audio,\n          video,\n          host_audio,\n          audience_audio,\n          host_sd,\n          host_hd,\n          host_hdp,\n          host_1080p,\n          host_2k,\n          host_4k,\n          audience_sd,\n          audience_hd,\n          audience_hdp,\n          audience_1080p,\n          audience_2k,\n          audience_4k,\n          audience_audio_low_latency,\n          audience_sd_low_latency,\n          audience_hd_low_latency,\n          audience_hdp_low_latency,\n          audience_1080p_low_latency,\n          audience_2k_low_latency,\n          audience_4k_low_latency,\n          audience_audio_ultra_low_latency,\n          audience_sd_ultra_low_latency,\n          audience_hd_ultra_low_latency,\n          audience_hdp_ultra_low_latency,\n          audience_1080p_ultra_low_latency,\n          audience_2k_ultra_low_latency,\n          audience_4k_ultra_low_latency,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n          audience_video_low_latency_last1 AS audience_video_low_latency_last,\n          audience_total_low_latency_last1 AS audience_total_low_latency_last,\n          audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n          audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n          audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n          audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n          audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n          audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n          audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n          audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n          audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n          audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n          audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n          audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n          audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n          audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n          audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n          audience_2k_last1 AS audience_2k_last,\n          audience_4k_last1 AS audience_4k_last,\n          audience_1080p_last1 AS audience_1080p_last,\n          host_1080p_last1 AS host_1080p_last,\n          host_2k_last1 AS host_2k_last,\n          host_4k_last1 AS host_4k_last,\n          total_last7,\n          audio_last7,\n          video_last7,\n          video_sd_last7,\n          video_hd_last7,\n          video_hdp_last7,\n          host_sd_last7,\n          audience_sd_last7,\n          host_hd_last7,\n          audience_hd_last7,\n          host_hdp_last7,\n          audience_hdp_last7,\n          host_audio_last7,\n          audience_audio_last7,\n          host_video_last7,\n          audience_video_last7,\n          audience_audio_low_latency_last7,\n          audience_video_low_latency_last7,\n          audience_total_low_latency_last7,\n          audience_sd_low_latency_last7,\n          audience_hd_low_latency_last7,\n          audience_hdp_low_latency_last7,\n          audience_1080p_low_latency_last7,\n          audience_2k_low_latency_last7,\n          audience_4k_low_latency_last7,\n          audience_audio_ultra_low_latency_last7,\n          audience_video_ultra_low_latency_last7,\n          audience_total_ultra_low_latency_last7,\n          audience_sd_ultra_low_latency_last7,\n          audience_hd_ultra_low_latency_last7,\n          audience_hdp_ultra_low_latency_last7,\n          audience_1080p_ultra_low_latency_last7,\n          audience_2k_ultra_low_latency_last7,\n          audience_4k_ultra_low_latency_last7,\n          audience_2k_last7,\n          audience_4k_last7,\n          audience_1080p_last7,\n          host_1080p_last7,\n          host_2k_last7,\n          host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'VerType' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND \"自定义 SQL 查询\".\"rank_level1\" = 7 AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 18,\n  20"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700079370244)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700079370244)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700079370244)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700079370244)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700079370244)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700079370244)(943764407)(0)\",\n  \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"sum_totalUsage_ok\",\n  DATE_ADD('SECOND', 0, date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"tdy_date_ok\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'VerType' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n          tag,\n          area AS Scope,\n          dim,\n          level1,\n          level2,\n          level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n            CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n          total AS totalUsage,\n          audio,\n          video,\n          host_audio,\n          audience_audio,\n          host_sd,\n          host_hd,\n          host_hdp,\n          host_1080p,\n          host_2k,\n          host_4k,\n          audience_sd,\n          audience_hd,\n          audience_hdp,\n          audience_1080p,\n          audience_2k,\n          audience_4k,\n          audience_audio_low_latency,\n          audience_sd_low_latency,\n          audience_hd_low_latency,\n          audience_hdp_low_latency,\n          audience_1080p_low_latency,\n          audience_2k_low_latency,\n          audience_4k_low_latency,\n          audience_audio_ultra_low_latency,\n          audience_sd_ultra_low_latency,\n          audience_hd_ultra_low_latency,\n          audience_hdp_ultra_low_latency,\n          audience_1080p_ultra_low_latency,\n          audience_2k_ultra_low_latency,\n          audience_4k_ultra_low_latency,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n          audience_video_low_latency_last1 AS audience_video_low_latency_last,\n          audience_total_low_latency_last1 AS audience_total_low_latency_last,\n          audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n          audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n          audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n          audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n          audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n          audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n          audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n          audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n          audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n          audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n          audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n          audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n          audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n          audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n          audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n          audience_2k_last1 AS audience_2k_last,\n          audience_4k_last1 AS audience_4k_last,\n          audience_1080p_last1 AS audience_1080p_last,\n          host_1080p_last1 AS host_1080p_last,\n          host_2k_last1 AS host_2k_last,\n          host_4k_last1 AS host_4k_last,\n          total_last7,\n          audio_last7,\n          video_last7,\n          video_sd_last7,\n          video_hd_last7,\n          video_hdp_last7,\n          host_sd_last7,\n          audience_sd_last7,\n          host_hd_last7,\n          audience_hd_last7,\n          host_hdp_last7,\n          audience_hdp_last7,\n          host_audio_last7,\n          audience_audio_last7,\n          host_video_last7,\n          audience_video_last7,\n          audience_audio_low_latency_last7,\n          audience_video_low_latency_last7,\n          audience_total_low_latency_last7,\n          audience_sd_low_latency_last7,\n          audience_hd_low_latency_last7,\n          audience_hdp_low_latency_last7,\n          audience_1080p_low_latency_last7,\n          audience_2k_low_latency_last7,\n          audience_4k_low_latency_last7,\n          audience_audio_ultra_low_latency_last7,\n          audience_video_ultra_low_latency_last7,\n          audience_total_ultra_low_latency_last7,\n          audience_sd_ultra_low_latency_last7,\n          audience_hd_ultra_low_latency_last7,\n          audience_hdp_ultra_low_latency_last7,\n          audience_1080p_ultra_low_latency_last7,\n          audience_2k_ultra_low_latency_last7,\n          audience_4k_ultra_low_latency_last7,\n          audience_2k_last7,\n          audience_4k_last7,\n          audience_1080p_last7,\n          host_1080p_last7,\n          host_2k_last7,\n          host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'VerType' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND \"自定义 SQL 查询\".\"rank_level1\" = 6 AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 18,\n  20"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k_last\") AS \"TEMP(Calculation_3519281700083154949)(101123376)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700083154949)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700083154949)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_hdp_last\") AS \"TEMP(Calculation_3519281700083154949)(1200517625)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700083154949)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p_last\") AS \"TEMP(Calculation_3519281700083154949)(1314346200)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_hd_last\") AS \"TEMP(Calculation_3519281700083154949)(146570423)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k_last\") AS \"TEMP(Calculation_3519281700083154949)(1717771635)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio_last\") AS \"TEMP(Calculation_3519281700083154949)(2313111073)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_hdp_last\") AS \"TEMP(Calculation_3519281700083154949)(258310559)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700083154949)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_video_last\") AS \"TEMP(Calculation_3519281700083154949)(2820618408)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700083154949)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700083154949)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700083154949)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700083154949)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700083154949)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k_last\") AS \"TEMP(Calculation_3519281700083154949)(3121859593)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p_last\") AS \"TEMP(Calculation_3519281700083154949)(3222422303)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio_last\") AS \"TEMP(Calculation_3519281700083154949)(3227677803)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700083154949)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700083154949)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700083154949)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video_last\") AS \"TEMP(Calculation_3519281700083154949)(3934387163)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k_last\") AS \"TEMP(Calculation_3519281700083154949)(4055292783)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_last\") AS \"TEMP(Calculation_3519281700083154949)(4091190060)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700083154949)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_hd_last\") AS \"TEMP(Calculation_3519281700083154949)(4170367250)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_sd_last\") AS \"TEMP(Calculation_3519281700083154949)(4190307025)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700083154949)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700083154949)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700083154949)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_sd_last\") AS \"TEMP(Calculation_3519281700083154949)(933007102)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700083154949)(943764407)(0)\",\n  AVG(\"自定义 SQL 查询\".\"totalUsage\") AS \"avg_totalUsage_ok\",\n  \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"sum_totalUsage_ok\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'VerType' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n          tag,\n          area AS Scope,\n          dim,\n          level1,\n          level2,\n          level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n            CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n          total AS totalUsage,\n          audio,\n          video,\n          host_audio,\n          audience_audio,\n          host_sd,\n          host_hd,\n          host_hdp,\n          host_1080p,\n          host_2k,\n          host_4k,\n          audience_sd,\n          audience_hd,\n          audience_hdp,\n          audience_1080p,\n          audience_2k,\n          audience_4k,\n          audience_audio_low_latency,\n          audience_sd_low_latency,\n          audience_hd_low_latency,\n          audience_hdp_low_latency,\n          audience_1080p_low_latency,\n          audience_2k_low_latency,\n          audience_4k_low_latency,\n          audience_audio_ultra_low_latency,\n          audience_sd_ultra_low_latency,\n          audience_hd_ultra_low_latency,\n          audience_hdp_ultra_low_latency,\n          audience_1080p_ultra_low_latency,\n          audience_2k_ultra_low_latency,\n          audience_4k_ultra_low_latency,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n          audience_video_low_latency_last1 AS audience_video_low_latency_last,\n          audience_total_low_latency_last1 AS audience_total_low_latency_last,\n          audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n          audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n          audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n          audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n          audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n          audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n          audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n          audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n          audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n          audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n          audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n          audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n          audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n          audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n          audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n          audience_2k_last1 AS audience_2k_last,\n          audience_4k_last1 AS audience_4k_last,\n          audience_1080p_last1 AS audience_1080p_last,\n          host_1080p_last1 AS host_1080p_last,\n          host_2k_last1 AS host_2k_last,\n          host_4k_last1 AS host_4k_last,\n          total_last7,\n          audio_last7,\n          video_last7,\n          video_sd_last7,\n          video_hd_last7,\n          video_hdp_last7,\n          host_sd_last7,\n          audience_sd_last7,\n          host_hd_last7,\n          audience_hd_last7,\n          host_hdp_last7,\n          audience_hdp_last7,\n          host_audio_last7,\n          audience_audio_last7,\n          host_video_last7,\n          audience_video_last7,\n          audience_audio_low_latency_last7,\n          audience_video_low_latency_last7,\n          audience_total_low_latency_last7,\n          audience_sd_low_latency_last7,\n          audience_hd_low_latency_last7,\n          audience_hdp_low_latency_last7,\n          audience_1080p_low_latency_last7,\n          audience_2k_low_latency_last7,\n          audience_4k_low_latency_last7,\n          audience_audio_ultra_low_latency_last7,\n          audience_video_ultra_low_latency_last7,\n          audience_total_ultra_low_latency_last7,\n          audience_sd_ultra_low_latency_last7,\n          audience_hd_ultra_low_latency_last7,\n          audience_hdp_ultra_low_latency_last7,\n          audience_1080p_ultra_low_latency_last7,\n          audience_2k_ultra_low_latency_last7,\n          audience_4k_ultra_low_latency_last7,\n          audience_2k_last7,\n          audience_4k_last7,\n          audience_1080p_last7,\n          host_1080p_last7,\n          host_2k_last7,\n          host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'VerType' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND \"自定义 SQL 查询\".\"rank_level1\" = 3 AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 36"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700341563406)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio_last7\") AS \"TEMP(Calculation_3519281700341563406)(1077563395)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700341563406)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700341563406)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd_last7\") AS \"TEMP(Calculation_3519281700341563406)(1456465729)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd_last7\") AS \"TEMP(Calculation_3519281700341563406)(1635749653)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd_last7\") AS \"TEMP(Calculation_3519281700341563406)(1747046964)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k_last7\") AS \"TEMP(Calculation_3519281700341563406)(1747524570)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp_last7\") AS \"TEMP(Calculation_3519281700341563406)(2044136109)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio_last7\") AS \"TEMP(Calculation_3519281700341563406)(2464388580)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_last7\") AS \"TEMP(Calculation_3519281700341563406)(2589233512)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700341563406)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k_last7\") AS \"TEMP(Calculation_3519281700341563406)(280796653)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700341563406)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700341563406)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700341563406)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700341563406)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700341563406)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_4k_last7\") AS \"TEMP(Calculation_3519281700341563406)(3127348545)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700341563406)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"total_last7\") AS \"TEMP(Calculation_3519281700341563406)(346677966)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k_last7\") AS \"TEMP(Calculation_3519281700341563406)(3543669678)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p_last7\") AS \"TEMP(Calculation_3519281700341563406)(3624983014)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700341563406)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700341563406)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd_last7\") AS \"TEMP(Calculation_3519281700341563406)(3905372418)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video_last7\") AS \"TEMP(Calculation_3519281700341563406)(4107040267)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700341563406)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700341563406)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p_last7\") AS \"TEMP(Calculation_3519281700341563406)(632977665)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700341563406)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp_last7\") AS \"TEMP(Calculation_3519281700341563406)(750340200)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700341563406)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700341563406)(943764407)(0)\",\n  \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"audio_video_last\") AS \"sum_audio_video_last_ok\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'VerType' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n          tag,\n          area AS Scope,\n          dim,\n          level1,\n          level2,\n          level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n            CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n          total AS totalUsage,\n          audio,\n          video,\n          host_audio,\n          audience_audio,\n          host_sd,\n          host_hd,\n          host_hdp,\n          host_1080p,\n          host_2k,\n          host_4k,\n          audience_sd,\n          audience_hd,\n          audience_hdp,\n          audience_1080p,\n          audience_2k,\n          audience_4k,\n          audience_audio_low_latency,\n          audience_sd_low_latency,\n          audience_hd_low_latency,\n          audience_hdp_low_latency,\n          audience_1080p_low_latency,\n          audience_2k_low_latency,\n          audience_4k_low_latency,\n          audience_audio_ultra_low_latency,\n          audience_sd_ultra_low_latency,\n          audience_hd_ultra_low_latency,\n          audience_hdp_ultra_low_latency,\n          audience_1080p_ultra_low_latency,\n          audience_2k_ultra_low_latency,\n          audience_4k_ultra_low_latency,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n          audience_video_low_latency_last1 AS audience_video_low_latency_last,\n          audience_total_low_latency_last1 AS audience_total_low_latency_last,\n          audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n          audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n          audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n          audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n          audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n          audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n          audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n          audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n          audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n          audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n          audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n          audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n          audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n          audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n          audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n          audience_2k_last1 AS audience_2k_last,\n          audience_4k_last1 AS audience_4k_last,\n          audience_1080p_last1 AS audience_1080p_last,\n          host_1080p_last1 AS host_1080p_last,\n          host_2k_last1 AS host_2k_last,\n          host_4k_last1 AS host_4k_last,\n          total_last7,\n          audio_last7,\n          video_last7,\n          video_sd_last7,\n          video_hd_last7,\n          video_hdp_last7,\n          host_sd_last7,\n          audience_sd_last7,\n          host_hd_last7,\n          audience_hd_last7,\n          host_hdp_last7,\n          audience_hdp_last7,\n          host_audio_last7,\n          audience_audio_last7,\n          host_video_last7,\n          audience_video_last7,\n          audience_audio_low_latency_last7,\n          audience_video_low_latency_last7,\n          audience_total_low_latency_last7,\n          audience_sd_low_latency_last7,\n          audience_hd_low_latency_last7,\n          audience_hdp_low_latency_last7,\n          audience_1080p_low_latency_last7,\n          audience_2k_low_latency_last7,\n          audience_4k_low_latency_last7,\n          audience_audio_ultra_low_latency_last7,\n          audience_video_ultra_low_latency_last7,\n          audience_total_ultra_low_latency_last7,\n          audience_sd_ultra_low_latency_last7,\n          audience_hd_ultra_low_latency_last7,\n          audience_hdp_ultra_low_latency_last7,\n          audience_1080p_ultra_low_latency_last7,\n          audience_2k_ultra_low_latency_last7,\n          audience_4k_ultra_low_latency_last7,\n          audience_2k_last7,\n          audience_4k_last7,\n          audience_1080p_last7,\n          host_1080p_last7,\n          host_2k_last7,\n          host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'VerType' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND \"自定义 SQL 查询\".\"rank_level1\" = 1 AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 35"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k_last\") AS \"TEMP(Calculation_3519281700083154949)(101123376)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700083154949)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700083154949)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_hdp_last\") AS \"TEMP(Calculation_3519281700083154949)(1200517625)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700083154949)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p_last\") AS \"TEMP(Calculation_3519281700083154949)(1314346200)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_hd_last\") AS \"TEMP(Calculation_3519281700083154949)(146570423)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k_last\") AS \"TEMP(Calculation_3519281700083154949)(1717771635)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio_last\") AS \"TEMP(Calculation_3519281700083154949)(2313111073)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_hdp_last\") AS \"TEMP(Calculation_3519281700083154949)(258310559)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700083154949)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_video_last\") AS \"TEMP(Calculation_3519281700083154949)(2820618408)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700083154949)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700083154949)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700083154949)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700083154949)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700083154949)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k_last\") AS \"TEMP(Calculation_3519281700083154949)(3121859593)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p_last\") AS \"TEMP(Calculation_3519281700083154949)(3222422303)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio_last\") AS \"TEMP(Calculation_3519281700083154949)(3227677803)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700083154949)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700083154949)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700083154949)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video_last\") AS \"TEMP(Calculation_3519281700083154949)(3934387163)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k_last\") AS \"TEMP(Calculation_3519281700083154949)(4055292783)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_last\") AS \"TEMP(Calculation_3519281700083154949)(4091190060)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700083154949)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_hd_last\") AS \"TEMP(Calculation_3519281700083154949)(4170367250)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_sd_last\") AS \"TEMP(Calculation_3519281700083154949)(4190307025)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700083154949)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700083154949)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700083154949)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_sd_last\") AS \"TEMP(Calculation_3519281700083154949)(933007102)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700083154949)(943764407)(0)\",\n  AVG(\"自定义 SQL 查询\".\"totalUsage\") AS \"avg_totalUsage_ok\",\n  \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"sum_totalUsage_ok\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'VerType' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n          tag,\n          area AS Scope,\n          dim,\n          level1,\n          level2,\n          level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n            CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n          total AS totalUsage,\n          audio,\n          video,\n          host_audio,\n          audience_audio,\n          host_sd,\n          host_hd,\n          host_hdp,\n          host_1080p,\n          host_2k,\n          host_4k,\n          audience_sd,\n          audience_hd,\n          audience_hdp,\n          audience_1080p,\n          audience_2k,\n          audience_4k,\n          audience_audio_low_latency,\n          audience_sd_low_latency,\n          audience_hd_low_latency,\n          audience_hdp_low_latency,\n          audience_1080p_low_latency,\n          audience_2k_low_latency,\n          audience_4k_low_latency,\n          audience_audio_ultra_low_latency,\n          audience_sd_ultra_low_latency,\n          audience_hd_ultra_low_latency,\n          audience_hdp_ultra_low_latency,\n          audience_1080p_ultra_low_latency,\n          audience_2k_ultra_low_latency,\n          audience_4k_ultra_low_latency,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n          audience_video_low_latency_last1 AS audience_video_low_latency_last,\n          audience_total_low_latency_last1 AS audience_total_low_latency_last,\n          audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n          audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n          audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n          audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n          audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n          audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n          audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n          audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n          audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n          audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n          audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n          audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n          audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n          audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n          audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n          audience_2k_last1 AS audience_2k_last,\n          audience_4k_last1 AS audience_4k_last,\n          audience_1080p_last1 AS audience_1080p_last,\n          host_1080p_last1 AS host_1080p_last,\n          host_2k_last1 AS host_2k_last,\n          host_4k_last1 AS host_4k_last,\n          total_last7,\n          audio_last7,\n          video_last7,\n          video_sd_last7,\n          video_hd_last7,\n          video_hdp_last7,\n          host_sd_last7,\n          audience_sd_last7,\n          host_hd_last7,\n          audience_hd_last7,\n          host_hdp_last7,\n          audience_hdp_last7,\n          host_audio_last7,\n          audience_audio_last7,\n          host_video_last7,\n          audience_video_last7,\n          audience_audio_low_latency_last7,\n          audience_video_low_latency_last7,\n          audience_total_low_latency_last7,\n          audience_sd_low_latency_last7,\n          audience_hd_low_latency_last7,\n          audience_hdp_low_latency_last7,\n          audience_1080p_low_latency_last7,\n          audience_2k_low_latency_last7,\n          audience_4k_low_latency_last7,\n          audience_audio_ultra_low_latency_last7,\n          audience_video_ultra_low_latency_last7,\n          audience_total_ultra_low_latency_last7,\n          audience_sd_ultra_low_latency_last7,\n          audience_hd_ultra_low_latency_last7,\n          audience_hdp_ultra_low_latency_last7,\n          audience_1080p_ultra_low_latency_last7,\n          audience_2k_ultra_low_latency_last7,\n          audience_4k_ultra_low_latency_last7,\n          audience_2k_last7,\n          audience_4k_last7,\n          audience_1080p_last7,\n          host_1080p_last7,\n          host_2k_last7,\n          host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'VerType' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND \"自定义 SQL 查询\".\"rank_level1\" = 6 AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 36"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k_last\") AS \"TEMP(Calculation_3519281700083154949)(101123376)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700083154949)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700083154949)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_hdp_last\") AS \"TEMP(Calculation_3519281700083154949)(1200517625)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700083154949)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p_last\") AS \"TEMP(Calculation_3519281700083154949)(1314346200)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_hd_last\") AS \"TEMP(Calculation_3519281700083154949)(146570423)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k_last\") AS \"TEMP(Calculation_3519281700083154949)(1717771635)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio_last\") AS \"TEMP(Calculation_3519281700083154949)(2313111073)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_hdp_last\") AS \"TEMP(Calculation_3519281700083154949)(258310559)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700083154949)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_video_last\") AS \"TEMP(Calculation_3519281700083154949)(2820618408)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700083154949)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700083154949)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700083154949)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700083154949)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700083154949)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k_last\") AS \"TEMP(Calculation_3519281700083154949)(3121859593)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p_last\") AS \"TEMP(Calculation_3519281700083154949)(3222422303)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio_last\") AS \"TEMP(Calculation_3519281700083154949)(3227677803)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700083154949)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700083154949)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700083154949)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video_last\") AS \"TEMP(Calculation_3519281700083154949)(3934387163)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k_last\") AS \"TEMP(Calculation_3519281700083154949)(4055292783)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_last\") AS \"TEMP(Calculation_3519281700083154949)(4091190060)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700083154949)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_hd_last\") AS \"TEMP(Calculation_3519281700083154949)(4170367250)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_sd_last\") AS \"TEMP(Calculation_3519281700083154949)(4190307025)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700083154949)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700083154949)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700083154949)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_sd_last\") AS \"TEMP(Calculation_3519281700083154949)(933007102)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700083154949)(943764407)(0)\",\n  \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"audio_video_last\") AS \"sum_audio_video_last_ok\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'VerType' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n          tag,\n          area AS Scope,\n          dim,\n          level1,\n          level2,\n          level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n            CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n          total AS totalUsage,\n          audio,\n          video,\n          host_audio,\n          audience_audio,\n          host_sd,\n          host_hd,\n          host_hdp,\n          host_1080p,\n          host_2k,\n          host_4k,\n          audience_sd,\n          audience_hd,\n          audience_hdp,\n          audience_1080p,\n          audience_2k,\n          audience_4k,\n          audience_audio_low_latency,\n          audience_sd_low_latency,\n          audience_hd_low_latency,\n          audience_hdp_low_latency,\n          audience_1080p_low_latency,\n          audience_2k_low_latency,\n          audience_4k_low_latency,\n          audience_audio_ultra_low_latency,\n          audience_sd_ultra_low_latency,\n          audience_hd_ultra_low_latency,\n          audience_hdp_ultra_low_latency,\n          audience_1080p_ultra_low_latency,\n          audience_2k_ultra_low_latency,\n          audience_4k_ultra_low_latency,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n          audience_video_low_latency_last1 AS audience_video_low_latency_last,\n          audience_total_low_latency_last1 AS audience_total_low_latency_last,\n          audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n          audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n          audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n          audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n          audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n          audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n          audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n          audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n          audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n          audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n          audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n          audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n          audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n          audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n          audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n          audience_2k_last1 AS audience_2k_last,\n          audience_4k_last1 AS audience_4k_last,\n          audience_1080p_last1 AS audience_1080p_last,\n          host_1080p_last1 AS host_1080p_last,\n          host_2k_last1 AS host_2k_last,\n          host_4k_last1 AS host_4k_last,\n          total_last7,\n          audio_last7,\n          video_last7,\n          video_sd_last7,\n          video_hd_last7,\n          video_hdp_last7,\n          host_sd_last7,\n          audience_sd_last7,\n          host_hd_last7,\n          audience_hd_last7,\n          host_hdp_last7,\n          audience_hdp_last7,\n          host_audio_last7,\n          audience_audio_last7,\n          host_video_last7,\n          audience_video_last7,\n          audience_audio_low_latency_last7,\n          audience_video_low_latency_last7,\n          audience_total_low_latency_last7,\n          audience_sd_low_latency_last7,\n          audience_hd_low_latency_last7,\n          audience_hdp_low_latency_last7,\n          audience_1080p_low_latency_last7,\n          audience_2k_low_latency_last7,\n          audience_4k_low_latency_last7,\n          audience_audio_ultra_low_latency_last7,\n          audience_video_ultra_low_latency_last7,\n          audience_total_ultra_low_latency_last7,\n          audience_sd_ultra_low_latency_last7,\n          audience_hd_ultra_low_latency_last7,\n          audience_hdp_ultra_low_latency_last7,\n          audience_1080p_ultra_low_latency_last7,\n          audience_2k_ultra_low_latency_last7,\n          audience_4k_ultra_low_latency_last7,\n          audience_2k_last7,\n          audience_4k_last7,\n          audience_1080p_last7,\n          host_1080p_last7,\n          host_2k_last7,\n          host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'VerType' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND \"自定义 SQL 查询\".\"rank_level1\" = 1 AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 35"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700341563406)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio_last7\") AS \"TEMP(Calculation_3519281700341563406)(1077563395)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700341563406)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700341563406)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd_last7\") AS \"TEMP(Calculation_3519281700341563406)(1456465729)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd_last7\") AS \"TEMP(Calculation_3519281700341563406)(1635749653)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd_last7\") AS \"TEMP(Calculation_3519281700341563406)(1747046964)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k_last7\") AS \"TEMP(Calculation_3519281700341563406)(1747524570)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp_last7\") AS \"TEMP(Calculation_3519281700341563406)(2044136109)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio_last7\") AS \"TEMP(Calculation_3519281700341563406)(2464388580)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_last7\") AS \"TEMP(Calculation_3519281700341563406)(2589233512)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700341563406)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k_last7\") AS \"TEMP(Calculation_3519281700341563406)(280796653)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700341563406)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700341563406)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700341563406)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700341563406)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700341563406)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_4k_last7\") AS \"TEMP(Calculation_3519281700341563406)(3127348545)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700341563406)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"total_last7\") AS \"TEMP(Calculation_3519281700341563406)(346677966)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k_last7\") AS \"TEMP(Calculation_3519281700341563406)(3543669678)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p_last7\") AS \"TEMP(Calculation_3519281700341563406)(3624983014)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700341563406)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700341563406)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd_last7\") AS \"TEMP(Calculation_3519281700341563406)(3905372418)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video_last7\") AS \"TEMP(Calculation_3519281700341563406)(4107040267)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700341563406)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700341563406)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p_last7\") AS \"TEMP(Calculation_3519281700341563406)(632977665)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700341563406)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp_last7\") AS \"TEMP(Calculation_3519281700341563406)(750340200)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700341563406)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700341563406)(943764407)(0)\",\n  \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"audio_video_last\") AS \"sum_audio_video_last_ok\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'VerType' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n          tag,\n          area AS Scope,\n          dim,\n          level1,\n          level2,\n          level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n            CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n          total AS totalUsage,\n          audio,\n          video,\n          host_audio,\n          audience_audio,\n          host_sd,\n          host_hd,\n          host_hdp,\n          host_1080p,\n          host_2k,\n          host_4k,\n          audience_sd,\n          audience_hd,\n          audience_hdp,\n          audience_1080p,\n          audience_2k,\n          audience_4k,\n          audience_audio_low_latency,\n          audience_sd_low_latency,\n          audience_hd_low_latency,\n          audience_hdp_low_latency,\n          audience_1080p_low_latency,\n          audience_2k_low_latency,\n          audience_4k_low_latency,\n          audience_audio_ultra_low_latency,\n          audience_sd_ultra_low_latency,\n          audience_hd_ultra_low_latency,\n          audience_hdp_ultra_low_latency,\n          audience_1080p_ultra_low_latency,\n          audience_2k_ultra_low_latency,\n          audience_4k_ultra_low_latency,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n          audience_video_low_latency_last1 AS audience_video_low_latency_last,\n          audience_total_low_latency_last1 AS audience_total_low_latency_last,\n          audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n          audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n          audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n          audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n          audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n          audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n          audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n          audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n          audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n          audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n          audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n          audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n          audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n          audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n          audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n          audience_2k_last1 AS audience_2k_last,\n          audience_4k_last1 AS audience_4k_last,\n          audience_1080p_last1 AS audience_1080p_last,\n          host_1080p_last1 AS host_1080p_last,\n          host_2k_last1 AS host_2k_last,\n          host_4k_last1 AS host_4k_last,\n          total_last7,\n          audio_last7,\n          video_last7,\n          video_sd_last7,\n          video_hd_last7,\n          video_hdp_last7,\n          host_sd_last7,\n          audience_sd_last7,\n          host_hd_last7,\n          audience_hd_last7,\n          host_hdp_last7,\n          audience_hdp_last7,\n          host_audio_last7,\n          audience_audio_last7,\n          host_video_last7,\n          audience_video_last7,\n          audience_audio_low_latency_last7,\n          audience_video_low_latency_last7,\n          audience_total_low_latency_last7,\n          audience_sd_low_latency_last7,\n          audience_hd_low_latency_last7,\n          audience_hdp_low_latency_last7,\n          audience_1080p_low_latency_last7,\n          audience_2k_low_latency_last7,\n          audience_4k_low_latency_last7,\n          audience_audio_ultra_low_latency_last7,\n          audience_video_ultra_low_latency_last7,\n          audience_total_ultra_low_latency_last7,\n          audience_sd_ultra_low_latency_last7,\n          audience_hd_ultra_low_latency_last7,\n          audience_hdp_ultra_low_latency_last7,\n          audience_1080p_ultra_low_latency_last7,\n          audience_2k_ultra_low_latency_last7,\n          audience_4k_ultra_low_latency_last7,\n          audience_2k_last7,\n          audience_4k_last7,\n          audience_1080p_last7,\n          host_1080p_last7,\n          host_2k_last7,\n          host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'VerType' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND \"自定义 SQL 查询\".\"rank_level1\" = 7 AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 35"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k_last\") AS \"TEMP(Calculation_3519281700083154949)(101123376)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700083154949)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700083154949)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_hdp_last\") AS \"TEMP(Calculation_3519281700083154949)(1200517625)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700083154949)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p_last\") AS \"TEMP(Calculation_3519281700083154949)(1314346200)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_hd_last\") AS \"TEMP(Calculation_3519281700083154949)(146570423)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k_last\") AS \"TEMP(Calculation_3519281700083154949)(1717771635)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio_last\") AS \"TEMP(Calculation_3519281700083154949)(2313111073)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_hdp_last\") AS \"TEMP(Calculation_3519281700083154949)(258310559)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700083154949)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_video_last\") AS \"TEMP(Calculation_3519281700083154949)(2820618408)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700083154949)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700083154949)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700083154949)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700083154949)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700083154949)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k_last\") AS \"TEMP(Calculation_3519281700083154949)(3121859593)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p_last\") AS \"TEMP(Calculation_3519281700083154949)(3222422303)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio_last\") AS \"TEMP(Calculation_3519281700083154949)(3227677803)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700083154949)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700083154949)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700083154949)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video_last\") AS \"TEMP(Calculation_3519281700083154949)(3934387163)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k_last\") AS \"TEMP(Calculation_3519281700083154949)(4055292783)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_last\") AS \"TEMP(Calculation_3519281700083154949)(4091190060)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700083154949)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_hd_last\") AS \"TEMP(Calculation_3519281700083154949)(4170367250)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_video_sd_last\") AS \"TEMP(Calculation_3519281700083154949)(4190307025)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700083154949)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700083154949)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700083154949)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_sd_last\") AS \"TEMP(Calculation_3519281700083154949)(933007102)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700083154949)(943764407)(0)\",\n  AVG(\"自定义 SQL 查询\".\"totalUsage\") AS \"avg_totalUsage_ok\",\n  \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"sum_totalUsage_ok\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'VerType' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n          tag,\n          area AS Scope,\n          dim,\n          level1,\n          level2,\n          level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n            CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n          total AS totalUsage,\n          audio,\n          video,\n          host_audio,\n          audience_audio,\n          host_sd,\n          host_hd,\n          host_hdp,\n          host_1080p,\n          host_2k,\n          host_4k,\n          audience_sd,\n          audience_hd,\n          audience_hdp,\n          audience_1080p,\n          audience_2k,\n          audience_4k,\n          audience_audio_low_latency,\n          audience_sd_low_latency,\n          audience_hd_low_latency,\n          audience_hdp_low_latency,\n          audience_1080p_low_latency,\n          audience_2k_low_latency,\n          audience_4k_low_latency,\n          audience_audio_ultra_low_latency,\n          audience_sd_ultra_low_latency,\n          audience_hd_ultra_low_latency,\n          audience_hdp_ultra_low_latency,\n          audience_1080p_ultra_low_latency,\n          audience_2k_ultra_low_latency,\n          audience_4k_ultra_low_latency,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n          audience_video_low_latency_last1 AS audience_video_low_latency_last,\n          audience_total_low_latency_last1 AS audience_total_low_latency_last,\n          audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n          audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n          audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n          audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n          audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n          audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n          audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n          audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n          audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n          audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n          audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n          audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n          audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n          audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n          audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n          audience_2k_last1 AS audience_2k_last,\n          audience_4k_last1 AS audience_4k_last,\n          audience_1080p_last1 AS audience_1080p_last,\n          host_1080p_last1 AS host_1080p_last,\n          host_2k_last1 AS host_2k_last,\n          host_4k_last1 AS host_4k_last,\n          total_last7,\n          audio_last7,\n          video_last7,\n          video_sd_last7,\n          video_hd_last7,\n          video_hdp_last7,\n          host_sd_last7,\n          audience_sd_last7,\n          host_hd_last7,\n          audience_hd_last7,\n          host_hdp_last7,\n          audience_hdp_last7,\n          host_audio_last7,\n          audience_audio_last7,\n          host_video_last7,\n          audience_video_last7,\n          audience_audio_low_latency_last7,\n          audience_video_low_latency_last7,\n          audience_total_low_latency_last7,\n          audience_sd_low_latency_last7,\n          audience_hd_low_latency_last7,\n          audience_hdp_low_latency_last7,\n          audience_1080p_low_latency_last7,\n          audience_2k_low_latency_last7,\n          audience_4k_low_latency_last7,\n          audience_audio_ultra_low_latency_last7,\n          audience_video_ultra_low_latency_last7,\n          audience_total_ultra_low_latency_last7,\n          audience_sd_ultra_low_latency_last7,\n          audience_hd_ultra_low_latency_last7,\n          audience_hdp_ultra_low_latency_last7,\n          audience_1080p_ultra_low_latency_last7,\n          audience_2k_ultra_low_latency_last7,\n          audience_4k_ultra_low_latency_last7,\n          audience_2k_last7,\n          audience_4k_last7,\n          audience_1080p_last7,\n          host_1080p_last7,\n          host_2k_last7,\n          host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'VerType' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND \"自定义 SQL 查询\".\"rank_level1\" = 7 AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 36"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700341563406)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio_last7\") AS \"TEMP(Calculation_3519281700341563406)(1077563395)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700341563406)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700341563406)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd_last7\") AS \"TEMP(Calculation_3519281700341563406)(1456465729)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd_last7\") AS \"TEMP(Calculation_3519281700341563406)(1635749653)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd_last7\") AS \"TEMP(Calculation_3519281700341563406)(1747046964)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k_last7\") AS \"TEMP(Calculation_3519281700341563406)(1747524570)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp_last7\") AS \"TEMP(Calculation_3519281700341563406)(2044136109)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio_last7\") AS \"TEMP(Calculation_3519281700341563406)(2464388580)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_last7\") AS \"TEMP(Calculation_3519281700341563406)(2589233512)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700341563406)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k_last7\") AS \"TEMP(Calculation_3519281700341563406)(280796653)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700341563406)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700341563406)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700341563406)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700341563406)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700341563406)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_4k_last7\") AS \"TEMP(Calculation_3519281700341563406)(3127348545)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700341563406)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"total_last7\") AS \"TEMP(Calculation_3519281700341563406)(346677966)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k_last7\") AS \"TEMP(Calculation_3519281700341563406)(3543669678)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p_last7\") AS \"TEMP(Calculation_3519281700341563406)(3624983014)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700341563406)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700341563406)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd_last7\") AS \"TEMP(Calculation_3519281700341563406)(3905372418)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video_last7\") AS \"TEMP(Calculation_3519281700341563406)(4107040267)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700341563406)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700341563406)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p_last7\") AS \"TEMP(Calculation_3519281700341563406)(632977665)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700341563406)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp_last7\") AS \"TEMP(Calculation_3519281700341563406)(750340200)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700341563406)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700341563406)(943764407)(0)\",\n  \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"audio_video_last\") AS \"sum_audio_video_last_ok\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'VerType' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n          tag,\n          area AS Scope,\n          dim,\n          level1,\n          level2,\n          level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n            CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n          total AS totalUsage,\n          audio,\n          video,\n          host_audio,\n          audience_audio,\n          host_sd,\n          host_hd,\n          host_hdp,\n          host_1080p,\n          host_2k,\n          host_4k,\n          audience_sd,\n          audience_hd,\n          audience_hdp,\n          audience_1080p,\n          audience_2k,\n          audience_4k,\n          audience_audio_low_latency,\n          audience_sd_low_latency,\n          audience_hd_low_latency,\n          audience_hdp_low_latency,\n          audience_1080p_low_latency,\n          audience_2k_low_latency,\n          audience_4k_low_latency,\n          audience_audio_ultra_low_latency,\n          audience_sd_ultra_low_latency,\n          audience_hd_ultra_low_latency,\n          audience_hdp_ultra_low_latency,\n          audience_1080p_ultra_low_latency,\n          audience_2k_ultra_low_latency,\n          audience_4k_ultra_low_latency,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n          audience_video_low_latency_last1 AS audience_video_low_latency_last,\n          audience_total_low_latency_last1 AS audience_total_low_latency_last,\n          audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n          audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n          audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n          audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n          audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n          audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n          audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n          audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n          audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n          audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n          audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n          audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n          audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n          audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n          audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n          audience_2k_last1 AS audience_2k_last,\n          audience_4k_last1 AS audience_4k_last,\n          audience_1080p_last1 AS audience_1080p_last,\n          host_1080p_last1 AS host_1080p_last,\n          host_2k_last1 AS host_2k_last,\n          host_4k_last1 AS host_4k_last,\n          total_last7,\n          audio_last7,\n          video_last7,\n          video_sd_last7,\n          video_hd_last7,\n          video_hdp_last7,\n          host_sd_last7,\n          audience_sd_last7,\n          host_hd_last7,\n          audience_hd_last7,\n          host_hdp_last7,\n          audience_hdp_last7,\n          host_audio_last7,\n          audience_audio_last7,\n          host_video_last7,\n          audience_video_last7,\n          audience_audio_low_latency_last7,\n          audience_video_low_latency_last7,\n          audience_total_low_latency_last7,\n          audience_sd_low_latency_last7,\n          audience_hd_low_latency_last7,\n          audience_hdp_low_latency_last7,\n          audience_1080p_low_latency_last7,\n          audience_2k_low_latency_last7,\n          audience_4k_low_latency_last7,\n          audience_audio_ultra_low_latency_last7,\n          audience_video_ultra_low_latency_last7,\n          audience_total_ultra_low_latency_last7,\n          audience_sd_ultra_low_latency_last7,\n          audience_hd_ultra_low_latency_last7,\n          audience_hdp_ultra_low_latency_last7,\n          audience_1080p_ultra_low_latency_last7,\n          audience_2k_ultra_low_latency_last7,\n          audience_4k_ultra_low_latency_last7,\n          audience_2k_last7,\n          audience_4k_last7,\n          audience_1080p_last7,\n          host_1080p_last7,\n          host_2k_last7,\n          host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'VerType' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND \"自定义 SQL 查询\".\"rank_level1\" = 3 AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 35"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"host_4k\") AS \"TEMP(Calculation_3519281700341563406)(1075454865)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio_last7\") AS \"TEMP(Calculation_3519281700341563406)(1077563395)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700341563406)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p\") AS \"TEMP(Calculation_3519281700341563406)(1312501967)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_sd_last7\") AS \"TEMP(Calculation_3519281700341563406)(1456465729)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd_last7\") AS \"TEMP(Calculation_3519281700341563406)(1635749653)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd_last7\") AS \"TEMP(Calculation_3519281700341563406)(1747046964)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k_last7\") AS \"TEMP(Calculation_3519281700341563406)(1747524570)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp_last7\") AS \"TEMP(Calculation_3519281700341563406)(2044136109)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio_last7\") AS \"TEMP(Calculation_3519281700341563406)(2464388580)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_last7\") AS \"TEMP(Calculation_3519281700341563406)(2589233512)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700341563406)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k_last7\") AS \"TEMP(Calculation_3519281700341563406)(280796653)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700341563406)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700341563406)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700341563406)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700341563406)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700341563406)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_4k_last7\") AS \"TEMP(Calculation_3519281700341563406)(3127348545)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700341563406)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"total_last7\") AS \"TEMP(Calculation_3519281700341563406)(346677966)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k_last7\") AS \"TEMP(Calculation_3519281700341563406)(3543669678)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_1080p_last7\") AS \"TEMP(Calculation_3519281700341563406)(3624983014)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p\") AS \"TEMP(Calculation_3519281700341563406)(3628946582)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700341563406)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd_last7\") AS \"TEMP(Calculation_3519281700341563406)(3905372418)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video_last7\") AS \"TEMP(Calculation_3519281700341563406)(4107040267)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700341563406)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_2k\") AS \"TEMP(Calculation_3519281700341563406)(586790827)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_1080p_last7\") AS \"TEMP(Calculation_3519281700341563406)(632977665)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700341563406)(709512178)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp_last7\") AS \"TEMP(Calculation_3519281700341563406)(750340200)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_4k\") AS \"TEMP(Calculation_3519281700341563406)(764410224)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_2k\") AS \"TEMP(Calculation_3519281700341563406)(943764407)(0)\",\n  \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"audio_video_last\") AS \"sum_audio_video_last_ok\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'VerType' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n          tag,\n          area AS Scope,\n          dim,\n          level1,\n          level2,\n          level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n            CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n          total AS totalUsage,\n          audio,\n          video,\n          host_audio,\n          audience_audio,\n          host_sd,\n          host_hd,\n          host_hdp,\n          host_1080p,\n          host_2k,\n          host_4k,\n          audience_sd,\n          audience_hd,\n          audience_hdp,\n          audience_1080p,\n          audience_2k,\n          audience_4k,\n          audience_audio_low_latency,\n          audience_sd_low_latency,\n          audience_hd_low_latency,\n          audience_hdp_low_latency,\n          audience_1080p_low_latency,\n          audience_2k_low_latency,\n          audience_4k_low_latency,\n          audience_audio_ultra_low_latency,\n          audience_sd_ultra_low_latency,\n          audience_hd_ultra_low_latency,\n          audience_hdp_ultra_low_latency,\n          audience_1080p_ultra_low_latency,\n          audience_2k_ultra_low_latency,\n          audience_4k_ultra_low_latency,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n          audience_video_low_latency_last1 AS audience_video_low_latency_last,\n          audience_total_low_latency_last1 AS audience_total_low_latency_last,\n          audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n          audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n          audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n          audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n          audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n          audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n          audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n          audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n          audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n          audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n          audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n          audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n          audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n          audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n          audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n          audience_2k_last1 AS audience_2k_last,\n          audience_4k_last1 AS audience_4k_last,\n          audience_1080p_last1 AS audience_1080p_last,\n          host_1080p_last1 AS host_1080p_last,\n          host_2k_last1 AS host_2k_last,\n          host_4k_last1 AS host_4k_last,\n          total_last7,\n          audio_last7,\n          video_last7,\n          video_sd_last7,\n          video_hd_last7,\n          video_hdp_last7,\n          host_sd_last7,\n          audience_sd_last7,\n          host_hd_last7,\n          audience_hd_last7,\n          host_hdp_last7,\n          audience_hdp_last7,\n          host_audio_last7,\n          audience_audio_last7,\n          host_video_last7,\n          audience_video_last7,\n          audience_audio_low_latency_last7,\n          audience_video_low_latency_last7,\n          audience_total_low_latency_last7,\n          audience_sd_low_latency_last7,\n          audience_hd_low_latency_last7,\n          audience_hdp_low_latency_last7,\n          audience_1080p_low_latency_last7,\n          audience_2k_low_latency_last7,\n          audience_4k_low_latency_last7,\n          audience_audio_ultra_low_latency_last7,\n          audience_video_ultra_low_latency_last7,\n          audience_total_ultra_low_latency_last7,\n          audience_sd_ultra_low_latency_last7,\n          audience_hd_ultra_low_latency_last7,\n          audience_hdp_ultra_low_latency_last7,\n          audience_1080p_ultra_low_latency_last7,\n          audience_2k_ultra_low_latency_last7,\n          audience_4k_ultra_low_latency_last7,\n          audience_2k_last7,\n          audience_4k_last7,\n          audience_1080p_last7,\n          host_1080p_last7,\n          host_2k_last7,\n          host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'VerType' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND \"自定义 SQL 查询\".\"rank_level1\" = 6 AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 35"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"total_last1\") AS \"TEMP(Calculation_4506766225720799234)(18463765)(0)\",\n  SUM(\"自定义 SQL 查询\".\"total_last1\") AS \"TEMP(Calculation_4506766225720799234)(3076278274)(0)\",\n  SUM(\"自定义 SQL 查询\".\"total\") AS \"TEMP(Calculation_4506766225720799234)(936442213)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio_Rtls\") AS \"TEMP(audience_audio环比 (复制)_3515481736061636625)(114275\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio_Rtls_last1\") AS \"TEMP(audience_audio环比 (复制)_3515481736061636625)(234044\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio_Rtls_last1\") AS \"TEMP(audience_audio环比 (复制)_3515481736061636625)(871842\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio_last1\") AS \"TEMP(audience_total环比 (复制)_3515481736059269128)(221897\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(audience_total环比 (复制)_3515481736059269128)(410951\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio_last1\") AS \"TEMP(audience_total环比 (复制)_3515481736059269128)(968935\",\n  SUM(\"自定义 SQL 查询\".\"audience_total_Rtls\") AS \"TEMP(audience_total环比 (复制)_3515481736061145103)(137652\",\n  SUM(\"自定义 SQL 查询\".\"audience_total_Rtls_last1\") AS \"TEMP(audience_total环比 (复制)_3515481736061145103)(229190\",\n  SUM(\"自定义 SQL 查询\".\"audience_total_Rtls_last1\") AS \"TEMP(audience_total环比 (复制)_3515481736061145103)(350237\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_Rtls_last1\") AS \"TEMP(audience_video环比 (复制)_3515481736061820947)(165034\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_Rtls\") AS \"TEMP(audience_video环比 (复制)_3515481736061820947)(280776\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_Rtls_last1\") AS \"TEMP(audience_video环比 (复制)_3515481736061820947)(485267\",\n  SUM(\"自定义 SQL 查询\".\"audience_total\") AS \"TEMP(audio环比 (复制)_3515481736057733126)(1329755254)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_total_last1\") AS \"TEMP(audio环比 (复制)_3515481736057733126)(1456980110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_total_last1\") AS \"TEMP(audio环比 (复制)_3515481736057733126)(740840681)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_last1\") AS \"TEMP(total环比 (复制)_3515481736054857729)(2207581090)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_last1\") AS \"TEMP(total环比 (复制)_3515481736054857729)(2881860068)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(total环比 (复制)_3515481736054857729)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video_last1\") AS \"TEMP(total环比 (复制)_3515481736056274947)(1016491311)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video_last1\") AS \"TEMP(total环比 (复制)_3515481736056274947)(1192334319)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(total环比 (复制)_3515481736056274947)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_last1\") AS \"TEMP(video环比 (复制)_3515481736060297229)(188915252)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_last1\") AS \"TEMP(video环比 (复制)_3515481736060297229)(4069483849)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video\") AS \"TEMP(video环比 (复制)_3515481736060297229)(4180494043)(0)\"\nFROM (SELECT date,\n      tag,\n      dim_grouping_name,\n      area,\n        SUM(audio) + SUM(video) AS total,\n      SUM(audio) AS audio,\n      SUM(video) AS video,\n      SUM(video_sd) AS video_sd,\n      SUM(video_hd) AS video_hd,\n      SUM(video_hdp) AS video_hdp,\n        SUM(audience_audio) + SUM(audience_video) AS audience_total,\n      SUM(audience_audio) AS audience_audio,\n      SUM(audience_video) AS audience_video,\n      SUM(audience_sd) AS audience_sd,\n      SUM(audience_hd) AS audience_hd,\n      SUM(audience_hdp) AS audience_hdp,\n      SUM(audience_total_low_latency) AS audience_total_Rtls,\n      SUM(audience_audio_low_latency) AS audience_audio_Rtls,\n      SUM(audience_video_low_latency) AS audience_video_Rtls,\n      SUM(audience_sd_low_latency) AS audience_sd_Rtls,\n      SUM(audience_hd_low_latency) AS audience_hd_Rtls,\n      SUM(audience_hdp_low_latency) AS audience_hdp_Rtls,\n      SUM(total_last1) AS total_last1,\n      SUM(audio_last1) AS audio_last1,\n      SUM(video_last1) AS video_last1,\n        SUM(audience_audio_last1) + SUM(audience_video_last1) AS audience_total_last1,\n      SUM(audience_audio_last1) AS audience_audio_last1,\n      SUM(audience_video_last1) AS audience_video_last1,\n      SUM(audience_total_low_latency_last1) AS audience_total_Rtls_last1,\n      SUM(audience_audio_low_latency_last1) AS audience_audio_Rtls_last1,\n      SUM(audience_video_low_latency_last1) AS audience_video_Rtls_last1,\n      SUM(total_last7) AS total_last7,\n      SUM(audio_last7) AS audio_last7,\n      SUM(video_last7) AS video_last7,\n        SUM(audience_audio_last7) + SUM(audience_video_last7) AS audience_total_last7,\n      SUM(audience_audio_last7) AS audience_audio_last7,\n      SUM(audience_video_last7) AS audience_video_last7,\n      SUM(audience_total_low_latency_last7) AS audience_total_Rtls_last7,\n      SUM(audience_audio_low_latency_last7) AS audience_audio_Rtls_last7,\n      SUM(audience_video_low_latency_last7) AS audience_video_Rtls_last7\n    FROM report_datahub.levels_usage_dod_di_1\n    WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') BETWEEN DATE('2021-11-13') AND DATE('2021-12-13') AND CAST(tag AS VARCHAR) = 'SpecialGroup' AND dim = 1 AND CAST(level1 AS VARCHAR) = 'RTLSVID' AND area IS NOT NULL\n    GROUP BY 1,\n      2,\n      3,\n      4) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n          tag,\n          dim_grouping_name,\n          area,\n            SUM(audio) + SUM(video) AS total,\n          SUM(audio) AS audio,\n          SUM(video) AS video,\n          SUM(video_sd) AS video_sd,\n          SUM(video_hd) AS video_hd,\n          SUM(video_hdp) AS video_hdp,\n            SUM(audience_audio) + SUM(audience_video) AS audience_total,\n          SUM(audience_audio) AS audience_audio,\n          SUM(audience_video) AS audience_video,\n          SUM(audience_sd) AS audience_sd,\n          SUM(audience_hd) AS audience_hd,\n          SUM(audience_hdp) AS audience_hdp,\n          SUM(audience_total_low_latency) AS audience_total_Rtls,\n          SUM(audience_audio_low_latency) AS audience_audio_Rtls,\n          SUM(audience_video_low_latency) AS audience_video_Rtls,\n          SUM(audience_sd_low_latency) AS audience_sd_Rtls,\n          SUM(audience_hd_low_latency) AS audience_hd_Rtls,\n          SUM(audience_hdp_low_latency) AS audience_hdp_Rtls,\n          SUM(total_last1) AS total_last1,\n          SUM(audio_last1) AS audio_last1,\n          SUM(video_last1) AS video_last1,\n            SUM(audience_audio_last1) + SUM(audience_video_last1) AS audience_total_last1,\n          SUM(audience_audio_last1) AS audience_audio_last1,\n          SUM(audience_video_last1) AS audience_video_last1,\n          SUM(audience_total_low_latency_last1) AS audience_total_Rtls_last1,\n          SUM(audience_audio_low_latency_last1) AS audience_audio_Rtls_last1,\n          SUM(audience_video_low_latency_last1) AS audience_video_Rtls_last1,\n          SUM(total_last7) AS total_last7,\n          SUM(audio_last7) AS audio_last7,\n          SUM(video_last7) AS video_last7,\n            SUM(audience_audio_last7) + SUM(audience_video_last7) AS audience_total_last7,\n          SUM(audience_audio_last7) AS audience_audio_last7,\n          SUM(audience_video_last7) AS audience_video_last7,\n          SUM(audience_total_low_latency_last7) AS audience_total_Rtls_last7,\n          SUM(audience_audio_low_latency_last7) AS audience_audio_Rtls_last7,\n          SUM(audience_video_low_latency_last7) AS audience_video_Rtls_last7\n        FROM report_datahub.levels_usage_dod_di_1\n        WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') BETWEEN DATE('2021-11-13') AND DATE('2021-12-13') AND CAST(tag AS VARCHAR) = 'SpecialGroup' AND dim = 1 AND CAST(level1 AS VARCHAR) = 'RTLSVID' AND area IS NOT NULL\n        GROUP BY 1,\n          2,\n          3,\n          4) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"area\" IN ('China', 'Not China') AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nHAVING COUNT(1) > 0"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"audience_audio_Rtls\") AS \"TEMP(audience_audio7同比 (复制)_3515481736061636624)(11427\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio_Rtls_last7\") AS \"TEMP(audience_audio7同比 (复制)_3515481736061636624)(30586\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio_Rtls_last7\") AS \"TEMP(audience_audio7同比 (复制)_3515481736061636624)(32950\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio_last7\") AS \"TEMP(audience_total7同比 (复制)_3515481736059269127)(10775\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio_last7\") AS \"TEMP(audience_total7同比 (复制)_3515481736059269127)(17839\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(audience_total7同比 (复制)_3515481736059269127)(41095\",\n  SUM(\"自定义 SQL 查询\".\"audience_total_Rtls\") AS \"TEMP(audience_total7同比 (复制)_3515481736061145102)(13765\",\n  SUM(\"自定义 SQL 查询\".\"audience_total_Rtls_last7\") AS \"TEMP(audience_total7同比 (复制)_3515481736061145102)(18635\",\n  SUM(\"自定义 SQL 查询\".\"audience_total_Rtls_last7\") AS \"TEMP(audience_total7同比 (复制)_3515481736061145102)(41459\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_Rtls_last7\") AS \"TEMP(audience_video7同比 (复制)_3515481736061820946)(17649\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_Rtls_last7\") AS \"TEMP(audience_video7同比 (复制)_3515481736061820946)(21126\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_Rtls\") AS \"TEMP(audience_video7同比 (复制)_3515481736061820946)(28077\",\n  SUM(\"自定义 SQL 查询\".\"audience_total\") AS \"TEMP(audio7同比 (复制)_3515481736057733125)(1329755254)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_total_last7\") AS \"TEMP(audio7同比 (复制)_3515481736057733125)(2726538543)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_total_last7\") AS \"TEMP(audio7同比 (复制)_3515481736057733125)(4160117856)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_last7\") AS \"TEMP(total7同比 (复制)_3515481736054857730)(1745737303)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_last7\") AS \"TEMP(total7同比 (复制)_3515481736054857730)(2589233512)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(total7同比 (复制)_3515481736054857730)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(total7同比 (复制)_3515481736056274948)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video_last7\") AS \"TEMP(total7同比 (复制)_3515481736056274948)(3553322618)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video_last7\") AS \"TEMP(total7同比 (复制)_3515481736056274948)(4107040267)(0)\",\n  SUM(\"自定义 SQL 查询\".\"total_last7\") AS \"TEMP(total环比 (复制)_3515481736050769920)(346677966)(0)\",\n  SUM(\"自定义 SQL 查询\".\"total_last7\") AS \"TEMP(total环比 (复制)_3515481736050769920)(431428601)(0)\",\n  SUM(\"自定义 SQL 查询\".\"total\") AS \"TEMP(total环比 (复制)_3515481736050769920)(936442213)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_last7\") AS \"TEMP(video7同比 (复制)_3515481736060297228)(1897793420)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video_last7\") AS \"TEMP(video7同比 (复制)_3515481736060297228)(3354863326)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_video\") AS \"TEMP(video7同比 (复制)_3515481736060297228)(4180494043)(0)\"\nFROM (SELECT date,\n      tag,\n      dim_grouping_name,\n      area,\n        SUM(audio) + SUM(video) AS total,\n      SUM(audio) AS audio,\n      SUM(video) AS video,\n      SUM(video_sd) AS video_sd,\n      SUM(video_hd) AS video_hd,\n      SUM(video_hdp) AS video_hdp,\n        SUM(audience_audio) + SUM(audience_video) AS audience_total,\n      SUM(audience_audio) AS audience_audio,\n      SUM(audience_video) AS audience_video,\n      SUM(audience_sd) AS audience_sd,\n      SUM(audience_hd) AS audience_hd,\n      SUM(audience_hdp) AS audience_hdp,\n      SUM(audience_total_low_latency) AS audience_total_Rtls,\n      SUM(audience_audio_low_latency) AS audience_audio_Rtls,\n      SUM(audience_video_low_latency) AS audience_video_Rtls,\n      SUM(audience_sd_low_latency) AS audience_sd_Rtls,\n      SUM(audience_hd_low_latency) AS audience_hd_Rtls,\n      SUM(audience_hdp_low_latency) AS audience_hdp_Rtls,\n      SUM(total_last1) AS total_last1,\n      SUM(audio_last1) AS audio_last1,\n      SUM(video_last1) AS video_last1,\n        SUM(audience_audio_last1) + SUM(audience_video_last1) AS audience_total_last1,\n      SUM(audience_audio_last1) AS audience_audio_last1,\n      SUM(audience_video_last1) AS audience_video_last1,\n      SUM(audience_total_low_latency_last1) AS audience_total_Rtls_last1,\n      SUM(audience_audio_low_latency_last1) AS audience_audio_Rtls_last1,\n      SUM(audience_video_low_latency_last1) AS audience_video_Rtls_last1,\n      SUM(total_last7) AS total_last7,\n      SUM(audio_last7) AS audio_last7,\n      SUM(video_last7) AS video_last7,\n        SUM(audience_audio_last7) + SUM(audience_video_last7) AS audience_total_last7,\n      SUM(audience_audio_last7) AS audience_audio_last7,\n      SUM(audience_video_last7) AS audience_video_last7,\n      SUM(audience_total_low_latency_last7) AS audience_total_Rtls_last7,\n      SUM(audience_audio_low_latency_last7) AS audience_audio_Rtls_last7,\n      SUM(audience_video_low_latency_last7) AS audience_video_Rtls_last7\n    FROM report_datahub.levels_usage_dod_di_1\n    WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') BETWEEN DATE('2021-11-13') AND DATE('2021-12-13') AND CAST(tag AS VARCHAR) = 'SpecialGroup' AND dim = 1 AND CAST(level1 AS VARCHAR) = 'RTLSVID' AND area IS NOT NULL\n    GROUP BY 1,\n      2,\n      3,\n      4) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n          tag,\n          dim_grouping_name,\n          area,\n            SUM(audio) + SUM(video) AS total,\n          SUM(audio) AS audio,\n          SUM(video) AS video,\n          SUM(video_sd) AS video_sd,\n          SUM(video_hd) AS video_hd,\n          SUM(video_hdp) AS video_hdp,\n            SUM(audience_audio) + SUM(audience_video) AS audience_total,\n          SUM(audience_audio) AS audience_audio,\n          SUM(audience_video) AS audience_video,\n          SUM(audience_sd) AS audience_sd,\n          SUM(audience_hd) AS audience_hd,\n          SUM(audience_hdp) AS audience_hdp,\n          SUM(audience_total_low_latency) AS audience_total_Rtls,\n          SUM(audience_audio_low_latency) AS audience_audio_Rtls,\n          SUM(audience_video_low_latency) AS audience_video_Rtls,\n          SUM(audience_sd_low_latency) AS audience_sd_Rtls,\n          SUM(audience_hd_low_latency) AS audience_hd_Rtls,\n          SUM(audience_hdp_low_latency) AS audience_hdp_Rtls,\n          SUM(total_last1) AS total_last1,\n          SUM(audio_last1) AS audio_last1,\n          SUM(video_last1) AS video_last1,\n            SUM(audience_audio_last1) + SUM(audience_video_last1) AS audience_total_last1,\n          SUM(audience_audio_last1) AS audience_audio_last1,\n          SUM(audience_video_last1) AS audience_video_last1,\n          SUM(audience_total_low_latency_last1) AS audience_total_Rtls_last1,\n          SUM(audience_audio_low_latency_last1) AS audience_audio_Rtls_last1,\n          SUM(audience_video_low_latency_last1) AS audience_video_Rtls_last1,\n          SUM(total_last7) AS total_last7,\n          SUM(audio_last7) AS audio_last7,\n          SUM(video_last7) AS video_last7,\n            SUM(audience_audio_last7) + SUM(audience_video_last7) AS audience_total_last7,\n          SUM(audience_audio_last7) AS audience_audio_last7,\n          SUM(audience_video_last7) AS audience_video_last7,\n          SUM(audience_total_low_latency_last7) AS audience_total_Rtls_last7,\n          SUM(audience_audio_low_latency_last7) AS audience_audio_Rtls_last7,\n          SUM(audience_video_low_latency_last7) AS audience_video_Rtls_last7\n        FROM report_datahub.levels_usage_dod_di_1\n        WHERE date_parse(cast( date as VARCHAR), '%Y%m%d') BETWEEN DATE('2021-11-13') AND DATE('2021-12-13') AND CAST(tag AS VARCHAR) = 'SpecialGroup' AND dim = 1 AND CAST(level1 AS VARCHAR) = 'RTLSVID' AND area IS NOT NULL\n        GROUP BY 1,\n          2,\n          3,\n          4) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"area\" IN ('China', 'Not China') AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nHAVING COUNT(1) > 0"
	},
	{
		"presto_sql" : "SELECT \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"usr_Calculation_3519281700079370244_ok\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'VerType' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1\nGROUP BY 1"
	},
	{
		"presto_sql" : "SELECT \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"usr_Calculation_3519281700079370244_ok\"\nFROM (SELECT date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n        CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n      total AS totalUsage,\n      audio,\n      video,\n      host_audio,\n      audience_audio,\n      host_sd,\n      host_hd,\n      host_hdp,\n      host_1080p,\n      host_2k,\n      host_4k,\n      audience_sd,\n      audience_hd,\n      audience_hdp,\n      audience_1080p,\n      audience_2k,\n      audience_4k,\n      audience_audio_low_latency,\n      audience_sd_low_latency,\n      audience_hd_low_latency,\n      audience_hdp_low_latency,\n      audience_1080p_low_latency,\n      audience_2k_low_latency,\n      audience_4k_low_latency,\n      audience_audio_ultra_low_latency,\n      audience_sd_ultra_low_latency,\n      audience_hd_ultra_low_latency,\n      audience_hdp_ultra_low_latency,\n      audience_1080p_ultra_low_latency,\n      audience_2k_ultra_low_latency,\n      audience_4k_ultra_low_latency,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n      audience_video_low_latency_last1 AS audience_video_low_latency_last,\n      audience_total_low_latency_last1 AS audience_total_low_latency_last,\n      audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n      audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n      audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n      audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n      audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n      audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n      audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n      audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n      audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n      audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n      audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n      audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n      audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n      audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n      audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n      audience_2k_last1 AS audience_2k_last,\n      audience_4k_last1 AS audience_4k_last,\n      audience_1080p_last1 AS audience_1080p_last,\n      host_1080p_last1 AS host_1080p_last,\n      host_2k_last1 AS host_2k_last,\n      host_4k_last1 AS host_4k_last,\n      total_last7,\n      audio_last7,\n      video_last7,\n      video_sd_last7,\n      video_hd_last7,\n      video_hdp_last7,\n      host_sd_last7,\n      audience_sd_last7,\n      host_hd_last7,\n      audience_hd_last7,\n      host_hdp_last7,\n      audience_hdp_last7,\n      host_audio_last7,\n      audience_audio_last7,\n      host_video_last7,\n      audience_video_last7,\n      audience_audio_low_latency_last7,\n      audience_video_low_latency_last7,\n      audience_total_low_latency_last7,\n      audience_sd_low_latency_last7,\n      audience_hd_low_latency_last7,\n      audience_hdp_low_latency_last7,\n      audience_1080p_low_latency_last7,\n      audience_2k_low_latency_last7,\n      audience_4k_low_latency_last7,\n      audience_audio_ultra_low_latency_last7,\n      audience_video_ultra_low_latency_last7,\n      audience_total_ultra_low_latency_last7,\n      audience_sd_ultra_low_latency_last7,\n      audience_hd_ultra_low_latency_last7,\n      audience_hdp_ultra_low_latency_last7,\n      audience_1080p_ultra_low_latency_last7,\n      audience_2k_ultra_low_latency_last7,\n      audience_4k_ultra_low_latency_last7,\n      audience_2k_last7,\n      audience_4k_last7,\n      audience_1080p_last7,\n      host_1080p_last7,\n      host_2k_last7,\n      host_4k_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'VerType' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n          tag,\n          area AS Scope,\n          dim,\n          level1,\n          level2,\n          level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n            CASE WHEN level1 IN ('RTC', '泛娱乐', '主版本') THEN 1 WHEN level1 IN ('RTSC', 'Gaming', '泛娱乐特殊版') THEN 2 WHEN level1 IN ('UNKNOWN', 'OTHERS', '老主版本') THEN 3 WHEN level1 IN ('RTSA', '教育', '主版本小版本') THEN 4 WHEN level1 IN ('智能硬件', '大重构版本') THEN 5 WHEN level1 IN ('企业协作', 'NASA版本') THEN 6 WHEN level1 IN ('医疗', '教育稳定版') THEN 7 WHEN level1 IN ('金融', '教育特殊版') THEN 8 ELSE NULL END AS rank_level1,\n          total AS totalUsage,\n          audio,\n          video,\n          host_audio,\n          audience_audio,\n          host_sd,\n          host_hd,\n          host_hdp,\n          host_1080p,\n          host_2k,\n          host_4k,\n          audience_sd,\n          audience_hd,\n          audience_hdp,\n          audience_1080p,\n          audience_2k,\n          audience_4k,\n          audience_audio_low_latency,\n          audience_sd_low_latency,\n          audience_hd_low_latency,\n          audience_hdp_low_latency,\n          audience_1080p_low_latency,\n          audience_2k_low_latency,\n          audience_4k_low_latency,\n          audience_audio_ultra_low_latency,\n          audience_sd_ultra_low_latency,\n          audience_hd_ultra_low_latency,\n          audience_hdp_ultra_low_latency,\n          audience_1080p_ultra_low_latency,\n          audience_2k_ultra_low_latency,\n          audience_4k_ultra_low_latency,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          audience_audio_low_latency_last1 AS audience_audio_low_latency_last,\n          audience_video_low_latency_last1 AS audience_video_low_latency_last,\n          audience_total_low_latency_last1 AS audience_total_low_latency_last,\n          audience_sd_low_latency_last1 AS audience_sd_low_latency_last,\n          audience_hd_low_latency_last1 AS audience_hd_low_latency_last,\n          audience_hdp_low_latency_last1 AS audience_hdp_low_latency_last,\n          audience_1080p_low_latency_last1 AS audience_1080p_low_latency_last,\n          audience_2k_low_latency_last1 AS audience_2k_low_latency_last,\n          audience_4k_low_latency_last1 AS audience_4k_low_latency_last,\n          audience_audio_ultra_low_latency_last1 AS audience_audio_ultra_low_latency_last,\n          audience_video_ultra_low_latency_last1 AS audience_video_ultra_low_latency_last,\n          audience_total_ultra_low_latency_last1 AS audience_total_ultra_low_latency_last,\n          audience_sd_ultra_low_latency_last1 AS audience_sd_ultra_low_latency_last,\n          audience_hd_ultra_low_latency_last1 AS audience_hd_ultra_low_latency_last,\n          audience_hdp_ultra_low_latency_last1 AS audience_hdp_ultra_low_latency_last,\n          audience_1080p_ultra_low_latency_last1 AS audience_1080p_ultra_low_latency_last,\n          audience_2k_ultra_low_latency_last1 AS audience_2k_ultra_low_latency_last,\n          audience_4k_ultra_low_latency_last1 AS audience_4k_ultra_low_latency_last,\n          audience_2k_last1 AS audience_2k_last,\n          audience_4k_last1 AS audience_4k_last,\n          audience_1080p_last1 AS audience_1080p_last,\n          host_1080p_last1 AS host_1080p_last,\n          host_2k_last1 AS host_2k_last,\n          host_4k_last1 AS host_4k_last,\n          total_last7,\n          audio_last7,\n          video_last7,\n          video_sd_last7,\n          video_hd_last7,\n          video_hdp_last7,\n          host_sd_last7,\n          audience_sd_last7,\n          host_hd_last7,\n          audience_hd_last7,\n          host_hdp_last7,\n          audience_hdp_last7,\n          host_audio_last7,\n          audience_audio_last7,\n          host_video_last7,\n          audience_video_last7,\n          audience_audio_low_latency_last7,\n          audience_video_low_latency_last7,\n          audience_total_low_latency_last7,\n          audience_sd_low_latency_last7,\n          audience_hd_low_latency_last7,\n          audience_hdp_low_latency_last7,\n          audience_1080p_low_latency_last7,\n          audience_2k_low_latency_last7,\n          audience_4k_low_latency_last7,\n          audience_audio_ultra_low_latency_last7,\n          audience_video_ultra_low_latency_last7,\n          audience_total_ultra_low_latency_last7,\n          audience_sd_ultra_low_latency_last7,\n          audience_hd_ultra_low_latency_last7,\n          audience_hdp_ultra_low_latency_last7,\n          audience_1080p_ultra_low_latency_last7,\n          audience_2k_ultra_low_latency_last7,\n          audience_4k_ultra_low_latency_last7,\n          audience_2k_last7,\n          audience_4k_last7,\n          audience_1080p_last7,\n          host_1080p_last7,\n          host_2k_last7,\n          host_4k_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'VerType' AND date >= 20211113 AND date <= 20211211 AND dim = 1 AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 1"
	},
	{
		"presto_sql" : "SELECT \"自定义 SQL 查询\".\"level1\" AS \"level1\"\nFROM (SELECT date,\n      SUBSTR(CAST(start_date AS VARCHAR), 1, 10) AS start_date_7,\n      SUBSTR(CAST(end_date AS VARCHAR), 1, 10) AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1,\n      product_level2,\n      product_level3,\n      product_level4,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      vid,\n      project,\n      company_id,\n      company_name,\n      dim_grouping_name,\n      rownum,\n      total,\n      total_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'VerType' AND date >= 20211113 AND date <= 20211211 AND dim IN (101, 102, 103) AND area IS NOT NULL AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\nGROUP BY 1\nORDER BY \"level1\""
	},
	{
		"presto_sql" : "SELECT \"自定义 SQL 查询\".\"rownum\" AS \"rownum\",\n  SUM(\"自定义 SQL 查询\".\"rownum\") AS \"sum_rownum_ok\"\nFROM (SELECT date,\n      SUBSTR(CAST(start_date AS VARCHAR), 1, 10) AS start_date_7,\n      SUBSTR(CAST(end_date AS VARCHAR), 1, 10) AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n      level1,\n      level2,\n      level3,\n      level4,\n      product_level1,\n      product_level2,\n      product_level3,\n      product_level4,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      vid,\n      project,\n      company_id,\n      company_name,\n      dim_grouping_name,\n      rownum,\n      total,\n      total_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'VerType' AND date >= 20211113 AND date <= 20211211 AND dim IN (101, 102, 103) AND area IS NOT NULL AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n          SUBSTR(CAST(start_date AS VARCHAR), 1, 10) AS start_date_7,\n          SUBSTR(CAST(end_date AS VARCHAR), 1, 10) AS end_date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          tag,\n          area AS Scope,\n          dim,\n          level1,\n          level2,\n          level3,\n          level4,\n          product_level1,\n          product_level2,\n          product_level3,\n          product_level4,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          vid,\n          project,\n          company_id,\n          company_name,\n          dim_grouping_name,\n          rownum,\n          total,\n          total_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'VerType' AND date >= 20211113 AND date <= 20211211 AND dim IN (101, 102, 103) AND area IS NOT NULL AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 101 AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 1"
	},
	{
		"presto_sql" : "SELECT \"自定义 SQL 查询\".\"vid_use_case_cn\" AS \"vid_use_case_cn\"\nFROM (SELECT date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n      total AS totalUsage,\n      audio AS audio,\n      video AS video,\n        host_sd + audience_sd AS video_sd,\n        host_hd + audience_hd AS video_hd,\n        host_hdp + audience_hdp AS video_hdp,\n      host_audio AS host_audio,\n      audience_audio AS audience_audio,\n      host_sd AS host_sd,\n      host_hd AS host_hd,\n      host_hdp AS host_hdp,\n      audience_sd AS audience_sd,\n      audience_hd AS audience_hd,\n      audience_hdp AS audience_hdp,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      total_last7 AS total_last7,\n      audio_last7 AS audio_last7,\n      video_last7 AS video_last7,\n      video_sd_last7 AS video_sd_last7,\n      video_hd_last7 AS video_hd_last7,\n      video_hdp_last7 AS video_hdp_last7,\n      host_sd_last7 AS host_sd_last7,\n      audience_sd_last7 AS audience_sd_last7,\n      host_hd_last7 AS host_hd_last7,\n      audience_hd_last7 AS audience_hd_last7,\n      host_hdp_last7 AS host_hdp_last7,\n      audience_hdp_last7 AS audience_hdp_last7,\n      host_audio_last7 AS host_audio_last7,\n      audience_audio_last7 AS audience_audio_last7,\n      host_video_last7 AS host_video_last7,\n      audience_video_last7 AS audience_video_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211113 AND date <= 20211212 AND dim = 1 AND area IS NOT NULL AND CAST(level1 AS VARCHAR) = 'Education' AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\nGROUP BY 1\nORDER BY \"vid_use_case_cn\""
	},
	{
		"presto_sql" : "SELECT \"自定义 SQL 查询\".\"stat_date\" AS \"stat_date\",\n  \"自定义 SQL 查询\".\"vid_sector_en\" AS \"vid_sector_en\"\nFROM (SELECT date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n      total AS totalUsage,\n      audio AS audio,\n      video AS video,\n        host_sd + audience_sd AS video_sd,\n        host_hd + audience_hd AS video_hd,\n        host_hdp + audience_hdp AS video_hdp,\n      host_audio AS host_audio,\n      audience_audio AS audience_audio,\n      host_sd AS host_sd,\n      host_hd AS host_hd,\n      host_hdp AS host_hdp,\n      audience_sd AS audience_sd,\n      audience_hd AS audience_hd,\n      audience_hdp AS audience_hdp,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      total_last7 AS total_last7,\n      audio_last7 AS audio_last7,\n      video_last7 AS video_last7,\n      video_sd_last7 AS video_sd_last7,\n      video_hd_last7 AS video_hd_last7,\n      video_hdp_last7 AS video_hdp_last7,\n      host_sd_last7 AS host_sd_last7,\n      audience_sd_last7 AS audience_sd_last7,\n      host_hd_last7 AS host_hd_last7,\n      audience_hd_last7 AS audience_hd_last7,\n      host_hdp_last7 AS host_hdp_last7,\n      audience_hdp_last7 AS audience_hdp_last7,\n      host_audio_last7 AS host_audio_last7,\n      audience_audio_last7 AS audience_audio_last7,\n      host_video_last7 AS host_video_last7,\n      audience_video_last7 AS audience_video_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211113 AND date <= 20211212 AND dim = 1 AND area IS NOT NULL AND CAST(level1 AS VARCHAR) = 'Education' AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          tag,\n          area AS Scope,\n          dim,\n            CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n            CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n            CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n          total AS totalUsage,\n          audio AS audio,\n          video AS video,\n            host_sd + audience_sd AS video_sd,\n            host_hd + audience_hd AS video_hd,\n            host_hdp + audience_hdp AS video_hdp,\n          host_audio AS host_audio,\n          audience_audio AS audience_audio,\n          host_sd AS host_sd,\n          host_hd AS host_hd,\n          host_hdp AS host_hdp,\n          audience_sd AS audience_sd,\n          audience_hd AS audience_hd,\n          audience_hdp AS audience_hdp,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          total_last7 AS total_last7,\n          audio_last7 AS audio_last7,\n          video_last7 AS video_last7,\n          video_sd_last7 AS video_sd_last7,\n          video_hd_last7 AS video_hd_last7,\n          video_hdp_last7 AS video_hdp_last7,\n          host_sd_last7 AS host_sd_last7,\n          audience_sd_last7 AS audience_sd_last7,\n          host_hd_last7 AS host_hd_last7,\n          audience_hd_last7 AS audience_hd_last7,\n          host_hdp_last7 AS host_hdp_last7,\n          audience_hdp_last7 AS audience_hdp_last7,\n          host_audio_last7 AS host_audio_last7,\n          audience_audio_last7 AS audience_audio_last7,\n          host_video_last7 AS host_video_last7,\n          audience_video_last7 AS audience_video_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211113 AND date <= 20211212 AND dim = 1 AND area IS NOT NULL AND CAST(level1 AS VARCHAR) = 'Education' AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND CAST(\"自定义 SQL 查询\".\"tag\" AS VARCHAR) = 'Industry' AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 1,\n  2"
	},
	{
		"presto_sql" : "SELECT \"自定义 SQL 查询\".\"product_level2\" AS \"product_level2\"\nFROM (SELECT date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n      total AS totalUsage,\n      audio AS audio,\n      video AS video,\n        host_sd + audience_sd AS video_sd,\n        host_hd + audience_hd AS video_hd,\n        host_hdp + audience_hdp AS video_hdp,\n      host_audio AS host_audio,\n      audience_audio AS audience_audio,\n      host_sd AS host_sd,\n      host_hd AS host_hd,\n      host_hdp AS host_hdp,\n      audience_sd AS audience_sd,\n      audience_hd AS audience_hd,\n      audience_hdp AS audience_hdp,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      total_last7 AS total_last7,\n      audio_last7 AS audio_last7,\n      video_last7 AS video_last7,\n      video_sd_last7 AS video_sd_last7,\n      video_hd_last7 AS video_hd_last7,\n      video_hdp_last7 AS video_hdp_last7,\n      host_sd_last7 AS host_sd_last7,\n      audience_sd_last7 AS audience_sd_last7,\n      host_hd_last7 AS host_hd_last7,\n      audience_hd_last7 AS audience_hd_last7,\n      host_hdp_last7 AS host_hdp_last7,\n      audience_hdp_last7 AS audience_hdp_last7,\n      host_audio_last7 AS host_audio_last7,\n      audience_audio_last7 AS audience_audio_last7,\n      host_video_last7 AS host_video_last7,\n      audience_video_last7 AS audience_video_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211113 AND date <= 20211212 AND dim = 1 AND area IS NOT NULL AND CAST(level1 AS VARCHAR) = 'Education' AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\nGROUP BY 1\nLIMIT 32"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  MIN(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(1482809429)(0)\",\n  MAX(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(3765460736)(0)\",\n  MAX(\"自定义 SQL 查询\".\"stat_date\") AS \"TEMP(attr_stat_date_nk)(2102638629)(0)\",\n  MIN(\"自定义 SQL 查询\".\"stat_date\") AS \"TEMP(attr_stat_date_nk)(2790680713)(0)\",\n  \"自定义 SQL 查询\".\"product_level2\" AS \"product_level2\",\n  DATE_ADD('SECOND', 0, date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"tdy_date_ok\"\nFROM (SELECT date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n      total AS totalUsage,\n      audio AS audio,\n      video AS video,\n        host_sd + audience_sd AS video_sd,\n        host_hd + audience_hd AS video_hd,\n        host_hdp + audience_hdp AS video_hdp,\n      host_audio AS host_audio,\n      audience_audio AS audience_audio,\n      host_sd AS host_sd,\n      host_hd AS host_hd,\n      host_hdp AS host_hdp,\n      audience_sd AS audience_sd,\n      audience_hd AS audience_hd,\n      audience_hdp AS audience_hdp,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      total_last7 AS total_last7,\n      audio_last7 AS audio_last7,\n      video_last7 AS video_last7,\n      video_sd_last7 AS video_sd_last7,\n      video_hd_last7 AS video_hd_last7,\n      video_hdp_last7 AS video_hdp_last7,\n      host_sd_last7 AS host_sd_last7,\n      audience_sd_last7 AS audience_sd_last7,\n      host_hd_last7 AS host_hd_last7,\n      audience_hd_last7 AS audience_hd_last7,\n      host_hdp_last7 AS host_hdp_last7,\n      audience_hdp_last7 AS audience_hdp_last7,\n      host_audio_last7 AS host_audio_last7,\n      audience_audio_last7 AS audience_audio_last7,\n      host_video_last7 AS host_video_last7,\n      audience_video_last7 AS audience_video_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211113 AND date <= 20211212 AND dim = 1 AND area IS NOT NULL AND CAST(level1 AS VARCHAR) = 'Education' AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND CAST(\"自定义 SQL 查询\".\"tag\" AS VARCHAR) = 'Industry'\nGROUP BY 16,\n  17"
	},
	{
		"presto_sql" : "SELECT \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  \"自定义 SQL 查询\".\"stat_date\" AS \"stat_date\"\nFROM (SELECT date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n      total AS totalUsage,\n      audio AS audio,\n      video AS video,\n        host_sd + audience_sd AS video_sd,\n        host_hd + audience_hd AS video_hd,\n        host_hdp + audience_hdp AS video_hdp,\n      host_audio AS host_audio,\n      audience_audio AS audience_audio,\n      host_sd AS host_sd,\n      host_hd AS host_hd,\n      host_hdp AS host_hdp,\n      audience_sd AS audience_sd,\n      audience_hd AS audience_hd,\n      audience_hdp AS audience_hdp,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      total_last7 AS total_last7,\n      audio_last7 AS audio_last7,\n      video_last7 AS video_last7,\n      video_sd_last7 AS video_sd_last7,\n      video_hd_last7 AS video_hd_last7,\n      video_hdp_last7 AS video_hdp_last7,\n      host_sd_last7 AS host_sd_last7,\n      audience_sd_last7 AS audience_sd_last7,\n      host_hd_last7 AS host_hd_last7,\n      audience_hd_last7 AS audience_hd_last7,\n      host_hdp_last7 AS host_hdp_last7,\n      audience_hdp_last7 AS audience_hdp_last7,\n      host_audio_last7 AS host_audio_last7,\n      audience_audio_last7 AS audience_audio_last7,\n      host_video_last7 AS host_video_last7,\n      audience_video_last7 AS audience_video_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211113 AND date <= 20211212 AND dim = 1 AND area IS NOT NULL AND CAST(level1 AS VARCHAR) = 'Education' AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          tag,\n          area AS Scope,\n          dim,\n            CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n            CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n            CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n          total AS totalUsage,\n          audio AS audio,\n          video AS video,\n            host_sd + audience_sd AS video_sd,\n            host_hd + audience_hd AS video_hd,\n            host_hdp + audience_hdp AS video_hdp,\n          host_audio AS host_audio,\n          audience_audio AS audience_audio,\n          host_sd AS host_sd,\n          host_hd AS host_hd,\n          host_hdp AS host_hdp,\n          audience_sd AS audience_sd,\n          audience_hd AS audience_hd,\n          audience_hdp AS audience_hdp,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          total_last7 AS total_last7,\n          audio_last7 AS audio_last7,\n          video_last7 AS video_last7,\n          video_sd_last7 AS video_sd_last7,\n          video_hd_last7 AS video_hd_last7,\n          video_hdp_last7 AS video_hdp_last7,\n          host_sd_last7 AS host_sd_last7,\n          audience_sd_last7 AS audience_sd_last7,\n          host_hd_last7 AS host_hd_last7,\n          audience_hd_last7 AS audience_hd_last7,\n          host_hdp_last7 AS host_hdp_last7,\n          audience_hdp_last7 AS audience_hdp_last7,\n          host_audio_last7 AS host_audio_last7,\n          audience_audio_last7 AS audience_audio_last7,\n          host_video_last7 AS host_video_last7,\n          audience_video_last7 AS audience_video_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211113 AND date <= 20211212 AND dim = 1 AND area IS NOT NULL AND CAST(level1 AS VARCHAR) = 'Education' AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND CAST(\"自定义 SQL 查询\".\"tag\" AS VARCHAR) = 'Industry' AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 1,\n  2"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"total_last7\") AS \"TEMP(video同比 (复制)_96897765683347458)(346677966)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(video同比 (复制)_96897765683347458)(3847882359)(0)\",\n  \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"audio_video_last\") AS \"sum_audio_video_last_ok\"\nFROM (SELECT date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n      total AS totalUsage,\n      audio AS audio,\n      video AS video,\n        host_sd + audience_sd AS video_sd,\n        host_hd + audience_hd AS video_hd,\n        host_hdp + audience_hdp AS video_hdp,\n      host_audio AS host_audio,\n      audience_audio AS audience_audio,\n      host_sd AS host_sd,\n      host_hd AS host_hd,\n      host_hdp AS host_hdp,\n      audience_sd AS audience_sd,\n      audience_hd AS audience_hd,\n      audience_hdp AS audience_hdp,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      total_last7 AS total_last7,\n      audio_last7 AS audio_last7,\n      video_last7 AS video_last7,\n      video_sd_last7 AS video_sd_last7,\n      video_hd_last7 AS video_hd_last7,\n      video_hdp_last7 AS video_hdp_last7,\n      host_sd_last7 AS host_sd_last7,\n      audience_sd_last7 AS audience_sd_last7,\n      host_hd_last7 AS host_hd_last7,\n      audience_hd_last7 AS audience_hd_last7,\n      host_hdp_last7 AS host_hdp_last7,\n      audience_hdp_last7 AS audience_hdp_last7,\n      host_audio_last7 AS host_audio_last7,\n      audience_audio_last7 AS audience_audio_last7,\n      host_video_last7 AS host_video_last7,\n      audience_video_last7 AS audience_video_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211113 AND date <= 20211212 AND dim = 1 AND area IS NOT NULL AND CAST(level1 AS VARCHAR) = 'Education' AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          tag,\n          area AS Scope,\n          dim,\n            CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n            CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n            CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n          total AS totalUsage,\n          audio AS audio,\n          video AS video,\n            host_sd + audience_sd AS video_sd,\n            host_hd + audience_hd AS video_hd,\n            host_hdp + audience_hdp AS video_hdp,\n          host_audio AS host_audio,\n          audience_audio AS audience_audio,\n          host_sd AS host_sd,\n          host_hd AS host_hd,\n          host_hdp AS host_hdp,\n          audience_sd AS audience_sd,\n          audience_hd AS audience_hd,\n          audience_hdp AS audience_hdp,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          total_last7 AS total_last7,\n          audio_last7 AS audio_last7,\n          video_last7 AS video_last7,\n          video_sd_last7 AS video_sd_last7,\n          video_hd_last7 AS video_hd_last7,\n          video_hdp_last7 AS video_hdp_last7,\n          host_sd_last7 AS host_sd_last7,\n          audience_sd_last7 AS audience_sd_last7,\n          host_hd_last7 AS host_hd_last7,\n          audience_hd_last7 AS audience_hd_last7,\n          host_hdp_last7 AS host_hdp_last7,\n          audience_hdp_last7 AS audience_hdp_last7,\n          host_audio_last7 AS host_audio_last7,\n          audience_audio_last7 AS audience_audio_last7,\n          host_video_last7 AS host_video_last7,\n          audience_video_last7 AS audience_video_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211113 AND date <= 20211212 AND dim = 1 AND area IS NOT NULL AND CAST(level1 AS VARCHAR) = 'Education' AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND CAST(\"自定义 SQL 查询\".\"tag\" AS VARCHAR) = 'Industry' AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 3"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"audio_last7\") AS \"TEMP(Calculation_96897765680816128)(2589233512)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_96897765680816128)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(audio同比 (复制)_96897765681725441)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video_last7\") AS \"TEMP(audio同比 (复制)_96897765681725441)(4107040267)(0)\",\n  \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"audio_video_last\") AS \"sum_audio_video_last_ok\"\nFROM (SELECT date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n      total AS totalUsage,\n      audio AS audio,\n      video AS video,\n        host_sd + audience_sd AS video_sd,\n        host_hd + audience_hd AS video_hd,\n        host_hdp + audience_hdp AS video_hdp,\n      host_audio AS host_audio,\n      audience_audio AS audience_audio,\n      host_sd AS host_sd,\n      host_hd AS host_hd,\n      host_hdp AS host_hdp,\n      audience_sd AS audience_sd,\n      audience_hd AS audience_hd,\n      audience_hdp AS audience_hdp,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      total_last7 AS total_last7,\n      audio_last7 AS audio_last7,\n      video_last7 AS video_last7,\n      video_sd_last7 AS video_sd_last7,\n      video_hd_last7 AS video_hd_last7,\n      video_hdp_last7 AS video_hdp_last7,\n      host_sd_last7 AS host_sd_last7,\n      audience_sd_last7 AS audience_sd_last7,\n      host_hd_last7 AS host_hd_last7,\n      audience_hd_last7 AS audience_hd_last7,\n      host_hdp_last7 AS host_hdp_last7,\n      audience_hdp_last7 AS audience_hdp_last7,\n      host_audio_last7 AS host_audio_last7,\n      audience_audio_last7 AS audience_audio_last7,\n      host_video_last7 AS host_video_last7,\n      audience_video_last7 AS audience_video_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211113 AND date <= 20211212 AND dim = 1 AND area IS NOT NULL AND CAST(level1 AS VARCHAR) = 'Education' AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          tag,\n          area AS Scope,\n          dim,\n            CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n            CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n            CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n          total AS totalUsage,\n          audio AS audio,\n          video AS video,\n            host_sd + audience_sd AS video_sd,\n            host_hd + audience_hd AS video_hd,\n            host_hdp + audience_hdp AS video_hdp,\n          host_audio AS host_audio,\n          audience_audio AS audience_audio,\n          host_sd AS host_sd,\n          host_hd AS host_hd,\n          host_hdp AS host_hdp,\n          audience_sd AS audience_sd,\n          audience_hd AS audience_hd,\n          audience_hdp AS audience_hdp,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          total_last7 AS total_last7,\n          audio_last7 AS audio_last7,\n          video_last7 AS video_last7,\n          video_sd_last7 AS video_sd_last7,\n          video_hd_last7 AS video_hd_last7,\n          video_hdp_last7 AS video_hdp_last7,\n          host_sd_last7 AS host_sd_last7,\n          audience_sd_last7 AS audience_sd_last7,\n          host_hd_last7 AS host_hd_last7,\n          audience_hd_last7 AS audience_hd_last7,\n          host_hdp_last7 AS host_hdp_last7,\n          audience_hdp_last7 AS audience_hdp_last7,\n          host_audio_last7 AS host_audio_last7,\n          audience_audio_last7 AS audience_audio_last7,\n          host_video_last7 AS host_video_last7,\n          audience_video_last7 AS audience_video_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211113 AND date <= 20211212 AND dim = 1 AND area IS NOT NULL AND CAST(level1 AS VARCHAR) = 'Education' AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND CAST(\"自定义 SQL 查询\".\"tag\" AS VARCHAR) = 'Industry' AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 5"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  MIN(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(1482809429)(0)\",\n  MAX(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(3765460736)(0)\",\n  \"自定义 SQL 查询\".\"stat_date\" AS \"TEMP(attr_stat_date_nk)(2102638629)(0)\",\n  \"自定义 SQL 查询\".\"stat_date\" AS \"TEMP(attr_stat_date_nk)(2790680713)(0)\",\n  \"自定义 SQL 查询\".\"stat_date\" AS \"stat_date\"\nFROM (SELECT date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n      total AS totalUsage,\n      audio AS audio,\n      video AS video,\n        host_sd + audience_sd AS video_sd,\n        host_hd + audience_hd AS video_hd,\n        host_hdp + audience_hdp AS video_hdp,\n      host_audio AS host_audio,\n      audience_audio AS audience_audio,\n      host_sd AS host_sd,\n      host_hd AS host_hd,\n      host_hdp AS host_hdp,\n      audience_sd AS audience_sd,\n      audience_hd AS audience_hd,\n      audience_hdp AS audience_hdp,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      total_last7 AS total_last7,\n      audio_last7 AS audio_last7,\n      video_last7 AS video_last7,\n      video_sd_last7 AS video_sd_last7,\n      video_hd_last7 AS video_hd_last7,\n      video_hdp_last7 AS video_hdp_last7,\n      host_sd_last7 AS host_sd_last7,\n      audience_sd_last7 AS audience_sd_last7,\n      host_hd_last7 AS host_hd_last7,\n      audience_hd_last7 AS audience_hd_last7,\n      host_hdp_last7 AS host_hdp_last7,\n      audience_hdp_last7 AS audience_hdp_last7,\n      host_audio_last7 AS host_audio_last7,\n      audience_audio_last7 AS audience_audio_last7,\n      host_video_last7 AS host_video_last7,\n      audience_video_last7 AS audience_video_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211113 AND date <= 20211212 AND dim = 1 AND area IS NOT NULL AND CAST(level1 AS VARCHAR) = 'Education' AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND CAST(\"自定义 SQL 查询\".\"tag\" AS VARCHAR) = 'Industry'\nGROUP BY 14"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  MIN(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(1482809429)(0)\",\n  MAX(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(3765460736)(0)\",\n  MAX(\"自定义 SQL 查询\".\"stat_date\") AS \"TEMP(attr_stat_date_nk)(2102638629)(0)\",\n  MIN(\"自定义 SQL 查询\".\"stat_date\") AS \"TEMP(attr_stat_date_nk)(2790680713)(0)\",\n  DATE_ADD('SECOND', 0, date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"tdy_date_ok\",\n  \"自定义 SQL 查询\".\"vid_sector_en\" AS \"vid_sector_en\"\nFROM (SELECT date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n      total AS totalUsage,\n      audio AS audio,\n      video AS video,\n        host_sd + audience_sd AS video_sd,\n        host_hd + audience_hd AS video_hd,\n        host_hdp + audience_hdp AS video_hdp,\n      host_audio AS host_audio,\n      audience_audio AS audience_audio,\n      host_sd AS host_sd,\n      host_hd AS host_hd,\n      host_hdp AS host_hdp,\n      audience_sd AS audience_sd,\n      audience_hd AS audience_hd,\n      audience_hdp AS audience_hdp,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      total_last7 AS total_last7,\n      audio_last7 AS audio_last7,\n      video_last7 AS video_last7,\n      video_sd_last7 AS video_sd_last7,\n      video_hd_last7 AS video_hd_last7,\n      video_hdp_last7 AS video_hdp_last7,\n      host_sd_last7 AS host_sd_last7,\n      audience_sd_last7 AS audience_sd_last7,\n      host_hd_last7 AS host_hd_last7,\n      audience_hd_last7 AS audience_hd_last7,\n      host_hdp_last7 AS host_hdp_last7,\n      audience_hdp_last7 AS audience_hdp_last7,\n      host_audio_last7 AS host_audio_last7,\n      audience_audio_last7 AS audience_audio_last7,\n      host_video_last7 AS host_video_last7,\n      audience_video_last7 AS audience_video_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211113 AND date <= 20211212 AND dim = 1 AND area IS NOT NULL AND CAST(level1 AS VARCHAR) = 'Education' AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND CAST(\"自定义 SQL 查询\".\"tag\" AS VARCHAR) = 'Industry'\nGROUP BY 16,\n  17"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3054707207061430272)(2629536046)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_video_last\") AS \"TEMP(Calculation_3054707207061430272)(2820618408)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(日环比 (复制 2)_96897765685432324)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio_last\") AS \"TEMP(日环比 (复制 2)_96897765685432324)(4091190060)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(日环比 (复制)_96897765685424131)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video_last\") AS \"TEMP(日环比 (复制)_96897765685424131)(3934387163)(0)\",\n  \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"sum_audio_ok\",\n  SUM(\"自定义 SQL 查询\".\"audio_video_last\") AS \"sum_audio_video_last_ok\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"sum_video_ok\"\nFROM (SELECT date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n      total AS totalUsage,\n      audio AS audio,\n      video AS video,\n        host_sd + audience_sd AS video_sd,\n        host_hd + audience_hd AS video_hd,\n        host_hdp + audience_hdp AS video_hdp,\n      host_audio AS host_audio,\n      audience_audio AS audience_audio,\n      host_sd AS host_sd,\n      host_hd AS host_hd,\n      host_hdp AS host_hdp,\n      audience_sd AS audience_sd,\n      audience_hd AS audience_hd,\n      audience_hdp AS audience_hdp,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      total_last7 AS total_last7,\n      audio_last7 AS audio_last7,\n      video_last7 AS video_last7,\n      video_sd_last7 AS video_sd_last7,\n      video_hd_last7 AS video_hd_last7,\n      video_hdp_last7 AS video_hdp_last7,\n      host_sd_last7 AS host_sd_last7,\n      audience_sd_last7 AS audience_sd_last7,\n      host_hd_last7 AS host_hd_last7,\n      audience_hd_last7 AS audience_hd_last7,\n      host_hdp_last7 AS host_hdp_last7,\n      audience_hdp_last7 AS audience_hdp_last7,\n      host_audio_last7 AS host_audio_last7,\n      audience_audio_last7 AS audience_audio_last7,\n      host_video_last7 AS host_video_last7,\n      audience_video_last7 AS audience_video_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211113 AND date <= 20211212 AND dim = 1 AND area IS NOT NULL AND CAST(level1 AS VARCHAR) = 'Education' AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          tag,\n          area AS Scope,\n          dim,\n            CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n            CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n            CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n          total AS totalUsage,\n          audio AS audio,\n          video AS video,\n            host_sd + audience_sd AS video_sd,\n            host_hd + audience_hd AS video_hd,\n            host_hdp + audience_hdp AS video_hdp,\n          host_audio AS host_audio,\n          audience_audio AS audience_audio,\n          host_sd AS host_sd,\n          host_hd AS host_hd,\n          host_hdp AS host_hdp,\n          audience_sd AS audience_sd,\n          audience_hd AS audience_hd,\n          audience_hdp AS audience_hdp,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          total_last7 AS total_last7,\n          audio_last7 AS audio_last7,\n          video_last7 AS video_last7,\n          video_sd_last7 AS video_sd_last7,\n          video_hd_last7 AS video_hd_last7,\n          video_hdp_last7 AS video_hdp_last7,\n          host_sd_last7 AS host_sd_last7,\n          audience_sd_last7 AS audience_sd_last7,\n          host_hd_last7 AS host_hd_last7,\n          audience_hd_last7 AS audience_hd_last7,\n          host_hdp_last7 AS host_hdp_last7,\n          audience_hdp_last7 AS audience_hdp_last7,\n          host_audio_last7 AS host_audio_last7,\n          audience_audio_last7 AS audience_audio_last7,\n          host_video_last7 AS host_video_last7,\n          audience_video_last7 AS audience_video_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211113 AND date <= 20211212 AND dim = 1 AND area IS NOT NULL AND CAST(level1 AS VARCHAR) = 'Education' AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND CAST(\"自定义 SQL 查询\".\"tag\" AS VARCHAR) = 'Industry' AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 7"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  MIN(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(1482809429)(0)\",\n  MAX(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(3765460736)(0)\",\n  MAX(\"自定义 SQL 查询\".\"stat_date\") AS \"TEMP(attr_stat_date_nk)(2102638629)(0)\",\n  MIN(\"自定义 SQL 查询\".\"stat_date\") AS \"TEMP(attr_stat_date_nk)(2790680713)(0)\",\n  DATE_ADD('SECOND', 0, date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"tdy_date_ok\",\n  \"自定义 SQL 查询\".\"vid_use_case_cn\" AS \"vid_use_case_cn\"\nFROM (SELECT date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n      total AS totalUsage,\n      audio AS audio,\n      video AS video,\n        host_sd + audience_sd AS video_sd,\n        host_hd + audience_hd AS video_hd,\n        host_hdp + audience_hdp AS video_hdp,\n      host_audio AS host_audio,\n      audience_audio AS audience_audio,\n      host_sd AS host_sd,\n      host_hd AS host_hd,\n      host_hdp AS host_hdp,\n      audience_sd AS audience_sd,\n      audience_hd AS audience_hd,\n      audience_hdp AS audience_hdp,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      total_last7 AS total_last7,\n      audio_last7 AS audio_last7,\n      video_last7 AS video_last7,\n      video_sd_last7 AS video_sd_last7,\n      video_hd_last7 AS video_hd_last7,\n      video_hdp_last7 AS video_hdp_last7,\n      host_sd_last7 AS host_sd_last7,\n      audience_sd_last7 AS audience_sd_last7,\n      host_hd_last7 AS host_hd_last7,\n      audience_hd_last7 AS audience_hd_last7,\n      host_hdp_last7 AS host_hdp_last7,\n      audience_hdp_last7 AS audience_hdp_last7,\n      host_audio_last7 AS host_audio_last7,\n      audience_audio_last7 AS audience_audio_last7,\n      host_video_last7 AS host_video_last7,\n      audience_video_last7 AS audience_video_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211113 AND date <= 20211212 AND dim = 1 AND area IS NOT NULL AND CAST(level1 AS VARCHAR) = 'Education' AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND CAST(\"自定义 SQL 查询\".\"tag\" AS VARCHAR) = 'Industry'\nGROUP BY 16,\n  17"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  MIN(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(1482809429)(0)\",\n  MAX(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(3765460736)(0)\",\n  MAX(\"自定义 SQL 查询\".\"stat_date\") AS \"TEMP(attr_stat_date_nk)(2102638629)(0)\",\n  MIN(\"自定义 SQL 查询\".\"stat_date\") AS \"TEMP(attr_stat_date_nk)(2790680713)(0)\",\n  \"自定义 SQL 查询\".\"product_level3\" AS \"product_level3\",\n  DATE_ADD('SECOND', 0, date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"tdy_date_ok\"\nFROM (SELECT date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n      total AS totalUsage,\n      audio AS audio,\n      video AS video,\n        host_sd + audience_sd AS video_sd,\n        host_hd + audience_hd AS video_hd,\n        host_hdp + audience_hdp AS video_hdp,\n      host_audio AS host_audio,\n      audience_audio AS audience_audio,\n      host_sd AS host_sd,\n      host_hd AS host_hd,\n      host_hdp AS host_hdp,\n      audience_sd AS audience_sd,\n      audience_hd AS audience_hd,\n      audience_hdp AS audience_hdp,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      total_last7 AS total_last7,\n      audio_last7 AS audio_last7,\n      video_last7 AS video_last7,\n      video_sd_last7 AS video_sd_last7,\n      video_hd_last7 AS video_hd_last7,\n      video_hdp_last7 AS video_hdp_last7,\n      host_sd_last7 AS host_sd_last7,\n      audience_sd_last7 AS audience_sd_last7,\n      host_hd_last7 AS host_hd_last7,\n      audience_hd_last7 AS audience_hd_last7,\n      host_hdp_last7 AS host_hdp_last7,\n      audience_hdp_last7 AS audience_hdp_last7,\n      host_audio_last7 AS host_audio_last7,\n      audience_audio_last7 AS audience_audio_last7,\n      host_video_last7 AS host_video_last7,\n      audience_video_last7 AS audience_video_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211113 AND date <= 20211212 AND dim = 1 AND area IS NOT NULL AND CAST(level1 AS VARCHAR) = 'Education' AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND CAST(\"自定义 SQL 查询\".\"tag\" AS VARCHAR) = 'Industry'\nGROUP BY 16,\n  17"
	},
	{
		"presto_sql" : "SELECT \"自定义 SQL 查询\".\"product_level3\" AS \"product_level3\"\nFROM (SELECT date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n      total AS totalUsage,\n      audio AS audio,\n      video AS video,\n        host_sd + audience_sd AS video_sd,\n        host_hd + audience_hd AS video_hd,\n        host_hdp + audience_hdp AS video_hdp,\n      host_audio AS host_audio,\n      audience_audio AS audience_audio,\n      host_sd AS host_sd,\n      host_hd AS host_hd,\n      host_hdp AS host_hdp,\n      audience_sd AS audience_sd,\n      audience_hd AS audience_hd,\n      audience_hdp AS audience_hdp,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      total_last7 AS total_last7,\n      audio_last7 AS audio_last7,\n      video_last7 AS video_last7,\n      video_sd_last7 AS video_sd_last7,\n      video_hd_last7 AS video_hd_last7,\n      video_hdp_last7 AS video_hdp_last7,\n      host_sd_last7 AS host_sd_last7,\n      audience_sd_last7 AS audience_sd_last7,\n      host_hd_last7 AS host_hd_last7,\n      audience_hd_last7 AS audience_hd_last7,\n      host_hdp_last7 AS host_hdp_last7,\n      audience_hdp_last7 AS audience_hdp_last7,\n      host_audio_last7 AS host_audio_last7,\n      audience_audio_last7 AS audience_audio_last7,\n      host_video_last7 AS host_video_last7,\n      audience_video_last7 AS audience_video_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211113 AND date <= 20211212 AND dim = 1 AND area IS NOT NULL AND CAST(level1 AS VARCHAR) = 'Education' AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\nGROUP BY 1\nLIMIT 64"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  MIN(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(1482809429)(0)\",\n  MAX(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(3765460736)(0)\",\n  \"自定义 SQL 查询\".\"stat_date\" AS \"TEMP(attr_stat_date_nk)(2102638629)(0)\",\n  \"自定义 SQL 查询\".\"stat_date\" AS \"TEMP(attr_stat_date_nk)(2790680713)(0)\",\n  \"自定义 SQL 查询\".\"stat_date\" AS \"stat_date\",\n  \"自定义 SQL 查询\".\"vid_use_case_cn\" AS \"vid_use_case_cn\"\nFROM (SELECT date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n      total AS totalUsage,\n      audio AS audio,\n      video AS video,\n        host_sd + audience_sd AS video_sd,\n        host_hd + audience_hd AS video_hd,\n        host_hdp + audience_hdp AS video_hdp,\n      host_audio AS host_audio,\n      audience_audio AS audience_audio,\n      host_sd AS host_sd,\n      host_hd AS host_hd,\n      host_hdp AS host_hdp,\n      audience_sd AS audience_sd,\n      audience_hd AS audience_hd,\n      audience_hdp AS audience_hdp,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      total_last7 AS total_last7,\n      audio_last7 AS audio_last7,\n      video_last7 AS video_last7,\n      video_sd_last7 AS video_sd_last7,\n      video_hd_last7 AS video_hd_last7,\n      video_hdp_last7 AS video_hdp_last7,\n      host_sd_last7 AS host_sd_last7,\n      audience_sd_last7 AS audience_sd_last7,\n      host_hd_last7 AS host_hd_last7,\n      audience_hd_last7 AS audience_hd_last7,\n      host_hdp_last7 AS host_hdp_last7,\n      audience_hdp_last7 AS audience_hdp_last7,\n      host_audio_last7 AS host_audio_last7,\n      audience_audio_last7 AS audience_audio_last7,\n      host_video_last7 AS host_video_last7,\n      audience_video_last7 AS audience_video_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211113 AND date <= 20211212 AND dim = 1 AND area IS NOT NULL AND CAST(level1 AS VARCHAR) = 'Education' AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          tag,\n          area AS Scope,\n          dim,\n            CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n            CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n            CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n          total AS totalUsage,\n          audio AS audio,\n          video AS video,\n            host_sd + audience_sd AS video_sd,\n            host_hd + audience_hd AS video_hd,\n            host_hdp + audience_hdp AS video_hdp,\n          host_audio AS host_audio,\n          audience_audio AS audience_audio,\n          host_sd AS host_sd,\n          host_hd AS host_hd,\n          host_hdp AS host_hdp,\n          audience_sd AS audience_sd,\n          audience_hd AS audience_hd,\n          audience_hdp AS audience_hdp,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          total_last7 AS total_last7,\n          audio_last7 AS audio_last7,\n          video_last7 AS video_last7,\n          video_sd_last7 AS video_sd_last7,\n          video_hd_last7 AS video_hd_last7,\n          video_hdp_last7 AS video_hdp_last7,\n          host_sd_last7 AS host_sd_last7,\n          audience_sd_last7 AS audience_sd_last7,\n          host_hd_last7 AS host_hd_last7,\n          audience_hd_last7 AS audience_hd_last7,\n          host_hdp_last7 AS host_hdp_last7,\n          audience_hdp_last7 AS audience_hdp_last7,\n          host_audio_last7 AS host_audio_last7,\n          audience_audio_last7 AS audience_audio_last7,\n          host_video_last7 AS host_video_last7,\n          audience_video_last7 AS audience_video_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211113 AND date <= 20211212 AND dim = 1 AND area IS NOT NULL AND CAST(level1 AS VARCHAR) = 'Education' AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND CAST(\"自定义 SQL 查询\".\"tag\" AS VARCHAR) = 'Industry' AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 14,\n  17"
	},
	{
		"presto_sql" : "SELECT \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n  \"自定义 SQL 查询\".\"stat_date\" AS \"stat_date\"\nFROM (SELECT date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n      total AS totalUsage,\n      audio AS audio,\n      video AS video,\n        host_sd + audience_sd AS video_sd,\n        host_hd + audience_hd AS video_hd,\n        host_hdp + audience_hdp AS video_hdp,\n      host_audio AS host_audio,\n      audience_audio AS audience_audio,\n      host_sd AS host_sd,\n      host_hd AS host_hd,\n      host_hdp AS host_hdp,\n      audience_sd AS audience_sd,\n      audience_hd AS audience_hd,\n      audience_hdp AS audience_hdp,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      total_last7 AS total_last7,\n      audio_last7 AS audio_last7,\n      video_last7 AS video_last7,\n      video_sd_last7 AS video_sd_last7,\n      video_hd_last7 AS video_hd_last7,\n      video_hdp_last7 AS video_hdp_last7,\n      host_sd_last7 AS host_sd_last7,\n      audience_sd_last7 AS audience_sd_last7,\n      host_hd_last7 AS host_hd_last7,\n      audience_hd_last7 AS audience_hd_last7,\n      host_hdp_last7 AS host_hdp_last7,\n      audience_hdp_last7 AS audience_hdp_last7,\n      host_audio_last7 AS host_audio_last7,\n      audience_audio_last7 AS audience_audio_last7,\n      host_video_last7 AS host_video_last7,\n      audience_video_last7 AS audience_video_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211113 AND date <= 20211212 AND dim = 1 AND area IS NOT NULL AND CAST(level1 AS VARCHAR) = 'Education' AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          tag,\n          area AS Scope,\n          dim,\n            CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n            CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n            CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n          total AS totalUsage,\n          audio AS audio,\n          video AS video,\n            host_sd + audience_sd AS video_sd,\n            host_hd + audience_hd AS video_hd,\n            host_hdp + audience_hdp AS video_hdp,\n          host_audio AS host_audio,\n          audience_audio AS audience_audio,\n          host_sd AS host_sd,\n          host_hd AS host_hd,\n          host_hdp AS host_hdp,\n          audience_sd AS audience_sd,\n          audience_hd AS audience_hd,\n          audience_hdp AS audience_hdp,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          total_last7 AS total_last7,\n          audio_last7 AS audio_last7,\n          video_last7 AS video_last7,\n          video_sd_last7 AS video_sd_last7,\n          video_hd_last7 AS video_hd_last7,\n          video_hdp_last7 AS video_hdp_last7,\n          host_sd_last7 AS host_sd_last7,\n          audience_sd_last7 AS audience_sd_last7,\n          host_hd_last7 AS host_hd_last7,\n          audience_hd_last7 AS audience_hd_last7,\n          host_hdp_last7 AS host_hdp_last7,\n          audience_hdp_last7 AS audience_hdp_last7,\n          host_audio_last7 AS host_audio_last7,\n          audience_audio_last7 AS audience_audio_last7,\n          host_video_last7 AS host_video_last7,\n          audience_video_last7 AS audience_video_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211113 AND date <= 20211212 AND dim = 1 AND area IS NOT NULL AND CAST(level1 AS VARCHAR) = 'Education' AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND CAST(\"自定义 SQL 查询\".\"tag\" AS VARCHAR) = 'Industry' AND \"自定义 SQL 查询\".\"vid_use_case_cn\" NOT IN ('Education Smart Devices', 'Online Classroom of Famous Schools') AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 1,\n  2"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  \"自定义 SQL 查询\".\"product_line\" AS \"product_line\",\n  \"自定义 SQL 查询\".\"stat_date\" AS \"stat_date\"\nFROM (SELECT date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n      total AS totalUsage,\n      audio AS audio,\n      video AS video,\n        host_sd + audience_sd AS video_sd,\n        host_hd + audience_hd AS video_hd,\n        host_hdp + audience_hdp AS video_hdp,\n      host_audio AS host_audio,\n      audience_audio AS audience_audio,\n      host_sd AS host_sd,\n      host_hd AS host_hd,\n      host_hdp AS host_hdp,\n      audience_sd AS audience_sd,\n      audience_hd AS audience_hd,\n      audience_hdp AS audience_hdp,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      total_last7 AS total_last7,\n      audio_last7 AS audio_last7,\n      video_last7 AS video_last7,\n      video_sd_last7 AS video_sd_last7,\n      video_hd_last7 AS video_hd_last7,\n      video_hdp_last7 AS video_hdp_last7,\n      host_sd_last7 AS host_sd_last7,\n      audience_sd_last7 AS audience_sd_last7,\n      host_hd_last7 AS host_hd_last7,\n      audience_hd_last7 AS audience_hd_last7,\n      host_hdp_last7 AS host_hdp_last7,\n      audience_hdp_last7 AS audience_hdp_last7,\n      host_audio_last7 AS host_audio_last7,\n      audience_audio_last7 AS audience_audio_last7,\n      host_video_last7 AS host_video_last7,\n      audience_video_last7 AS audience_video_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211113 AND date <= 20211212 AND dim = 1 AND area IS NOT NULL AND CAST(level1 AS VARCHAR) = 'Education' AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          tag,\n          area AS Scope,\n          dim,\n            CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n            CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n            CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n          total AS totalUsage,\n          audio AS audio,\n          video AS video,\n            host_sd + audience_sd AS video_sd,\n            host_hd + audience_hd AS video_hd,\n            host_hdp + audience_hdp AS video_hdp,\n          host_audio AS host_audio,\n          audience_audio AS audience_audio,\n          host_sd AS host_sd,\n          host_hd AS host_hd,\n          host_hdp AS host_hdp,\n          audience_sd AS audience_sd,\n          audience_hd AS audience_hd,\n          audience_hdp AS audience_hdp,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          total_last7 AS total_last7,\n          audio_last7 AS audio_last7,\n          video_last7 AS video_last7,\n          video_sd_last7 AS video_sd_last7,\n          video_hd_last7 AS video_hd_last7,\n          video_hdp_last7 AS video_hdp_last7,\n          host_sd_last7 AS host_sd_last7,\n          audience_sd_last7 AS audience_sd_last7,\n          host_hd_last7 AS host_hd_last7,\n          audience_hd_last7 AS audience_hd_last7,\n          host_hdp_last7 AS host_hdp_last7,\n          audience_hdp_last7 AS audience_hdp_last7,\n          host_audio_last7 AS host_audio_last7,\n          audience_audio_last7 AS audience_audio_last7,\n          host_video_last7 AS host_video_last7,\n          audience_video_last7 AS audience_video_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211113 AND date <= 20211212 AND dim = 1 AND area IS NOT NULL AND CAST(level1 AS VARCHAR) = 'Education' AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 12,\n  13"
	},
	{
		"presto_sql" : "SELECT \"t0\".\"TEMP(Calculation_3519281700079370244)(1133678835)(0)\" AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  \"t0\".\"TEMP(Calculation_3519281700079370244)(276907208)(0)\" AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  \"t0\".\"TEMP(Calculation_3519281700079370244)(2929708110)(0)\" AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  \"t0\".\"TEMP(Calculation_3519281700079370244)(2930728935)(0)\" AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  \"t0\".\"TEMP(Calculation_3519281700079370244)(3010533957)(0)\" AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  \"t0\".\"TEMP(Calculation_3519281700079370244)(30306054)(0)\" AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  \"t0\".\"TEMP(Calculation_3519281700079370244)(3087054365)(0)\" AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  \"t0\".\"TEMP(Calculation_3519281700079370244)(3299350010)(0)\" AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  \"t0\".\"sum_totalUsage_ok\" AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  \"t0\".\"TEMP(Calculation_3519281700079370244)(4109514392)(0)\" AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  \"t0\".\"TEMP(Calculation_3519281700079370244)(709512178)(0)\" AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  \"t0\".\"level1\" AS \"level1\",\n  \"t3\".\"__measure__0\" AS \"sum_Calculation_4164281609521332225_ok\",\n  \"t0\".\"sum_totalUsage_ok\" AS \"sum_totalUsage_ok\"\nFROM (SELECT \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n      SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n      SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n      SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n      SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n      SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n      SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n      SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n      SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n      SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n      SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n      SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"sum_totalUsage_ok\"\n    FROM (SELECT date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          tag,\n          area AS Scope,\n          dim,\n            CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n            CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n            CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n          total AS totalUsage,\n          audio AS audio,\n          video AS video,\n            host_sd + audience_sd AS video_sd,\n            host_hd + audience_hd AS video_hd,\n            host_hdp + audience_hdp AS video_hdp,\n          host_audio AS host_audio,\n          audience_audio AS audience_audio,\n          host_sd AS host_sd,\n          host_hd AS host_hd,\n          host_hdp AS host_hdp,\n          audience_sd AS audience_sd,\n          audience_hd AS audience_hd,\n          audience_hdp AS audience_hdp,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          total_last7 AS total_last7,\n          audio_last7 AS audio_last7,\n          video_last7 AS video_last7,\n          video_sd_last7 AS video_sd_last7,\n          video_hd_last7 AS video_hd_last7,\n          video_hdp_last7 AS video_hdp_last7,\n          host_sd_last7 AS host_sd_last7,\n          audience_sd_last7 AS audience_sd_last7,\n          host_hd_last7 AS host_hd_last7,\n          audience_hd_last7 AS audience_hd_last7,\n          host_hdp_last7 AS host_hdp_last7,\n          audience_hdp_last7 AS audience_hdp_last7,\n          host_audio_last7 AS host_audio_last7,\n          audience_audio_last7 AS audience_audio_last7,\n          host_video_last7 AS host_video_last7,\n          audience_video_last7 AS audience_video_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211113 AND date <= 20211212 AND dim = 1 AND area IS NOT NULL AND CAST(level1 AS VARCHAR) = 'Education' AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n    WHERE \"自定义 SQL 查询\".\"dim\" = 1 AND CAST(\"自定义 SQL 查询\".\"tag\" AS VARCHAR) = 'Industry'\n    GROUP BY 1) AS \"t0\"\n  INNER JOIN (SELECT \"t1\".\"level1\" AS \"level1\",\n      SUM(\"t2\".\"__measure__1\") AS \"__measure__0\"\n    FROM (SELECT \"自定义 SQL 查询\".\"date\" AS \"date\",\n          \"自定义 SQL 查询\".\"level1\" AS \"level1\"\n        FROM (SELECT date,\n              start_date AS start_date_7,\n              end_date AS end_date,\n                CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n              tag,\n              area AS Scope,\n              dim,\n                CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n                CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n                CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n              level4,\n              product_level1 AS product_line,\n              product_level2,\n              product_level3,\n              product_level4,\n              vid_internal_industry_en AS cid_industry,\n              vid_use_case_en AS vid_use_case_cn,\n              vid_sector_en,\n              ver_type,\n              ver,\n              os,\n              domain,\n              country,\n              region,\n              dim_grouping_name,\n              total AS totalUsage,\n              audio AS audio,\n              video AS video,\n                host_sd + audience_sd AS video_sd,\n                host_hd + audience_hd AS video_hd,\n                host_hdp + audience_hdp AS video_hdp,\n              host_audio AS host_audio,\n              audience_audio AS audience_audio,\n              host_sd AS host_sd,\n              host_hd AS host_hd,\n              host_hdp AS host_hdp,\n              audience_sd AS audience_sd,\n              audience_hd AS audience_hd,\n              audience_hdp AS audience_hdp,\n              total_last1 AS audio_video_last,\n              audio_last1 AS audio_last,\n              video_last1 AS video_last,\n              video_sd_last1 AS video_sd_last,\n              video_hd_last1 AS video_hd_last,\n              video_hdp_last1 AS video_hdp_last,\n              host_sd_last1 AS host_video_sd_last,\n              audience_sd_last1 AS audience_video_sd_last,\n              host_hd_last1 AS host_video_hd_last,\n              audience_hd_last1 AS audience_video_hd_last,\n              host_hdp_last1 AS host_video_hdp_last,\n              audience_hdp_last1 AS audience_video_hdp_last,\n              host_audio_last1 AS host_audio_last,\n              audience_audio_last1 AS audience_audio_last,\n              host_video_last1 AS host_video_last,\n              audience_video_last1 AS audience_video_last,\n              total_last7 AS total_last7,\n              audio_last7 AS audio_last7,\n              video_last7 AS video_last7,\n              video_sd_last7 AS video_sd_last7,\n              video_hd_last7 AS video_hd_last7,\n              video_hdp_last7 AS video_hdp_last7,\n              host_sd_last7 AS host_sd_last7,\n              audience_sd_last7 AS audience_sd_last7,\n              host_hd_last7 AS host_hd_last7,\n              audience_hd_last7 AS audience_hd_last7,\n              host_hdp_last7 AS host_hdp_last7,\n              audience_hdp_last7 AS audience_hdp_last7,\n              host_audio_last7 AS host_audio_last7,\n              audience_audio_last7 AS audience_audio_last7,\n              host_video_last7 AS host_video_last7,\n              audience_video_last7 AS audience_video_last7\n            FROM levels_usage_dod_di_1\n            WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211113 AND date <= 20211212 AND dim = 1 AND area IS NOT NULL AND CAST(level1 AS VARCHAR) = 'Education' AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n        WHERE \"自定义 SQL 查询\".\"dim\" = 1 AND CAST(\"自定义 SQL 查询\".\"tag\" AS VARCHAR) = 'Industry'\n        GROUP BY 1,\n          2) AS \"t1\"\n      INNER JOIN (SELECT \"自定义 SQL 查询\".\"date\" AS \"date\",\n          SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"__measure__1\"\n        FROM (SELECT date,\n              start_date AS start_date_7,\n              end_date AS end_date,\n                CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n              tag,\n              area AS Scope,\n              dim,\n                CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n                CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n                CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n              level4,\n              product_level1 AS product_line,\n              product_level2,\n              product_level3,\n              product_level4,\n              vid_internal_industry_en AS cid_industry,\n              vid_use_case_en AS vid_use_case_cn,\n              vid_sector_en,\n              ver_type,\n              ver,\n              os,\n              domain,\n              country,\n              region,\n              dim_grouping_name,\n              total AS totalUsage,\n              audio AS audio,\n              video AS video,\n                host_sd + audience_sd AS video_sd,\n                host_hd + audience_hd AS video_hd,\n                host_hdp + audience_hdp AS video_hdp,\n              host_audio AS host_audio,\n              audience_audio AS audience_audio,\n              host_sd AS host_sd,\n              host_hd AS host_hd,\n              host_hdp AS host_hdp,\n              audience_sd AS audience_sd,\n              audience_hd AS audience_hd,\n              audience_hdp AS audience_hdp,\n              total_last1 AS audio_video_last,\n              audio_last1 AS audio_last,\n              video_last1 AS video_last,\n              video_sd_last1 AS video_sd_last,\n              video_hd_last1 AS video_hd_last,\n              video_hdp_last1 AS video_hdp_last,\n              host_sd_last1 AS host_video_sd_last,\n              audience_sd_last1 AS audience_video_sd_last,\n              host_hd_last1 AS host_video_hd_last,\n              audience_hd_last1 AS audience_video_hd_last,\n              host_hdp_last1 AS host_video_hdp_last,\n              audience_hdp_last1 AS audience_video_hdp_last,\n              host_audio_last1 AS host_audio_last,\n              audience_audio_last1 AS audience_audio_last,\n              host_video_last1 AS host_video_last,\n              audience_video_last1 AS audience_video_last,\n              total_last7 AS total_last7,\n              audio_last7 AS audio_last7,\n              video_last7 AS video_last7,\n              video_sd_last7 AS video_sd_last7,\n              video_hd_last7 AS video_hd_last7,\n              video_hdp_last7 AS video_hdp_last7,\n              host_sd_last7 AS host_sd_last7,\n              audience_sd_last7 AS audience_sd_last7,\n              host_hd_last7 AS host_hd_last7,\n              audience_hd_last7 AS audience_hd_last7,\n              host_hdp_last7 AS host_hdp_last7,\n              audience_hdp_last7 AS audience_hdp_last7,\n              host_audio_last7 AS host_audio_last7,\n              audience_audio_last7 AS audience_audio_last7,\n              host_video_last7 AS host_video_last7,\n              audience_video_last7 AS audience_video_last7\n            FROM levels_usage_dod_di_1\n            WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211113 AND date <= 20211212 AND dim = 1 AND area IS NOT NULL AND CAST(level1 AS VARCHAR) = 'Education' AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n        GROUP BY 1) AS \"t2\" ON ((\"t1\".\"date\"  is null and  \"t2\".\"date\"  is null )  or  (\"t1\".\"date\" = \"t2\".\"date\"))\n    GROUP BY 1) AS \"t3\" ON ((\"t0\".\"level1\"  is null and  \"t3\".\"level1\"  is null )  or  (\"t0\".\"level1\" = \"t3\".\"level1\"))"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  MIN(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(1482809429)(0)\",\n  MAX(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(3765460736)(0)\",\n  \"自定义 SQL 查询\".\"product_level2\" AS \"product_level2\",\n  \"自定义 SQL 查询\".\"stat_date\" AS \"stat_date\"\nFROM (SELECT date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n      total AS totalUsage,\n      audio AS audio,\n      video AS video,\n        host_sd + audience_sd AS video_sd,\n        host_hd + audience_hd AS video_hd,\n        host_hdp + audience_hdp AS video_hdp,\n      host_audio AS host_audio,\n      audience_audio AS audience_audio,\n      host_sd AS host_sd,\n      host_hd AS host_hd,\n      host_hdp AS host_hdp,\n      audience_sd AS audience_sd,\n      audience_hd AS audience_hd,\n      audience_hdp AS audience_hdp,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      total_last7 AS total_last7,\n      audio_last7 AS audio_last7,\n      video_last7 AS video_last7,\n      video_sd_last7 AS video_sd_last7,\n      video_hd_last7 AS video_hd_last7,\n      video_hdp_last7 AS video_hdp_last7,\n      host_sd_last7 AS host_sd_last7,\n      audience_sd_last7 AS audience_sd_last7,\n      host_hd_last7 AS host_hd_last7,\n      audience_hd_last7 AS audience_hd_last7,\n      host_hdp_last7 AS host_hdp_last7,\n      audience_hdp_last7 AS audience_hdp_last7,\n      host_audio_last7 AS host_audio_last7,\n      audience_audio_last7 AS audience_audio_last7,\n      host_video_last7 AS host_video_last7,\n      audience_video_last7 AS audience_video_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211113 AND date <= 20211212 AND dim = 1 AND area IS NOT NULL AND CAST(level1 AS VARCHAR) = 'Education' AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          tag,\n          area AS Scope,\n          dim,\n            CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n            CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n            CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n          total AS totalUsage,\n          audio AS audio,\n          video AS video,\n            host_sd + audience_sd AS video_sd,\n            host_hd + audience_hd AS video_hd,\n            host_hdp + audience_hdp AS video_hdp,\n          host_audio AS host_audio,\n          audience_audio AS audience_audio,\n          host_sd AS host_sd,\n          host_hd AS host_hd,\n          host_hdp AS host_hdp,\n          audience_sd AS audience_sd,\n          audience_hd AS audience_hd,\n          audience_hdp AS audience_hdp,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          total_last7 AS total_last7,\n          audio_last7 AS audio_last7,\n          video_last7 AS video_last7,\n          video_sd_last7 AS video_sd_last7,\n          video_hd_last7 AS video_hd_last7,\n          video_hdp_last7 AS video_hdp_last7,\n          host_sd_last7 AS host_sd_last7,\n          audience_sd_last7 AS audience_sd_last7,\n          host_hd_last7 AS host_hd_last7,\n          audience_hd_last7 AS audience_hd_last7,\n          host_hdp_last7 AS host_hdp_last7,\n          audience_hdp_last7 AS audience_hdp_last7,\n          host_audio_last7 AS host_audio_last7,\n          audience_audio_last7 AS audience_audio_last7,\n          host_video_last7 AS host_video_last7,\n          audience_video_last7 AS audience_video_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211113 AND date <= 20211212 AND dim = 1 AND area IS NOT NULL AND CAST(level1 AS VARCHAR) = 'Education' AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND CAST(\"自定义 SQL 查询\".\"tag\" AS VARCHAR) = 'Industry' AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 14,\n  15"
	},
	{
		"presto_sql" : "SELECT \"t0\".\"TEMP(attr_stat_date_nk)(2102638629)(0)\" AS \"TEMP(attr_stat_date_nk)(2102638629)(0)\",\n  \"t0\".\"TEMP(attr_stat_date_nk)(2790680713)(0)\" AS \"TEMP(attr_stat_date_nk)(2790680713)(0)\",\n  \"t0\".\"level1\" AS \"level1\",\n  \"t3\".\"__measure__0\" AS \"sum_Calculation_96897765691088903_ok\",\n  \"t0\".\"sum_audio_ok\" AS \"sum_audio_ok\",\n  \"t3\".\"__measure__1\" AS \"sum_sd百分比 (复制) (复制)_96897765691801609_ok\",\n  \"t3\".\"__measure__2\" AS \"sum_sd百分比 (复制)_96897765691785224_ok\",\n  \"t0\".\"sum_totalUsage_ok\" AS \"sum_totalUsage_ok\",\n  \"t0\".\"sum_video_ok\" AS \"sum_video_ok\",\n  \"t0\".\"sum_video_hd_ok\" AS \"sum_video_hd_ok\",\n  \"t0\".\"sum_video_hdp_ok\" AS \"sum_video_hdp_ok\",\n  \"t0\".\"sum_video_sd_ok\" AS \"sum_video_sd_ok\",\n  \"t0\".\"tdy_date_ok\" AS \"tdy_date_ok\"\nFROM (SELECT \"自定义 SQL 查询\".\"level1\" AS \"level1\",\n      DATE_ADD('SECOND', 0, date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"tdy_date_ok\",\n      MAX(\"自定义 SQL 查询\".\"stat_date\") AS \"TEMP(attr_stat_date_nk)(2102638629)(0)\",\n      MIN(\"自定义 SQL 查询\".\"stat_date\") AS \"TEMP(attr_stat_date_nk)(2790680713)(0)\",\n      SUM(\"自定义 SQL 查询\".\"audio\") AS \"sum_audio_ok\",\n      SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"sum_totalUsage_ok\",\n      SUM(\"自定义 SQL 查询\".\"video\") AS \"sum_video_ok\",\n      SUM(\"自定义 SQL 查询\".\"video_hd\") AS \"sum_video_hd_ok\",\n      SUM(\"自定义 SQL 查询\".\"video_hdp\") AS \"sum_video_hdp_ok\",\n      SUM(\"自定义 SQL 查询\".\"video_sd\") AS \"sum_video_sd_ok\"\n    FROM (SELECT date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          tag,\n          area AS Scope,\n          dim,\n            CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n            CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n            CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n          total AS totalUsage,\n          audio AS audio,\n          video AS video,\n            host_sd + audience_sd AS video_sd,\n            host_hd + audience_hd AS video_hd,\n            host_hdp + audience_hdp AS video_hdp,\n          host_audio AS host_audio,\n          audience_audio AS audience_audio,\n          host_sd AS host_sd,\n          host_hd AS host_hd,\n          host_hdp AS host_hdp,\n          audience_sd AS audience_sd,\n          audience_hd AS audience_hd,\n          audience_hdp AS audience_hdp,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          total_last7 AS total_last7,\n          audio_last7 AS audio_last7,\n          video_last7 AS video_last7,\n          video_sd_last7 AS video_sd_last7,\n          video_hd_last7 AS video_hd_last7,\n          video_hdp_last7 AS video_hdp_last7,\n          host_sd_last7 AS host_sd_last7,\n          audience_sd_last7 AS audience_sd_last7,\n          host_hd_last7 AS host_hd_last7,\n          audience_hd_last7 AS audience_hd_last7,\n          host_hdp_last7 AS host_hdp_last7,\n          audience_hdp_last7 AS audience_hdp_last7,\n          host_audio_last7 AS host_audio_last7,\n          audience_audio_last7 AS audience_audio_last7,\n          host_video_last7 AS host_video_last7,\n          audience_video_last7 AS audience_video_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211113 AND date <= 20211212 AND dim = 1 AND area IS NOT NULL AND CAST(level1 AS VARCHAR) = 'Education' AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n    WHERE \"自定义 SQL 查询\".\"dim\" = 1 AND CAST(\"自定义 SQL 查询\".\"tag\" AS VARCHAR) = 'Industry'\n    GROUP BY 1,\n      2) AS \"t0\"\n  INNER JOIN (SELECT \"t1\".\"level1\" AS \"level1\",\n      DATE_ADD('SECOND', 0, date_parse(cast( \"t1\".\"date\" as VARCHAR), '%Y%m%d')) AS \"tdy_date_ok\",\n      SUM(\"t2\".\"$temp0_import1\") AS \"__measure__0\",\n      SUM(\"t2\".\"$temp1_import1\") AS \"__measure__1\",\n      SUM(\"t2\".\"$temp2_import1\") AS \"__measure__2\"\n    FROM (SELECT \"自定义 SQL 查询\".\"date\" AS \"date\",\n          \"自定义 SQL 查询\".\"level1\" AS \"level1\"\n        FROM (SELECT date,\n              start_date AS start_date_7,\n              end_date AS end_date,\n                CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n              tag,\n              area AS Scope,\n              dim,\n                CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n                CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n                CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n              level4,\n              product_level1 AS product_line,\n              product_level2,\n              product_level3,\n              product_level4,\n              vid_internal_industry_en AS cid_industry,\n              vid_use_case_en AS vid_use_case_cn,\n              vid_sector_en,\n              ver_type,\n              ver,\n              os,\n              domain,\n              country,\n              region,\n              dim_grouping_name,\n              total AS totalUsage,\n              audio AS audio,\n              video AS video,\n                host_sd + audience_sd AS video_sd,\n                host_hd + audience_hd AS video_hd,\n                host_hdp + audience_hdp AS video_hdp,\n              host_audio AS host_audio,\n              audience_audio AS audience_audio,\n              host_sd AS host_sd,\n              host_hd AS host_hd,\n              host_hdp AS host_hdp,\n              audience_sd AS audience_sd,\n              audience_hd AS audience_hd,\n              audience_hdp AS audience_hdp,\n              total_last1 AS audio_video_last,\n              audio_last1 AS audio_last,\n              video_last1 AS video_last,\n              video_sd_last1 AS video_sd_last,\n              video_hd_last1 AS video_hd_last,\n              video_hdp_last1 AS video_hdp_last,\n              host_sd_last1 AS host_video_sd_last,\n              audience_sd_last1 AS audience_video_sd_last,\n              host_hd_last1 AS host_video_hd_last,\n              audience_hd_last1 AS audience_video_hd_last,\n              host_hdp_last1 AS host_video_hdp_last,\n              audience_hdp_last1 AS audience_video_hdp_last,\n              host_audio_last1 AS host_audio_last,\n              audience_audio_last1 AS audience_audio_last,\n              host_video_last1 AS host_video_last,\n              audience_video_last1 AS audience_video_last,\n              total_last7 AS total_last7,\n              audio_last7 AS audio_last7,\n              video_last7 AS video_last7,\n              video_sd_last7 AS video_sd_last7,\n              video_hd_last7 AS video_hd_last7,\n              video_hdp_last7 AS video_hdp_last7,\n              host_sd_last7 AS host_sd_last7,\n              audience_sd_last7 AS audience_sd_last7,\n              host_hd_last7 AS host_hd_last7,\n              audience_hd_last7 AS audience_hd_last7,\n              host_hdp_last7 AS host_hdp_last7,\n              audience_hdp_last7 AS audience_hdp_last7,\n              host_audio_last7 AS host_audio_last7,\n              audience_audio_last7 AS audience_audio_last7,\n              host_video_last7 AS host_video_last7,\n              audience_video_last7 AS audience_video_last7\n            FROM levels_usage_dod_di_1\n            WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211113 AND date <= 20211212 AND dim = 1 AND area IS NOT NULL AND CAST(level1 AS VARCHAR) = 'Education' AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n        WHERE \"自定义 SQL 查询\".\"dim\" = 1 AND CAST(\"自定义 SQL 查询\".\"tag\" AS VARCHAR) = 'Industry'\n        GROUP BY 1,\n          2) AS \"t1\"\n      INNER JOIN (SELECT \"自定义 SQL 查询\".\"date\" AS \"date\",\n            SUM(\"自定义 SQL 查询\".\"video_sd\") \/ SUM(\"自定义 SQL 查询\".\"video\") AS \"$temp0_import1\",\n            SUM(\"自定义 SQL 查询\".\"video_hdp\") \/ SUM(\"自定义 SQL 查询\".\"video\") AS \"$temp1_import1\",\n            SUM(\"自定义 SQL 查询\".\"video_hd\") \/ SUM(\"自定义 SQL 查询\".\"video\") AS \"$temp2_import1\"\n        FROM (SELECT date,\n              start_date AS start_date_7,\n              end_date AS end_date,\n                CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n              tag,\n              area AS Scope,\n              dim,\n                CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n                CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n                CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n              level4,\n              product_level1 AS product_line,\n              product_level2,\n              product_level3,\n              product_level4,\n              vid_internal_industry_en AS cid_industry,\n              vid_use_case_en AS vid_use_case_cn,\n              vid_sector_en,\n              ver_type,\n              ver,\n              os,\n              domain,\n              country,\n              region,\n              dim_grouping_name,\n              total AS totalUsage,\n              audio AS audio,\n              video AS video,\n                host_sd + audience_sd AS video_sd,\n                host_hd + audience_hd AS video_hd,\n                host_hdp + audience_hdp AS video_hdp,\n              host_audio AS host_audio,\n              audience_audio AS audience_audio,\n              host_sd AS host_sd,\n              host_hd AS host_hd,\n              host_hdp AS host_hdp,\n              audience_sd AS audience_sd,\n              audience_hd AS audience_hd,\n              audience_hdp AS audience_hdp,\n              total_last1 AS audio_video_last,\n              audio_last1 AS audio_last,\n              video_last1 AS video_last,\n              video_sd_last1 AS video_sd_last,\n              video_hd_last1 AS video_hd_last,\n              video_hdp_last1 AS video_hdp_last,\n              host_sd_last1 AS host_video_sd_last,\n              audience_sd_last1 AS audience_video_sd_last,\n              host_hd_last1 AS host_video_hd_last,\n              audience_hd_last1 AS audience_video_hd_last,\n              host_hdp_last1 AS host_video_hdp_last,\n              audience_hdp_last1 AS audience_video_hdp_last,\n              host_audio_last1 AS host_audio_last,\n              audience_audio_last1 AS audience_audio_last,\n              host_video_last1 AS host_video_last,\n              audience_video_last1 AS audience_video_last,\n              total_last7 AS total_last7,\n              audio_last7 AS audio_last7,\n              video_last7 AS video_last7,\n              video_sd_last7 AS video_sd_last7,\n              video_hd_last7 AS video_hd_last7,\n              video_hdp_last7 AS video_hdp_last7,\n              host_sd_last7 AS host_sd_last7,\n              audience_sd_last7 AS audience_sd_last7,\n              host_hd_last7 AS host_hd_last7,\n              audience_hd_last7 AS audience_hd_last7,\n              host_hdp_last7 AS host_hdp_last7,\n              audience_hdp_last7 AS audience_hdp_last7,\n              host_audio_last7 AS host_audio_last7,\n              audience_audio_last7 AS audience_audio_last7,\n              host_video_last7 AS host_video_last7,\n              audience_video_last7 AS audience_video_last7\n            FROM levels_usage_dod_di_1\n            WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211113 AND date <= 20211212 AND dim = 1 AND area IS NOT NULL AND CAST(level1 AS VARCHAR) = 'Education' AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n        GROUP BY 1) AS \"t2\" ON ((\"t1\".\"date\"  is null and  \"t2\".\"date\"  is null )  or  (\"t1\".\"date\" = \"t2\".\"date\"))\n    GROUP BY 1,\n      2) AS \"t3\" ON ((\"t0\".\"level1\"  is null and  \"t3\".\"level1\"  is null )  or  (\"t0\".\"level1\" = \"t3\".\"level1\")) AND ((\"t0\".\"tdy_date_ok\"  is null and  \"t3\".\"tdy_date_ok\"  is null )  or  (\"t0\".\"tdy_date_ok\" = \"t3\".\"tdy_date_ok\"))"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  MIN(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(1482809429)(0)\",\n  MAX(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(3765460736)(0)\",\n  \"自定义 SQL 查询\".\"product_level3\" AS \"TEMP(attr_product_level3_nk)(1428376059)(0)\",\n  \"自定义 SQL 查询\".\"product_level3\" AS \"TEMP(attr_product_level3_nk)(3667766967)(0)\",\n  \"自定义 SQL 查询\".\"product_level3\" AS \"product_level3\",\n  \"自定义 SQL 查询\".\"stat_date\" AS \"stat_date\"\nFROM (SELECT date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n      total AS totalUsage,\n      audio AS audio,\n      video AS video,\n        host_sd + audience_sd AS video_sd,\n        host_hd + audience_hd AS video_hd,\n        host_hdp + audience_hdp AS video_hdp,\n      host_audio AS host_audio,\n      audience_audio AS audience_audio,\n      host_sd AS host_sd,\n      host_hd AS host_hd,\n      host_hdp AS host_hdp,\n      audience_sd AS audience_sd,\n      audience_hd AS audience_hd,\n      audience_hdp AS audience_hdp,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      total_last7 AS total_last7,\n      audio_last7 AS audio_last7,\n      video_last7 AS video_last7,\n      video_sd_last7 AS video_sd_last7,\n      video_hd_last7 AS video_hd_last7,\n      video_hdp_last7 AS video_hdp_last7,\n      host_sd_last7 AS host_sd_last7,\n      audience_sd_last7 AS audience_sd_last7,\n      host_hd_last7 AS host_hd_last7,\n      audience_hd_last7 AS audience_hd_last7,\n      host_hdp_last7 AS host_hdp_last7,\n      audience_hdp_last7 AS audience_hdp_last7,\n      host_audio_last7 AS host_audio_last7,\n      audience_audio_last7 AS audience_audio_last7,\n      host_video_last7 AS host_video_last7,\n      audience_video_last7 AS audience_video_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211113 AND date <= 20211212 AND dim = 1 AND area IS NOT NULL AND CAST(level1 AS VARCHAR) = 'Education' AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          tag,\n          area AS Scope,\n          dim,\n            CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n            CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n            CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n          total AS totalUsage,\n          audio AS audio,\n          video AS video,\n            host_sd + audience_sd AS video_sd,\n            host_hd + audience_hd AS video_hd,\n            host_hdp + audience_hdp AS video_hdp,\n          host_audio AS host_audio,\n          audience_audio AS audience_audio,\n          host_sd AS host_sd,\n          host_hd AS host_hd,\n          host_hdp AS host_hdp,\n          audience_sd AS audience_sd,\n          audience_hd AS audience_hd,\n          audience_hdp AS audience_hdp,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          total_last7 AS total_last7,\n          audio_last7 AS audio_last7,\n          video_last7 AS video_last7,\n          video_sd_last7 AS video_sd_last7,\n          video_hd_last7 AS video_hd_last7,\n          video_hdp_last7 AS video_hdp_last7,\n          host_sd_last7 AS host_sd_last7,\n          audience_sd_last7 AS audience_sd_last7,\n          host_hd_last7 AS host_hd_last7,\n          audience_hd_last7 AS audience_hd_last7,\n          host_hdp_last7 AS host_hdp_last7,\n          audience_hdp_last7 AS audience_hdp_last7,\n          host_audio_last7 AS host_audio_last7,\n          audience_audio_last7 AS audience_audio_last7,\n          host_video_last7 AS host_video_last7,\n          audience_video_last7 AS audience_video_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211113 AND date <= 20211212 AND dim = 1 AND area IS NOT NULL AND CAST(level1 AS VARCHAR) = 'Education' AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND CAST(\"自定义 SQL 查询\".\"tag\" AS VARCHAR) = 'Industry' AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 14,\n  17"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  \"自定义 SQL 查询\".\"product_line\" AS \"product_line\",\n  DATE_ADD('SECOND', 0, date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"tdy_date_ok\"\nFROM (SELECT date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n      total AS totalUsage,\n      audio AS audio,\n      video AS video,\n        host_sd + audience_sd AS video_sd,\n        host_hd + audience_hd AS video_hd,\n        host_hdp + audience_hdp AS video_hdp,\n      host_audio AS host_audio,\n      audience_audio AS audience_audio,\n      host_sd AS host_sd,\n      host_hd AS host_hd,\n      host_hdp AS host_hdp,\n      audience_sd AS audience_sd,\n      audience_hd AS audience_hd,\n      audience_hdp AS audience_hdp,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      total_last7 AS total_last7,\n      audio_last7 AS audio_last7,\n      video_last7 AS video_last7,\n      video_sd_last7 AS video_sd_last7,\n      video_hd_last7 AS video_hd_last7,\n      video_hdp_last7 AS video_hdp_last7,\n      host_sd_last7 AS host_sd_last7,\n      audience_sd_last7 AS audience_sd_last7,\n      host_hd_last7 AS host_hd_last7,\n      audience_hd_last7 AS audience_hd_last7,\n      host_hdp_last7 AS host_hdp_last7,\n      audience_hdp_last7 AS audience_hdp_last7,\n      host_audio_last7 AS host_audio_last7,\n      audience_audio_last7 AS audience_audio_last7,\n      host_video_last7 AS host_video_last7,\n      audience_video_last7 AS audience_video_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211113 AND date <= 20211212 AND dim = 1 AND area IS NOT NULL AND CAST(level1 AS VARCHAR) = 'Education' AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1\nGROUP BY 12,\n  13"
	},
	{
		"presto_sql" : "SELECT \"自定义 SQL 查询\".\"product_level3\" AS \"product_level3\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"usr_Calculation_3519281700079370244_ok\"\nFROM (SELECT date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n      total AS totalUsage,\n      audio AS audio,\n      video AS video,\n        host_sd + audience_sd AS video_sd,\n        host_hd + audience_hd AS video_hd,\n        host_hdp + audience_hdp AS video_hdp,\n      host_audio AS host_audio,\n      audience_audio AS audience_audio,\n      host_sd AS host_sd,\n      host_hd AS host_hd,\n      host_hdp AS host_hdp,\n      audience_sd AS audience_sd,\n      audience_hd AS audience_hd,\n      audience_hdp AS audience_hdp,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      total_last7 AS total_last7,\n      audio_last7 AS audio_last7,\n      video_last7 AS video_last7,\n      video_sd_last7 AS video_sd_last7,\n      video_hd_last7 AS video_hd_last7,\n      video_hdp_last7 AS video_hdp_last7,\n      host_sd_last7 AS host_sd_last7,\n      audience_sd_last7 AS audience_sd_last7,\n      host_hd_last7 AS host_hd_last7,\n      audience_hd_last7 AS audience_hd_last7,\n      host_hdp_last7 AS host_hdp_last7,\n      audience_hdp_last7 AS audience_hdp_last7,\n      host_audio_last7 AS host_audio_last7,\n      audience_audio_last7 AS audience_audio_last7,\n      host_video_last7 AS host_video_last7,\n      audience_video_last7 AS audience_video_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211113 AND date <= 20211212 AND dim = 1 AND area IS NOT NULL AND CAST(level1 AS VARCHAR) = 'Education' AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND CAST(\"自定义 SQL 查询\".\"tag\" AS VARCHAR) = 'Industry'\nGROUP BY 1"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"usr_Calculation_3519281700079370244_ok\",\n  \"自定义 SQL 查询\".\"vid_use_case_cn\" AS \"vid_use_case_cn\"\nFROM (SELECT date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n      total AS totalUsage,\n      audio AS audio,\n      video AS video,\n        host_sd + audience_sd AS video_sd,\n        host_hd + audience_hd AS video_hd,\n        host_hdp + audience_hdp AS video_hdp,\n      host_audio AS host_audio,\n      audience_audio AS audience_audio,\n      host_sd AS host_sd,\n      host_hd AS host_hd,\n      host_hdp AS host_hdp,\n      audience_sd AS audience_sd,\n      audience_hd AS audience_hd,\n      audience_hdp AS audience_hdp,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      total_last7 AS total_last7,\n      audio_last7 AS audio_last7,\n      video_last7 AS video_last7,\n      video_sd_last7 AS video_sd_last7,\n      video_hd_last7 AS video_hd_last7,\n      video_hdp_last7 AS video_hdp_last7,\n      host_sd_last7 AS host_sd_last7,\n      audience_sd_last7 AS audience_sd_last7,\n      host_hd_last7 AS host_hd_last7,\n      audience_hd_last7 AS audience_hd_last7,\n      host_hdp_last7 AS host_hdp_last7,\n      audience_hdp_last7 AS audience_hdp_last7,\n      host_audio_last7 AS host_audio_last7,\n      audience_audio_last7 AS audience_audio_last7,\n      host_video_last7 AS host_video_last7,\n      audience_video_last7 AS audience_video_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211113 AND date <= 20211212 AND dim = 1 AND area IS NOT NULL AND CAST(level1 AS VARCHAR) = 'Education' AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND CAST(\"自定义 SQL 查询\".\"tag\" AS VARCHAR) = 'Industry'\nGROUP BY 2"
	},
	{
		"presto_sql" : "SELECT \"自定义 SQL 查询\".\"product_level2\" AS \"product_level2\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"usr_Calculation_3519281700079370244_ok\"\nFROM (SELECT date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n      total AS totalUsage,\n      audio AS audio,\n      video AS video,\n        host_sd + audience_sd AS video_sd,\n        host_hd + audience_hd AS video_hd,\n        host_hdp + audience_hdp AS video_hdp,\n      host_audio AS host_audio,\n      audience_audio AS audience_audio,\n      host_sd AS host_sd,\n      host_hd AS host_hd,\n      host_hdp AS host_hdp,\n      audience_sd AS audience_sd,\n      audience_hd AS audience_hd,\n      audience_hdp AS audience_hdp,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      total_last7 AS total_last7,\n      audio_last7 AS audio_last7,\n      video_last7 AS video_last7,\n      video_sd_last7 AS video_sd_last7,\n      video_hd_last7 AS video_hd_last7,\n      video_hdp_last7 AS video_hdp_last7,\n      host_sd_last7 AS host_sd_last7,\n      audience_sd_last7 AS audience_sd_last7,\n      host_hd_last7 AS host_hd_last7,\n      audience_hd_last7 AS audience_hd_last7,\n      host_hdp_last7 AS host_hdp_last7,\n      audience_hdp_last7 AS audience_hdp_last7,\n      host_audio_last7 AS host_audio_last7,\n      audience_audio_last7 AS audience_audio_last7,\n      host_video_last7 AS host_video_last7,\n      audience_video_last7 AS audience_video_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211113 AND date <= 20211212 AND dim = 1 AND area IS NOT NULL AND CAST(level1 AS VARCHAR) = 'Education' AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND CAST(\"自定义 SQL 查询\".\"tag\" AS VARCHAR) = 'Industry'\nGROUP BY 1"
	},
	{
		"presto_sql" : "SELECT \"自定义 SQL 查询\".\"product_line\" AS \"product_line\"\nFROM (SELECT date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n      total AS totalUsage,\n      audio AS audio,\n      video AS video,\n        host_sd + audience_sd AS video_sd,\n        host_hd + audience_hd AS video_hd,\n        host_hdp + audience_hdp AS video_hdp,\n      host_audio AS host_audio,\n      audience_audio AS audience_audio,\n      host_sd AS host_sd,\n      host_hd AS host_hd,\n      host_hdp AS host_hdp,\n      audience_sd AS audience_sd,\n      audience_hd AS audience_hd,\n      audience_hdp AS audience_hdp,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      total_last7 AS total_last7,\n      audio_last7 AS audio_last7,\n      video_last7 AS video_last7,\n      video_sd_last7 AS video_sd_last7,\n      video_hd_last7 AS video_hd_last7,\n      video_hdp_last7 AS video_hdp_last7,\n      host_sd_last7 AS host_sd_last7,\n      audience_sd_last7 AS audience_sd_last7,\n      host_hd_last7 AS host_hd_last7,\n      audience_hd_last7 AS audience_hd_last7,\n      host_hdp_last7 AS host_hdp_last7,\n      audience_hdp_last7 AS audience_hdp_last7,\n      host_audio_last7 AS host_audio_last7,\n      audience_audio_last7 AS audience_audio_last7,\n      host_video_last7 AS host_video_last7,\n      audience_video_last7 AS audience_video_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211113 AND date <= 20211212 AND dim = 1 AND area IS NOT NULL AND CAST(level1 AS VARCHAR) = 'Education' AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\nGROUP BY 1\nORDER BY \"product_line\""
	},
	{
		"presto_sql" : "SELECT \"自定义 SQL 查询\".\"product_level2\" AS \"product_level2\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"usr_Calculation_3519281700079370244_ok\"\nFROM (SELECT date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n      total AS totalUsage,\n      audio AS audio,\n      video AS video,\n        host_sd + audience_sd AS video_sd,\n        host_hd + audience_hd AS video_hd,\n        host_hdp + audience_hdp AS video_hdp,\n      host_audio AS host_audio,\n      audience_audio AS audience_audio,\n      host_sd AS host_sd,\n      host_hd AS host_hd,\n      host_hdp AS host_hdp,\n      audience_sd AS audience_sd,\n      audience_hd AS audience_hd,\n      audience_hdp AS audience_hdp,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      total_last7 AS total_last7,\n      audio_last7 AS audio_last7,\n      video_last7 AS video_last7,\n      video_sd_last7 AS video_sd_last7,\n      video_hd_last7 AS video_hd_last7,\n      video_hdp_last7 AS video_hdp_last7,\n      host_sd_last7 AS host_sd_last7,\n      audience_sd_last7 AS audience_sd_last7,\n      host_hd_last7 AS host_hd_last7,\n      audience_hd_last7 AS audience_hd_last7,\n      host_hdp_last7 AS host_hdp_last7,\n      audience_hdp_last7 AS audience_hdp_last7,\n      host_audio_last7 AS host_audio_last7,\n      audience_audio_last7 AS audience_audio_last7,\n      host_video_last7 AS host_video_last7,\n      audience_video_last7 AS audience_video_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211113 AND date <= 20211212 AND dim = 1 AND area IS NOT NULL AND CAST(level1 AS VARCHAR) = 'Education' AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          tag,\n          area AS Scope,\n          dim,\n            CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n            CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n            CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n          total AS totalUsage,\n          audio AS audio,\n          video AS video,\n            host_sd + audience_sd AS video_sd,\n            host_hd + audience_hd AS video_hd,\n            host_hdp + audience_hdp AS video_hdp,\n          host_audio AS host_audio,\n          audience_audio AS audience_audio,\n          host_sd AS host_sd,\n          host_hd AS host_hd,\n          host_hdp AS host_hdp,\n          audience_sd AS audience_sd,\n          audience_hd AS audience_hd,\n          audience_hdp AS audience_hdp,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          total_last7 AS total_last7,\n          audio_last7 AS audio_last7,\n          video_last7 AS video_last7,\n          video_sd_last7 AS video_sd_last7,\n          video_hd_last7 AS video_hd_last7,\n          video_hdp_last7 AS video_hdp_last7,\n          host_sd_last7 AS host_sd_last7,\n          audience_sd_last7 AS audience_sd_last7,\n          host_hd_last7 AS host_hd_last7,\n          audience_hd_last7 AS audience_hd_last7,\n          host_hdp_last7 AS host_hdp_last7,\n          audience_hdp_last7 AS audience_hdp_last7,\n          host_audio_last7 AS host_audio_last7,\n          audience_audio_last7 AS audience_audio_last7,\n          host_video_last7 AS host_video_last7,\n          audience_video_last7 AS audience_video_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211113 AND date <= 20211212 AND dim = 1 AND area IS NOT NULL AND CAST(level1 AS VARCHAR) = 'Education' AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND CAST(\"自定义 SQL 查询\".\"tag\" AS VARCHAR) = 'Industry' AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 1"
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"usr_Calculation_3519281700079370244_ok\",\n  \"自定义 SQL 查询\".\"vid_use_case_cn\" AS \"vid_use_case_cn\"\nFROM (SELECT date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n      total AS totalUsage,\n      audio AS audio,\n      video AS video,\n        host_sd + audience_sd AS video_sd,\n        host_hd + audience_hd AS video_hd,\n        host_hdp + audience_hdp AS video_hdp,\n      host_audio AS host_audio,\n      audience_audio AS audience_audio,\n      host_sd AS host_sd,\n      host_hd AS host_hd,\n      host_hdp AS host_hdp,\n      audience_sd AS audience_sd,\n      audience_hd AS audience_hd,\n      audience_hdp AS audience_hdp,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      total_last7 AS total_last7,\n      audio_last7 AS audio_last7,\n      video_last7 AS video_last7,\n      video_sd_last7 AS video_sd_last7,\n      video_hd_last7 AS video_hd_last7,\n      video_hdp_last7 AS video_hdp_last7,\n      host_sd_last7 AS host_sd_last7,\n      audience_sd_last7 AS audience_sd_last7,\n      host_hd_last7 AS host_hd_last7,\n      audience_hd_last7 AS audience_hd_last7,\n      host_hdp_last7 AS host_hdp_last7,\n      audience_hdp_last7 AS audience_hdp_last7,\n      host_audio_last7 AS host_audio_last7,\n      audience_audio_last7 AS audience_audio_last7,\n      host_video_last7 AS host_video_last7,\n      audience_video_last7 AS audience_video_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211113 AND date <= 20211212 AND dim = 1 AND area IS NOT NULL AND CAST(level1 AS VARCHAR) = 'Education' AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          tag,\n          area AS Scope,\n          dim,\n            CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n            CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n            CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n          total AS totalUsage,\n          audio AS audio,\n          video AS video,\n            host_sd + audience_sd AS video_sd,\n            host_hd + audience_hd AS video_hd,\n            host_hdp + audience_hdp AS video_hdp,\n          host_audio AS host_audio,\n          audience_audio AS audience_audio,\n          host_sd AS host_sd,\n          host_hd AS host_hd,\n          host_hdp AS host_hdp,\n          audience_sd AS audience_sd,\n          audience_hd AS audience_hd,\n          audience_hdp AS audience_hdp,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          total_last7 AS total_last7,\n          audio_last7 AS audio_last7,\n          video_last7 AS video_last7,\n          video_sd_last7 AS video_sd_last7,\n          video_hd_last7 AS video_hd_last7,\n          video_hdp_last7 AS video_hdp_last7,\n          host_sd_last7 AS host_sd_last7,\n          audience_sd_last7 AS audience_sd_last7,\n          host_hd_last7 AS host_hd_last7,\n          audience_hd_last7 AS audience_hd_last7,\n          host_hdp_last7 AS host_hdp_last7,\n          audience_hdp_last7 AS audience_hdp_last7,\n          host_audio_last7 AS host_audio_last7,\n          audience_audio_last7 AS audience_audio_last7,\n          host_video_last7 AS host_video_last7,\n          audience_video_last7 AS audience_video_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211113 AND date <= 20211212 AND dim = 1 AND area IS NOT NULL AND CAST(level1 AS VARCHAR) = 'Education' AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND CAST(\"自定义 SQL 查询\".\"tag\" AS VARCHAR) = 'Industry' AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 2"
	},
	{
		"presto_sql" : "SELECT \"自定义 SQL 查询\".\"product_level3\" AS \"product_level3\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"usr_Calculation_3519281700079370244_ok\"\nFROM (SELECT date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n      total AS totalUsage,\n      audio AS audio,\n      video AS video,\n        host_sd + audience_sd AS video_sd,\n        host_hd + audience_hd AS video_hd,\n        host_hdp + audience_hdp AS video_hdp,\n      host_audio AS host_audio,\n      audience_audio AS audience_audio,\n      host_sd AS host_sd,\n      host_hd AS host_hd,\n      host_hdp AS host_hdp,\n      audience_sd AS audience_sd,\n      audience_hd AS audience_hd,\n      audience_hdp AS audience_hdp,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      total_last7 AS total_last7,\n      audio_last7 AS audio_last7,\n      video_last7 AS video_last7,\n      video_sd_last7 AS video_sd_last7,\n      video_hd_last7 AS video_hd_last7,\n      video_hdp_last7 AS video_hdp_last7,\n      host_sd_last7 AS host_sd_last7,\n      audience_sd_last7 AS audience_sd_last7,\n      host_hd_last7 AS host_hd_last7,\n      audience_hd_last7 AS audience_hd_last7,\n      host_hdp_last7 AS host_hdp_last7,\n      audience_hdp_last7 AS audience_hdp_last7,\n      host_audio_last7 AS host_audio_last7,\n      audience_audio_last7 AS audience_audio_last7,\n      host_video_last7 AS host_video_last7,\n      audience_video_last7 AS audience_video_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211113 AND date <= 20211212 AND dim = 1 AND area IS NOT NULL AND CAST(level1 AS VARCHAR) = 'Education' AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          tag,\n          area AS Scope,\n          dim,\n            CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n            CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n            CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n          total AS totalUsage,\n          audio AS audio,\n          video AS video,\n            host_sd + audience_sd AS video_sd,\n            host_hd + audience_hd AS video_hd,\n            host_hdp + audience_hdp AS video_hdp,\n          host_audio AS host_audio,\n          audience_audio AS audience_audio,\n          host_sd AS host_sd,\n          host_hd AS host_hd,\n          host_hdp AS host_hdp,\n          audience_sd AS audience_sd,\n          audience_hd AS audience_hd,\n          audience_hdp AS audience_hdp,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          total_last7 AS total_last7,\n          audio_last7 AS audio_last7,\n          video_last7 AS video_last7,\n          video_sd_last7 AS video_sd_last7,\n          video_hd_last7 AS video_hd_last7,\n          video_hdp_last7 AS video_hdp_last7,\n          host_sd_last7 AS host_sd_last7,\n          audience_sd_last7 AS audience_sd_last7,\n          host_hd_last7 AS host_hd_last7,\n          audience_hd_last7 AS audience_hd_last7,\n          host_hdp_last7 AS host_hdp_last7,\n          audience_hdp_last7 AS audience_hdp_last7,\n          host_audio_last7 AS host_audio_last7,\n          audience_audio_last7 AS audience_audio_last7,\n          host_video_last7 AS host_video_last7,\n          audience_video_last7 AS audience_video_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211113 AND date <= 20211212 AND dim = 1 AND area IS NOT NULL AND CAST(level1 AS VARCHAR) = 'Education' AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND CAST(\"自定义 SQL 查询\".\"tag\" AS VARCHAR) = 'Industry' AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 1"
	},
	{
		"presto_sql" : "SELECT \"自定义 SQL 查询\".\"vid_sector_en\" AS \"vid_sector_en\"\nFROM (SELECT date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n      total AS totalUsage,\n      audio AS audio,\n      video AS video,\n        host_sd + audience_sd AS video_sd,\n        host_hd + audience_hd AS video_hd,\n        host_hdp + audience_hdp AS video_hdp,\n      host_audio AS host_audio,\n      audience_audio AS audience_audio,\n      host_sd AS host_sd,\n      host_hd AS host_hd,\n      host_hdp AS host_hdp,\n      audience_sd AS audience_sd,\n      audience_hd AS audience_hd,\n      audience_hdp AS audience_hdp,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      total_last7 AS total_last7,\n      audio_last7 AS audio_last7,\n      video_last7 AS video_last7,\n      video_sd_last7 AS video_sd_last7,\n      video_hd_last7 AS video_hd_last7,\n      video_hdp_last7 AS video_hdp_last7,\n      host_sd_last7 AS host_sd_last7,\n      audience_sd_last7 AS audience_sd_last7,\n      host_hd_last7 AS host_hd_last7,\n      audience_hd_last7 AS audience_hd_last7,\n      host_hdp_last7 AS host_hdp_last7,\n      audience_hdp_last7 AS audience_hdp_last7,\n      host_audio_last7 AS host_audio_last7,\n      audience_audio_last7 AS audience_audio_last7,\n      host_video_last7 AS host_video_last7,\n      audience_video_last7 AS audience_video_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211113 AND date <= 20211212 AND dim = 1 AND area IS NOT NULL AND CAST(level1 AS VARCHAR) = 'Education' AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\nGROUP BY 1\nORDER BY \"vid_sector_en\""
	},
	{
		"presto_sql" : "SELECT \"自定义 SQL 查询\".\"product_level3\" AS \"product_level3\"\nFROM (SELECT date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n      total AS totalUsage,\n      audio AS audio,\n      video AS video,\n        host_sd + audience_sd AS video_sd,\n        host_hd + audience_hd AS video_hd,\n        host_hdp + audience_hdp AS video_hdp,\n      host_audio AS host_audio,\n      audience_audio AS audience_audio,\n      host_sd AS host_sd,\n      host_hd AS host_hd,\n      host_hdp AS host_hdp,\n      audience_sd AS audience_sd,\n      audience_hd AS audience_hd,\n      audience_hdp AS audience_hdp,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      total_last7 AS total_last7,\n      audio_last7 AS audio_last7,\n      video_last7 AS video_last7,\n      video_sd_last7 AS video_sd_last7,\n      video_hd_last7 AS video_hd_last7,\n      video_hdp_last7 AS video_hdp_last7,\n      host_sd_last7 AS host_sd_last7,\n      audience_sd_last7 AS audience_sd_last7,\n      host_hd_last7 AS host_hd_last7,\n      audience_hd_last7 AS audience_hd_last7,\n      host_hdp_last7 AS host_hdp_last7,\n      audience_hdp_last7 AS audience_hdp_last7,\n      host_audio_last7 AS host_audio_last7,\n      audience_audio_last7 AS audience_audio_last7,\n      host_video_last7 AS host_video_last7,\n      audience_video_last7 AS audience_video_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211113 AND date <= 20211212 AND dim = 1 AND area IS NOT NULL AND CAST(level1 AS VARCHAR) = 'Education' AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\nGROUP BY 1\nORDER BY \"product_level3\""
	},
	{
		"presto_sql" : "SELECT \"自定义 SQL 查询\".\"product_level2\" AS \"product_level2\"\nFROM (SELECT date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n      total AS totalUsage,\n      audio AS audio,\n      video AS video,\n        host_sd + audience_sd AS video_sd,\n        host_hd + audience_hd AS video_hd,\n        host_hdp + audience_hdp AS video_hdp,\n      host_audio AS host_audio,\n      audience_audio AS audience_audio,\n      host_sd AS host_sd,\n      host_hd AS host_hd,\n      host_hdp AS host_hdp,\n      audience_sd AS audience_sd,\n      audience_hd AS audience_hd,\n      audience_hdp AS audience_hdp,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      total_last7 AS total_last7,\n      audio_last7 AS audio_last7,\n      video_last7 AS video_last7,\n      video_sd_last7 AS video_sd_last7,\n      video_hd_last7 AS video_hd_last7,\n      video_hdp_last7 AS video_hdp_last7,\n      host_sd_last7 AS host_sd_last7,\n      audience_sd_last7 AS audience_sd_last7,\n      host_hd_last7 AS host_hd_last7,\n      audience_hd_last7 AS audience_hd_last7,\n      host_hdp_last7 AS host_hdp_last7,\n      audience_hdp_last7 AS audience_hdp_last7,\n      host_audio_last7 AS host_audio_last7,\n      audience_audio_last7 AS audience_audio_last7,\n      host_video_last7 AS host_video_last7,\n      audience_video_last7 AS audience_video_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211113 AND date <= 20211212 AND dim = 1 AND area IS NOT NULL AND CAST(level1 AS VARCHAR) = 'Education' AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\nGROUP BY 1\nORDER BY \"product_level2\""
	},
	{
		"presto_sql" : "SELECT SUM(\"自定义 SQL 查询\".\"audience_sd\") AS \"TEMP(Calculation_3519281700079370244)(1133678835)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hd\") AS \"TEMP(Calculation_3519281700079370244)(276907208)(0)\",\n  SUM(\"自定义 SQL 查询\".\"video\") AS \"TEMP(Calculation_3519281700079370244)(2929708110)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hd\") AS \"TEMP(Calculation_3519281700079370244)(2930728935)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_hdp\") AS \"TEMP(Calculation_3519281700079370244)(3010533957)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_hdp\") AS \"TEMP(Calculation_3519281700079370244)(30306054)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_audio\") AS \"TEMP(Calculation_3519281700079370244)(3087054365)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audio\") AS \"TEMP(Calculation_3519281700079370244)(3299350010)(0)\",\n  SUM(\"自定义 SQL 查询\".\"totalUsage\") AS \"TEMP(Calculation_3519281700079370244)(3847882359)(0)\",\n  SUM(\"自定义 SQL 查询\".\"audience_audio\") AS \"TEMP(Calculation_3519281700079370244)(4109514392)(0)\",\n  SUM(\"自定义 SQL 查询\".\"host_sd\") AS \"TEMP(Calculation_3519281700079370244)(709512178)(0)\",\n  MIN(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(1482809429)(0)\",\n  MAX(\"自定义 SQL 查询\".\"level1\") AS \"TEMP(attr_level1_nk)(3765460736)(0)\",\n  \"自定义 SQL 查询\".\"stat_date\" AS \"TEMP(attr_stat_date_nk)(2102638629)(0)\",\n  \"自定义 SQL 查询\".\"stat_date\" AS \"TEMP(attr_stat_date_nk)(2790680713)(0)\",\n  \"自定义 SQL 查询\".\"stat_date\" AS \"stat_date\",\n  \"自定义 SQL 查询\".\"vid_sector_en\" AS \"vid_sector_en\"\nFROM (SELECT date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n      total AS totalUsage,\n      audio AS audio,\n      video AS video,\n        host_sd + audience_sd AS video_sd,\n        host_hd + audience_hd AS video_hd,\n        host_hdp + audience_hdp AS video_hdp,\n      host_audio AS host_audio,\n      audience_audio AS audience_audio,\n      host_sd AS host_sd,\n      host_hd AS host_hd,\n      host_hdp AS host_hdp,\n      audience_sd AS audience_sd,\n      audience_hd AS audience_hd,\n      audience_hdp AS audience_hdp,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      total_last7 AS total_last7,\n      audio_last7 AS audio_last7,\n      video_last7 AS video_last7,\n      video_sd_last7 AS video_sd_last7,\n      video_hd_last7 AS video_hd_last7,\n      video_hdp_last7 AS video_hdp_last7,\n      host_sd_last7 AS host_sd_last7,\n      audience_sd_last7 AS audience_sd_last7,\n      host_hd_last7 AS host_hd_last7,\n      audience_hd_last7 AS audience_hd_last7,\n      host_hdp_last7 AS host_hdp_last7,\n      audience_hdp_last7 AS audience_hdp_last7,\n      host_audio_last7 AS host_audio_last7,\n      audience_audio_last7 AS audience_audio_last7,\n      host_video_last7 AS host_video_last7,\n      audience_video_last7 AS audience_video_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211113 AND date <= 20211212 AND dim = 1 AND area IS NOT NULL AND CAST(level1 AS VARCHAR) = 'Education' AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n  CROSS JOIN (SELECT MAX(date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d')) AS \"__measure__0\"\n    FROM (SELECT date,\n          start_date AS start_date_7,\n          end_date AS end_date,\n            CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n          tag,\n          area AS Scope,\n          dim,\n            CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n            CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n            CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n          level4,\n          product_level1 AS product_line,\n          product_level2,\n          product_level3,\n          product_level4,\n          vid_internal_industry_en AS cid_industry,\n          vid_use_case_en AS vid_use_case_cn,\n          vid_sector_en,\n          ver_type,\n          ver,\n          os,\n          domain,\n          country,\n          region,\n          dim_grouping_name,\n          total AS totalUsage,\n          audio AS audio,\n          video AS video,\n            host_sd + audience_sd AS video_sd,\n            host_hd + audience_hd AS video_hd,\n            host_hdp + audience_hdp AS video_hdp,\n          host_audio AS host_audio,\n          audience_audio AS audience_audio,\n          host_sd AS host_sd,\n          host_hd AS host_hd,\n          host_hdp AS host_hdp,\n          audience_sd AS audience_sd,\n          audience_hd AS audience_hd,\n          audience_hdp AS audience_hdp,\n          total_last1 AS audio_video_last,\n          audio_last1 AS audio_last,\n          video_last1 AS video_last,\n          video_sd_last1 AS video_sd_last,\n          video_hd_last1 AS video_hd_last,\n          video_hdp_last1 AS video_hdp_last,\n          host_sd_last1 AS host_video_sd_last,\n          audience_sd_last1 AS audience_video_sd_last,\n          host_hd_last1 AS host_video_hd_last,\n          audience_hd_last1 AS audience_video_hd_last,\n          host_hdp_last1 AS host_video_hdp_last,\n          audience_hdp_last1 AS audience_video_hdp_last,\n          host_audio_last1 AS host_audio_last,\n          audience_audio_last1 AS audience_audio_last,\n          host_video_last1 AS host_video_last,\n          audience_video_last1 AS audience_video_last,\n          total_last7 AS total_last7,\n          audio_last7 AS audio_last7,\n          video_last7 AS video_last7,\n          video_sd_last7 AS video_sd_last7,\n          video_hd_last7 AS video_hd_last7,\n          video_hdp_last7 AS video_hdp_last7,\n          host_sd_last7 AS host_sd_last7,\n          audience_sd_last7 AS audience_sd_last7,\n          host_hd_last7 AS host_hd_last7,\n          audience_hd_last7 AS audience_hd_last7,\n          host_hdp_last7 AS host_hdp_last7,\n          audience_hdp_last7 AS audience_hdp_last7,\n          host_audio_last7 AS host_audio_last7,\n          audience_audio_last7 AS audience_audio_last7,\n          host_video_last7 AS host_video_last7,\n          audience_video_last7 AS audience_video_last7\n        FROM levels_usage_dod_di_1\n        WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211113 AND date <= 20211212 AND dim = 1 AND area IS NOT NULL AND CAST(level1 AS VARCHAR) = 'Education' AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n    HAVING COUNT(1) > 0) AS \"t0\"\nWHERE \"自定义 SQL 查询\".\"dim\" = 1 AND CAST(\"自定义 SQL 查询\".\"tag\" AS VARCHAR) = 'Industry' AND date_parse(cast( \"自定义 SQL 查询\".\"date\" as VARCHAR), '%Y%m%d') = \"t0\".\"__measure__0\"\nGROUP BY 16,\n  17"
	},
	{
		"presto_sql" : "SELECT \"t0\".\"tag\" AS \"tag\"\nFROM (SELECT \"自定义 SQL 查询\".\"tag\" AS \"tag\"\n      FROM (SELECT date,\n            start_date AS start_date_7,\n            end_date AS end_date,\n              CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n            tag,\n            area AS Scope,\n            dim,\n              CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n              CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n              CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n            level4,\n            product_level1 AS product_line,\n            product_level2,\n            product_level3,\n            product_level4,\n            vid_internal_industry_en AS cid_industry,\n            vid_use_case_en AS vid_use_case_cn,\n            vid_sector_en,\n            ver_type,\n            ver,\n            os,\n            domain,\n            country,\n            region,\n            dim_grouping_name,\n            total AS totalUsage,\n            audio AS audio,\n            video AS video,\n              host_sd + audience_sd AS video_sd,\n              host_hd + audience_hd AS video_hd,\n              host_hdp + audience_hdp AS video_hdp,\n            host_audio AS host_audio,\n            audience_audio AS audience_audio,\n            host_sd AS host_sd,\n            host_hd AS host_hd,\n            host_hdp AS host_hdp,\n            audience_sd AS audience_sd,\n            audience_hd AS audience_hd,\n            audience_hdp AS audience_hdp,\n            total_last1 AS audio_video_last,\n            audio_last1 AS audio_last,\n            video_last1 AS video_last,\n            video_sd_last1 AS video_sd_last,\n            video_hd_last1 AS video_hd_last,\n            video_hdp_last1 AS video_hdp_last,\n            host_sd_last1 AS host_video_sd_last,\n            audience_sd_last1 AS audience_video_sd_last,\n            host_hd_last1 AS host_video_hd_last,\n            audience_hd_last1 AS audience_video_hd_last,\n            host_hdp_last1 AS host_video_hdp_last,\n            audience_hdp_last1 AS audience_video_hdp_last,\n            host_audio_last1 AS host_audio_last,\n            audience_audio_last1 AS audience_audio_last,\n            host_video_last1 AS host_video_last,\n            audience_video_last1 AS audience_video_last,\n            total_last7 AS total_last7,\n            audio_last7 AS audio_last7,\n            video_last7 AS video_last7,\n            video_sd_last7 AS video_sd_last7,\n            video_hd_last7 AS video_hd_last7,\n            video_hdp_last7 AS video_hdp_last7,\n            host_sd_last7 AS host_sd_last7,\n            audience_sd_last7 AS audience_sd_last7,\n            host_hd_last7 AS host_hd_last7,\n            audience_hd_last7 AS audience_hd_last7,\n            host_hdp_last7 AS host_hdp_last7,\n            audience_hdp_last7 AS audience_hdp_last7,\n            host_audio_last7 AS host_audio_last7,\n            audience_audio_last7 AS audience_audio_last7,\n            host_video_last7 AS host_video_last7,\n            audience_video_last7 AS audience_video_last7\n          FROM levels_usage_dod_di_1\n          WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211113 AND date <= 20211212 AND dim = 1 AND area IS NOT NULL AND CAST(level1 AS VARCHAR) = 'Education' AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\n      WHERE CAST(\"自定义 SQL 查询\".\"tag\" AS VARCHAR) = 'Industry'\n      LIMIT 1) AS \"t0\"\nORDER BY \"tag\""
	},
	{
		"presto_sql" : "SELECT '跳转查看 vid 用量详情' AS \"Calculation_5485102878107062272\"\nFROM (SELECT date,\n      start_date AS start_date_7,\n      end_date AS end_date,\n        CASE WHEN 1 = 1 THEN substr(CAST(date_parse(cast( date as VARCHAR), '%Y%m%d') AS VARCHAR), 1, 10) ELSE concat(CAST(date_format(CAST(start_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR), '~', CAST(date_format(CAST(end_date AS TIMESTAMP), '%Y%m%d') AS VARCHAR)) END AS stat_date,\n      tag,\n      area AS Scope,\n      dim,\n        CASE WHEN CAST(level1 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level1 END AS level1,\n        CASE WHEN CAST(level2 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level2 END AS level2,\n        CASE WHEN CAST(level3 AS VARCHAR) = 'unknown' THEN 'UNKNOWN' ELSE level3 END AS level3,\n      level4,\n      product_level1 AS product_line,\n      product_level2,\n      product_level3,\n      product_level4,\n      vid_internal_industry_en AS cid_industry,\n      vid_use_case_en AS vid_use_case_cn,\n      vid_sector_en,\n      ver_type,\n      ver,\n      os,\n      domain,\n      country,\n      region,\n      dim_grouping_name,\n      total AS totalUsage,\n      audio AS audio,\n      video AS video,\n        host_sd + audience_sd AS video_sd,\n        host_hd + audience_hd AS video_hd,\n        host_hdp + audience_hdp AS video_hdp,\n      host_audio AS host_audio,\n      audience_audio AS audience_audio,\n      host_sd AS host_sd,\n      host_hd AS host_hd,\n      host_hdp AS host_hdp,\n      audience_sd AS audience_sd,\n      audience_hd AS audience_hd,\n      audience_hdp AS audience_hdp,\n      total_last1 AS audio_video_last,\n      audio_last1 AS audio_last,\n      video_last1 AS video_last,\n      video_sd_last1 AS video_sd_last,\n      video_hd_last1 AS video_hd_last,\n      video_hdp_last1 AS video_hdp_last,\n      host_sd_last1 AS host_video_sd_last,\n      audience_sd_last1 AS audience_video_sd_last,\n      host_hd_last1 AS host_video_hd_last,\n      audience_hd_last1 AS audience_video_hd_last,\n      host_hdp_last1 AS host_video_hdp_last,\n      audience_hdp_last1 AS audience_video_hdp_last,\n      host_audio_last1 AS host_audio_last,\n      audience_audio_last1 AS audience_audio_last,\n      host_video_last1 AS host_video_last,\n      audience_video_last1 AS audience_video_last,\n      total_last7 AS total_last7,\n      audio_last7 AS audio_last7,\n      video_last7 AS video_last7,\n      video_sd_last7 AS video_sd_last7,\n      video_hd_last7 AS video_hd_last7,\n      video_hdp_last7 AS video_hdp_last7,\n      host_sd_last7 AS host_sd_last7,\n      audience_sd_last7 AS audience_sd_last7,\n      host_hd_last7 AS host_hd_last7,\n      audience_hd_last7 AS audience_hd_last7,\n      host_hdp_last7 AS host_hdp_last7,\n      audience_hdp_last7 AS audience_hdp_last7,\n      host_audio_last7 AS host_audio_last7,\n      audience_audio_last7 AS audience_audio_last7,\n      host_video_last7 AS host_video_last7,\n      audience_video_last7 AS audience_video_last7\n    FROM levels_usage_dod_di_1\n    WHERE CAST(tag AS VARCHAR) = 'Industry' AND date >= 20211113 AND date <= 20211212 AND dim = 1 AND area IS NOT NULL AND CAST(level1 AS VARCHAR) = 'Education' AND ('ALL' = 'ALL' OR CAST(area AS VARCHAR) = 'ALL')) AS \"自定义 SQL 查询\"\nWHERE \"自定义 SQL 查询\".\"vid_use_case_cn\" NOT IN ('Education Smart Devices', 'Online Classroom of Famous Schools')\nHAVING COUNT(1) > 0"
	}
]
